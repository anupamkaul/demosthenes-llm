current dir:  /Users/anupkaul/akaul_git/demosthenes-llm/attention 

module path to be used for import:  /Users/anupkaul/akaul_git/demosthenes-llm/attention/../tokenizers/ 

Token IDs:
 tensor([[   40,   367,  2885,  1464],
        [ 1807,  3619,   402,   271],
        [10899,  2138,   257,  7026],
        [15632,   438,  2016,   257],
        [  922,  5891,  1576,   438],
        [  568,   340,   373,   645],
        [ 1049,  5975,   284,   502],
        [  284,  3285,   326,    11]])

Inputs shape:
 torch.Size([8, 4])
token embedding layer:
 Embedding(50257, 768) 

weights of this layer: 
 Parameter containing:
tensor([[-1.0474, -0.8342,  2.5102,  ...,  0.6789,  0.4676, -1.5935],
        [ 1.0546,  0.6294,  0.5132,  ..., -0.4131,  0.3235,  0.9475],
        [-0.6216,  2.0132, -0.1684,  ...,  1.3180,  0.0316,  0.6517],
        ...,
        [-1.4883,  2.5625,  2.0408,  ...,  0.6784, -0.6221, -0.5874],
        [-0.6043,  0.6628, -0.9639,  ..., -1.3769, -0.1813, -1.5688],
        [ 0.0143,  1.2063, -0.8165,  ..., -0.3156, -0.6950, -0.5700]],
       requires_grad=True) 

token embedding shape:  torch.Size([8, 4, 768])
shape of positional embedding:  torch.Size([4, 768])
input embeddings are now (with positional embedding inserted) : 
 tensor([[[ 0.9927,  2.5799, -0.5984,  ..., -1.2880,  0.1192, -0.3710],
         [ 2.5352, -1.2900, -1.1702,  ..., -0.7544,  0.7101, -0.0867],
         [-1.2132, -0.7121, -0.4737,  ...,  1.2960,  0.0728, -1.4022],
         [ 1.4148,  1.3905,  2.2193,  ...,  0.0144,  0.8420, -0.7353]],

        [[ 0.4831,  2.9225, -1.1147,  ...,  0.1881, -0.8944, -1.0534],
         [ 2.4027, -0.7118, -0.1588,  ..., -0.4205,  1.3653, -0.0197],
         [-0.5416,  1.0986,  0.0818,  ..., -0.2149,  0.9092, -0.7141],
         [-1.1467,  0.7429,  0.3129,  ..., -1.5010,  1.1559,  1.3680]],

        [[ 0.5802,  2.4944, -0.9560,  ...,  0.6493,  1.0376, -1.3388],
         [ 2.5814, -0.1345, -0.4236,  ..., -0.1149, -0.3818,  0.3032],
         [-1.2813, -1.5651, -3.0068,  ...,  4.2049, -0.9540, -0.6875],
         [-0.6956,  2.2145,  3.4953,  ..., -0.1779,  1.1260,  0.1362]],

        ...,

        [[ 0.6752,  3.1706, -1.8367,  ...,  0.3738, -0.6126, -2.9691],
         [ 0.4236,  0.4225, -0.8899,  ...,  1.1560,  0.3079,  0.2540],
         [-0.1368, -0.8187, -0.0369,  ...,  2.4644, -0.8036, -1.9474],
         [-1.8275,  0.5355,  1.7919,  ..., -0.8340,  0.6017, -0.0477]],

        [[ 1.9242,  2.2496, -0.2916,  ...,  1.9410, -0.9053,  0.2901],
         [ 2.2884, -0.8681, -0.1853,  ..., -0.9026, -1.4595, -1.2139],
         [-0.3218, -0.8343, -0.8483,  ...,  1.2970, -0.8085, -2.6267],
         [-0.5245,  0.7360,  2.6353,  ..., -0.6990,  2.9002,  0.4729]],

        [[ 1.0690,  1.7504, -1.1617,  ..., -0.7749, -0.7474, -2.6620],
         [ 3.0211, -0.9049,  0.4420,  ...,  0.1756,  0.8314,  0.5112],
         [-1.3505, -3.7123,  0.5667,  ...,  0.9043, -0.1212, -0.6254],
         [ 1.0411, -1.1164,  2.0764,  ...,  0.1115, -0.2995, -1.0904]]],
       grad_fn=<AddBackward0>) 

input_embeddings shape (adding positional embeddings) is 
 torch.Size([8, 4, 768])
batch shape:  torch.Size([8, 4, 768]) 

batch: 
 tensor([[[ 0.9927,  2.5799, -0.5984,  ..., -1.2880,  0.1192, -0.3710],
         [ 2.5352, -1.2900, -1.1702,  ..., -0.7544,  0.7101, -0.0867],
         [-1.2132, -0.7121, -0.4737,  ...,  1.2960,  0.0728, -1.4022],
         [ 1.4148,  1.3905,  2.2193,  ...,  0.0144,  0.8420, -0.7353]],

        [[ 0.4831,  2.9225, -1.1147,  ...,  0.1881, -0.8944, -1.0534],
         [ 2.4027, -0.7118, -0.1588,  ..., -0.4205,  1.3653, -0.0197],
         [-0.5416,  1.0986,  0.0818,  ..., -0.2149,  0.9092, -0.7141],
         [-1.1467,  0.7429,  0.3129,  ..., -1.5010,  1.1559,  1.3680]],

        [[ 0.5802,  2.4944, -0.9560,  ...,  0.6493,  1.0376, -1.3388],
         [ 2.5814, -0.1345, -0.4236,  ..., -0.1149, -0.3818,  0.3032],
         [-1.2813, -1.5651, -3.0068,  ...,  4.2049, -0.9540, -0.6875],
         [-0.6956,  2.2145,  3.4953,  ..., -0.1779,  1.1260,  0.1362]],

        ...,

        [[ 0.6752,  3.1706, -1.8367,  ...,  0.3738, -0.6126, -2.9691],
         [ 0.4236,  0.4225, -0.8899,  ...,  1.1560,  0.3079,  0.2540],
         [-0.1368, -0.8187, -0.0369,  ...,  2.4644, -0.8036, -1.9474],
         [-1.8275,  0.5355,  1.7919,  ..., -0.8340,  0.6017, -0.0477]],

        [[ 1.9242,  2.2496, -0.2916,  ...,  1.9410, -0.9053,  0.2901],
         [ 2.2884, -0.8681, -0.1853,  ..., -0.9026, -1.4595, -1.2139],
         [-0.3218, -0.8343, -0.8483,  ...,  1.2970, -0.8085, -2.6267],
         [-0.5245,  0.7360,  2.6353,  ..., -0.6990,  2.9002,  0.4729]],

        [[ 1.0690,  1.7504, -1.1617,  ..., -0.7749, -0.7474, -2.6620],
         [ 3.0211, -0.9049,  0.4420,  ...,  0.1756,  0.8314,  0.5112],
         [-1.3505, -3.7123,  0.5667,  ...,  0.9043, -0.1212, -0.6254],
         [ 1.0411, -1.1164,  2.0764,  ...,  0.1115, -0.2995, -1.0904]]],
       grad_fn=<AddBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.3118e+01,        -inf,        -inf,        -inf],
          [-3.3616e+00, -5.0145e+00,        -inf,        -inf],
          [-2.9262e+00,  2.1655e+00,  4.0617e+00,        -inf],
          [-8.5980e-01,  5.7158e+00,  1.4772e+01,  1.8686e+00]],

         [[-2.0163e+00,        -inf,        -inf,        -inf],
          [-8.2061e+00,  2.0534e+00,        -inf,        -inf],
          [ 3.1094e+00, -2.0309e+00,  7.5782e-01,        -inf],
          [ 1.5776e+01,  4.5795e+00,  1.2862e+01, -1.2630e+00]],

         [[ 4.1208e+00,        -inf,        -inf,        -inf],
          [ 6.3284e-03,  5.6710e+00,        -inf,        -inf],
          [-7.1513e+00, -1.5835e+00,  1.3032e+00,        -inf],
          [ 4.0073e+00,  6.2757e+00, -6.1265e-01,  2.0580e+00]],

         ...,

         [[-8.0092e+00,        -inf,        -inf,        -inf],
          [-3.6920e+00, -4.9571e-01,        -inf,        -inf],
          [ 3.6186e+00,  2.4954e+00, -6.5653e+00,        -inf],
          [ 7.2290e-01, -6.2384e-01, -4.4022e-01,  6.3417e+00]],

         [[ 9.6009e+00,        -inf,        -inf,        -inf],
          [ 6.2867e+00, -6.3945e-01,        -inf,        -inf],
          [ 5.9626e+00, -6.7421e+00,  3.3903e+00,        -inf],
          [ 4.4025e+00,  4.9494e-01, -1.6188e+00,  1.0783e+00]],

         [[ 1.0151e+00,        -inf,        -inf,        -inf],
          [-1.9894e-01, -3.1823e+00,        -inf,        -inf],
          [-9.0259e-01,  1.7837e+00, -3.5674e-02,        -inf],
          [ 3.0527e+00,  3.5856e+00,  6.9988e+00,  5.1076e+00]]],


        [[[ 2.3750e+00,        -inf,        -inf,        -inf],
          [ 1.1126e-01,  3.2067e+00,        -inf,        -inf],
          [ 2.8786e-02,  3.7742e+00, -3.2749e+00,        -inf],
          [-7.1443e+00, -3.0760e+00, -5.9145e-01,  3.4891e-01]],

         [[ 2.5714e+00,        -inf,        -inf,        -inf],
          [ 2.8033e+00, -3.6822e+00,        -inf,        -inf],
          [ 5.3978e-02,  5.6453e+00,  4.7381e+00,        -inf],
          [-1.4641e+00,  5.8126e+00, -2.5477e-01,  2.8659e+00]],

         [[ 9.8960e-01,        -inf,        -inf,        -inf],
          [ 9.6938e+00,  5.5369e+00,        -inf,        -inf],
          [ 3.3993e+00, -1.6523e+00, -8.2746e+00,        -inf],
          [-1.5847e+00,  5.2748e+00, -8.0338e+00,  2.5996e+00]],

         ...,

         [[-4.0670e+00,        -inf,        -inf,        -inf],
          [-2.6154e+00, -4.6439e+00,        -inf,        -inf],
          [ 2.8345e+00,  7.0639e+00, -3.2898e+00,        -inf],
          [-4.0017e+00,  9.2939e-01, -5.3421e+00,  5.9318e+00]],

         [[ 3.3486e+00,        -inf,        -inf,        -inf],
          [-3.9425e-01, -7.1581e+00,        -inf,        -inf],
          [-4.5376e+00, -5.2897e+00, -3.2546e-01,        -inf],
          [-6.4372e-01,  5.9738e-02, -2.7576e+00, -5.4180e+00]],

         [[-3.6359e+00,        -inf,        -inf,        -inf],
          [-1.7676e+00,  5.1935e+00,        -inf,        -inf],
          [-1.2747e+01,  1.1735e+01, -9.7883e+00,        -inf],
          [ 3.5845e+00, -6.6553e+00,  1.0293e+01, -6.0860e+00]]],


        [[[ 4.8412e-01,        -inf,        -inf,        -inf],
          [-2.1062e+00,  5.0673e+00,        -inf,        -inf],
          [ 4.4535e-01,  7.9977e+00,  6.5444e+00,        -inf],
          [-6.1854e+00,  2.8853e+00, -1.5691e+00,  3.4767e+00]],

         [[-2.1814e+00,        -inf,        -inf,        -inf],
          [ 1.2800e+00, -8.1402e+00,        -inf,        -inf],
          [-4.0800e+00,  8.8348e-01, -5.2767e+00,        -inf],
          [-1.1187e-01, -1.9062e+00,  5.9601e+00, -1.4949e+00]],

         [[-4.7007e-01,        -inf,        -inf,        -inf],
          [ 8.7728e+00,  2.1508e+00,        -inf,        -inf],
          [ 2.9698e+00,  2.9653e+00, -5.2843e+00,        -inf],
          [ 3.8312e+00, -2.9434e+00, -2.6703e+00,  4.8055e+00]],

         ...,

         [[-7.8711e+00,        -inf,        -inf,        -inf],
          [ 6.6321e-01,  7.7547e+00,        -inf,        -inf],
          [-8.3991e-01,  5.3349e+00, -1.0908e+01,        -inf],
          [-9.2521e+00, -3.2284e+00, -8.8089e-02,  1.7933e+00]],

         [[ 3.7383e+00,        -inf,        -inf,        -inf],
          [-8.1117e-01, -7.0438e+00,        -inf,        -inf],
          [ 7.4401e-01,  8.2951e+00, -1.9257e+00,        -inf],
          [-1.2221e+00,  2.7667e+00,  4.1929e+00, -2.1913e+00]],

         [[ 1.1731e+00,        -inf,        -inf,        -inf],
          [-9.6188e-01,  3.9717e-01,        -inf,        -inf],
          [-1.4848e+01,  1.7823e+00,  7.4967e-02,        -inf],
          [ 1.8948e+00, -5.9020e+00,  9.0346e+00, -9.7812e-01]]],


        ...,


        [[[-1.2977e+01,        -inf,        -inf,        -inf],
          [-2.5513e+00,  8.0011e-01,        -inf,        -inf],
          [-7.7903e+00,  2.1509e+00, -7.9837e+00,        -inf],
          [ 6.9332e+00, -4.0171e+00,  6.5823e+00,  6.3494e+00]],

         [[ 5.4971e-01,        -inf,        -inf,        -inf],
          [-2.8516e+00, -3.0726e+00,        -inf,        -inf],
          [ 2.6418e+00,  3.7991e+00,  5.5340e+00,        -inf],
          [ 4.9921e+00, -4.0395e+00, -4.5234e+00, -6.0354e+00]],

         [[ 1.0086e+00,        -inf,        -inf,        -inf],
          [ 1.8724e+00,  4.9927e+00,        -inf,        -inf],
          [ 1.1522e+00, -4.4611e+00, -7.2720e+00,        -inf],
          [ 1.3107e+00,  1.0556e+00,  3.7289e+00,  8.3735e+00]],

         ...,

         [[-2.3316e+00,        -inf,        -inf,        -inf],
          [-2.2004e+00, -8.9338e-01,        -inf,        -inf],
          [ 3.2768e+00,  2.0760e+00, -4.4370e+00,        -inf],
          [ 4.0191e-01,  6.1266e+00, -4.8176e-01, -2.9436e+00]],

         [[ 1.5263e+01,        -inf,        -inf,        -inf],
          [-1.5942e+00, -5.9151e+00,        -inf,        -inf],
          [ 2.1063e+00, -2.3327e+00,  4.6978e+00,        -inf],
          [-8.8758e+00, -1.0246e+00,  3.8994e+00, -1.3066e+01]],

         [[ 2.5473e+00,        -inf,        -inf,        -inf],
          [ 1.9737e+00,  2.7064e-01,        -inf,        -inf],
          [-2.1291e+00, -8.0468e+00, -1.4342e+01,        -inf],
          [ 1.7270e+00,  6.7915e+00,  1.2140e+01,  4.2520e+00]]],


        [[[-1.5456e+00,        -inf,        -inf,        -inf],
          [ 2.0954e+00, -1.4700e+00,        -inf,        -inf],
          [-6.6421e+00,  1.3497e+01, -1.3386e+00,        -inf],
          [-7.8483e-01,  8.7543e+00, -7.4246e+00,  3.7680e+00]],

         [[-3.5013e-01,        -inf,        -inf,        -inf],
          [-5.9864e+00, -7.1317e+00,        -inf,        -inf],
          [ 7.0476e-01,  8.8478e+00, -1.2628e+00,        -inf],
          [ 1.1088e+01,  3.6259e-01,  1.0410e+01, -2.0268e+01]],

         [[-4.9897e+00,        -inf,        -inf,        -inf],
          [ 1.0368e+00,  2.6455e+00,        -inf,        -inf],
          [-1.9392e+00, -3.1083e+00, -1.2806e+01,        -inf],
          [ 6.1019e+00, -1.5887e+00, -8.5311e-01,  8.3917e+00]],

         ...,

         [[-9.5044e-01,        -inf,        -inf,        -inf],
          [-3.7168e+00,  9.3201e+00,        -inf,        -inf],
          [ 3.8110e+00, -2.7698e+00, -9.6701e-01,        -inf],
          [-5.4132e+00, -9.1422e+00, -1.5955e+00,  2.7424e+00]],

         [[ 5.8067e+00,        -inf,        -inf,        -inf],
          [ 4.4835e+00,  3.3868e+00,        -inf,        -inf],
          [-4.7350e+00, -2.1166e-01,  2.8126e+00,        -inf],
          [ 5.7561e+00,  3.1802e+00,  4.7893e-01, -4.5050e+00]],

         [[ 1.1195e+00,        -inf,        -inf,        -inf],
          [-1.6991e+00,  7.4804e-01,        -inf,        -inf],
          [ 1.3746e-01,  6.6167e+00, -6.6339e+00,        -inf],
          [ 1.8241e+00,  7.5691e+00,  6.5842e+00, -1.1948e+00]]],


        [[[-6.9392e+00,        -inf,        -inf,        -inf],
          [-1.2937e+00,  5.0836e+00,        -inf,        -inf],
          [-5.7003e+00, -3.3204e+00,  1.2361e+00,        -inf],
          [-7.3642e+00, -9.0674e-01,  6.5471e+00, -9.1733e-01]],

         [[ 4.7674e+00,        -inf,        -inf,        -inf],
          [-1.3402e+00, -2.3921e+00,        -inf,        -inf],
          [-2.4598e+00, -8.0039e+00,  1.7548e+00,        -inf],
          [ 5.9985e+00, -1.7470e+00,  5.5967e+00, -9.2742e+00]],

         [[-8.1888e+00,        -inf,        -inf,        -inf],
          [ 3.9304e+00, -4.9583e+00,        -inf,        -inf],
          [-1.6520e+00,  1.3132e+00, -5.5239e+00,        -inf],
          [ 3.0022e+00,  2.6790e+00,  2.2676e+00,  2.0883e+00]],

         ...,

         [[ 1.9722e+00,        -inf,        -inf,        -inf],
          [-3.8742e+00,  3.8605e-01,        -inf,        -inf],
          [ 1.1454e+01, -6.1875e+00,  2.1113e+00,        -inf],
          [-1.8165e+00, -2.8069e+00,  1.6445e+00, -3.9381e-01]],

         [[ 8.0017e+00,        -inf,        -inf,        -inf],
          [ 5.2146e+00, -5.6536e+00,        -inf,        -inf],
          [-2.1296e+00,  6.2506e+00,  4.7994e+00,        -inf],
          [ 1.6770e+00,  9.6088e-01,  7.9718e+00,  1.5905e+00]],

         [[ 8.0781e+00,        -inf,        -inf,        -inf],
          [ 3.1111e+00,  5.1425e+00,        -inf,        -inf],
          [-1.4193e+01, -6.3780e+00, -1.4449e+01,        -inf],
          [ 8.7725e-01,  8.5572e+00,  4.9617e+00, -1.9047e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.3118e+01,        -inf,        -inf,        -inf],
          [-3.3616e+00, -5.0145e+00,        -inf,        -inf],
          [-2.9262e+00,  2.1655e+00,  4.0617e+00,        -inf],
          [-8.5980e-01,  5.7158e+00,  1.4772e+01,  1.8686e+00]],

         [[-2.0163e+00,        -inf,        -inf,        -inf],
          [-8.2061e+00,  2.0534e+00,        -inf,        -inf],
          [ 3.1094e+00, -2.0309e+00,  7.5782e-01,        -inf],
          [ 1.5776e+01,  4.5795e+00,  1.2862e+01, -1.2630e+00]],

         [[ 4.1208e+00,        -inf,        -inf,        -inf],
          [ 6.3284e-03,  5.6710e+00,        -inf,        -inf],
          [-7.1513e+00, -1.5835e+00,  1.3032e+00,        -inf],
          [ 4.0073e+00,  6.2757e+00, -6.1265e-01,  2.0580e+00]],

         ...,

         [[-8.0092e+00,        -inf,        -inf,        -inf],
          [-3.6920e+00, -4.9571e-01,        -inf,        -inf],
          [ 3.6186e+00,  2.4954e+00, -6.5653e+00,        -inf],
          [ 7.2290e-01, -6.2384e-01, -4.4022e-01,  6.3417e+00]],

         [[ 9.6009e+00,        -inf,        -inf,        -inf],
          [ 6.2867e+00, -6.3945e-01,        -inf,        -inf],
          [ 5.9626e+00, -6.7421e+00,  3.3903e+00,        -inf],
          [ 4.4025e+00,  4.9494e-01, -1.6188e+00,  1.0783e+00]],

         [[ 1.0151e+00,        -inf,        -inf,        -inf],
          [-1.9894e-01, -3.1823e+00,        -inf,        -inf],
          [-9.0259e-01,  1.7837e+00, -3.5674e-02,        -inf],
          [ 3.0527e+00,  3.5856e+00,  6.9988e+00,  5.1076e+00]]],


        [[[ 2.3750e+00,        -inf,        -inf,        -inf],
          [ 1.1126e-01,  3.2067e+00,        -inf,        -inf],
          [ 2.8786e-02,  3.7742e+00, -3.2749e+00,        -inf],
          [-7.1443e+00, -3.0760e+00, -5.9145e-01,  3.4891e-01]],

         [[ 2.5714e+00,        -inf,        -inf,        -inf],
          [ 2.8033e+00, -3.6822e+00,        -inf,        -inf],
          [ 5.3978e-02,  5.6453e+00,  4.7381e+00,        -inf],
          [-1.4641e+00,  5.8126e+00, -2.5477e-01,  2.8659e+00]],

         [[ 9.8960e-01,        -inf,        -inf,        -inf],
          [ 9.6938e+00,  5.5369e+00,        -inf,        -inf],
          [ 3.3993e+00, -1.6523e+00, -8.2746e+00,        -inf],
          [-1.5847e+00,  5.2748e+00, -8.0338e+00,  2.5996e+00]],

         ...,

         [[-4.0670e+00,        -inf,        -inf,        -inf],
          [-2.6154e+00, -4.6439e+00,        -inf,        -inf],
          [ 2.8345e+00,  7.0639e+00, -3.2898e+00,        -inf],
          [-4.0017e+00,  9.2939e-01, -5.3421e+00,  5.9318e+00]],

         [[ 3.3486e+00,        -inf,        -inf,        -inf],
          [-3.9425e-01, -7.1581e+00,        -inf,        -inf],
          [-4.5376e+00, -5.2897e+00, -3.2546e-01,        -inf],
          [-6.4372e-01,  5.9738e-02, -2.7576e+00, -5.4180e+00]],

         [[-3.6359e+00,        -inf,        -inf,        -inf],
          [-1.7676e+00,  5.1935e+00,        -inf,        -inf],
          [-1.2747e+01,  1.1735e+01, -9.7883e+00,        -inf],
          [ 3.5845e+00, -6.6553e+00,  1.0293e+01, -6.0860e+00]]],


        [[[ 4.8412e-01,        -inf,        -inf,        -inf],
          [-2.1062e+00,  5.0673e+00,        -inf,        -inf],
          [ 4.4535e-01,  7.9977e+00,  6.5444e+00,        -inf],
          [-6.1854e+00,  2.8853e+00, -1.5691e+00,  3.4767e+00]],

         [[-2.1814e+00,        -inf,        -inf,        -inf],
          [ 1.2800e+00, -8.1402e+00,        -inf,        -inf],
          [-4.0800e+00,  8.8348e-01, -5.2767e+00,        -inf],
          [-1.1187e-01, -1.9062e+00,  5.9601e+00, -1.4949e+00]],

         [[-4.7007e-01,        -inf,        -inf,        -inf],
          [ 8.7728e+00,  2.1508e+00,        -inf,        -inf],
          [ 2.9698e+00,  2.9653e+00, -5.2843e+00,        -inf],
          [ 3.8312e+00, -2.9434e+00, -2.6703e+00,  4.8055e+00]],

         ...,

         [[-7.8711e+00,        -inf,        -inf,        -inf],
          [ 6.6321e-01,  7.7547e+00,        -inf,        -inf],
          [-8.3991e-01,  5.3349e+00, -1.0908e+01,        -inf],
          [-9.2521e+00, -3.2284e+00, -8.8089e-02,  1.7933e+00]],

         [[ 3.7383e+00,        -inf,        -inf,        -inf],
          [-8.1117e-01, -7.0438e+00,        -inf,        -inf],
          [ 7.4401e-01,  8.2951e+00, -1.9257e+00,        -inf],
          [-1.2221e+00,  2.7667e+00,  4.1929e+00, -2.1913e+00]],

         [[ 1.1731e+00,        -inf,        -inf,        -inf],
          [-9.6188e-01,  3.9717e-01,        -inf,        -inf],
          [-1.4848e+01,  1.7823e+00,  7.4967e-02,        -inf],
          [ 1.8948e+00, -5.9020e+00,  9.0346e+00, -9.7812e-01]]],


        ...,


        [[[-1.2977e+01,        -inf,        -inf,        -inf],
          [-2.5513e+00,  8.0011e-01,        -inf,        -inf],
          [-7.7903e+00,  2.1509e+00, -7.9837e+00,        -inf],
          [ 6.9332e+00, -4.0171e+00,  6.5823e+00,  6.3494e+00]],

         [[ 5.4971e-01,        -inf,        -inf,        -inf],
          [-2.8516e+00, -3.0726e+00,        -inf,        -inf],
          [ 2.6418e+00,  3.7991e+00,  5.5340e+00,        -inf],
          [ 4.9921e+00, -4.0395e+00, -4.5234e+00, -6.0354e+00]],

         [[ 1.0086e+00,        -inf,        -inf,        -inf],
          [ 1.8724e+00,  4.9927e+00,        -inf,        -inf],
          [ 1.1522e+00, -4.4611e+00, -7.2720e+00,        -inf],
          [ 1.3107e+00,  1.0556e+00,  3.7289e+00,  8.3735e+00]],

         ...,

         [[-2.3316e+00,        -inf,        -inf,        -inf],
          [-2.2004e+00, -8.9338e-01,        -inf,        -inf],
          [ 3.2768e+00,  2.0760e+00, -4.4370e+00,        -inf],
          [ 4.0191e-01,  6.1266e+00, -4.8176e-01, -2.9436e+00]],

         [[ 1.5263e+01,        -inf,        -inf,        -inf],
          [-1.5942e+00, -5.9151e+00,        -inf,        -inf],
          [ 2.1063e+00, -2.3327e+00,  4.6978e+00,        -inf],
          [-8.8758e+00, -1.0246e+00,  3.8994e+00, -1.3066e+01]],

         [[ 2.5473e+00,        -inf,        -inf,        -inf],
          [ 1.9737e+00,  2.7064e-01,        -inf,        -inf],
          [-2.1291e+00, -8.0468e+00, -1.4342e+01,        -inf],
          [ 1.7270e+00,  6.7915e+00,  1.2140e+01,  4.2520e+00]]],


        [[[-1.5456e+00,        -inf,        -inf,        -inf],
          [ 2.0954e+00, -1.4700e+00,        -inf,        -inf],
          [-6.6421e+00,  1.3497e+01, -1.3386e+00,        -inf],
          [-7.8483e-01,  8.7543e+00, -7.4246e+00,  3.7680e+00]],

         [[-3.5013e-01,        -inf,        -inf,        -inf],
          [-5.9864e+00, -7.1317e+00,        -inf,        -inf],
          [ 7.0476e-01,  8.8478e+00, -1.2628e+00,        -inf],
          [ 1.1088e+01,  3.6259e-01,  1.0410e+01, -2.0268e+01]],

         [[-4.9897e+00,        -inf,        -inf,        -inf],
          [ 1.0368e+00,  2.6455e+00,        -inf,        -inf],
          [-1.9392e+00, -3.1083e+00, -1.2806e+01,        -inf],
          [ 6.1019e+00, -1.5887e+00, -8.5311e-01,  8.3917e+00]],

         ...,

         [[-9.5044e-01,        -inf,        -inf,        -inf],
          [-3.7168e+00,  9.3201e+00,        -inf,        -inf],
          [ 3.8110e+00, -2.7698e+00, -9.6701e-01,        -inf],
          [-5.4132e+00, -9.1422e+00, -1.5955e+00,  2.7424e+00]],

         [[ 5.8067e+00,        -inf,        -inf,        -inf],
          [ 4.4835e+00,  3.3868e+00,        -inf,        -inf],
          [-4.7350e+00, -2.1166e-01,  2.8126e+00,        -inf],
          [ 5.7561e+00,  3.1802e+00,  4.7893e-01, -4.5050e+00]],

         [[ 1.1195e+00,        -inf,        -inf,        -inf],
          [-1.6991e+00,  7.4804e-01,        -inf,        -inf],
          [ 1.3746e-01,  6.6167e+00, -6.6339e+00,        -inf],
          [ 1.8241e+00,  7.5691e+00,  6.5842e+00, -1.1948e+00]]],


        [[[-6.9392e+00,        -inf,        -inf,        -inf],
          [-1.2937e+00,  5.0836e+00,        -inf,        -inf],
          [-5.7003e+00, -3.3204e+00,  1.2361e+00,        -inf],
          [-7.3642e+00, -9.0674e-01,  6.5471e+00, -9.1733e-01]],

         [[ 4.7674e+00,        -inf,        -inf,        -inf],
          [-1.3402e+00, -2.3921e+00,        -inf,        -inf],
          [-2.4598e+00, -8.0039e+00,  1.7548e+00,        -inf],
          [ 5.9985e+00, -1.7470e+00,  5.5967e+00, -9.2742e+00]],

         [[-8.1888e+00,        -inf,        -inf,        -inf],
          [ 3.9304e+00, -4.9583e+00,        -inf,        -inf],
          [-1.6520e+00,  1.3132e+00, -5.5239e+00,        -inf],
          [ 3.0022e+00,  2.6790e+00,  2.2676e+00,  2.0883e+00]],

         ...,

         [[ 1.9722e+00,        -inf,        -inf,        -inf],
          [-3.8742e+00,  3.8605e-01,        -inf,        -inf],
          [ 1.1454e+01, -6.1875e+00,  2.1113e+00,        -inf],
          [-1.8165e+00, -2.8069e+00,  1.6445e+00, -3.9381e-01]],

         [[ 8.0017e+00,        -inf,        -inf,        -inf],
          [ 5.2146e+00, -5.6536e+00,        -inf,        -inf],
          [-2.1296e+00,  6.2506e+00,  4.7994e+00,        -inf],
          [ 1.6770e+00,  9.6088e-01,  7.9718e+00,  1.5905e+00]],

         [[ 8.0781e+00,        -inf,        -inf,        -inf],
          [ 3.1111e+00,  5.1425e+00,        -inf,        -inf],
          [-1.4193e+01, -6.3780e+00, -1.4449e+01,        -inf],
          [ 8.7725e-01,  8.5572e+00,  4.9617e+00, -1.9047e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.6671e+00,  1.9119e-01,  7.5183e-01,  ...,  5.7815e-01,
            6.7113e-01, -8.6446e-01],
          [ 6.0476e-01, -4.9908e-01,  5.9795e-01,  ..., -1.5717e-01,
           -7.6881e-01,  1.4289e-01],
          [ 7.3676e-01, -8.7367e-01, -7.1227e-01,  ...,  1.7369e-01,
           -1.1658e-01,  3.1445e-01],
          ...,
          [ 3.1983e-01,  9.9182e-01,  7.2982e-01,  ..., -1.4329e-01,
            8.4509e-02, -1.2412e-01],
          [-6.2176e-01,  9.3907e-01, -1.0398e+00,  ...,  4.7205e-01,
           -4.8053e-01,  5.2221e-01],
          [ 8.7311e-01,  1.0369e-01, -1.4764e+00,  ...,  5.0728e-02,
           -1.2818e-01, -7.4418e-02]],

         [[-7.4947e-01, -2.1562e-02,  6.1241e-01,  ...,  5.3804e-01,
            3.7407e-01, -2.8252e-01],
          [-1.2125e-01, -7.2331e-01,  6.6899e-01,  ...,  2.0139e-02,
            1.6521e-01, -3.6299e-01],
          [ 1.1575e+00, -1.2848e+00, -9.3575e-01,  ...,  6.1767e-01,
           -6.7442e-01, -5.4851e-01],
          ...,
          [ 6.8538e-01,  1.3212e+00,  4.6385e-01,  ..., -2.6870e-01,
            3.1553e-01,  4.5298e-01],
          [-1.1185e-01,  4.6011e-01, -8.3085e-01,  ...,  3.7306e-01,
           -4.7382e-01,  2.8796e-01],
          [ 3.8617e-01,  2.0164e-01, -2.0872e-01,  ...,  3.2187e-02,
           -2.8590e-01,  1.4118e-01]],

         [[-5.7843e-01, -2.2408e-01,  2.5192e-01,  ...,  6.5224e-01,
           -3.3852e-01, -2.0505e-01],
          [ 4.3518e-01, -6.1964e-01,  6.6887e-01,  ..., -3.0183e-01,
           -4.9459e-01, -4.2899e-01],
          [ 4.4893e-01, -1.1578e+00, -9.8546e-01,  ...,  1.7057e-01,
           -6.4658e-01, -1.8543e-01],
          ...,
          [ 4.6594e-01,  9.5200e-01,  5.4636e-01,  ..., -1.6557e-01,
            2.4363e-01,  1.7624e-01],
          [-1.0940e-01,  4.2556e-01, -4.8391e-01,  ...,  1.8596e-01,
           -1.8423e-01,  3.1193e-01],
          [-4.8994e-02,  2.0512e-01,  1.1249e-01,  ..., -1.4509e-01,
            1.1460e-01, -2.2055e-03]],

         [[-6.6059e-01, -1.8588e-01, -5.1784e-02,  ...,  4.2475e-01,
           -4.7635e-01, -4.0713e-01],
          [ 5.6130e-01, -6.1613e-01,  6.7032e-01,  ..., -3.1241e-01,
           -5.4101e-01, -3.3428e-01],
          [ 7.9632e-01, -7.6898e-01, -8.1287e-01,  ...,  1.5711e-01,
           -4.2935e-01, -4.6993e-01],
          ...,
          [ 4.5338e-01,  3.8463e-01,  2.1410e-01,  ...,  7.0200e-02,
           -5.7674e-02,  2.4899e-01],
          [ 3.6552e-01, -1.8304e-01, -4.5172e-01,  ...,  2.9720e-02,
           -1.2141e-02,  2.3156e-01],
          [-2.6914e-01,  2.6377e-01, -2.9040e-01,  ...,  2.7798e-01,
            6.7988e-01, -9.4657e-02]]],


        [[[-9.9593e-01,  3.1809e-01, -4.9947e-01,  ...,  1.2098e+00,
           -2.4921e-02, -2.1790e+00],
          [ 8.1335e-01, -4.5379e-02, -2.0496e-01,  ...,  7.5673e-01,
            6.3968e-02, -3.8392e-01],
          [-6.2573e-01, -5.0180e-01,  1.4541e-01,  ...,  4.4860e-02,
            5.4514e-01,  1.0932e+00],
          ...,
          [-7.4235e-01,  1.3682e+00, -1.2581e-01,  ..., -4.1486e-01,
           -3.2751e-01,  2.5709e-01],
          [-9.3162e-01,  6.9358e-01, -7.3762e-02,  ..., -6.5089e-01,
           -7.9029e-02,  2.9758e-01],
          [-3.3783e-01, -1.4661e+00,  1.2679e+00,  ..., -9.1975e-02,
           -3.4396e-01,  8.6027e-01]],

         [[ 6.7403e-02, -1.4240e-02, -2.0385e-01,  ...,  4.3316e-01,
           -1.9510e-02, -1.0686e+00],
          [ 5.7942e-01, -1.8458e-01,  1.1530e-01,  ...,  5.9412e-01,
           -9.8874e-02, -4.4467e-01],
          [-2.2157e-01, -5.7961e-01,  2.5882e-01,  ..., -6.4035e-02,
           -6.5022e-02,  3.6558e-01],
          ...,
          [ 3.2841e-02,  6.9001e-01, -1.9756e-01,  ...,  2.5739e-01,
            4.3572e-02,  5.8631e-01],
          [-6.1480e-01,  3.9788e-01, -6.6046e-02,  ..., -4.8403e-01,
           -4.0053e-01,  4.3797e-01],
          [-1.8359e-02, -6.6178e-01,  6.0766e-01,  ...,  1.4653e-01,
           -7.1998e-01,  2.5942e-01]],

         [[ 7.5791e-02, -6.3267e-02, -1.8608e-01,  ...,  5.1177e-01,
           -2.2905e-01, -7.6109e-01],
          [ 2.8369e-01, -1.8140e-01,  1.4939e-01,  ..., -6.1515e-02,
           -3.8053e-01, -8.5141e-01],
          [-2.5329e-01, -5.5193e-01, -5.0704e-02,  ..., -9.6032e-02,
           -6.3491e-02,  4.8469e-01],
          ...,
          [ 3.7224e-01,  1.6610e-01, -2.3317e-01,  ...,  6.4781e-01,
            2.3305e-01,  5.1838e-01],
          [ 4.0062e-01,  3.5209e-01,  1.7708e-01,  ..., -2.4658e-01,
           -7.0076e-01,  7.8507e-02],
          [ 9.2859e-02, -3.5218e-01,  3.6180e-01,  ...,  2.8277e-01,
           -7.3851e-01,  6.3614e-03]],

         [[-2.2736e-01, -1.2378e-01, -2.0582e-01,  ...,  1.5209e-02,
           -2.2755e-01, -2.6378e-01],
          [ 3.1214e-01, -6.4399e-01,  3.0328e-01,  ...,  4.2448e-01,
           -2.9792e-01, -4.8387e-01],
          [ 1.5603e-01, -3.0627e-01, -2.6308e-02,  ...,  9.0332e-02,
           -4.2782e-01, -3.3212e-01],
          ...,
          [ 8.0228e-01,  5.4567e-01,  1.9802e-01,  ..., -3.4626e-03,
            9.4216e-02,  1.0815e-01],
          [ 1.9448e-01,  1.5902e-01, -4.7251e-02,  ..., -3.3758e-01,
           -4.2588e-01,  2.5811e-01],
          [-1.4679e-01, -3.8458e-01,  4.5597e-01,  ...,  6.6012e-01,
            5.8552e-01, -1.1493e-01]]],


        [[[ 2.9103e-01, -8.4649e-01,  1.4535e+00,  ...,  8.5331e-01,
            1.0571e-01, -2.0575e+00],
          [-1.2148e-01,  6.3649e-01, -1.4949e-01,  ...,  9.8155e-01,
           -5.7202e-01,  1.5368e+00],
          [ 8.0249e-01, -8.9206e-01,  6.3621e-01,  ..., -2.6492e-01,
            4.0577e-01,  2.7352e-01],
          ...,
          [ 7.0162e-01,  1.4410e+00,  8.7533e-01,  ..., -8.6545e-01,
           -5.7694e-01,  2.1048e-01],
          [-1.4237e+00,  1.0817e+00,  8.0149e-01,  ..., -1.5312e-02,
           -7.2488e-01,  3.9462e-01],
          [-8.2374e-01, -1.7152e+00, -9.1206e-01,  ..., -9.3291e-01,
            7.3769e-01, -6.0656e-01]],

         [[ 6.6695e-01,  1.1249e-01,  6.9686e-01,  ..., -7.0467e-01,
           -8.9728e-02,  3.4522e-01],
          [ 4.0653e-02,  5.5505e-01, -2.3729e-02,  ...,  9.6831e-01,
           -6.3336e-01,  1.2151e+00],
          [ 1.0566e+00, -1.0479e+00,  1.1635e-01,  ..., -1.6136e-01,
           -1.1703e-01, -1.2338e-01],
          ...,
          [ 5.9004e-01,  1.1960e+00,  1.1665e+00,  ...,  5.2695e-01,
            2.1999e-01,  4.2323e-01],
          [-1.2937e+00,  7.3016e-01,  6.7986e-01,  ..., -2.3401e-01,
           -8.9038e-01,  4.2838e-01],
          [-2.7758e-01, -3.4644e-01,  3.0534e-01,  ..., -3.8697e-01,
            1.8469e-01, -2.7372e-01]],

         [[ 2.5608e-01, -3.5716e-02,  2.7102e-01,  ..., -1.2352e-01,
           -2.0190e-01,  3.8581e-01],
          [ 4.4668e-01,  2.3639e-01,  3.1207e-01,  ...,  9.2473e-01,
           -6.4134e-01,  3.4812e-01],
          [ 9.1472e-01, -1.2382e+00, -3.1540e-01,  ..., -1.7159e-01,
           -4.4571e-01, -2.3542e-01],
          ...,
          [ 5.0739e-01,  1.1376e+00,  1.0155e+00,  ...,  5.1407e-01,
            1.4312e-01,  3.9709e-01],
          [-8.5602e-01,  6.2217e-02,  4.8342e-01,  ..., -5.3827e-01,
           -1.2353e+00,  1.9340e-01],
          [-2.1848e-01,  2.3696e-01,  1.0355e+00,  ...,  9.6702e-03,
            6.5884e-01,  4.2280e-01]],

         [[ 2.2257e-01,  1.9755e-01, -2.0004e-01,  ..., -5.4145e-01,
            1.1478e-01, -9.1049e-02],
          [ 3.7648e-01, -2.2031e-01,  2.5257e-01,  ...,  6.9692e-01,
           -2.3489e-01,  1.2318e-02],
          [ 2.6356e-01, -5.3630e-01, -2.7543e-01,  ..., -5.7182e-01,
           -5.4432e-03, -9.2964e-01],
          ...,
          [ 8.3061e-02,  3.9322e-01,  3.4935e-01,  ...,  5.2805e-01,
            2.9443e-01,  2.7513e-01],
          [-3.0216e-01, -5.2936e-01,  4.2841e-01,  ..., -5.1543e-01,
           -8.6584e-01, -2.7559e-01],
          [-7.3303e-01, -3.1902e-01,  4.1547e-01,  ...,  5.4840e-02,
            1.4448e+00,  3.7196e-01]]],


        ...,


        [[[-1.9612e+00, -5.2963e-01,  1.7679e+00,  ..., -1.5583e-01,
            2.4186e-01, -6.8287e-01],
          [ 6.1267e-01,  1.1891e+00,  6.1816e-02,  ...,  2.0685e-01,
           -6.4070e-01,  2.2435e-01],
          [ 1.0471e+00, -4.3493e-01,  6.4210e-01,  ..., -3.2565e-01,
            2.4162e-01,  1.0694e+00],
          ...,
          [ 1.2382e+00,  1.0444e+00,  2.6023e-01,  ..., -5.9549e-01,
           -1.9125e-01,  1.8300e-01],
          [-8.7986e-01,  2.9715e-01,  1.3847e-01,  ...,  1.2231e+00,
           -1.3668e+00,  4.8018e-01],
          [-7.7295e-01, -9.7384e-01, -8.1130e-02,  ..., -4.2010e-01,
            1.9126e-04, -8.2718e-01]],

         [[-1.0023e-01, -1.1814e-01,  1.0522e+00,  ...,  2.3179e-01,
           -1.4546e-01, -8.5236e-01],
          [ 3.8964e-01,  5.1829e-01, -1.3072e-01,  ..., -8.7498e-02,
            4.7606e-01,  3.3235e-01],
          [ 8.3746e-01, -9.2040e-01, -8.0993e-02,  ...,  1.6909e-01,
           -4.1564e-01, -5.4072e-01],
          ...,
          [ 3.7331e-01,  7.0433e-01, -6.2852e-02,  ..., -2.9889e-01,
            1.3488e-01,  1.0487e+00],
          [-8.2906e-01,  1.3333e-01,  2.7146e-01,  ...,  8.3828e-01,
           -8.3635e-01,  7.8391e-01],
          [-7.9377e-02, -1.8396e-01,  6.1544e-01,  ..., -3.7512e-01,
           -5.3745e-01, -9.1928e-02]],

         [[ 1.7942e-01, -7.4122e-02,  6.4544e-01,  ...,  3.8096e-01,
           -5.6382e-01, -8.6234e-01],
          [ 4.6546e-01,  8.4532e-02, -2.0641e-01,  ..., -3.4471e-01,
           -1.2153e-01,  3.0642e-01],
          [ 7.1607e-01, -5.6644e-01, -2.8099e-02,  ..., -2.8732e-01,
           -1.3765e-01,  2.8676e-01],
          ...,
          [ 5.3182e-01,  7.0231e-01,  2.0380e-02,  ..., -1.3801e-01,
           -8.7518e-03,  7.7345e-01],
          [-1.9503e-01,  1.6497e-01,  5.8094e-01,  ...,  2.1810e-01,
           -1.0054e+00,  2.5163e-01],
          [ 4.5252e-02, -3.7109e-01,  3.7491e-01,  ..., -4.0146e-01,
           -1.5991e-01, -3.2314e-01]],

         [[-6.3067e-01, -2.5609e-01,  2.3585e-01,  ..., -3.7591e-01,
           -2.8994e-01, -3.5628e-01],
          [ 4.1827e-01,  2.9745e-01, -2.5298e-02,  ..., -9.0930e-02,
           -1.9774e-01,  2.9040e-01],
          [ 7.3223e-01,  1.6542e-01, -5.2882e-01,  ..., -1.6389e-01,
           -6.1676e-01, -1.9039e-01],
          ...,
          [ 2.7642e-01,  3.9132e-01,  1.0225e-01,  ...,  4.2739e-02,
            4.3250e-03,  7.8523e-01],
          [-6.3222e-03,  6.0784e-02,  6.4462e-01,  ..., -9.3875e-02,
           -7.0301e-01,  2.2904e-01],
          [ 9.2384e-01,  5.2694e-02,  2.5025e-01,  ..., -2.3529e-01,
            4.8884e-01, -1.5594e-01]]],


        [[[-1.2157e+00, -1.0285e-01,  9.1534e-01,  ..., -4.0863e-01,
            4.7485e-03, -1.0572e+00],
          [-1.9164e-01, -9.4979e-01,  9.9736e-01,  ..., -7.3530e-01,
           -1.0456e+00, -3.1846e-01],
          [ 5.0859e-01,  5.1531e-01, -1.9173e-01,  ...,  7.6607e-01,
            1.7633e-03,  2.6235e+00],
          ...,
          [ 4.5870e-01,  1.6597e+00, -2.0129e-01,  ..., -7.5749e-01,
            1.4864e-01,  2.8103e-01],
          [-6.9600e-01,  1.7327e+00,  6.8328e-02,  ...,  3.5650e-01,
           -1.8964e-01,  1.0108e+00],
          [-8.5880e-01, -1.2467e+00,  1.4161e-01,  ...,  3.5387e-01,
            3.6679e-01,  1.3716e-01]],

         [[-3.0939e-01, -4.4579e-01,  7.5367e-01,  ..., -9.0652e-02,
           -4.0213e-01, -8.3417e-01],
          [ 2.6499e-01, -9.8927e-01,  8.2690e-01,  ..., -2.7439e-01,
           -9.8442e-01, -2.6428e-01],
          [ 3.7317e-01, -2.3850e-01,  5.1280e-02,  ...,  1.0339e+00,
           -4.7335e-01,  4.9725e-01],
          ...,
          [ 1.0838e+00,  1.0463e+00, -1.2018e-02,  ...,  1.0795e+00,
            2.5554e-01,  3.2487e-01],
          [-7.2310e-01,  6.4493e-01,  2.2286e-01,  ...,  3.6136e-01,
           -4.5889e-01,  9.6176e-01],
          [-5.3741e-02, -5.5520e-01,  8.2679e-01,  ..., -3.7274e-01,
            1.6393e-02,  3.7308e-01]],

         [[ 7.8065e-01, -8.1157e-01,  3.8324e-01,  ...,  3.7205e-01,
           -1.0529e+00, -5.6733e-01],
          [ 5.8172e-01, -1.0117e+00,  6.5423e-01,  ...,  5.4237e-02,
           -1.0138e+00, -3.0720e-01],
          [ 3.6568e-01, -1.5262e-01, -1.4695e-01,  ...,  6.3175e-01,
           -3.8735e-01,  8.4636e-01],
          ...,
          [ 5.6044e-01,  9.6499e-01,  9.9452e-02,  ..., -1.1028e-01,
           -1.6037e-01,  2.2571e-01],
          [-1.3371e-01, -5.6585e-01,  3.0458e-01,  ..., -3.7494e-01,
           -9.3124e-01,  5.6012e-01],
          [ 1.6495e-01, -4.2204e-01,  7.6469e-01,  ..., -3.5226e-01,
            6.7323e-02,  3.8160e-01]],

         [[ 2.2727e-01, -5.0779e-01,  8.1448e-03,  ..., -1.2589e-01,
           -8.1968e-01, -5.3518e-01],
          [ 3.5340e-01, -9.8213e-01,  6.4627e-01,  ..., -1.5106e-01,
           -1.1418e+00, -4.5070e-01],
          [ 4.3110e-01,  2.2339e-01, -2.4047e-02,  ..., -2.3934e-01,
           -3.7627e-02,  7.3581e-01],
          ...,
          [ 4.9138e-01,  1.8314e-01,  5.0729e-01,  ...,  1.0109e-01,
           -5.2704e-01,  1.1067e-01],
          [-3.5061e-01,  7.6376e-02,  1.5443e-01,  ...,  4.8611e-02,
           -5.0720e-01,  6.8930e-01],
          [ 3.4487e-02, -3.2332e-01,  2.4211e-01,  ...,  2.1461e-01,
            2.8394e-01,  1.5312e-01]]],


        [[[-6.1722e-01, -3.1099e-01,  5.5470e-01,  ...,  1.4344e-01,
           -7.7511e-01, -1.6435e+00],
          [ 6.7335e-02, -1.1904e+00,  2.4564e-01,  ...,  5.6828e-01,
           -1.2877e+00, -2.6462e-01],
          [ 1.0348e+00, -5.0319e-01, -8.0368e-01,  ..., -1.3006e+00,
            2.0779e-02,  1.3696e+00],
          ...,
          [ 7.7190e-01,  5.1247e-01,  7.5598e-01,  ..., -1.6002e+00,
           -9.8440e-01,  8.2598e-01],
          [-8.7933e-01, -3.6698e-01, -4.7002e-01,  ...,  1.1560e-02,
           -3.4501e-01,  1.3159e+00],
          [ 1.5672e-02, -1.1970e+00, -1.0130e+00,  ...,  6.4985e-02,
           -3.7893e-01,  5.1962e-01]],

         [[ 5.0474e-01,  3.3196e-01,  9.2852e-02,  ..., -9.8395e-01,
           -6.3331e-01, -3.4246e-01],
          [ 1.5202e-01, -5.7843e-01,  2.9387e-01,  ..., -1.2692e-01,
           -9.1819e-01, -5.5813e-02],
          [ 9.6071e-01, -7.7456e-01, -8.0320e-01,  ..., -8.4704e-01,
           -1.7736e-01,  7.2508e-01],
          ...,
          [ 4.7603e-01,  5.3288e-01,  4.1073e-01,  ...,  1.2761e-01,
           -2.6081e-01,  8.8990e-01],
          [-9.1010e-01, -2.5912e-01, -5.9717e-01,  ...,  1.1887e-01,
           -2.4944e-01,  1.2496e+00],
          [ 1.4384e-01, -3.0454e-01,  2.0398e-01,  ..., -4.4425e-01,
           -7.9829e-01,  3.7360e-01]],

         [[-2.6564e-01,  1.9400e-01, -4.9592e-01,  ..., -9.7395e-02,
           -8.1526e-01, -4.8942e-01],
          [ 4.8381e-01, -6.3364e-01,  7.5053e-03,  ...,  1.2539e-01,
           -1.2436e+00, -5.8282e-01],
          [ 6.4952e-01, -1.1324e+00, -5.1059e-01,  ..., -3.9544e-01,
           -5.2389e-01,  4.5898e-02],
          ...,
          [ 3.6241e-01,  5.0318e-01,  6.6582e-01,  ..., -1.1597e+00,
           -5.6747e-01,  4.8901e-01],
          [-8.9621e-01, -9.0219e-02, -3.8423e-01,  ...,  3.7733e-02,
           -7.1838e-01,  8.6405e-01],
          [ 2.0023e-02, -4.7152e-02,  4.3079e-01,  ..., -3.9781e-01,
           -5.9553e-01,  7.5284e-02]],

         [[-3.0403e-01,  1.6275e-02, -7.3733e-01,  ..., -1.2094e-01,
           -4.9574e-01, -4.6873e-01],
          [ 3.8672e-01, -7.2104e-01,  3.9594e-02,  ...,  1.9806e-01,
           -1.1783e+00, -4.4486e-01],
          [ 3.7881e-01, -8.1811e-01, -1.2428e-01,  ..., -5.9426e-01,
           -4.3961e-01,  2.7235e-01],
          ...,
          [ 2.2357e-01,  1.0932e-01,  3.8681e-01,  ..., -2.0086e-01,
           -4.5860e-01,  1.3458e-01],
          [-3.1524e-01, -3.0971e-01, -2.4526e-01,  ..., -2.7906e-01,
           -3.9129e-01,  6.9573e-01],
          [-1.3757e-01,  6.4494e-02,  3.5065e-01,  ..., -1.8580e-01,
           -3.3776e-01,  1.2649e-02]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.6671e+00,  1.9119e-01,  7.5183e-01,  ...,  5.0728e-02,
          -1.2818e-01, -7.4418e-02],
         [-7.4947e-01, -2.1562e-02,  6.1241e-01,  ...,  3.2187e-02,
          -2.8590e-01,  1.4118e-01],
         [-5.7843e-01, -2.2408e-01,  2.5192e-01,  ..., -1.4509e-01,
           1.1460e-01, -2.2055e-03],
         [-6.6059e-01, -1.8588e-01, -5.1784e-02,  ...,  2.7798e-01,
           6.7988e-01, -9.4657e-02]],

        [[-9.9593e-01,  3.1809e-01, -4.9947e-01,  ..., -9.1975e-02,
          -3.4396e-01,  8.6027e-01],
         [ 6.7403e-02, -1.4240e-02, -2.0385e-01,  ...,  1.4653e-01,
          -7.1998e-01,  2.5942e-01],
         [ 7.5791e-02, -6.3267e-02, -1.8608e-01,  ...,  2.8277e-01,
          -7.3851e-01,  6.3614e-03],
         [-2.2736e-01, -1.2378e-01, -2.0582e-01,  ...,  6.6012e-01,
           5.8552e-01, -1.1493e-01]],

        [[ 2.9103e-01, -8.4649e-01,  1.4535e+00,  ..., -9.3291e-01,
           7.3769e-01, -6.0656e-01],
         [ 6.6695e-01,  1.1249e-01,  6.9686e-01,  ..., -3.8697e-01,
           1.8469e-01, -2.7372e-01],
         [ 2.5608e-01, -3.5716e-02,  2.7102e-01,  ...,  9.6702e-03,
           6.5884e-01,  4.2280e-01],
         [ 2.2257e-01,  1.9755e-01, -2.0004e-01,  ...,  5.4840e-02,
           1.4448e+00,  3.7196e-01]],

        ...,

        [[-1.9612e+00, -5.2963e-01,  1.7679e+00,  ..., -4.2010e-01,
           1.9126e-04, -8.2718e-01],
         [-1.0023e-01, -1.1814e-01,  1.0522e+00,  ..., -3.7512e-01,
          -5.3745e-01, -9.1928e-02],
         [ 1.7942e-01, -7.4122e-02,  6.4544e-01,  ..., -4.0146e-01,
          -1.5991e-01, -3.2314e-01],
         [-6.3067e-01, -2.5609e-01,  2.3585e-01,  ..., -2.3529e-01,
           4.8884e-01, -1.5594e-01]],

        [[-1.2157e+00, -1.0285e-01,  9.1534e-01,  ...,  3.5387e-01,
           3.6679e-01,  1.3716e-01],
         [-3.0939e-01, -4.4579e-01,  7.5367e-01,  ..., -3.7274e-01,
           1.6393e-02,  3.7308e-01],
         [ 7.8065e-01, -8.1157e-01,  3.8324e-01,  ..., -3.5226e-01,
           6.7323e-02,  3.8160e-01],
         [ 2.2727e-01, -5.0779e-01,  8.1448e-03,  ...,  2.1461e-01,
           2.8394e-01,  1.5312e-01]],

        [[-6.1722e-01, -3.1099e-01,  5.5470e-01,  ...,  6.4985e-02,
          -3.7893e-01,  5.1962e-01],
         [ 5.0474e-01,  3.3196e-01,  9.2852e-02,  ..., -4.4425e-01,
          -7.9829e-01,  3.7360e-01],
         [-2.6564e-01,  1.9400e-01, -4.9592e-01,  ..., -3.9781e-01,
          -5.9553e-01,  7.5284e-02],
         [-3.0403e-01,  1.6275e-02, -7.3733e-01,  ..., -1.8580e-01,
          -3.3776e-01,  1.2649e-02]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.5210,  0.2648,  0.1610,  ...,  0.0237, -0.5577, -0.7006],
         [ 0.2060,  0.2878,  0.3221,  ..., -0.1559, -0.2859, -0.8879],
         [-0.0435,  0.1338,  0.3011,  ...,  0.2072, -0.3310, -0.5912],
         [-0.0677,  0.2742,  0.1085,  ...,  0.2854, -0.2392, -0.3543]],

        [[ 0.7153,  0.1948,  0.3585,  ..., -0.0651, -0.2749, -0.6515],
         [ 0.5791,  0.3427,  0.5164,  ..., -0.0405, -0.2667, -0.4560],
         [ 0.6852,  0.4104,  0.3315,  ...,  0.1020, -0.2075, -0.4771],
         [ 0.4728,  0.2764,  0.3788,  ...,  0.0100, -0.2076, -0.7091]],

        [[ 0.3894,  0.5964, -0.1958,  ...,  0.0612,  0.5895, -0.8937],
         [ 0.6134,  0.7147, -0.1151,  ...,  0.1801,  0.4224, -0.3004],
         [ 0.5787,  0.7952,  0.0757,  ...,  0.2778, -0.2345, -0.3033],
         [ 0.2030,  0.5042, -0.0651,  ..., -0.2423, -0.2364, -0.3104]],

        ...,

        [[ 0.3299,  0.4593,  0.3620,  ...,  0.5509, -0.3176, -0.8464],
         [ 0.4424,  0.4283,  0.2808,  ..., -0.0092, -0.3625, -0.7248],
         [ 0.5407,  0.2935,  0.1719,  ...,  0.4981, -0.1091, -0.4660],
         [ 0.1322,  0.0836,  0.0581,  ...,  0.3340, -0.2806, -0.0926]],

        [[-0.1702,  0.0483,  0.1147,  ...,  0.1613, -0.6101, -0.8292],
         [-0.1218, -0.2398,  0.0569,  ...,  0.2239, -0.2878, -0.6069],
         [-0.0134,  0.3890, -0.1251,  ...,  0.0398, -0.2555, -0.5483],
         [-0.0951,  0.0988, -0.0209,  ...,  0.0915, -0.2312, -0.3673]],

        [[ 0.1816,  0.1722,  0.0030,  ..., -0.0743, -0.2838, -1.1572],
         [ 0.5211, -0.1100,  0.1905,  ..., -0.1126, -0.0690, -0.6450],
         [ 0.5347,  0.5049, -0.0182,  ...,  0.1735, -0.3129, -0.6021],
         [ 0.2806,  0.3079,  0.1629,  ...,  0.2588, -0.2884, -0.2129]]],
       grad_fn=<ViewBackward0>)
context vecs:
 tensor([[[-0.5210,  0.2648,  0.1610,  ...,  0.0237, -0.5577, -0.7006],
         [ 0.2060,  0.2878,  0.3221,  ..., -0.1559, -0.2859, -0.8879],
         [-0.0435,  0.1338,  0.3011,  ...,  0.2072, -0.3310, -0.5912],
         [-0.0677,  0.2742,  0.1085,  ...,  0.2854, -0.2392, -0.3543]],

        [[ 0.7153,  0.1948,  0.3585,  ..., -0.0651, -0.2749, -0.6515],
         [ 0.5791,  0.3427,  0.5164,  ..., -0.0405, -0.2667, -0.4560],
         [ 0.6852,  0.4104,  0.3315,  ...,  0.1020, -0.2075, -0.4771],
         [ 0.4728,  0.2764,  0.3788,  ...,  0.0100, -0.2076, -0.7091]],

        [[ 0.3894,  0.5964, -0.1958,  ...,  0.0612,  0.5895, -0.8937],
         [ 0.6134,  0.7147, -0.1151,  ...,  0.1801,  0.4224, -0.3004],
         [ 0.5787,  0.7952,  0.0757,  ...,  0.2778, -0.2345, -0.3033],
         [ 0.2030,  0.5042, -0.0651,  ..., -0.2423, -0.2364, -0.3104]],

        ...,

        [[ 0.3299,  0.4593,  0.3620,  ...,  0.5509, -0.3176, -0.8464],
         [ 0.4424,  0.4283,  0.2808,  ..., -0.0092, -0.3625, -0.7248],
         [ 0.5407,  0.2935,  0.1719,  ...,  0.4981, -0.1091, -0.4660],
         [ 0.1322,  0.0836,  0.0581,  ...,  0.3340, -0.2806, -0.0926]],

        [[-0.1702,  0.0483,  0.1147,  ...,  0.1613, -0.6101, -0.8292],
         [-0.1218, -0.2398,  0.0569,  ...,  0.2239, -0.2878, -0.6069],
         [-0.0134,  0.3890, -0.1251,  ...,  0.0398, -0.2555, -0.5483],
         [-0.0951,  0.0988, -0.0209,  ...,  0.0915, -0.2312, -0.3673]],

        [[ 0.1816,  0.1722,  0.0030,  ..., -0.0743, -0.2838, -1.1572],
         [ 0.5211, -0.1100,  0.1905,  ..., -0.1126, -0.0690, -0.6450],
         [ 0.5347,  0.5049, -0.0182,  ...,  0.1735, -0.3129, -0.6021],
         [ 0.2806,  0.3079,  0.1629,  ...,  0.2588, -0.2884, -0.2129]]],
       grad_fn=<ViewBackward0>)

shape of context vec:  torch.Size([8, 4, 768])
