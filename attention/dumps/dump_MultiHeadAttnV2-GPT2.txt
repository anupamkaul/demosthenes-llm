current dir:  /Users/anupkaul/akaul_git/demosthenes-llm/attention 

module path to be used for import:  /Users/anupkaul/akaul_git/demosthenes-llm/attention/../tokenizers/ 

Token IDs:
 tensor([[   40,   367,  2885,  1464],
        [ 1807,  3619,   402,   271],
        [10899,  2138,   257,  7026],
        [15632,   438,  2016,   257],
        [  922,  5891,  1576,   438],
        [  568,   340,   373,   645],
        [ 1049,  5975,   284,   502],
        [  284,  3285,   326,    11]])

Inputs shape:
 torch.Size([8, 4])
token embedding layer:
 Embedding(50257, 768) 

weights of this layer: 
 Parameter containing:
tensor([[-1.4714,  0.7842, -0.1833,  ..., -0.2711, -0.4956, -1.2463],
        [ 1.5308,  2.1863, -1.2475,  ...,  0.6973, -0.8852,  0.3055],
        [ 0.6028, -1.7602, -0.0307,  ..., -0.8255,  1.5107, -0.4305],
        ...,
        [ 1.6145, -0.5164, -0.3943,  ...,  0.0637, -1.2336,  1.0224],
        [ 1.7403,  1.3269, -0.0199,  ..., -0.5808, -0.8209,  0.5449],
        [ 0.4513, -1.3701,  0.2191,  ...,  0.8437,  2.1269, -0.9069]],
       requires_grad=True) 

token embedding shape:  torch.Size([8, 4, 768])
shape of positional embedding:  torch.Size([4, 768])
input embeddings are now (with positional embedding inserted) : 
 tensor([[[-0.8725, -0.6117, -0.3569,  ..., -1.0419,  0.3982, -1.2014],
         [ 1.1496, -0.0463,  1.4116,  ..., -1.2209,  0.4490, -1.8952],
         [-3.1524,  3.4159,  2.2660,  ...,  0.5055, -1.4290,  0.4213],
         [ 0.5760, -0.6848,  1.0649,  ..., -0.1465,  1.6038,  2.3581]],

        [[ 0.5424, -0.6584,  0.1440,  ...,  0.5368, -0.7893, -0.4281],
         [ 0.7354, -0.9235,  0.2273,  ...,  0.4795, -0.3041, -0.2899],
         [-0.3702,  0.8700,  2.5632,  ...,  1.2771, -1.5659, -2.0019],
         [-0.5182, -1.8988,  0.5284,  ...,  1.0584,  0.6464,  3.6383]],

        [[-0.1542, -2.0102, -1.3154,  ...,  0.5915, -1.7004,  0.1588],
         [ 0.3236,  1.5342, -2.2387,  ..., -1.8572, -0.7382, -1.5258],
         [-2.8152,  1.9956,  0.8254,  ...,  1.7559, -3.8878,  0.8733],
         [-0.8015,  1.8869,  2.0082,  ..., -0.8526,  0.4439,  2.1781]],

        ...,

        [[ 1.9341, -1.6319,  1.0015,  ..., -3.2686, -1.5594, -1.0909],
         [ 1.7048,  0.0999,  1.6434,  ...,  0.2274, -0.2358,  0.2691],
         [-3.4323,  1.2074,  1.3974,  ..., -0.9359, -2.8525,  2.3968],
         [ 1.6042, -2.0901, -0.2627,  ...,  1.5092,  2.3206,  2.5009]],

        [[-0.1847, -1.2486, -1.0651,  ..., -0.8988,  1.7098, -2.2661],
         [-0.9216, -0.6313,  2.7779,  ..., -0.3216, -0.6260, -0.4117],
         [-3.4285,  1.4367,  0.6086,  ..., -0.5518, -4.2382, -0.2032],
         [ 2.5656, -0.8710,  0.7336,  ..., -0.3798,  1.5546,  3.3875]],

        [[-2.2606, -0.3541, -1.4994,  ..., -0.6747, -2.4854, -1.2424],
         [-1.1846, -1.0889, -1.6948,  ...,  0.2811,  0.6114,  0.0628],
         [-1.7460,  0.5090,  3.7040,  ...,  0.9813, -1.1672,  0.0806],
         [ 1.0005, -0.6855,  2.5482,  ..., -0.7682,  1.5666,  1.1456]]],
       grad_fn=<AddBackward0>) 

input_embeddings shape (adding positional embeddings) is 
 torch.Size([8, 4, 768])
batch shape:  torch.Size([8, 4, 768]) 

batch: 
 tensor([[[-0.8725, -0.6117, -0.3569,  ..., -1.0419,  0.3982, -1.2014],
         [ 1.1496, -0.0463,  1.4116,  ..., -1.2209,  0.4490, -1.8952],
         [-3.1524,  3.4159,  2.2660,  ...,  0.5055, -1.4290,  0.4213],
         [ 0.5760, -0.6848,  1.0649,  ..., -0.1465,  1.6038,  2.3581]],

        [[ 0.5424, -0.6584,  0.1440,  ...,  0.5368, -0.7893, -0.4281],
         [ 0.7354, -0.9235,  0.2273,  ...,  0.4795, -0.3041, -0.2899],
         [-0.3702,  0.8700,  2.5632,  ...,  1.2771, -1.5659, -2.0019],
         [-0.5182, -1.8988,  0.5284,  ...,  1.0584,  0.6464,  3.6383]],

        [[-0.1542, -2.0102, -1.3154,  ...,  0.5915, -1.7004,  0.1588],
         [ 0.3236,  1.5342, -2.2387,  ..., -1.8572, -0.7382, -1.5258],
         [-2.8152,  1.9956,  0.8254,  ...,  1.7559, -3.8878,  0.8733],
         [-0.8015,  1.8869,  2.0082,  ..., -0.8526,  0.4439,  2.1781]],

        ...,

        [[ 1.9341, -1.6319,  1.0015,  ..., -3.2686, -1.5594, -1.0909],
         [ 1.7048,  0.0999,  1.6434,  ...,  0.2274, -0.2358,  0.2691],
         [-3.4323,  1.2074,  1.3974,  ..., -0.9359, -2.8525,  2.3968],
         [ 1.6042, -2.0901, -0.2627,  ...,  1.5092,  2.3206,  2.5009]],

        [[-0.1847, -1.2486, -1.0651,  ..., -0.8988,  1.7098, -2.2661],
         [-0.9216, -0.6313,  2.7779,  ..., -0.3216, -0.6260, -0.4117],
         [-3.4285,  1.4367,  0.6086,  ..., -0.5518, -4.2382, -0.2032],
         [ 2.5656, -0.8710,  0.7336,  ..., -0.3798,  1.5546,  3.3875]],

        [[-2.2606, -0.3541, -1.4994,  ..., -0.6747, -2.4854, -1.2424],
         [-1.1846, -1.0889, -1.6948,  ...,  0.2811,  0.6114,  0.0628],
         [-1.7460,  0.5090,  3.7040,  ...,  0.9813, -1.1672,  0.0806],
         [ 1.0005, -0.6855,  2.5482,  ..., -0.7682,  1.5666,  1.1456]]],
       grad_fn=<AddBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 6.2545e+00,        -inf,        -inf,        -inf],
          [ 1.1541e+00,  2.4862e+00,        -inf,        -inf],
          [ 3.8189e+00, -1.8550e+00, -2.7722e+00,        -inf],
          [ 5.1649e+00, -4.5731e+00,  2.3423e+00, -3.7367e+00]],

         [[-2.0097e+00,        -inf,        -inf,        -inf],
          [-3.9195e+00, -2.2445e+00,        -inf,        -inf],
          [ 1.7625e+00, -4.4332e+00,  8.4356e-01,        -inf],
          [-4.3469e-01,  5.2741e+00,  1.5106e-01,  2.1621e+00]],

         [[ 8.2856e+00,        -inf,        -inf,        -inf],
          [ 3.9209e+00,  8.3901e+00,        -inf,        -inf],
          [-1.1635e+01, -1.0591e+01,  8.2555e-01,        -inf],
          [ 9.1362e+00,  1.8340e+00, -5.4291e+00,  8.0325e+00]],

         ...,

         [[-4.4508e-01,        -inf,        -inf,        -inf],
          [-1.3285e+01,  1.4315e+00,        -inf,        -inf],
          [ 4.1462e+00, -8.0108e+00, -7.9593e+00,        -inf],
          [-3.1404e+00, -3.0544e+00,  9.1568e+00,  5.7499e+00]],

         [[ 2.9442e+00,        -inf,        -inf,        -inf],
          [-5.0809e+00,  6.6632e+00,        -inf,        -inf],
          [-7.8616e+00,  1.8406e-01,  1.4971e+00,        -inf],
          [ 2.4926e+00, -9.3156e+00, -3.5131e+00, -9.6208e-01]],

         [[ 8.1253e+00,        -inf,        -inf,        -inf],
          [ 8.8045e+00, -1.4969e+00,        -inf,        -inf],
          [ 7.7993e+00,  1.7207e-01,  2.1458e+00,        -inf],
          [-4.8712e+00, -4.0101e+00, -7.4667e+00,  8.4528e+00]]],


        [[[-6.2129e-01,        -inf,        -inf,        -inf],
          [-2.2745e+00, -5.0477e-01,        -inf,        -inf],
          [ 6.1642e+00, -2.5525e+00, -2.1484e+00,        -inf],
          [ 1.1654e+01,  1.4555e+00,  4.1719e+00,  3.9059e+00]],

         [[ 4.8080e+00,        -inf,        -inf,        -inf],
          [ 4.6527e-01,  6.2725e+00,        -inf,        -inf],
          [ 1.6487e+00, -2.3390e+00, -4.0497e-01,        -inf],
          [-4.0520e+00, -8.4620e-01, -2.1715e+00, -3.8767e+00]],

         [[ 3.5252e+00,        -inf,        -inf,        -inf],
          [ 1.4354e+00,  1.1272e-01,        -inf,        -inf],
          [-2.2885e+00,  1.2697e+00,  7.2239e+00,        -inf],
          [ 2.1511e+00,  4.5042e+00, -1.6466e-01, -3.1784e+00]],

         ...,

         [[ 6.4323e-01,        -inf,        -inf,        -inf],
          [ 2.5409e+00, -1.8468e+00,        -inf,        -inf],
          [-1.9390e+00,  1.1044e-01,  5.9338e+00,        -inf],
          [ 1.2824e+00, -5.3561e+00, -1.7852e+00,  1.0841e+01]],

         [[ 3.8382e+00,        -inf,        -inf,        -inf],
          [-6.8231e+00,  5.3904e+00,        -inf,        -inf],
          [ 3.2844e+00,  1.0587e+00, -1.9624e+00,        -inf],
          [ 1.8502e+00,  1.1088e+01,  2.9437e+00,  1.6450e+00]],

         [[ 1.0253e+01,        -inf,        -inf,        -inf],
          [ 7.1702e+00, -5.4109e+00,        -inf,        -inf],
          [-6.0062e+00,  6.0397e-01,  1.0422e+01,        -inf],
          [-9.0584e-01, -4.5614e+00,  1.0582e-01,  1.0238e+01]]],


        [[[ 3.1050e+00,        -inf,        -inf,        -inf],
          [-3.6093e-02,  1.4526e+00,        -inf,        -inf],
          [-6.1986e+00, -7.6923e+00, -1.4984e+00,        -inf],
          [ 2.8365e+00, -4.1717e+00,  7.9036e+00, -2.5390e+00]],

         [[-3.8252e+00,        -inf,        -inf,        -inf],
          [-8.4721e+00, -9.0153e+00,        -inf,        -inf],
          [-7.4142e-01,  1.7392e-01, -5.8212e+00,        -inf],
          [ 4.7855e+00,  2.3645e+00, -2.2493e+00, -4.3426e+00]],

         [[ 1.1026e+00,        -inf,        -inf,        -inf],
          [-6.8033e+00, -1.0722e+00,        -inf,        -inf],
          [ 3.0893e+00,  4.4546e+00,  2.3167e+00,        -inf],
          [ 6.3542e+00,  8.0599e-01, -6.0721e-01,  2.5721e+00]],

         ...,

         [[-2.5007e+00,        -inf,        -inf,        -inf],
          [-7.1458e+00, -5.4867e+00,        -inf,        -inf],
          [-1.2713e+00,  6.5941e+00,  4.5816e+00,        -inf],
          [-1.2634e+00,  4.4397e+00,  3.4572e+00, -1.0912e+00]],

         [[-2.1860e+00,        -inf,        -inf,        -inf],
          [-2.9438e+00,  1.1156e+01,        -inf,        -inf],
          [-1.2382e+00,  3.6626e-01, -3.4941e+00,        -inf],
          [-1.6801e+00, -1.2381e+00,  4.5302e+00, -3.2304e+00]],

         [[ 4.8909e+00,        -inf,        -inf,        -inf],
          [ 7.8098e+00,  2.3336e+00,        -inf,        -inf],
          [-3.9018e-01, -3.7622e+00, -3.7933e+00,        -inf],
          [-3.8560e+00, -1.3023e+00, -4.8615e+00,  8.6209e+00]]],


        ...,


        [[[-2.5312e-01,        -inf,        -inf,        -inf],
          [-1.3317e-01, -1.9177e+00,        -inf,        -inf],
          [-1.5854e+00, -3.2852e+00, -1.0025e+01,        -inf],
          [ 1.3871e+00, -2.2262e-01, -1.4566e+00, -4.7164e+00]],

         [[ 3.3905e+00,        -inf,        -inf,        -inf],
          [ 1.0956e+01, -5.2763e+00,        -inf,        -inf],
          [ 7.6966e+00, -2.4760e+00,  9.6425e+00,        -inf],
          [-1.8555e+00,  3.5773e+00, -2.1191e+00, -2.4294e+00]],

         [[ 2.5829e+00,        -inf,        -inf,        -inf],
          [ 7.4538e-01,  7.0395e+00,        -inf,        -inf],
          [-2.9948e+00, -4.3931e+00,  1.5995e+01,        -inf],
          [ 4.6879e+00, -4.0339e-01, -6.0882e+00,  7.8790e-01]],

         ...,

         [[ 5.3511e+00,        -inf,        -inf,        -inf],
          [-6.0087e+00, -4.9263e+00,        -inf,        -inf],
          [ 5.0416e+00, -4.8865e+00,  1.9053e+00,        -inf],
          [ 2.0397e+00,  1.2728e+01, -7.5729e-01,  2.7785e+00]],

         [[ 1.5782e+00,        -inf,        -inf,        -inf],
          [-8.6740e+00,  3.2210e+00,        -inf,        -inf],
          [-3.5554e+00, -9.1788e+00,  3.0597e+00,        -inf],
          [-3.2928e+00,  5.0521e+00,  1.5649e+00,  1.5484e-01]],

         [[ 7.4492e+00,        -inf,        -inf,        -inf],
          [ 5.4327e+00,  8.6986e-01,        -inf,        -inf],
          [-5.4677e+00, -8.1625e+00, -4.1606e-01,        -inf],
          [-2.3521e+00, -1.7483e+00, -6.2224e+00,  3.4860e+00]]],


        [[[ 1.1163e+00,        -inf,        -inf,        -inf],
          [ 3.5071e+00,  7.1898e+00,        -inf,        -inf],
          [-5.0481e+00, -8.0558e+00, -8.6663e+00,        -inf],
          [-5.3894e+00, -8.2250e-01, -1.1884e+00,  1.8417e-01]],

         [[-4.0217e-01,        -inf,        -inf,        -inf],
          [-3.1878e+00,  7.2439e-01,        -inf,        -inf],
          [ 4.2720e+00,  5.3712e+00, -5.1296e+00,        -inf],
          [-1.2794e+00,  2.6867e+00, -8.1849e+00,  2.1453e-01]],

         [[ 5.8202e+00,        -inf,        -inf,        -inf],
          [-3.8294e+00, -1.1263e+01,        -inf,        -inf],
          [-3.8338e+00,  4.2917e+00,  2.7110e+00,        -inf],
          [ 2.8541e+00, -1.7299e+00, -5.8337e+00, -1.9551e+00]],

         ...,

         [[-5.7333e+00,        -inf,        -inf,        -inf],
          [-2.9819e+00, -5.3323e+00,        -inf,        -inf],
          [ 1.8485e-01, -1.0152e+00, -1.5633e+00,        -inf],
          [-2.4674e+00, -6.3800e+00,  3.6394e+00, -3.2121e+00]],

         [[-1.3830e+00,        -inf,        -inf,        -inf],
          [ 9.6041e-01,  3.8088e+00,        -inf,        -inf],
          [ 5.0836e-01,  8.9317e-01,  5.7973e-03,        -inf],
          [ 1.6332e+00,  7.8533e+00, -7.7560e+00, -2.4044e+00]],

         [[ 1.0294e+00,        -inf,        -inf,        -inf],
          [ 2.6744e+00, -3.9343e+00,        -inf,        -inf],
          [-5.9356e+00,  7.4257e+00, -3.6047e+00,        -inf],
          [-8.1296e+00,  9.5208e-01, -5.1974e-01,  4.5134e+00]]],


        [[[ 3.0039e+00,        -inf,        -inf,        -inf],
          [ 6.2313e+00,  3.0695e+00,        -inf,        -inf],
          [-1.2404e-01, -6.8848e+00,  2.8136e+00,        -inf],
          [ 7.1369e-03, -1.9610e+00,  5.3665e+00,  7.2231e+00]],

         [[ 2.9645e+00,        -inf,        -inf,        -inf],
          [ 1.0190e+01, -8.9463e+00,        -inf,        -inf],
          [-7.0897e+00, -3.7143e+00,  5.1498e+00,        -inf],
          [ 3.7611e+00,  5.7138e+00,  4.6997e+00,  4.1845e+00]],

         [[ 5.1384e+00,        -inf,        -inf,        -inf],
          [-1.3283e+01, -2.0284e+00,        -inf,        -inf],
          [ 4.1740e+00,  3.6162e-01, -5.4954e+00,        -inf],
          [ 8.1533e-01,  7.2503e+00,  2.7022e+00, -4.4714e-01]],

         ...,

         [[-2.9159e+00,        -inf,        -inf,        -inf],
          [-4.4115e+00, -5.6326e+00,        -inf,        -inf],
          [-1.2523e+00, -3.8967e-01,  2.8285e+00,        -inf],
          [ 5.1913e+00, -2.3155e+00,  4.9473e+00,  5.5427e+00]],

         [[ 3.4911e+00,        -inf,        -inf,        -inf],
          [-4.8883e+00, -2.3938e+00,        -inf,        -inf],
          [ 8.1183e-01, -1.0165e+01, -8.3057e+00,        -inf],
          [ 1.1471e-02,  4.9718e+00, -3.2154e+00, -3.9978e+00]],

         [[-1.5576e+00,        -inf,        -inf,        -inf],
          [ 2.6816e+00, -4.6519e+00,        -inf,        -inf],
          [-5.0081e+00, -5.8990e+00, -3.6623e+00,        -inf],
          [ 5.4878e+00,  1.1318e+01, -4.9957e+00,  8.8483e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 6.2545e+00,        -inf,        -inf,        -inf],
          [ 1.1541e+00,  2.4862e+00,        -inf,        -inf],
          [ 3.8189e+00, -1.8550e+00, -2.7722e+00,        -inf],
          [ 5.1649e+00, -4.5731e+00,  2.3423e+00, -3.7367e+00]],

         [[-2.0097e+00,        -inf,        -inf,        -inf],
          [-3.9195e+00, -2.2445e+00,        -inf,        -inf],
          [ 1.7625e+00, -4.4332e+00,  8.4356e-01,        -inf],
          [-4.3469e-01,  5.2741e+00,  1.5106e-01,  2.1621e+00]],

         [[ 8.2856e+00,        -inf,        -inf,        -inf],
          [ 3.9209e+00,  8.3901e+00,        -inf,        -inf],
          [-1.1635e+01, -1.0591e+01,  8.2555e-01,        -inf],
          [ 9.1362e+00,  1.8340e+00, -5.4291e+00,  8.0325e+00]],

         ...,

         [[-4.4508e-01,        -inf,        -inf,        -inf],
          [-1.3285e+01,  1.4315e+00,        -inf,        -inf],
          [ 4.1462e+00, -8.0108e+00, -7.9593e+00,        -inf],
          [-3.1404e+00, -3.0544e+00,  9.1568e+00,  5.7499e+00]],

         [[ 2.9442e+00,        -inf,        -inf,        -inf],
          [-5.0809e+00,  6.6632e+00,        -inf,        -inf],
          [-7.8616e+00,  1.8406e-01,  1.4971e+00,        -inf],
          [ 2.4926e+00, -9.3156e+00, -3.5131e+00, -9.6208e-01]],

         [[ 8.1253e+00,        -inf,        -inf,        -inf],
          [ 8.8045e+00, -1.4969e+00,        -inf,        -inf],
          [ 7.7993e+00,  1.7207e-01,  2.1458e+00,        -inf],
          [-4.8712e+00, -4.0101e+00, -7.4667e+00,  8.4528e+00]]],


        [[[-6.2129e-01,        -inf,        -inf,        -inf],
          [-2.2745e+00, -5.0477e-01,        -inf,        -inf],
          [ 6.1642e+00, -2.5525e+00, -2.1484e+00,        -inf],
          [ 1.1654e+01,  1.4555e+00,  4.1719e+00,  3.9059e+00]],

         [[ 4.8080e+00,        -inf,        -inf,        -inf],
          [ 4.6527e-01,  6.2725e+00,        -inf,        -inf],
          [ 1.6487e+00, -2.3390e+00, -4.0497e-01,        -inf],
          [-4.0520e+00, -8.4620e-01, -2.1715e+00, -3.8767e+00]],

         [[ 3.5252e+00,        -inf,        -inf,        -inf],
          [ 1.4354e+00,  1.1272e-01,        -inf,        -inf],
          [-2.2885e+00,  1.2697e+00,  7.2239e+00,        -inf],
          [ 2.1511e+00,  4.5042e+00, -1.6466e-01, -3.1784e+00]],

         ...,

         [[ 6.4323e-01,        -inf,        -inf,        -inf],
          [ 2.5409e+00, -1.8468e+00,        -inf,        -inf],
          [-1.9390e+00,  1.1044e-01,  5.9338e+00,        -inf],
          [ 1.2824e+00, -5.3561e+00, -1.7852e+00,  1.0841e+01]],

         [[ 3.8382e+00,        -inf,        -inf,        -inf],
          [-6.8231e+00,  5.3904e+00,        -inf,        -inf],
          [ 3.2844e+00,  1.0587e+00, -1.9624e+00,        -inf],
          [ 1.8502e+00,  1.1088e+01,  2.9437e+00,  1.6450e+00]],

         [[ 1.0253e+01,        -inf,        -inf,        -inf],
          [ 7.1702e+00, -5.4109e+00,        -inf,        -inf],
          [-6.0062e+00,  6.0397e-01,  1.0422e+01,        -inf],
          [-9.0584e-01, -4.5614e+00,  1.0582e-01,  1.0238e+01]]],


        [[[ 3.1050e+00,        -inf,        -inf,        -inf],
          [-3.6093e-02,  1.4526e+00,        -inf,        -inf],
          [-6.1986e+00, -7.6923e+00, -1.4984e+00,        -inf],
          [ 2.8365e+00, -4.1717e+00,  7.9036e+00, -2.5390e+00]],

         [[-3.8252e+00,        -inf,        -inf,        -inf],
          [-8.4721e+00, -9.0153e+00,        -inf,        -inf],
          [-7.4142e-01,  1.7392e-01, -5.8212e+00,        -inf],
          [ 4.7855e+00,  2.3645e+00, -2.2493e+00, -4.3426e+00]],

         [[ 1.1026e+00,        -inf,        -inf,        -inf],
          [-6.8033e+00, -1.0722e+00,        -inf,        -inf],
          [ 3.0893e+00,  4.4546e+00,  2.3167e+00,        -inf],
          [ 6.3542e+00,  8.0599e-01, -6.0721e-01,  2.5721e+00]],

         ...,

         [[-2.5007e+00,        -inf,        -inf,        -inf],
          [-7.1458e+00, -5.4867e+00,        -inf,        -inf],
          [-1.2713e+00,  6.5941e+00,  4.5816e+00,        -inf],
          [-1.2634e+00,  4.4397e+00,  3.4572e+00, -1.0912e+00]],

         [[-2.1860e+00,        -inf,        -inf,        -inf],
          [-2.9438e+00,  1.1156e+01,        -inf,        -inf],
          [-1.2382e+00,  3.6626e-01, -3.4941e+00,        -inf],
          [-1.6801e+00, -1.2381e+00,  4.5302e+00, -3.2304e+00]],

         [[ 4.8909e+00,        -inf,        -inf,        -inf],
          [ 7.8098e+00,  2.3336e+00,        -inf,        -inf],
          [-3.9018e-01, -3.7622e+00, -3.7933e+00,        -inf],
          [-3.8560e+00, -1.3023e+00, -4.8615e+00,  8.6209e+00]]],


        ...,


        [[[-2.5312e-01,        -inf,        -inf,        -inf],
          [-1.3317e-01, -1.9177e+00,        -inf,        -inf],
          [-1.5854e+00, -3.2852e+00, -1.0025e+01,        -inf],
          [ 1.3871e+00, -2.2262e-01, -1.4566e+00, -4.7164e+00]],

         [[ 3.3905e+00,        -inf,        -inf,        -inf],
          [ 1.0956e+01, -5.2763e+00,        -inf,        -inf],
          [ 7.6966e+00, -2.4760e+00,  9.6425e+00,        -inf],
          [-1.8555e+00,  3.5773e+00, -2.1191e+00, -2.4294e+00]],

         [[ 2.5829e+00,        -inf,        -inf,        -inf],
          [ 7.4538e-01,  7.0395e+00,        -inf,        -inf],
          [-2.9948e+00, -4.3931e+00,  1.5995e+01,        -inf],
          [ 4.6879e+00, -4.0339e-01, -6.0882e+00,  7.8790e-01]],

         ...,

         [[ 5.3511e+00,        -inf,        -inf,        -inf],
          [-6.0087e+00, -4.9263e+00,        -inf,        -inf],
          [ 5.0416e+00, -4.8865e+00,  1.9053e+00,        -inf],
          [ 2.0397e+00,  1.2728e+01, -7.5729e-01,  2.7785e+00]],

         [[ 1.5782e+00,        -inf,        -inf,        -inf],
          [-8.6740e+00,  3.2210e+00,        -inf,        -inf],
          [-3.5554e+00, -9.1788e+00,  3.0597e+00,        -inf],
          [-3.2928e+00,  5.0521e+00,  1.5649e+00,  1.5484e-01]],

         [[ 7.4492e+00,        -inf,        -inf,        -inf],
          [ 5.4327e+00,  8.6986e-01,        -inf,        -inf],
          [-5.4677e+00, -8.1625e+00, -4.1606e-01,        -inf],
          [-2.3521e+00, -1.7483e+00, -6.2224e+00,  3.4860e+00]]],


        [[[ 1.1163e+00,        -inf,        -inf,        -inf],
          [ 3.5071e+00,  7.1898e+00,        -inf,        -inf],
          [-5.0481e+00, -8.0558e+00, -8.6663e+00,        -inf],
          [-5.3894e+00, -8.2250e-01, -1.1884e+00,  1.8417e-01]],

         [[-4.0217e-01,        -inf,        -inf,        -inf],
          [-3.1878e+00,  7.2439e-01,        -inf,        -inf],
          [ 4.2720e+00,  5.3712e+00, -5.1296e+00,        -inf],
          [-1.2794e+00,  2.6867e+00, -8.1849e+00,  2.1453e-01]],

         [[ 5.8202e+00,        -inf,        -inf,        -inf],
          [-3.8294e+00, -1.1263e+01,        -inf,        -inf],
          [-3.8338e+00,  4.2917e+00,  2.7110e+00,        -inf],
          [ 2.8541e+00, -1.7299e+00, -5.8337e+00, -1.9551e+00]],

         ...,

         [[-5.7333e+00,        -inf,        -inf,        -inf],
          [-2.9819e+00, -5.3323e+00,        -inf,        -inf],
          [ 1.8485e-01, -1.0152e+00, -1.5633e+00,        -inf],
          [-2.4674e+00, -6.3800e+00,  3.6394e+00, -3.2121e+00]],

         [[-1.3830e+00,        -inf,        -inf,        -inf],
          [ 9.6041e-01,  3.8088e+00,        -inf,        -inf],
          [ 5.0836e-01,  8.9317e-01,  5.7973e-03,        -inf],
          [ 1.6332e+00,  7.8533e+00, -7.7560e+00, -2.4044e+00]],

         [[ 1.0294e+00,        -inf,        -inf,        -inf],
          [ 2.6744e+00, -3.9343e+00,        -inf,        -inf],
          [-5.9356e+00,  7.4257e+00, -3.6047e+00,        -inf],
          [-8.1296e+00,  9.5208e-01, -5.1974e-01,  4.5134e+00]]],


        [[[ 3.0039e+00,        -inf,        -inf,        -inf],
          [ 6.2313e+00,  3.0695e+00,        -inf,        -inf],
          [-1.2404e-01, -6.8848e+00,  2.8136e+00,        -inf],
          [ 7.1369e-03, -1.9610e+00,  5.3665e+00,  7.2231e+00]],

         [[ 2.9645e+00,        -inf,        -inf,        -inf],
          [ 1.0190e+01, -8.9463e+00,        -inf,        -inf],
          [-7.0897e+00, -3.7143e+00,  5.1498e+00,        -inf],
          [ 3.7611e+00,  5.7138e+00,  4.6997e+00,  4.1845e+00]],

         [[ 5.1384e+00,        -inf,        -inf,        -inf],
          [-1.3283e+01, -2.0284e+00,        -inf,        -inf],
          [ 4.1740e+00,  3.6162e-01, -5.4954e+00,        -inf],
          [ 8.1533e-01,  7.2503e+00,  2.7022e+00, -4.4714e-01]],

         ...,

         [[-2.9159e+00,        -inf,        -inf,        -inf],
          [-4.4115e+00, -5.6326e+00,        -inf,        -inf],
          [-1.2523e+00, -3.8967e-01,  2.8285e+00,        -inf],
          [ 5.1913e+00, -2.3155e+00,  4.9473e+00,  5.5427e+00]],

         [[ 3.4911e+00,        -inf,        -inf,        -inf],
          [-4.8883e+00, -2.3938e+00,        -inf,        -inf],
          [ 8.1183e-01, -1.0165e+01, -8.3057e+00,        -inf],
          [ 1.1471e-02,  4.9718e+00, -3.2154e+00, -3.9978e+00]],

         [[-1.5576e+00,        -inf,        -inf,        -inf],
          [ 2.6816e+00, -4.6519e+00,        -inf,        -inf],
          [-5.0081e+00, -5.8990e+00, -3.6623e+00,        -inf],
          [ 5.4878e+00,  1.1318e+01, -4.9957e+00,  8.8483e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 6.4716e-01, -2.9772e-01,  3.0064e-02,  ...,  6.3126e-01,
           -5.0006e-01, -7.2024e-01],
          [-6.7563e-01,  2.0139e-01,  6.6434e-01,  ...,  4.4845e-01,
           -1.0340e+00,  2.1648e-01],
          [ 7.9885e-01,  2.1662e-01, -2.1036e-01,  ...,  5.9356e-01,
            5.7540e-01,  8.2007e-01],
          ...,
          [-2.0794e-01, -2.4516e-01, -1.2542e+00,  ..., -5.5915e-01,
            5.0721e-01, -5.1036e-01],
          [-5.9670e-01,  9.4164e-01,  8.7398e-01,  ..., -7.3070e-01,
            7.5176e-01, -9.0636e-01],
          [-1.7959e+00,  8.2926e-01, -8.0298e-01,  ...,  1.1308e-01,
            1.7422e-01,  5.3212e-01]],

         [[-2.5544e-01, -2.3211e-05, -5.1787e-01,  ..., -1.3004e-01,
           -3.7387e-01,  3.3337e-02],
          [ 4.1122e-01,  2.4454e-01, -3.8105e-01,  ..., -1.8313e-01,
           -1.6452e-01,  4.1361e-01],
          [-8.1026e-02, -8.6634e-01,  6.3713e-02,  ...,  9.3150e-01,
           -2.7137e-01, -3.6724e-01],
          ...,
          [-1.0788e+00, -8.9972e-01,  2.0263e-02,  ..., -1.2118e-01,
            6.4032e-01,  3.8753e-01],
          [-5.7011e-03, -9.0417e-01, -8.7105e-01,  ..., -8.4987e-01,
            2.7582e-01,  1.0613e-02],
          [-1.5024e+00,  5.6724e-01, -4.9318e-01,  ...,  1.3265e-01,
            7.5597e-02,  4.5379e-01]],

         [[ 3.0697e-01,  2.0889e-01, -1.8175e-01,  ..., -1.0762e-02,
           -3.4125e-01, -2.2865e-01],
          [ 2.7990e-01, -7.6763e-02, -4.9529e-02,  ...,  3.4253e-01,
            3.3350e-01, -4.8863e-02],
          [ 4.8112e-02,  5.5701e-02,  1.5132e-01,  ...,  1.3925e-01,
            1.0360e+00, -8.8973e-01],
          ...,
          [-3.6417e-01, -3.4275e-01, -7.9139e-01,  ..., -3.7624e-01,
            3.9998e-01, -3.5907e-01],
          [ 1.6098e-02, -6.8973e-01, -8.0841e-01,  ..., -7.1368e-01,
            2.7359e-01,  2.5353e-01],
          [-9.8062e-01,  5.8283e-01, -4.4260e-01,  ...,  1.2881e-01,
            8.5319e-02,  3.5896e-01]],

         [[ 3.2316e-01,  1.8566e-01, -6.8127e-02,  ..., -1.2198e-01,
           -1.9709e-01, -2.7594e-01],
          [ 4.8369e-01,  1.8508e-01, -1.2434e-01,  ..., -2.2469e-01,
           -4.0416e-02, -7.9066e-02],
          [ 1.9040e-01, -3.2633e-01, -8.1183e-02,  ...,  6.7907e-01,
           -1.5590e-01,  1.4519e-01],
          ...,
          [-9.7078e-02, -1.6903e-01,  2.2426e-02,  ...,  3.8771e-02,
           -1.4252e-01, -4.1388e-01],
          [-3.5540e-01, -5.2981e-02,  1.3800e-02,  ..., -8.0644e-01,
            4.2211e-01, -4.8446e-01],
          [ 8.9123e-01,  4.6735e-01,  1.1814e-01,  ..., -8.7375e-02,
            2.3705e-01, -7.6338e-02]]],


        [[[ 6.1041e-03, -1.0391e-01, -1.1837e+00,  ..., -9.8541e-01,
           -4.8418e-01, -4.8808e-01],
          [ 1.0532e+00,  1.5673e+00, -3.0149e-01,  ..., -4.1730e-01,
           -1.3999e+00, -2.8614e-01],
          [ 5.2931e-01, -1.7492e-01,  8.5141e-01,  ...,  6.5831e-01,
            1.1638e+00,  8.2240e-02],
          ...,
          [ 6.1028e-01, -9.4891e-01, -4.3875e-01,  ..., -1.9833e-01,
           -2.7119e-01, -8.5968e-01],
          [ 4.6961e-01,  3.8052e-01, -9.0000e-01,  ..., -6.2799e-01,
           -5.1031e-03, -1.0814e+00],
          [-1.7213e+00,  3.0984e-01, -4.2054e-01,  ...,  1.6189e+00,
           -1.9325e-01, -9.7546e-01]],

         [[-7.8673e-02, -1.9974e-01, -3.7902e-01,  ..., -6.1758e-01,
           -1.9911e-01, -1.9158e-01],
          [ 1.0287e+00,  2.3339e-01, -1.2326e-01,  ..., -1.0501e+00,
            6.4829e-02, -3.9625e-01],
          [-2.7909e-01, -6.3250e-01,  8.9405e-02,  ...,  1.5769e+00,
            2.0214e-01, -3.3986e-01],
          ...,
          [-3.2801e-01, -4.4901e-01, -1.6642e-01,  ...,  6.8747e-03,
           -7.7605e-02, -4.4600e-01],
          [ 1.0735e-01, -8.4941e-01, -1.9496e-01,  ..., -9.8354e-02,
            1.9575e-01,  4.5815e-01],
          [-1.3277e+00,  1.1863e-01, -2.5190e-01,  ...,  1.3397e+00,
           -1.6675e-01, -8.0894e-01]],

         [[ 3.1853e-01, -1.6119e-01, -6.8664e-01,  ..., -7.7527e-01,
           -2.7598e-03, -1.8915e-01],
          [ 1.2499e+00,  4.7190e-01, -1.3040e-01,  ..., -3.3237e-01,
           -2.4233e-01, -6.6882e-01],
          [-7.1377e-02, -1.6805e-01,  4.2872e-01,  ...,  7.5521e-01,
           -7.0404e-02, -1.3569e-01],
          ...,
          [-8.0409e-01,  7.8653e-02,  7.2861e-02,  ..., -2.8009e-01,
           -7.8705e-01, -4.3028e-01],
          [ 4.2085e-01, -2.6495e-01, -4.9812e-01,  ..., -5.3451e-01,
            5.1304e-02, -4.0744e-01],
          [-9.2917e-01,  1.2985e-01,  7.5581e-02,  ...,  4.2698e-01,
            8.8652e-01, -4.9887e-01]],

         [[ 4.7126e-02, -2.4953e-01, -6.9764e-01,  ..., -8.2489e-01,
            7.1675e-02, -1.9225e-01],
          [ 6.2452e-01, -7.9633e-02,  5.9685e-02,  ..., -3.8753e-01,
           -2.5507e-02, -8.0075e-01],
          [-1.2690e-01, -4.3180e-01,  3.1926e-01,  ...,  1.1367e+00,
           -4.2881e-02, -3.9733e-01],
          ...,
          [ 3.0092e-03,  1.5868e-02, -2.8238e-02,  ...,  4.6167e-01,
           -3.1339e-01, -7.9688e-01],
          [ 2.6696e-02, -5.8694e-01, -3.1297e-01,  ..., -3.7326e-01,
            7.5416e-02,  2.0869e-01],
          [-5.3814e-01, -2.7844e-03, -3.2333e-01,  ..., -2.7768e-01,
            7.7843e-01,  7.9551e-01]]],


        [[[ 4.8809e-01, -3.3631e-01, -7.1919e-01,  ...,  2.5864e-01,
           -2.9638e-01, -9.8284e-01],
          [ 1.2867e+00,  8.1231e-01,  8.9719e-01,  ...,  3.7275e-01,
           -2.7125e+00, -7.4174e-01],
          [-2.8757e-01, -1.0396e+00,  2.8455e-01,  ...,  5.1982e-01,
            2.7282e-02, -2.2799e-01],
          ...,
          [-7.1949e-01,  5.2311e-01, -9.7580e-01,  ..., -5.2730e-01,
            4.0023e-01, -1.0582e+00],
          [-5.7413e-01,  8.9406e-01,  1.8627e-01,  ..., -9.4176e-02,
           -8.9591e-01, -1.4545e+00],
          [-5.8284e-01, -6.8707e-01, -3.5675e-01,  ...,  1.2307e+00,
            6.4130e-02, -1.1894e+00]],

         [[ 3.8379e-01, -7.7107e-03, -5.8596e-01,  ...,  1.1132e-01,
           -5.8556e-02, -1.7626e-01],
          [ 9.9479e-01,  8.7237e-01,  1.1758e-01,  ..., -1.5033e-01,
           -1.6429e+00, -2.6685e-01],
          [-2.1139e-01, -9.5688e-01, -4.3639e-01,  ...,  2.4914e-01,
            4.7625e-01, -1.1703e+00],
          ...,
          [-9.5021e-01,  6.8597e-02, -5.6382e-01,  ...,  4.0672e-01,
           -4.3505e-02, -3.7166e-01],
          [ 7.8766e-01, -6.1836e-01, -3.1984e-01,  ..., -1.1469e+00,
            6.6447e-01, -1.2745e-01],
          [-2.2381e-01, -5.3626e-01,  1.0352e-01,  ...,  6.3860e-01,
           -3.5095e-04, -5.8419e-01]],

         [[ 7.6137e-01, -2.2254e-01, -4.6471e-01,  ..., -1.8084e-01,
            5.1927e-01, -1.6762e-01],
          [ 1.1378e+00,  7.7442e-01, -2.9585e-01,  ..., -4.1177e-01,
           -1.1492e+00, -4.5504e-01],
          [-1.1752e-01, -3.7069e-01,  1.3313e-01,  ...,  2.4978e-01,
            2.7319e-01, -9.0092e-01],
          ...,
          [-9.1188e-01, -1.4286e-01, -3.8571e-01,  ...,  6.9791e-01,
           -3.9046e-01, -5.5846e-02],
          [ 3.5325e-01, -2.3873e-01, -2.3398e-01,  ..., -5.0712e-01,
            2.8535e-01, -2.5348e-01],
          [ 1.3623e-01, -3.7658e-01, -8.7185e-02,  ...,  6.4660e-01,
           -6.6113e-02, -7.9163e-01]],

         [[ 5.6803e-01, -2.6883e-01, -4.4420e-01,  ..., -3.6719e-01,
            5.2889e-01, -3.2569e-01],
          [ 1.0765e+00,  5.9455e-01, -1.0276e-01,  ..., -3.3114e-01,
           -1.4287e+00, -4.4265e-01],
          [-7.3841e-02, -4.1631e-01,  3.5248e-01,  ...,  3.1192e-01,
            1.8674e-01, -6.8018e-01],
          ...,
          [-6.6565e-01, -1.3134e-01, -2.9280e-01,  ...,  4.0054e-01,
           -4.2984e-01, -1.3474e-02],
          [ 3.2978e-01, -2.9978e-01, -2.6978e-01,  ..., -1.6671e-01,
            4.1402e-01,  9.4676e-02],
          [ 7.5212e-01,  3.9804e-01, -8.8064e-02,  ...,  1.0018e-01,
            6.5091e-01, -5.3288e-01]]],


        ...,


        [[[ 1.2783e+00, -6.2416e-01, -1.2374e+00,  ..., -1.4182e-01,
           -2.1347e-01,  1.4956e+00],
          [ 5.6224e-01,  4.4089e-01, -1.2718e-01,  ...,  4.0327e-01,
           -6.1444e-01, -4.2708e-01],
          [-1.4891e-01,  3.1613e-01,  5.8912e-01,  ...,  5.9815e-01,
           -2.3505e-01, -3.8266e-02],
          ...,
          [-6.9355e-01, -5.4055e-01, -4.8613e-01,  ...,  1.3994e-02,
           -8.0709e-01, -5.4056e-01],
          [-1.4769e+00, -2.6655e-01, -9.6270e-01,  ..., -9.9457e-01,
            2.4375e-01, -1.7984e+00],
          [-1.0186e+00,  8.0982e-01, -4.3836e-01,  ...,  3.1069e-01,
            2.9372e-01, -6.1266e-01]],

         [[ 5.2628e-01,  1.0357e-01, -9.2691e-01,  ...,  1.2208e-01,
            4.9625e-02,  9.1233e-01],
          [ 5.3311e-01,  3.0701e-01, -9.9226e-02,  ...,  2.9360e-01,
           -5.9822e-01, -4.6733e-01],
          [-1.4655e+00, -6.2240e-01, -4.3772e-01,  ...,  1.0214e+00,
            2.5243e-01, -3.1866e-01],
          ...,
          [-1.3412e+00, -3.7878e-01, -1.4875e-01,  ...,  3.1224e-01,
           -4.5143e-01, -8.8064e-01],
          [ 5.1213e-02, -7.0091e-01, -7.7699e-01,  ..., -5.4591e-01,
            5.2348e-01, -2.4185e-01],
          [-4.2849e-01,  4.6124e-01,  2.7161e-03,  ..., -1.0786e-01,
            2.5331e-01, -2.4913e-01]],

         [[ 5.6452e-01, -8.3355e-02, -8.5397e-01,  ...,  2.3765e-02,
            5.9075e-02,  9.1336e-01],
          [ 2.9367e-01,  1.4879e-01, -1.3545e-01,  ..., -9.2708e-02,
            6.0971e-01, -1.1177e+00],
          [-5.5923e-01,  1.5083e+00,  1.1560e+00,  ...,  2.4598e-01,
            1.2317e-01, -1.2035e+00],
          ...,
          [-4.3757e-01, -4.9987e-01, -4.1180e-01,  ..., -3.3296e-02,
           -9.4262e-01, -6.6355e-01],
          [ 2.6108e-01, -9.2162e-01, -1.2017e+00,  ..., -9.6053e-01,
            4.3446e-01,  6.9761e-01],
          [ 5.4536e-02,  5.9483e-01, -2.9446e-01,  ..., -1.8977e-01,
           -2.5132e-01, -1.0091e-01]],

         [[ 5.0042e-01, -1.3938e-01, -6.0423e-01,  ..., -8.6147e-02,
            1.1879e-01,  7.8087e-01],
          [ 1.5311e-01, -1.5235e-01,  9.0248e-02,  ..., -3.4537e-01,
           -9.5695e-02, -9.6104e-01],
          [-6.8005e-01, -1.3638e-02,  3.5270e-01,  ...,  6.0186e-01,
            1.0739e-01, -3.5059e-01],
          ...,
          [-1.0831e+00, -2.5812e-01, -1.0958e-01,  ...,  2.5141e-01,
           -3.4418e-01, -1.0518e+00],
          [ 1.0868e-01, -6.7291e-01, -9.9769e-01,  ..., -5.2456e-01,
            5.3190e-01,  1.6744e-01],
          [ 5.7140e-01,  2.5200e-01, -1.0119e-01,  ...,  1.6587e-01,
            9.2892e-01,  3.4926e-01]]],


        [[[-1.2399e-01, -6.3642e-01, -4.4239e-01,  ..., -8.2668e-01,
           -3.1695e-01, -8.7668e-01],
          [-2.2307e-01,  1.4551e+00, -1.5225e-01,  ...,  3.2622e-01,
           -1.4395e+00, -5.0436e-01],
          [-3.2797e-01, -6.9266e-01, -6.1380e-01,  ...,  4.5028e-01,
            1.8472e+00, -1.3582e+00],
          ...,
          [-2.3986e-01,  2.6942e-01, -3.4868e-01,  ..., -2.4031e-02,
           -2.6305e-02, -1.5095e+00],
          [-3.2786e-01,  8.9467e-03,  1.7283e-02,  ..., -1.1596e+00,
           -1.3375e+00, -4.6239e-01],
          [ 5.8509e-02, -5.6861e-01, -1.9624e+00,  ...,  4.4313e-01,
           -2.4064e-01, -4.3803e-01]],

         [[-8.8072e-01, -2.8103e-01, -5.5927e-01,  ..., -6.2360e-01,
            2.0750e-01, -1.1658e-02],
          [ 4.6815e-01, -1.3123e-01,  5.9523e-01,  ..., -3.3743e-01,
           -2.1498e-01, -1.9048e-01],
          [-5.9417e-01, -9.7426e-01, -2.0967e-01,  ...,  5.9905e-01,
            1.2151e+00, -1.0610e+00],
          ...,
          [-7.0194e-01, -1.3193e-01, -9.3924e-02,  ...,  7.5990e-02,
            9.1111e-02, -8.3830e-01],
          [-2.0079e-01, -4.6421e-01, -9.5746e-02,  ..., -7.4142e-01,
            8.5447e-01,  1.3952e-02],
          [ 2.8725e-02, -5.4228e-01, -1.1195e+00,  ...,  3.2120e-01,
           -7.1292e-02, -2.1795e-01]],

         [[-7.7093e-02, -4.8958e-01, -5.2543e-01,  ..., -4.1670e-01,
            4.6953e-02, -1.8743e-01],
          [ 3.0800e-01, -1.1148e-02,  3.6594e-01,  ..., -1.3472e-01,
           -2.8831e-01, -2.4252e-01],
          [-5.2944e-01, -4.9030e-01,  2.2440e-01,  ...,  3.7395e-01,
            1.2554e-01, -6.2030e-01],
          ...,
          [-6.3787e-01,  5.7119e-02,  8.3192e-02,  ..., -1.2991e-01,
           -1.3086e-01, -6.7855e-01],
          [ 1.7453e-01, -6.7027e-01, -5.4437e-01,  ..., -7.1755e-01,
            3.9991e-01,  1.6249e-01],
          [ 3.6008e-01, -3.4625e-01,  2.9114e-01,  ...,  9.2898e-02,
            3.5416e-01, -7.1903e-02]],

         [[-2.4548e-01, -4.4527e-01, -6.4774e-01,  ..., -1.3266e-01,
            9.0948e-02, -3.1745e-01],
          [ 5.4659e-01, -2.6514e-01,  3.3349e-01,  ..., -2.4597e-01,
           -3.8137e-01, -1.2841e-01],
          [-5.4835e-01, -5.4178e-01,  7.2687e-02,  ...,  3.4426e-01,
            7.3364e-01, -7.3418e-01],
          ...,
          [-4.7361e-01,  3.5173e-01,  2.1694e-01,  ..., -8.6619e-02,
           -6.1363e-01, -6.5111e-01],
          [-1.0857e-01, -5.2476e-01, -3.4962e-01,  ..., -6.5679e-01,
            8.6651e-01,  1.2723e-01],
          [ 1.1137e+00,  1.4118e-01, -1.6040e-01,  ...,  1.3614e-01,
            5.9561e-01,  3.1251e-02]]],


        [[[ 9.6523e-01, -9.0203e-01, -7.4205e-01,  ...,  2.5029e-01,
           -5.6840e-01, -5.9798e-01],
          [-1.1777e+00,  4.6935e-01,  5.9975e-01,  ...,  5.7987e-01,
           -1.0495e+00, -5.3626e-01],
          [ 4.9886e-01, -4.3271e-01, -7.2883e-02,  ..., -9.0989e-02,
            4.4014e-01,  2.1916e-01],
          ...,
          [-5.0056e-01, -4.1941e-02,  1.6884e-02,  ..., -9.8714e-01,
            1.3388e-01, -9.8635e-01],
          [-1.9744e-01, -7.1233e-01, -9.6431e-01,  ..., -5.8256e-01,
           -6.5278e-01, -1.2575e+00],
          [ 1.0817e+00, -1.0203e-01, -5.3048e-01,  ...,  1.0128e-01,
            1.4310e+00, -7.7414e-01]],

         [[ 6.7729e-01, -6.1892e-01, -3.4124e-01,  ..., -1.2419e-01,
           -1.1586e-01, -4.7146e-01],
          [-1.1000e+00,  3.4895e-01,  5.9021e-01,  ...,  5.1572e-01,
           -9.0390e-01, -5.1349e-01],
          [-1.2859e+00, -7.0687e-01, -1.0849e-02,  ...,  6.5385e-01,
            1.4672e-01, -5.9227e-01],
          ...,
          [-8.6949e-01,  6.7803e-01,  1.6790e-01,  ..., -1.4091e-01,
            3.1772e-01, -2.2856e-01],
          [ 4.5774e-01, -1.2431e+00, -1.6678e+00,  ..., -2.9380e-01,
           -4.7603e-02, -6.4420e-01],
          [ 7.4752e-01, -1.6116e-01, -1.4052e-01,  ...,  1.7514e-01,
            9.5461e-01, -3.4867e-01]],

         [[ 9.9986e-01, -5.9580e-01, -6.6332e-01,  ..., -5.3234e-01,
           -1.3942e-02, -2.0484e-01],
          [ 2.3270e-01, -1.0078e+00, -3.4267e-01,  ...,  2.0991e-01,
            4.9561e-01, -5.6316e-01],
          [-3.0935e-01, -2.6623e-01,  1.0340e-01,  ...,  2.8601e-01,
            3.7804e-01, -3.5733e-01],
          ...,
          [-4.9822e-01,  6.1478e-01,  2.0977e-01,  ...,  1.6623e-01,
           -9.6208e-02, -2.5876e-01],
          [ 2.0657e-01, -7.5959e-01, -1.1997e+00,  ..., -2.6239e-01,
           -2.9569e-01, -6.1252e-01],
          [ 4.1570e-01, -2.3904e-01, -6.9296e-03,  ...,  6.4800e-01,
            3.3156e-01, -5.8905e-01]],

         [[-9.8293e-02, -6.0318e-01, -7.4232e-01,  ..., -2.3438e-01,
           -4.7610e-02, -3.8998e-01],
          [-2.9583e-01, -3.9987e-01,  2.9977e-01,  ..., -5.9272e-02,
           -2.1684e-01, -4.4478e-01],
          [-6.8003e-01, -1.1886e-01,  2.8704e-01,  ...,  4.1341e-01,
            3.4271e-01, -7.8401e-01],
          ...,
          [-1.6336e-02,  3.3955e-01, -2.5385e-01,  ..., -3.9573e-01,
           -4.5710e-02, -3.8661e-01],
          [ 3.8797e-01, -1.0838e+00, -1.4052e+00,  ..., -1.6537e-01,
            1.0165e-01, -3.9163e-01],
          [ 4.5622e-01, -2.8273e-01,  3.7194e-01,  ...,  2.4966e-01,
            5.3404e-01,  3.7051e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 6.4716e-01, -2.9772e-01,  3.0064e-02,  ...,  1.1308e-01,
           1.7422e-01,  5.3212e-01],
         [-2.5544e-01, -2.3211e-05, -5.1787e-01,  ...,  1.3265e-01,
           7.5597e-02,  4.5379e-01],
         [ 3.0697e-01,  2.0889e-01, -1.8175e-01,  ...,  1.2881e-01,
           8.5319e-02,  3.5896e-01],
         [ 3.2316e-01,  1.8566e-01, -6.8127e-02,  ..., -8.7375e-02,
           2.3705e-01, -7.6338e-02]],

        [[ 6.1041e-03, -1.0391e-01, -1.1837e+00,  ...,  1.6189e+00,
          -1.9325e-01, -9.7546e-01],
         [-7.8673e-02, -1.9974e-01, -3.7902e-01,  ...,  1.3397e+00,
          -1.6675e-01, -8.0894e-01],
         [ 3.1853e-01, -1.6119e-01, -6.8664e-01,  ...,  4.2698e-01,
           8.8652e-01, -4.9887e-01],
         [ 4.7126e-02, -2.4953e-01, -6.9764e-01,  ..., -2.7768e-01,
           7.7843e-01,  7.9551e-01]],

        [[ 4.8809e-01, -3.3631e-01, -7.1919e-01,  ...,  1.2307e+00,
           6.4130e-02, -1.1894e+00],
         [ 3.8379e-01, -7.7107e-03, -5.8596e-01,  ...,  6.3860e-01,
          -3.5095e-04, -5.8419e-01],
         [ 7.6137e-01, -2.2254e-01, -4.6471e-01,  ...,  6.4660e-01,
          -6.6113e-02, -7.9163e-01],
         [ 5.6803e-01, -2.6883e-01, -4.4420e-01,  ...,  1.0018e-01,
           6.5091e-01, -5.3288e-01]],

        ...,

        [[ 1.2783e+00, -6.2416e-01, -1.2374e+00,  ...,  3.1069e-01,
           2.9372e-01, -6.1266e-01],
         [ 5.2628e-01,  1.0357e-01, -9.2691e-01,  ..., -1.0786e-01,
           2.5331e-01, -2.4913e-01],
         [ 5.6452e-01, -8.3355e-02, -8.5397e-01,  ..., -1.8977e-01,
          -2.5132e-01, -1.0091e-01],
         [ 5.0042e-01, -1.3938e-01, -6.0423e-01,  ...,  1.6587e-01,
           9.2892e-01,  3.4926e-01]],

        [[-1.2399e-01, -6.3642e-01, -4.4239e-01,  ...,  4.4313e-01,
          -2.4064e-01, -4.3803e-01],
         [-8.8072e-01, -2.8103e-01, -5.5927e-01,  ...,  3.2120e-01,
          -7.1292e-02, -2.1795e-01],
         [-7.7093e-02, -4.8958e-01, -5.2543e-01,  ...,  9.2898e-02,
           3.5416e-01, -7.1903e-02],
         [-2.4548e-01, -4.4527e-01, -6.4774e-01,  ...,  1.3614e-01,
           5.9561e-01,  3.1251e-02]],

        [[ 9.6523e-01, -9.0203e-01, -7.4205e-01,  ...,  1.0128e-01,
           1.4310e+00, -7.7414e-01],
         [ 6.7729e-01, -6.1892e-01, -3.4124e-01,  ...,  1.7514e-01,
           9.5461e-01, -3.4867e-01],
         [ 9.9986e-01, -5.9580e-01, -6.6332e-01,  ...,  6.4800e-01,
           3.3156e-01, -5.8905e-01],
         [-9.8293e-02, -6.0318e-01, -7.4232e-01,  ...,  2.4966e-01,
           5.3404e-01,  3.7051e-01]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1213,  0.0465, -0.5017,  ...,  0.4832, -0.0877, -0.2300],
         [-0.0735, -0.1649, -0.3906,  ...,  0.4293,  0.0046, -0.2550],
         [ 0.0776,  0.0199, -0.0106,  ...,  0.0224,  0.0322,  0.1603],
         [-0.1150,  0.1058, -0.4311,  ...,  0.3137, -0.4430,  0.0920]],

        [[ 0.0336, -0.3242, -0.6767,  ...,  0.5369, -0.4851, -0.1381],
         [ 0.2695, -0.6938, -0.3003,  ...,  0.2068, -0.5449, -0.1400],
         [ 0.1457,  0.1164, -0.4732,  ...,  0.0444, -0.3416,  0.0204],
         [ 0.2206,  0.0812, -0.2604,  ...,  0.0093, -0.4457,  0.0163]],

        [[-0.2830, -0.5338, -0.0670,  ...,  0.5683, -0.2345,  0.1375],
         [ 0.0851, -0.8473, -0.4867,  ...,  0.6086, -0.5066, -0.2392],
         [-0.0909, -0.6731, -0.1015,  ...,  0.1703, -0.4731,  0.0164],
         [-0.2905, -0.3549, -0.1986,  ...,  0.2079, -0.3076, -0.1434]],

        ...,

        [[-0.2531, -0.4097, -0.4405,  ...,  0.3563,  0.2139,  0.3235],
         [ 0.1142, -0.5596, -0.6040,  ...,  0.3986,  0.0772,  0.1200],
         [ 0.4984, -0.5801, -0.0063,  ...,  0.3877,  0.4773,  0.0191],
         [ 0.0763, -0.1051, -0.3694,  ...,  0.5103, -0.1017,  0.0436]],

        [[-0.2896,  0.0094, -0.1026,  ...,  0.2528, -0.3201,  0.0749],
         [-0.1328, -0.3403, -0.3301,  ...,  0.2055, -0.2981,  0.0357],
         [ 0.1217, -0.2339, -0.2279,  ...,  0.0532, -0.2268, -0.2274],
         [ 0.1551, -0.2127,  0.0613,  ...,  0.0025, -0.5681,  0.0972]],

        [[ 0.1728, -0.0896, -0.4091,  ..., -0.2124, -0.4596, -0.3444],
         [ 0.5104, -0.3828, -0.5602,  ..., -0.1549, -0.5189, -0.2750],
         [ 0.3518, -0.0186, -0.2977,  ..., -0.0580, -0.4536, -0.3832],
         [ 0.2326,  0.1216,  0.0462,  ..., -0.2527, -0.6344, -0.2021]]],
       grad_fn=<ViewBackward0>)
context vecs:
 tensor([[[ 0.1213,  0.0465, -0.5017,  ...,  0.4832, -0.0877, -0.2300],
         [-0.0735, -0.1649, -0.3906,  ...,  0.4293,  0.0046, -0.2550],
         [ 0.0776,  0.0199, -0.0106,  ...,  0.0224,  0.0322,  0.1603],
         [-0.1150,  0.1058, -0.4311,  ...,  0.3137, -0.4430,  0.0920]],

        [[ 0.0336, -0.3242, -0.6767,  ...,  0.5369, -0.4851, -0.1381],
         [ 0.2695, -0.6938, -0.3003,  ...,  0.2068, -0.5449, -0.1400],
         [ 0.1457,  0.1164, -0.4732,  ...,  0.0444, -0.3416,  0.0204],
         [ 0.2206,  0.0812, -0.2604,  ...,  0.0093, -0.4457,  0.0163]],

        [[-0.2830, -0.5338, -0.0670,  ...,  0.5683, -0.2345,  0.1375],
         [ 0.0851, -0.8473, -0.4867,  ...,  0.6086, -0.5066, -0.2392],
         [-0.0909, -0.6731, -0.1015,  ...,  0.1703, -0.4731,  0.0164],
         [-0.2905, -0.3549, -0.1986,  ...,  0.2079, -0.3076, -0.1434]],

        ...,

        [[-0.2531, -0.4097, -0.4405,  ...,  0.3563,  0.2139,  0.3235],
         [ 0.1142, -0.5596, -0.6040,  ...,  0.3986,  0.0772,  0.1200],
         [ 0.4984, -0.5801, -0.0063,  ...,  0.3877,  0.4773,  0.0191],
         [ 0.0763, -0.1051, -0.3694,  ...,  0.5103, -0.1017,  0.0436]],

        [[-0.2896,  0.0094, -0.1026,  ...,  0.2528, -0.3201,  0.0749],
         [-0.1328, -0.3403, -0.3301,  ...,  0.2055, -0.2981,  0.0357],
         [ 0.1217, -0.2339, -0.2279,  ...,  0.0532, -0.2268, -0.2274],
         [ 0.1551, -0.2127,  0.0613,  ...,  0.0025, -0.5681,  0.0972]],

        [[ 0.1728, -0.0896, -0.4091,  ..., -0.2124, -0.4596, -0.3444],
         [ 0.5104, -0.3828, -0.5602,  ..., -0.1549, -0.5189, -0.2750],
         [ 0.3518, -0.0186, -0.2977,  ..., -0.0580, -0.4536, -0.3832],
         [ 0.2326,  0.1216,  0.0462,  ..., -0.2527, -0.6344, -0.2021]]],
       grad_fn=<ViewBackward0>)

shape of context vec:  torch.Size([8, 4, 768])
params of the MultiHeadAttention GPT class: 2,360,064
