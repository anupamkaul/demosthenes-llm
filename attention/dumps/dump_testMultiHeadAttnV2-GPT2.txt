python test_MultiHeadAttnV2-GPT2.py 
batch shape:  torch.Size([2, 6, 3]) 

batch: 
 tensor([[[0.4300, 0.1500, 0.8900],
         [0.5500, 0.8700, 0.6600],
         [0.5700, 0.8500, 0.6400],
         [0.2200, 0.5800, 0.3300],
         [0.7700, 0.2500, 0.1000],
         [0.0500, 0.8000, 0.5500]],

        [[0.4300, 0.1500, 0.8900],
         [0.5500, 0.8700, 0.6600],
         [0.5700, 0.8500, 0.6400],
         [0.2200, 0.5800, 0.3300],
         [0.7700, 0.2500, 0.1000],
         [0.0500, 0.8000, 0.5500]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True,  True,  True],
        [False, False,  True,  True,  True,  True],
        [False, False, False,  True,  True,  True],
        [False, False, False, False,  True,  True],
        [False, False, False, False, False,  True],
        [False, False, False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 8.7422e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.8569e-01,  4.9095e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 5.0005e-01,  5.2235e-01,  5.8662e-01,        -inf,        -inf,
                  -inf],
          [ 1.2484e-01, -3.7978e-02,  2.8432e-03, -1.6034e-01,        -inf,
                  -inf],
          [ 6.1865e-01,  9.4258e-01,  9.4015e-01,  5.0068e-01,  6.3192e-01,
                  -inf],
          [ 1.0687e-02, -3.0834e-01, -2.3911e-01, -3.9319e-01,  1.0757e+00,
           -1.0647e+00]],

         [[ 2.8632e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 3.9192e-01, -9.1380e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.1827e-01, -8.8255e-01, -8.8663e-01,        -inf,        -inf,
                  -inf],
          [ 1.2545e-01, -5.9488e-01, -5.9808e-01, -3.8479e-01,        -inf,
                  -inf],
          [ 7.7522e-01, -7.0888e-02, -8.8944e-02, -1.1662e-01, -3.8839e-01,
                  -inf],
          [-1.1147e-01, -9.2637e-01, -9.2142e-01, -5.7858e-01, -5.7250e-01,
           -6.5608e-01]],

         [[-1.4134e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.2384e-01,  1.0531e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.1262e-01,  1.0498e+00,  1.0652e+00,        -inf,        -inf,
                  -inf],
          [-1.5018e-01,  5.1673e-01,  5.2681e-01,  3.1992e-01,        -inf,
                  -inf],
          [ 4.9376e-02,  6.9576e-01,  6.8692e-01,  4.5467e-01,  3.3392e-01,
                  -inf],
          [-2.6577e-01,  5.8987e-01,  6.1125e-01,  3.5206e-01,  8.2385e-01,
            1.6385e-01]],

         [[-1.2559e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-4.2734e-01,  1.4501e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-4.8159e-01,  1.3531e+00,  1.3441e+00,        -inf,        -inf,
                  -inf],
          [ 8.6593e-02,  1.1540e+00,  1.1410e+00,  7.4873e-01,        -inf,
                  -inf],
          [-1.3244e+00, -7.7546e-01, -7.5676e-01, -3.2956e-01, -2.0777e-01,
                  -inf],
          [ 5.8048e-01,  2.1287e+00,  2.1021e+00,  1.3212e+00,  1.0309e+00,
            1.6476e+00]],

         [[-8.1816e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-6.0487e-01, -1.8911e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-6.2133e-01, -1.8619e+00, -1.8755e+00,        -inf,        -inf,
                  -inf],
          [-2.0269e-01, -1.0531e+00, -1.0624e+00, -6.0323e-01,        -inf,
                  -inf],
          [-7.4346e-01, -8.1367e-01, -8.1190e-01, -3.9788e-01, -5.5181e-01,
                  -inf],
          [-7.1743e-02, -1.4033e+00, -1.4192e+00, -8.2527e-01, -1.3048e+00,
           -7.1851e-01]],

         [[ 1.9803e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.6350e-01, -1.9593e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.7890e-01, -1.6844e-01, -1.9402e-01,        -inf,        -inf,
                  -inf],
          [-1.9415e-01, -4.6327e-01, -4.7530e-01, -2.2586e-01,        -inf,
                  -inf],
          [ 4.7964e-01,  3.7609e-01,  3.5860e-01,  2.0983e-01, -5.7219e-02,
                  -inf],
          [-3.1528e-01, -7.1758e-01, -7.3113e-01, -3.6203e-01, -7.6942e-01,
           -2.5791e-01]],

         [[-9.8499e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0762e+00, -3.5207e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0606e+00, -3.4855e+00, -3.4491e+00,        -inf,        -inf,
                  -inf],
          [-1.1923e+00, -1.9968e+00, -1.9823e+00, -1.1064e+00,        -inf,
                  -inf],
          [-1.1999e+00, -1.8697e+00, -1.8056e+00, -1.1668e+00, -1.4224e-01,
                  -inf],
          [-1.4154e+00, -2.4624e+00, -2.4669e+00, -1.3091e+00, -1.8533e+00,
           -1.3566e+00]],

         [[-1.3008e-02,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0550e-02, -9.0600e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0108e-02, -8.6667e-01, -8.5955e-01,        -inf,        -inf,
                  -inf],
          [-3.0957e-02, -5.5643e-01, -5.4953e-01, -3.6451e-01,        -inf,
                  -inf],
          [-2.8033e-02,  8.5726e-02,  7.9430e-02,  7.6331e-02, -5.6458e-02,
                  -inf],
          [-3.6888e-02, -9.6809e-01, -9.5490e-01, -6.4024e-01, -4.4791e-01,
           -7.9721e-01]],

         [[-2.1099e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0936e+00, -1.2344e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0820e+00, -1.2125e+00, -1.1928e+00,        -inf,        -inf,
                  -inf],
          [-3.8388e-01, -5.2035e-01, -5.0329e-01, -3.1453e-01,        -inf,
                  -inf],
          [-5.7045e-01, -4.7748e-01, -4.9303e-01, -1.6474e-01, -6.3462e-01,
                  -inf],
          [-5.4788e-01, -7.8675e-01, -7.5322e-01, -5.0285e-01,  6.2778e-02,
           -8.5309e-01]],

         [[ 4.4400e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 6.9734e-01,  1.0284e+00,        -inf,        -inf,        -inf,
                  -inf],
          [ 7.0830e-01,  1.0206e+00,  9.7465e-01,        -inf,        -inf,
                  -inf],
          [ 3.3620e-01,  5.4089e-01,  5.1346e-01,  3.6467e-01,        -inf,
                  -inf],
          [ 7.0632e-01,  5.9389e-01,  5.6643e-01,  3.3902e-01, -8.7288e-02,
                  -inf],
          [ 2.5745e-01,  6.5458e-01,  6.2260e-01,  4.6168e-01, -1.2897e-01,
            7.9036e-01]],

         [[-6.2324e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5838e+00, -6.9820e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5682e+00, -6.8128e-01, -6.9445e-01,        -inf,        -inf,
                  -inf],
          [-9.4033e-01, -5.7822e-01, -5.8654e-01, -1.8972e-01,        -inf,
                  -inf],
          [-8.4696e-01, -1.8365e-01, -1.7301e-01, -1.0733e-02,  6.6598e-02,
                  -inf],
          [-1.1442e+00, -7.5689e-01, -7.7655e-01, -2.3712e-01, -9.1286e-01,
           -8.3307e-02]],

         [[-5.5726e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5160e+00, -3.5523e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.4871e+00, -3.6168e-01, -3.6802e-01,        -inf,        -inf,
                  -inf],
          [-9.4638e-01, -1.9490e-01, -1.9755e-01,  3.6012e-02,        -inf,
                  -inf],
          [-5.4812e-01, -3.7603e-01, -3.8357e-01, -1.2740e-01, -4.1179e-01,
                  -inf],
          [-1.2751e+00, -1.4495e-01, -1.4625e-01,  1.1598e-01, -1.2986e-01,
            1.1249e-01]]],


        [[[ 8.7422e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.8569e-01,  4.9095e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 5.0005e-01,  5.2235e-01,  5.8662e-01,        -inf,        -inf,
                  -inf],
          [ 1.2484e-01, -3.7978e-02,  2.8432e-03, -1.6034e-01,        -inf,
                  -inf],
          [ 6.1865e-01,  9.4258e-01,  9.4015e-01,  5.0068e-01,  6.3192e-01,
                  -inf],
          [ 1.0687e-02, -3.0834e-01, -2.3911e-01, -3.9319e-01,  1.0757e+00,
           -1.0647e+00]],

         [[ 2.8632e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 3.9192e-01, -9.1380e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.1827e-01, -8.8255e-01, -8.8663e-01,        -inf,        -inf,
                  -inf],
          [ 1.2545e-01, -5.9488e-01, -5.9808e-01, -3.8479e-01,        -inf,
                  -inf],
          [ 7.7522e-01, -7.0888e-02, -8.8944e-02, -1.1662e-01, -3.8839e-01,
                  -inf],
          [-1.1147e-01, -9.2637e-01, -9.2142e-01, -5.7858e-01, -5.7250e-01,
           -6.5608e-01]],

         [[-1.4134e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.2384e-01,  1.0531e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.1262e-01,  1.0498e+00,  1.0652e+00,        -inf,        -inf,
                  -inf],
          [-1.5018e-01,  5.1673e-01,  5.2681e-01,  3.1992e-01,        -inf,
                  -inf],
          [ 4.9376e-02,  6.9576e-01,  6.8692e-01,  4.5467e-01,  3.3392e-01,
                  -inf],
          [-2.6577e-01,  5.8987e-01,  6.1125e-01,  3.5206e-01,  8.2385e-01,
            1.6385e-01]],

         [[-1.2559e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-4.2734e-01,  1.4501e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-4.8159e-01,  1.3531e+00,  1.3441e+00,        -inf,        -inf,
                  -inf],
          [ 8.6593e-02,  1.1540e+00,  1.1410e+00,  7.4873e-01,        -inf,
                  -inf],
          [-1.3244e+00, -7.7546e-01, -7.5676e-01, -3.2956e-01, -2.0777e-01,
                  -inf],
          [ 5.8048e-01,  2.1287e+00,  2.1021e+00,  1.3212e+00,  1.0309e+00,
            1.6476e+00]],

         [[-8.1816e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-6.0487e-01, -1.8911e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-6.2133e-01, -1.8619e+00, -1.8755e+00,        -inf,        -inf,
                  -inf],
          [-2.0269e-01, -1.0531e+00, -1.0624e+00, -6.0323e-01,        -inf,
                  -inf],
          [-7.4346e-01, -8.1367e-01, -8.1190e-01, -3.9788e-01, -5.5181e-01,
                  -inf],
          [-7.1743e-02, -1.4033e+00, -1.4192e+00, -8.2527e-01, -1.3048e+00,
           -7.1851e-01]],

         [[ 1.9803e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.6350e-01, -1.9593e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.7890e-01, -1.6844e-01, -1.9402e-01,        -inf,        -inf,
                  -inf],
          [-1.9415e-01, -4.6327e-01, -4.7530e-01, -2.2586e-01,        -inf,
                  -inf],
          [ 4.7964e-01,  3.7609e-01,  3.5860e-01,  2.0983e-01, -5.7219e-02,
                  -inf],
          [-3.1528e-01, -7.1758e-01, -7.3113e-01, -3.6203e-01, -7.6942e-01,
           -2.5791e-01]],

         [[-9.8499e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0762e+00, -3.5207e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0606e+00, -3.4855e+00, -3.4491e+00,        -inf,        -inf,
                  -inf],
          [-1.1923e+00, -1.9968e+00, -1.9823e+00, -1.1064e+00,        -inf,
                  -inf],
          [-1.1999e+00, -1.8697e+00, -1.8056e+00, -1.1668e+00, -1.4224e-01,
                  -inf],
          [-1.4154e+00, -2.4624e+00, -2.4669e+00, -1.3091e+00, -1.8533e+00,
           -1.3566e+00]],

         [[-1.3008e-02,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0550e-02, -9.0600e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0108e-02, -8.6667e-01, -8.5955e-01,        -inf,        -inf,
                  -inf],
          [-3.0957e-02, -5.5643e-01, -5.4953e-01, -3.6451e-01,        -inf,
                  -inf],
          [-2.8033e-02,  8.5726e-02,  7.9430e-02,  7.6331e-02, -5.6458e-02,
                  -inf],
          [-3.6888e-02, -9.6809e-01, -9.5490e-01, -6.4024e-01, -4.4791e-01,
           -7.9721e-01]],

         [[-2.1099e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0936e+00, -1.2344e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0820e+00, -1.2125e+00, -1.1928e+00,        -inf,        -inf,
                  -inf],
          [-3.8388e-01, -5.2035e-01, -5.0329e-01, -3.1453e-01,        -inf,
                  -inf],
          [-5.7045e-01, -4.7748e-01, -4.9303e-01, -1.6474e-01, -6.3462e-01,
                  -inf],
          [-5.4788e-01, -7.8675e-01, -7.5322e-01, -5.0285e-01,  6.2778e-02,
           -8.5309e-01]],

         [[ 4.4400e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 6.9734e-01,  1.0284e+00,        -inf,        -inf,        -inf,
                  -inf],
          [ 7.0830e-01,  1.0206e+00,  9.7465e-01,        -inf,        -inf,
                  -inf],
          [ 3.3620e-01,  5.4089e-01,  5.1346e-01,  3.6467e-01,        -inf,
                  -inf],
          [ 7.0632e-01,  5.9389e-01,  5.6643e-01,  3.3902e-01, -8.7288e-02,
                  -inf],
          [ 2.5745e-01,  6.5458e-01,  6.2260e-01,  4.6168e-01, -1.2897e-01,
            7.9036e-01]],

         [[-6.2324e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5838e+00, -6.9820e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5682e+00, -6.8128e-01, -6.9445e-01,        -inf,        -inf,
                  -inf],
          [-9.4033e-01, -5.7822e-01, -5.8654e-01, -1.8972e-01,        -inf,
                  -inf],
          [-8.4696e-01, -1.8365e-01, -1.7301e-01, -1.0733e-02,  6.6598e-02,
                  -inf],
          [-1.1442e+00, -7.5689e-01, -7.7655e-01, -2.3712e-01, -9.1286e-01,
           -8.3307e-02]],

         [[-5.5726e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5160e+00, -3.5523e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.4871e+00, -3.6168e-01, -3.6802e-01,        -inf,        -inf,
                  -inf],
          [-9.4638e-01, -1.9490e-01, -1.9755e-01,  3.6012e-02,        -inf,
                  -inf],
          [-5.4812e-01, -3.7603e-01, -3.8357e-01, -1.2740e-01, -4.1179e-01,
                  -inf],
          [-1.2751e+00, -1.4495e-01, -1.4625e-01,  1.1598e-01, -1.2986e-01,
            1.1249e-01]]]], grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 8.7422e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.8569e-01,  4.9095e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 5.0005e-01,  5.2235e-01,  5.8662e-01,        -inf,        -inf,
                  -inf],
          [ 1.2484e-01, -3.7978e-02,  2.8432e-03, -1.6034e-01,        -inf,
                  -inf],
          [ 6.1865e-01,  9.4258e-01,  9.4015e-01,  5.0068e-01,  6.3192e-01,
                  -inf],
          [ 1.0687e-02, -3.0834e-01, -2.3911e-01, -3.9319e-01,  1.0757e+00,
           -1.0647e+00]],

         [[ 2.8632e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 3.9192e-01, -9.1380e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.1827e-01, -8.8255e-01, -8.8663e-01,        -inf,        -inf,
                  -inf],
          [ 1.2545e-01, -5.9488e-01, -5.9808e-01, -3.8479e-01,        -inf,
                  -inf],
          [ 7.7522e-01, -7.0888e-02, -8.8944e-02, -1.1662e-01, -3.8839e-01,
                  -inf],
          [-1.1147e-01, -9.2637e-01, -9.2142e-01, -5.7858e-01, -5.7250e-01,
           -6.5608e-01]],

         [[-1.4134e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.2384e-01,  1.0531e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.1262e-01,  1.0498e+00,  1.0652e+00,        -inf,        -inf,
                  -inf],
          [-1.5018e-01,  5.1673e-01,  5.2681e-01,  3.1992e-01,        -inf,
                  -inf],
          [ 4.9376e-02,  6.9576e-01,  6.8692e-01,  4.5467e-01,  3.3392e-01,
                  -inf],
          [-2.6577e-01,  5.8987e-01,  6.1125e-01,  3.5206e-01,  8.2385e-01,
            1.6385e-01]],

         [[-1.2559e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-4.2734e-01,  1.4501e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-4.8159e-01,  1.3531e+00,  1.3441e+00,        -inf,        -inf,
                  -inf],
          [ 8.6593e-02,  1.1540e+00,  1.1410e+00,  7.4873e-01,        -inf,
                  -inf],
          [-1.3244e+00, -7.7546e-01, -7.5676e-01, -3.2956e-01, -2.0777e-01,
                  -inf],
          [ 5.8048e-01,  2.1287e+00,  2.1021e+00,  1.3212e+00,  1.0309e+00,
            1.6476e+00]],

         [[-8.1816e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-6.0487e-01, -1.8911e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-6.2133e-01, -1.8619e+00, -1.8755e+00,        -inf,        -inf,
                  -inf],
          [-2.0269e-01, -1.0531e+00, -1.0624e+00, -6.0323e-01,        -inf,
                  -inf],
          [-7.4346e-01, -8.1367e-01, -8.1190e-01, -3.9788e-01, -5.5181e-01,
                  -inf],
          [-7.1743e-02, -1.4033e+00, -1.4192e+00, -8.2527e-01, -1.3048e+00,
           -7.1851e-01]],

         [[ 1.9803e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.6350e-01, -1.9593e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.7890e-01, -1.6844e-01, -1.9402e-01,        -inf,        -inf,
                  -inf],
          [-1.9415e-01, -4.6327e-01, -4.7530e-01, -2.2586e-01,        -inf,
                  -inf],
          [ 4.7964e-01,  3.7609e-01,  3.5860e-01,  2.0983e-01, -5.7219e-02,
                  -inf],
          [-3.1528e-01, -7.1758e-01, -7.3113e-01, -3.6203e-01, -7.6942e-01,
           -2.5791e-01]],

         [[-9.8499e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0762e+00, -3.5207e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0606e+00, -3.4855e+00, -3.4491e+00,        -inf,        -inf,
                  -inf],
          [-1.1923e+00, -1.9968e+00, -1.9823e+00, -1.1064e+00,        -inf,
                  -inf],
          [-1.1999e+00, -1.8697e+00, -1.8056e+00, -1.1668e+00, -1.4224e-01,
                  -inf],
          [-1.4154e+00, -2.4624e+00, -2.4669e+00, -1.3091e+00, -1.8533e+00,
           -1.3566e+00]],

         [[-1.3008e-02,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0550e-02, -9.0600e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0108e-02, -8.6667e-01, -8.5955e-01,        -inf,        -inf,
                  -inf],
          [-3.0957e-02, -5.5643e-01, -5.4953e-01, -3.6451e-01,        -inf,
                  -inf],
          [-2.8033e-02,  8.5726e-02,  7.9430e-02,  7.6331e-02, -5.6458e-02,
                  -inf],
          [-3.6888e-02, -9.6809e-01, -9.5490e-01, -6.4024e-01, -4.4791e-01,
           -7.9721e-01]],

         [[-2.1099e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0936e+00, -1.2344e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0820e+00, -1.2125e+00, -1.1928e+00,        -inf,        -inf,
                  -inf],
          [-3.8388e-01, -5.2035e-01, -5.0329e-01, -3.1453e-01,        -inf,
                  -inf],
          [-5.7045e-01, -4.7748e-01, -4.9303e-01, -1.6474e-01, -6.3462e-01,
                  -inf],
          [-5.4788e-01, -7.8675e-01, -7.5322e-01, -5.0285e-01,  6.2778e-02,
           -8.5309e-01]],

         [[ 4.4400e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 6.9734e-01,  1.0284e+00,        -inf,        -inf,        -inf,
                  -inf],
          [ 7.0830e-01,  1.0206e+00,  9.7465e-01,        -inf,        -inf,
                  -inf],
          [ 3.3620e-01,  5.4089e-01,  5.1346e-01,  3.6467e-01,        -inf,
                  -inf],
          [ 7.0632e-01,  5.9389e-01,  5.6643e-01,  3.3902e-01, -8.7288e-02,
                  -inf],
          [ 2.5745e-01,  6.5458e-01,  6.2260e-01,  4.6168e-01, -1.2897e-01,
            7.9036e-01]],

         [[-6.2324e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5838e+00, -6.9820e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5682e+00, -6.8128e-01, -6.9445e-01,        -inf,        -inf,
                  -inf],
          [-9.4033e-01, -5.7822e-01, -5.8654e-01, -1.8972e-01,        -inf,
                  -inf],
          [-8.4696e-01, -1.8365e-01, -1.7301e-01, -1.0733e-02,  6.6598e-02,
                  -inf],
          [-1.1442e+00, -7.5689e-01, -7.7655e-01, -2.3712e-01, -9.1286e-01,
           -8.3307e-02]],

         [[-5.5726e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5160e+00, -3.5523e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.4871e+00, -3.6168e-01, -3.6802e-01,        -inf,        -inf,
                  -inf],
          [-9.4638e-01, -1.9490e-01, -1.9755e-01,  3.6012e-02,        -inf,
                  -inf],
          [-5.4812e-01, -3.7603e-01, -3.8357e-01, -1.2740e-01, -4.1179e-01,
                  -inf],
          [-1.2751e+00, -1.4495e-01, -1.4625e-01,  1.1598e-01, -1.2986e-01,
            1.1249e-01]]],


        [[[ 8.7422e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.8569e-01,  4.9095e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 5.0005e-01,  5.2235e-01,  5.8662e-01,        -inf,        -inf,
                  -inf],
          [ 1.2484e-01, -3.7978e-02,  2.8432e-03, -1.6034e-01,        -inf,
                  -inf],
          [ 6.1865e-01,  9.4258e-01,  9.4015e-01,  5.0068e-01,  6.3192e-01,
                  -inf],
          [ 1.0687e-02, -3.0834e-01, -2.3911e-01, -3.9319e-01,  1.0757e+00,
           -1.0647e+00]],

         [[ 2.8632e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 3.9192e-01, -9.1380e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 4.1827e-01, -8.8255e-01, -8.8663e-01,        -inf,        -inf,
                  -inf],
          [ 1.2545e-01, -5.9488e-01, -5.9808e-01, -3.8479e-01,        -inf,
                  -inf],
          [ 7.7522e-01, -7.0888e-02, -8.8944e-02, -1.1662e-01, -3.8839e-01,
                  -inf],
          [-1.1147e-01, -9.2637e-01, -9.2142e-01, -5.7858e-01, -5.7250e-01,
           -6.5608e-01]],

         [[-1.4134e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.2384e-01,  1.0531e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.1262e-01,  1.0498e+00,  1.0652e+00,        -inf,        -inf,
                  -inf],
          [-1.5018e-01,  5.1673e-01,  5.2681e-01,  3.1992e-01,        -inf,
                  -inf],
          [ 4.9376e-02,  6.9576e-01,  6.8692e-01,  4.5467e-01,  3.3392e-01,
                  -inf],
          [-2.6577e-01,  5.8987e-01,  6.1125e-01,  3.5206e-01,  8.2385e-01,
            1.6385e-01]],

         [[-1.2559e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-4.2734e-01,  1.4501e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-4.8159e-01,  1.3531e+00,  1.3441e+00,        -inf,        -inf,
                  -inf],
          [ 8.6593e-02,  1.1540e+00,  1.1410e+00,  7.4873e-01,        -inf,
                  -inf],
          [-1.3244e+00, -7.7546e-01, -7.5676e-01, -3.2956e-01, -2.0777e-01,
                  -inf],
          [ 5.8048e-01,  2.1287e+00,  2.1021e+00,  1.3212e+00,  1.0309e+00,
            1.6476e+00]],

         [[-8.1816e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-6.0487e-01, -1.8911e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-6.2133e-01, -1.8619e+00, -1.8755e+00,        -inf,        -inf,
                  -inf],
          [-2.0269e-01, -1.0531e+00, -1.0624e+00, -6.0323e-01,        -inf,
                  -inf],
          [-7.4346e-01, -8.1367e-01, -8.1190e-01, -3.9788e-01, -5.5181e-01,
                  -inf],
          [-7.1743e-02, -1.4033e+00, -1.4192e+00, -8.2527e-01, -1.3048e+00,
           -7.1851e-01]],

         [[ 1.9803e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.6350e-01, -1.9593e-01,        -inf,        -inf,        -inf,
                  -inf],
          [ 2.7890e-01, -1.6844e-01, -1.9402e-01,        -inf,        -inf,
                  -inf],
          [-1.9415e-01, -4.6327e-01, -4.7530e-01, -2.2586e-01,        -inf,
                  -inf],
          [ 4.7964e-01,  3.7609e-01,  3.5860e-01,  2.0983e-01, -5.7219e-02,
                  -inf],
          [-3.1528e-01, -7.1758e-01, -7.3113e-01, -3.6203e-01, -7.6942e-01,
           -2.5791e-01]],

         [[-9.8499e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0762e+00, -3.5207e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-2.0606e+00, -3.4855e+00, -3.4491e+00,        -inf,        -inf,
                  -inf],
          [-1.1923e+00, -1.9968e+00, -1.9823e+00, -1.1064e+00,        -inf,
                  -inf],
          [-1.1999e+00, -1.8697e+00, -1.8056e+00, -1.1668e+00, -1.4224e-01,
                  -inf],
          [-1.4154e+00, -2.4624e+00, -2.4669e+00, -1.3091e+00, -1.8533e+00,
           -1.3566e+00]],

         [[-1.3008e-02,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0550e-02, -9.0600e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-5.0108e-02, -8.6667e-01, -8.5955e-01,        -inf,        -inf,
                  -inf],
          [-3.0957e-02, -5.5643e-01, -5.4953e-01, -3.6451e-01,        -inf,
                  -inf],
          [-2.8033e-02,  8.5726e-02,  7.9430e-02,  7.6331e-02, -5.6458e-02,
                  -inf],
          [-3.6888e-02, -9.6809e-01, -9.5490e-01, -6.4024e-01, -4.4791e-01,
           -7.9721e-01]],

         [[-2.1099e+00,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0936e+00, -1.2344e+00,        -inf,        -inf,        -inf,
                  -inf],
          [-1.0820e+00, -1.2125e+00, -1.1928e+00,        -inf,        -inf,
                  -inf],
          [-3.8388e-01, -5.2035e-01, -5.0329e-01, -3.1453e-01,        -inf,
                  -inf],
          [-5.7045e-01, -4.7748e-01, -4.9303e-01, -1.6474e-01, -6.3462e-01,
                  -inf],
          [-5.4788e-01, -7.8675e-01, -7.5322e-01, -5.0285e-01,  6.2778e-02,
           -8.5309e-01]],

         [[ 4.4400e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [ 6.9734e-01,  1.0284e+00,        -inf,        -inf,        -inf,
                  -inf],
          [ 7.0830e-01,  1.0206e+00,  9.7465e-01,        -inf,        -inf,
                  -inf],
          [ 3.3620e-01,  5.4089e-01,  5.1346e-01,  3.6467e-01,        -inf,
                  -inf],
          [ 7.0632e-01,  5.9389e-01,  5.6643e-01,  3.3902e-01, -8.7288e-02,
                  -inf],
          [ 2.5745e-01,  6.5458e-01,  6.2260e-01,  4.6168e-01, -1.2897e-01,
            7.9036e-01]],

         [[-6.2324e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5838e+00, -6.9820e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5682e+00, -6.8128e-01, -6.9445e-01,        -inf,        -inf,
                  -inf],
          [-9.4033e-01, -5.7822e-01, -5.8654e-01, -1.8972e-01,        -inf,
                  -inf],
          [-8.4696e-01, -1.8365e-01, -1.7301e-01, -1.0733e-02,  6.6598e-02,
                  -inf],
          [-1.1442e+00, -7.5689e-01, -7.7655e-01, -2.3712e-01, -9.1286e-01,
           -8.3307e-02]],

         [[-5.5726e-01,        -inf,        -inf,        -inf,        -inf,
                  -inf],
          [-1.5160e+00, -3.5523e-01,        -inf,        -inf,        -inf,
                  -inf],
          [-1.4871e+00, -3.6168e-01, -3.6802e-01,        -inf,        -inf,
                  -inf],
          [-9.4638e-01, -1.9490e-01, -1.9755e-01,  3.6012e-02,        -inf,
                  -inf],
          [-5.4812e-01, -3.7603e-01, -3.8357e-01, -1.2740e-01, -4.1179e-01,
                  -inf],
          [-1.2751e+00, -1.4495e-01, -1.4625e-01,  1.1598e-01, -1.2986e-01,
            1.1249e-01]]]], grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.2674, -0.3658,  0.1773,  ..., -0.2585,  0.1683,  0.2244],
          [-0.0580,  0.3409, -0.1899,  ...,  0.1820,  0.4896, -0.0519],
          [-0.6887, -0.1940,  0.1050,  ...,  0.4398,  0.5306, -0.4935],
          ...,
          [ 0.0956, -0.4877,  0.0307,  ..., -0.0141, -0.0886,  0.5309],
          [-0.0946,  0.4608,  0.1187,  ...,  0.2358, -0.1993,  0.1392],
          [ 0.2961,  0.0607, -0.3782,  ...,  0.1044,  0.3099, -0.5199]],

         [[-0.3518, -0.1269,  0.2433,  ..., -0.3439,  0.0178,  0.0854],
          [ 0.0883,  0.5115,  0.0491,  ...,  0.0101,  0.4513, -0.1416],
          [-0.7309, -0.1537,  0.0368,  ...,  0.2309,  0.4801, -0.6930],
          ...,
          [-0.0408, -0.3964,  0.1875,  ...,  0.1532, -0.1170,  0.3856],
          [ 0.1218,  0.6498,  0.1602,  ...,  0.0451, -0.1137, -0.0564],
          [ 0.5386,  0.3331, -0.4252,  ...,  0.0924,  0.3853, -0.4836]],

         [[-0.3740, -0.0477,  0.2659,  ..., -0.3639, -0.0289,  0.0379],
          [ 0.1383,  0.5738,  0.1374,  ..., -0.0532,  0.4370, -0.1695],
          [-0.7420, -0.1383,  0.0101,  ...,  0.1703,  0.4611, -0.7502],
          ...,
          [-0.0878, -0.3648,  0.2354,  ...,  0.2015, -0.1242,  0.3416],
          [ 0.1903,  0.7031,  0.1767,  ..., -0.0083, -0.0820, -0.1123],
          [ 0.6111,  0.4153, -0.4348,  ...,  0.0939,  0.4037, -0.4690]],

         [[-0.3512, -0.0040,  0.2400,  ..., -0.3481, -0.0556,  0.0144],
          [ 0.1603,  0.5357,  0.1696,  ..., -0.0829,  0.3714, -0.1783],
          [-0.6516, -0.1224,  0.0147,  ...,  0.1193,  0.4025, -0.6788],
          ...,
          [-0.0896, -0.3083,  0.2332,  ...,  0.2120, -0.1163,  0.2691],
          [ 0.1884,  0.6418,  0.1491,  ..., -0.0449, -0.0713, -0.1327],
          [ 0.5593,  0.3928, -0.3911,  ...,  0.0675,  0.3673, -0.4073]],

         [[-0.2772,  0.0032,  0.2422,  ..., -0.2463, -0.0234, -0.0066],
          [ 0.1172,  0.5206,  0.1777,  ..., -0.0870,  0.3571, -0.1176],
          [-0.6163, -0.0802, -0.0586,  ...,  0.1229,  0.3437, -0.6428],
          ...,
          [-0.1263, -0.2705,  0.2065,  ...,  0.1546, -0.0940,  0.2834],
          [ 0.2174,  0.5757,  0.1896,  ...,  0.0063, -0.0033, -0.0910],
          [ 0.5482,  0.3971, -0.3312,  ...,  0.1216,  0.3130, -0.3539]],

         [[-0.2953,  0.0249,  0.2292,  ..., -0.2786, -0.0508, -0.0118],
          [ 0.1535,  0.5083,  0.1923,  ..., -0.1022,  0.3281, -0.1559],
          [-0.5882, -0.0917, -0.0216,  ...,  0.0862,  0.3408, -0.6311],
          ...,
          [-0.1089, -0.2584,  0.2272,  ...,  0.2021, -0.1043,  0.2276],
          [ 0.2047,  0.5905,  0.1496,  ..., -0.0530, -0.0382, -0.1354],
          [ 0.5375,  0.3947, -0.3441,  ...,  0.0756,  0.3279, -0.3496]]],


        [[[-0.2674, -0.3658,  0.1773,  ..., -0.2585,  0.1683,  0.2244],
          [-0.0580,  0.3409, -0.1899,  ...,  0.1820,  0.4896, -0.0519],
          [-0.6887, -0.1940,  0.1050,  ...,  0.4398,  0.5306, -0.4935],
          ...,
          [ 0.0956, -0.4877,  0.0307,  ..., -0.0141, -0.0886,  0.5309],
          [-0.0946,  0.4608,  0.1187,  ...,  0.2358, -0.1993,  0.1392],
          [ 0.2961,  0.0607, -0.3782,  ...,  0.1044,  0.3099, -0.5199]],

         [[-0.3518, -0.1269,  0.2433,  ..., -0.3439,  0.0178,  0.0854],
          [ 0.0883,  0.5115,  0.0491,  ...,  0.0101,  0.4513, -0.1416],
          [-0.7309, -0.1537,  0.0368,  ...,  0.2309,  0.4801, -0.6930],
          ...,
          [-0.0408, -0.3964,  0.1875,  ...,  0.1532, -0.1170,  0.3856],
          [ 0.1218,  0.6498,  0.1602,  ...,  0.0451, -0.1137, -0.0564],
          [ 0.5386,  0.3331, -0.4252,  ...,  0.0924,  0.3853, -0.4836]],

         [[-0.3740, -0.0477,  0.2659,  ..., -0.3639, -0.0289,  0.0379],
          [ 0.1383,  0.5738,  0.1374,  ..., -0.0532,  0.4370, -0.1695],
          [-0.7420, -0.1383,  0.0101,  ...,  0.1703,  0.4611, -0.7502],
          ...,
          [-0.0878, -0.3648,  0.2354,  ...,  0.2015, -0.1242,  0.3416],
          [ 0.1903,  0.7031,  0.1767,  ..., -0.0083, -0.0820, -0.1123],
          [ 0.6111,  0.4153, -0.4348,  ...,  0.0939,  0.4037, -0.4690]],

         [[-0.3512, -0.0040,  0.2400,  ..., -0.3481, -0.0556,  0.0144],
          [ 0.1603,  0.5357,  0.1696,  ..., -0.0829,  0.3714, -0.1783],
          [-0.6516, -0.1224,  0.0147,  ...,  0.1193,  0.4025, -0.6788],
          ...,
          [-0.0896, -0.3083,  0.2332,  ...,  0.2120, -0.1163,  0.2691],
          [ 0.1884,  0.6418,  0.1491,  ..., -0.0449, -0.0713, -0.1327],
          [ 0.5593,  0.3928, -0.3911,  ...,  0.0675,  0.3673, -0.4073]],

         [[-0.2772,  0.0032,  0.2422,  ..., -0.2463, -0.0234, -0.0066],
          [ 0.1172,  0.5206,  0.1777,  ..., -0.0870,  0.3571, -0.1176],
          [-0.6163, -0.0802, -0.0586,  ...,  0.1229,  0.3437, -0.6428],
          ...,
          [-0.1263, -0.2705,  0.2065,  ...,  0.1546, -0.0940,  0.2834],
          [ 0.2174,  0.5757,  0.1896,  ...,  0.0063, -0.0033, -0.0910],
          [ 0.5482,  0.3971, -0.3312,  ...,  0.1216,  0.3130, -0.3539]],

         [[-0.2953,  0.0249,  0.2292,  ..., -0.2786, -0.0508, -0.0118],
          [ 0.1535,  0.5083,  0.1923,  ..., -0.1022,  0.3281, -0.1559],
          [-0.5882, -0.0917, -0.0216,  ...,  0.0862,  0.3408, -0.6311],
          ...,
          [-0.1089, -0.2584,  0.2272,  ...,  0.2021, -0.1043,  0.2276],
          [ 0.2047,  0.5905,  0.1496,  ..., -0.0530, -0.0382, -0.1354],
          [ 0.5375,  0.3947, -0.3441,  ...,  0.0756,  0.3279, -0.3496]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.2674, -0.3658,  0.1773,  ...,  0.1044,  0.3099, -0.5199],
         [-0.3518, -0.1269,  0.2433,  ...,  0.0924,  0.3853, -0.4836],
         [-0.3740, -0.0477,  0.2659,  ...,  0.0939,  0.4037, -0.4690],
         [-0.3512, -0.0040,  0.2400,  ...,  0.0675,  0.3673, -0.4073],
         [-0.2772,  0.0032,  0.2422,  ...,  0.1216,  0.3130, -0.3539],
         [-0.2953,  0.0249,  0.2292,  ...,  0.0756,  0.3279, -0.3496]],

        [[-0.2674, -0.3658,  0.1773,  ...,  0.1044,  0.3099, -0.5199],
         [-0.3518, -0.1269,  0.2433,  ...,  0.0924,  0.3853, -0.4836],
         [-0.3740, -0.0477,  0.2659,  ...,  0.0939,  0.4037, -0.4690],
         [-0.3512, -0.0040,  0.2400,  ...,  0.0675,  0.3673, -0.4073],
         [-0.2772,  0.0032,  0.2422,  ...,  0.1216,  0.3130, -0.3539],
         [-0.2953,  0.0249,  0.2292,  ...,  0.0756,  0.3279, -0.3496]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0208, -0.1094, -0.1502,  ...,  0.3617,  0.2821,  0.0099],
         [-0.0732, -0.1550, -0.1058,  ...,  0.4179,  0.2185,  0.0626],
         [-0.1013, -0.1662, -0.0936,  ...,  0.4298,  0.1946,  0.0779],
         [-0.1035, -0.1574, -0.0720,  ...,  0.3876,  0.1603,  0.0761],
         [-0.0765, -0.1191, -0.0922,  ...,  0.3362,  0.1465,  0.0587],
         [-0.0913, -0.1358, -0.0698,  ...,  0.3519,  0.1339,  0.0640]],

        [[ 0.0208, -0.1094, -0.1502,  ...,  0.3617,  0.2821,  0.0099],
         [-0.0732, -0.1550, -0.1058,  ...,  0.4179,  0.2185,  0.0626],
         [-0.1013, -0.1662, -0.0936,  ...,  0.4298,  0.1946,  0.0779],
         [-0.1035, -0.1574, -0.0720,  ...,  0.3876,  0.1603,  0.0761],
         [-0.0765, -0.1191, -0.0922,  ...,  0.3362,  0.1465,  0.0587],
         [-0.0913, -0.1358, -0.0698,  ...,  0.3519,  0.1339,  0.0640]]],
       grad_fn=<ViewBackward0>)
context vecs:
 tensor([[[ 0.0208, -0.1094, -0.1502,  ...,  0.3617,  0.2821,  0.0099],
         [-0.0732, -0.1550, -0.1058,  ...,  0.4179,  0.2185,  0.0626],
         [-0.1013, -0.1662, -0.0936,  ...,  0.4298,  0.1946,  0.0779],
         [-0.1035, -0.1574, -0.0720,  ...,  0.3876,  0.1603,  0.0761],
         [-0.0765, -0.1191, -0.0922,  ...,  0.3362,  0.1465,  0.0587],
         [-0.0913, -0.1358, -0.0698,  ...,  0.3519,  0.1339,  0.0640]],

        [[ 0.0208, -0.1094, -0.1502,  ...,  0.3617,  0.2821,  0.0099],
         [-0.0732, -0.1550, -0.1058,  ...,  0.4179,  0.2185,  0.0626],
         [-0.1013, -0.1662, -0.0936,  ...,  0.4298,  0.1946,  0.0779],
         [-0.1035, -0.1574, -0.0720,  ...,  0.3876,  0.1603,  0.0761],
         [-0.0765, -0.1191, -0.0922,  ...,  0.3362,  0.1465,  0.0587],
         [-0.0913, -0.1358, -0.0698,  ...,  0.3519,  0.1339,  0.0640]]],
       grad_fn=<ViewBackward0>)

