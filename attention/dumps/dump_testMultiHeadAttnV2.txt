batch shape:  torch.Size([2, 6, 3]) 

batch: 
 tensor([[[0.4300, 0.1500, 0.8900],
         [0.5500, 0.8700, 0.6600],
         [0.5700, 0.8500, 0.6400],
         [0.2200, 0.5800, 0.3300],
         [0.7700, 0.2500, 0.1000],
         [0.0500, 0.8000, 0.5500]],

        [[0.4300, 0.1500, 0.8900],
         [0.5500, 0.8700, 0.6600],
         [0.5700, 0.8500, 0.6400],
         [0.2200, 0.5800, 0.3300],
         [0.7700, 0.2500, 0.1000],
         [0.0500, 0.8000, 0.5500]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True,  True,  True],
        [False, False,  True,  True,  True,  True],
        [False, False, False,  True,  True,  True],
        [False, False, False, False,  True,  True],
        [False, False, False, False, False,  True],
        [False, False, False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.2029,    -inf,    -inf,    -inf,    -inf,    -inf],
          [ 0.1734,  0.2631,    -inf,    -inf,    -inf,    -inf],
          [ 0.1730,  0.2625,  0.2601,    -inf,    -inf,    -inf],
          [ 0.0777,  0.1179,  0.1168,  0.0648,    -inf,    -inf],
          [ 0.1178,  0.1787,  0.1770,  0.0983,  0.0973,    -inf],
          [ 0.0885,  0.1343,  0.1330,  0.0738,  0.0731,  0.0908]],

         [[ 0.1081,    -inf,    -inf,    -inf,    -inf,    -inf],
          [-0.0079, -0.0029,    -inf,    -inf,    -inf,    -inf],
          [-0.0063, -0.0023, -0.0025,    -inf,    -inf,    -inf],
          [-0.0267, -0.0099, -0.0104, -0.0005,    -inf,    -inf],
          [ 0.0237,  0.0088,  0.0092,  0.0004,  0.0148,    -inf],
          [-0.0409, -0.0151, -0.0159, -0.0008, -0.0254,  0.0058]]],


        [[[ 0.2029,    -inf,    -inf,    -inf,    -inf,    -inf],
          [ 0.1734,  0.2631,    -inf,    -inf,    -inf,    -inf],
          [ 0.1730,  0.2625,  0.2601,    -inf,    -inf,    -inf],
          [ 0.0777,  0.1179,  0.1168,  0.0648,    -inf,    -inf],
          [ 0.1178,  0.1787,  0.1770,  0.0983,  0.0973,    -inf],
          [ 0.0885,  0.1343,  0.1330,  0.0738,  0.0731,  0.0908]],

         [[ 0.1081,    -inf,    -inf,    -inf,    -inf,    -inf],
          [-0.0079, -0.0029,    -inf,    -inf,    -inf,    -inf],
          [-0.0063, -0.0023, -0.0025,    -inf,    -inf,    -inf],
          [-0.0267, -0.0099, -0.0104, -0.0005,    -inf,    -inf],
          [ 0.0237,  0.0088,  0.0092,  0.0004,  0.0148,    -inf],
          [-0.0409, -0.0151, -0.0159, -0.0008, -0.0254,  0.0058]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 0.2029,    -inf,    -inf,    -inf,    -inf,    -inf],
          [ 0.1734,  0.2631,    -inf,    -inf,    -inf,    -inf],
          [ 0.1730,  0.2625,  0.2601,    -inf,    -inf,    -inf],
          [ 0.0777,  0.1179,  0.1168,  0.0648,    -inf,    -inf],
          [ 0.1178,  0.1787,  0.1770,  0.0983,  0.0973,    -inf],
          [ 0.0885,  0.1343,  0.1330,  0.0738,  0.0731,  0.0908]],

         [[ 0.1081,    -inf,    -inf,    -inf,    -inf,    -inf],
          [-0.0079, -0.0029,    -inf,    -inf,    -inf,    -inf],
          [-0.0063, -0.0023, -0.0025,    -inf,    -inf,    -inf],
          [-0.0267, -0.0099, -0.0104, -0.0005,    -inf,    -inf],
          [ 0.0237,  0.0088,  0.0092,  0.0004,  0.0148,    -inf],
          [-0.0409, -0.0151, -0.0159, -0.0008, -0.0254,  0.0058]]],


        [[[ 0.2029,    -inf,    -inf,    -inf,    -inf,    -inf],
          [ 0.1734,  0.2631,    -inf,    -inf,    -inf,    -inf],
          [ 0.1730,  0.2625,  0.2601,    -inf,    -inf,    -inf],
          [ 0.0777,  0.1179,  0.1168,  0.0648,    -inf,    -inf],
          [ 0.1178,  0.1787,  0.1770,  0.0983,  0.0973,    -inf],
          [ 0.0885,  0.1343,  0.1330,  0.0738,  0.0731,  0.0908]],

         [[ 0.1081,    -inf,    -inf,    -inf,    -inf,    -inf],
          [-0.0079, -0.0029,    -inf,    -inf,    -inf,    -inf],
          [-0.0063, -0.0023, -0.0025,    -inf,    -inf,    -inf],
          [-0.0267, -0.0099, -0.0104, -0.0005,    -inf,    -inf],
          [ 0.0237,  0.0088,  0.0092,  0.0004,  0.0148,    -inf],
          [-0.0409, -0.0151, -0.0159, -0.0008, -0.0254,  0.0058]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.4519],
          [ 0.2216]],

         [[-0.5889],
          [ 0.0122]],

         [[-0.6313],
          [-0.0576]],

         [[-0.5685],
          [-0.0832]],

         [[-0.5541],
          [-0.0964]],

         [[-0.5311],
          [-0.1077]]],


        [[[-0.4519],
          [ 0.2216]],

         [[-0.5889],
          [ 0.0122]],

         [[-0.6313],
          [-0.0576]],

         [[-0.5685],
          [-0.0832]],

         [[-0.5541],
          [-0.0964]],

         [[-0.5311],
          [-0.1077]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.4519,  0.2216],
         [-0.5889,  0.0122],
         [-0.6313, -0.0576],
         [-0.5685, -0.0832],
         [-0.5541, -0.0964],
         [-0.5311, -0.1077]],

        [[-0.4519,  0.2216],
         [-0.5889,  0.0122],
         [-0.6313, -0.0576],
         [-0.5685, -0.0832],
         [-0.5541, -0.0964],
         [-0.5311, -0.1077]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[0.3190, 0.4858],
         [0.2943, 0.3897],
         [0.2856, 0.3593],
         [0.2693, 0.3873],
         [0.2639, 0.3928],
         [0.2575, 0.4028]],

        [[0.3190, 0.4858],
         [0.2943, 0.3897],
         [0.2856, 0.3593],
         [0.2693, 0.3873],
         [0.2639, 0.3928],
         [0.2575, 0.4028]]], grad_fn=<ViewBackward0>)
context vecs:
 tensor([[[0.3190, 0.4858],
         [0.2943, 0.3897],
         [0.2856, 0.3593],
         [0.2693, 0.3873],
         [0.2639, 0.3928],
         [0.2575, 0.4028]],

        [[0.3190, 0.4858],
         [0.2943, 0.3897],
         [0.2856, 0.3593],
         [0.2693, 0.3873],
         [0.2639, 0.3928],
         [0.2575, 0.4028]]], grad_fn=<ViewBackward0>)
