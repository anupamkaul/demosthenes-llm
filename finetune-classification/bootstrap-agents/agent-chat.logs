(base) anupkaul@147dda4c0851 bootstrap-agents % python agent-chat.py
2025-10-21 13:40:03.573488: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
File already exists and is up-to-date: gpt2/124M/checkpoint
File already exists and is up-to-date: gpt2/124M/encoder.json
File already exists and is up-to-date: gpt2/124M/hparams.json
File already exists and is up-to-date: gpt2/124M/model.ckpt.data-00000-of-00001
File already exists and is up-to-date: gpt2/124M/model.ckpt.index
File already exists and is up-to-date: gpt2/124M/model.ckpt.meta
File already exists and is up-to-date: gpt2/124M/vocab.bpe
Loaded trained agent model
Agent Chat Ready! Type 'quit' to exit.

You: Hi ! 
predicted function:  no_function
probabilities:  tensor([[0.0335, 0.0009, 0.0949, 0.3667, 0.0057, 0.4983]])  confidence:  0.49826475977897644
Function: no_function (0.50)
Agent: I understand. How can I help you?

You: get_weather
predicted function:  no_function
probabilities:  tensor([[2.3914e-02, 1.3592e-04, 5.9300e-02, 3.4767e-02, 1.5257e-03, 8.8036e-01]])  confidence:  0.8803583383560181
Function: no_function (0.88)
Agent: I understand. How can I help you?

You: what is the weather ?
predicted function:  no_function
probabilities:  tensor([[9.9062e-04, 1.2701e-06, 1.1861e-02, 4.4402e-02, 9.3758e-05, 9.4265e-01]])  confidence:  0.9426512122154236
Function: no_function (0.94)
Agent: I understand. How can I help you?

You: tell me what the weather is
predicted function:  no_function
probabilities:  tensor([[8.7251e-05, 2.8190e-07, 2.0900e-03, 2.6843e-02, 7.8699e-05, 9.7090e-01]])  confidence:  0.9709004163742065
Function: no_function (0.97)
Agent: I understand. How can I help you?

You: what is the current weather
predicted function:  no_function
probabilities:  tensor([[5.8131e-04, 6.3115e-06, 7.7614e-03, 1.9569e-02, 1.9431e-04, 9.7189e-01]])  confidence:  0.9718874096870422
Function: no_function (0.97)
Agent: I understand. How can I help you?

You: I give up ! 
predicted function:  no_function
probabilities:  tensor([[2.2903e-02, 3.1024e-04, 9.2329e-02, 3.0138e-01, 3.5301e-03, 5.7955e-01]])  confidence:  0.5795478820800781
Function: no_function (0.58)
Agent: I understand. How can I help you?

You: ^CTraceback (most recent call last):
  File "/Users/anupkaul/akaul_git/demosthenes-llm/finetune-classification/bootstrap-agents/agent-chat.py", line 80, in <module>
    agent.chat()
  File "/Users/anupkaul/akaul_git/demosthenes-llm/finetune-classification/bootstrap-agents/agent-chat.py", line 68, in chat
    user_input = input("\nYou: ")
                 ^^^^^^^^^^^^^^^^
KeyboardInterrupt

--> upon retraining the fine tuning for 20 epochs, the results are now skewed to "Search Web" :( 

(base) anupkaul@147dda4c0851 bootstrap-agents % python agent-chat.py
2025-10-21 14:49:54.712408: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
AttributeError: 'MessageFactory' object has no attribute 'GetPrototype'
File already exists and is up-to-date: gpt2/124M/checkpoint
File already exists and is up-to-date: gpt2/124M/encoder.json
File already exists and is up-to-date: gpt2/124M/hparams.json
File already exists and is up-to-date: gpt2/124M/model.ckpt.data-00000-of-00001
File already exists and is up-to-date: gpt2/124M/model.ckpt.index
File already exists and is up-to-date: gpt2/124M/model.ckpt.meta
File already exists and is up-to-date: gpt2/124M/vocab.bpe
Loaded trained agent model
Agent Chat Ready! Type 'quit' to exit.

You: Hi ! 
predicted function:  search_web
probabilities:  tensor([[0.2451, 0.0388, 0.6606, 0.0045, 0.0019, 0.0491]])  confidence:  0.6605753898620605
Function: search_web (0.66)
Agent: Search results for: Hi !

You: Send email to Alice
predicted function:  search_web
probabilities:  tensor([[1.0626e-01, 9.9016e-03, 8.4711e-01, 1.4183e-03, 1.7283e-04, 3.5144e-02]])  confidence:  0.8471080660820007
Function: search_web (0.85)
Agent: Search results for: Send email to

You: this is screwed up ! 
predicted function:  search_web
probabilities:  tensor([[2.0550e-01, 2.7270e-02, 7.2085e-01, 1.7283e-03, 5.2371e-04, 4.4133e-02]])  confidence:  0.720849335193634
Function: search_web (0.72)
Agent: Search results for: this is screwed

You: bye
predicted function:  search_web
probabilities:  tensor([[0.1891, 0.0908, 0.4736, 0.0804, 0.0496, 0.1165]])  confidence:  0.47358933091163635
Function: search_web (0.47)
Agent: Search results for: bye

You: quit
