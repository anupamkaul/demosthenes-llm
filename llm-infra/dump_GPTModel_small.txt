current dir:  /Users/anupkaul/akaul_git/demosthenes-llm/llm-infra 

addnl module path to be used for import:  /Users/anupkaul/akaul_git/demosthenes-llm/llm-infra/../attention/ 

tensor([[6109, 3626, 6100,  345],
        [6109, 1110, 6622,  257]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-9.5016e-01,        -inf,        -inf,        -inf],
          [ 4.1319e+00,  3.0590e-01,        -inf,        -inf],
          [-4.4848e+00,  9.5192e-01,  6.1092e-01,        -inf],
          [-2.8657e-01,  1.7790e-01,  5.0122e-01, -2.0204e+00]],

         [[-1.7520e+00,        -inf,        -inf,        -inf],
          [ 4.6492e+00, -2.7599e+00,        -inf,        -inf],
          [ 1.1534e+00,  1.5699e+00,  3.8418e-01,        -inf],
          [-2.0622e+00, -3.2506e+00,  1.2508e-01,  1.1016e+00]],

         [[ 2.1146e+00,        -inf,        -inf,        -inf],
          [-3.3048e+00, -3.0260e-01,        -inf,        -inf],
          [-4.0125e+00, -2.0699e+00,  3.0089e+00,        -inf],
          [-2.6488e-01, -6.2557e-02, -3.7323e+00, -3.8743e+00]],

         [[ 5.8461e-01,        -inf,        -inf,        -inf],
          [ 1.1845e+00, -1.1965e+00,        -inf,        -inf],
          [-1.5325e+00,  5.6252e-01,  1.9819e+00,        -inf],
          [-1.0057e+00, -1.1031e+00,  1.0295e+00, -5.6976e-01]],

         [[-3.8215e+00,        -inf,        -inf,        -inf],
          [ 8.1225e-01,  1.3386e+00,        -inf,        -inf],
          [-8.8906e-01, -2.4913e+00, -1.2349e+01,        -inf],
          [-2.9546e+00,  1.5607e-01, -2.3606e+00, -8.1309e-02]],

         [[-5.7629e-01,        -inf,        -inf,        -inf],
          [-3.2767e+00, -1.9737e+00,        -inf,        -inf],
          [ 2.4678e-01,  2.8660e+00, -1.8027e+00,        -inf],
          [-1.3145e+00, -9.7260e-01,  2.8736e-01, -3.5975e+00]],

         [[ 1.4958e-01,        -inf,        -inf,        -inf],
          [-3.8820e-01,  1.0917e+00,        -inf,        -inf],
          [-3.3588e+00,  3.4080e+00,  4.0822e+00,        -inf],
          [-3.0100e+00, -1.4317e+00,  3.6590e+00, -6.3646e-01]],

         [[-2.8126e+00,        -inf,        -inf,        -inf],
          [ 2.5391e+00,  5.4519e+00,        -inf,        -inf],
          [ 7.8898e-02, -1.5722e+00, -1.4175e+00,        -inf],
          [-3.1585e-01, -1.1767e+00, -2.4822e+00,  1.8663e+00]],

         [[ 1.6361e+00,        -inf,        -inf,        -inf],
          [ 7.3706e+00,  1.8811e-01,        -inf,        -inf],
          [ 1.6723e+00, -2.1656e-01,  2.3188e-01,        -inf],
          [ 1.8575e-01,  4.1151e+00, -4.9667e-01,  1.2662e+00]],

         [[-3.6838e-01,        -inf,        -inf,        -inf],
          [ 4.5052e-01, -8.7605e-01,        -inf,        -inf],
          [ 1.6882e+00, -5.8862e-01, -1.6486e+00,        -inf],
          [-1.4237e+00, -2.1513e+00,  9.7725e-01, -2.4413e+00]],

         [[-4.7337e+00,        -inf,        -inf,        -inf],
          [-4.0439e+00, -1.2944e+00,        -inf,        -inf],
          [-3.0908e+00,  9.4462e+00, -2.4021e+00,        -inf],
          [ 3.1681e-01, -3.9234e+00,  3.6824e+00, -4.7542e+00]],

         [[-3.7555e+00,        -inf,        -inf,        -inf],
          [-2.6376e-01, -2.6873e+00,        -inf,        -inf],
          [-2.7398e+00, -4.2586e+00,  5.2125e+00,        -inf],
          [ 8.6451e-01, -6.3579e+00,  1.0133e+00, -4.6796e+00]]],


        [[[-3.6548e+00,        -inf,        -inf,        -inf],
          [ 2.8032e+00, -3.3614e+00,        -inf,        -inf],
          [ 2.1030e+00, -1.7855e+00,  4.9789e-01,        -inf],
          [ 2.5622e+00,  8.8902e-01,  1.0662e-01, -3.8825e-01]],

         [[-2.9857e-01,        -inf,        -inf,        -inf],
          [-1.0009e+00, -1.6605e+00,        -inf,        -inf],
          [-1.4025e+00, -5.6923e+00, -1.6946e+00,        -inf],
          [-7.1546e-01,  3.7639e+00, -4.8979e-01, -1.8599e+00]],

         [[ 1.5130e+00,        -inf,        -inf,        -inf],
          [-5.7859e+00,  1.4783e+00,        -inf,        -inf],
          [-3.9773e+00,  6.8818e+00, -1.9753e+00,        -inf],
          [-2.1308e+00, -1.1693e+00,  3.1999e-01,  1.7338e+00]],

         [[ 9.1571e-01,        -inf,        -inf,        -inf],
          [-1.2883e+00, -5.0342e+00,        -inf,        -inf],
          [-1.0305e+00, -1.0636e+00, -6.0870e+00,        -inf],
          [-3.4242e-02,  1.8248e+00, -1.2543e+00, -8.1044e-01]],

         [[-2.7256e+00,        -inf,        -inf,        -inf],
          [-6.6351e-02, -2.7703e+00,        -inf,        -inf],
          [-1.2339e-02,  3.6194e+00, -5.4361e+00,        -inf],
          [ 5.3836e-01, -2.7981e+00, -4.0768e+00,  1.0147e+00]],

         [[-1.4575e+00,        -inf,        -inf,        -inf],
          [-1.7629e-01,  2.1194e+00,        -inf,        -inf],
          [-1.7148e+00, -2.4959e+00,  1.1591e-01,        -inf],
          [ 2.4205e-01,  2.1174e+00, -9.9259e-01,  2.3272e+00]],

         [[ 1.0364e+00,        -inf,        -inf,        -inf],
          [ 2.1483e-01, -4.5759e+00,        -inf,        -inf],
          [-8.1867e-01, -4.7269e+00,  5.6947e-01,        -inf],
          [ 4.5893e-01,  2.3220e+00, -1.6991e-01,  1.0873e+00]],

         [[-9.1905e-01,        -inf,        -inf,        -inf],
          [-5.5531e+00,  4.9874e-01,        -inf,        -inf],
          [ 1.9710e+00,  2.0902e-01,  2.5715e-01,        -inf],
          [ 7.3046e-01, -2.2304e+00, -1.2327e+00, -3.3188e-01]],

         [[-5.2534e-01,        -inf,        -inf,        -inf],
          [ 4.6066e+00,  4.7916e+00,        -inf,        -inf],
          [-3.6236e+00,  2.0497e+00, -2.9971e+00,        -inf],
          [ 1.4470e-01,  4.1104e-01,  5.1080e-01, -2.6914e+00]],

         [[-2.8189e+00,        -inf,        -inf,        -inf],
          [ 8.7829e-01,  9.7859e-01,        -inf,        -inf],
          [-3.0392e+00,  2.2343e-01,  2.3230e+00,        -inf],
          [-2.3174e+00, -2.9550e+00, -3.4743e+00,  1.3464e+00]],

         [[-4.4390e+00,        -inf,        -inf,        -inf],
          [-2.1137e+00,  3.4936e-01,        -inf,        -inf],
          [ 5.8283e-01,  2.0017e+00,  1.1250e+00,        -inf],
          [-3.3438e+00,  1.8291e-01,  2.2655e+00,  6.8556e+00]],

         [[-2.5064e+00,        -inf,        -inf,        -inf],
          [ 3.3037e+00,  4.1583e-01,        -inf,        -inf],
          [-8.4623e-01,  1.0722e+00,  4.3706e+00,        -inf],
          [-5.9330e-01, -5.6719e+00, -1.5487e+00, -2.4837e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-9.5016e-01,        -inf,        -inf,        -inf],
          [ 4.1319e+00,  3.0590e-01,        -inf,        -inf],
          [-4.4848e+00,  9.5192e-01,  6.1092e-01,        -inf],
          [-2.8657e-01,  1.7790e-01,  5.0122e-01, -2.0204e+00]],

         [[-1.7520e+00,        -inf,        -inf,        -inf],
          [ 4.6492e+00, -2.7599e+00,        -inf,        -inf],
          [ 1.1534e+00,  1.5699e+00,  3.8418e-01,        -inf],
          [-2.0622e+00, -3.2506e+00,  1.2508e-01,  1.1016e+00]],

         [[ 2.1146e+00,        -inf,        -inf,        -inf],
          [-3.3048e+00, -3.0260e-01,        -inf,        -inf],
          [-4.0125e+00, -2.0699e+00,  3.0089e+00,        -inf],
          [-2.6488e-01, -6.2557e-02, -3.7323e+00, -3.8743e+00]],

         [[ 5.8461e-01,        -inf,        -inf,        -inf],
          [ 1.1845e+00, -1.1965e+00,        -inf,        -inf],
          [-1.5325e+00,  5.6252e-01,  1.9819e+00,        -inf],
          [-1.0057e+00, -1.1031e+00,  1.0295e+00, -5.6976e-01]],

         [[-3.8215e+00,        -inf,        -inf,        -inf],
          [ 8.1225e-01,  1.3386e+00,        -inf,        -inf],
          [-8.8906e-01, -2.4913e+00, -1.2349e+01,        -inf],
          [-2.9546e+00,  1.5607e-01, -2.3606e+00, -8.1309e-02]],

         [[-5.7629e-01,        -inf,        -inf,        -inf],
          [-3.2767e+00, -1.9737e+00,        -inf,        -inf],
          [ 2.4678e-01,  2.8660e+00, -1.8027e+00,        -inf],
          [-1.3145e+00, -9.7260e-01,  2.8736e-01, -3.5975e+00]],

         [[ 1.4958e-01,        -inf,        -inf,        -inf],
          [-3.8820e-01,  1.0917e+00,        -inf,        -inf],
          [-3.3588e+00,  3.4080e+00,  4.0822e+00,        -inf],
          [-3.0100e+00, -1.4317e+00,  3.6590e+00, -6.3646e-01]],

         [[-2.8126e+00,        -inf,        -inf,        -inf],
          [ 2.5391e+00,  5.4519e+00,        -inf,        -inf],
          [ 7.8898e-02, -1.5722e+00, -1.4175e+00,        -inf],
          [-3.1585e-01, -1.1767e+00, -2.4822e+00,  1.8663e+00]],

         [[ 1.6361e+00,        -inf,        -inf,        -inf],
          [ 7.3706e+00,  1.8811e-01,        -inf,        -inf],
          [ 1.6723e+00, -2.1656e-01,  2.3188e-01,        -inf],
          [ 1.8575e-01,  4.1151e+00, -4.9667e-01,  1.2662e+00]],

         [[-3.6838e-01,        -inf,        -inf,        -inf],
          [ 4.5052e-01, -8.7605e-01,        -inf,        -inf],
          [ 1.6882e+00, -5.8862e-01, -1.6486e+00,        -inf],
          [-1.4237e+00, -2.1513e+00,  9.7725e-01, -2.4413e+00]],

         [[-4.7337e+00,        -inf,        -inf,        -inf],
          [-4.0439e+00, -1.2944e+00,        -inf,        -inf],
          [-3.0908e+00,  9.4462e+00, -2.4021e+00,        -inf],
          [ 3.1681e-01, -3.9234e+00,  3.6824e+00, -4.7542e+00]],

         [[-3.7555e+00,        -inf,        -inf,        -inf],
          [-2.6376e-01, -2.6873e+00,        -inf,        -inf],
          [-2.7398e+00, -4.2586e+00,  5.2125e+00,        -inf],
          [ 8.6451e-01, -6.3579e+00,  1.0133e+00, -4.6796e+00]]],


        [[[-3.6548e+00,        -inf,        -inf,        -inf],
          [ 2.8032e+00, -3.3614e+00,        -inf,        -inf],
          [ 2.1030e+00, -1.7855e+00,  4.9789e-01,        -inf],
          [ 2.5622e+00,  8.8902e-01,  1.0662e-01, -3.8825e-01]],

         [[-2.9857e-01,        -inf,        -inf,        -inf],
          [-1.0009e+00, -1.6605e+00,        -inf,        -inf],
          [-1.4025e+00, -5.6923e+00, -1.6946e+00,        -inf],
          [-7.1546e-01,  3.7639e+00, -4.8979e-01, -1.8599e+00]],

         [[ 1.5130e+00,        -inf,        -inf,        -inf],
          [-5.7859e+00,  1.4783e+00,        -inf,        -inf],
          [-3.9773e+00,  6.8818e+00, -1.9753e+00,        -inf],
          [-2.1308e+00, -1.1693e+00,  3.1999e-01,  1.7338e+00]],

         [[ 9.1571e-01,        -inf,        -inf,        -inf],
          [-1.2883e+00, -5.0342e+00,        -inf,        -inf],
          [-1.0305e+00, -1.0636e+00, -6.0870e+00,        -inf],
          [-3.4242e-02,  1.8248e+00, -1.2543e+00, -8.1044e-01]],

         [[-2.7256e+00,        -inf,        -inf,        -inf],
          [-6.6351e-02, -2.7703e+00,        -inf,        -inf],
          [-1.2339e-02,  3.6194e+00, -5.4361e+00,        -inf],
          [ 5.3836e-01, -2.7981e+00, -4.0768e+00,  1.0147e+00]],

         [[-1.4575e+00,        -inf,        -inf,        -inf],
          [-1.7629e-01,  2.1194e+00,        -inf,        -inf],
          [-1.7148e+00, -2.4959e+00,  1.1591e-01,        -inf],
          [ 2.4205e-01,  2.1174e+00, -9.9259e-01,  2.3272e+00]],

         [[ 1.0364e+00,        -inf,        -inf,        -inf],
          [ 2.1483e-01, -4.5759e+00,        -inf,        -inf],
          [-8.1867e-01, -4.7269e+00,  5.6947e-01,        -inf],
          [ 4.5893e-01,  2.3220e+00, -1.6991e-01,  1.0873e+00]],

         [[-9.1905e-01,        -inf,        -inf,        -inf],
          [-5.5531e+00,  4.9874e-01,        -inf,        -inf],
          [ 1.9710e+00,  2.0902e-01,  2.5715e-01,        -inf],
          [ 7.3046e-01, -2.2304e+00, -1.2327e+00, -3.3188e-01]],

         [[-5.2534e-01,        -inf,        -inf,        -inf],
          [ 4.6066e+00,  4.7916e+00,        -inf,        -inf],
          [-3.6236e+00,  2.0497e+00, -2.9971e+00,        -inf],
          [ 1.4470e-01,  4.1104e-01,  5.1080e-01, -2.6914e+00]],

         [[-2.8189e+00,        -inf,        -inf,        -inf],
          [ 8.7829e-01,  9.7859e-01,        -inf,        -inf],
          [-3.0392e+00,  2.2343e-01,  2.3230e+00,        -inf],
          [-2.3174e+00, -2.9550e+00, -3.4743e+00,  1.3464e+00]],

         [[-4.4390e+00,        -inf,        -inf,        -inf],
          [-2.1137e+00,  3.4936e-01,        -inf,        -inf],
          [ 5.8283e-01,  2.0017e+00,  1.1250e+00,        -inf],
          [-3.3438e+00,  1.8291e-01,  2.2655e+00,  6.8556e+00]],

         [[-2.5064e+00,        -inf,        -inf,        -inf],
          [ 3.3037e+00,  4.1583e-01,        -inf,        -inf],
          [-8.4623e-01,  1.0722e+00,  4.3706e+00,        -inf],
          [-5.9330e-01, -5.6719e+00, -1.5487e+00, -2.4837e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.7289, -0.0403,  0.1560,  ..., -0.9453, -0.1937,  0.7642],
          [ 0.3445, -0.2808,  0.7747,  ...,  0.2412,  0.4617,  0.2438],
          [ 0.3766,  0.8842, -0.1184,  ...,  0.4006,  0.2326,  0.2914],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-1.2864, -0.1712, -0.2184,  ...,  0.6391,  0.4329, -0.3954],
          [-1.2790, -0.9305,  0.6052,  ...,  0.1041,  0.1194, -0.1717]],

         [[ 0.3126, -0.5122,  0.0874,  ..., -0.5535, -0.2118,  0.7815],
          [-0.0043, -0.1280,  0.6565,  ...,  0.4216,  0.2128,  0.0320],
          [ 0.0547,  0.3216,  0.2879,  ...,  0.6865,  0.4835,  0.6245],
          ...,
          [ 0.7214,  0.2856, -0.2459,  ..., -0.3112,  0.4601,  0.0164],
          [-0.2266,  0.0629, -0.2929,  ...,  0.3513, -0.4873, -0.0892],
          [-0.5273, -0.6226,  0.1516,  ..., -0.1153,  0.2279,  0.1725]],

         [[-0.1987, -0.1271,  0.1462,  ..., -0.1478,  0.0181,  0.8075],
          [-0.0319,  0.1145,  0.3875,  ..., -0.0768,  0.1264, -0.0364],
          [ 0.9191,  0.0843,  0.2318,  ...,  0.6146,  0.1170,  0.5702],
          ...,
          [ 0.5050,  0.3740, -0.4241,  ..., -0.0183,  0.2869, -0.3723],
          [ 0.3240,  0.0889, -0.3827,  ...,  0.1431, -0.7669, -0.0931],
          [ 0.0029,  0.1764,  0.2784,  ..., -0.3422,  0.0908,  0.8105]],

         [[ 0.0559, -0.3699,  0.0423,  ..., -0.1157, -0.0458,  0.2467],
          [ 0.2075, -0.0300, -0.0329,  ..., -0.2117,  0.0358, -0.1159],
          [ 0.4505,  0.2339,  0.0034,  ...,  0.2309,  0.0278,  0.1930],
          ...,
          [ 0.1415, -0.0216, -0.4933,  ...,  0.0049,  0.0896, -0.5727],
          [ 0.1770, -0.2047, -0.3864,  ...,  0.0914, -0.2253, -0.4090],
          [-0.0804, -0.0407,  0.4242,  ...,  0.2203,  0.0183,  0.4006]]],


        [[[ 0.6762, -0.3841,  0.0155,  ..., -0.7185, -0.2822,  0.7933],
          [ 0.5380, -0.2747,  0.8552,  ...,  0.1676,  0.5195,  0.3570],
          [ 0.4547,  0.8764, -0.3173,  ..., -0.1033,  0.3600,  0.2774],
          ...,
          [ 1.4401,  0.7697, -0.1096,  ..., -0.1949,  0.2419, -0.2610],
          [-0.8392, -0.1280, -0.1791,  ...,  0.4291,  0.2313, -0.1784],
          [-1.5339, -0.8083, -0.0719,  ..., -0.3124,  0.1800, -0.1854]],

         [[ 0.2096, -0.4545,  0.1100,  ..., -0.6340, -0.2223,  0.6622],
          [ 0.3388, -0.3804,  0.4981,  ...,  0.2635,  0.3859,  0.0858],
          [ 0.3967,  0.1941, -0.4521,  ...,  0.8002,  0.0445, -0.5751],
          ...,
          [ 0.7155,  0.3824, -0.0544,  ..., -0.0969,  0.1202, -0.1297],
          [-0.1106, -0.1446,  0.4093,  ...,  0.0615, -0.1497,  0.2810],
          [-1.2611, -0.3051, -0.1815,  ..., -0.6245, -0.0266, -0.0451]],

         [[ 0.1930, -0.4205,  0.2150,  ..., -0.4881,  0.1250,  0.6486],
          [ 0.2399, -0.3126,  0.4858,  ..., -0.3904,  0.5925,  0.1550],
          [ 0.5317,  0.0136, -0.1170,  ...,  0.4817, -0.0266, -0.5125],
          ...,
          [ 0.5954, -0.1410,  0.0692,  ..., -0.3726,  0.0696, -0.1901],
          [-0.2449,  0.2206, -0.1311,  ...,  0.1025,  0.0062, -0.1138],
          [-0.3733, -0.5927,  0.1420,  ..., -0.3155,  0.6117,  0.4669]],

         [[-0.1232, -0.2161,  0.1394,  ..., -0.2465,  0.0826,  0.4300],
          [ 0.2070, -0.2890,  0.4710,  ..., -0.2353,  0.3180, -0.0637],
          [ 0.2890, -0.3582,  0.0263,  ..., -0.0798,  0.0327,  0.1969],
          ...,
          [ 0.4478,  0.0038,  0.0574,  ..., -0.4481,  0.1831, -0.1531],
          [-0.2224,  0.0028, -0.1916,  ...,  0.1078, -0.0866,  0.3058],
          [-0.2913, -0.5841,  0.2149,  ..., -0.4395,  0.4761,  0.5690]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.7289, -0.0403,  0.1560,  ...,  0.1041,  0.1194, -0.1717],
         [ 0.3126, -0.5122,  0.0874,  ..., -0.1153,  0.2279,  0.1725],
         [-0.1987, -0.1271,  0.1462,  ..., -0.3422,  0.0908,  0.8105],
         [ 0.0559, -0.3699,  0.0423,  ...,  0.2203,  0.0183,  0.4006]],

        [[ 0.6762, -0.3841,  0.0155,  ..., -0.3124,  0.1800, -0.1854],
         [ 0.2096, -0.4545,  0.1100,  ..., -0.6245, -0.0266, -0.0451],
         [ 0.1930, -0.4205,  0.2150,  ..., -0.3155,  0.6117,  0.4669],
         [-0.1232, -0.2161,  0.1394,  ..., -0.4395,  0.4761,  0.5690]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.3091, -0.4685,  0.1402,  ..., -0.1073,  0.2294,  0.2545],
         [-0.8277, -0.2274,  0.0125,  ...,  0.0332,  0.2589,  0.3776],
         [-0.3239, -0.2419,  0.0488,  ..., -0.2091,  0.3337,  0.0841],
         [-0.1742, -0.3053, -0.0806,  ..., -0.1049, -0.0011,  0.0666]],

        [[-0.0539, -0.3594,  0.1552,  ...,  0.1561, -0.2729,  0.3169],
         [-0.2146, -0.0297,  0.1153,  ...,  0.1914, -0.2186,  0.4676],
         [-0.1682, -0.1659,  0.2510,  ...,  0.2738,  0.1684,  0.3408],
         [-0.0448,  0.0125,  0.0402,  ...,  0.3494, -0.0032,  0.0550]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.7441e-01,        -inf,        -inf,        -inf],
          [-3.0686e-01, -5.8466e+00,        -inf,        -inf],
          [ 2.2388e+00, -2.8622e+00,  5.8491e+00,        -inf],
          [-6.7757e-01, -2.8222e+00,  1.0762e+00, -1.6430e+00]],

         [[-1.4387e+00,        -inf,        -inf,        -inf],
          [ 6.0106e-01,  2.5807e+00,        -inf,        -inf],
          [-5.5690e-01, -7.9559e-01,  1.9443e+00,        -inf],
          [-4.7609e+00,  8.3388e-01,  3.6340e+00,  3.5885e-01]],

         [[ 6.7594e-01,        -inf,        -inf,        -inf],
          [-4.3706e-01,  5.6465e+00,        -inf,        -inf],
          [ 2.5201e+00,  2.9874e+00,  4.7770e-01,        -inf],
          [ 6.3769e-01, -1.6701e+00, -6.8797e-01, -2.1052e+00]],

         [[-2.8826e+00,        -inf,        -inf,        -inf],
          [ 1.9229e+00, -3.5182e+00,        -inf,        -inf],
          [ 2.8356e+00, -1.3987e+00, -1.4069e+00,        -inf],
          [-2.1951e+00,  1.8686e-01,  4.2779e+00, -5.5827e-01]],

         [[-2.3251e+00,        -inf,        -inf,        -inf],
          [-4.6582e+00, -1.4726e+00,        -inf,        -inf],
          [-1.3399e-01, -9.6332e-01,  1.2336e+00,        -inf],
          [ 1.7461e+00, -1.3995e+00,  2.9007e+00, -2.7666e-01]],

         [[ 2.4242e+00,        -inf,        -inf,        -inf],
          [ 1.0501e+00, -3.6879e+00,        -inf,        -inf],
          [-7.2542e+00,  3.4190e+00,  1.0737e+00,        -inf],
          [ 1.2046e+00,  2.2303e-01, -3.0000e+00,  2.7934e+00]],

         [[-4.6063e-01,        -inf,        -inf,        -inf],
          [-4.6662e+00,  3.3253e+00,        -inf,        -inf],
          [-1.8306e+00, -2.1832e+00, -2.3060e+00,        -inf],
          [-3.2525e+00,  6.2443e-02,  2.0765e+00,  2.8197e+00]],

         [[ 2.6243e+00,        -inf,        -inf,        -inf],
          [ 5.4346e+00, -3.0977e+00,        -inf,        -inf],
          [-4.3143e+00,  3.6633e+00, -1.9786e+00,        -inf],
          [ 8.1114e+00,  5.8977e-01,  1.1101e+00, -6.2896e-01]],

         [[ 8.7123e-02,        -inf,        -inf,        -inf],
          [ 1.6505e+00,  7.8596e-01,        -inf,        -inf],
          [ 2.0481e+00, -1.8216e+00, -8.1400e-01,        -inf],
          [ 2.2737e+00, -3.4005e+00,  2.0817e+00,  2.6997e+00]],

         [[-6.1502e+00,        -inf,        -inf,        -inf],
          [ 3.0608e+00,  1.8889e+00,        -inf,        -inf],
          [ 1.4897e+00,  2.7890e+00,  3.4657e+00,        -inf],
          [ 2.5416e+00,  1.6145e+00, -2.3074e+00, -6.0683e-01]],

         [[ 3.1553e+00,        -inf,        -inf,        -inf],
          [-1.4124e+00, -4.6378e+00,        -inf,        -inf],
          [ 1.9444e+00, -3.8758e+00, -1.8684e+00,        -inf],
          [-3.8291e+00,  5.0813e+00,  1.5269e+00, -7.5685e-01]],

         [[ 5.2968e+00,        -inf,        -inf,        -inf],
          [-1.5797e+00,  4.6649e-01,        -inf,        -inf],
          [ 7.3251e+00,  2.9590e+00,  8.8735e-01,        -inf],
          [ 4.8439e-01, -3.2762e+00,  1.9747e+00,  4.6648e+00]]],


        [[[-1.4358e-01,        -inf,        -inf,        -inf],
          [ 1.9843e+00,  9.4879e-01,        -inf,        -inf],
          [ 2.5164e+00,  2.6268e-01,  4.4131e+00,        -inf],
          [-2.7136e-01,  1.0600e+00, -1.5881e+00,  6.1868e-01]],

         [[-1.6078e+00,        -inf,        -inf,        -inf],
          [ 1.0117e+00,  3.8854e+00,        -inf,        -inf],
          [ 5.5161e-01, -1.1031e+00, -3.3970e+00,        -inf],
          [-1.3510e+00, -1.8544e+00,  4.3081e+00, -1.7652e+00]],

         [[ 2.2908e+00,        -inf,        -inf,        -inf],
          [ 2.4681e+00,  3.1827e-01,        -inf,        -inf],
          [-9.2010e-01,  4.5955e-01, -2.7827e+00,        -inf],
          [-2.1809e+00,  9.2673e-01, -9.3567e-01,  3.6459e+00]],

         [[-4.7651e+00,        -inf,        -inf,        -inf],
          [ 1.0093e+00,  2.8069e+00,        -inf,        -inf],
          [-6.0876e-01, -1.9695e+00,  2.2616e+00,        -inf],
          [ 1.7829e+00,  2.9064e-01, -2.0299e+00,  2.8797e-01]],

         [[-5.5153e-01,        -inf,        -inf,        -inf],
          [ 4.4729e-01, -1.7596e+00,        -inf,        -inf],
          [-1.3296e+00, -2.2516e-01, -1.5981e+00,        -inf],
          [ 4.4709e+00,  1.8225e+00, -6.2347e-01, -6.0045e+00]],

         [[ 3.4971e-01,        -inf,        -inf,        -inf],
          [ 1.5881e-02,  4.9297e+00,        -inf,        -inf],
          [-1.4160e+00,  1.7120e+00, -2.1475e+00,        -inf],
          [-2.2240e+00, -1.4260e+00, -4.3470e+00,  3.9859e-01]],

         [[-4.0890e-01,        -inf,        -inf,        -inf],
          [ 1.5679e+00,  1.1219e+00,        -inf,        -inf],
          [-3.5616e+00,  2.4331e+00, -1.2226e+00,        -inf],
          [ 2.6325e+00,  3.0578e+00, -1.3626e-01,  3.3515e+00]],

         [[ 2.1031e+00,        -inf,        -inf,        -inf],
          [ 3.3571e+00, -6.6932e-01,        -inf,        -inf],
          [ 2.7087e+00, -4.5992e+00, -4.8472e+00,        -inf],
          [-4.6602e-01, -1.6553e+00, -3.1121e+00,  2.9995e+00]],

         [[ 7.9765e-01,        -inf,        -inf,        -inf],
          [-2.0083e-03, -2.3942e+00,        -inf,        -inf],
          [-1.3392e+00, -6.7532e-01, -1.3611e+00,        -inf],
          [-2.2680e+00,  1.6560e+00, -1.1939e-01,  6.6618e+00]],

         [[-4.6338e+00,        -inf,        -inf,        -inf],
          [ 3.5187e+00, -1.6916e+00,        -inf,        -inf],
          [ 2.3509e+00, -9.1086e-02, -5.5451e-02,        -inf],
          [-2.7770e+00, -1.6613e+00,  2.6813e+00, -3.4187e+00]],

         [[ 5.9269e-01,        -inf,        -inf,        -inf],
          [-2.5004e+00, -1.9170e+00,        -inf,        -inf],
          [ 1.6255e+00, -6.4328e+00, -8.3272e-02,        -inf],
          [-1.7295e+00,  1.7128e-01,  5.6154e+00, -1.7050e+00]],

         [[ 3.1829e+00,        -inf,        -inf,        -inf],
          [ 2.3080e+00, -2.9694e-01,        -inf,        -inf],
          [ 1.9074e+00, -3.3000e+00, -5.9938e-01,        -inf],
          [ 8.2484e-01,  8.2354e-01,  4.3427e-01,  5.8645e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.7441e-01,        -inf,        -inf,        -inf],
          [-3.0686e-01, -5.8466e+00,        -inf,        -inf],
          [ 2.2388e+00, -2.8622e+00,  5.8491e+00,        -inf],
          [-6.7757e-01, -2.8222e+00,  1.0762e+00, -1.6430e+00]],

         [[-1.4387e+00,        -inf,        -inf,        -inf],
          [ 6.0106e-01,  2.5807e+00,        -inf,        -inf],
          [-5.5690e-01, -7.9559e-01,  1.9443e+00,        -inf],
          [-4.7609e+00,  8.3388e-01,  3.6340e+00,  3.5885e-01]],

         [[ 6.7594e-01,        -inf,        -inf,        -inf],
          [-4.3706e-01,  5.6465e+00,        -inf,        -inf],
          [ 2.5201e+00,  2.9874e+00,  4.7770e-01,        -inf],
          [ 6.3769e-01, -1.6701e+00, -6.8797e-01, -2.1052e+00]],

         [[-2.8826e+00,        -inf,        -inf,        -inf],
          [ 1.9229e+00, -3.5182e+00,        -inf,        -inf],
          [ 2.8356e+00, -1.3987e+00, -1.4069e+00,        -inf],
          [-2.1951e+00,  1.8686e-01,  4.2779e+00, -5.5827e-01]],

         [[-2.3251e+00,        -inf,        -inf,        -inf],
          [-4.6582e+00, -1.4726e+00,        -inf,        -inf],
          [-1.3399e-01, -9.6332e-01,  1.2336e+00,        -inf],
          [ 1.7461e+00, -1.3995e+00,  2.9007e+00, -2.7666e-01]],

         [[ 2.4242e+00,        -inf,        -inf,        -inf],
          [ 1.0501e+00, -3.6879e+00,        -inf,        -inf],
          [-7.2542e+00,  3.4190e+00,  1.0737e+00,        -inf],
          [ 1.2046e+00,  2.2303e-01, -3.0000e+00,  2.7934e+00]],

         [[-4.6063e-01,        -inf,        -inf,        -inf],
          [-4.6662e+00,  3.3253e+00,        -inf,        -inf],
          [-1.8306e+00, -2.1832e+00, -2.3060e+00,        -inf],
          [-3.2525e+00,  6.2443e-02,  2.0765e+00,  2.8197e+00]],

         [[ 2.6243e+00,        -inf,        -inf,        -inf],
          [ 5.4346e+00, -3.0977e+00,        -inf,        -inf],
          [-4.3143e+00,  3.6633e+00, -1.9786e+00,        -inf],
          [ 8.1114e+00,  5.8977e-01,  1.1101e+00, -6.2896e-01]],

         [[ 8.7123e-02,        -inf,        -inf,        -inf],
          [ 1.6505e+00,  7.8596e-01,        -inf,        -inf],
          [ 2.0481e+00, -1.8216e+00, -8.1400e-01,        -inf],
          [ 2.2737e+00, -3.4005e+00,  2.0817e+00,  2.6997e+00]],

         [[-6.1502e+00,        -inf,        -inf,        -inf],
          [ 3.0608e+00,  1.8889e+00,        -inf,        -inf],
          [ 1.4897e+00,  2.7890e+00,  3.4657e+00,        -inf],
          [ 2.5416e+00,  1.6145e+00, -2.3074e+00, -6.0683e-01]],

         [[ 3.1553e+00,        -inf,        -inf,        -inf],
          [-1.4124e+00, -4.6378e+00,        -inf,        -inf],
          [ 1.9444e+00, -3.8758e+00, -1.8684e+00,        -inf],
          [-3.8291e+00,  5.0813e+00,  1.5269e+00, -7.5685e-01]],

         [[ 5.2968e+00,        -inf,        -inf,        -inf],
          [-1.5797e+00,  4.6649e-01,        -inf,        -inf],
          [ 7.3251e+00,  2.9590e+00,  8.8735e-01,        -inf],
          [ 4.8439e-01, -3.2762e+00,  1.9747e+00,  4.6648e+00]]],


        [[[-1.4358e-01,        -inf,        -inf,        -inf],
          [ 1.9843e+00,  9.4879e-01,        -inf,        -inf],
          [ 2.5164e+00,  2.6268e-01,  4.4131e+00,        -inf],
          [-2.7136e-01,  1.0600e+00, -1.5881e+00,  6.1868e-01]],

         [[-1.6078e+00,        -inf,        -inf,        -inf],
          [ 1.0117e+00,  3.8854e+00,        -inf,        -inf],
          [ 5.5161e-01, -1.1031e+00, -3.3970e+00,        -inf],
          [-1.3510e+00, -1.8544e+00,  4.3081e+00, -1.7652e+00]],

         [[ 2.2908e+00,        -inf,        -inf,        -inf],
          [ 2.4681e+00,  3.1827e-01,        -inf,        -inf],
          [-9.2010e-01,  4.5955e-01, -2.7827e+00,        -inf],
          [-2.1809e+00,  9.2673e-01, -9.3567e-01,  3.6459e+00]],

         [[-4.7651e+00,        -inf,        -inf,        -inf],
          [ 1.0093e+00,  2.8069e+00,        -inf,        -inf],
          [-6.0876e-01, -1.9695e+00,  2.2616e+00,        -inf],
          [ 1.7829e+00,  2.9064e-01, -2.0299e+00,  2.8797e-01]],

         [[-5.5153e-01,        -inf,        -inf,        -inf],
          [ 4.4729e-01, -1.7596e+00,        -inf,        -inf],
          [-1.3296e+00, -2.2516e-01, -1.5981e+00,        -inf],
          [ 4.4709e+00,  1.8225e+00, -6.2347e-01, -6.0045e+00]],

         [[ 3.4971e-01,        -inf,        -inf,        -inf],
          [ 1.5881e-02,  4.9297e+00,        -inf,        -inf],
          [-1.4160e+00,  1.7120e+00, -2.1475e+00,        -inf],
          [-2.2240e+00, -1.4260e+00, -4.3470e+00,  3.9859e-01]],

         [[-4.0890e-01,        -inf,        -inf,        -inf],
          [ 1.5679e+00,  1.1219e+00,        -inf,        -inf],
          [-3.5616e+00,  2.4331e+00, -1.2226e+00,        -inf],
          [ 2.6325e+00,  3.0578e+00, -1.3626e-01,  3.3515e+00]],

         [[ 2.1031e+00,        -inf,        -inf,        -inf],
          [ 3.3571e+00, -6.6932e-01,        -inf,        -inf],
          [ 2.7087e+00, -4.5992e+00, -4.8472e+00,        -inf],
          [-4.6602e-01, -1.6553e+00, -3.1121e+00,  2.9995e+00]],

         [[ 7.9765e-01,        -inf,        -inf,        -inf],
          [-2.0083e-03, -2.3942e+00,        -inf,        -inf],
          [-1.3392e+00, -6.7532e-01, -1.3611e+00,        -inf],
          [-2.2680e+00,  1.6560e+00, -1.1939e-01,  6.6618e+00]],

         [[-4.6338e+00,        -inf,        -inf,        -inf],
          [ 3.5187e+00, -1.6916e+00,        -inf,        -inf],
          [ 2.3509e+00, -9.1086e-02, -5.5451e-02,        -inf],
          [-2.7770e+00, -1.6613e+00,  2.6813e+00, -3.4187e+00]],

         [[ 5.9269e-01,        -inf,        -inf,        -inf],
          [-2.5004e+00, -1.9170e+00,        -inf,        -inf],
          [ 1.6255e+00, -6.4328e+00, -8.3272e-02,        -inf],
          [-1.7295e+00,  1.7128e-01,  5.6154e+00, -1.7050e+00]],

         [[ 3.1829e+00,        -inf,        -inf,        -inf],
          [ 2.3080e+00, -2.9694e-01,        -inf,        -inf],
          [ 1.9074e+00, -3.3000e+00, -5.9938e-01,        -inf],
          [ 8.2484e-01,  8.2354e-01,  4.3427e-01,  5.8645e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.2681, -0.4362, -0.2608,  ...,  0.2089, -0.2575,  0.0077],
          [ 0.4430, -0.9208, -0.4936,  ..., -0.7423,  0.9520, -0.3221],
          [ 0.5631,  0.2689,  0.2439,  ...,  1.0646,  0.0853,  1.0078],
          ...,
          [ 1.0277,  0.1626, -0.6859,  ...,  0.4320,  0.5130,  0.0988],
          [ 0.6944, -0.8963, -0.7420,  ..., -0.7654, -0.8093, -1.7332],
          [-0.2087, -0.2509, -0.9686,  ...,  0.0983, -0.1693, -0.0578]],

         [[ 0.1642, -0.1686, -0.2755,  ...,  0.3018, -0.0285, -0.0083],
          [-0.2053, -0.4042,  0.1844,  ..., -0.5024,  0.8816,  0.2455],
          [ 0.2075,  0.7411,  0.5097,  ...,  0.0274, -0.4711, -0.2596],
          ...,
          [ 0.5514,  0.0872, -0.3680,  ...,  0.2318,  0.2753,  0.0530],
          [ 0.5172, -0.4683, -0.3677,  ..., -0.3182, -0.6119, -0.8107],
          [-0.0354, -0.2291, -0.2671,  ..., -0.1792,  0.1530, -0.0730]],

         [[ 0.1129,  0.1605, -0.7956,  ..., -0.2196, -0.3579, -0.2624],
          [-0.2215,  0.0335,  0.1006,  ..., -0.2202,  0.3178, -0.0881],
          [ 0.4422,  0.6385,  0.3081,  ...,  0.3545, -0.3383,  0.1398],
          ...,
          [-0.1546,  0.0119, -0.3071,  ...,  0.2788,  0.2157,  0.4228],
          [ 0.3879, -0.3865, -0.3084,  ..., -0.2832, -0.4573, -0.6929],
          [-0.1594, -0.1384, -0.4323,  ..., -0.2211,  0.1652,  0.1996]],

         [[ 0.4743,  0.2002, -0.9288,  ..., -0.2393, -0.2890, -0.0715],
          [-0.2389,  0.0744,  0.0884,  ..., -0.1828,  0.2174, -0.1296],
          [ 0.5730,  0.4193, -0.1023,  ...,  0.3377, -0.1549, -0.0149],
          ...,
          [ 0.1015,  0.2754, -0.1373,  ...,  0.1231,  0.4828,  0.2750],
          [ 0.2069, -0.0472, -0.0415,  ...,  0.5828, -0.3652, -0.0896],
          [ 0.1019, -0.2533, -0.2808,  ..., -0.3265,  0.6587,  0.3375]]],


        [[[ 0.2848, -0.0608, -0.1987,  ..., -0.0849,  0.0776,  0.5120],
          [ 0.1687, -1.0108,  0.0396,  ..., -1.2314,  0.4925, -0.1566],
          [ 0.2924,  0.4264,  0.3924,  ...,  1.1196,  0.0617,  1.1005],
          ...,
          [ 0.5379,  0.2513, -0.3465,  ...,  0.6144,  0.7062, -0.2778],
          [ 0.9781, -0.9995, -0.5216,  ..., -0.7280, -1.2348, -1.3003],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[-0.1897,  0.0544, -0.3431,  ..., -0.0189,  0.2969,  0.1355],
          [-0.0917, -0.7032, -0.0782,  ..., -0.6489, -0.1757,  0.3288],
          [ 0.6293,  0.5357, -0.0739,  ...,  0.3400, -0.3598,  0.6253],
          ...,
          [ 0.1615, -0.1479, -0.0740,  ...,  0.4298,  0.5033, -0.1171],
          [ 0.4050, -0.5269, -0.5895,  ..., -0.2293, -1.1923, -0.3454],
          [-0.2334,  0.0468, -0.3334,  ..., -0.4277,  0.0038, -0.0961]],

         [[ 0.2063,  0.0103, -0.5326,  ...,  0.0797,  0.1814,  0.1812],
          [-0.0507, -0.3945, -0.2852,  ..., -0.8846,  0.1826,  0.3669],
          [ 0.5366,  0.6312, -0.1050,  ...,  0.2355, -0.2268,  0.6917],
          ...,
          [ 0.2705,  0.1465, -0.0774,  ...,  0.0114,  0.3953,  0.0071],
          [ 0.6391, -0.6214, -0.0435,  ...,  0.1961, -1.0718, -0.1317],
          [-0.4913, -0.0170, -0.7323,  ..., -0.3919, -0.1051, -0.1721]],

         [[ 0.3699,  0.0534, -0.2594,  ...,  0.1424,  0.5621, -0.1615],
          [-0.2135,  0.3593, -0.5461,  ..., -0.6308,  0.2270,  0.3409],
          [ 0.2262,  0.1883, -0.3533,  ..., -0.0823,  0.0894,  0.3854],
          ...,
          [ 0.0061, -0.0483,  0.0272,  ..., -0.1878,  0.3574,  0.2318],
          [ 0.2895, -0.3644, -0.0382,  ...,  0.6124, -1.0176,  0.4012],
          [-0.1326,  0.1043, -0.0660,  ..., -0.3862, -0.1902, -0.0023]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.2681, -0.4362, -0.2608,  ...,  0.0983, -0.1693, -0.0578],
         [ 0.1642, -0.1686, -0.2755,  ..., -0.1792,  0.1530, -0.0730],
         [ 0.1129,  0.1605, -0.7956,  ..., -0.2211,  0.1652,  0.1996],
         [ 0.4743,  0.2002, -0.9288,  ..., -0.3265,  0.6587,  0.3375]],

        [[ 0.2848, -0.0608, -0.1987,  ...,  0.0000,  0.0000,  0.0000],
         [-0.1897,  0.0544, -0.3431,  ..., -0.4277,  0.0038, -0.0961],
         [ 0.2063,  0.0103, -0.5326,  ..., -0.3919, -0.1051, -0.1721],
         [ 0.3699,  0.0534, -0.2594,  ..., -0.3862, -0.1902, -0.0023]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2471,  0.1274,  0.0866,  ..., -0.0651,  0.0014, -0.1364],
         [ 0.0747,  0.0547,  0.0531,  ..., -0.2368,  0.2500, -0.0394],
         [ 0.1754,  0.2755, -0.1467,  ..., -0.0363,  0.3751, -0.0175],
         [ 0.0290,  0.2732,  0.1085,  ...,  0.1376,  0.2722, -0.1899]],

        [[ 0.0082,  0.5120, -0.0589,  ...,  0.0825,  0.2270, -0.0651],
         [-0.0477,  0.0221,  0.4860,  ..., -0.3829, -0.0545,  0.1365],
         [-0.2437, -0.1339,  0.1458,  ..., -0.0938, -0.1230,  0.0466],
         [-0.0538,  0.0290,  0.2652,  ..., -0.1411, -0.1054, -0.1831]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 4.0407e-01,        -inf,        -inf,        -inf],
          [-4.0189e+00, -2.5729e+00,        -inf,        -inf],
          [ 1.5955e+00, -3.6850e+00,  2.0586e+00,        -inf],
          [ 3.6403e+00,  1.4773e+00,  3.6051e+00, -6.6714e-01]],

         [[-2.1491e+00,        -inf,        -inf,        -inf],
          [ 3.9247e+00, -1.5391e-01,        -inf,        -inf],
          [-4.5390e+00,  2.7289e+00, -6.9655e-01,        -inf],
          [-2.8037e+00,  7.6648e-01, -7.0981e-01, -5.5809e-01]],

         [[ 5.0881e-01,        -inf,        -inf,        -inf],
          [-1.1237e+00,  9.9010e-01,        -inf,        -inf],
          [-2.8049e+00, -4.1615e-01,  2.7675e+00,        -inf],
          [ 9.6381e-01,  4.7224e+00, -2.6503e+00,  2.6657e+00]],

         [[ 1.4840e-01,        -inf,        -inf,        -inf],
          [ 3.0931e+00,  2.9198e+00,        -inf,        -inf],
          [-1.0731e+00,  5.5635e+00, -8.0786e-01,        -inf],
          [ 1.2749e+00,  4.4314e-01, -7.2617e-01,  6.5393e-01]],

         [[-3.5067e+00,        -inf,        -inf,        -inf],
          [ 4.6930e-01,  2.0150e+00,        -inf,        -inf],
          [ 1.7924e+00,  2.7016e-01, -2.8131e+00,        -inf],
          [-4.9296e+00, -3.1250e-01, -1.7984e+00, -1.5902e+00]],

         [[ 2.3100e+00,        -inf,        -inf,        -inf],
          [-5.1190e+00,  3.6402e+00,        -inf,        -inf],
          [-3.7626e+00, -1.8579e+00,  5.7625e-01,        -inf],
          [ 6.5667e+00, -3.5106e+00, -3.0455e+00, -3.4647e+00]],

         [[-2.6837e+00,        -inf,        -inf,        -inf],
          [-2.2151e+00,  3.9461e+00,        -inf,        -inf],
          [ 1.2760e+00,  1.1239e+00,  5.1680e+00,        -inf],
          [-4.8298e+00,  1.7753e+00,  3.0677e+00,  1.7579e+00]],

         [[-2.0287e+00,        -inf,        -inf,        -inf],
          [ 1.1869e-01, -4.5461e+00,        -inf,        -inf],
          [ 5.2454e+00, -1.6793e+00,  4.0418e+00,        -inf],
          [ 2.3011e+00,  2.7349e+00, -1.1873e+00, -3.1747e-02]],

         [[ 2.1464e+00,        -inf,        -inf,        -inf],
          [-1.7286e+00, -2.0687e+00,        -inf,        -inf],
          [-1.5180e+00,  5.2782e-01, -1.0701e-01,        -inf],
          [-2.9880e+00,  5.1734e+00, -2.8738e+00,  2.4412e+00]],

         [[ 5.6440e-01,        -inf,        -inf,        -inf],
          [ 3.6801e-01, -2.4307e+00,        -inf,        -inf],
          [ 2.6424e+00, -8.4878e-01, -1.5702e-01,        -inf],
          [-8.4616e-02,  1.9528e+00,  3.9107e+00,  1.8831e+00]],

         [[ 2.1312e+00,        -inf,        -inf,        -inf],
          [-1.1397e+00, -3.1860e-01,        -inf,        -inf],
          [ 1.5598e-01,  1.0762e-01, -1.5156e+00,        -inf],
          [-1.6458e+00,  1.4969e+00, -1.0079e-01, -9.8639e-01]],

         [[ 1.2597e+00,        -inf,        -inf,        -inf],
          [ 9.6849e-02,  2.9424e-01,        -inf,        -inf],
          [-2.5050e+00, -6.7589e-03,  4.1709e+00,        -inf],
          [ 1.9258e-01,  2.5095e+00, -3.1230e+00, -3.3052e+00]]],


        [[[ 6.6864e-01,        -inf,        -inf,        -inf],
          [-2.0242e+00, -3.7069e+00,        -inf,        -inf],
          [ 1.5672e+00,  1.0327e+00, -1.7747e+00,        -inf],
          [ 5.0337e-01, -9.4908e-01,  3.3021e+00,  1.5845e+00]],

         [[ 1.1234e+00,        -inf,        -inf,        -inf],
          [ 2.4214e+00,  1.6430e+00,        -inf,        -inf],
          [-9.0877e+00, -5.2822e+00,  2.0243e+00,        -inf],
          [-7.3010e-01,  1.3702e+00, -7.0290e+00,  1.8847e-02]],

         [[ 1.3362e+00,        -inf,        -inf,        -inf],
          [ 2.1413e+00,  1.6562e-01,        -inf,        -inf],
          [ 1.7937e+00,  9.8695e-02,  2.1941e+00,        -inf],
          [-1.7645e+00, -4.0300e+00, -3.5917e+00,  2.9068e+00]],

         [[-2.7161e+00,        -inf,        -inf,        -inf],
          [ 2.8925e+00, -4.4878e-02,        -inf,        -inf],
          [ 1.7563e+00,  3.0968e+00,  1.3033e-01,        -inf],
          [-2.1158e+00, -7.3455e-01, -2.0824e+00,  1.5262e+00]],

         [[-1.5572e+00,        -inf,        -inf,        -inf],
          [ 3.7712e+00,  5.2385e+00,        -inf,        -inf],
          [-1.1043e+00,  2.4719e+00, -2.0718e+00,        -inf],
          [ 1.1651e-01,  6.1969e-01,  3.2728e+00, -7.9944e-01]],

         [[ 2.2430e+00,        -inf,        -inf,        -inf],
          [-4.0821e+00, -2.4023e+00,        -inf,        -inf],
          [-6.1365e-02,  1.0736e-01,  4.1565e-01,        -inf],
          [ 3.1223e-01, -3.9406e+00,  1.9441e+00, -5.3452e+00]],

         [[ 8.5209e-01,        -inf,        -inf,        -inf],
          [-7.6739e+00, -6.6341e-01,        -inf,        -inf],
          [-4.3758e-01, -1.5865e+00, -1.5482e-01,        -inf],
          [ 1.0191e+00,  9.4108e-01,  4.1152e-01, -3.8189e+00]],

         [[-1.7169e+00,        -inf,        -inf,        -inf],
          [ 7.2389e-01, -4.6208e+00,        -inf,        -inf],
          [ 4.2867e+00,  5.3858e+00, -3.2834e+00,        -inf],
          [-1.3488e+00, -9.4790e-01,  2.6337e+00,  2.2755e+00]],

         [[ 1.7370e+00,        -inf,        -inf,        -inf],
          [-4.6152e+00, -5.6307e-01,        -inf,        -inf],
          [-2.0143e+00,  1.2775e-01, -2.6382e+00,        -inf],
          [-2.9153e+00, -1.5938e-01, -2.1979e-01,  2.9311e+00]],

         [[ 2.2957e+00,        -inf,        -inf,        -inf],
          [ 2.8211e+00,  6.2472e+00,        -inf,        -inf],
          [-1.1805e+00, -2.2989e+00, -5.8987e-01,        -inf],
          [ 5.7411e-01,  9.8649e-01, -1.4916e-01, -1.4749e+00]],

         [[-2.9764e-01,        -inf,        -inf,        -inf],
          [-8.6089e-01,  9.8414e-01,        -inf,        -inf],
          [ 4.8750e+00, -4.8223e-01, -4.8551e+00,        -inf],
          [-2.1661e+00, -4.6085e+00, -5.5727e+00, -3.9043e-01]],

         [[-4.2791e-01,        -inf,        -inf,        -inf],
          [ 2.7026e+00,  5.5600e-01,        -inf,        -inf],
          [ 9.6391e-01, -4.7980e+00, -9.2461e-01,        -inf],
          [-1.9598e+00,  6.2835e-01,  2.1639e+00,  5.2870e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 4.0407e-01,        -inf,        -inf,        -inf],
          [-4.0189e+00, -2.5729e+00,        -inf,        -inf],
          [ 1.5955e+00, -3.6850e+00,  2.0586e+00,        -inf],
          [ 3.6403e+00,  1.4773e+00,  3.6051e+00, -6.6714e-01]],

         [[-2.1491e+00,        -inf,        -inf,        -inf],
          [ 3.9247e+00, -1.5391e-01,        -inf,        -inf],
          [-4.5390e+00,  2.7289e+00, -6.9655e-01,        -inf],
          [-2.8037e+00,  7.6648e-01, -7.0981e-01, -5.5809e-01]],

         [[ 5.0881e-01,        -inf,        -inf,        -inf],
          [-1.1237e+00,  9.9010e-01,        -inf,        -inf],
          [-2.8049e+00, -4.1615e-01,  2.7675e+00,        -inf],
          [ 9.6381e-01,  4.7224e+00, -2.6503e+00,  2.6657e+00]],

         [[ 1.4840e-01,        -inf,        -inf,        -inf],
          [ 3.0931e+00,  2.9198e+00,        -inf,        -inf],
          [-1.0731e+00,  5.5635e+00, -8.0786e-01,        -inf],
          [ 1.2749e+00,  4.4314e-01, -7.2617e-01,  6.5393e-01]],

         [[-3.5067e+00,        -inf,        -inf,        -inf],
          [ 4.6930e-01,  2.0150e+00,        -inf,        -inf],
          [ 1.7924e+00,  2.7016e-01, -2.8131e+00,        -inf],
          [-4.9296e+00, -3.1250e-01, -1.7984e+00, -1.5902e+00]],

         [[ 2.3100e+00,        -inf,        -inf,        -inf],
          [-5.1190e+00,  3.6402e+00,        -inf,        -inf],
          [-3.7626e+00, -1.8579e+00,  5.7625e-01,        -inf],
          [ 6.5667e+00, -3.5106e+00, -3.0455e+00, -3.4647e+00]],

         [[-2.6837e+00,        -inf,        -inf,        -inf],
          [-2.2151e+00,  3.9461e+00,        -inf,        -inf],
          [ 1.2760e+00,  1.1239e+00,  5.1680e+00,        -inf],
          [-4.8298e+00,  1.7753e+00,  3.0677e+00,  1.7579e+00]],

         [[-2.0287e+00,        -inf,        -inf,        -inf],
          [ 1.1869e-01, -4.5461e+00,        -inf,        -inf],
          [ 5.2454e+00, -1.6793e+00,  4.0418e+00,        -inf],
          [ 2.3011e+00,  2.7349e+00, -1.1873e+00, -3.1747e-02]],

         [[ 2.1464e+00,        -inf,        -inf,        -inf],
          [-1.7286e+00, -2.0687e+00,        -inf,        -inf],
          [-1.5180e+00,  5.2782e-01, -1.0701e-01,        -inf],
          [-2.9880e+00,  5.1734e+00, -2.8738e+00,  2.4412e+00]],

         [[ 5.6440e-01,        -inf,        -inf,        -inf],
          [ 3.6801e-01, -2.4307e+00,        -inf,        -inf],
          [ 2.6424e+00, -8.4878e-01, -1.5702e-01,        -inf],
          [-8.4616e-02,  1.9528e+00,  3.9107e+00,  1.8831e+00]],

         [[ 2.1312e+00,        -inf,        -inf,        -inf],
          [-1.1397e+00, -3.1860e-01,        -inf,        -inf],
          [ 1.5598e-01,  1.0762e-01, -1.5156e+00,        -inf],
          [-1.6458e+00,  1.4969e+00, -1.0079e-01, -9.8639e-01]],

         [[ 1.2597e+00,        -inf,        -inf,        -inf],
          [ 9.6849e-02,  2.9424e-01,        -inf,        -inf],
          [-2.5050e+00, -6.7589e-03,  4.1709e+00,        -inf],
          [ 1.9258e-01,  2.5095e+00, -3.1230e+00, -3.3052e+00]]],


        [[[ 6.6864e-01,        -inf,        -inf,        -inf],
          [-2.0242e+00, -3.7069e+00,        -inf,        -inf],
          [ 1.5672e+00,  1.0327e+00, -1.7747e+00,        -inf],
          [ 5.0337e-01, -9.4908e-01,  3.3021e+00,  1.5845e+00]],

         [[ 1.1234e+00,        -inf,        -inf,        -inf],
          [ 2.4214e+00,  1.6430e+00,        -inf,        -inf],
          [-9.0877e+00, -5.2822e+00,  2.0243e+00,        -inf],
          [-7.3010e-01,  1.3702e+00, -7.0290e+00,  1.8847e-02]],

         [[ 1.3362e+00,        -inf,        -inf,        -inf],
          [ 2.1413e+00,  1.6562e-01,        -inf,        -inf],
          [ 1.7937e+00,  9.8695e-02,  2.1941e+00,        -inf],
          [-1.7645e+00, -4.0300e+00, -3.5917e+00,  2.9068e+00]],

         [[-2.7161e+00,        -inf,        -inf,        -inf],
          [ 2.8925e+00, -4.4878e-02,        -inf,        -inf],
          [ 1.7563e+00,  3.0968e+00,  1.3033e-01,        -inf],
          [-2.1158e+00, -7.3455e-01, -2.0824e+00,  1.5262e+00]],

         [[-1.5572e+00,        -inf,        -inf,        -inf],
          [ 3.7712e+00,  5.2385e+00,        -inf,        -inf],
          [-1.1043e+00,  2.4719e+00, -2.0718e+00,        -inf],
          [ 1.1651e-01,  6.1969e-01,  3.2728e+00, -7.9944e-01]],

         [[ 2.2430e+00,        -inf,        -inf,        -inf],
          [-4.0821e+00, -2.4023e+00,        -inf,        -inf],
          [-6.1365e-02,  1.0736e-01,  4.1565e-01,        -inf],
          [ 3.1223e-01, -3.9406e+00,  1.9441e+00, -5.3452e+00]],

         [[ 8.5209e-01,        -inf,        -inf,        -inf],
          [-7.6739e+00, -6.6341e-01,        -inf,        -inf],
          [-4.3758e-01, -1.5865e+00, -1.5482e-01,        -inf],
          [ 1.0191e+00,  9.4108e-01,  4.1152e-01, -3.8189e+00]],

         [[-1.7169e+00,        -inf,        -inf,        -inf],
          [ 7.2389e-01, -4.6208e+00,        -inf,        -inf],
          [ 4.2867e+00,  5.3858e+00, -3.2834e+00,        -inf],
          [-1.3488e+00, -9.4790e-01,  2.6337e+00,  2.2755e+00]],

         [[ 1.7370e+00,        -inf,        -inf,        -inf],
          [-4.6152e+00, -5.6307e-01,        -inf,        -inf],
          [-2.0143e+00,  1.2775e-01, -2.6382e+00,        -inf],
          [-2.9153e+00, -1.5938e-01, -2.1979e-01,  2.9311e+00]],

         [[ 2.2957e+00,        -inf,        -inf,        -inf],
          [ 2.8211e+00,  6.2472e+00,        -inf,        -inf],
          [-1.1805e+00, -2.2989e+00, -5.8987e-01,        -inf],
          [ 5.7411e-01,  9.8649e-01, -1.4916e-01, -1.4749e+00]],

         [[-2.9764e-01,        -inf,        -inf,        -inf],
          [-8.6089e-01,  9.8414e-01,        -inf,        -inf],
          [ 4.8750e+00, -4.8223e-01, -4.8551e+00,        -inf],
          [-2.1661e+00, -4.6085e+00, -5.5727e+00, -3.9043e-01]],

         [[-4.2791e-01,        -inf,        -inf,        -inf],
          [ 2.7026e+00,  5.5600e-01,        -inf,        -inf],
          [ 9.6391e-01, -4.7980e+00, -9.2461e-01,        -inf],
          [-1.9598e+00,  6.2835e-01,  2.1639e+00,  5.2870e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.1617e-01,  2.8747e-01, -8.7313e-01,  ...,  5.2789e-01,
           -3.8952e-01, -1.7994e+00],
          [ 2.2189e-01, -8.1039e-01,  4.6936e-01,  ...,  9.8004e-01,
           -3.0278e-01, -1.6542e+00],
          ...,
          [ 3.4671e-01,  7.8115e-01, -1.6471e-01,  ...,  9.2814e-01,
           -1.9053e-01,  1.1050e+00],
          [ 8.2536e-02, -5.6421e-01,  1.0322e+00,  ...,  4.1460e-01,
           -2.3630e-03,  8.4687e-03],
          [ 4.8078e-01, -9.3130e-02, -2.0920e-01,  ...,  4.1229e-01,
           -1.1551e-01,  7.4446e-01]],

         [[ 6.6641e-02,  5.8982e-01, -3.4292e-01,  ..., -2.8803e-01,
            5.9732e-01, -8.1972e-02],
          [ 4.5681e-01,  1.6373e-01, -5.6376e-01,  ...,  4.5229e-01,
           -3.1454e-01, -7.1097e-01],
          [ 6.3697e-01, -1.8527e-01,  2.0695e-01,  ...,  3.8597e-01,
           -1.8614e-01, -3.9266e-01],
          ...,
          [ 5.3604e-02,  5.7316e-01, -3.4417e-01,  ...,  5.4791e-01,
           -3.0728e-01,  4.0337e-01],
          [ 6.8166e-02,  2.8852e-03, -2.1959e-01,  ..., -5.2282e-01,
            4.4581e-01, -4.4300e-01],
          [-6.1631e-02, -2.1149e-01, -6.7630e-03,  ..., -4.9672e-02,
           -4.7518e-01,  2.0570e-01]],

         [[ 1.0135e-01,  2.8210e-01, -4.4153e-01,  ...,  7.9452e-02,
            4.5557e-01,  5.6136e-02],
          [-2.7956e-02,  1.2094e-01, -2.4530e-01,  ...,  1.7759e-01,
           -1.1782e-01, -1.0540e-01],
          [ 1.4348e-01, -3.1710e-01,  1.3220e-01,  ...,  4.9016e-01,
           -3.6079e-01, -2.1858e-01],
          ...,
          [-1.0492e-01,  5.3385e-01, -1.5920e-01,  ...,  6.6927e-01,
           -3.9960e-01,  5.6273e-02],
          [-1.6680e-01,  8.9651e-02,  2.2980e-01,  ..., -5.7007e-01,
            6.9807e-01, -1.6050e-01],
          [-4.9516e-01, -2.6845e-01,  9.6220e-02,  ...,  2.8768e-01,
           -8.9366e-02, -2.8113e-01]],

         [[ 1.2953e-02,  2.1505e-01, -3.2221e-01,  ..., -2.4544e-01,
            5.9123e-01, -7.3228e-02],
          [ 1.8874e-02,  4.6088e-02, -3.4611e-01,  ...,  1.9527e-01,
           -1.3017e-01,  4.1177e-01],
          [ 1.1391e-01,  4.5453e-02,  1.6940e-01,  ..., -3.9944e-03,
           -2.7878e-01,  1.8015e-01],
          ...,
          [-2.2049e-02,  4.2426e-01,  3.5959e-02,  ...,  4.5800e-01,
           -2.6692e-01, -6.6778e-02],
          [-1.3938e-01,  9.8092e-02, -2.5800e-01,  ..., -6.7610e-01,
            6.8837e-01, -5.5519e-02],
          [-2.4107e-01, -2.0169e-01,  4.3854e-02,  ...,  5.6839e-02,
           -2.6957e-01, -4.0531e-02]]],


        [[[ 4.2386e-01,  5.6937e-02, -1.1372e+00,  ..., -8.2280e-01,
            1.3890e+00, -5.1827e-01],
          [ 9.1559e-01,  5.8446e-01, -2.4282e-01,  ...,  3.3032e-01,
           -2.3637e-01, -2.4205e+00],
          [ 3.0997e-02, -6.0051e-01,  2.0959e-01,  ...,  9.2929e-01,
           -1.9603e-01, -7.3609e-01],
          ...,
          [ 5.2585e-01,  4.9094e-01, -2.7064e-01,  ...,  6.9568e-01,
           -5.7796e-01,  5.5526e-01],
          [-3.6971e-01, -4.2088e-01,  2.7763e-01,  ...,  7.4857e-01,
           -9.8887e-02,  2.8748e-01],
          [ 5.5551e-01,  2.1229e-01, -9.4675e-02,  ...,  3.8116e-01,
           -3.6928e-01,  4.2645e-01]],

         [[-2.5726e-02,  2.3189e-01, -8.3795e-01,  ..., -7.6044e-01,
            8.6586e-01, -6.5109e-01],
          [ 1.0537e+00,  5.1104e-01, -4.8977e-02,  ...,  4.7678e-01,
           -2.3222e-01, -1.6355e+00],
          [ 3.6979e-01, -2.7686e-01,  1.2664e-01,  ...,  3.5986e-01,
           -2.8181e-01, -3.3273e-01],
          ...,
          [ 5.8293e-02,  6.6145e-01,  7.3190e-02,  ...,  2.3843e-01,
           -7.7803e-01, -2.4039e-01],
          [-1.7464e-01, -1.8014e-02, -6.9152e-02,  ...,  9.0715e-02,
           -1.0947e-01,  1.9311e-02],
          [ 2.6820e-02, -1.2985e-01,  7.6450e-02,  ...,  3.9451e-03,
           -6.6596e-01,  2.4213e-01]],

         [[ 8.2059e-02, -1.0975e-01, -6.0965e-01,  ..., -1.8314e-01,
            3.1583e-01, -7.4335e-02],
          [ 9.4938e-01,  1.5088e-01,  5.3230e-01,  ...,  4.1105e-01,
            6.2387e-02, -4.6721e-01],
          [ 7.1963e-01, -3.0251e-01,  9.1751e-02,  ...,  3.6455e-01,
           -1.0018e-02,  1.0429e-01],
          ...,
          [-7.4560e-02,  3.9016e-01, -8.5666e-02,  ...,  5.6493e-01,
           -8.1603e-01, -2.2967e-01],
          [-2.1005e-01, -1.4730e-01,  5.6011e-02,  ...,  2.9179e-01,
           -8.8055e-02,  1.0417e-01],
          [ 5.6515e-02,  4.8490e-02, -2.4607e-01,  ...,  4.1842e-01,
           -6.0019e-01,  7.6094e-02]],

         [[-5.2526e-02, -4.5881e-02, -4.1185e-02,  ..., -1.2656e-01,
            4.9883e-02, -1.4432e-01],
          [ 4.4721e-01,  1.6907e-01,  1.8615e-01,  ...,  4.9659e-01,
           -1.1872e-01, -1.0116e+00],
          [ 9.4636e-02,  1.6480e-01,  1.0071e-01,  ...,  2.2727e-01,
           -3.7218e-01, -2.3998e-02],
          ...,
          [ 5.6756e-02,  4.9325e-01,  2.4630e-01,  ...,  4.7973e-01,
           -6.9618e-01, -1.7400e-01],
          [-1.5919e-01, -1.4672e-01,  9.0764e-02,  ..., -3.5402e-01,
           -1.2777e-01,  5.0016e-01],
          [ 3.3639e-02,  2.8246e-01, -8.0522e-03,  ...,  4.4848e-01,
           -4.5555e-01, -1.0418e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.0000,  0.0000,  0.0000,  ...,  0.4123, -0.1155,  0.7445],
         [ 0.0666,  0.5898, -0.3429,  ..., -0.0497, -0.4752,  0.2057],
         [ 0.1013,  0.2821, -0.4415,  ...,  0.2877, -0.0894, -0.2811],
         [ 0.0130,  0.2150, -0.3222,  ...,  0.0568, -0.2696, -0.0405]],

        [[ 0.4239,  0.0569, -1.1372,  ...,  0.3812, -0.3693,  0.4264],
         [-0.0257,  0.2319, -0.8379,  ...,  0.0039, -0.6660,  0.2421],
         [ 0.0821, -0.1097, -0.6097,  ...,  0.4184, -0.6002,  0.0761],
         [-0.0525, -0.0459, -0.0412,  ...,  0.4485, -0.4556, -0.1042]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1582, -0.0336, -0.3518,  ..., -0.4611,  0.3030, -0.0021],
         [ 0.1976,  0.0187, -0.3510,  ...,  0.0988,  0.0951,  0.1464],
         [ 0.2597, -0.1285, -0.0282,  ..., -0.1010,  0.2590,  0.0073],
         [-0.0218, -0.0813, -0.0167,  ..., -0.0612, -0.0640,  0.1521]],

        [[ 0.4209, -0.0203, -0.6114,  ..., -0.2899,  0.2497,  0.3884],
         [ 0.5721, -0.1434, -0.3232,  ..., -0.2103,  0.2810,  0.3120],
         [ 0.6346, -0.3515, -0.0283,  ...,  0.0177,  0.5246,  0.3571],
         [ 0.2696, -0.1118,  0.3008,  ...,  0.1243,  0.1809,  0.3390]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.3663,    -inf,    -inf,    -inf],
          [ 0.6806, -0.3685,    -inf,    -inf],
          [ 4.9179, -4.3207,  0.3269,    -inf],
          [-0.1670, -2.8854, -1.7874,  3.8169]],

         [[-4.6725,    -inf,    -inf,    -inf],
          [ 0.6215,  0.5166,    -inf,    -inf],
          [-0.5648, -0.1935, -1.6009,    -inf],
          [-1.2634,  2.8661,  5.4955,  5.5140]],

         [[-0.1006,    -inf,    -inf,    -inf],
          [ 2.8003,  4.0650,    -inf,    -inf],
          [ 2.8077, -0.3508,  1.8321,    -inf],
          [ 2.7866,  2.1210,  0.7493,  1.3307]],

         [[-4.3624,    -inf,    -inf,    -inf],
          [ 0.8165,  0.3678,    -inf,    -inf],
          [ 0.7922, -4.9628, -1.4823,    -inf],
          [-1.4071,  1.0912, -1.6613,  0.2411]],

         [[ 0.4675,    -inf,    -inf,    -inf],
          [ 6.0462, -2.2152,    -inf,    -inf],
          [-1.5802,  5.0075, -2.6349,    -inf],
          [-3.0129,  1.9947,  0.5407,  1.2626]],

         [[ 1.7682,    -inf,    -inf,    -inf],
          [ 0.5771,  0.8485,    -inf,    -inf],
          [ 5.1064,  2.8785,  0.7094,    -inf],
          [ 5.9176, -0.5884,  0.6017, -1.0410]],

         [[-3.0453,    -inf,    -inf,    -inf],
          [-0.4098, -2.4244,    -inf,    -inf],
          [-1.8245,  0.5593,  8.0774,    -inf],
          [ 0.7190,  1.3743, -1.5713,  3.4528]],

         [[ 1.5493,    -inf,    -inf,    -inf],
          [ 4.7080, -0.2177,    -inf,    -inf],
          [-6.7146, -5.1276, -1.0116,    -inf],
          [-3.9368,  2.1833,  0.3172,  1.2903]],

         [[ 2.7685,    -inf,    -inf,    -inf],
          [ 1.2385, -1.1022,    -inf,    -inf],
          [ 3.5564,  2.1590, -1.9824,    -inf],
          [-1.3413,  5.9228, -2.1370,  5.8274]],

         [[ 0.0474,    -inf,    -inf,    -inf],
          [ 0.9344,  1.7718,    -inf,    -inf],
          [ 3.2239,  2.2230, -1.9853,    -inf],
          [-0.0963, -2.0772, -1.4720, -0.7700]],

         [[ 2.7730,    -inf,    -inf,    -inf],
          [-0.0783,  2.9741,    -inf,    -inf],
          [ 1.5059,  0.0631, -0.8199,    -inf],
          [ 1.1304, -0.0988,  0.8440,  1.5965]],

         [[-2.5412,    -inf,    -inf,    -inf],
          [ 7.7286, -2.8517,    -inf,    -inf],
          [ 4.0768,  0.1341,  1.1560,    -inf],
          [-1.4906,  1.9481,  3.3934,  1.6332]]],


        [[[ 3.1677,    -inf,    -inf,    -inf],
          [ 2.3907,  3.4557,    -inf,    -inf],
          [ 1.9925,  0.3723,  2.6543,    -inf],
          [ 2.3814,  1.6923,  0.5381, -1.7038]],

         [[-6.2997,    -inf,    -inf,    -inf],
          [-1.9439, -0.7253,    -inf,    -inf],
          [ 0.3338, -1.0141, -1.8340,    -inf],
          [-2.4401,  1.4186, -2.4737,  1.1900]],

         [[ 0.4819,    -inf,    -inf,    -inf],
          [-0.1463,  0.2084,    -inf,    -inf],
          [ 3.8829,  4.5717,  1.5734,    -inf],
          [ 0.4474,  1.6718,  2.7690,  0.7008]],

         [[-3.8676,    -inf,    -inf,    -inf],
          [-3.1203, -0.4748,    -inf,    -inf],
          [-3.4947, -3.2571, -5.4610,    -inf],
          [ 1.4586, -3.0400, -0.7854, -3.7013]],

         [[-0.4613,    -inf,    -inf,    -inf],
          [ 1.9020, -2.0860,    -inf,    -inf],
          [-1.3247, -1.0244, -1.8001,    -inf],
          [ 0.2861,  3.3194,  1.4900,  0.3564]],

         [[ 0.9289,    -inf,    -inf,    -inf],
          [-2.3288, -3.2033,    -inf,    -inf],
          [-1.9497, -0.6201, -4.5456,    -inf],
          [ 4.3283, -1.6534,  1.1402,  4.2737]],

         [[ 0.3658,    -inf,    -inf,    -inf],
          [-0.9485,  3.9380,    -inf,    -inf],
          [-1.7714, -1.5063,  3.3599,    -inf],
          [ 0.7258,  0.9465, -1.2017,  1.0363]],

         [[ 0.8344,    -inf,    -inf,    -inf],
          [ 2.2280,  2.8827,    -inf,    -inf],
          [-4.0192, -3.5066,  3.3482,    -inf],
          [-1.7457,  3.6902,  2.4146,  3.8059]],

         [[ 2.6548,    -inf,    -inf,    -inf],
          [ 1.3613, -2.8915,    -inf,    -inf],
          [ 2.4448,  8.5008, -1.0100,    -inf],
          [-1.3740, -0.0701,  1.1217, -5.8835]],

         [[ 1.4991,    -inf,    -inf,    -inf],
          [-2.9867, -3.9921,    -inf,    -inf],
          [-0.8361,  3.6035,  0.1463,    -inf],
          [ 2.1980, -2.3109,  3.8265, -0.9836]],

         [[ 3.2696,    -inf,    -inf,    -inf],
          [ 2.8446, -0.7308,    -inf,    -inf],
          [-0.8099, -4.5021,  6.2019,    -inf],
          [ 0.6704, -1.9034,  2.0884,  0.0119]],

         [[-2.7685,    -inf,    -inf,    -inf],
          [ 3.7703,  4.5955,    -inf,    -inf],
          [ 4.9573,  1.2526, -0.1117,    -inf],
          [ 1.8089, -2.1571, -2.6974,  2.8352]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 0.3663,    -inf,    -inf,    -inf],
          [ 0.6806, -0.3685,    -inf,    -inf],
          [ 4.9179, -4.3207,  0.3269,    -inf],
          [-0.1670, -2.8854, -1.7874,  3.8169]],

         [[-4.6725,    -inf,    -inf,    -inf],
          [ 0.6215,  0.5166,    -inf,    -inf],
          [-0.5648, -0.1935, -1.6009,    -inf],
          [-1.2634,  2.8661,  5.4955,  5.5140]],

         [[-0.1006,    -inf,    -inf,    -inf],
          [ 2.8003,  4.0650,    -inf,    -inf],
          [ 2.8077, -0.3508,  1.8321,    -inf],
          [ 2.7866,  2.1210,  0.7493,  1.3307]],

         [[-4.3624,    -inf,    -inf,    -inf],
          [ 0.8165,  0.3678,    -inf,    -inf],
          [ 0.7922, -4.9628, -1.4823,    -inf],
          [-1.4071,  1.0912, -1.6613,  0.2411]],

         [[ 0.4675,    -inf,    -inf,    -inf],
          [ 6.0462, -2.2152,    -inf,    -inf],
          [-1.5802,  5.0075, -2.6349,    -inf],
          [-3.0129,  1.9947,  0.5407,  1.2626]],

         [[ 1.7682,    -inf,    -inf,    -inf],
          [ 0.5771,  0.8485,    -inf,    -inf],
          [ 5.1064,  2.8785,  0.7094,    -inf],
          [ 5.9176, -0.5884,  0.6017, -1.0410]],

         [[-3.0453,    -inf,    -inf,    -inf],
          [-0.4098, -2.4244,    -inf,    -inf],
          [-1.8245,  0.5593,  8.0774,    -inf],
          [ 0.7190,  1.3743, -1.5713,  3.4528]],

         [[ 1.5493,    -inf,    -inf,    -inf],
          [ 4.7080, -0.2177,    -inf,    -inf],
          [-6.7146, -5.1276, -1.0116,    -inf],
          [-3.9368,  2.1833,  0.3172,  1.2903]],

         [[ 2.7685,    -inf,    -inf,    -inf],
          [ 1.2385, -1.1022,    -inf,    -inf],
          [ 3.5564,  2.1590, -1.9824,    -inf],
          [-1.3413,  5.9228, -2.1370,  5.8274]],

         [[ 0.0474,    -inf,    -inf,    -inf],
          [ 0.9344,  1.7718,    -inf,    -inf],
          [ 3.2239,  2.2230, -1.9853,    -inf],
          [-0.0963, -2.0772, -1.4720, -0.7700]],

         [[ 2.7730,    -inf,    -inf,    -inf],
          [-0.0783,  2.9741,    -inf,    -inf],
          [ 1.5059,  0.0631, -0.8199,    -inf],
          [ 1.1304, -0.0988,  0.8440,  1.5965]],

         [[-2.5412,    -inf,    -inf,    -inf],
          [ 7.7286, -2.8517,    -inf,    -inf],
          [ 4.0768,  0.1341,  1.1560,    -inf],
          [-1.4906,  1.9481,  3.3934,  1.6332]]],


        [[[ 3.1677,    -inf,    -inf,    -inf],
          [ 2.3907,  3.4557,    -inf,    -inf],
          [ 1.9925,  0.3723,  2.6543,    -inf],
          [ 2.3814,  1.6923,  0.5381, -1.7038]],

         [[-6.2997,    -inf,    -inf,    -inf],
          [-1.9439, -0.7253,    -inf,    -inf],
          [ 0.3338, -1.0141, -1.8340,    -inf],
          [-2.4401,  1.4186, -2.4737,  1.1900]],

         [[ 0.4819,    -inf,    -inf,    -inf],
          [-0.1463,  0.2084,    -inf,    -inf],
          [ 3.8829,  4.5717,  1.5734,    -inf],
          [ 0.4474,  1.6718,  2.7690,  0.7008]],

         [[-3.8676,    -inf,    -inf,    -inf],
          [-3.1203, -0.4748,    -inf,    -inf],
          [-3.4947, -3.2571, -5.4610,    -inf],
          [ 1.4586, -3.0400, -0.7854, -3.7013]],

         [[-0.4613,    -inf,    -inf,    -inf],
          [ 1.9020, -2.0860,    -inf,    -inf],
          [-1.3247, -1.0244, -1.8001,    -inf],
          [ 0.2861,  3.3194,  1.4900,  0.3564]],

         [[ 0.9289,    -inf,    -inf,    -inf],
          [-2.3288, -3.2033,    -inf,    -inf],
          [-1.9497, -0.6201, -4.5456,    -inf],
          [ 4.3283, -1.6534,  1.1402,  4.2737]],

         [[ 0.3658,    -inf,    -inf,    -inf],
          [-0.9485,  3.9380,    -inf,    -inf],
          [-1.7714, -1.5063,  3.3599,    -inf],
          [ 0.7258,  0.9465, -1.2017,  1.0363]],

         [[ 0.8344,    -inf,    -inf,    -inf],
          [ 2.2280,  2.8827,    -inf,    -inf],
          [-4.0192, -3.5066,  3.3482,    -inf],
          [-1.7457,  3.6902,  2.4146,  3.8059]],

         [[ 2.6548,    -inf,    -inf,    -inf],
          [ 1.3613, -2.8915,    -inf,    -inf],
          [ 2.4448,  8.5008, -1.0100,    -inf],
          [-1.3740, -0.0701,  1.1217, -5.8835]],

         [[ 1.4991,    -inf,    -inf,    -inf],
          [-2.9867, -3.9921,    -inf,    -inf],
          [-0.8361,  3.6035,  0.1463,    -inf],
          [ 2.1980, -2.3109,  3.8265, -0.9836]],

         [[ 3.2696,    -inf,    -inf,    -inf],
          [ 2.8446, -0.7308,    -inf,    -inf],
          [-0.8099, -4.5021,  6.2019,    -inf],
          [ 0.6704, -1.9034,  2.0884,  0.0119]],

         [[-2.7685,    -inf,    -inf,    -inf],
          [ 3.7703,  4.5955,    -inf,    -inf],
          [ 4.9573,  1.2526, -0.1117,    -inf],
          [ 1.8089, -2.1571, -2.6974,  2.8352]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.1120, -0.0527, -0.2068,  ..., -0.8192, -0.4145,  1.1938],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.5160, -0.3889, -0.1710,  ...,  0.6891,  1.0842,  0.9873],
          ...,
          [ 0.1165, -0.6029, -0.0682,  ...,  0.7093, -0.1300,  0.8281],
          [ 1.2676, -0.1186, -0.9930,  ...,  0.1614,  0.3868, -0.4352],
          [-0.4059,  0.0138, -0.1092,  ..., -0.1425, -0.3480, -1.1469]],

         [[-0.2053, -0.3713,  0.0481,  ..., -0.6529, -0.5717,  0.2999],
          [-0.0801, -0.1637,  0.0490,  ...,  0.3172, -0.4062,  0.0177],
          [-0.0636, -0.8114,  0.3337,  ...,  0.2956,  1.3953, -0.5489],
          ...,
          [ 0.0770, -0.9578,  0.0300,  ...,  0.7109, -0.1823,  0.4104],
          [ 0.2975, -0.0251, -0.8610,  ...,  0.1996,  0.2610,  0.3310],
          [-0.0974,  0.0224,  0.1777,  ...,  0.0526,  0.0514,  0.1769]],

         [[-0.0766,  0.1479,  0.0495,  ..., -0.1323, -0.1819,  0.7536],
          [-0.1894, -0.1665, -0.2777,  ...,  0.1451, -0.6103,  0.0115],
          [ 0.0546, -0.4606,  0.1345,  ...,  0.2587,  0.8610, -0.1041],
          ...,
          [-0.0445, -0.8425,  0.1833,  ...,  0.9288, -0.1682,  0.3941],
          [ 0.4272,  0.1107, -0.7905,  ...,  0.4320,  0.1258,  0.0768],
          [-0.3097,  0.2299,  0.1836,  ...,  0.2270, -0.0338, -0.1724]],

         [[-0.0550,  0.0900,  0.0149,  ...,  0.4857, -0.6643,  0.9783],
          [ 0.0020, -0.0316, -0.1688,  ...,  0.0473, -0.2658,  0.0683],
          [ 0.2803, -0.1544,  0.2690,  ..., -0.2091,  0.7221, -0.6750],
          ...,
          [-0.1392, -0.6341,  0.3960,  ...,  0.3818,  0.0532,  0.2143],
          [ 0.3879, -0.0181, -0.1163,  ...,  0.0699,  0.1575, -0.1581],
          [-0.3580, -0.0513,  0.0527,  ...,  0.2200,  0.4278,  0.1215]]],


        [[[ 0.3806,  0.5576, -0.2868,  ..., -0.8419, -0.3327,  1.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.9654,  0.0097, -0.0538,  ...,  1.1341,  0.5369,  0.9081],
          ...,
          [-0.4328, -0.5202,  0.1527,  ...,  0.7245, -0.5300,  0.6794],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.9623, -0.0058,  0.1681,  ..., -0.5809,  0.1037, -1.3150]],

         [[ 0.2738,  0.0966,  0.2400,  ..., -0.7706, -0.2330,  0.4067],
          [-0.7033, -0.2589, -0.6411,  ...,  0.3883, -0.7196, -0.4585],
          [ 0.7486, -0.2858, -0.2434,  ...,  0.3213,  0.5866,  0.0188],
          ...,
          [-0.7189, -0.5616,  0.0234,  ...,  0.4295, -0.1587,  0.3172],
          [-0.0492,  0.0982,  0.0921,  ..., -0.3002, -0.2580, -0.1661],
          [-0.2251,  0.4498,  0.0301,  ..., -0.4689,  0.7038, -0.8659]],

         [[ 0.1819,  0.1057,  0.0984,  ..., -0.4892, -0.1556,  0.3128],
          [-0.1646,  0.0946, -0.7886,  ..., -0.0660, -0.5622, -0.4560],
          [ 0.3523, -0.1010,  0.0850,  ..., -0.4398,  0.0837, -0.2088],
          ...,
          [-0.5811, -0.4081, -0.0160,  ...,  0.2298, -0.0189,  0.1334],
          [ 0.2820,  0.0591, -0.6900,  ...,  0.0116,  0.1179, -0.1021],
          [-0.3174,  0.2481,  0.0503,  ..., -0.3761,  0.4108, -0.7431]],

         [[ 0.4092,  0.0256,  0.1646,  ..., -0.0194, -0.3802,  0.3555],
          [-0.2743,  0.0714, -0.5505,  ..., -0.2090, -0.5674, -0.4310],
          [ 0.5985,  0.0378,  0.3444,  ..., -0.6228,  0.1586,  0.0386],
          ...,
          [-0.5722, -0.4127,  0.1100,  ...,  0.2020, -0.1588,  0.2062],
          [ 0.2474,  0.1742, -0.4558,  ..., -0.2186,  0.1364, -0.0299],
          [-0.4864, -0.0851,  0.2582,  ..., -0.5988,  0.9600, -0.6539]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.1120, -0.0527, -0.2068,  ..., -0.1425, -0.3480, -1.1469],
         [-0.2053, -0.3713,  0.0481,  ...,  0.0526,  0.0514,  0.1769],
         [-0.0766,  0.1479,  0.0495,  ...,  0.2270, -0.0338, -0.1724],
         [-0.0550,  0.0900,  0.0149,  ...,  0.2200,  0.4278,  0.1215]],

        [[ 0.3806,  0.5576, -0.2868,  ..., -0.5809,  0.1037, -1.3150],
         [ 0.2738,  0.0966,  0.2400,  ..., -0.4689,  0.7038, -0.8659],
         [ 0.1819,  0.1057,  0.0984,  ..., -0.3761,  0.4108, -0.7431],
         [ 0.4092,  0.0256,  0.1646,  ..., -0.5988,  0.9600, -0.6539]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.7069, -0.5773,  0.4487,  ...,  0.2157,  0.2566,  0.6944],
         [ 0.2723, -0.6999,  0.2693,  ...,  0.0116,  0.2312,  0.3578],
         [ 0.2936, -0.4800,  0.3725,  ...,  0.2140,  0.1308,  0.2263],
         [ 0.3428, -0.1971,  0.4298,  ...,  0.0573,  0.2552,  0.2392]],

        [[ 0.3956, -0.4956,  0.2916,  ...,  0.2380,  0.2306,  0.4328],
         [ 0.2703, -0.1127,  0.3160,  ..., -0.0619,  0.1011,  0.3879],
         [-0.0809, -0.0991,  0.3509,  ...,  0.1888, -0.0912,  0.4621],
         [-0.0090, -0.0249,  0.5184,  ...,  0.0158, -0.0709,  0.3318]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.5882e-01,        -inf,        -inf,        -inf],
          [ 1.9528e+00,  3.1500e-01,        -inf,        -inf],
          [-1.9440e+00, -2.2581e+00,  4.4196e+00,        -inf],
          [-7.2926e-01, -2.2949e-01,  3.9834e-01,  3.9452e+00]],

         [[ 5.5795e-01,        -inf,        -inf,        -inf],
          [-1.9378e+00, -3.3897e+00,        -inf,        -inf],
          [-1.9345e+00, -4.7982e+00, -2.4897e-01,        -inf],
          [ 2.7420e+00, -2.5939e+00, -1.7032e-01,  2.2183e+00]],

         [[-1.6567e+00,        -inf,        -inf,        -inf],
          [-1.9993e+00,  2.1768e-01,        -inf,        -inf],
          [ 1.8631e+00, -2.1435e+00,  1.0498e+00,        -inf],
          [-2.4466e+00, -1.6247e+00,  2.4631e+00, -7.1202e-01]],

         [[-7.1505e-01,        -inf,        -inf,        -inf],
          [ 3.9764e+00, -8.6621e+00,        -inf,        -inf],
          [-3.3519e+00,  1.2969e+00,  6.3734e-01,        -inf],
          [-2.3380e+00,  2.2182e+00,  3.0605e+00,  1.8769e+00]],

         [[ 3.6092e+00,        -inf,        -inf,        -inf],
          [-3.5560e+00, -1.1634e+00,        -inf,        -inf],
          [-4.8032e+00, -3.3670e+00, -6.3912e-01,        -inf],
          [-3.8319e+00, -1.4007e+00, -2.2782e+00, -2.1850e+00]],

         [[ 2.9195e-01,        -inf,        -inf,        -inf],
          [-1.2175e+00,  4.5721e+00,        -inf,        -inf],
          [ 3.6044e+00,  1.5281e+00, -2.2380e+00,        -inf],
          [-9.6714e-01,  1.7579e-02, -3.5756e-01, -2.5921e+00]],

         [[ 3.9165e+00,        -inf,        -inf,        -inf],
          [ 5.5886e+00, -2.4365e+00,        -inf,        -inf],
          [ 2.0609e-01,  2.2412e-01, -4.3653e+00,        -inf],
          [-6.8033e+00,  1.6471e+00,  1.4101e+00, -1.6476e+00]],

         [[-4.7050e+00,        -inf,        -inf,        -inf],
          [ 8.5459e-01, -2.6652e+00,        -inf,        -inf],
          [-4.1707e+00, -3.5557e+00,  1.8806e-01,        -inf],
          [-1.6367e+00, -1.9220e-02,  3.9534e+00, -2.5977e+00]],

         [[-3.9192e+00,        -inf,        -inf,        -inf],
          [ 1.2641e+00,  6.0861e-01,        -inf,        -inf],
          [ 4.4823e+00,  1.0472e+00,  8.4970e-01,        -inf],
          [ 1.2216e-01,  8.5508e-02, -1.5527e-01,  1.9122e-01]],

         [[ 7.6257e-01,        -inf,        -inf,        -inf],
          [ 7.9853e-01,  1.9100e+00,        -inf,        -inf],
          [ 5.5881e+00, -2.6315e+00,  6.6864e+00,        -inf],
          [ 1.9486e+00, -3.2195e+00, -9.6842e-01, -1.0617e+00]],

         [[ 1.6616e+00,        -inf,        -inf,        -inf],
          [-5.9937e-01,  2.0532e+00,        -inf,        -inf],
          [ 5.9090e-01,  4.0336e-01, -8.2549e-01,        -inf],
          [-2.4677e+00,  2.5556e+00,  3.3745e+00,  1.9812e+00]],

         [[-1.5271e+00,        -inf,        -inf,        -inf],
          [-5.7251e+00,  9.0008e-02,        -inf,        -inf],
          [ 3.4058e+00, -1.3098e+00, -5.9910e-02,        -inf],
          [-8.0114e-02,  1.6959e+00, -2.9381e-01, -2.9932e+00]]],


        [[[ 8.4765e-01,        -inf,        -inf,        -inf],
          [ 2.7202e-01, -2.4935e+00,        -inf,        -inf],
          [ 8.3036e-01, -3.3853e-01, -5.4136e-01,        -inf],
          [-5.7118e-01, -1.5305e+00, -1.1067e+00, -1.2032e+00]],

         [[ 2.5058e+00,        -inf,        -inf,        -inf],
          [-3.2742e+00,  2.7691e+00,        -inf,        -inf],
          [ 2.1303e+00, -1.5807e-01, -1.1262e+00,        -inf],
          [-1.1790e+00, -3.7275e+00,  4.2084e-01,  8.9791e-01]],

         [[-1.0544e+00,        -inf,        -inf,        -inf],
          [ 1.7465e-01, -4.3559e+00,        -inf,        -inf],
          [ 2.0660e+00, -5.1407e+00,  6.5766e-01,        -inf],
          [-3.2718e+00,  6.6149e-02,  3.0436e-01, -4.7787e-01]],

         [[-2.4700e-01,        -inf,        -inf,        -inf],
          [ 2.5149e+00, -8.4814e-01,        -inf,        -inf],
          [-5.5044e+00, -6.3102e+00, -2.3113e+00,        -inf],
          [ 2.5164e+00,  1.8827e+00,  2.6134e+00, -5.5467e-01]],

         [[ 9.4027e-01,        -inf,        -inf,        -inf],
          [ 3.4806e-03,  2.2557e+00,        -inf,        -inf],
          [ 1.4512e+00, -3.0332e+00,  2.8953e+00,        -inf],
          [-1.0330e+00,  2.2644e+00,  6.5524e-01, -8.4922e-01]],

         [[ 1.2540e+00,        -inf,        -inf,        -inf],
          [ 1.6228e+00,  2.1724e+00,        -inf,        -inf],
          [ 3.1733e+00,  3.1647e+00, -1.6857e+00,        -inf],
          [ 1.6525e+00,  8.0347e-01, -3.0069e+00, -4.6174e-01]],

         [[ 9.5586e-01,        -inf,        -inf,        -inf],
          [ 2.6579e+00,  9.8927e-01,        -inf,        -inf],
          [-4.1312e+00, -4.1744e+00, -3.3637e+00,        -inf],
          [-7.4545e+00,  1.6188e+00, -3.0428e+00,  3.8975e+00]],

         [[-4.1712e+00,        -inf,        -inf,        -inf],
          [ 1.3533e+00, -4.4189e+00,        -inf,        -inf],
          [-3.8133e+00,  4.5133e+00, -6.0059e+00,        -inf],
          [-4.9292e+00,  2.5006e+00, -2.2165e+00, -4.0548e+00]],

         [[-5.2058e+00,        -inf,        -inf,        -inf],
          [-1.3285e+00,  1.9679e+00,        -inf,        -inf],
          [ 2.7994e+00,  1.6604e-01,  1.2349e+00,        -inf],
          [-5.0490e+00,  1.0957e+00, -4.0276e+00,  2.4891e-01]],

         [[ 2.8176e+00,        -inf,        -inf,        -inf],
          [-3.1389e+00,  2.8937e+00,        -inf,        -inf],
          [ 4.3890e+00,  3.1711e-01, -7.9988e-01,        -inf],
          [ 3.9739e+00,  6.3448e-01, -1.1723e+00, -4.2903e-02]],

         [[ 1.2277e+00,        -inf,        -inf,        -inf],
          [ 1.1572e+00,  2.2459e+00,        -inf,        -inf],
          [-7.7164e-01,  4.6813e-01,  3.1302e+00,        -inf],
          [-3.3974e+00, -2.7187e+00, -2.5653e+00, -1.2911e-01]],

         [[ 3.1092e+00,        -inf,        -inf,        -inf],
          [-7.2145e-01,  2.8432e+00,        -inf,        -inf],
          [ 2.4665e+00,  2.0988e+00, -4.5709e+00,        -inf],
          [ 1.5049e+00,  4.2011e+00,  8.5395e-01,  4.1792e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.5882e-01,        -inf,        -inf,        -inf],
          [ 1.9528e+00,  3.1500e-01,        -inf,        -inf],
          [-1.9440e+00, -2.2581e+00,  4.4196e+00,        -inf],
          [-7.2926e-01, -2.2949e-01,  3.9834e-01,  3.9452e+00]],

         [[ 5.5795e-01,        -inf,        -inf,        -inf],
          [-1.9378e+00, -3.3897e+00,        -inf,        -inf],
          [-1.9345e+00, -4.7982e+00, -2.4897e-01,        -inf],
          [ 2.7420e+00, -2.5939e+00, -1.7032e-01,  2.2183e+00]],

         [[-1.6567e+00,        -inf,        -inf,        -inf],
          [-1.9993e+00,  2.1768e-01,        -inf,        -inf],
          [ 1.8631e+00, -2.1435e+00,  1.0498e+00,        -inf],
          [-2.4466e+00, -1.6247e+00,  2.4631e+00, -7.1202e-01]],

         [[-7.1505e-01,        -inf,        -inf,        -inf],
          [ 3.9764e+00, -8.6621e+00,        -inf,        -inf],
          [-3.3519e+00,  1.2969e+00,  6.3734e-01,        -inf],
          [-2.3380e+00,  2.2182e+00,  3.0605e+00,  1.8769e+00]],

         [[ 3.6092e+00,        -inf,        -inf,        -inf],
          [-3.5560e+00, -1.1634e+00,        -inf,        -inf],
          [-4.8032e+00, -3.3670e+00, -6.3912e-01,        -inf],
          [-3.8319e+00, -1.4007e+00, -2.2782e+00, -2.1850e+00]],

         [[ 2.9195e-01,        -inf,        -inf,        -inf],
          [-1.2175e+00,  4.5721e+00,        -inf,        -inf],
          [ 3.6044e+00,  1.5281e+00, -2.2380e+00,        -inf],
          [-9.6714e-01,  1.7579e-02, -3.5756e-01, -2.5921e+00]],

         [[ 3.9165e+00,        -inf,        -inf,        -inf],
          [ 5.5886e+00, -2.4365e+00,        -inf,        -inf],
          [ 2.0609e-01,  2.2412e-01, -4.3653e+00,        -inf],
          [-6.8033e+00,  1.6471e+00,  1.4101e+00, -1.6476e+00]],

         [[-4.7050e+00,        -inf,        -inf,        -inf],
          [ 8.5459e-01, -2.6652e+00,        -inf,        -inf],
          [-4.1707e+00, -3.5557e+00,  1.8806e-01,        -inf],
          [-1.6367e+00, -1.9220e-02,  3.9534e+00, -2.5977e+00]],

         [[-3.9192e+00,        -inf,        -inf,        -inf],
          [ 1.2641e+00,  6.0861e-01,        -inf,        -inf],
          [ 4.4823e+00,  1.0472e+00,  8.4970e-01,        -inf],
          [ 1.2216e-01,  8.5508e-02, -1.5527e-01,  1.9122e-01]],

         [[ 7.6257e-01,        -inf,        -inf,        -inf],
          [ 7.9853e-01,  1.9100e+00,        -inf,        -inf],
          [ 5.5881e+00, -2.6315e+00,  6.6864e+00,        -inf],
          [ 1.9486e+00, -3.2195e+00, -9.6842e-01, -1.0617e+00]],

         [[ 1.6616e+00,        -inf,        -inf,        -inf],
          [-5.9937e-01,  2.0532e+00,        -inf,        -inf],
          [ 5.9090e-01,  4.0336e-01, -8.2549e-01,        -inf],
          [-2.4677e+00,  2.5556e+00,  3.3745e+00,  1.9812e+00]],

         [[-1.5271e+00,        -inf,        -inf,        -inf],
          [-5.7251e+00,  9.0008e-02,        -inf,        -inf],
          [ 3.4058e+00, -1.3098e+00, -5.9910e-02,        -inf],
          [-8.0114e-02,  1.6959e+00, -2.9381e-01, -2.9932e+00]]],


        [[[ 8.4765e-01,        -inf,        -inf,        -inf],
          [ 2.7202e-01, -2.4935e+00,        -inf,        -inf],
          [ 8.3036e-01, -3.3853e-01, -5.4136e-01,        -inf],
          [-5.7118e-01, -1.5305e+00, -1.1067e+00, -1.2032e+00]],

         [[ 2.5058e+00,        -inf,        -inf,        -inf],
          [-3.2742e+00,  2.7691e+00,        -inf,        -inf],
          [ 2.1303e+00, -1.5807e-01, -1.1262e+00,        -inf],
          [-1.1790e+00, -3.7275e+00,  4.2084e-01,  8.9791e-01]],

         [[-1.0544e+00,        -inf,        -inf,        -inf],
          [ 1.7465e-01, -4.3559e+00,        -inf,        -inf],
          [ 2.0660e+00, -5.1407e+00,  6.5766e-01,        -inf],
          [-3.2718e+00,  6.6149e-02,  3.0436e-01, -4.7787e-01]],

         [[-2.4700e-01,        -inf,        -inf,        -inf],
          [ 2.5149e+00, -8.4814e-01,        -inf,        -inf],
          [-5.5044e+00, -6.3102e+00, -2.3113e+00,        -inf],
          [ 2.5164e+00,  1.8827e+00,  2.6134e+00, -5.5467e-01]],

         [[ 9.4027e-01,        -inf,        -inf,        -inf],
          [ 3.4806e-03,  2.2557e+00,        -inf,        -inf],
          [ 1.4512e+00, -3.0332e+00,  2.8953e+00,        -inf],
          [-1.0330e+00,  2.2644e+00,  6.5524e-01, -8.4922e-01]],

         [[ 1.2540e+00,        -inf,        -inf,        -inf],
          [ 1.6228e+00,  2.1724e+00,        -inf,        -inf],
          [ 3.1733e+00,  3.1647e+00, -1.6857e+00,        -inf],
          [ 1.6525e+00,  8.0347e-01, -3.0069e+00, -4.6174e-01]],

         [[ 9.5586e-01,        -inf,        -inf,        -inf],
          [ 2.6579e+00,  9.8927e-01,        -inf,        -inf],
          [-4.1312e+00, -4.1744e+00, -3.3637e+00,        -inf],
          [-7.4545e+00,  1.6188e+00, -3.0428e+00,  3.8975e+00]],

         [[-4.1712e+00,        -inf,        -inf,        -inf],
          [ 1.3533e+00, -4.4189e+00,        -inf,        -inf],
          [-3.8133e+00,  4.5133e+00, -6.0059e+00,        -inf],
          [-4.9292e+00,  2.5006e+00, -2.2165e+00, -4.0548e+00]],

         [[-5.2058e+00,        -inf,        -inf,        -inf],
          [-1.3285e+00,  1.9679e+00,        -inf,        -inf],
          [ 2.7994e+00,  1.6604e-01,  1.2349e+00,        -inf],
          [-5.0490e+00,  1.0957e+00, -4.0276e+00,  2.4891e-01]],

         [[ 2.8176e+00,        -inf,        -inf,        -inf],
          [-3.1389e+00,  2.8937e+00,        -inf,        -inf],
          [ 4.3890e+00,  3.1711e-01, -7.9988e-01,        -inf],
          [ 3.9739e+00,  6.3448e-01, -1.1723e+00, -4.2903e-02]],

         [[ 1.2277e+00,        -inf,        -inf,        -inf],
          [ 1.1572e+00,  2.2459e+00,        -inf,        -inf],
          [-7.7164e-01,  4.6813e-01,  3.1302e+00,        -inf],
          [-3.3974e+00, -2.7187e+00, -2.5653e+00, -1.2911e-01]],

         [[ 3.1092e+00,        -inf,        -inf,        -inf],
          [-7.2145e-01,  2.8432e+00,        -inf,        -inf],
          [ 2.4665e+00,  2.0988e+00, -4.5709e+00,        -inf],
          [ 1.5049e+00,  4.2011e+00,  8.5395e-01,  4.1792e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.3551,  0.1618, -0.3918,  ...,  0.0711, -0.2157, -0.1558],
          [ 0.0949,  1.4645,  0.2514,  ..., -1.1555,  0.3607,  0.5408],
          [-0.0059,  1.0204,  0.6918,  ...,  0.7270,  0.5801, -0.4059],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.7206, -0.6099, -0.1708,  ..., -0.6227,  0.6961, -0.3575],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[ 0.3096,  0.3589, -0.2296,  ...,  0.0449,  0.2131, -0.3337],
          [ 0.3784,  0.5927,  0.4359,  ..., -0.7441,  0.4861, -0.2151],
          [ 0.2587,  0.0217,  0.0743,  ...,  0.0515, -0.0999, -0.2722],
          ...,
          [ 1.0919,  0.0823,  0.3047,  ...,  0.3396,  0.2517, -0.5471],
          [ 0.4549, -0.8637, -0.1679,  ..., -0.1030,  0.0461, -0.6791],
          [-0.9098,  0.4090, -0.4222,  ..., -0.5535,  0.3369, -0.9346]],

         [[-0.5273,  0.1371, -0.2573,  ..., -0.4482,  0.4225, -0.5847],
          [ 0.3723,  0.4412,  0.0942,  ..., -0.5039,  0.5579, -0.7970],
          [ 0.6689,  0.4196,  0.2606,  ...,  0.0192,  0.4351, -0.1976],
          ...,
          [ 0.4608, -0.1815,  0.2291,  ...,  0.0228, -0.1059, -0.8411],
          [ 0.1518, -0.2062,  0.0725,  ..., -0.1540,  0.2662, -0.1667],
          [-0.4101, -0.0020, -0.0034,  ..., -0.2732,  0.5757, -0.5411]],

         [[-0.4120,  0.0168,  0.0758,  ..., -0.1827,  0.2857, -0.5444],
          [ 0.5706,  0.3727,  0.1720,  ..., -0.5473,  0.6098, -0.5702],
          [ 0.6501,  0.2082,  0.1149,  ..., -0.1295,  0.3174, -0.1014],
          ...,
          [ 0.5032, -0.0973,  0.2173,  ...,  0.1081,  0.0094, -0.5701],
          [-0.1959,  0.1196,  0.1884,  ..., -0.1156,  0.4029,  0.3950],
          [-0.6943,  0.0140, -0.0345,  ..., -0.3720,  0.4279, -0.7034]]],


        [[[ 0.5988, -0.1644,  0.1134,  ...,  0.2469,  0.1467,  0.8389],
          [ 0.3168,  1.1169,  0.3670,  ..., -0.9990, -0.4849,  0.9427],
          [-0.6017,  0.7323,  0.2264,  ...,  1.1738,  0.2454, -0.5317],
          ...,
          [ 1.0145, -0.2666,  0.8226,  ...,  0.7180,  0.4773, -0.6245],
          [ 0.5345, -0.9823, -0.6945,  ..., -0.4508,  0.9967, -0.1390],
          [ 0.5592,  0.0126, -0.4960,  ..., -0.8590,  0.1093,  0.5608]],

         [[ 0.4562, -0.0389, -0.0767,  ...,  0.3343,  0.6027,  0.7291],
          [ 0.6894,  0.6364,  0.4752,  ..., -1.0791,  0.3416, -0.6517],
          [ 0.4546,  0.0683, -0.4410,  ...,  0.2921, -0.1399, -0.2817],
          ...,
          [ 0.6890, -0.2938,  0.7529,  ..., -0.0739,  0.3313, -0.8531],
          [ 0.1733, -0.4193, -0.5165,  ..., -0.2787,  0.7269, -0.0125],
          [-0.5245,  0.1609,  0.1187,  ..., -0.8307,  0.0445, -0.5945]],

         [[ 0.2139, -0.2687, -0.1474,  ...,  0.2070,  0.6679,  0.5432],
          [ 0.1250,  0.7062,  0.1201,  ..., -0.3784, -0.1498,  0.1118],
          [ 0.3334,  0.8622, -0.2097,  ...,  0.5687, -0.5534, -0.2222],
          ...,
          [ 0.6811, -0.0042,  0.5748,  ...,  0.1076, -0.1389, -0.4625],
          [ 0.1191,  0.1538, -0.5652,  ..., -0.3493,  0.7392,  0.1389],
          [-0.0863,  0.0265,  0.0557,  ..., -0.6584,  0.2518, -0.5072]],

         [[-0.0115, -0.2565, -0.0787,  ...,  0.1583,  0.2990,  0.3569],
          [ 0.4509,  0.3407,  0.1289,  ..., -0.3025,  0.1538, -0.5247],
          [ 0.3096,  0.5770, -0.4818,  ...,  0.3223, -0.4475, -0.2200],
          ...,
          [ 0.4119, -0.1275,  0.2890,  ...,  0.1863, -0.0361, -0.1234],
          [ 0.1051,  0.0756, -0.6252,  ..., -0.3212,  0.3932,  0.2237],
          [-0.2517, -0.1965, -0.2053,  ..., -0.6034,  0.1518, -0.5031]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.3551,  0.1618, -0.3918,  ...,  0.0000,  0.0000,  0.0000],
         [ 0.3096,  0.3589, -0.2296,  ..., -0.5535,  0.3369, -0.9346],
         [-0.5273,  0.1371, -0.2573,  ..., -0.2732,  0.5757, -0.5411],
         [-0.4120,  0.0168,  0.0758,  ..., -0.3720,  0.4279, -0.7034]],

        [[ 0.5988, -0.1644,  0.1134,  ..., -0.8590,  0.1093,  0.5608],
         [ 0.4562, -0.0389, -0.0767,  ..., -0.8307,  0.0445, -0.5945],
         [ 0.2139, -0.2687, -0.1474,  ..., -0.6584,  0.2518, -0.5072],
         [-0.0115, -0.2565, -0.0787,  ..., -0.6034,  0.1518, -0.5031]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.0020,  0.2700,  0.1059,  ...,  0.0608,  0.2438,  0.1550],
         [ 0.2143,  0.2396,  0.1222,  ...,  0.0607,  0.0194,  0.1163],
         [ 0.0743,  0.0656, -0.1796,  ..., -0.3055,  0.1701, -0.1873],
         [ 0.1600,  0.2686, -0.2129,  ..., -0.2885,  0.1889, -0.0965]],

        [[ 0.2007,  0.3203, -0.0484,  ..., -0.0195,  0.3848,  0.1284],
         [-0.1004,  0.3992, -0.0585,  ...,  0.1732,  0.3348, -0.1501],
         [-0.0160,  0.1832, -0.2703,  ...,  0.1008, -0.0040, -0.3223],
         [-0.0706,  0.2781, -0.3330,  ..., -0.0787,  0.0483, -0.1685]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-5.2320,    -inf,    -inf,    -inf],
          [-5.6535, -0.6315,    -inf,    -inf],
          [-3.4414, -3.9477, -3.2936,    -inf],
          [-4.0928, -4.6457,  3.6072,  2.4798]],

         [[ 2.8211,    -inf,    -inf,    -inf],
          [ 2.2822,  0.7765,    -inf,    -inf],
          [-7.2501,  0.8440, -3.6182,    -inf],
          [ 1.2454,  1.7141, -1.5757, -2.1441]],

         [[-3.5764,    -inf,    -inf,    -inf],
          [-0.1214,  0.0607,    -inf,    -inf],
          [ 6.2005,  2.6470, -2.7223,    -inf],
          [ 0.7827, -1.5717,  2.4438,  1.0577]],

         [[ 0.5857,    -inf,    -inf,    -inf],
          [ 1.0843, -1.8439,    -inf,    -inf],
          [-0.6353, -3.5127,  1.2792,    -inf],
          [ 2.4407,  0.0461, -2.3220, -2.6703]],

         [[-1.5281,    -inf,    -inf,    -inf],
          [ 1.5160, -0.5598,    -inf,    -inf],
          [-1.0522, -2.4238, -1.4772,    -inf],
          [ 3.7873,  5.4384, -0.4097,  4.5119]],

         [[ 1.8135,    -inf,    -inf,    -inf],
          [ 1.0827, -2.0084,    -inf,    -inf],
          [-4.0971,  1.1072,  1.2879,    -inf],
          [-2.2930, -2.3262, -2.7818, -3.4725]],

         [[-6.1603,    -inf,    -inf,    -inf],
          [ 1.7756,  3.3936,    -inf,    -inf],
          [-4.9745,  0.1631,  0.4131,    -inf],
          [ 1.8607,  2.3344, -0.4040, -4.5489]],

         [[ 0.0578,    -inf,    -inf,    -inf],
          [-2.3004,  0.2400,    -inf,    -inf],
          [-1.5407, -4.5385,  0.9226,    -inf],
          [ 4.9260,  0.1876,  1.2546,  1.7049]],

         [[ 5.9731,    -inf,    -inf,    -inf],
          [ 1.2773,  0.2884,    -inf,    -inf],
          [ 4.3528,  1.2524, -2.9774,    -inf],
          [ 4.4597,  2.7715, -1.0927,  0.5723]],

         [[-2.0644,    -inf,    -inf,    -inf],
          [ 0.5439, -2.3367,    -inf,    -inf],
          [ 2.9966,  1.6191,  1.8868,    -inf],
          [-1.5159, -2.2030, -2.6726, -4.7868]],

         [[ 0.0181,    -inf,    -inf,    -inf],
          [-1.6803,  0.9091,    -inf,    -inf],
          [ 2.9995,  2.2101,  0.2375,    -inf],
          [-2.5591,  0.4514, -0.7586, -3.5249]],

         [[ 0.2898,    -inf,    -inf,    -inf],
          [-3.4420,  1.8695,    -inf,    -inf],
          [-0.8693, -2.4781, -0.6226,    -inf],
          [-1.4649, -0.3966, -0.1680, -0.5284]]],


        [[[-5.3741,    -inf,    -inf,    -inf],
          [-0.5462,  3.8340,    -inf,    -inf],
          [-0.2030, -1.8065, -1.3258,    -inf],
          [ 1.2782, -1.3343, -0.9428, -1.1214]],

         [[ 4.4646,    -inf,    -inf,    -inf],
          [-2.7475,  0.3384,    -inf,    -inf],
          [-1.7484,  1.1073,  0.5074,    -inf],
          [ 1.8271,  2.9949, -4.0515,  4.3299]],

         [[-3.0225,    -inf,    -inf,    -inf],
          [-1.4398, -4.9230,    -inf,    -inf],
          [ 5.6751, -1.9042,  0.4124,    -inf],
          [-0.2155,  0.1207, -2.0973, -4.5050]],

         [[ 1.2107,    -inf,    -inf,    -inf],
          [ 3.7971, -3.7571,    -inf,    -inf],
          [ 0.5945, -6.3302, -1.8179,    -inf],
          [ 4.9623,  1.0938, -0.4381,  0.4037]],

         [[ 0.7226,    -inf,    -inf,    -inf],
          [ 3.9441, -3.7466,    -inf,    -inf],
          [ 1.7862, -3.2529, -1.2821,    -inf],
          [ 3.0510,  0.2116,  1.2065,  4.2569]],

         [[ 2.4181,    -inf,    -inf,    -inf],
          [-2.3456,  1.7882,    -inf,    -inf],
          [-0.1268,  0.0376,  1.6412,    -inf],
          [-0.2620, -5.4266,  0.4891, -1.0248]],

         [[-3.9117,    -inf,    -inf,    -inf],
          [-0.5152,  3.2431,    -inf,    -inf],
          [-2.2094,  1.2742, -3.1071,    -inf],
          [ 0.7963,  1.9109, -2.4355, -4.3366]],

         [[ 0.0333,    -inf,    -inf,    -inf],
          [-0.3006, -7.3890,    -inf,    -inf],
          [ 0.7176, -1.4977,  4.5491,    -inf],
          [-0.2848, -0.0597, -3.5771,  5.5959]],

         [[ 0.7207,    -inf,    -inf,    -inf],
          [ 0.2106,  2.5388,    -inf,    -inf],
          [ 4.6617,  2.7317,  4.1190,    -inf],
          [-0.8316,  1.3791, -2.6662, -6.9124]],

         [[-1.9108,    -inf,    -inf,    -inf],
          [-0.4024, -2.3865,    -inf,    -inf],
          [ 1.0939, -0.0618,  1.5503,    -inf],
          [-0.0145, -5.8288, -1.3458, -2.3351]],

         [[-0.7137,    -inf,    -inf,    -inf],
          [-0.4109, -2.3156,    -inf,    -inf],
          [-0.3850, -3.2577,  4.7740,    -inf],
          [-2.1776, -1.1220, -2.0210, -1.1400]],

         [[ 0.6204,    -inf,    -inf,    -inf],
          [ 0.8968, -0.3716,    -inf,    -inf],
          [ 1.3331, -0.9008, -3.9484,    -inf],
          [ 1.2917, -3.9246, -4.1442, -3.1045]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-5.2320,    -inf,    -inf,    -inf],
          [-5.6535, -0.6315,    -inf,    -inf],
          [-3.4414, -3.9477, -3.2936,    -inf],
          [-4.0928, -4.6457,  3.6072,  2.4798]],

         [[ 2.8211,    -inf,    -inf,    -inf],
          [ 2.2822,  0.7765,    -inf,    -inf],
          [-7.2501,  0.8440, -3.6182,    -inf],
          [ 1.2454,  1.7141, -1.5757, -2.1441]],

         [[-3.5764,    -inf,    -inf,    -inf],
          [-0.1214,  0.0607,    -inf,    -inf],
          [ 6.2005,  2.6470, -2.7223,    -inf],
          [ 0.7827, -1.5717,  2.4438,  1.0577]],

         [[ 0.5857,    -inf,    -inf,    -inf],
          [ 1.0843, -1.8439,    -inf,    -inf],
          [-0.6353, -3.5127,  1.2792,    -inf],
          [ 2.4407,  0.0461, -2.3220, -2.6703]],

         [[-1.5281,    -inf,    -inf,    -inf],
          [ 1.5160, -0.5598,    -inf,    -inf],
          [-1.0522, -2.4238, -1.4772,    -inf],
          [ 3.7873,  5.4384, -0.4097,  4.5119]],

         [[ 1.8135,    -inf,    -inf,    -inf],
          [ 1.0827, -2.0084,    -inf,    -inf],
          [-4.0971,  1.1072,  1.2879,    -inf],
          [-2.2930, -2.3262, -2.7818, -3.4725]],

         [[-6.1603,    -inf,    -inf,    -inf],
          [ 1.7756,  3.3936,    -inf,    -inf],
          [-4.9745,  0.1631,  0.4131,    -inf],
          [ 1.8607,  2.3344, -0.4040, -4.5489]],

         [[ 0.0578,    -inf,    -inf,    -inf],
          [-2.3004,  0.2400,    -inf,    -inf],
          [-1.5407, -4.5385,  0.9226,    -inf],
          [ 4.9260,  0.1876,  1.2546,  1.7049]],

         [[ 5.9731,    -inf,    -inf,    -inf],
          [ 1.2773,  0.2884,    -inf,    -inf],
          [ 4.3528,  1.2524, -2.9774,    -inf],
          [ 4.4597,  2.7715, -1.0927,  0.5723]],

         [[-2.0644,    -inf,    -inf,    -inf],
          [ 0.5439, -2.3367,    -inf,    -inf],
          [ 2.9966,  1.6191,  1.8868,    -inf],
          [-1.5159, -2.2030, -2.6726, -4.7868]],

         [[ 0.0181,    -inf,    -inf,    -inf],
          [-1.6803,  0.9091,    -inf,    -inf],
          [ 2.9995,  2.2101,  0.2375,    -inf],
          [-2.5591,  0.4514, -0.7586, -3.5249]],

         [[ 0.2898,    -inf,    -inf,    -inf],
          [-3.4420,  1.8695,    -inf,    -inf],
          [-0.8693, -2.4781, -0.6226,    -inf],
          [-1.4649, -0.3966, -0.1680, -0.5284]]],


        [[[-5.3741,    -inf,    -inf,    -inf],
          [-0.5462,  3.8340,    -inf,    -inf],
          [-0.2030, -1.8065, -1.3258,    -inf],
          [ 1.2782, -1.3343, -0.9428, -1.1214]],

         [[ 4.4646,    -inf,    -inf,    -inf],
          [-2.7475,  0.3384,    -inf,    -inf],
          [-1.7484,  1.1073,  0.5074,    -inf],
          [ 1.8271,  2.9949, -4.0515,  4.3299]],

         [[-3.0225,    -inf,    -inf,    -inf],
          [-1.4398, -4.9230,    -inf,    -inf],
          [ 5.6751, -1.9042,  0.4124,    -inf],
          [-0.2155,  0.1207, -2.0973, -4.5050]],

         [[ 1.2107,    -inf,    -inf,    -inf],
          [ 3.7971, -3.7571,    -inf,    -inf],
          [ 0.5945, -6.3302, -1.8179,    -inf],
          [ 4.9623,  1.0938, -0.4381,  0.4037]],

         [[ 0.7226,    -inf,    -inf,    -inf],
          [ 3.9441, -3.7466,    -inf,    -inf],
          [ 1.7862, -3.2529, -1.2821,    -inf],
          [ 3.0510,  0.2116,  1.2065,  4.2569]],

         [[ 2.4181,    -inf,    -inf,    -inf],
          [-2.3456,  1.7882,    -inf,    -inf],
          [-0.1268,  0.0376,  1.6412,    -inf],
          [-0.2620, -5.4266,  0.4891, -1.0248]],

         [[-3.9117,    -inf,    -inf,    -inf],
          [-0.5152,  3.2431,    -inf,    -inf],
          [-2.2094,  1.2742, -3.1071,    -inf],
          [ 0.7963,  1.9109, -2.4355, -4.3366]],

         [[ 0.0333,    -inf,    -inf,    -inf],
          [-0.3006, -7.3890,    -inf,    -inf],
          [ 0.7176, -1.4977,  4.5491,    -inf],
          [-0.2848, -0.0597, -3.5771,  5.5959]],

         [[ 0.7207,    -inf,    -inf,    -inf],
          [ 0.2106,  2.5388,    -inf,    -inf],
          [ 4.6617,  2.7317,  4.1190,    -inf],
          [-0.8316,  1.3791, -2.6662, -6.9124]],

         [[-1.9108,    -inf,    -inf,    -inf],
          [-0.4024, -2.3865,    -inf,    -inf],
          [ 1.0939, -0.0618,  1.5503,    -inf],
          [-0.0145, -5.8288, -1.3458, -2.3351]],

         [[-0.7137,    -inf,    -inf,    -inf],
          [-0.4109, -2.3156,    -inf,    -inf],
          [-0.3850, -3.2577,  4.7740,    -inf],
          [-2.1776, -1.1220, -2.0210, -1.1400]],

         [[ 0.6204,    -inf,    -inf,    -inf],
          [ 0.8968, -0.3716,    -inf,    -inf],
          [ 1.3331, -0.9008, -3.9484,    -inf],
          [ 1.2917, -3.9246, -4.1442, -3.1045]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-3.3822e-01, -2.6984e-01,  1.6277e-01,  ...,  5.0711e-01,
            1.6255e-02,  1.0569e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 1.9806e-01, -5.8177e-01,  1.1666e+00,  ..., -7.1009e-01,
            7.8904e-01,  5.5358e-01],
          [ 1.3252e+00,  2.7216e-01,  5.1769e-01,  ..., -9.9938e-01,
            1.3639e+00, -2.4567e-02],
          [-2.6993e-01,  4.8990e-01,  1.6350e-01,  ..., -3.8614e-01,
           -1.0246e+00,  6.0391e-01]],

         [[-9.5642e-02,  6.3921e-01,  5.3665e-02,  ...,  4.4970e-01,
           -2.1748e-01, -1.4465e-01],
          [ 2.0002e-01, -3.0932e-01, -2.1748e-02,  ...,  2.3179e-01,
           -1.6281e-01,  3.3700e-01],
          [ 1.1834e-01, -8.7712e-01,  5.5549e-01,  ..., -1.6536e-01,
           -4.4574e-01,  5.2367e-01],
          ...,
          [-1.7288e-01, -7.5763e-01,  8.0357e-01,  ..., -4.0468e-01,
            4.7174e-01,  2.2636e-01],
          [ 1.7421e-01,  6.0072e-01,  1.5342e-01,  ..., -9.3773e-01,
            8.8817e-01, -5.7240e-03],
          [-4.0394e-03, -2.4634e-01, -2.7641e-01,  ..., -4.0046e-01,
           -2.2915e-01, -4.0040e-01]],

         [[-6.3831e-02,  6.4207e-01,  4.1847e-02,  ...,  1.8043e-01,
           -1.3827e-01, -4.5338e-01],
          [ 1.2551e-01, -4.4075e-01,  2.1432e-02,  ..., -4.2425e-02,
           -1.6891e-01,  3.4785e-01],
          [-1.7717e-01, -4.1366e-01,  9.6117e-01,  ...,  1.2447e-01,
           -1.5834e-01,  5.6028e-02],
          ...,
          [-3.0826e-01, -9.1469e-01,  3.6014e-01,  ..., -3.4713e-01,
            2.2959e-01, -5.6794e-02],
          [ 5.9839e-01,  4.2448e-01,  1.6553e-01,  ..., -6.4217e-01,
            4.8779e-01, -9.4801e-03],
          [-4.0477e-01,  4.8266e-01, -5.6544e-01,  ...,  4.7810e-02,
           -7.8240e-02, -4.5534e-04]],

         [[-4.5599e-01,  3.6324e-01, -2.0918e-01,  ..., -3.9630e-01,
            4.0383e-03, -1.0322e-01],
          [-1.0310e-01, -2.5547e-01,  1.1923e-01,  ...,  2.0896e-01,
           -2.7839e-01,  2.3537e-01],
          [-2.8849e-01, -2.7012e-01,  5.2924e-01,  ..., -3.8790e-02,
           -1.5560e-01,  5.7355e-02],
          ...,
          [-2.5421e-01, -6.5552e-01,  2.9030e-01,  ..., -4.4549e-01,
            2.1554e-01, -3.5628e-01],
          [ 3.3663e-01,  2.4171e-01,  1.5475e-01,  ..., -5.7014e-01,
            1.4738e-01,  9.8307e-02],
          [-5.7454e-01,  4.1042e-01, -2.3882e-01,  ..., -2.2332e-01,
            6.2169e-02,  2.1855e-02]]],


        [[[ 1.7350e-01,  9.0626e-01,  5.2989e-01,  ...,  9.1241e-01,
           -2.9174e-01, -3.0436e-01],
          [-7.6322e-01,  6.5019e-02,  2.0171e-01,  ...,  1.1931e-01,
            2.7203e-01, -7.4656e-02],
          [-2.3392e-01,  5.6494e-01,  5.7725e-01,  ...,  3.6353e-01,
            2.7556e-01, -3.0681e-01],
          ...,
          [ 1.6973e-01, -5.5557e-01,  1.1043e+00,  ..., -2.4983e-01,
           -4.1582e-02,  5.0862e-01],
          [ 9.1236e-01,  5.0934e-01,  4.0420e-01,  ..., -3.9780e-01,
            1.4925e+00, -4.0991e-01],
          [-6.8555e-01,  3.6178e-01,  2.5432e-01,  ..., -6.1632e-01,
           -5.8805e-03,  9.1226e-01]],

         [[ 1.3223e-01,  3.2825e-01, -3.4995e-02,  ...,  1.3361e-01,
           -2.8773e-01, -3.5728e-01],
          [ 8.5774e-01, -3.8532e-01,  1.7658e-01,  ..., -3.3838e-01,
            5.6436e-01,  3.1268e-01],
          [-1.4203e-01,  3.4301e-01,  3.5048e-01,  ...,  2.2072e-01,
            1.6731e-01, -1.8628e-01],
          ...,
          [ 4.2755e-01, -4.5139e-01,  6.9568e-01,  ..., -3.4129e-02,
            1.1375e-01, -4.0407e-03],
          [ 5.1023e-01,  2.8485e-01,  2.2605e-01,  ..., -2.2247e-01,
            8.3464e-01, -2.2924e-01],
          [-1.6682e-01, -1.9155e-01, -4.7081e-01,  ..., -4.1911e-01,
           -1.9104e-01,  2.0983e-01]],

         [[ 1.9518e-01,  4.4197e-02,  9.1157e-02,  ...,  4.4922e-02,
           -2.2242e-02, -1.6182e-01],
          [ 4.9407e-01, -2.3397e-01,  1.3013e-01,  ..., -3.5666e-01,
            3.7412e-01,  3.1802e-01],
          [-1.1603e-01,  3.3677e-01,  6.8654e-01,  ...,  4.7684e-01,
            2.4960e-01, -2.4376e-01],
          ...,
          [ 2.8053e-01, -5.0384e-01,  2.4885e-01,  ...,  4.0170e-01,
            4.2345e-01, -4.3070e-01],
          [-9.9246e-02,  8.4546e-01,  2.5001e-01,  ..., -5.4999e-03,
            4.7302e-01, -3.9670e-01],
          [-2.2453e-01,  1.1127e-01, -1.7903e-01,  ..., -3.4444e-01,
           -2.9862e-02,  3.3846e-01]],

         [[-1.3315e-01,  2.5606e-01, -1.9527e-01,  ..., -2.2877e-01,
            3.0534e-01, -2.3976e-01],
          [ 3.5933e-01, -1.7958e-01,  1.0180e-01,  ..., -2.0583e-01,
            2.9229e-01,  1.8809e-01],
          [ 8.0150e-02,  2.9986e-02,  5.9177e-01,  ...,  3.5696e-01,
            1.9669e-01, -3.2591e-01],
          ...,
          [ 4.1415e-01, -3.5090e-01,  4.1885e-02,  ...,  4.0544e-02,
           -5.0577e-03, -3.1266e-01],
          [ 2.4327e-02,  7.3674e-01,  3.4856e-01,  ..., -3.8658e-01,
            4.3375e-01, -3.3333e-01],
          [-3.4050e-01,  2.8529e-01,  4.3926e-01,  ..., -6.0493e-01,
           -6.1957e-02,  5.4599e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ..., -3.8614e-01,
          -1.0246e+00,  6.0391e-01],
         [-9.5642e-02,  6.3921e-01,  5.3665e-02,  ..., -4.0046e-01,
          -2.2915e-01, -4.0040e-01],
         [-6.3831e-02,  6.4207e-01,  4.1847e-02,  ...,  4.7810e-02,
          -7.8240e-02, -4.5534e-04],
         [-4.5599e-01,  3.6324e-01, -2.0918e-01,  ..., -2.2332e-01,
           6.2169e-02,  2.1855e-02]],

        [[ 1.7350e-01,  9.0626e-01,  5.2989e-01,  ..., -6.1632e-01,
          -5.8805e-03,  9.1226e-01],
         [ 1.3223e-01,  3.2825e-01, -3.4995e-02,  ..., -4.1911e-01,
          -1.9104e-01,  2.0983e-01],
         [ 1.9518e-01,  4.4197e-02,  9.1157e-02,  ..., -3.4444e-01,
          -2.9862e-02,  3.3846e-01],
         [-1.3315e-01,  2.5606e-01, -1.9527e-01,  ..., -6.0493e-01,
          -6.1957e-02,  5.4599e-01]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1980,  0.0656, -0.0655,  ...,  0.1086,  0.4634,  0.1975],
         [ 0.3451, -0.1966,  0.0110,  ..., -0.1188,  0.4194, -0.3274],
         [ 0.3098, -0.0643,  0.0654,  ..., -0.0968,  0.4449,  0.0745],
         [ 0.3133, -0.0457,  0.0076,  ..., -0.0806,  0.3933,  0.3036]],

        [[-0.1115,  0.2629,  0.2769,  ..., -0.0205,  0.6303,  0.1695],
         [ 0.0606,  0.1493,  0.2890,  ..., -0.1161,  0.3774,  0.1185],
         [ 0.1758,  0.1752,  0.3738,  ...,  0.0827,  0.3708,  0.0457],
         [ 0.2554,  0.1449,  0.1160,  ...,  0.1415,  0.3545,  0.1354]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.3185e+00,        -inf,        -inf,        -inf],
          [ 2.4432e-01, -3.1691e+00,        -inf,        -inf],
          [-3.0530e+00,  5.9106e-01, -9.1850e-01,        -inf],
          [-1.4906e+00,  2.4588e+00,  1.8705e+00, -2.6409e+00]],

         [[ 4.5860e-02,        -inf,        -inf,        -inf],
          [-1.0386e+00,  5.4113e-01,        -inf,        -inf],
          [ 7.9218e-01,  1.1325e+00, -7.8897e-01,        -inf],
          [-3.3846e+00, -2.3230e+00, -3.3401e+00, -3.7069e+00]],

         [[ 3.2457e+00,        -inf,        -inf,        -inf],
          [ 2.2902e+00, -1.4407e-02,        -inf,        -inf],
          [-6.7007e-01,  4.5808e-01,  2.8755e-01,        -inf],
          [-1.4865e+00,  3.2304e-01, -4.1739e+00, -1.3659e+00]],

         [[-2.0757e-01,        -inf,        -inf,        -inf],
          [-2.1770e-02,  2.1241e+00,        -inf,        -inf],
          [-3.0905e+00,  9.9219e-03,  3.9999e+00,        -inf],
          [-5.2545e+00,  5.1184e+00,  1.2897e+00, -2.8451e+00]],

         [[-3.8813e+00,        -inf,        -inf,        -inf],
          [ 3.3952e+00,  1.9670e+00,        -inf,        -inf],
          [-2.5930e+00,  1.3333e+00, -3.2001e+00,        -inf],
          [ 5.6882e-01, -1.0683e+00,  4.5629e+00, -9.1460e-01]],

         [[ 5.7283e+00,        -inf,        -inf,        -inf],
          [-4.6069e+00, -1.6995e+00,        -inf,        -inf],
          [-4.7217e+00, -9.6466e-01,  1.0408e+00,        -inf],
          [-2.2985e+00, -1.4809e+00,  2.3093e+00,  2.0860e+00]],

         [[-2.8593e+00,        -inf,        -inf,        -inf],
          [ 1.1576e+00, -5.6579e+00,        -inf,        -inf],
          [-1.4360e+00, -3.2414e+00, -1.2143e+00,        -inf],
          [-2.1327e+00, -5.3377e-01, -5.6293e-02,  6.3787e-01]],

         [[ 2.3859e+00,        -inf,        -inf,        -inf],
          [-2.6725e+00,  3.4564e+00,        -inf,        -inf],
          [ 1.0067e+00,  8.9637e-01,  9.5105e-01,        -inf],
          [-3.8306e+00,  2.3516e+00,  3.2551e+00, -1.5261e-02]],

         [[-3.3279e+00,        -inf,        -inf,        -inf],
          [ 5.0397e-02,  4.2865e-02,        -inf,        -inf],
          [ 3.7634e+00,  3.8402e+00,  1.9134e+00,        -inf],
          [-1.2488e+00, -8.1980e-01,  3.5500e+00,  3.1408e+00]],

         [[-3.4080e+00,        -inf,        -inf,        -inf],
          [ 2.1796e+00,  1.2171e+00,        -inf,        -inf],
          [ 5.0241e+00,  1.9085e+00, -3.8967e-01,        -inf],
          [ 3.6332e+00, -5.3810e+00,  7.0072e+00,  2.1648e+00]],

         [[ 3.3433e+00,        -inf,        -inf,        -inf],
          [ 2.1336e+00,  2.4143e-01,        -inf,        -inf],
          [ 1.9198e+00,  6.2685e+00, -2.9077e+00,        -inf],
          [ 1.0400e+01, -9.9644e-01, -3.8089e+00,  3.8085e-01]],

         [[ 8.3801e-01,        -inf,        -inf,        -inf],
          [ 6.6527e-01, -1.0916e+00,        -inf,        -inf],
          [ 3.9936e+00, -4.4102e+00,  6.3050e-01,        -inf],
          [-1.9792e+00,  1.2819e+00, -1.3889e-01, -7.1685e+00]]],


        [[[-8.4728e-01,        -inf,        -inf,        -inf],
          [ 1.0180e+00,  2.5196e+00,        -inf,        -inf],
          [-1.0811e+00,  1.7363e+00,  4.1944e+00,        -inf],
          [-1.8097e-01,  4.1772e-02, -1.4605e+00, -3.3377e+00]],

         [[-2.3985e+00,        -inf,        -inf,        -inf],
          [ 2.1174e+00, -2.2520e+00,        -inf,        -inf],
          [-4.0964e+00,  2.3375e+00,  2.5300e+00,        -inf],
          [-1.2553e+00,  1.6193e-01,  1.0570e+00, -1.2797e+00]],

         [[ 4.9867e+00,        -inf,        -inf,        -inf],
          [-2.4141e+00, -9.9169e-01,        -inf,        -inf],
          [ 4.4854e-01,  8.1319e-01,  1.5422e+00,        -inf],
          [-8.2734e-01, -2.0522e+00,  1.0509e+00,  1.6763e-01]],

         [[-1.4615e+00,        -inf,        -inf,        -inf],
          [-3.6095e+00, -3.2113e+00,        -inf,        -inf],
          [ 2.7919e+00, -3.4376e-01,  1.6376e+00,        -inf],
          [ 3.6735e-01, -1.2161e+00,  7.7594e-01,  5.9172e+00]],

         [[-6.3114e-01,        -inf,        -inf,        -inf],
          [ 3.7154e-01, -4.6520e+00,        -inf,        -inf],
          [-1.2366e-01, -3.4518e+00,  4.9479e+00,        -inf],
          [-2.6166e+00,  2.1623e+00, -1.3009e+00,  4.9591e-01]],

         [[ 4.3077e+00,        -inf,        -inf,        -inf],
          [-2.3289e+00, -2.7043e+00,        -inf,        -inf],
          [-3.9527e+00,  2.2502e+00,  1.7522e+00,        -inf],
          [-2.9277e+00, -1.1764e+00,  3.6778e+00, -2.0075e+00]],

         [[-3.4378e+00,        -inf,        -inf,        -inf],
          [ 1.2450e+00, -1.3494e+00,        -inf,        -inf],
          [-2.5502e+00, -1.0573e+00, -1.7790e+00,        -inf],
          [-3.2972e+00, -3.4252e+00, -1.4879e+00, -2.0312e+00]],

         [[ 5.3036e+00,        -inf,        -inf,        -inf],
          [-1.7546e+00, -1.4588e-01,        -inf,        -inf],
          [ 3.3850e+00,  1.7054e+00, -3.0658e+00,        -inf],
          [-1.1076e+00, -1.8422e+00,  2.0138e+00, -2.4884e-01]],

         [[-3.3446e+00,        -inf,        -inf,        -inf],
          [-1.9397e+00,  2.2485e+00,        -inf,        -inf],
          [ 2.0141e+00,  1.6043e+00, -7.7594e+00,        -inf],
          [-1.0835e+00,  3.5458e-01,  2.1953e+00,  6.6676e-01]],

         [[-2.9489e+00,        -inf,        -inf,        -inf],
          [ 4.4281e-01,  3.8989e+00,        -inf,        -inf],
          [ 1.9232e+00, -1.7114e+00, -3.5320e+00,        -inf],
          [-2.6931e+00,  3.7696e+00, -8.6422e-01, -2.3963e+00]],

         [[ 2.9221e+00,        -inf,        -inf,        -inf],
          [ 1.8156e+00, -5.1228e+00,        -inf,        -inf],
          [ 5.7530e+00,  3.7271e+00,  4.3792e+00,        -inf],
          [ 4.8260e+00,  3.5094e+00,  3.4326e-01,  1.4732e+00]],

         [[-3.4051e+00,        -inf,        -inf,        -inf],
          [-6.7294e-01, -1.9870e+00,        -inf,        -inf],
          [ 6.7429e+00, -8.7847e-01,  3.8312e+00,        -inf],
          [-4.7804e+00,  1.7885e+00, -1.5800e+00, -4.4179e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.3185e+00,        -inf,        -inf,        -inf],
          [ 2.4432e-01, -3.1691e+00,        -inf,        -inf],
          [-3.0530e+00,  5.9106e-01, -9.1850e-01,        -inf],
          [-1.4906e+00,  2.4588e+00,  1.8705e+00, -2.6409e+00]],

         [[ 4.5860e-02,        -inf,        -inf,        -inf],
          [-1.0386e+00,  5.4113e-01,        -inf,        -inf],
          [ 7.9218e-01,  1.1325e+00, -7.8897e-01,        -inf],
          [-3.3846e+00, -2.3230e+00, -3.3401e+00, -3.7069e+00]],

         [[ 3.2457e+00,        -inf,        -inf,        -inf],
          [ 2.2902e+00, -1.4407e-02,        -inf,        -inf],
          [-6.7007e-01,  4.5808e-01,  2.8755e-01,        -inf],
          [-1.4865e+00,  3.2304e-01, -4.1739e+00, -1.3659e+00]],

         [[-2.0757e-01,        -inf,        -inf,        -inf],
          [-2.1770e-02,  2.1241e+00,        -inf,        -inf],
          [-3.0905e+00,  9.9219e-03,  3.9999e+00,        -inf],
          [-5.2545e+00,  5.1184e+00,  1.2897e+00, -2.8451e+00]],

         [[-3.8813e+00,        -inf,        -inf,        -inf],
          [ 3.3952e+00,  1.9670e+00,        -inf,        -inf],
          [-2.5930e+00,  1.3333e+00, -3.2001e+00,        -inf],
          [ 5.6882e-01, -1.0683e+00,  4.5629e+00, -9.1460e-01]],

         [[ 5.7283e+00,        -inf,        -inf,        -inf],
          [-4.6069e+00, -1.6995e+00,        -inf,        -inf],
          [-4.7217e+00, -9.6466e-01,  1.0408e+00,        -inf],
          [-2.2985e+00, -1.4809e+00,  2.3093e+00,  2.0860e+00]],

         [[-2.8593e+00,        -inf,        -inf,        -inf],
          [ 1.1576e+00, -5.6579e+00,        -inf,        -inf],
          [-1.4360e+00, -3.2414e+00, -1.2143e+00,        -inf],
          [-2.1327e+00, -5.3377e-01, -5.6293e-02,  6.3787e-01]],

         [[ 2.3859e+00,        -inf,        -inf,        -inf],
          [-2.6725e+00,  3.4564e+00,        -inf,        -inf],
          [ 1.0067e+00,  8.9637e-01,  9.5105e-01,        -inf],
          [-3.8306e+00,  2.3516e+00,  3.2551e+00, -1.5261e-02]],

         [[-3.3279e+00,        -inf,        -inf,        -inf],
          [ 5.0397e-02,  4.2865e-02,        -inf,        -inf],
          [ 3.7634e+00,  3.8402e+00,  1.9134e+00,        -inf],
          [-1.2488e+00, -8.1980e-01,  3.5500e+00,  3.1408e+00]],

         [[-3.4080e+00,        -inf,        -inf,        -inf],
          [ 2.1796e+00,  1.2171e+00,        -inf,        -inf],
          [ 5.0241e+00,  1.9085e+00, -3.8967e-01,        -inf],
          [ 3.6332e+00, -5.3810e+00,  7.0072e+00,  2.1648e+00]],

         [[ 3.3433e+00,        -inf,        -inf,        -inf],
          [ 2.1336e+00,  2.4143e-01,        -inf,        -inf],
          [ 1.9198e+00,  6.2685e+00, -2.9077e+00,        -inf],
          [ 1.0400e+01, -9.9644e-01, -3.8089e+00,  3.8085e-01]],

         [[ 8.3801e-01,        -inf,        -inf,        -inf],
          [ 6.6527e-01, -1.0916e+00,        -inf,        -inf],
          [ 3.9936e+00, -4.4102e+00,  6.3050e-01,        -inf],
          [-1.9792e+00,  1.2819e+00, -1.3889e-01, -7.1685e+00]]],


        [[[-8.4728e-01,        -inf,        -inf,        -inf],
          [ 1.0180e+00,  2.5196e+00,        -inf,        -inf],
          [-1.0811e+00,  1.7363e+00,  4.1944e+00,        -inf],
          [-1.8097e-01,  4.1772e-02, -1.4605e+00, -3.3377e+00]],

         [[-2.3985e+00,        -inf,        -inf,        -inf],
          [ 2.1174e+00, -2.2520e+00,        -inf,        -inf],
          [-4.0964e+00,  2.3375e+00,  2.5300e+00,        -inf],
          [-1.2553e+00,  1.6193e-01,  1.0570e+00, -1.2797e+00]],

         [[ 4.9867e+00,        -inf,        -inf,        -inf],
          [-2.4141e+00, -9.9169e-01,        -inf,        -inf],
          [ 4.4854e-01,  8.1319e-01,  1.5422e+00,        -inf],
          [-8.2734e-01, -2.0522e+00,  1.0509e+00,  1.6763e-01]],

         [[-1.4615e+00,        -inf,        -inf,        -inf],
          [-3.6095e+00, -3.2113e+00,        -inf,        -inf],
          [ 2.7919e+00, -3.4376e-01,  1.6376e+00,        -inf],
          [ 3.6735e-01, -1.2161e+00,  7.7594e-01,  5.9172e+00]],

         [[-6.3114e-01,        -inf,        -inf,        -inf],
          [ 3.7154e-01, -4.6520e+00,        -inf,        -inf],
          [-1.2366e-01, -3.4518e+00,  4.9479e+00,        -inf],
          [-2.6166e+00,  2.1623e+00, -1.3009e+00,  4.9591e-01]],

         [[ 4.3077e+00,        -inf,        -inf,        -inf],
          [-2.3289e+00, -2.7043e+00,        -inf,        -inf],
          [-3.9527e+00,  2.2502e+00,  1.7522e+00,        -inf],
          [-2.9277e+00, -1.1764e+00,  3.6778e+00, -2.0075e+00]],

         [[-3.4378e+00,        -inf,        -inf,        -inf],
          [ 1.2450e+00, -1.3494e+00,        -inf,        -inf],
          [-2.5502e+00, -1.0573e+00, -1.7790e+00,        -inf],
          [-3.2972e+00, -3.4252e+00, -1.4879e+00, -2.0312e+00]],

         [[ 5.3036e+00,        -inf,        -inf,        -inf],
          [-1.7546e+00, -1.4588e-01,        -inf,        -inf],
          [ 3.3850e+00,  1.7054e+00, -3.0658e+00,        -inf],
          [-1.1076e+00, -1.8422e+00,  2.0138e+00, -2.4884e-01]],

         [[-3.3446e+00,        -inf,        -inf,        -inf],
          [-1.9397e+00,  2.2485e+00,        -inf,        -inf],
          [ 2.0141e+00,  1.6043e+00, -7.7594e+00,        -inf],
          [-1.0835e+00,  3.5458e-01,  2.1953e+00,  6.6676e-01]],

         [[-2.9489e+00,        -inf,        -inf,        -inf],
          [ 4.4281e-01,  3.8989e+00,        -inf,        -inf],
          [ 1.9232e+00, -1.7114e+00, -3.5320e+00,        -inf],
          [-2.6931e+00,  3.7696e+00, -8.6422e-01, -2.3963e+00]],

         [[ 2.9221e+00,        -inf,        -inf,        -inf],
          [ 1.8156e+00, -5.1228e+00,        -inf,        -inf],
          [ 5.7530e+00,  3.7271e+00,  4.3792e+00,        -inf],
          [ 4.8260e+00,  3.5094e+00,  3.4326e-01,  1.4732e+00]],

         [[-3.4051e+00,        -inf,        -inf,        -inf],
          [-6.7294e-01, -1.9870e+00,        -inf,        -inf],
          [ 6.7429e+00, -8.7847e-01,  3.8312e+00,        -inf],
          [-4.7804e+00,  1.7885e+00, -1.5800e+00, -4.4179e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.0198e+00, -1.2404e-01,  1.3324e-01,  ...,  1.9806e-01,
           -5.2130e-01,  2.7838e-01],
          [-9.0852e-03, -8.5923e-01, -2.6147e-01,  ...,  7.7560e-01,
           -4.2132e-02,  1.5051e+00],
          [ 2.8681e-01, -8.7478e-02, -2.7396e-01,  ...,  7.0304e-01,
            1.3885e-01,  9.6354e-01],
          ...,
          [ 1.5690e-01, -4.3335e-01,  5.4963e-01,  ...,  6.0006e-01,
           -1.6114e+00,  1.0582e+00],
          [ 3.0566e-01,  1.5977e+00, -1.3637e-01,  ...,  1.9923e-01,
            7.7387e-01, -5.0404e-01],
          [ 1.1505e-01, -3.5252e-01, -3.7982e-01,  ..., -5.8818e-01,
           -9.9697e-01, -9.3406e-01]],

         [[-6.1705e-01, -7.5056e-02,  8.0622e-02,  ...,  1.1984e-01,
           -3.1543e-01,  1.6844e-01],
          [-1.6617e-01, -7.1394e-01, -1.0831e-01,  ...,  6.9975e-02,
           -4.4274e-01,  1.1183e+00],
          [ 2.6379e-01, -2.9621e-01,  3.3231e-02,  ...,  5.8212e-01,
            2.2735e-01,  5.0914e-01],
          ...,
          [-3.5523e-01, -2.1794e-01, -1.3337e-01,  ...,  1.8913e-01,
           -1.5560e+00,  2.3700e-01],
          [ 9.1281e-02,  8.6528e-01,  5.6935e-01,  ..., -3.0056e-02,
            9.3329e-01, -2.0162e-01],
          [-6.0019e-01, -6.8657e-01, -4.3248e-02,  ..., -1.0117e+00,
           -8.0054e-01, -3.0261e-01]],

         [[-2.7561e-01,  2.0034e-02, -9.1532e-02,  ...,  1.3043e-01,
           -4.4555e-01,  3.2767e-01],
          [-4.3881e-01, -2.1518e-01,  7.0078e-02,  ...,  2.3028e-01,
           -3.0345e-01,  1.0374e+00],
          [ 1.6934e-01, -2.2849e-01,  7.2014e-02,  ...,  3.6223e-01,
            1.6366e-01,  2.5984e-01],
          ...,
          [-8.4827e-02, -3.9650e-01,  1.0434e-01,  ...,  2.3289e-01,
           -8.1058e-01,  4.1692e-01],
          [-5.1061e-02,  5.9149e-01,  9.2428e-01,  ..., -1.2349e-01,
            7.9823e-01, -1.5329e-01],
          [-2.6357e-01, -7.0270e-01,  2.0376e-01,  ..., -8.9437e-01,
           -4.9477e-01, -3.6106e-01]],

         [[-1.1707e-01,  7.4189e-02,  6.5986e-02,  ...,  1.1202e-01,
           -4.2891e-01,  2.5511e-01],
          [-6.1287e-01, -1.2304e-01,  2.4221e-01,  ...,  4.3656e-01,
           -2.7591e-01,  9.1569e-01],
          [ 1.6671e-01, -4.0203e-01,  1.2665e-01,  ...,  6.5491e-01,
            1.1841e-01,  3.0309e-01],
          ...,
          [-2.1954e-01, -5.0865e-01, -1.8168e-01,  ...,  9.3597e-02,
           -7.4282e-01,  2.1763e-01],
          [ 1.2510e-01,  1.1410e+00,  4.2383e-01,  ...,  1.3823e-01,
            6.4188e-01, -4.1050e-01],
          [-4.4893e-01, -8.6091e-01,  4.3356e-01,  ..., -1.0174e+00,
           -3.1608e-01, -9.3148e-02]]],


        [[[-1.3943e+00, -1.7086e-01,  2.5551e-01,  ...,  3.7037e-01,
           -3.5068e-01,  4.2071e-04],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.1585e-01,  1.4519e-01, -3.9397e-02,  ...,  2.9930e-01,
            2.9114e-01,  6.0940e-01],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-6.0878e-02,  1.1848e+00,  3.8103e-01,  ...,  6.2654e-01,
            5.7201e-01, -2.8417e-01],
          [ 8.3535e-01, -6.9265e-01, -3.5837e-01,  ..., -3.8981e-01,
           -1.1136e+00, -1.3939e+00]],

         [[-8.1721e-01, -3.2737e-01,  4.5029e-01,  ...,  5.7654e-01,
           -4.8128e-01,  4.2482e-02],
          [ 4.9153e-02, -1.0442e+00, -8.7431e-02,  ..., -2.2252e-01,
            4.2639e-02,  8.5982e-01],
          [ 1.0952e-02, -1.0805e-01,  4.9395e-01,  ...,  1.1885e-01,
            4.9084e-01, -2.7629e-03],
          ...,
          [ 3.9078e-02,  7.7625e-01,  2.8127e-01,  ...,  1.4086e-01,
           -6.4186e-01,  3.0564e-02],
          [ 1.5996e-01,  7.6270e-01,  4.6276e-01,  ...,  3.5979e-01,
            2.8806e-01, -2.1738e-01],
          [-8.7866e-02,  4.8303e-02, -1.0911e-01,  ..., -4.0531e-01,
           -5.0349e-01, -4.8994e-01]],

         [[-5.9633e-01, -1.0531e-01, -3.4631e-02,  ..., -4.3785e-02,
           -6.9567e-01,  2.3314e-01],
          [-5.1117e-01, -8.2278e-01,  3.7473e-01,  ..., -3.0363e-01,
            3.8611e-01,  2.0099e-01],
          [ 7.4985e-02, -4.1466e-01,  4.3653e-01,  ...,  2.9234e-01,
            3.0122e-01, -3.2136e-01],
          ...,
          [ 7.9041e-02,  3.9924e-01,  4.2254e-01,  ...,  2.0123e-01,
           -6.3944e-01,  4.0068e-01],
          [ 2.4337e-01,  4.9789e-01,  5.1257e-01,  ...,  1.6477e-01,
           -7.5468e-02, -1.3541e-01],
          [ 8.1378e-02, -6.7422e-04, -1.5094e-01,  ..., -5.5382e-01,
           -4.2777e-01, -7.6381e-01]],

         [[-7.7674e-01, -2.3156e-01,  2.2568e-01,  ...,  2.1939e-01,
           -6.7206e-01,  1.9897e-01],
          [-3.3266e-01, -6.9989e-01,  2.1925e-01,  ..., -5.7371e-02,
            3.4786e-01,  6.1684e-01],
          [ 1.7398e-01, -6.0715e-01,  1.2963e-01,  ...,  3.9157e-01,
            3.6180e-01, -6.8507e-02],
          ...,
          [-8.9306e-02,  4.8028e-01,  1.6946e-01,  ...,  1.3379e-02,
           -3.4207e-01, -2.1689e-03],
          [ 2.0777e-01,  5.1250e-01,  4.3252e-01,  ..., -5.9936e-02,
            1.6811e-01, -2.2365e-01],
          [-3.6966e-01,  2.9354e-01,  3.7561e-02,  ..., -5.2996e-01,
           -1.0639e-01, -3.1578e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.0198, -0.1240,  0.1332,  ..., -0.5882, -0.9970, -0.9341],
         [-0.6170, -0.0751,  0.0806,  ..., -1.0117, -0.8005, -0.3026],
         [-0.2756,  0.0200, -0.0915,  ..., -0.8944, -0.4948, -0.3611],
         [-0.1171,  0.0742,  0.0660,  ..., -1.0174, -0.3161, -0.0931]],

        [[-1.3943, -0.1709,  0.2555,  ..., -0.3898, -1.1136, -1.3939],
         [-0.8172, -0.3274,  0.4503,  ..., -0.4053, -0.5035, -0.4899],
         [-0.5963, -0.1053, -0.0346,  ..., -0.5538, -0.4278, -0.7638],
         [-0.7767, -0.2316,  0.2257,  ..., -0.5300, -0.1064, -0.3158]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.5725,  0.2511,  0.3244,  ...,  0.2840, -0.1664,  0.1701],
         [-0.3274,  0.0472,  0.0111,  ...,  0.1313, -0.0324,  0.0114],
         [-0.0223,  0.1491,  0.1508,  ..., -0.1224, -0.3236,  0.0447],
         [ 0.0051,  0.1362,  0.2076,  ..., -0.1683, -0.2077,  0.0012]],

        [[-0.3369,  0.3088,  0.4325,  ...,  0.3098, -0.0500,  0.0076],
         [-0.4592,  0.3861,  0.2895,  ...,  0.3648,  0.0818, -0.2019],
         [-0.3321,  0.1554,  0.0847,  ...,  0.4107,  0.0521, -0.0717],
         [-0.1507,  0.3030,  0.1609,  ...,  0.2602, -0.0133, -0.0964]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 4.0830e+00,        -inf,        -inf,        -inf],
          [ 1.3531e+00,  3.1757e+00,        -inf,        -inf],
          [-2.1269e+00,  8.2719e-01, -3.1386e+00,        -inf],
          [ 2.2818e+00, -1.2365e-01, -1.7116e+00, -2.2287e+00]],

         [[ 1.3053e+00,        -inf,        -inf,        -inf],
          [ 2.5099e+00, -4.4558e+00,        -inf,        -inf],
          [-1.1854e+00,  5.2375e-01, -1.7626e+00,        -inf],
          [ 1.0636e+00, -4.2043e-01,  4.1804e+00, -4.7391e+00]],

         [[-2.8067e+00,        -inf,        -inf,        -inf],
          [ 1.7698e-01, -6.3733e-04,        -inf,        -inf],
          [ 8.4176e-01,  8.5148e-01, -1.3486e+00,        -inf],
          [ 6.4716e+00, -1.0026e+00,  1.6756e-02, -8.0200e-01]],

         [[ 8.9080e-01,        -inf,        -inf,        -inf],
          [-2.0932e+00, -1.6666e+00,        -inf,        -inf],
          [ 7.1806e-01,  2.4204e+00, -9.5359e-01,        -inf],
          [-5.9216e+00,  1.5718e+00, -4.8345e+00, -2.5211e+00]],

         [[ 3.1748e+00,        -inf,        -inf,        -inf],
          [ 2.7819e+00, -1.2148e+00,        -inf,        -inf],
          [-1.8973e+00,  3.3122e+00, -4.7762e+00,        -inf],
          [-2.6131e+00,  1.6839e+00, -1.4193e+00, -1.4079e+00]],

         [[-1.3752e+00,        -inf,        -inf,        -inf],
          [ 7.9014e-01, -2.8859e+00,        -inf,        -inf],
          [ 2.1641e+00,  3.4512e+00,  1.3711e+00,        -inf],
          [ 4.1022e+00, -9.7649e-01, -1.5396e+00,  1.4214e-01]],

         [[-1.4684e+00,        -inf,        -inf,        -inf],
          [ 4.1143e-01,  1.2933e+00,        -inf,        -inf],
          [-9.6159e-02,  4.4370e+00,  1.1498e+00,        -inf],
          [-4.5130e+00, -3.0714e+00,  3.5468e-01,  1.0036e+00]],

         [[ 3.0060e+00,        -inf,        -inf,        -inf],
          [ 4.3255e+00,  1.3678e+00,        -inf,        -inf],
          [ 9.1152e-03, -3.1019e+00,  1.0130e+00,        -inf],
          [ 3.6372e+00,  8.9991e-01,  1.5147e+00, -2.8325e+00]],

         [[ 4.1002e-01,        -inf,        -inf,        -inf],
          [ 1.2120e+00,  8.4458e-01,        -inf,        -inf],
          [-2.7603e+00, -5.5899e+00, -3.0698e+00,        -inf],
          [ 1.0044e+00,  6.5398e-01,  1.9722e-01, -3.1923e+00]],

         [[-2.2638e+00,        -inf,        -inf,        -inf],
          [ 7.4728e-01, -1.2278e-01,        -inf,        -inf],
          [-1.0772e+00,  4.2819e+00,  3.2126e+00,        -inf],
          [ 2.5267e+00,  2.2734e+00,  6.3893e-01, -3.9138e-01]],

         [[-1.2259e+00,        -inf,        -inf,        -inf],
          [-7.3969e-01, -2.5141e-01,        -inf,        -inf],
          [ 6.2732e-01, -2.1144e+00,  8.6704e-01,        -inf],
          [-2.2779e+00,  4.6504e-01, -3.6154e-01,  4.2029e+00]],

         [[ 3.7388e+00,        -inf,        -inf,        -inf],
          [ 1.0586e-01,  4.6344e+00,        -inf,        -inf],
          [ 4.6162e+00, -1.8239e+00,  2.4002e+00,        -inf],
          [-2.1785e+00,  6.8435e-01, -2.3439e+00,  3.5623e+00]]],


        [[[-3.3057e-01,        -inf,        -inf,        -inf],
          [-2.2960e-01, -2.2780e+00,        -inf,        -inf],
          [ 5.8895e-01,  4.4680e+00,  4.2390e+00,        -inf],
          [ 2.0347e+00,  7.6459e-01, -3.2471e-01, -3.8995e+00]],

         [[ 1.0912e+00,        -inf,        -inf,        -inf],
          [ 5.2409e-01,  9.0330e-01,        -inf,        -inf],
          [-6.2526e-01,  8.6539e-02, -2.0971e+00,        -inf],
          [-2.0184e+00, -8.9192e-01,  2.9850e+00, -4.7016e-01]],

         [[-2.7806e+00,        -inf,        -inf,        -inf],
          [ 1.5366e+00, -9.7828e-01,        -inf,        -inf],
          [ 1.8208e+00,  3.3333e-01, -2.6268e+00,        -inf],
          [ 4.0107e+00,  8.4969e-02, -2.9664e+00,  6.7587e-01]],

         [[ 2.0494e+00,        -inf,        -inf,        -inf],
          [ 8.4274e-01, -3.1433e+00,        -inf,        -inf],
          [ 1.0891e+00,  2.0785e+00, -2.0100e+00,        -inf],
          [-3.9263e+00,  2.8330e-01, -2.4407e+00, -8.7427e-01]],

         [[ 1.9079e+00,        -inf,        -inf,        -inf],
          [ 1.7642e+00, -9.6383e-01,        -inf,        -inf],
          [-5.8918e+00,  5.8637e+00,  7.8140e-01,        -inf],
          [-4.0859e+00,  1.6085e+00,  1.1003e+00, -3.8762e+00]],

         [[-1.8026e+00,        -inf,        -inf,        -inf],
          [ 3.3704e+00, -5.0434e+00,        -inf,        -inf],
          [-6.2471e-01, -7.7486e-01,  2.5652e-01,        -inf],
          [ 3.3861e+00, -1.8212e+00,  6.1661e-01,  3.6403e+00]],

         [[-1.0894e+00,        -inf,        -inf,        -inf],
          [ 2.7916e+00,  2.7242e-01,        -inf,        -inf],
          [ 4.7289e+00, -1.7952e-01,  2.9109e+00,        -inf],
          [-1.1483e+00, -3.1928e+00,  4.6600e+00,  7.5453e-01]],

         [[ 8.3799e-01,        -inf,        -inf,        -inf],
          [ 1.5984e+00,  1.0569e+00,        -inf,        -inf],
          [ 1.0818e+00, -2.4451e+00, -1.0483e+00,        -inf],
          [ 1.6576e+00, -1.9144e+00,  1.5818e+00,  3.4991e+00]],

         [[-9.0585e-01,        -inf,        -inf,        -inf],
          [-2.0462e+00,  4.4392e+00,        -inf,        -inf],
          [-4.6362e+00, -3.7937e+00,  8.6279e+00,        -inf],
          [-3.0919e-01, -3.1753e+00, -5.3696e+00,  3.7735e-01]],

         [[ 1.2107e+00,        -inf,        -inf,        -inf],
          [-1.2537e+00,  2.3087e+00,        -inf,        -inf],
          [-1.0984e+00,  9.7441e-01, -1.2546e+00,        -inf],
          [ 1.0653e+00, -1.9150e+00,  8.5529e-01, -3.6067e+00]],

         [[-1.1333e+00,        -inf,        -inf,        -inf],
          [ 1.0422e+00, -1.4694e+00,        -inf,        -inf],
          [ 8.8979e-01,  2.0699e+00, -1.6114e+00,        -inf],
          [-7.3062e-01,  2.2320e+00,  9.0535e-01, -5.3865e+00]],

         [[ 3.4927e+00,        -inf,        -inf,        -inf],
          [-6.8134e-01,  5.0515e+00,        -inf,        -inf],
          [ 3.1823e+00,  2.4915e+00,  1.1152e-01,        -inf],
          [-4.3863e+00, -8.0839e-01,  5.7041e+00,  1.2541e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 4.0830e+00,        -inf,        -inf,        -inf],
          [ 1.3531e+00,  3.1757e+00,        -inf,        -inf],
          [-2.1269e+00,  8.2719e-01, -3.1386e+00,        -inf],
          [ 2.2818e+00, -1.2365e-01, -1.7116e+00, -2.2287e+00]],

         [[ 1.3053e+00,        -inf,        -inf,        -inf],
          [ 2.5099e+00, -4.4558e+00,        -inf,        -inf],
          [-1.1854e+00,  5.2375e-01, -1.7626e+00,        -inf],
          [ 1.0636e+00, -4.2043e-01,  4.1804e+00, -4.7391e+00]],

         [[-2.8067e+00,        -inf,        -inf,        -inf],
          [ 1.7698e-01, -6.3733e-04,        -inf,        -inf],
          [ 8.4176e-01,  8.5148e-01, -1.3486e+00,        -inf],
          [ 6.4716e+00, -1.0026e+00,  1.6756e-02, -8.0200e-01]],

         [[ 8.9080e-01,        -inf,        -inf,        -inf],
          [-2.0932e+00, -1.6666e+00,        -inf,        -inf],
          [ 7.1806e-01,  2.4204e+00, -9.5359e-01,        -inf],
          [-5.9216e+00,  1.5718e+00, -4.8345e+00, -2.5211e+00]],

         [[ 3.1748e+00,        -inf,        -inf,        -inf],
          [ 2.7819e+00, -1.2148e+00,        -inf,        -inf],
          [-1.8973e+00,  3.3122e+00, -4.7762e+00,        -inf],
          [-2.6131e+00,  1.6839e+00, -1.4193e+00, -1.4079e+00]],

         [[-1.3752e+00,        -inf,        -inf,        -inf],
          [ 7.9014e-01, -2.8859e+00,        -inf,        -inf],
          [ 2.1641e+00,  3.4512e+00,  1.3711e+00,        -inf],
          [ 4.1022e+00, -9.7649e-01, -1.5396e+00,  1.4214e-01]],

         [[-1.4684e+00,        -inf,        -inf,        -inf],
          [ 4.1143e-01,  1.2933e+00,        -inf,        -inf],
          [-9.6159e-02,  4.4370e+00,  1.1498e+00,        -inf],
          [-4.5130e+00, -3.0714e+00,  3.5468e-01,  1.0036e+00]],

         [[ 3.0060e+00,        -inf,        -inf,        -inf],
          [ 4.3255e+00,  1.3678e+00,        -inf,        -inf],
          [ 9.1152e-03, -3.1019e+00,  1.0130e+00,        -inf],
          [ 3.6372e+00,  8.9991e-01,  1.5147e+00, -2.8325e+00]],

         [[ 4.1002e-01,        -inf,        -inf,        -inf],
          [ 1.2120e+00,  8.4458e-01,        -inf,        -inf],
          [-2.7603e+00, -5.5899e+00, -3.0698e+00,        -inf],
          [ 1.0044e+00,  6.5398e-01,  1.9722e-01, -3.1923e+00]],

         [[-2.2638e+00,        -inf,        -inf,        -inf],
          [ 7.4728e-01, -1.2278e-01,        -inf,        -inf],
          [-1.0772e+00,  4.2819e+00,  3.2126e+00,        -inf],
          [ 2.5267e+00,  2.2734e+00,  6.3893e-01, -3.9138e-01]],

         [[-1.2259e+00,        -inf,        -inf,        -inf],
          [-7.3969e-01, -2.5141e-01,        -inf,        -inf],
          [ 6.2732e-01, -2.1144e+00,  8.6704e-01,        -inf],
          [-2.2779e+00,  4.6504e-01, -3.6154e-01,  4.2029e+00]],

         [[ 3.7388e+00,        -inf,        -inf,        -inf],
          [ 1.0586e-01,  4.6344e+00,        -inf,        -inf],
          [ 4.6162e+00, -1.8239e+00,  2.4002e+00,        -inf],
          [-2.1785e+00,  6.8435e-01, -2.3439e+00,  3.5623e+00]]],


        [[[-3.3057e-01,        -inf,        -inf,        -inf],
          [-2.2960e-01, -2.2780e+00,        -inf,        -inf],
          [ 5.8895e-01,  4.4680e+00,  4.2390e+00,        -inf],
          [ 2.0347e+00,  7.6459e-01, -3.2471e-01, -3.8995e+00]],

         [[ 1.0912e+00,        -inf,        -inf,        -inf],
          [ 5.2409e-01,  9.0330e-01,        -inf,        -inf],
          [-6.2526e-01,  8.6539e-02, -2.0971e+00,        -inf],
          [-2.0184e+00, -8.9192e-01,  2.9850e+00, -4.7016e-01]],

         [[-2.7806e+00,        -inf,        -inf,        -inf],
          [ 1.5366e+00, -9.7828e-01,        -inf,        -inf],
          [ 1.8208e+00,  3.3333e-01, -2.6268e+00,        -inf],
          [ 4.0107e+00,  8.4969e-02, -2.9664e+00,  6.7587e-01]],

         [[ 2.0494e+00,        -inf,        -inf,        -inf],
          [ 8.4274e-01, -3.1433e+00,        -inf,        -inf],
          [ 1.0891e+00,  2.0785e+00, -2.0100e+00,        -inf],
          [-3.9263e+00,  2.8330e-01, -2.4407e+00, -8.7427e-01]],

         [[ 1.9079e+00,        -inf,        -inf,        -inf],
          [ 1.7642e+00, -9.6383e-01,        -inf,        -inf],
          [-5.8918e+00,  5.8637e+00,  7.8140e-01,        -inf],
          [-4.0859e+00,  1.6085e+00,  1.1003e+00, -3.8762e+00]],

         [[-1.8026e+00,        -inf,        -inf,        -inf],
          [ 3.3704e+00, -5.0434e+00,        -inf,        -inf],
          [-6.2471e-01, -7.7486e-01,  2.5652e-01,        -inf],
          [ 3.3861e+00, -1.8212e+00,  6.1661e-01,  3.6403e+00]],

         [[-1.0894e+00,        -inf,        -inf,        -inf],
          [ 2.7916e+00,  2.7242e-01,        -inf,        -inf],
          [ 4.7289e+00, -1.7952e-01,  2.9109e+00,        -inf],
          [-1.1483e+00, -3.1928e+00,  4.6600e+00,  7.5453e-01]],

         [[ 8.3799e-01,        -inf,        -inf,        -inf],
          [ 1.5984e+00,  1.0569e+00,        -inf,        -inf],
          [ 1.0818e+00, -2.4451e+00, -1.0483e+00,        -inf],
          [ 1.6576e+00, -1.9144e+00,  1.5818e+00,  3.4991e+00]],

         [[-9.0585e-01,        -inf,        -inf,        -inf],
          [-2.0462e+00,  4.4392e+00,        -inf,        -inf],
          [-4.6362e+00, -3.7937e+00,  8.6279e+00,        -inf],
          [-3.0919e-01, -3.1753e+00, -5.3696e+00,  3.7735e-01]],

         [[ 1.2107e+00,        -inf,        -inf,        -inf],
          [-1.2537e+00,  2.3087e+00,        -inf,        -inf],
          [-1.0984e+00,  9.7441e-01, -1.2546e+00,        -inf],
          [ 1.0653e+00, -1.9150e+00,  8.5529e-01, -3.6067e+00]],

         [[-1.1333e+00,        -inf,        -inf,        -inf],
          [ 1.0422e+00, -1.4694e+00,        -inf,        -inf],
          [ 8.8979e-01,  2.0699e+00, -1.6114e+00,        -inf],
          [-7.3062e-01,  2.2320e+00,  9.0535e-01, -5.3865e+00]],

         [[ 3.4927e+00,        -inf,        -inf,        -inf],
          [-6.8134e-01,  5.0515e+00,        -inf,        -inf],
          [ 3.1823e+00,  2.4915e+00,  1.1152e-01,        -inf],
          [-4.3863e+00, -8.0839e-01,  5.7041e+00,  1.2541e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.1354,  0.6184, -0.2036,  ...,  1.0703,  0.6262,  0.8701],
          [ 0.5802,  0.4999,  0.1042,  ...,  0.3191,  0.0110, -0.3728],
          [-0.1124, -0.4921,  0.1687,  ..., -0.7943,  0.1750,  0.2773],
          ...,
          [-0.0812,  0.9237,  0.2886,  ..., -0.5644,  0.1848, -0.5668],
          [ 0.6089,  0.1699,  0.1903,  ...,  0.0977, -1.0465,  0.0262],
          [-0.7952,  0.2908,  0.2920,  ...,  0.0184, -0.7877,  0.3428]],

         [[ 0.0340,  0.2560, -0.0377,  ...,  1.3557,  0.1576,  0.2113],
          [ 0.5776,  0.0228,  0.4387,  ..., -0.1721,  0.0473, -0.3550],
          [-0.0526, -0.0459,  0.3008,  ..., -0.5616,  0.3630,  0.1709],
          ...,
          [ 0.2357,  0.9825,  0.1786,  ..., -0.0861,  0.1551, -0.2589],
          [ 0.4622,  0.0733, -0.0319,  ..., -0.0926, -0.1969, -0.1327],
          [-0.4785,  0.1358,  0.5185,  ...,  0.2275, -0.3493,  0.6406]],

         [[ 0.1756, -0.0148,  0.2428,  ...,  1.1632,  0.3082,  0.1330],
          [ 0.4063, -0.2786,  0.5166,  ..., -0.4251,  0.0558, -0.2397],
          [-0.0376, -0.0294,  0.2191,  ..., -0.4050,  0.2646,  0.1229],
          ...,
          [ 0.1874,  0.5092,  0.0081,  ..., -0.4968,  0.0907,  0.1460],
          [ 0.2584,  0.3041, -0.2146,  ...,  0.3108, -0.8014, -0.3556],
          [-0.4212,  0.1416,  0.2636,  ...,  0.0785, -0.3776,  0.3196]],

         [[-0.0451, -0.0145, -0.1664,  ...,  0.3966,  0.0030, -0.1724],
          [ 0.4167,  0.4427,  0.5048,  ...,  0.1655,  0.2474, -0.0229],
          [-0.1813, -0.0249, -0.1744,  ...,  0.2936, -0.0434,  0.2363],
          ...,
          [ 0.2931,  0.7518,  0.1009,  ..., -0.3573,  0.2810, -0.1545],
          [ 0.1061,  0.1169, -0.1677,  ...,  0.5604, -0.6252, -0.2550],
          [-0.5697, -0.1939,  0.1597,  ...,  0.5100, -0.2968,  0.5923]]],


        [[[ 0.0262,  0.8142, -0.2463,  ...,  0.7184,  0.7416,  1.3861],
          [ 0.5808, -0.2282, -0.0689,  ...,  0.6736, -0.4226, -0.5562],
          [-0.1698, -0.3904,  0.4709,  ..., -1.0864,  0.4170,  0.3957],
          ...,
          [ 0.0948,  0.5304,  0.0504,  ..., -0.1144,  0.1345, -0.0397],
          [ 0.4669, -0.1819,  0.8024,  ..., -0.1916, -1.2186,  0.5404],
          [-0.4799,  0.4351, -0.2558,  ...,  0.4869, -0.3789,  0.1818]],

         [[ 0.1833,  0.6390, -0.3616,  ...,  1.2220,  0.4707,  0.9986],
          [ 0.3016, -0.5373,  0.2202,  ...,  0.0026, -0.2611, -0.2344],
          [ 0.0379,  0.1063,  0.3751,  ..., -0.5913,  0.3828,  0.4081],
          ...,
          [ 0.4532,  0.6226,  0.2258,  ...,  0.6787,  0.1940, -0.1000],
          [ 0.3185, -0.3777,  0.4454,  ...,  0.1009, -0.6836,  0.6025],
          [-0.2566, -0.4255,  0.3667,  ...,  0.6212, -0.3190,  0.9957]],

         [[ 0.4241, -0.1418, -0.0603,  ...,  0.6806,  0.4726,  0.2831],
          [ 0.2688, -0.0056,  0.1413,  ...,  0.3580, -0.2532, -0.3531],
          [ 0.0407,  0.1093,  0.2801,  ..., -0.4220,  0.2895,  0.3114],
          ...,
          [ 0.2053,  0.6429, -0.1346,  ...,  0.6079,  0.0980, -0.0566],
          [ 0.1027, -0.3134,  0.1465,  ...,  0.1003, -0.5723,  0.1956],
          [-0.0388, -0.2240, -0.0218,  ...,  0.4051, -0.1594,  0.1873]],

         [[ 0.4453,  0.1445, -0.3068,  ...,  0.8089,  0.6714,  0.7125],
          [ 0.2745,  0.0465,  0.7122,  ...,  0.3107, -0.1995, -0.5740],
          [-0.1044, -0.1623,  0.2562,  ..., -0.3355,  0.0815,  0.1077],
          ...,
          [ 0.2078,  0.2024,  0.0998,  ...,  0.1062,  0.1548, -0.1241],
          [-0.0165, -0.1003,  0.0356,  ...,  0.1042, -0.5305,  0.1028],
          [ 0.1184, -0.2134, -0.0813,  ...,  0.4776,  0.0478,  0.0131]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.1354,  0.6184, -0.2036,  ...,  0.0184, -0.7877,  0.3428],
         [ 0.0340,  0.2560, -0.0377,  ...,  0.2275, -0.3493,  0.6406],
         [ 0.1756, -0.0148,  0.2428,  ...,  0.0785, -0.3776,  0.3196],
         [-0.0451, -0.0145, -0.1664,  ...,  0.5100, -0.2968,  0.5923]],

        [[ 0.0262,  0.8142, -0.2463,  ...,  0.4869, -0.3789,  0.1818],
         [ 0.1833,  0.6390, -0.3616,  ...,  0.6212, -0.3190,  0.9957],
         [ 0.4241, -0.1418, -0.0603,  ...,  0.4051, -0.1594,  0.1873],
         [ 0.4453,  0.1445, -0.3068,  ...,  0.4776,  0.0478,  0.0131]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.5957, -0.0236,  0.8991,  ...,  0.1350, -0.4407,  0.1917],
         [ 0.1865, -0.3232,  0.5766,  ..., -0.3712, -0.3878,  0.1115],
         [ 0.2713, -0.0375,  0.2840,  ..., -0.0359, -0.1966, -0.2334],
         [ 0.0840, -0.1743,  0.3004,  ..., -0.2011, -0.2142, -0.2111]],

        [[ 0.2958,  0.1644,  0.9128,  ...,  0.0664, -0.5921,  0.2413],
         [ 0.0044,  0.1403,  0.6641,  ...,  0.2750, -0.3216, -0.0214],
         [-0.2558, -0.0675,  0.4723,  ...,  0.1170, -0.1585,  0.2358],
         [-0.1015,  0.0588,  0.1432,  ...,  0.2515, -0.1188,  0.0215]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 2.0894e+00,        -inf,        -inf,        -inf],
          [ 3.5902e+00,  1.5475e+00,        -inf,        -inf],
          [-6.7394e+00, -1.0389e-01,  1.8088e+00,        -inf],
          [ 2.2599e+00,  1.0227e+00,  3.8025e-01, -2.2830e+00]],

         [[ 7.7264e+00,        -inf,        -inf,        -inf],
          [-1.5033e+00,  2.2665e+00,        -inf,        -inf],
          [ 7.4243e+00,  2.4503e+00,  2.8156e+00,        -inf],
          [ 1.8072e+00,  7.6054e-01,  7.9399e-01, -2.5787e+00]],

         [[-8.5278e-01,        -inf,        -inf,        -inf],
          [ 7.3429e-01,  4.4611e-01,        -inf,        -inf],
          [ 2.6928e+00,  1.0347e+00, -3.2746e+00,        -inf],
          [-1.7466e+00,  2.4913e-01,  1.3333e+00,  1.2243e+00]],

         [[ 3.0280e+00,        -inf,        -inf,        -inf],
          [ 7.8413e-01, -2.2956e+00,        -inf,        -inf],
          [ 3.6161e-01, -3.0278e+00, -9.4162e-01,        -inf],
          [-9.6772e-01, -1.5815e+00, -9.5628e-02, -1.4739e+00]],

         [[-2.5986e+00,        -inf,        -inf,        -inf],
          [ 2.2926e+00, -4.1446e-02,        -inf,        -inf],
          [-1.9971e-01,  2.0415e+00,  1.7646e+00,        -inf],
          [ 3.3367e+00, -1.0045e+00,  2.6031e+00,  1.0158e+00]],

         [[-4.2120e+00,        -inf,        -inf,        -inf],
          [-3.7975e+00,  4.5870e+00,        -inf,        -inf],
          [-1.2308e+00,  1.2809e+00, -2.7557e+00,        -inf],
          [ 6.7405e-01,  1.1617e+00, -1.9914e+00,  4.2946e+00]],

         [[ 1.3743e-01,        -inf,        -inf,        -inf],
          [-7.6596e-01, -5.1413e+00,        -inf,        -inf],
          [-8.1195e-01, -3.0555e+00, -2.8426e+00,        -inf],
          [-4.3672e-01, -2.1778e+00, -2.1273e+00, -3.7864e+00]],

         [[-3.1053e+00,        -inf,        -inf,        -inf],
          [-1.4068e+00, -1.6062e+00,        -inf,        -inf],
          [ 3.8730e+00,  2.3828e+00,  1.8609e+00,        -inf],
          [ 2.5912e+00, -2.2755e-01, -7.1816e+00, -1.4524e+00]],

         [[-2.5237e+00,        -inf,        -inf,        -inf],
          [-3.9335e+00, -4.6238e+00,        -inf,        -inf],
          [-4.1153e+00, -4.9496e+00, -1.7607e+00,        -inf],
          [ 4.4378e+00,  1.5985e+00,  4.1700e+00,  2.3377e+00]],

         [[ 2.6364e+00,        -inf,        -inf,        -inf],
          [ 1.0542e+00, -3.9480e-01,        -inf,        -inf],
          [-1.9361e+00,  3.2549e+00,  2.8458e+00,        -inf],
          [-7.7364e-01,  8.2876e-01, -8.4957e-01, -1.6610e+00]],

         [[ 1.2430e+00,        -inf,        -inf,        -inf],
          [-1.6253e+00,  9.8696e-01,        -inf,        -inf],
          [ 4.5078e-01, -2.0401e-01, -7.5982e+00,        -inf],
          [ 3.0514e-01, -8.5957e-01,  1.1172e+00, -3.0003e-01]],

         [[ 2.7825e+00,        -inf,        -inf,        -inf],
          [ 3.7551e+00,  2.3270e+00,        -inf,        -inf],
          [-1.6213e+00, -1.0553e-01,  1.2168e+00,        -inf],
          [ 2.2992e-01,  5.4166e+00, -1.5768e+00,  5.0459e-01]]],


        [[[ 2.8240e+00,        -inf,        -inf,        -inf],
          [ 3.2395e+00,  1.5696e+00,        -inf,        -inf],
          [-8.7317e-01,  2.2776e-02,  4.4035e+00,        -inf],
          [ 5.0403e+00,  4.9635e-01, -2.6037e+00, -2.9408e-01]],

         [[ 3.2393e+00,        -inf,        -inf,        -inf],
          [-3.2214e+00,  5.7483e+00,        -inf,        -inf],
          [ 6.0601e+00,  3.6242e+00,  2.3621e+00,        -inf],
          [ 4.1783e+00,  5.1881e-01, -3.3593e+00, -2.1800e+00]],

         [[-1.4107e+00,        -inf,        -inf,        -inf],
          [-2.3247e+00, -4.4566e+00,        -inf,        -inf],
          [ 3.6698e+00, -9.5828e-01,  1.5728e-01,        -inf],
          [ 1.3447e+00, -2.0347e+00, -4.7440e-01, -4.3957e-01]],

         [[ 3.3598e+00,        -inf,        -inf,        -inf],
          [ 2.1611e+00,  1.3397e+00,        -inf,        -inf],
          [-7.9123e-02,  3.2487e+00, -2.1695e-01,        -inf],
          [ 8.9751e-02,  1.1465e+00,  3.5119e-01, -3.2056e-01]],

         [[-2.5673e+00,        -inf,        -inf,        -inf],
          [-5.2019e-01,  1.8014e+00,        -inf,        -inf],
          [-4.6782e+00,  3.1752e+00, -9.3965e-01,        -inf],
          [ 2.0627e+00,  1.2269e+00, -2.6270e+00, -8.7892e-01]],

         [[-2.9810e-03,        -inf,        -inf,        -inf],
          [-2.3009e+00,  4.7738e+00,        -inf,        -inf],
          [ 3.7922e+00,  6.5391e+00, -3.2967e+00,        -inf],
          [-6.6330e-01,  1.8096e+00,  2.2899e+00, -1.9937e+00]],

         [[-3.3938e+00,        -inf,        -inf,        -inf],
          [-2.8393e+00, -1.9624e+00,        -inf,        -inf],
          [-4.2467e-01, -1.4339e+00, -7.8930e-01,        -inf],
          [ 1.7030e+00, -3.5400e+00,  4.7376e-01,  9.7577e-02]],

         [[-3.7081e+00,        -inf,        -inf,        -inf],
          [ 4.6362e+00,  7.8040e-01,        -inf,        -inf],
          [-4.6058e+00, -1.1489e+00,  2.4567e+00,        -inf],
          [ 1.3872e+00,  1.0678e-01, -4.7578e+00,  3.8904e-01]],

         [[-2.6888e+00,        -inf,        -inf,        -inf],
          [-9.8420e-01,  4.3620e-01,        -inf,        -inf],
          [ 8.8634e-01,  1.8012e+00, -2.4820e-02,        -inf],
          [ 9.7364e-02,  2.0451e+00,  2.2101e+00, -2.8026e+00]],

         [[-2.1894e-01,        -inf,        -inf,        -inf],
          [-2.9504e+00,  8.5025e-01,        -inf,        -inf],
          [-1.4006e+00,  3.7441e+00, -4.8166e-02,        -inf],
          [-2.1629e+00, -1.2232e+00, -2.0350e+00, -8.0551e-01]],

         [[ 3.6242e+00,        -inf,        -inf,        -inf],
          [ 3.0797e+00, -1.2659e-02,        -inf,        -inf],
          [ 8.2768e-02,  1.1343e+00, -3.5292e+00,        -inf],
          [ 2.6299e+00,  1.3796e+00,  3.5486e+00, -2.1083e+00]],

         [[ 9.1287e-02,        -inf,        -inf,        -inf],
          [ 2.5574e+00,  5.4304e+00,        -inf,        -inf],
          [ 3.5602e+00,  2.7693e+00,  2.6415e+00,        -inf],
          [-8.9581e-01,  3.0182e+00,  9.9791e-01,  2.6183e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 2.0894e+00,        -inf,        -inf,        -inf],
          [ 3.5902e+00,  1.5475e+00,        -inf,        -inf],
          [-6.7394e+00, -1.0389e-01,  1.8088e+00,        -inf],
          [ 2.2599e+00,  1.0227e+00,  3.8025e-01, -2.2830e+00]],

         [[ 7.7264e+00,        -inf,        -inf,        -inf],
          [-1.5033e+00,  2.2665e+00,        -inf,        -inf],
          [ 7.4243e+00,  2.4503e+00,  2.8156e+00,        -inf],
          [ 1.8072e+00,  7.6054e-01,  7.9399e-01, -2.5787e+00]],

         [[-8.5278e-01,        -inf,        -inf,        -inf],
          [ 7.3429e-01,  4.4611e-01,        -inf,        -inf],
          [ 2.6928e+00,  1.0347e+00, -3.2746e+00,        -inf],
          [-1.7466e+00,  2.4913e-01,  1.3333e+00,  1.2243e+00]],

         [[ 3.0280e+00,        -inf,        -inf,        -inf],
          [ 7.8413e-01, -2.2956e+00,        -inf,        -inf],
          [ 3.6161e-01, -3.0278e+00, -9.4162e-01,        -inf],
          [-9.6772e-01, -1.5815e+00, -9.5628e-02, -1.4739e+00]],

         [[-2.5986e+00,        -inf,        -inf,        -inf],
          [ 2.2926e+00, -4.1446e-02,        -inf,        -inf],
          [-1.9971e-01,  2.0415e+00,  1.7646e+00,        -inf],
          [ 3.3367e+00, -1.0045e+00,  2.6031e+00,  1.0158e+00]],

         [[-4.2120e+00,        -inf,        -inf,        -inf],
          [-3.7975e+00,  4.5870e+00,        -inf,        -inf],
          [-1.2308e+00,  1.2809e+00, -2.7557e+00,        -inf],
          [ 6.7405e-01,  1.1617e+00, -1.9914e+00,  4.2946e+00]],

         [[ 1.3743e-01,        -inf,        -inf,        -inf],
          [-7.6596e-01, -5.1413e+00,        -inf,        -inf],
          [-8.1195e-01, -3.0555e+00, -2.8426e+00,        -inf],
          [-4.3672e-01, -2.1778e+00, -2.1273e+00, -3.7864e+00]],

         [[-3.1053e+00,        -inf,        -inf,        -inf],
          [-1.4068e+00, -1.6062e+00,        -inf,        -inf],
          [ 3.8730e+00,  2.3828e+00,  1.8609e+00,        -inf],
          [ 2.5912e+00, -2.2755e-01, -7.1816e+00, -1.4524e+00]],

         [[-2.5237e+00,        -inf,        -inf,        -inf],
          [-3.9335e+00, -4.6238e+00,        -inf,        -inf],
          [-4.1153e+00, -4.9496e+00, -1.7607e+00,        -inf],
          [ 4.4378e+00,  1.5985e+00,  4.1700e+00,  2.3377e+00]],

         [[ 2.6364e+00,        -inf,        -inf,        -inf],
          [ 1.0542e+00, -3.9480e-01,        -inf,        -inf],
          [-1.9361e+00,  3.2549e+00,  2.8458e+00,        -inf],
          [-7.7364e-01,  8.2876e-01, -8.4957e-01, -1.6610e+00]],

         [[ 1.2430e+00,        -inf,        -inf,        -inf],
          [-1.6253e+00,  9.8696e-01,        -inf,        -inf],
          [ 4.5078e-01, -2.0401e-01, -7.5982e+00,        -inf],
          [ 3.0514e-01, -8.5957e-01,  1.1172e+00, -3.0003e-01]],

         [[ 2.7825e+00,        -inf,        -inf,        -inf],
          [ 3.7551e+00,  2.3270e+00,        -inf,        -inf],
          [-1.6213e+00, -1.0553e-01,  1.2168e+00,        -inf],
          [ 2.2992e-01,  5.4166e+00, -1.5768e+00,  5.0459e-01]]],


        [[[ 2.8240e+00,        -inf,        -inf,        -inf],
          [ 3.2395e+00,  1.5696e+00,        -inf,        -inf],
          [-8.7317e-01,  2.2776e-02,  4.4035e+00,        -inf],
          [ 5.0403e+00,  4.9635e-01, -2.6037e+00, -2.9408e-01]],

         [[ 3.2393e+00,        -inf,        -inf,        -inf],
          [-3.2214e+00,  5.7483e+00,        -inf,        -inf],
          [ 6.0601e+00,  3.6242e+00,  2.3621e+00,        -inf],
          [ 4.1783e+00,  5.1881e-01, -3.3593e+00, -2.1800e+00]],

         [[-1.4107e+00,        -inf,        -inf,        -inf],
          [-2.3247e+00, -4.4566e+00,        -inf,        -inf],
          [ 3.6698e+00, -9.5828e-01,  1.5728e-01,        -inf],
          [ 1.3447e+00, -2.0347e+00, -4.7440e-01, -4.3957e-01]],

         [[ 3.3598e+00,        -inf,        -inf,        -inf],
          [ 2.1611e+00,  1.3397e+00,        -inf,        -inf],
          [-7.9123e-02,  3.2487e+00, -2.1695e-01,        -inf],
          [ 8.9751e-02,  1.1465e+00,  3.5119e-01, -3.2056e-01]],

         [[-2.5673e+00,        -inf,        -inf,        -inf],
          [-5.2019e-01,  1.8014e+00,        -inf,        -inf],
          [-4.6782e+00,  3.1752e+00, -9.3965e-01,        -inf],
          [ 2.0627e+00,  1.2269e+00, -2.6270e+00, -8.7892e-01]],

         [[-2.9810e-03,        -inf,        -inf,        -inf],
          [-2.3009e+00,  4.7738e+00,        -inf,        -inf],
          [ 3.7922e+00,  6.5391e+00, -3.2967e+00,        -inf],
          [-6.6330e-01,  1.8096e+00,  2.2899e+00, -1.9937e+00]],

         [[-3.3938e+00,        -inf,        -inf,        -inf],
          [-2.8393e+00, -1.9624e+00,        -inf,        -inf],
          [-4.2467e-01, -1.4339e+00, -7.8930e-01,        -inf],
          [ 1.7030e+00, -3.5400e+00,  4.7376e-01,  9.7577e-02]],

         [[-3.7081e+00,        -inf,        -inf,        -inf],
          [ 4.6362e+00,  7.8040e-01,        -inf,        -inf],
          [-4.6058e+00, -1.1489e+00,  2.4567e+00,        -inf],
          [ 1.3872e+00,  1.0678e-01, -4.7578e+00,  3.8904e-01]],

         [[-2.6888e+00,        -inf,        -inf,        -inf],
          [-9.8420e-01,  4.3620e-01,        -inf,        -inf],
          [ 8.8634e-01,  1.8012e+00, -2.4820e-02,        -inf],
          [ 9.7364e-02,  2.0451e+00,  2.2101e+00, -2.8026e+00]],

         [[-2.1894e-01,        -inf,        -inf,        -inf],
          [-2.9504e+00,  8.5025e-01,        -inf,        -inf],
          [-1.4006e+00,  3.7441e+00, -4.8166e-02,        -inf],
          [-2.1629e+00, -1.2232e+00, -2.0350e+00, -8.0551e-01]],

         [[ 3.6242e+00,        -inf,        -inf,        -inf],
          [ 3.0797e+00, -1.2659e-02,        -inf,        -inf],
          [ 8.2768e-02,  1.1343e+00, -3.5292e+00,        -inf],
          [ 2.6299e+00,  1.3796e+00,  3.5486e+00, -2.1083e+00]],

         [[ 9.1287e-02,        -inf,        -inf,        -inf],
          [ 2.5574e+00,  5.4304e+00,        -inf,        -inf],
          [ 3.5602e+00,  2.7693e+00,  2.6415e+00,        -inf],
          [-8.9581e-01,  3.0182e+00,  9.9791e-01,  2.6183e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 1.8177e+00, -8.5416e-01, -1.2255e+00,  ..., -4.0281e-02,
            2.6072e-01,  6.2750e-02],
          [-4.3876e-01, -1.4359e+00,  6.7323e-01,  ..., -7.3667e-01,
           -6.1023e-01,  6.3422e-01],
          [ 3.6491e-01,  9.8824e-02, -5.4982e-01,  ..., -4.4856e-01,
            7.1458e-02, -4.4459e-01],
          ...,
          [ 6.0262e-01, -1.5208e-01, -1.0261e+00,  ..., -4.3733e-01,
            6.5727e-01,  4.9329e-02],
          [-7.3187e-01, -1.3235e+00, -9.7505e-01,  ...,  7.3315e-01,
            6.0564e-01,  1.4320e+00],
          [-6.9458e-03,  2.4024e-01, -3.1741e-01,  ..., -4.1310e-01,
            1.5808e-02, -6.2864e-01]],

         [[-4.5390e-02, -2.1699e-01, -4.1909e-01,  ..., -2.4699e-01,
            2.8118e-01, -4.6509e-02],
          [-3.4150e-01, -9.3188e-01,  2.5834e-01,  ..., -8.4057e-01,
           -7.0406e-01, -8.9609e-01],
          [ 4.1074e-02,  2.0402e-01, -1.6481e-01,  ..., -3.4034e-01,
            1.5189e-01, -2.5359e-03],
          ...,
          [ 3.2852e-01, -8.2906e-02, -5.5940e-01,  ..., -2.3841e-01,
            3.5832e-01,  2.6892e-02],
          [-1.2400e-01, -3.6796e-01, -8.1674e-01,  ..., -3.6880e-02,
            8.9608e-02,  9.1674e-01],
          [-3.7821e-03,  1.3081e-01, -1.7283e-01,  ..., -2.2494e-01,
            8.6078e-03, -3.4230e-01]],

         [[ 9.9841e-02, -5.8760e-01, -1.0073e-01,  ...,  2.7484e-02,
            1.1265e+00, -3.2697e-01],
          [-3.2469e-01, -9.5629e-01,  6.8501e-01,  ..., -9.6526e-01,
           -1.0807e+00, -3.7118e-01],
          [ 1.5317e-01,  2.1284e-01, -4.1647e-01,  ..., -1.8786e-01,
           -1.1300e-01, -8.4000e-02],
          ...,
          [ 2.6910e-01,  1.4582e-01, -7.3685e-02,  ..., -6.4708e-01,
            2.0961e-01, -1.3680e-01],
          [-2.3239e-01, -5.5277e-01, -8.1821e-01,  ...,  1.4251e-01,
            1.7471e-01,  8.2684e-01],
          [ 1.9253e-01,  8.5295e-02,  4.2852e-02,  ...,  6.5682e-02,
           -3.4116e-01,  1.1265e-01]],

         [[ 4.6915e-01, -7.2941e-01, -5.2839e-01,  ..., -1.0323e-01,
            8.7595e-01, -1.6213e-01],
          [-2.7812e-01, -7.9360e-01,  7.5538e-01,  ..., -9.1875e-01,
           -9.3254e-01, -6.6751e-01],
          [ 2.0668e-01,  2.8548e-01, -5.5284e-01,  ..., -1.2101e-01,
           -1.4701e-01,  6.9260e-03],
          ...,
          [ 2.6087e-01,  1.6063e-02, -2.0695e-01,  ..., -4.0622e-01,
           -1.9548e-01,  1.0069e-01],
          [-7.2387e-02, -6.8501e-01, -3.6433e-01,  ...,  1.3141e-01,
            1.7954e-01,  4.8328e-01],
          [ 1.5025e-03,  9.8452e-02, -9.2408e-02,  ...,  1.4925e-01,
           -6.2535e-01,  2.8413e-02]]],


        [[[ 1.2812e+00, -2.4969e-01, -1.4029e+00,  ..., -1.5453e-01,
           -2.1522e-01, -8.8623e-02],
          [-2.9283e-01, -3.3036e-01,  1.3318e+00,  ..., -4.0225e-01,
           -8.2709e-01,  5.8365e-01],
          [ 7.6432e-01,  3.1935e-02, -2.9070e-01,  ..., -1.0794e-02,
           -6.4735e-01, -3.2466e-01],
          ...,
          [-1.1236e-01,  7.9592e-02, -4.0782e-01,  ..., -1.1599e+00,
            2.5113e-01,  3.2353e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.6836e-01,  5.4710e-01,  6.3011e-01,  ..., -6.3480e-01,
            2.9420e-01, -1.8470e-01]],

         [[ 7.8436e-01, -4.3918e-01, -9.1582e-01,  ..., -1.9197e-01,
            3.8676e-01, -3.8581e-01],
          [-3.7849e-01, -2.8938e-01,  3.8683e-01,  ..., -3.7906e-01,
           -9.7938e-01, -1.2343e-01],
          [ 4.9272e-02,  3.4136e-01, -1.9990e-01,  ...,  4.9771e-02,
           -1.0429e-01,  2.3612e-02],
          ...,
          [ 1.9565e-01, -1.9795e-01, -8.1368e-05,  ..., -7.1642e-01,
           -1.7005e-02,  8.0400e-01],
          [-4.6836e-01, -2.9189e-01, -1.8773e-01,  ...,  1.6552e-01,
            2.5550e-01,  1.1296e+00],
          [-1.4033e-01,  7.0642e-01,  7.5251e-01,  ...,  3.4229e-01,
           -1.7763e-01, -9.5141e-03]],

         [[ 6.9173e-01, -5.2479e-01,  7.3757e-02,  ..., -2.5510e-01,
            7.9023e-01, -1.2754e-01],
          [-4.0840e-01, -4.8867e-01,  8.2856e-01,  ..., -5.4004e-01,
           -1.1891e+00,  5.0130e-02],
          [ 3.9671e-01,  1.2170e-01, -3.7964e-01,  ...,  3.2609e-01,
           -1.2198e-02, -9.8378e-02],
          ...,
          [-2.7496e-02,  1.9477e-02, -9.9797e-02,  ..., -2.8383e-01,
            6.1453e-02,  7.9169e-02],
          [-4.0521e-01, -3.0008e-01, -4.4476e-01,  ...,  5.1801e-02,
            9.0332e-02,  8.0692e-01],
          [-7.0293e-03,  5.9588e-01,  2.8413e-01,  ...,  4.0178e-01,
           -1.0624e-01, -1.1854e-02]],

         [[ 1.0728e-01, -9.0748e-02,  1.6581e-01,  ..., -4.9460e-02,
            1.7392e-01,  3.3317e-02],
          [-3.8438e-01, -5.8491e-01,  8.2909e-01,  ..., -4.7718e-01,
           -8.4409e-01,  1.7981e-02],
          [ 5.6827e-02,  1.6003e-01, -1.0579e-01,  ...,  2.2646e-02,
           -7.7195e-02, -3.4427e-03],
          ...,
          [ 1.6685e-01, -4.2304e-03,  2.8995e-02,  ..., -3.3924e-01,
           -6.5408e-01,  6.8185e-01],
          [-3.5140e-01, -3.4305e-01, -5.8666e-01,  ...,  1.4059e-01,
            1.8374e-02,  6.1604e-01],
          [-2.9552e-01,  5.8566e-01,  2.9507e-01,  ...,  4.0530e-01,
           -2.6720e-01, -2.1093e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 1.8177, -0.8542, -1.2255,  ..., -0.4131,  0.0158, -0.6286],
         [-0.0454, -0.2170, -0.4191,  ..., -0.2249,  0.0086, -0.3423],
         [ 0.0998, -0.5876, -0.1007,  ...,  0.0657, -0.3412,  0.1126],
         [ 0.4692, -0.7294, -0.5284,  ...,  0.1493, -0.6254,  0.0284]],

        [[ 1.2812, -0.2497, -1.4029,  ..., -0.6348,  0.2942, -0.1847],
         [ 0.7844, -0.4392, -0.9158,  ...,  0.3423, -0.1776, -0.0095],
         [ 0.6917, -0.5248,  0.0738,  ...,  0.4018, -0.1062, -0.0119],
         [ 0.1073, -0.0907,  0.1658,  ...,  0.4053, -0.2672, -0.2109]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.3880, -0.1234,  0.2552,  ...,  0.1113, -0.3074, -0.0586],
         [ 0.2643,  0.0134, -0.2031,  ...,  0.2604, -0.0277,  0.0020],
         [ 0.4008, -0.0873, -0.1587,  ...,  0.3545,  0.1730,  0.0057],
         [ 0.3724,  0.0334, -0.1357,  ...,  0.1266,  0.1825, -0.2334]],

        [[-0.0425, -0.0689,  0.0810,  ..., -0.0915, -0.2004,  0.0563],
         [ 0.1558,  0.0386,  0.1437,  ..., -0.2322,  0.2912, -0.1475],
         [ 0.1549, -0.1448,  0.2273,  ..., -0.1471,  0.2849,  0.0727],
         [ 0.1443, -0.1286,  0.3015,  ..., -0.0770,  0.2293,  0.0571]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.0746e+00,        -inf,        -inf,        -inf],
          [-2.5789e+00, -1.2924e+00,        -inf,        -inf],
          [ 2.2804e-01, -3.7929e+00,  6.8994e-01,        -inf],
          [-8.8282e-01, -6.0228e-01, -1.7496e+00, -6.4143e-01]],

         [[-3.2498e-01,        -inf,        -inf,        -inf],
          [-3.8764e+00,  6.1402e+00,        -inf,        -inf],
          [ 5.9960e-01,  1.3801e+00, -1.0205e+00,        -inf],
          [ 1.6227e+00,  3.2636e+00,  1.1493e+00,  5.5407e+00]],

         [[-9.8993e-01,        -inf,        -inf,        -inf],
          [-2.5578e+00, -2.5576e+00,        -inf,        -inf],
          [ 2.2887e+00, -3.8998e+00, -1.5383e+00,        -inf],
          [-7.6870e-01, -1.1360e+00,  2.4903e+00, -1.1236e+00]],

         [[ 3.5628e+00,        -inf,        -inf,        -inf],
          [ 3.2148e-01, -1.0148e+00,        -inf,        -inf],
          [-2.7999e+00, -2.4343e-01, -4.1163e-01,        -inf],
          [-5.4775e+00, -3.7443e+00,  8.0563e-01, -1.0732e+00]],

         [[ 7.0352e-01,        -inf,        -inf,        -inf],
          [-3.6951e+00, -4.9536e+00,        -inf,        -inf],
          [-2.6477e+00, -8.8109e-02, -5.5754e+00,        -inf],
          [ 1.1214e+00, -4.6953e-01,  1.6919e+00,  5.5957e+00]],

         [[ 2.0202e+00,        -inf,        -inf,        -inf],
          [-2.4703e+00,  4.4510e+00,        -inf,        -inf],
          [-8.6834e-01, -2.8114e+00, -2.0330e-01,        -inf],
          [ 3.1048e+00,  7.3317e-01, -9.7914e-01, -1.2951e+00]],

         [[-2.8479e+00,        -inf,        -inf,        -inf],
          [-1.0498e+00,  2.2682e+00,        -inf,        -inf],
          [ 2.4943e-02,  2.1787e+00,  4.5058e+00,        -inf],
          [-3.0418e+00, -3.8491e-01, -7.8785e-01,  5.9793e-01]],

         [[-2.5756e+00,        -inf,        -inf,        -inf],
          [-3.5625e-01, -5.1779e+00,        -inf,        -inf],
          [ 2.1065e+00, -1.3731e+00, -4.0820e+00,        -inf],
          [-5.2963e+00, -1.3099e+00,  3.5601e+00,  3.0104e+00]],

         [[-1.6325e+00,        -inf,        -inf,        -inf],
          [ 2.9695e+00,  3.9026e-01,        -inf,        -inf],
          [ 5.0804e+00,  4.1267e+00, -5.4049e-01,        -inf],
          [ 1.3390e+00, -8.5028e-01, -3.2855e-01, -1.9927e+00]],

         [[-7.3720e-01,        -inf,        -inf,        -inf],
          [-4.9387e+00,  8.6697e-01,        -inf,        -inf],
          [ 1.1958e-01,  1.4957e+00, -1.3322e+00,        -inf],
          [ 2.0696e+00,  3.3646e+00, -1.1677e-01,  2.9314e+00]],

         [[-1.9994e+00,        -inf,        -inf,        -inf],
          [-2.2391e+00, -6.1424e-02,        -inf,        -inf],
          [ 1.9456e+00,  2.1339e+00, -4.1504e+00,        -inf],
          [ 1.1051e+00, -2.4083e+00, -1.1993e+00, -4.2439e-01]],

         [[ 1.5891e+00,        -inf,        -inf,        -inf],
          [ 2.1018e+00,  1.0517e+00,        -inf,        -inf],
          [-1.8190e-01,  2.0792e+00, -3.6481e-01,        -inf],
          [-3.5170e+00,  3.0705e+00,  1.4172e+00, -1.6767e+00]]],


        [[[ 1.4146e-01,        -inf,        -inf,        -inf],
          [-4.8383e+00,  1.5527e+00,        -inf,        -inf],
          [ 4.1110e+00, -1.9365e+00, -5.6949e-01,        -inf],
          [ 1.1788e+00, -1.2417e+00, -5.7079e+00, -2.5675e+00]],

         [[ 3.1106e+00,        -inf,        -inf,        -inf],
          [-2.0967e+00, -8.7070e-01,        -inf,        -inf],
          [ 1.4773e+00, -2.2038e-03, -4.5570e+00,        -inf],
          [ 3.4676e+00,  3.5248e+00, -1.1017e+00,  3.5686e+00]],

         [[-3.6667e+00,        -inf,        -inf,        -inf],
          [-1.0234e+00,  6.7098e-03,        -inf,        -inf],
          [-5.5371e-02,  3.0655e+00, -5.3457e-01,        -inf],
          [ 8.0845e-01, -8.6114e-01,  1.5282e+00,  1.9601e+00]],

         [[ 6.5191e+00,        -inf,        -inf,        -inf],
          [-2.9400e+00, -2.5135e+00,        -inf,        -inf],
          [ 2.7785e+00,  5.0702e+00,  1.7416e+00,        -inf],
          [-1.4955e+00, -4.1814e+00,  2.8885e+00, -2.8576e+00]],

         [[-1.0753e+00,        -inf,        -inf,        -inf],
          [-1.3749e+00, -2.5105e+00,        -inf,        -inf],
          [ 4.6358e+00, -5.8086e-01,  1.1391e+00,        -inf],
          [ 2.8475e-01, -1.0498e+00, -1.5027e+00, -4.5262e+00]],

         [[ 1.5742e+00,        -inf,        -inf,        -inf],
          [-3.2858e+00, -1.5189e+00,        -inf,        -inf],
          [-5.8515e+00, -5.5856e-01, -6.5129e+00,        -inf],
          [-3.0761e+00, -3.3510e+00,  2.6535e-01,  2.6712e+00]],

         [[-1.1438e+00,        -inf,        -inf,        -inf],
          [-8.6451e-01,  2.6516e+00,        -inf,        -inf],
          [ 4.9731e-01,  1.0602e+00, -1.9128e+00,        -inf],
          [-1.0366e+00, -1.0582e+00, -7.1144e+00, -2.2463e+00]],

         [[-3.3090e+00,        -inf,        -inf,        -inf],
          [ 1.4872e+00,  3.4130e+00,        -inf,        -inf],
          [-1.2956e+00,  9.8029e-01, -1.3107e+00,        -inf],
          [-3.5714e-01,  8.2391e-02,  4.5844e+00,  2.1381e+00]],

         [[-1.8260e+00,        -inf,        -inf,        -inf],
          [ 2.8683e+00,  1.2111e+00,        -inf,        -inf],
          [ 1.0385e+00, -6.9050e-01,  1.5558e+00,        -inf],
          [-8.8244e-02,  1.6527e+00,  2.5102e+00,  3.9274e+00]],

         [[-3.5499e-01,        -inf,        -inf,        -inf],
          [-1.5045e+00, -5.2404e+00,        -inf,        -inf],
          [ 4.4654e-01, -3.4974e-02, -2.9767e+00,        -inf],
          [ 1.3386e+00,  3.2672e-01,  1.5597e+00,  4.1395e-01]],

         [[-2.5293e+00,        -inf,        -inf,        -inf],
          [ 1.8127e-01, -4.8163e-01,        -inf,        -inf],
          [-6.2235e-01, -2.3152e+00,  2.8831e-01,        -inf],
          [ 3.1152e+00, -2.3199e+00, -6.7188e-02, -1.5231e+00]],

         [[ 2.3735e+00,        -inf,        -inf,        -inf],
          [-2.8321e-01,  7.3363e+00,        -inf,        -inf],
          [-7.9567e-01,  1.6407e+00,  1.4750e+00,        -inf],
          [-9.3256e-01, -6.5360e-01, -1.3813e+00, -3.4809e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.0746e+00,        -inf,        -inf,        -inf],
          [-2.5789e+00, -1.2924e+00,        -inf,        -inf],
          [ 2.2804e-01, -3.7929e+00,  6.8994e-01,        -inf],
          [-8.8282e-01, -6.0228e-01, -1.7496e+00, -6.4143e-01]],

         [[-3.2498e-01,        -inf,        -inf,        -inf],
          [-3.8764e+00,  6.1402e+00,        -inf,        -inf],
          [ 5.9960e-01,  1.3801e+00, -1.0205e+00,        -inf],
          [ 1.6227e+00,  3.2636e+00,  1.1493e+00,  5.5407e+00]],

         [[-9.8993e-01,        -inf,        -inf,        -inf],
          [-2.5578e+00, -2.5576e+00,        -inf,        -inf],
          [ 2.2887e+00, -3.8998e+00, -1.5383e+00,        -inf],
          [-7.6870e-01, -1.1360e+00,  2.4903e+00, -1.1236e+00]],

         [[ 3.5628e+00,        -inf,        -inf,        -inf],
          [ 3.2148e-01, -1.0148e+00,        -inf,        -inf],
          [-2.7999e+00, -2.4343e-01, -4.1163e-01,        -inf],
          [-5.4775e+00, -3.7443e+00,  8.0563e-01, -1.0732e+00]],

         [[ 7.0352e-01,        -inf,        -inf,        -inf],
          [-3.6951e+00, -4.9536e+00,        -inf,        -inf],
          [-2.6477e+00, -8.8109e-02, -5.5754e+00,        -inf],
          [ 1.1214e+00, -4.6953e-01,  1.6919e+00,  5.5957e+00]],

         [[ 2.0202e+00,        -inf,        -inf,        -inf],
          [-2.4703e+00,  4.4510e+00,        -inf,        -inf],
          [-8.6834e-01, -2.8114e+00, -2.0330e-01,        -inf],
          [ 3.1048e+00,  7.3317e-01, -9.7914e-01, -1.2951e+00]],

         [[-2.8479e+00,        -inf,        -inf,        -inf],
          [-1.0498e+00,  2.2682e+00,        -inf,        -inf],
          [ 2.4943e-02,  2.1787e+00,  4.5058e+00,        -inf],
          [-3.0418e+00, -3.8491e-01, -7.8785e-01,  5.9793e-01]],

         [[-2.5756e+00,        -inf,        -inf,        -inf],
          [-3.5625e-01, -5.1779e+00,        -inf,        -inf],
          [ 2.1065e+00, -1.3731e+00, -4.0820e+00,        -inf],
          [-5.2963e+00, -1.3099e+00,  3.5601e+00,  3.0104e+00]],

         [[-1.6325e+00,        -inf,        -inf,        -inf],
          [ 2.9695e+00,  3.9026e-01,        -inf,        -inf],
          [ 5.0804e+00,  4.1267e+00, -5.4049e-01,        -inf],
          [ 1.3390e+00, -8.5028e-01, -3.2855e-01, -1.9927e+00]],

         [[-7.3720e-01,        -inf,        -inf,        -inf],
          [-4.9387e+00,  8.6697e-01,        -inf,        -inf],
          [ 1.1958e-01,  1.4957e+00, -1.3322e+00,        -inf],
          [ 2.0696e+00,  3.3646e+00, -1.1677e-01,  2.9314e+00]],

         [[-1.9994e+00,        -inf,        -inf,        -inf],
          [-2.2391e+00, -6.1424e-02,        -inf,        -inf],
          [ 1.9456e+00,  2.1339e+00, -4.1504e+00,        -inf],
          [ 1.1051e+00, -2.4083e+00, -1.1993e+00, -4.2439e-01]],

         [[ 1.5891e+00,        -inf,        -inf,        -inf],
          [ 2.1018e+00,  1.0517e+00,        -inf,        -inf],
          [-1.8190e-01,  2.0792e+00, -3.6481e-01,        -inf],
          [-3.5170e+00,  3.0705e+00,  1.4172e+00, -1.6767e+00]]],


        [[[ 1.4146e-01,        -inf,        -inf,        -inf],
          [-4.8383e+00,  1.5527e+00,        -inf,        -inf],
          [ 4.1110e+00, -1.9365e+00, -5.6949e-01,        -inf],
          [ 1.1788e+00, -1.2417e+00, -5.7079e+00, -2.5675e+00]],

         [[ 3.1106e+00,        -inf,        -inf,        -inf],
          [-2.0967e+00, -8.7070e-01,        -inf,        -inf],
          [ 1.4773e+00, -2.2038e-03, -4.5570e+00,        -inf],
          [ 3.4676e+00,  3.5248e+00, -1.1017e+00,  3.5686e+00]],

         [[-3.6667e+00,        -inf,        -inf,        -inf],
          [-1.0234e+00,  6.7098e-03,        -inf,        -inf],
          [-5.5371e-02,  3.0655e+00, -5.3457e-01,        -inf],
          [ 8.0845e-01, -8.6114e-01,  1.5282e+00,  1.9601e+00]],

         [[ 6.5191e+00,        -inf,        -inf,        -inf],
          [-2.9400e+00, -2.5135e+00,        -inf,        -inf],
          [ 2.7785e+00,  5.0702e+00,  1.7416e+00,        -inf],
          [-1.4955e+00, -4.1814e+00,  2.8885e+00, -2.8576e+00]],

         [[-1.0753e+00,        -inf,        -inf,        -inf],
          [-1.3749e+00, -2.5105e+00,        -inf,        -inf],
          [ 4.6358e+00, -5.8086e-01,  1.1391e+00,        -inf],
          [ 2.8475e-01, -1.0498e+00, -1.5027e+00, -4.5262e+00]],

         [[ 1.5742e+00,        -inf,        -inf,        -inf],
          [-3.2858e+00, -1.5189e+00,        -inf,        -inf],
          [-5.8515e+00, -5.5856e-01, -6.5129e+00,        -inf],
          [-3.0761e+00, -3.3510e+00,  2.6535e-01,  2.6712e+00]],

         [[-1.1438e+00,        -inf,        -inf,        -inf],
          [-8.6451e-01,  2.6516e+00,        -inf,        -inf],
          [ 4.9731e-01,  1.0602e+00, -1.9128e+00,        -inf],
          [-1.0366e+00, -1.0582e+00, -7.1144e+00, -2.2463e+00]],

         [[-3.3090e+00,        -inf,        -inf,        -inf],
          [ 1.4872e+00,  3.4130e+00,        -inf,        -inf],
          [-1.2956e+00,  9.8029e-01, -1.3107e+00,        -inf],
          [-3.5714e-01,  8.2391e-02,  4.5844e+00,  2.1381e+00]],

         [[-1.8260e+00,        -inf,        -inf,        -inf],
          [ 2.8683e+00,  1.2111e+00,        -inf,        -inf],
          [ 1.0385e+00, -6.9050e-01,  1.5558e+00,        -inf],
          [-8.8244e-02,  1.6527e+00,  2.5102e+00,  3.9274e+00]],

         [[-3.5499e-01,        -inf,        -inf,        -inf],
          [-1.5045e+00, -5.2404e+00,        -inf,        -inf],
          [ 4.4654e-01, -3.4974e-02, -2.9767e+00,        -inf],
          [ 1.3386e+00,  3.2672e-01,  1.5597e+00,  4.1395e-01]],

         [[-2.5293e+00,        -inf,        -inf,        -inf],
          [ 1.8127e-01, -4.8163e-01,        -inf,        -inf],
          [-6.2235e-01, -2.3152e+00,  2.8831e-01,        -inf],
          [ 3.1152e+00, -2.3199e+00, -6.7188e-02, -1.5231e+00]],

         [[ 2.3735e+00,        -inf,        -inf,        -inf],
          [-2.8321e-01,  7.3363e+00,        -inf,        -inf],
          [-7.9567e-01,  1.6407e+00,  1.4750e+00,        -inf],
          [-9.3256e-01, -6.5360e-01, -1.3813e+00, -3.4809e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-8.1497e-01, -4.0100e-01,  5.5939e-02,  ...,  1.3350e-01,
            1.2131e+00, -4.4141e-01],
          [ 1.4113e-01, -1.0102e-01, -2.8648e-01,  ...,  3.0722e-01,
           -6.6449e-01, -5.9905e-01],
          [ 9.9535e-01, -1.1172e+00,  4.8923e-01,  ..., -1.1822e+00,
            4.3236e-01, -3.2114e-01],
          ...,
          [-6.3865e-01, -3.4076e-01, -1.5833e+00,  ..., -4.2023e-01,
           -3.2322e-01,  3.5096e-01],
          [-5.4477e-01,  1.9864e-01,  4.6934e-01,  ..., -5.6961e-01,
            2.8529e-01,  1.0354e+00],
          [ 5.1516e-02, -8.2223e-01,  5.8678e-02,  ...,  3.6014e-01,
           -8.0072e-01,  6.8027e-01]],

         [[-2.2078e-01,  1.2520e-01, -7.5799e-02,  ...,  2.2829e-01,
            6.7540e-01, -7.6128e-01],
          [-8.9779e-02, -1.5834e+00, -3.1784e-01,  ...,  1.6614e-01,
            1.8568e-01, -8.4402e-01],
          [ 5.5529e-01, -1.6832e+00,  1.1105e-01,  ..., -6.7011e-01,
            1.5144e-01, -5.3844e-01],
          ...,
          [ 2.5661e-01, -1.2023e-01, -7.9515e-01,  ...,  9.3999e-03,
            1.8332e-01, -2.6798e-02],
          [ 6.0830e-02, -8.0589e-02, -5.0791e-01,  ..., -5.9119e-01,
            3.1145e-01,  5.2524e-01],
          [ 2.9994e-01, -1.9932e-01, -2.5131e-01,  ...,  1.6637e-01,
           -2.1260e-01,  3.7118e-01]],

         [[ 2.2475e-02,  2.3199e-01, -1.2110e-01,  ..., -1.4619e-01,
            1.3031e-01, -7.0916e-01],
          [-1.1774e-02, -1.0268e+00, -4.4440e-01,  ...,  2.4500e-01,
            8.3013e-02, -6.4724e-01],
          [ 5.3480e-01, -1.3201e+00, -1.3557e-01,  ..., -9.0379e-01,
            3.4265e-01, -4.6440e-01],
          ...,
          [ 7.6515e-02, -1.3509e-01, -8.1710e-01,  ..., -7.3586e-04,
           -1.2887e-01,  1.5852e-01],
          [ 2.1463e-01, -1.2056e-01, -5.1479e-01,  ..., -2.4979e-01,
            1.3623e-01,  5.6171e-02],
          [ 4.1668e-01, -1.7484e-01, -2.3073e-01,  ..., -1.9842e-01,
           -2.7388e-01,  2.1880e-01]],

         [[ 3.5143e-02,  4.3720e-02,  6.2449e-02,  ...,  2.5189e-01,
            2.0654e-02, -5.7362e-01],
          [ 1.9675e-01, -9.7841e-02, -2.5414e-01,  ...,  3.0874e-02,
           -5.4543e-02, -4.4965e-01],
          [ 4.6145e-01, -1.2612e+00, -3.4073e-01,  ..., -7.1979e-01,
            2.2062e-01, -5.5121e-01],
          ...,
          [-2.0079e-02,  1.3990e-01, -5.8144e-01,  ..., -9.6642e-02,
            1.5546e-01,  2.5604e-01],
          [-1.2932e-01,  5.0002e-01, -1.3193e-01,  ..., -1.1956e-01,
           -2.2798e-02,  2.1439e-01],
          [ 2.3891e-01, -3.5476e-01, -1.1397e-01,  ..., -3.0604e-01,
           -2.5953e-01, -2.7757e-02]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-4.4511e-01,  8.9141e-03, -3.1321e-01,  ...,  2.2398e-01,
           -6.7195e-01, -4.8164e-01],
          [ 3.6910e-01, -1.0122e+00,  2.7602e-01,  ..., -8.4156e-01,
            6.7088e-01, -7.0610e-01],
          ...,
          [-4.3779e-01,  2.0560e-01, -2.5246e+00,  ..., -3.7469e-01,
           -7.4597e-01,  4.7878e-01],
          [-8.0142e-01,  4.0380e-02,  7.5694e-01,  ...,  1.1027e-01,
            9.0626e-01,  6.5033e-01],
          [-2.5466e-01, -3.0951e-01,  5.1180e-02,  ...,  1.6694e-01,
           -7.2563e-01,  9.0669e-01]],

         [[ 3.5965e-01, -5.7133e-01,  2.7265e-02,  ...,  5.7243e-01,
            3.8149e-01, -4.0977e-01],
          [-9.3661e-02, -1.3156e-01, -2.2045e-01,  ...,  2.1099e-01,
            3.8921e-01,  9.7894e-02],
          [ 3.1144e-01, -6.9369e-01, -1.4850e-01,  ..., -2.1744e-01,
            1.0105e+00, -8.8663e-01],
          ...,
          [-4.0417e-01, -1.0593e-01, -1.7512e+00,  ..., -3.6393e-01,
           -7.8590e-01, -1.4171e-02],
          [-6.2343e-01,  2.0552e-01,  3.0972e-01,  ...,  9.9339e-02,
            7.0010e-01,  2.4439e-01],
          [ 2.2749e-01, -1.6246e-01, -1.0543e+00,  ...,  5.6141e-01,
            4.1782e-01,  3.7664e-01]],

         [[-6.1440e-01, -1.1259e-01, -1.1758e-01,  ...,  2.1368e-01,
            2.7269e-01, -5.9675e-02],
          [-2.3198e-01, -1.6240e-01, -4.2299e-01,  ...,  2.4778e-01,
            1.9447e-01, -1.7575e-01],
          [ 2.8053e-01, -3.6531e-01,  6.2631e-02,  ..., -2.4060e-01,
            4.6945e-01, -4.4382e-01],
          ...,
          [-2.9856e-01, -7.0191e-02, -1.2523e+00,  ..., -4.6407e-01,
           -7.6186e-01, -3.0963e-01],
          [-5.9918e-01,  5.1306e-01, -4.3697e-02,  ...,  2.2931e-01,
            6.5968e-01,  3.0511e-01],
          [ 3.2563e-01, -1.4591e-01, -7.3529e-01,  ...,  3.2395e-01,
           -1.0431e-01,  5.9696e-01]],

         [[ 7.5115e-02, -3.3221e-01,  1.7315e-02,  ...,  3.5960e-01,
            1.7807e-01, -2.4498e-01],
          [-6.3758e-02,  2.7946e-02, -2.7013e-01,  ..., -6.7297e-03,
            1.3174e-02, -3.5661e-01],
          [ 4.3560e-01, -3.0218e-01, -2.1313e-01,  ..., -1.3943e-01,
            6.3121e-01, -6.1116e-01],
          ...,
          [-3.1627e-01, -8.8923e-02, -8.6193e-01,  ..., -2.3765e-01,
           -6.2791e-01, -4.3061e-01],
          [-2.5822e-01,  3.7173e-02,  2.8164e-01,  ...,  8.0380e-02,
            5.4733e-01,  2.1128e-01],
          [ 1.5478e-01,  7.4148e-02, -4.0881e-01,  ...,  3.2195e-01,
           -1.0187e-01,  5.3821e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.8150, -0.4010,  0.0559,  ...,  0.3601, -0.8007,  0.6803],
         [-0.2208,  0.1252, -0.0758,  ...,  0.1664, -0.2126,  0.3712],
         [ 0.0225,  0.2320, -0.1211,  ..., -0.1984, -0.2739,  0.2188],
         [ 0.0351,  0.0437,  0.0624,  ..., -0.3060, -0.2595, -0.0278]],

        [[ 0.0000,  0.0000,  0.0000,  ...,  0.1669, -0.7256,  0.9067],
         [ 0.3596, -0.5713,  0.0273,  ...,  0.5614,  0.4178,  0.3766],
         [-0.6144, -0.1126, -0.1176,  ...,  0.3239, -0.1043,  0.5970],
         [ 0.0751, -0.3322,  0.0173,  ...,  0.3219, -0.1019,  0.5382]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0713,  0.4604,  0.0645,  ..., -0.2704,  0.4455,  0.5729],
         [-0.0872, -0.0093,  0.1632,  ...,  0.1318,  0.3453,  0.2254],
         [-0.0980, -0.0351,  0.1957,  ..., -0.0981,  0.3985, -0.0521],
         [-0.2235, -0.0018,  0.3718,  ..., -0.3380,  0.2816, -0.0146]],

        [[ 0.0078,  0.3996,  0.2201,  ..., -0.1120,  1.0158,  0.3110],
         [-0.0387,  0.1200,  0.0659,  ..., -0.1182,  0.8333, -0.0090],
         [-0.0764,  0.0567,  0.5706,  ..., -0.1937,  0.6336,  0.1134],
         [ 0.0918,  0.2264,  0.3950,  ..., -0.1613,  0.5187,  0.1549]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-2.2649e+00,        -inf,        -inf,        -inf],
          [-9.5279e-01,  2.9034e+00,        -inf,        -inf],
          [-2.2288e+00, -1.9985e-01,  1.9558e+00,        -inf],
          [ 1.0521e+00, -4.1263e+00,  4.7156e-01, -5.7860e+00]],

         [[-2.9549e+00,        -inf,        -inf,        -inf],
          [-3.0652e+00,  2.4092e+00,        -inf,        -inf],
          [-4.8610e+00,  5.7441e-01,  1.4952e+00,        -inf],
          [-1.7191e+00,  2.2452e+00, -1.0157e+00,  4.8036e+00]],

         [[ 1.9368e+00,        -inf,        -inf,        -inf],
          [ 2.3215e+00, -1.4776e+00,        -inf,        -inf],
          [ 2.0419e-01,  7.6383e-01, -1.5977e+00,        -inf],
          [ 1.5587e+00, -2.7641e-01,  4.1262e-01,  1.5087e+00]],

         [[ 1.1592e+00,        -inf,        -inf,        -inf],
          [ 2.6035e-01, -1.3647e+00,        -inf,        -inf],
          [-5.4689e-02,  1.4186e+00,  2.6594e+00,        -inf],
          [ 2.2697e-01,  2.2487e-01,  1.7097e+00, -1.6039e+00]],

         [[-1.3902e+00,        -inf,        -inf,        -inf],
          [ 6.8786e-01, -2.6685e-01,        -inf,        -inf],
          [ 3.0503e-01,  8.3507e-01,  2.9071e+00,        -inf],
          [ 6.2105e+00, -1.5033e+00,  5.6845e+00,  3.6341e+00]],

         [[-2.2090e+00,        -inf,        -inf,        -inf],
          [-5.1225e+00, -5.1023e+00,        -inf,        -inf],
          [-2.0628e+00,  4.0193e+00,  2.5703e+00,        -inf],
          [ 2.2185e-01,  1.1228e+00,  8.1505e-01, -2.7245e+00]],

         [[ 2.2775e+00,        -inf,        -inf,        -inf],
          [ 1.2308e+00,  8.2963e-01,        -inf,        -inf],
          [-3.7119e+00,  1.2564e+00,  6.7219e-01,        -inf],
          [ 9.0505e-01,  4.5497e+00, -2.6713e-01, -1.4555e+00]],

         [[-2.7432e+00,        -inf,        -inf,        -inf],
          [ 3.7091e+00,  1.2617e+00,        -inf,        -inf],
          [ 3.2091e+00,  1.2602e+00,  3.2264e+00,        -inf],
          [ 1.0990e+00, -1.7175e+00,  7.7970e-01, -4.4729e-01]],

         [[ 3.5241e+00,        -inf,        -inf,        -inf],
          [-4.4592e+00,  4.8195e+00,        -inf,        -inf],
          [-1.0345e+00,  1.2601e+00, -2.4697e+00,        -inf],
          [-3.4906e+00, -1.1298e+00, -2.9437e-01, -3.7634e+00]],

         [[-1.0422e-01,        -inf,        -inf,        -inf],
          [ 3.8818e+00,  1.1550e+00,        -inf,        -inf],
          [-7.0487e-01,  3.0572e+00, -3.8056e+00,        -inf],
          [ 1.4623e-01,  1.9393e+00,  2.0725e+00,  6.5409e-01]],

         [[-3.8900e+00,        -inf,        -inf,        -inf],
          [ 2.2177e+00,  6.3258e+00,        -inf,        -inf],
          [ 2.9734e+00,  2.0457e+00,  5.5043e-02,        -inf],
          [-9.8771e-01,  1.1115e+00,  2.0623e+00,  1.9920e+00]],

         [[ 3.7846e+00,        -inf,        -inf,        -inf],
          [-1.9621e+00, -6.4031e+00,        -inf,        -inf],
          [-1.0863e+00, -5.3608e-01,  2.4201e+00,        -inf],
          [ 2.2519e+00,  1.4930e+00,  2.2494e+00, -1.7536e+00]]],


        [[[-3.6742e+00,        -inf,        -inf,        -inf],
          [-5.5524e+00,  1.0689e-01,        -inf,        -inf],
          [-1.2766e+00, -4.2550e-01,  3.0553e-01,        -inf],
          [ 4.9540e+00, -3.2512e+00,  9.2564e-01, -2.8757e+00]],

         [[-5.1500e+00,        -inf,        -inf,        -inf],
          [-1.1093e+00,  3.4965e+00,        -inf,        -inf],
          [-2.7052e-01, -4.6372e-01,  3.3137e+00,        -inf],
          [ 1.1516e+00, -5.1123e+00, -1.3946e+00,  2.2872e-02]],

         [[ 1.9564e-01,        -inf,        -inf,        -inf],
          [ 4.7760e-01,  8.5280e-01,        -inf,        -inf],
          [ 1.1643e+00, -3.0295e-02,  4.5937e-01,        -inf],
          [ 6.3561e-01, -6.0810e+00, -1.6188e+00, -2.2700e+00]],

         [[ 1.5965e+00,        -inf,        -inf,        -inf],
          [-1.2266e+00, -3.0019e+00,        -inf,        -inf],
          [ 1.2728e-01,  9.4897e-01, -2.2912e-02,        -inf],
          [-1.9271e+00,  5.1063e-01,  1.9616e+00,  2.5404e+00]],

         [[-2.0774e+00,        -inf,        -inf,        -inf],
          [-2.6009e+00,  2.2050e+00,        -inf,        -inf],
          [ 4.0363e+00,  2.5055e+00,  1.0174e+00,        -inf],
          [ 1.5630e+00, -1.1708e+00, -3.0914e+00,  7.1177e-02]],

         [[-1.6862e-01,        -inf,        -inf,        -inf],
          [-3.1127e+00,  1.6161e+00,        -inf,        -inf],
          [ 1.3773e+00,  3.0902e+00,  1.7134e+00,        -inf],
          [-5.0223e-01,  1.2764e+00, -4.3590e+00,  5.7233e-01]],

         [[-1.3147e+00,        -inf,        -inf,        -inf],
          [-7.6959e-01, -7.4938e-03,        -inf,        -inf],
          [-4.1741e-02, -9.3716e-01,  1.2799e+00,        -inf],
          [-2.9835e+00, -2.6452e-01,  4.5855e+00,  3.4967e-01]],

         [[-1.8700e+00,        -inf,        -inf,        -inf],
          [ 5.1492e+00,  1.6225e+00,        -inf,        -inf],
          [ 3.6023e-01, -4.4809e+00,  5.7577e+00,        -inf],
          [ 1.6255e+00,  7.9071e+00,  1.2230e+00,  1.6057e+00]],

         [[ 3.1085e+00,        -inf,        -inf,        -inf],
          [ 1.8520e+00, -1.5563e+00,        -inf,        -inf],
          [ 7.5832e-01,  2.9464e-01, -1.0920e+00,        -inf],
          [-1.9074e-01, -4.1018e+00, -2.6841e+00, -6.6746e-01]],

         [[ 1.9448e+00,        -inf,        -inf,        -inf],
          [ 3.0598e+00,  2.4027e+00,        -inf,        -inf],
          [-1.0502e+00, -2.7349e+00, -5.7050e+00,        -inf],
          [ 5.4279e-02, -8.1684e-01, -4.0390e+00, -7.0224e-01]],

         [[-1.1025e+00,        -inf,        -inf,        -inf],
          [ 5.1644e+00, -2.4212e+00,        -inf,        -inf],
          [ 3.3192e+00,  1.7181e+00,  2.5586e+00,        -inf],
          [ 1.2694e-01, -2.0448e+00,  2.7440e+00,  6.5509e-01]],

         [[ 3.2675e+00,        -inf,        -inf,        -inf],
          [ 8.9580e-01, -1.7093e+00,        -inf,        -inf],
          [ 4.4545e+00, -3.8981e-01, -1.9215e+00,        -inf],
          [ 2.7543e+00,  2.7671e+00, -1.2239e+00, -1.8569e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-2.2649e+00,        -inf,        -inf,        -inf],
          [-9.5279e-01,  2.9034e+00,        -inf,        -inf],
          [-2.2288e+00, -1.9985e-01,  1.9558e+00,        -inf],
          [ 1.0521e+00, -4.1263e+00,  4.7156e-01, -5.7860e+00]],

         [[-2.9549e+00,        -inf,        -inf,        -inf],
          [-3.0652e+00,  2.4092e+00,        -inf,        -inf],
          [-4.8610e+00,  5.7441e-01,  1.4952e+00,        -inf],
          [-1.7191e+00,  2.2452e+00, -1.0157e+00,  4.8036e+00]],

         [[ 1.9368e+00,        -inf,        -inf,        -inf],
          [ 2.3215e+00, -1.4776e+00,        -inf,        -inf],
          [ 2.0419e-01,  7.6383e-01, -1.5977e+00,        -inf],
          [ 1.5587e+00, -2.7641e-01,  4.1262e-01,  1.5087e+00]],

         [[ 1.1592e+00,        -inf,        -inf,        -inf],
          [ 2.6035e-01, -1.3647e+00,        -inf,        -inf],
          [-5.4689e-02,  1.4186e+00,  2.6594e+00,        -inf],
          [ 2.2697e-01,  2.2487e-01,  1.7097e+00, -1.6039e+00]],

         [[-1.3902e+00,        -inf,        -inf,        -inf],
          [ 6.8786e-01, -2.6685e-01,        -inf,        -inf],
          [ 3.0503e-01,  8.3507e-01,  2.9071e+00,        -inf],
          [ 6.2105e+00, -1.5033e+00,  5.6845e+00,  3.6341e+00]],

         [[-2.2090e+00,        -inf,        -inf,        -inf],
          [-5.1225e+00, -5.1023e+00,        -inf,        -inf],
          [-2.0628e+00,  4.0193e+00,  2.5703e+00,        -inf],
          [ 2.2185e-01,  1.1228e+00,  8.1505e-01, -2.7245e+00]],

         [[ 2.2775e+00,        -inf,        -inf,        -inf],
          [ 1.2308e+00,  8.2963e-01,        -inf,        -inf],
          [-3.7119e+00,  1.2564e+00,  6.7219e-01,        -inf],
          [ 9.0505e-01,  4.5497e+00, -2.6713e-01, -1.4555e+00]],

         [[-2.7432e+00,        -inf,        -inf,        -inf],
          [ 3.7091e+00,  1.2617e+00,        -inf,        -inf],
          [ 3.2091e+00,  1.2602e+00,  3.2264e+00,        -inf],
          [ 1.0990e+00, -1.7175e+00,  7.7970e-01, -4.4729e-01]],

         [[ 3.5241e+00,        -inf,        -inf,        -inf],
          [-4.4592e+00,  4.8195e+00,        -inf,        -inf],
          [-1.0345e+00,  1.2601e+00, -2.4697e+00,        -inf],
          [-3.4906e+00, -1.1298e+00, -2.9437e-01, -3.7634e+00]],

         [[-1.0422e-01,        -inf,        -inf,        -inf],
          [ 3.8818e+00,  1.1550e+00,        -inf,        -inf],
          [-7.0487e-01,  3.0572e+00, -3.8056e+00,        -inf],
          [ 1.4623e-01,  1.9393e+00,  2.0725e+00,  6.5409e-01]],

         [[-3.8900e+00,        -inf,        -inf,        -inf],
          [ 2.2177e+00,  6.3258e+00,        -inf,        -inf],
          [ 2.9734e+00,  2.0457e+00,  5.5043e-02,        -inf],
          [-9.8771e-01,  1.1115e+00,  2.0623e+00,  1.9920e+00]],

         [[ 3.7846e+00,        -inf,        -inf,        -inf],
          [-1.9621e+00, -6.4031e+00,        -inf,        -inf],
          [-1.0863e+00, -5.3608e-01,  2.4201e+00,        -inf],
          [ 2.2519e+00,  1.4930e+00,  2.2494e+00, -1.7536e+00]]],


        [[[-3.6742e+00,        -inf,        -inf,        -inf],
          [-5.5524e+00,  1.0689e-01,        -inf,        -inf],
          [-1.2766e+00, -4.2550e-01,  3.0553e-01,        -inf],
          [ 4.9540e+00, -3.2512e+00,  9.2564e-01, -2.8757e+00]],

         [[-5.1500e+00,        -inf,        -inf,        -inf],
          [-1.1093e+00,  3.4965e+00,        -inf,        -inf],
          [-2.7052e-01, -4.6372e-01,  3.3137e+00,        -inf],
          [ 1.1516e+00, -5.1123e+00, -1.3946e+00,  2.2872e-02]],

         [[ 1.9564e-01,        -inf,        -inf,        -inf],
          [ 4.7760e-01,  8.5280e-01,        -inf,        -inf],
          [ 1.1643e+00, -3.0295e-02,  4.5937e-01,        -inf],
          [ 6.3561e-01, -6.0810e+00, -1.6188e+00, -2.2700e+00]],

         [[ 1.5965e+00,        -inf,        -inf,        -inf],
          [-1.2266e+00, -3.0019e+00,        -inf,        -inf],
          [ 1.2728e-01,  9.4897e-01, -2.2912e-02,        -inf],
          [-1.9271e+00,  5.1063e-01,  1.9616e+00,  2.5404e+00]],

         [[-2.0774e+00,        -inf,        -inf,        -inf],
          [-2.6009e+00,  2.2050e+00,        -inf,        -inf],
          [ 4.0363e+00,  2.5055e+00,  1.0174e+00,        -inf],
          [ 1.5630e+00, -1.1708e+00, -3.0914e+00,  7.1177e-02]],

         [[-1.6862e-01,        -inf,        -inf,        -inf],
          [-3.1127e+00,  1.6161e+00,        -inf,        -inf],
          [ 1.3773e+00,  3.0902e+00,  1.7134e+00,        -inf],
          [-5.0223e-01,  1.2764e+00, -4.3590e+00,  5.7233e-01]],

         [[-1.3147e+00,        -inf,        -inf,        -inf],
          [-7.6959e-01, -7.4938e-03,        -inf,        -inf],
          [-4.1741e-02, -9.3716e-01,  1.2799e+00,        -inf],
          [-2.9835e+00, -2.6452e-01,  4.5855e+00,  3.4967e-01]],

         [[-1.8700e+00,        -inf,        -inf,        -inf],
          [ 5.1492e+00,  1.6225e+00,        -inf,        -inf],
          [ 3.6023e-01, -4.4809e+00,  5.7577e+00,        -inf],
          [ 1.6255e+00,  7.9071e+00,  1.2230e+00,  1.6057e+00]],

         [[ 3.1085e+00,        -inf,        -inf,        -inf],
          [ 1.8520e+00, -1.5563e+00,        -inf,        -inf],
          [ 7.5832e-01,  2.9464e-01, -1.0920e+00,        -inf],
          [-1.9074e-01, -4.1018e+00, -2.6841e+00, -6.6746e-01]],

         [[ 1.9448e+00,        -inf,        -inf,        -inf],
          [ 3.0598e+00,  2.4027e+00,        -inf,        -inf],
          [-1.0502e+00, -2.7349e+00, -5.7050e+00,        -inf],
          [ 5.4279e-02, -8.1684e-01, -4.0390e+00, -7.0224e-01]],

         [[-1.1025e+00,        -inf,        -inf,        -inf],
          [ 5.1644e+00, -2.4212e+00,        -inf,        -inf],
          [ 3.3192e+00,  1.7181e+00,  2.5586e+00,        -inf],
          [ 1.2694e-01, -2.0448e+00,  2.7440e+00,  6.5509e-01]],

         [[ 3.2675e+00,        -inf,        -inf,        -inf],
          [ 8.9580e-01, -1.7093e+00,        -inf,        -inf],
          [ 4.4545e+00, -3.8981e-01, -1.9215e+00,        -inf],
          [ 2.7543e+00,  2.7671e+00, -1.2239e+00, -1.8569e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.5940,  0.5550, -0.1295,  ...,  0.5362,  0.6059,  0.3122],
          [-0.3836,  0.2356, -0.1200,  ...,  0.0676, -0.1557,  0.5968],
          [-0.4584,  0.4934, -0.3892,  ...,  0.1103, -0.3908, -1.3123],
          ...,
          [-0.7716,  0.4370, -0.6038,  ...,  0.3668,  0.7628, -1.1391],
          [-0.1520, -0.0302, -0.7869,  ...,  0.4342, -0.4298,  0.2858],
          [ 0.0168,  0.7825, -0.2992,  ...,  0.2533,  0.4120,  0.3745]],

         [[-0.5191, -0.2963,  0.8617,  ..., -0.5481, -0.0675, -0.3940],
          [-0.1286,  0.0790, -0.0402,  ...,  0.0227, -0.0522,  0.2001],
          [-0.2826,  0.3042, -0.2399,  ...,  0.0680, -0.2409, -0.8091],
          ...,
          [-0.4509,  0.2554, -0.3529,  ...,  0.2144,  0.4458, -0.6657],
          [ 0.1165, -0.1529,  0.4298,  ...,  0.6436, -0.5641, -0.0685],
          [ 0.2417,  0.0520,  0.3753,  ..., -0.0622,  0.1812,  0.2150]],

         [[-0.2306, -0.0052,  0.1400,  ..., -0.2986,  0.1087, -0.2422],
          [-0.1631, -0.7987, -0.6040,  ...,  0.9464,  0.1542,  0.8029],
          [-0.0722,  0.3188, -0.0835,  ...,  0.1087,  0.1503, -0.3679],
          ...,
          [ 0.0164, -0.0356, -0.4914,  ..., -0.1200,  0.3357, -0.5746],
          [ 0.0411,  0.0283,  0.0195,  ...,  0.6942, -0.4264,  0.0174],
          [ 0.3140,  0.7361,  0.2523,  ...,  0.2347,  0.3518,  0.0919]],

         [[-0.2065,  0.0729,  0.1216,  ..., -0.1852,  0.3315, -0.4128],
          [-0.3243, -0.5238, -0.4280,  ...,  0.5092,  0.0773,  0.3144],
          [-0.0461,  0.2448, -0.0765,  ...,  0.0618,  0.1332, -0.2894],
          ...,
          [-0.0985,  0.1545, -0.5807,  ..., -0.0129,  0.3838, -0.4883],
          [ 0.2689,  0.0540, -0.1303,  ...,  0.8175, -0.1715,  0.0427],
          [ 0.2562,  0.5535, -0.0358,  ...,  0.2633,  0.4131,  0.0635]]],


        [[[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0788,  0.1890,  0.1803,  ...,  0.8017,  0.3090,  0.6347],
          [-0.0874,  0.5135,  0.4741,  ...,  0.4887, -1.2324, -0.8173],
          ...,
          [-0.5356,  0.0572, -0.6358,  ...,  0.2735,  0.9765, -1.1701],
          [-0.3696,  0.2072, -0.1760,  ...,  0.1880, -0.7036, -0.4211],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[ 0.1896, -0.2118,  0.1381,  ...,  0.2405, -0.6512,  0.6870],
          [-0.5119, -0.3116, -0.1823,  ...,  0.5133,  0.6230, -0.0228],
          [ 0.1185,  0.9118,  0.6299,  ...,  0.6222, -0.7078, -0.3744],
          ...,
          [-0.2105,  0.2730, -0.2835,  ..., -0.1354,  0.5089, -0.9159],
          [-0.2664,  0.1493, -0.1269,  ...,  0.1355, -0.5071, -0.3035],
          [ 0.2275,  0.0529,  0.6924,  ..., -0.1441, -0.0533,  0.6650]],

         [[ 0.0679, -0.2179, -0.1871,  ...,  0.0391, -0.2748,  0.5687],
          [-0.2104, -0.1101, -0.0556,  ...,  0.3232,  0.3077,  0.0710],
          [ 0.0137,  0.5132,  0.9236,  ...,  0.2340, -0.3818,  0.1772],
          ...,
          [-0.1382,  0.1980, -0.3459,  ..., -0.2541,  0.4438, -0.9075],
          [-0.4351,  0.0886, -0.1014,  ...,  0.3372, -0.6811, -0.1068],
          [ 0.1606, -0.0414,  0.5241,  ..., -0.0149,  0.0501,  0.5315]],

         [[ 0.1934, -0.0606,  0.1045,  ...,  0.0655, -0.2097,  0.3054],
          [-0.1739,  0.0768, -0.2874,  ...,  0.5966,  0.3373,  0.2116],
          [ 0.0165,  0.0706,  0.5337,  ...,  0.3272, -0.0337, -0.0156],
          ...,
          [ 0.0417,  0.1387,  0.1162,  ..., -0.3805,  0.0553, -0.3237],
          [-0.5762,  0.0139, -0.1279,  ...,  0.5565, -0.4328, -0.2199],
          [ 0.2881, -0.1095,  0.4447,  ...,  0.0475,  0.0419,  0.5465]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.5940,  0.5550, -0.1295,  ...,  0.2533,  0.4120,  0.3745],
         [-0.5191, -0.2963,  0.8617,  ..., -0.0622,  0.1812,  0.2150],
         [-0.2306, -0.0052,  0.1400,  ...,  0.2347,  0.3518,  0.0919],
         [-0.2065,  0.0729,  0.1216,  ...,  0.2633,  0.4131,  0.0635]],

        [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
         [ 0.1896, -0.2118,  0.1381,  ..., -0.1441, -0.0533,  0.6650],
         [ 0.0679, -0.2179, -0.1871,  ..., -0.0149,  0.0501,  0.5315],
         [ 0.1934, -0.0606,  0.1045,  ...,  0.0475,  0.0419,  0.5465]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1152, -0.2685,  0.2787,  ..., -0.5502,  0.0731, -0.0525],
         [-0.1496, -0.5084,  0.2692,  ..., -0.3619,  0.4763,  0.4017],
         [-0.1979, -0.2949,  0.1031,  ..., -0.4337,  0.3496,  0.2197],
         [ 0.0920, -0.2281,  0.2940,  ..., -0.3336,  0.4065,  0.2086]],

        [[ 0.3272,  0.0526,  0.4667,  ..., -0.7637,  0.0053, -0.0224],
         [-0.2907, -0.1114,  0.4582,  ..., -0.4840, -0.0230,  0.2908],
         [-0.2005, -0.2003,  0.4403,  ..., -0.4175,  0.1808,  0.1394],
         [-0.2599,  0.0645,  0.3968,  ..., -0.2516,  0.1845,  0.1915]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.6189e+00,        -inf,        -inf,        -inf],
          [ 4.4953e-01,  1.9552e+00,        -inf,        -inf],
          [ 1.1909e+00,  3.6447e+00,  1.4955e+00,        -inf],
          [ 5.7974e-01,  5.3700e+00, -1.7670e+00,  1.9004e-01]],

         [[ 2.6059e+00,        -inf,        -inf,        -inf],
          [ 1.2617e+00, -4.8706e+00,        -inf,        -inf],
          [-6.2719e-01, -2.0062e+00,  1.4037e-01,        -inf],
          [ 4.2623e+00,  3.5798e-03, -6.3883e-01, -1.5799e+00]],

         [[-1.6829e+00,        -inf,        -inf,        -inf],
          [ 4.0870e+00,  4.1752e+00,        -inf,        -inf],
          [ 2.2432e+00,  8.5565e-01, -7.9440e-01,        -inf],
          [-2.8631e+00,  2.3332e+00, -2.3475e+00, -1.9564e+00]],

         [[ 4.5737e+00,        -inf,        -inf,        -inf],
          [ 3.4541e-01, -2.6063e+00,        -inf,        -inf],
          [-1.2016e+00,  9.8496e-01, -3.1123e+00,        -inf],
          [ 1.1805e+00,  8.7758e-02, -1.9823e+00,  1.9651e+00]],

         [[ 1.9767e+00,        -inf,        -inf,        -inf],
          [-8.9040e-02, -9.8387e-01,        -inf,        -inf],
          [-1.6276e-01, -4.0603e+00,  1.8640e+00,        -inf],
          [-3.6669e+00, -1.6168e+00,  6.2705e+00,  1.1711e+00]],

         [[ 1.9429e+00,        -inf,        -inf,        -inf],
          [ 1.4129e-01,  1.1341e+00,        -inf,        -inf],
          [ 8.6347e-01, -1.4329e+00,  8.9366e-01,        -inf],
          [-1.9044e+00, -1.1160e+00, -1.1320e+00,  7.0526e-01]],

         [[ 1.4649e+00,        -inf,        -inf,        -inf],
          [ 5.9878e+00,  2.7194e+00,        -inf,        -inf],
          [ 2.4676e-01, -4.9130e-01,  1.8046e+00,        -inf],
          [ 7.9314e-01,  9.4037e-01, -7.0518e-01, -6.4119e-01]],

         [[ 3.3562e-01,        -inf,        -inf,        -inf],
          [-3.0363e+00, -5.7952e+00,        -inf,        -inf],
          [-4.4205e+00, -3.7917e+00, -2.3733e+00,        -inf],
          [-6.8773e-01, -2.8946e+00, -1.3115e+00, -1.9684e+00]],

         [[-1.1349e+00,        -inf,        -inf,        -inf],
          [ 4.9894e-01,  2.4553e+00,        -inf,        -inf],
          [ 1.5860e+00, -5.8544e-01, -3.9129e+00,        -inf],
          [-3.1764e-01, -2.4154e+00, -1.2878e-01, -2.1520e-01]],

         [[-5.8450e+00,        -inf,        -inf,        -inf],
          [-1.5245e+00,  2.4337e+00,        -inf,        -inf],
          [-1.8918e+00, -2.9280e-01,  3.5060e+00,        -inf],
          [ 2.0102e+00,  2.8628e+00,  3.6087e+00,  3.2449e+00]],

         [[-3.4844e+00,        -inf,        -inf,        -inf],
          [ 1.3943e+00,  1.1780e+00,        -inf,        -inf],
          [-1.8558e+00, -3.6508e+00, -1.3628e+00,        -inf],
          [-2.8166e-01,  2.7157e-01,  9.4826e-01, -8.9900e-01]],

         [[-2.9494e+00,        -inf,        -inf,        -inf],
          [-1.7065e+00,  3.2588e+00,        -inf,        -inf],
          [-2.3610e+00, -9.7744e-01,  2.5832e+00,        -inf],
          [-2.3432e-01,  5.8418e+00,  1.6816e+00,  9.4587e-01]]],


        [[[ 1.6895e-03,        -inf,        -inf,        -inf],
          [-1.4085e-01, -4.1196e-01,        -inf,        -inf],
          [ 2.0510e+00,  5.0268e+00,  1.3722e+00,        -inf],
          [-8.6619e-01, -2.7767e-01, -4.9839e+00,  1.1474e+00]],

         [[ 3.4012e+00,        -inf,        -inf,        -inf],
          [ 4.0663e+00,  4.9250e+00,        -inf,        -inf],
          [-2.0074e+00,  1.0854e+00,  5.6960e+00,        -inf],
          [ 2.1158e+00,  3.8117e+00,  2.0721e+00,  2.0214e+00]],

         [[ 2.4538e+00,        -inf,        -inf,        -inf],
          [ 9.2453e-01,  2.2134e+00,        -inf,        -inf],
          [ 5.2423e+00,  1.2306e+00,  3.3404e+00,        -inf],
          [ 1.4024e+00,  8.6052e-01, -1.5621e+00,  3.7134e+00]],

         [[ 4.4810e+00,        -inf,        -inf,        -inf],
          [ 2.3225e+00, -3.1972e+00,        -inf,        -inf],
          [-2.4791e+00,  4.5002e+00,  5.1117e-01,        -inf],
          [ 1.8409e-01,  3.1810e+00,  1.2551e+00,  3.6472e+00]],

         [[-2.7486e-01,        -inf,        -inf,        -inf],
          [-3.0311e+00, -6.3068e-01,        -inf,        -inf],
          [-2.2085e+00, -2.3168e+00,  3.2186e+00,        -inf],
          [-2.2993e+00,  3.6398e+00,  4.7364e+00, -8.5439e-01]],

         [[ 1.6262e+00,        -inf,        -inf,        -inf],
          [-9.9326e-01, -3.5577e+00,        -inf,        -inf],
          [-1.6899e+00, -1.8966e+00,  2.9280e+00,        -inf],
          [-1.1893e+00,  1.3074e+00, -5.1003e-01, -1.8101e+00]],

         [[ 1.8163e+00,        -inf,        -inf,        -inf],
          [ 4.8406e+00,  1.6475e+00,        -inf,        -inf],
          [-2.9952e-01,  3.1628e+00,  1.6793e-01,        -inf],
          [ 3.9668e-01, -4.0348e-01, -1.1459e+00,  3.8817e+00]],

         [[ 1.9865e+00,        -inf,        -inf,        -inf],
          [ 6.5138e+00,  5.7461e+00,        -inf,        -inf],
          [-1.4513e+00,  4.9902e+00,  5.2500e+00,        -inf],
          [ 3.6170e+00,  4.8645e+00,  3.1038e+00, -3.4643e-01]],

         [[ 3.1462e+00,        -inf,        -inf,        -inf],
          [-2.0962e+00, -1.3915e+00,        -inf,        -inf],
          [ 2.4950e+00, -1.7676e+00, -8.0627e-01,        -inf],
          [-4.1996e+00, -8.1802e-01,  1.5232e+00,  2.8676e+00]],

         [[-3.9095e+00,        -inf,        -inf,        -inf],
          [ 1.5092e+00, -1.8861e-01,        -inf,        -inf],
          [-2.3167e+00,  3.1627e+00,  3.7436e-02,        -inf],
          [-1.7613e+00,  3.2616e+00,  2.0962e+00,  1.1410e+00]],

         [[-1.3609e+00,        -inf,        -inf,        -inf],
          [-4.2762e+00, -2.3101e+00,        -inf,        -inf],
          [-1.1872e+00, -2.7749e+00,  3.0883e+00,        -inf],
          [-2.9464e+00, -3.0408e+00,  2.1010e-01,  1.3417e+00]],

         [[ 3.7450e-01,        -inf,        -inf,        -inf],
          [-2.5376e-01,  2.7331e+00,        -inf,        -inf],
          [ 2.8536e+00,  3.1506e+00,  4.4873e+00,        -inf],
          [ 1.9661e+00, -2.4854e+00, -1.8820e+00, -3.5090e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.6189e+00,        -inf,        -inf,        -inf],
          [ 4.4953e-01,  1.9552e+00,        -inf,        -inf],
          [ 1.1909e+00,  3.6447e+00,  1.4955e+00,        -inf],
          [ 5.7974e-01,  5.3700e+00, -1.7670e+00,  1.9004e-01]],

         [[ 2.6059e+00,        -inf,        -inf,        -inf],
          [ 1.2617e+00, -4.8706e+00,        -inf,        -inf],
          [-6.2719e-01, -2.0062e+00,  1.4037e-01,        -inf],
          [ 4.2623e+00,  3.5798e-03, -6.3883e-01, -1.5799e+00]],

         [[-1.6829e+00,        -inf,        -inf,        -inf],
          [ 4.0870e+00,  4.1752e+00,        -inf,        -inf],
          [ 2.2432e+00,  8.5565e-01, -7.9440e-01,        -inf],
          [-2.8631e+00,  2.3332e+00, -2.3475e+00, -1.9564e+00]],

         [[ 4.5737e+00,        -inf,        -inf,        -inf],
          [ 3.4541e-01, -2.6063e+00,        -inf,        -inf],
          [-1.2016e+00,  9.8496e-01, -3.1123e+00,        -inf],
          [ 1.1805e+00,  8.7758e-02, -1.9823e+00,  1.9651e+00]],

         [[ 1.9767e+00,        -inf,        -inf,        -inf],
          [-8.9040e-02, -9.8387e-01,        -inf,        -inf],
          [-1.6276e-01, -4.0603e+00,  1.8640e+00,        -inf],
          [-3.6669e+00, -1.6168e+00,  6.2705e+00,  1.1711e+00]],

         [[ 1.9429e+00,        -inf,        -inf,        -inf],
          [ 1.4129e-01,  1.1341e+00,        -inf,        -inf],
          [ 8.6347e-01, -1.4329e+00,  8.9366e-01,        -inf],
          [-1.9044e+00, -1.1160e+00, -1.1320e+00,  7.0526e-01]],

         [[ 1.4649e+00,        -inf,        -inf,        -inf],
          [ 5.9878e+00,  2.7194e+00,        -inf,        -inf],
          [ 2.4676e-01, -4.9130e-01,  1.8046e+00,        -inf],
          [ 7.9314e-01,  9.4037e-01, -7.0518e-01, -6.4119e-01]],

         [[ 3.3562e-01,        -inf,        -inf,        -inf],
          [-3.0363e+00, -5.7952e+00,        -inf,        -inf],
          [-4.4205e+00, -3.7917e+00, -2.3733e+00,        -inf],
          [-6.8773e-01, -2.8946e+00, -1.3115e+00, -1.9684e+00]],

         [[-1.1349e+00,        -inf,        -inf,        -inf],
          [ 4.9894e-01,  2.4553e+00,        -inf,        -inf],
          [ 1.5860e+00, -5.8544e-01, -3.9129e+00,        -inf],
          [-3.1764e-01, -2.4154e+00, -1.2878e-01, -2.1520e-01]],

         [[-5.8450e+00,        -inf,        -inf,        -inf],
          [-1.5245e+00,  2.4337e+00,        -inf,        -inf],
          [-1.8918e+00, -2.9280e-01,  3.5060e+00,        -inf],
          [ 2.0102e+00,  2.8628e+00,  3.6087e+00,  3.2449e+00]],

         [[-3.4844e+00,        -inf,        -inf,        -inf],
          [ 1.3943e+00,  1.1780e+00,        -inf,        -inf],
          [-1.8558e+00, -3.6508e+00, -1.3628e+00,        -inf],
          [-2.8166e-01,  2.7157e-01,  9.4826e-01, -8.9900e-01]],

         [[-2.9494e+00,        -inf,        -inf,        -inf],
          [-1.7065e+00,  3.2588e+00,        -inf,        -inf],
          [-2.3610e+00, -9.7744e-01,  2.5832e+00,        -inf],
          [-2.3432e-01,  5.8418e+00,  1.6816e+00,  9.4587e-01]]],


        [[[ 1.6895e-03,        -inf,        -inf,        -inf],
          [-1.4085e-01, -4.1196e-01,        -inf,        -inf],
          [ 2.0510e+00,  5.0268e+00,  1.3722e+00,        -inf],
          [-8.6619e-01, -2.7767e-01, -4.9839e+00,  1.1474e+00]],

         [[ 3.4012e+00,        -inf,        -inf,        -inf],
          [ 4.0663e+00,  4.9250e+00,        -inf,        -inf],
          [-2.0074e+00,  1.0854e+00,  5.6960e+00,        -inf],
          [ 2.1158e+00,  3.8117e+00,  2.0721e+00,  2.0214e+00]],

         [[ 2.4538e+00,        -inf,        -inf,        -inf],
          [ 9.2453e-01,  2.2134e+00,        -inf,        -inf],
          [ 5.2423e+00,  1.2306e+00,  3.3404e+00,        -inf],
          [ 1.4024e+00,  8.6052e-01, -1.5621e+00,  3.7134e+00]],

         [[ 4.4810e+00,        -inf,        -inf,        -inf],
          [ 2.3225e+00, -3.1972e+00,        -inf,        -inf],
          [-2.4791e+00,  4.5002e+00,  5.1117e-01,        -inf],
          [ 1.8409e-01,  3.1810e+00,  1.2551e+00,  3.6472e+00]],

         [[-2.7486e-01,        -inf,        -inf,        -inf],
          [-3.0311e+00, -6.3068e-01,        -inf,        -inf],
          [-2.2085e+00, -2.3168e+00,  3.2186e+00,        -inf],
          [-2.2993e+00,  3.6398e+00,  4.7364e+00, -8.5439e-01]],

         [[ 1.6262e+00,        -inf,        -inf,        -inf],
          [-9.9326e-01, -3.5577e+00,        -inf,        -inf],
          [-1.6899e+00, -1.8966e+00,  2.9280e+00,        -inf],
          [-1.1893e+00,  1.3074e+00, -5.1003e-01, -1.8101e+00]],

         [[ 1.8163e+00,        -inf,        -inf,        -inf],
          [ 4.8406e+00,  1.6475e+00,        -inf,        -inf],
          [-2.9952e-01,  3.1628e+00,  1.6793e-01,        -inf],
          [ 3.9668e-01, -4.0348e-01, -1.1459e+00,  3.8817e+00]],

         [[ 1.9865e+00,        -inf,        -inf,        -inf],
          [ 6.5138e+00,  5.7461e+00,        -inf,        -inf],
          [-1.4513e+00,  4.9902e+00,  5.2500e+00,        -inf],
          [ 3.6170e+00,  4.8645e+00,  3.1038e+00, -3.4643e-01]],

         [[ 3.1462e+00,        -inf,        -inf,        -inf],
          [-2.0962e+00, -1.3915e+00,        -inf,        -inf],
          [ 2.4950e+00, -1.7676e+00, -8.0627e-01,        -inf],
          [-4.1996e+00, -8.1802e-01,  1.5232e+00,  2.8676e+00]],

         [[-3.9095e+00,        -inf,        -inf,        -inf],
          [ 1.5092e+00, -1.8861e-01,        -inf,        -inf],
          [-2.3167e+00,  3.1627e+00,  3.7436e-02,        -inf],
          [-1.7613e+00,  3.2616e+00,  2.0962e+00,  1.1410e+00]],

         [[-1.3609e+00,        -inf,        -inf,        -inf],
          [-4.2762e+00, -2.3101e+00,        -inf,        -inf],
          [-1.1872e+00, -2.7749e+00,  3.0883e+00,        -inf],
          [-2.9464e+00, -3.0408e+00,  2.1010e-01,  1.3417e+00]],

         [[ 3.7450e-01,        -inf,        -inf,        -inf],
          [-2.5376e-01,  2.7331e+00,        -inf,        -inf],
          [ 2.8536e+00,  3.1506e+00,  4.4873e+00,        -inf],
          [ 1.9661e+00, -2.4854e+00, -1.8820e+00, -3.5090e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.8283, -0.2573,  0.2857,  ...,  0.1350, -0.7717, -0.0387],
          [ 0.6491, -1.1832, -0.9910,  ..., -0.2541,  0.8869,  0.4313],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [-0.2852,  0.0495, -1.4973,  ..., -1.1220,  0.1438,  0.7788],
          [-0.4058, -0.1576, -0.6069,  ..., -0.8094, -0.6566, -0.0475],
          [-0.3460, -0.3017,  0.0781,  ...,  0.4014,  0.1554, -0.2794]],

         [[ 0.2754,  0.1725,  0.5237,  ...,  0.0320, -0.3098, -0.2042],
          [ 0.5385, -1.2642, -0.6562,  ..., -0.3166,  0.7733,  0.2200],
          [-0.2629, -0.0591, -0.1401,  ..., -0.4022,  0.5716, -0.4785],
          ...,
          [-0.1080,  0.0187, -0.5671,  ..., -0.4250,  0.0545,  0.2950],
          [ 0.1501, -0.3775,  0.1523,  ..., -0.3814, -0.7877, -0.2585],
          [-0.5424, -0.1033,  0.2850,  ..., -0.2926,  0.1843,  0.3068]],

         [[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.3066, -0.8136, -0.3183,  ..., -0.2154,  0.4527,  0.0794],
          [-0.2051, -0.0696, -0.0556,  ..., -0.2939,  0.4542, -0.3804],
          ...,
          [-0.2140, -0.2293, -0.0751,  ..., -0.2076,  0.6244,  0.4291],
          [ 0.6083, -0.4593,  0.2318,  ...,  0.2388, -0.2127, -0.4112],
          [ 0.2338,  0.5557, -0.2052,  ..., -0.0668,  0.5014,  0.4546]],

         [[ 0.2586,  0.2798,  0.2668,  ...,  0.2870, -0.2820, -0.3554],
          [ 0.2154, -0.7869, -0.5335,  ..., -0.1773,  0.5944,  0.0623],
          [-0.0241, -0.1897,  0.1496,  ...,  0.0346, -0.0083, -0.0568],
          ...,
          [-0.3593, -0.1796,  0.1882,  ...,  0.2733,  0.4104,  0.0920],
          [ 0.3950, -0.4125,  0.0727,  ..., -0.0116, -0.3614, -0.3437],
          [ 0.0267,  0.1507, -0.0449,  ..., -0.1724,  0.4530,  0.5611]]],


        [[[-0.4150, -0.8455,  0.3734,  ...,  0.1437, -0.3570, -0.5368],
          [-0.0518, -0.6486, -0.8697,  ...,  0.4454,  0.9291,  0.5125],
          [-0.3084, -0.4626,  0.4476,  ..., -0.8868,  0.9086, -1.0683],
          ...,
          [ 0.4677, -0.0275, -2.0830,  ..., -0.9147, -0.1319,  0.8473],
          [ 0.1157, -0.2313, -0.6391,  ..., -0.8303, -0.7643, -0.1127],
          [-0.2738, -0.1697, -0.0104,  ...,  0.5307,  0.0462, -0.8560]],

         [[-0.2405, -0.1023,  0.9146,  ..., -0.1728, -0.1173, -0.3216],
          [-0.0245, -0.3069, -0.4115,  ...,  0.2108,  0.4396,  0.2425],
          [-0.0518,  0.0797,  0.6069,  ..., -0.5687,  0.4694, -0.8641],
          ...,
          [ 0.3038,  0.0164, -1.1332,  ...,  0.0163,  0.1082,  0.4035],
          [ 0.5196, -0.0716,  0.0775,  ..., -0.2543, -1.3193, -0.1910],
          [-0.0232, -0.5015, -0.1207,  ...,  0.0151, -0.2734, -0.5207]],

         [[-0.0065, -0.1679,  0.8011,  ..., -0.2219, -0.0445, -0.0680],
          [-0.1569,  0.0706, -0.4456,  ...,  0.0849,  0.7748,  0.4812],
          [-0.2368, -0.0434,  0.0901,  ...,  0.1465,  0.2958, -0.7383],
          ...,
          [ 0.2410, -0.0399, -0.2913,  ...,  0.3957,  0.1706,  0.2781],
          [ 0.4827, -0.2387,  0.2537,  ...,  0.0931, -1.1210,  0.0596],
          [ 0.5999,  0.1117, -0.2689,  ...,  0.3172, -0.0290, -0.1676]],

         [[-0.0422, -0.1452,  0.5257,  ..., -0.1269, -0.0518, -0.0883],
          [ 0.2205, -0.5180, -0.1600,  ...,  0.5999,  0.4980,  0.2726],
          [-0.2489,  0.0902,  0.3050,  ..., -0.2924, -0.2487, -0.4848],
          ...,
          [ 0.2538, -0.1079, -0.1693,  ...,  0.1655,  0.1945,  0.0631],
          [ 0.3480, -0.3751,  0.4550,  ...,  0.2634, -0.8024, -0.5275],
          [ 0.3888,  0.0082, -0.2092,  ..., -0.1086, -0.2085,  0.2304]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.8283, -0.2573,  0.2857,  ...,  0.4014,  0.1554, -0.2794],
         [ 0.2754,  0.1725,  0.5237,  ..., -0.2926,  0.1843,  0.3068],
         [ 0.0000,  0.0000,  0.0000,  ..., -0.0668,  0.5014,  0.4546],
         [ 0.2586,  0.2798,  0.2668,  ..., -0.1724,  0.4530,  0.5611]],

        [[-0.4150, -0.8455,  0.3734,  ...,  0.5307,  0.0462, -0.8560],
         [-0.2405, -0.1023,  0.9146,  ...,  0.0151, -0.2734, -0.5207],
         [-0.0065, -0.1679,  0.8011,  ...,  0.3172, -0.0290, -0.1676],
         [-0.0422, -0.1452,  0.5257,  ..., -0.1086, -0.2085,  0.2304]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.1035,  0.1731,  0.0353,  ...,  0.3535,  0.2204,  0.4611],
         [-0.3428,  0.2381,  0.2831,  ...,  0.7025,  0.4396,  0.0162],
         [-0.1355, -0.0245,  0.2561,  ...,  0.3718,  0.2990, -0.1299],
         [ 0.1029, -0.1354,  0.0524,  ...,  0.5694,  0.2247, -0.2089]],

        [[-0.4931,  0.6454,  0.2900,  ...,  0.3593,  0.3623,  0.5449],
         [-0.2501,  0.2716,  0.3784,  ...,  0.4672,  0.1527,  0.1392],
         [ 0.0466,  0.0416,  0.3324,  ...,  0.1412,  0.0941,  0.0635],
         [-0.1545, -0.0391,  0.3214,  ...,  0.2846,  0.3254, -0.0962]]],
       grad_fn=<ViewBackward0>)
Output shape:  torch.Size([2, 4, 50257])
tensor([[[ 0.1381,  0.0077, -0.1963,  ..., -0.0222, -0.1060,  0.1717],
         [ 0.3865, -0.8408, -0.6564,  ..., -0.5163,  0.2369, -0.3357],
         [ 0.6989, -0.1829, -0.1631,  ...,  0.1472, -0.6504, -0.0056],
         [-0.4290,  0.1669, -0.1258,  ...,  1.1579,  0.5303, -0.5549]],

        [[ 0.1094, -0.2894, -0.1467,  ..., -0.0557,  0.2911, -0.2824],
         [ 0.0882, -0.3552, -0.3527,  ...,  1.2930,  0.0053,  0.1898],
         [ 0.6091,  0.4702, -0.4094,  ...,  0.7688,  0.3787, -0.1974],
         [-0.0612, -0.0737,  0.4751,  ...,  1.2463, -0.3834,  0.0609]]],
       grad_fn=<UnsafeViewBackward0>)


Model Analysis (params and size)

Total number of parameters: 163,009,536
	Token embedding layer shape: torch.Size([50257, 768])
	Output layer shape: torch.Size([50257, 768])
Number of trainable parameters considering weight tying:  {124412160}
params of the out_head piece of the model: 38,597,376
params of the final_norm piece of the model:  1536
Total size of the model: 621.83 MB
