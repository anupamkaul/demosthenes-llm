current dir:  /Users/anupkaul/akaul_git/demosthenes-llm/llm-infra 

addnl module path to be used for import:  /Users/anupkaul/akaul_git/demosthenes-llm/llm-infra/../attention/ 

tensor([[6109, 3626, 6100,  345],
        [6109, 1110, 6622,  257]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-5.9103e+00,        -inf,        -inf,        -inf],
          [-3.9426e+00, -1.8578e+00,        -inf,        -inf],
          [ 3.2116e+00,  2.8487e-01,  1.3306e+00,        -inf],
          [ 3.0448e+00,  3.5605e-02,  3.7283e+00, -5.3867e-02]],

         [[ 2.6907e+00,        -inf,        -inf,        -inf],
          [ 9.8233e-01, -1.7586e+00,        -inf,        -inf],
          [-4.4146e+00, -1.0036e+00, -4.9657e+00,        -inf],
          [-1.7670e+00, -3.7493e+00,  2.3126e+00, -1.1789e+00]],

         [[ 3.5973e+00,        -inf,        -inf,        -inf],
          [-5.2846e-02,  3.4846e+00,        -inf,        -inf],
          [-1.2390e+00,  1.0044e+00, -3.4462e+00,        -inf],
          [ 9.4931e-01,  1.8666e+00, -4.9427e+00,  3.0936e+00]],

         [[ 4.8055e+00,        -inf,        -inf,        -inf],
          [-3.8727e+00,  1.7439e+00,        -inf,        -inf],
          [-2.1196e+00, -4.5317e+00,  3.2421e+00,        -inf],
          [ 9.4911e+00, -1.2432e-01, -7.7508e+00, -2.6362e+00]],

         [[-3.3396e+00,        -inf,        -inf,        -inf],
          [-2.1366e+00,  1.4371e+00,        -inf,        -inf],
          [-6.4881e-01, -2.5083e-01,  2.1581e+00,        -inf],
          [-2.3622e+00,  1.6870e+00,  5.6164e-03,  8.6852e-01]],

         [[ 1.4692e+00,        -inf,        -inf,        -inf],
          [ 3.5232e+00,  3.5130e-01,        -inf,        -inf],
          [-2.3507e+00,  1.9016e-01,  2.2317e+00,        -inf],
          [ 1.2526e+00,  6.5942e-01, -1.1210e+00, -3.4643e-01]],

         [[-1.1495e+00,        -inf,        -inf,        -inf],
          [-2.3410e+00, -3.5364e+00,        -inf,        -inf],
          [-2.4985e-01,  1.5276e+00,  3.6205e-01,        -inf],
          [ 7.4209e-01,  3.5102e+00, -2.9821e+00,  3.7595e+00]],

         [[-1.1073e-01,        -inf,        -inf,        -inf],
          [ 4.3760e+00, -1.6010e+00,        -inf,        -inf],
          [ 1.4319e+00, -9.8673e-01,  1.8214e+00,        -inf],
          [ 2.6811e+00,  2.2665e+00,  1.0257e+00,  4.1742e+00]],

         [[ 1.4273e-01,        -inf,        -inf,        -inf],
          [-1.4142e+00, -2.8578e+00,        -inf,        -inf],
          [-9.3608e-01, -1.8138e+00,  3.4870e+00,        -inf],
          [-1.6519e+00, -2.5394e-01,  3.0770e+00, -3.2515e+00]],

         [[-4.2051e+00,        -inf,        -inf,        -inf],
          [ 7.9485e-01,  3.9576e+00,        -inf,        -inf],
          [ 1.9224e+00,  2.6087e+00, -3.8895e+00,        -inf],
          [ 5.5003e-02,  3.7383e+00,  3.3835e-01,  8.3183e-01]],

         [[-2.9559e+00,        -inf,        -inf,        -inf],
          [-2.8677e+00, -1.8544e+00,        -inf,        -inf],
          [ 7.6890e+00, -2.7318e+00, -1.0143e+00,        -inf],
          [-3.6611e-01,  4.3186e+00, -4.3550e+00, -2.7216e+00]],

         [[-2.7300e+00,        -inf,        -inf,        -inf],
          [ 3.7743e+00,  1.7347e+00,        -inf,        -inf],
          [-8.2357e-01,  1.3212e+00, -2.1484e+00,        -inf],
          [ 4.6256e+00, -8.7227e-01, -1.4817e+00,  4.6655e+00]],

         [[ 3.6169e+00,        -inf,        -inf,        -inf],
          [ 2.7406e-02, -1.8131e+00,        -inf,        -inf],
          [-1.6518e+00, -3.3376e-01,  6.2062e+00,        -inf],
          [-3.2067e+00, -6.4476e-01,  3.9707e+00, -2.6977e+00]],

         [[ 6.8177e-01,        -inf,        -inf,        -inf],
          [ 3.9452e+00,  2.6044e+00,        -inf,        -inf],
          [ 5.6409e-01, -4.5879e+00, -4.5692e+00,        -inf],
          [ 7.1173e+00, -9.1799e-01,  6.4645e+00,  5.8300e-01]],

         [[ 1.1839e+00,        -inf,        -inf,        -inf],
          [ 3.0281e-01,  4.1503e-01,        -inf,        -inf],
          [-6.0537e+00,  4.2935e-01,  6.2514e-01,        -inf],
          [ 3.1300e+00,  3.4072e+00, -3.9025e-01,  2.3223e+00]],

         [[-3.2574e+00,        -inf,        -inf,        -inf],
          [-2.4087e+00, -1.8575e+00,        -inf,        -inf],
          [ 2.0111e+00, -7.2483e-01, -2.6812e+00,        -inf],
          [ 1.2081e+00, -3.1624e+00,  6.2119e+00, -1.5305e+00]],

         [[-6.3037e-01,        -inf,        -inf,        -inf],
          [ 6.9664e-02,  2.3999e+00,        -inf,        -inf],
          [-1.7693e+00, -2.5325e+00, -1.4128e+00,        -inf],
          [ 1.8690e+00,  1.3628e+00, -2.0005e+00,  2.1404e+00]],

         [[ 4.3299e+00,        -inf,        -inf,        -inf],
          [ 3.2192e-01,  1.4689e+00,        -inf,        -inf],
          [-1.5195e+00, -1.2164e+00, -4.1619e-01,        -inf],
          [-2.1417e+00,  5.4132e+00, -2.3238e+00,  6.0144e-01]],

         [[ 6.0671e-02,        -inf,        -inf,        -inf],
          [-4.9818e+00, -2.0061e+00,        -inf,        -inf],
          [ 6.7762e-02,  2.3405e-01,  5.4825e-01,        -inf],
          [-1.1618e-01,  4.3454e+00, -2.7043e+00,  4.0470e+00]],

         [[-2.6947e+00,        -inf,        -inf,        -inf],
          [ 9.6031e-01,  5.3040e+00,        -inf,        -inf],
          [-7.7072e-01, -3.0939e+00, -2.5286e+00,        -inf],
          [-1.9740e-01, -3.2404e+00,  2.5193e+00,  1.5020e+00]],

         [[ 1.8758e+00,        -inf,        -inf,        -inf],
          [-1.2441e+00, -1.0695e+00,        -inf,        -inf],
          [ 4.5854e+00, -5.5915e-01,  9.4854e-01,        -inf],
          [-3.6749e+00, -1.0001e+00,  1.7178e+00, -4.3244e+00]],

         [[ 1.7763e+00,        -inf,        -inf,        -inf],
          [ 2.3047e+00, -9.4703e-01,        -inf,        -inf],
          [ 3.8679e+00, -2.3467e+00, -1.7493e+00,        -inf],
          [ 5.0018e+00,  3.8109e+00, -1.6942e+00,  1.6655e+00]],

         [[ 5.9192e-01,        -inf,        -inf,        -inf],
          [ 1.1123e+00, -3.4928e+00,        -inf,        -inf],
          [-2.2318e+00, -4.2716e+00,  2.9080e+00,        -inf],
          [ 2.0775e-01, -3.3669e+00,  6.2348e+00,  1.6393e+00]],

         [[-2.3623e+00,        -inf,        -inf,        -inf],
          [-1.2002e+00,  1.9156e-01,        -inf,        -inf],
          [ 1.5449e+00, -1.5650e+00,  1.5266e+00,        -inf],
          [-3.9343e-01,  2.8289e+00, -1.1687e+00, -2.0514e+00]],

         [[ 8.2928e-01,        -inf,        -inf,        -inf],
          [ 2.3098e+00, -3.8197e+00,        -inf,        -inf],
          [-2.1663e+00, -5.3341e+00,  1.3715e+00,        -inf],
          [ 2.4906e+00,  1.1609e+00, -1.3973e+00,  2.7622e+00]]],


        [[[-5.9008e+00,        -inf,        -inf,        -inf],
          [-2.0336e+00, -2.9726e+00,        -inf,        -inf],
          [-9.4349e-01, -2.0480e+00,  1.0334e+00,        -inf],
          [-2.8815e+00,  2.0587e+00, -3.8094e+00,  6.6688e-01]],

         [[ 1.7103e+00,        -inf,        -inf,        -inf],
          [-2.7225e+00,  1.4446e+00,        -inf,        -inf],
          [-8.2152e-01, -9.0307e-01, -4.7254e+00,        -inf],
          [ 3.4275e+00, -9.5491e-02,  3.0610e+00,  3.0199e-01]],

         [[ 3.5548e+00,        -inf,        -inf,        -inf],
          [-7.0106e+00,  2.4192e+00,        -inf,        -inf],
          [-2.0547e+00,  7.9195e-01,  4.3890e-02,        -inf],
          [-1.7087e+00,  1.4668e+00,  3.9133e-01,  1.5153e+00]],

         [[ 2.7362e+00,        -inf,        -inf,        -inf],
          [-3.5396e+00,  3.0856e-01,        -inf,        -inf],
          [-9.5423e-01, -6.5286e-01,  2.0556e+00,        -inf],
          [ 6.1286e+00, -2.7454e-01, -2.4371e+00,  4.1183e-01]],

         [[-1.6536e+00,        -inf,        -inf,        -inf],
          [-3.6398e+00,  4.5401e+00,        -inf,        -inf],
          [-2.6449e+00,  3.5581e-01, -1.7302e+00,        -inf],
          [-2.2209e+00,  7.1425e-01,  3.0854e+00, -9.6982e-01]],

         [[ 2.8998e+00,        -inf,        -inf,        -inf],
          [-1.6329e+00, -2.9405e+00,        -inf,        -inf],
          [-7.4658e-01, -6.6858e-02, -5.0696e+00,        -inf],
          [ 2.6950e+00,  2.6594e+00,  2.3304e+00,  1.4024e+00]],

         [[ 6.3824e-01,        -inf,        -inf,        -inf],
          [ 1.1542e+00, -5.5862e+00,        -inf,        -inf],
          [-9.0771e-01,  2.5630e+00,  1.4369e+00,        -inf],
          [ 3.0958e+00,  1.5165e+00, -1.0234e+00,  2.5242e+00]],

         [[ 7.2353e-01,        -inf,        -inf,        -inf],
          [-5.0412e-01,  5.8701e-01,        -inf,        -inf],
          [ 1.8048e+00, -9.3594e-01,  6.3942e+00,        -inf],
          [ 1.6401e+00,  3.5763e+00, -1.6810e+00,  1.6051e+00]],

         [[-2.1695e+00,        -inf,        -inf,        -inf],
          [-2.5101e+00, -3.2662e+00,        -inf,        -inf],
          [-1.8321e-01,  3.2402e-01,  3.3946e+00,        -inf],
          [ 6.2764e+00, -8.8325e-01,  1.2115e-01, -1.6399e+00]],

         [[-3.6838e+00,        -inf,        -inf,        -inf],
          [-1.0309e+00,  6.8546e+00,        -inf,        -inf],
          [-2.5762e+00, -3.7519e-01,  3.6021e+00,        -inf],
          [ 1.6707e+00,  3.1399e-01,  3.4732e+00, -2.6342e+00]],

         [[-1.1964e+00,        -inf,        -inf,        -inf],
          [ 2.8202e+00, -1.3359e+00,        -inf,        -inf],
          [ 2.3189e+00,  1.3411e+00,  2.7380e+00,        -inf],
          [ 8.1337e-01, -6.7854e-02,  2.9632e-01,  1.0316e+00]],

         [[-2.7914e+00,        -inf,        -inf,        -inf],
          [ 1.6767e-01, -2.4280e+00,        -inf,        -inf],
          [-2.6755e+00,  4.4596e-01,  2.3826e+00,        -inf],
          [ 1.0200e-01, -5.2208e+00,  1.7732e-01, -6.0091e-01]],

         [[ 1.5599e+00,        -inf,        -inf,        -inf],
          [-3.2780e+00,  1.9657e-01,        -inf,        -inf],
          [ 1.9685e+00,  9.9029e-01, -1.7415e+00,        -inf],
          [ 6.1606e-01, -2.6090e+00,  2.5796e+00, -5.4648e-01]],

         [[ 6.9993e-01,        -inf,        -inf,        -inf],
          [ 4.0246e+00,  2.5591e+00,        -inf,        -inf],
          [-1.0160e+00, -2.6886e+00, -5.0998e+00,        -inf],
          [-5.8630e-01,  9.5051e-02,  3.2705e-02, -9.6006e-01]],

         [[ 2.5137e+00,        -inf,        -inf,        -inf],
          [-2.3810e+00,  3.3801e+00,        -inf,        -inf],
          [-4.2152e+00,  1.2717e+00,  8.7748e-01,        -inf],
          [ 6.8026e+00,  5.7250e-01, -2.1452e+00, -1.5163e+00]],

         [[-1.5730e+00,        -inf,        -inf,        -inf],
          [-4.2694e+00,  1.4731e+00,        -inf,        -inf],
          [-9.0661e-01,  3.6161e+00,  3.0550e-01,        -inf],
          [-3.3555e-01,  4.9791e+00,  5.4239e+00,  1.9139e-01]],

         [[ 7.9051e-01,        -inf,        -inf,        -inf],
          [ 1.2957e+00, -4.2798e-01,        -inf,        -inf],
          [-3.1355e+00, -1.4410e+00,  6.3659e-01,        -inf],
          [-5.9135e-01,  3.3830e+00, -4.2363e-01,  3.0067e-01]],

         [[ 2.3499e+00,        -inf,        -inf,        -inf],
          [ 1.6708e+00, -3.3377e+00,        -inf,        -inf],
          [ 2.1430e-01,  3.9778e+00, -7.2318e-02,        -inf],
          [-1.1461e-01,  1.1403e+00, -5.6196e-01, -2.5736e+00]],

         [[ 1.2661e+00,        -inf,        -inf,        -inf],
          [ 3.2610e+00, -1.9355e+00,        -inf,        -inf],
          [-6.3053e+00,  2.3136e-01,  4.6002e+00,        -inf],
          [ 7.0152e+00, -2.2448e+00, -2.8315e+00,  3.1328e+00]],

         [[-2.3017e+00,        -inf,        -inf,        -inf],
          [ 6.4540e-01,  3.4089e+00,        -inf,        -inf],
          [-2.5435e+00,  3.7217e+00, -2.7653e+00,        -inf],
          [ 2.7601e+00, -4.1501e+00,  7.3569e-01, -5.5993e-01]],

         [[ 4.3853e+00,        -inf,        -inf,        -inf],
          [ 5.1475e-01, -5.1813e-01,        -inf,        -inf],
          [ 4.5816e-01, -4.7504e+00, -1.6033e+00,        -inf],
          [ 2.2821e-01,  2.7004e+00,  2.9194e-01, -3.6379e+00]],

         [[ 3.8511e+00,        -inf,        -inf,        -inf],
          [-1.1758e+00, -2.5212e+00,        -inf,        -inf],
          [-5.2209e+00,  4.6147e-01,  2.3905e+00,        -inf],
          [ 1.8616e+00, -7.4546e-01, -2.6122e+00, -4.0053e+00]],

         [[ 1.4442e+00,        -inf,        -inf,        -inf],
          [-2.6927e+00, -5.6662e-01,        -inf,        -inf],
          [-8.2773e-01, -3.7795e+00, -1.0958e+00,        -inf],
          [ 2.1879e+00,  2.8488e+00, -3.5927e+00,  5.6286e+00]],

         [[-2.9843e+00,        -inf,        -inf,        -inf],
          [ 3.7433e-01,  4.0357e+00,        -inf,        -inf],
          [ 6.4104e+00, -1.0970e-02, -2.6021e+00,        -inf],
          [-3.4875e+00, -5.4347e-01, -1.0073e+00, -2.9411e+00]],

         [[ 3.0777e+00,        -inf,        -inf,        -inf],
          [ 3.0620e+00, -3.4059e+00,        -inf,        -inf],
          [ 2.0218e-01,  1.9547e-01,  1.4210e+00,        -inf],
          [-5.1620e-02,  4.0622e+00,  1.2972e+00,  9.0557e-02]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-5.9103e+00,        -inf,        -inf,        -inf],
          [-3.9426e+00, -1.8578e+00,        -inf,        -inf],
          [ 3.2116e+00,  2.8487e-01,  1.3306e+00,        -inf],
          [ 3.0448e+00,  3.5605e-02,  3.7283e+00, -5.3867e-02]],

         [[ 2.6907e+00,        -inf,        -inf,        -inf],
          [ 9.8233e-01, -1.7586e+00,        -inf,        -inf],
          [-4.4146e+00, -1.0036e+00, -4.9657e+00,        -inf],
          [-1.7670e+00, -3.7493e+00,  2.3126e+00, -1.1789e+00]],

         [[ 3.5973e+00,        -inf,        -inf,        -inf],
          [-5.2846e-02,  3.4846e+00,        -inf,        -inf],
          [-1.2390e+00,  1.0044e+00, -3.4462e+00,        -inf],
          [ 9.4931e-01,  1.8666e+00, -4.9427e+00,  3.0936e+00]],

         [[ 4.8055e+00,        -inf,        -inf,        -inf],
          [-3.8727e+00,  1.7439e+00,        -inf,        -inf],
          [-2.1196e+00, -4.5317e+00,  3.2421e+00,        -inf],
          [ 9.4911e+00, -1.2432e-01, -7.7508e+00, -2.6362e+00]],

         [[-3.3396e+00,        -inf,        -inf,        -inf],
          [-2.1366e+00,  1.4371e+00,        -inf,        -inf],
          [-6.4881e-01, -2.5083e-01,  2.1581e+00,        -inf],
          [-2.3622e+00,  1.6870e+00,  5.6164e-03,  8.6852e-01]],

         [[ 1.4692e+00,        -inf,        -inf,        -inf],
          [ 3.5232e+00,  3.5130e-01,        -inf,        -inf],
          [-2.3507e+00,  1.9016e-01,  2.2317e+00,        -inf],
          [ 1.2526e+00,  6.5942e-01, -1.1210e+00, -3.4643e-01]],

         [[-1.1495e+00,        -inf,        -inf,        -inf],
          [-2.3410e+00, -3.5364e+00,        -inf,        -inf],
          [-2.4985e-01,  1.5276e+00,  3.6205e-01,        -inf],
          [ 7.4209e-01,  3.5102e+00, -2.9821e+00,  3.7595e+00]],

         [[-1.1073e-01,        -inf,        -inf,        -inf],
          [ 4.3760e+00, -1.6010e+00,        -inf,        -inf],
          [ 1.4319e+00, -9.8673e-01,  1.8214e+00,        -inf],
          [ 2.6811e+00,  2.2665e+00,  1.0257e+00,  4.1742e+00]],

         [[ 1.4273e-01,        -inf,        -inf,        -inf],
          [-1.4142e+00, -2.8578e+00,        -inf,        -inf],
          [-9.3608e-01, -1.8138e+00,  3.4870e+00,        -inf],
          [-1.6519e+00, -2.5394e-01,  3.0770e+00, -3.2515e+00]],

         [[-4.2051e+00,        -inf,        -inf,        -inf],
          [ 7.9485e-01,  3.9576e+00,        -inf,        -inf],
          [ 1.9224e+00,  2.6087e+00, -3.8895e+00,        -inf],
          [ 5.5003e-02,  3.7383e+00,  3.3835e-01,  8.3183e-01]],

         [[-2.9559e+00,        -inf,        -inf,        -inf],
          [-2.8677e+00, -1.8544e+00,        -inf,        -inf],
          [ 7.6890e+00, -2.7318e+00, -1.0143e+00,        -inf],
          [-3.6611e-01,  4.3186e+00, -4.3550e+00, -2.7216e+00]],

         [[-2.7300e+00,        -inf,        -inf,        -inf],
          [ 3.7743e+00,  1.7347e+00,        -inf,        -inf],
          [-8.2357e-01,  1.3212e+00, -2.1484e+00,        -inf],
          [ 4.6256e+00, -8.7227e-01, -1.4817e+00,  4.6655e+00]],

         [[ 3.6169e+00,        -inf,        -inf,        -inf],
          [ 2.7406e-02, -1.8131e+00,        -inf,        -inf],
          [-1.6518e+00, -3.3376e-01,  6.2062e+00,        -inf],
          [-3.2067e+00, -6.4476e-01,  3.9707e+00, -2.6977e+00]],

         [[ 6.8177e-01,        -inf,        -inf,        -inf],
          [ 3.9452e+00,  2.6044e+00,        -inf,        -inf],
          [ 5.6409e-01, -4.5879e+00, -4.5692e+00,        -inf],
          [ 7.1173e+00, -9.1799e-01,  6.4645e+00,  5.8300e-01]],

         [[ 1.1839e+00,        -inf,        -inf,        -inf],
          [ 3.0281e-01,  4.1503e-01,        -inf,        -inf],
          [-6.0537e+00,  4.2935e-01,  6.2514e-01,        -inf],
          [ 3.1300e+00,  3.4072e+00, -3.9025e-01,  2.3223e+00]],

         [[-3.2574e+00,        -inf,        -inf,        -inf],
          [-2.4087e+00, -1.8575e+00,        -inf,        -inf],
          [ 2.0111e+00, -7.2483e-01, -2.6812e+00,        -inf],
          [ 1.2081e+00, -3.1624e+00,  6.2119e+00, -1.5305e+00]],

         [[-6.3037e-01,        -inf,        -inf,        -inf],
          [ 6.9664e-02,  2.3999e+00,        -inf,        -inf],
          [-1.7693e+00, -2.5325e+00, -1.4128e+00,        -inf],
          [ 1.8690e+00,  1.3628e+00, -2.0005e+00,  2.1404e+00]],

         [[ 4.3299e+00,        -inf,        -inf,        -inf],
          [ 3.2192e-01,  1.4689e+00,        -inf,        -inf],
          [-1.5195e+00, -1.2164e+00, -4.1619e-01,        -inf],
          [-2.1417e+00,  5.4132e+00, -2.3238e+00,  6.0144e-01]],

         [[ 6.0671e-02,        -inf,        -inf,        -inf],
          [-4.9818e+00, -2.0061e+00,        -inf,        -inf],
          [ 6.7762e-02,  2.3405e-01,  5.4825e-01,        -inf],
          [-1.1618e-01,  4.3454e+00, -2.7043e+00,  4.0470e+00]],

         [[-2.6947e+00,        -inf,        -inf,        -inf],
          [ 9.6031e-01,  5.3040e+00,        -inf,        -inf],
          [-7.7072e-01, -3.0939e+00, -2.5286e+00,        -inf],
          [-1.9740e-01, -3.2404e+00,  2.5193e+00,  1.5020e+00]],

         [[ 1.8758e+00,        -inf,        -inf,        -inf],
          [-1.2441e+00, -1.0695e+00,        -inf,        -inf],
          [ 4.5854e+00, -5.5915e-01,  9.4854e-01,        -inf],
          [-3.6749e+00, -1.0001e+00,  1.7178e+00, -4.3244e+00]],

         [[ 1.7763e+00,        -inf,        -inf,        -inf],
          [ 2.3047e+00, -9.4703e-01,        -inf,        -inf],
          [ 3.8679e+00, -2.3467e+00, -1.7493e+00,        -inf],
          [ 5.0018e+00,  3.8109e+00, -1.6942e+00,  1.6655e+00]],

         [[ 5.9192e-01,        -inf,        -inf,        -inf],
          [ 1.1123e+00, -3.4928e+00,        -inf,        -inf],
          [-2.2318e+00, -4.2716e+00,  2.9080e+00,        -inf],
          [ 2.0775e-01, -3.3669e+00,  6.2348e+00,  1.6393e+00]],

         [[-2.3623e+00,        -inf,        -inf,        -inf],
          [-1.2002e+00,  1.9156e-01,        -inf,        -inf],
          [ 1.5449e+00, -1.5650e+00,  1.5266e+00,        -inf],
          [-3.9343e-01,  2.8289e+00, -1.1687e+00, -2.0514e+00]],

         [[ 8.2928e-01,        -inf,        -inf,        -inf],
          [ 2.3098e+00, -3.8197e+00,        -inf,        -inf],
          [-2.1663e+00, -5.3341e+00,  1.3715e+00,        -inf],
          [ 2.4906e+00,  1.1609e+00, -1.3973e+00,  2.7622e+00]]],


        [[[-5.9008e+00,        -inf,        -inf,        -inf],
          [-2.0336e+00, -2.9726e+00,        -inf,        -inf],
          [-9.4349e-01, -2.0480e+00,  1.0334e+00,        -inf],
          [-2.8815e+00,  2.0587e+00, -3.8094e+00,  6.6688e-01]],

         [[ 1.7103e+00,        -inf,        -inf,        -inf],
          [-2.7225e+00,  1.4446e+00,        -inf,        -inf],
          [-8.2152e-01, -9.0307e-01, -4.7254e+00,        -inf],
          [ 3.4275e+00, -9.5491e-02,  3.0610e+00,  3.0199e-01]],

         [[ 3.5548e+00,        -inf,        -inf,        -inf],
          [-7.0106e+00,  2.4192e+00,        -inf,        -inf],
          [-2.0547e+00,  7.9195e-01,  4.3890e-02,        -inf],
          [-1.7087e+00,  1.4668e+00,  3.9133e-01,  1.5153e+00]],

         [[ 2.7362e+00,        -inf,        -inf,        -inf],
          [-3.5396e+00,  3.0856e-01,        -inf,        -inf],
          [-9.5423e-01, -6.5286e-01,  2.0556e+00,        -inf],
          [ 6.1286e+00, -2.7454e-01, -2.4371e+00,  4.1183e-01]],

         [[-1.6536e+00,        -inf,        -inf,        -inf],
          [-3.6398e+00,  4.5401e+00,        -inf,        -inf],
          [-2.6449e+00,  3.5581e-01, -1.7302e+00,        -inf],
          [-2.2209e+00,  7.1425e-01,  3.0854e+00, -9.6982e-01]],

         [[ 2.8998e+00,        -inf,        -inf,        -inf],
          [-1.6329e+00, -2.9405e+00,        -inf,        -inf],
          [-7.4658e-01, -6.6858e-02, -5.0696e+00,        -inf],
          [ 2.6950e+00,  2.6594e+00,  2.3304e+00,  1.4024e+00]],

         [[ 6.3824e-01,        -inf,        -inf,        -inf],
          [ 1.1542e+00, -5.5862e+00,        -inf,        -inf],
          [-9.0771e-01,  2.5630e+00,  1.4369e+00,        -inf],
          [ 3.0958e+00,  1.5165e+00, -1.0234e+00,  2.5242e+00]],

         [[ 7.2353e-01,        -inf,        -inf,        -inf],
          [-5.0412e-01,  5.8701e-01,        -inf,        -inf],
          [ 1.8048e+00, -9.3594e-01,  6.3942e+00,        -inf],
          [ 1.6401e+00,  3.5763e+00, -1.6810e+00,  1.6051e+00]],

         [[-2.1695e+00,        -inf,        -inf,        -inf],
          [-2.5101e+00, -3.2662e+00,        -inf,        -inf],
          [-1.8321e-01,  3.2402e-01,  3.3946e+00,        -inf],
          [ 6.2764e+00, -8.8325e-01,  1.2115e-01, -1.6399e+00]],

         [[-3.6838e+00,        -inf,        -inf,        -inf],
          [-1.0309e+00,  6.8546e+00,        -inf,        -inf],
          [-2.5762e+00, -3.7519e-01,  3.6021e+00,        -inf],
          [ 1.6707e+00,  3.1399e-01,  3.4732e+00, -2.6342e+00]],

         [[-1.1964e+00,        -inf,        -inf,        -inf],
          [ 2.8202e+00, -1.3359e+00,        -inf,        -inf],
          [ 2.3189e+00,  1.3411e+00,  2.7380e+00,        -inf],
          [ 8.1337e-01, -6.7854e-02,  2.9632e-01,  1.0316e+00]],

         [[-2.7914e+00,        -inf,        -inf,        -inf],
          [ 1.6767e-01, -2.4280e+00,        -inf,        -inf],
          [-2.6755e+00,  4.4596e-01,  2.3826e+00,        -inf],
          [ 1.0200e-01, -5.2208e+00,  1.7732e-01, -6.0091e-01]],

         [[ 1.5599e+00,        -inf,        -inf,        -inf],
          [-3.2780e+00,  1.9657e-01,        -inf,        -inf],
          [ 1.9685e+00,  9.9029e-01, -1.7415e+00,        -inf],
          [ 6.1606e-01, -2.6090e+00,  2.5796e+00, -5.4648e-01]],

         [[ 6.9993e-01,        -inf,        -inf,        -inf],
          [ 4.0246e+00,  2.5591e+00,        -inf,        -inf],
          [-1.0160e+00, -2.6886e+00, -5.0998e+00,        -inf],
          [-5.8630e-01,  9.5051e-02,  3.2705e-02, -9.6006e-01]],

         [[ 2.5137e+00,        -inf,        -inf,        -inf],
          [-2.3810e+00,  3.3801e+00,        -inf,        -inf],
          [-4.2152e+00,  1.2717e+00,  8.7748e-01,        -inf],
          [ 6.8026e+00,  5.7250e-01, -2.1452e+00, -1.5163e+00]],

         [[-1.5730e+00,        -inf,        -inf,        -inf],
          [-4.2694e+00,  1.4731e+00,        -inf,        -inf],
          [-9.0661e-01,  3.6161e+00,  3.0550e-01,        -inf],
          [-3.3555e-01,  4.9791e+00,  5.4239e+00,  1.9139e-01]],

         [[ 7.9051e-01,        -inf,        -inf,        -inf],
          [ 1.2957e+00, -4.2798e-01,        -inf,        -inf],
          [-3.1355e+00, -1.4410e+00,  6.3659e-01,        -inf],
          [-5.9135e-01,  3.3830e+00, -4.2363e-01,  3.0067e-01]],

         [[ 2.3499e+00,        -inf,        -inf,        -inf],
          [ 1.6708e+00, -3.3377e+00,        -inf,        -inf],
          [ 2.1430e-01,  3.9778e+00, -7.2318e-02,        -inf],
          [-1.1461e-01,  1.1403e+00, -5.6196e-01, -2.5736e+00]],

         [[ 1.2661e+00,        -inf,        -inf,        -inf],
          [ 3.2610e+00, -1.9355e+00,        -inf,        -inf],
          [-6.3053e+00,  2.3136e-01,  4.6002e+00,        -inf],
          [ 7.0152e+00, -2.2448e+00, -2.8315e+00,  3.1328e+00]],

         [[-2.3017e+00,        -inf,        -inf,        -inf],
          [ 6.4540e-01,  3.4089e+00,        -inf,        -inf],
          [-2.5435e+00,  3.7217e+00, -2.7653e+00,        -inf],
          [ 2.7601e+00, -4.1501e+00,  7.3569e-01, -5.5993e-01]],

         [[ 4.3853e+00,        -inf,        -inf,        -inf],
          [ 5.1475e-01, -5.1813e-01,        -inf,        -inf],
          [ 4.5816e-01, -4.7504e+00, -1.6033e+00,        -inf],
          [ 2.2821e-01,  2.7004e+00,  2.9194e-01, -3.6379e+00]],

         [[ 3.8511e+00,        -inf,        -inf,        -inf],
          [-1.1758e+00, -2.5212e+00,        -inf,        -inf],
          [-5.2209e+00,  4.6147e-01,  2.3905e+00,        -inf],
          [ 1.8616e+00, -7.4546e-01, -2.6122e+00, -4.0053e+00]],

         [[ 1.4442e+00,        -inf,        -inf,        -inf],
          [-2.6927e+00, -5.6662e-01,        -inf,        -inf],
          [-8.2773e-01, -3.7795e+00, -1.0958e+00,        -inf],
          [ 2.1879e+00,  2.8488e+00, -3.5927e+00,  5.6286e+00]],

         [[-2.9843e+00,        -inf,        -inf,        -inf],
          [ 3.7433e-01,  4.0357e+00,        -inf,        -inf],
          [ 6.4104e+00, -1.0970e-02, -2.6021e+00,        -inf],
          [-3.4875e+00, -5.4347e-01, -1.0073e+00, -2.9411e+00]],

         [[ 3.0777e+00,        -inf,        -inf,        -inf],
          [ 3.0620e+00, -3.4059e+00,        -inf,        -inf],
          [ 2.0218e-01,  1.9547e-01,  1.4210e+00,        -inf],
          [-5.1620e-02,  4.0622e+00,  1.2972e+00,  9.0557e-02]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-4.3853e-01, -9.7306e-02, -1.9515e-01,  ...,  6.1997e-01,
            5.1273e-01, -2.1968e-02],
          [ 2.8379e-02, -4.1242e-01,  9.7772e-01,  ...,  3.4444e-01,
            6.1228e-02, -3.6596e-01],
          [ 1.0144e+00,  1.6397e-01, -6.3510e-02,  ...,  3.6155e-01,
           -3.2197e-01,  1.6201e-01],
          ...,
          [ 7.6973e-01, -5.8326e-01,  1.6414e-01,  ...,  1.7914e-02,
            2.6300e-01,  3.6060e-01],
          [ 5.9291e-01, -7.1870e-01, -1.8790e+00,  ...,  7.3288e-01,
            7.7222e-01, -4.7809e-01],
          [-5.5525e-01, -7.0473e-01,  3.0525e-01,  ...,  4.3207e-01,
            3.9213e-01, -2.3319e-02]],

         [[-2.2686e-01,  3.5372e-01,  2.5558e-01,  ...,  5.8593e-02,
            1.3647e-01,  8.4004e-01],
          [ 1.0513e-01, -1.3394e-02, -7.4496e-03,  ...,  6.6039e-02,
           -3.5629e-01, -3.5042e-01],
          [ 1.1426e+00, -1.3786e-01,  1.3300e-01,  ...,  2.6901e-01,
           -6.1016e-01, -1.9429e-01],
          ...,
          [-4.5920e-01,  2.2140e-01,  2.8691e-01,  ..., -2.8229e-01,
            2.7466e-01,  8.1906e-02],
          [ 3.9339e-01, -2.8337e-02, -1.6627e-01,  ..., -4.4275e-06,
            1.2275e-01, -3.8260e-01],
          [-5.2093e-01, -6.0108e-01,  1.5725e-01,  ...,  3.0321e-01,
            1.4695e-01,  1.6746e-01]],

         [[-4.3260e-01,  5.3955e-01,  2.9922e-02,  ...,  4.3457e-01,
           -1.9572e-02,  5.3199e-01],
          [ 4.1159e-01,  7.3627e-02, -3.0272e-01,  ...,  1.3394e-01,
           -9.7784e-02, -2.5945e-01],
          [ 5.2603e-01, -1.4249e-01,  1.1134e-01,  ...,  8.9983e-02,
           -3.4153e-01, -1.8175e-01],
          ...,
          [-5.6891e-01,  2.5456e-01,  8.2972e-01,  ..., -5.1717e-01,
            6.5121e-01,  2.2273e-01],
          [ 5.0415e-01, -7.8269e-01, -1.0125e+00,  ...,  9.4335e-01,
           -1.6898e-01, -3.4888e-01],
          [-2.1714e-01, -5.0823e-01,  9.7902e-02,  ...,  4.1601e-01,
            4.6317e-01, -2.9210e-01]],

         [[-4.2543e-01,  6.5386e-01,  1.6214e-01,  ...,  5.5264e-01,
            7.1541e-03,  2.8868e-01],
          [ 4.8714e-01, -1.1161e-01,  6.0839e-02,  ...,  5.3108e-02,
            2.1315e-01, -2.3252e-01],
          [ 2.5960e-01,  4.1961e-02, -1.6253e-02,  ...,  9.2523e-02,
           -8.2394e-02,  4.1460e-02],
          ...,
          [-3.7243e-01,  1.4231e-01,  5.8045e-01,  ..., -7.1528e-01,
            4.0904e-01,  3.4055e-01],
          [ 3.8563e-01, -5.8721e-01, -7.4208e-01,  ...,  5.0927e-01,
            6.1073e-02, -1.8642e-01],
          [-2.6709e-01, -2.9313e-01,  4.8266e-02,  ...,  1.2986e-01,
            1.9976e-02,  1.3330e-01]]],


        [[[-3.5976e-01,  8.1282e-02, -1.8984e-01,  ...,  4.9596e-01,
            5.2549e-01, -5.8059e-02],
          [-1.7862e-01, -2.4893e-01,  9.0532e-01,  ...,  3.9103e-01,
            1.1111e-02, -1.0648e-02],
          [ 6.2199e-01,  3.1728e-01,  1.8439e-01,  ...,  6.8562e-01,
           -2.0754e-01,  2.1251e-01],
          ...,
          [ 1.1528e+00, -6.9258e-01,  2.6341e-01,  ..., -1.9576e-02,
           -5.5026e-02,  4.2030e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-5.6375e-01, -6.5532e-01,  1.9604e-01,  ...,  3.8647e-01,
            3.4698e-01, -9.2771e-02]],

         [[-3.0467e-02,  1.1976e-01, -9.7646e-02,  ..., -3.3570e-02,
            2.2745e-01,  5.4210e-01],
          [ 5.3753e-01,  3.0976e-01,  6.1386e-01,  ...,  1.1615e-01,
           -4.5897e-01, -2.0514e-01],
          [ 1.1344e-01, -4.2710e-01, -3.8407e-01,  ..., -9.5571e-03,
           -7.6806e-01,  1.2807e-01],
          ...,
          [-3.5707e-01, -2.4531e-01,  5.8879e-01,  ...,  4.6503e-02,
            2.7328e-01, -4.3707e-02],
          [ 5.0065e-01, -5.2899e-01, -7.6004e-01,  ...,  4.1991e-01,
            4.6920e-01,  4.8178e-02],
          [-6.4833e-01, -5.7056e-01,  3.4784e-01,  ...,  4.2190e-01,
            4.9074e-01,  2.6362e-01]],

         [[ 2.7754e-01,  1.5618e-01, -3.1101e-01,  ...,  4.1438e-01,
            8.2999e-02,  4.0743e-01],
          [ 3.5816e-01,  3.0262e-01,  5.0826e-01,  ...,  3.2532e-03,
           -2.1018e-01,  8.3917e-02],
          [ 5.4842e-01,  1.1314e-01,  3.6300e-01,  ...,  1.2907e-01,
           -5.3532e-01,  8.2965e-02],
          ...,
          [-6.3872e-02, -1.4063e-01,  8.3052e-01,  ..., -3.3749e-01,
            1.6192e-01,  2.8978e-01],
          [ 4.5883e-01, -4.6900e-01, -1.2331e+00,  ...,  8.2594e-01,
            4.0699e-01, -1.1621e-02],
          [-5.3378e-01, -8.3501e-02,  1.0026e-01,  ...,  6.0678e-01,
            2.1983e-01,  2.4186e-01]],

         [[-1.6307e-01,  3.0594e-01,  1.5360e-01,  ...,  1.6416e-01,
           -4.4210e-02,  2.3255e-01],
          [ 6.0187e-02,  1.1633e-01,  9.3291e-02,  ..., -3.3148e-01,
           -2.1084e-02,  1.9972e-01],
          [ 6.1656e-01,  2.7146e-01,  6.7649e-02,  ...,  3.4695e-01,
           -7.1088e-01, -2.7894e-01],
          ...,
          [-1.2416e-01, -2.0382e-01,  4.8818e-01,  ..., -2.6164e-01,
            2.7959e-01,  3.7082e-01],
          [ 1.8306e-01, -5.6718e-01, -7.2792e-01,  ...,  3.3773e-01,
            1.9508e-01,  4.9378e-02],
          [-4.1990e-01,  4.7883e-02,  2.8433e-01,  ...,  6.3375e-01,
            4.1703e-01,  2.3604e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.4385, -0.0973, -0.1952,  ...,  0.4321,  0.3921, -0.0233],
         [-0.2269,  0.3537,  0.2556,  ...,  0.3032,  0.1470,  0.1675],
         [-0.4326,  0.5396,  0.0299,  ...,  0.4160,  0.4632, -0.2921],
         [-0.4254,  0.6539,  0.1621,  ...,  0.1299,  0.0200,  0.1333]],

        [[-0.3598,  0.0813, -0.1898,  ...,  0.3865,  0.3470, -0.0928],
         [-0.0305,  0.1198, -0.0976,  ...,  0.4219,  0.4907,  0.2636],
         [ 0.2775,  0.1562, -0.3110,  ...,  0.6068,  0.2198,  0.2419],
         [-0.1631,  0.3059,  0.1536,  ...,  0.6337,  0.4170,  0.2360]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.2084,  0.1477,  0.1563,  ..., -0.6554,  0.1122,  0.1589],
         [-0.0116, -0.1090, -0.2654,  ..., -0.2426, -0.1407, -0.3634],
         [ 0.2615, -0.2638, -0.3417,  ..., -0.3982, -0.0702, -0.2802],
         [ 0.1486, -0.1062, -0.0805,  ..., -0.2563,  0.0365, -0.2245]],

        [[-0.1096, -0.0825, -0.2981,  ..., -0.9434, -0.0526, -0.3426],
         [ 0.1255,  0.2268,  0.1573,  ..., -0.7923, -0.0502, -0.2575],
         [ 0.1959,  0.1688,  0.1829,  ..., -0.5171, -0.0310, -0.1033],
         [ 0.0883,  0.2961,  0.1629,  ..., -0.4119, -0.0872,  0.0947]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.5078e+00,        -inf,        -inf,        -inf],
          [ 1.7456e+00,  7.9463e-01,        -inf,        -inf],
          [-6.7122e-01, -4.6583e-01, -1.1462e-01,        -inf],
          [-9.9068e-01,  5.7364e+00,  2.0020e+00,  3.1056e+00]],

         [[ 1.0958e-01,        -inf,        -inf,        -inf],
          [-2.1037e+00,  4.2784e+00,        -inf,        -inf],
          [ 2.1332e+00,  2.9375e+00,  2.8176e+00,        -inf],
          [-1.6862e+00, -4.4133e+00,  4.8784e+00, -2.0407e+00]],

         [[ 3.3354e-01,        -inf,        -inf,        -inf],
          [-2.8704e-01, -5.1742e+00,        -inf,        -inf],
          [ 8.1999e-01,  5.4675e+00,  4.3005e+00,        -inf],
          [-9.2357e-01, -2.5192e+00,  1.1628e+00, -2.0765e+00]],

         [[-2.2492e+00,        -inf,        -inf,        -inf],
          [-6.0912e-01, -4.7457e-01,        -inf,        -inf],
          [-2.3870e+00, -1.9542e+00, -1.1243e+00,        -inf],
          [ 1.1479e+00, -7.2445e-02,  8.7728e-01, -1.5542e+00]],

         [[-3.3870e+00,        -inf,        -inf,        -inf],
          [-3.5863e+00, -5.2753e+00,        -inf,        -inf],
          [-2.2909e+00,  1.8100e-01,  2.6036e+00,        -inf],
          [-7.8533e-01,  1.6020e+00,  2.6061e+00, -1.5357e+00]],

         [[-1.0846e+00,        -inf,        -inf,        -inf],
          [ 5.3511e+00,  3.3276e+00,        -inf,        -inf],
          [-3.6759e-01, -3.3701e+00,  3.8988e+00,        -inf],
          [ 3.7783e+00, -2.5093e+00, -7.1184e-01, -6.0246e-01]],

         [[ 1.3497e+00,        -inf,        -inf,        -inf],
          [ 2.8782e+00, -1.9216e+00,        -inf,        -inf],
          [ 1.2115e+00,  1.3281e+00, -4.6412e+00,        -inf],
          [-4.4098e+00,  2.1534e-01, -4.0980e+00, -2.8635e-01]],

         [[ 1.2884e+00,        -inf,        -inf,        -inf],
          [-2.0822e+00,  1.6040e+00,        -inf,        -inf],
          [ 3.1671e+00,  8.0462e-01, -2.3928e+00,        -inf],
          [-5.1771e+00, -5.5430e-01, -2.1326e-01, -7.3816e-01]],

         [[ 4.3372e-01,        -inf,        -inf,        -inf],
          [-2.0154e+00,  2.8983e+00,        -inf,        -inf],
          [-1.5276e-02,  1.4719e+00,  3.2782e+00,        -inf],
          [-6.2381e-01, -1.5054e+00,  1.2991e+00, -3.6964e+00]],

         [[-4.3402e-01,        -inf,        -inf,        -inf],
          [ 5.2696e-01, -3.3880e+00,        -inf,        -inf],
          [ 2.8322e+00, -2.5878e+00, -1.7078e+00,        -inf],
          [-1.8386e+00,  4.6313e+00,  3.5126e-02, -7.0198e+00]],

         [[-1.8037e+00,        -inf,        -inf,        -inf],
          [ 2.0549e+00, -4.7725e+00,        -inf,        -inf],
          [ 1.0743e+00,  5.1930e-02,  6.0908e+00,        -inf],
          [-2.3254e+00,  8.8105e-01, -3.0156e+00,  1.0169e+00]],

         [[ 2.7159e-01,        -inf,        -inf,        -inf],
          [ 1.0596e+00,  1.3054e+00,        -inf,        -inf],
          [-1.2823e-01, -7.2808e-01,  1.3692e+00,        -inf],
          [ 1.2348e+00,  2.6069e-01,  5.0772e+00,  4.6308e-01]],

         [[-2.7061e+00,        -inf,        -inf,        -inf],
          [ 2.0162e+00,  1.8186e+00,        -inf,        -inf],
          [ 3.6670e+00, -2.0532e+00, -5.2122e-01,        -inf],
          [ 1.2327e+00, -1.8285e+00, -4.4038e-01, -3.3595e-01]],

         [[ 5.2374e-01,        -inf,        -inf,        -inf],
          [ 1.7987e+00, -1.9935e+00,        -inf,        -inf],
          [ 2.1159e-01,  9.2489e-01, -3.7294e+00,        -inf],
          [ 1.8189e+00, -2.0708e-01,  5.6535e+00, -4.5543e+00]],

         [[ 4.0565e+00,        -inf,        -inf,        -inf],
          [ 2.1722e+00,  2.0849e+00,        -inf,        -inf],
          [-2.6767e+00,  1.6618e+00, -2.9346e+00,        -inf],
          [ 2.4534e+00,  4.2280e+00,  3.3937e-01, -7.2682e-03]],

         [[ 3.2529e-01,        -inf,        -inf,        -inf],
          [-3.3120e+00, -3.4231e+00,        -inf,        -inf],
          [ 2.0799e+00,  2.3598e+00, -3.5784e+00,        -inf],
          [ 2.4797e+00,  2.7841e+00, -4.9855e-01, -3.3923e+00]],

         [[-2.1907e+00,        -inf,        -inf,        -inf],
          [-8.1425e-01,  1.0822e+00,        -inf,        -inf],
          [-2.9734e+00, -2.7023e+00, -3.3645e+00,        -inf],
          [ 2.5887e+00, -1.0178e+00,  6.0353e-01, -2.3115e+00]],

         [[ 2.0559e+00,        -inf,        -inf,        -inf],
          [ 2.8231e-01,  1.6527e+00,        -inf,        -inf],
          [-3.1235e+00, -4.9677e+00,  1.2241e+00,        -inf],
          [ 6.0050e-01,  1.6204e+00, -1.3008e+00,  1.1575e+00]],

         [[-7.2944e-01,        -inf,        -inf,        -inf],
          [ 3.2691e+00,  4.8303e-01,        -inf,        -inf],
          [ 1.6691e+00, -1.3819e+00,  4.6489e+00,        -inf],
          [ 2.2420e+00, -3.8558e+00, -2.7038e+00,  4.5550e-01]],

         [[ 1.7791e+00,        -inf,        -inf,        -inf],
          [-3.9284e-01, -2.2865e+00,        -inf,        -inf],
          [-1.9825e+00,  4.3270e+00,  2.0246e+00,        -inf],
          [ 1.7634e+00, -9.6161e-02,  6.2216e-01,  1.5886e+00]],

         [[ 9.8338e-01,        -inf,        -inf,        -inf],
          [ 3.9788e+00,  8.3609e+00,        -inf,        -inf],
          [ 1.2818e+00,  2.3094e+00,  2.8264e+00,        -inf],
          [ 8.7939e+00, -5.2657e-01,  2.1225e-01,  1.8071e+00]],

         [[ 1.5592e+00,        -inf,        -inf,        -inf],
          [-1.5548e+00, -1.5767e+00,        -inf,        -inf],
          [-2.3463e+00, -5.4746e+00,  1.9916e+00,        -inf],
          [ 2.2622e+00,  1.2433e+00, -4.4996e-01,  6.0155e-01]],

         [[ 1.1713e+00,        -inf,        -inf,        -inf],
          [-1.3458e+00,  3.2432e+00,        -inf,        -inf],
          [ 1.9991e+00, -1.1271e+00,  3.3839e+00,        -inf],
          [-8.8798e-01, -4.3390e+00,  2.6583e+00,  9.3180e+00]],

         [[-3.3413e+00,        -inf,        -inf,        -inf],
          [-4.5910e-01, -9.1125e-01,        -inf,        -inf],
          [-6.8320e+00, -2.1984e-01,  5.2269e-01,        -inf],
          [ 1.6771e+00, -1.8978e+00, -3.5583e+00,  3.7253e+00]],

         [[ 3.2598e+00,        -inf,        -inf,        -inf],
          [-1.2980e+00, -4.9116e+00,        -inf,        -inf],
          [-4.2531e+00,  7.5146e-01, -1.5657e+00,        -inf],
          [ 1.9347e+00,  2.3438e+00, -1.0273e-01,  3.4401e+00]]],


        [[[ 1.1306e+00,        -inf,        -inf,        -inf],
          [-3.5578e-01,  3.0855e-01,        -inf,        -inf],
          [-2.0742e+00, -8.3689e-02,  1.1966e+00,        -inf],
          [ 1.0607e+00, -1.0001e+00,  8.7311e-01,  2.0639e+00]],

         [[ 1.4702e+00,        -inf,        -inf,        -inf],
          [-8.5863e-01, -3.4684e+00,        -inf,        -inf],
          [ 1.3130e+00, -2.7124e-01,  4.3424e-01,        -inf],
          [-8.0551e-01, -4.6194e+00,  1.1751e+00,  1.9250e+00]],

         [[ 2.2239e-01,        -inf,        -inf,        -inf],
          [-2.9701e-01,  8.8507e-01,        -inf,        -inf],
          [ 3.6841e+00,  2.0533e+00, -3.7492e+00,        -inf],
          [-2.1577e-01,  1.6458e+00, -3.7394e+00,  1.6854e+00]],

         [[-1.6459e+00,        -inf,        -inf,        -inf],
          [ 1.1227e+00, -5.5255e-01,        -inf,        -inf],
          [ 3.5443e+00, -3.0843e+00,  7.2188e-01,        -inf],
          [-2.6052e-01,  3.0565e-01,  3.7256e+00,  1.0955e+00]],

         [[-1.4244e+00,        -inf,        -inf,        -inf],
          [-1.1754e-01,  3.2652e-01,        -inf,        -inf],
          [-9.9786e-01, -7.1044e-01, -5.7814e+00,        -inf],
          [-1.0216e+00,  2.7860e+00,  4.9612e+00,  5.3185e+00]],

         [[-2.1358e+00,        -inf,        -inf,        -inf],
          [ 6.9030e+00,  6.9276e-01,        -inf,        -inf],
          [ 9.1356e-02, -2.4962e+00,  1.3019e+00,        -inf],
          [-4.2486e-01,  3.8670e-01,  3.9696e-01, -3.6587e+00]],

         [[-6.7428e-01,        -inf,        -inf,        -inf],
          [ 1.4451e+00,  1.2091e+00,        -inf,        -inf],
          [ 4.3783e+00,  8.0861e-01,  2.6172e+00,        -inf],
          [-2.3979e+00,  1.8849e+00,  2.5074e+00,  2.2942e+00]],

         [[-1.2918e+00,        -inf,        -inf,        -inf],
          [-2.2075e+00, -1.5209e+00,        -inf,        -inf],
          [ 7.3140e-01,  4.3133e-01, -2.4872e+00,        -inf],
          [-5.6523e+00, -1.3835e+00, -5.3304e-01, -4.9844e+00]],

         [[-1.2694e+00,        -inf,        -inf,        -inf],
          [ 1.1315e+00, -1.9371e+00,        -inf,        -inf],
          [ 1.0378e+00, -4.7198e+00, -1.6115e+00,        -inf],
          [-2.3699e+00,  4.1051e+00, -1.2245e+00,  6.9775e-01]],

         [[-2.3732e+00,        -inf,        -inf,        -inf],
          [ 6.8042e-01, -5.7382e+00,        -inf,        -inf],
          [ 4.7152e-02,  2.1052e+00, -5.6258e-01,        -inf],
          [-5.8601e-01,  2.7265e+00,  1.1331e+00, -2.2969e+00]],

         [[-3.2431e+00,        -inf,        -inf,        -inf],
          [-3.1490e+00,  1.0037e-01,        -inf,        -inf],
          [ 1.9039e+00, -8.1168e-01,  1.1894e+00,        -inf],
          [-2.1033e+00,  2.4691e+00,  3.5034e+00,  2.9036e+00]],

         [[ 1.8611e+00,        -inf,        -inf,        -inf],
          [-7.3949e-01, -1.1517e+00,        -inf,        -inf],
          [-9.0443e+00,  6.2285e+00,  1.3742e+00,        -inf],
          [ 1.9484e-01,  3.0802e+00, -2.5825e+00, -6.4344e-01]],

         [[-1.7774e+00,        -inf,        -inf,        -inf],
          [-2.3726e+00,  1.3714e+00,        -inf,        -inf],
          [ 1.8113e+00,  3.8658e+00,  1.5233e+00,        -inf],
          [ 4.2296e+00, -8.2673e-01, -1.1991e-02, -6.4393e-01]],

         [[-1.2694e+00,        -inf,        -inf,        -inf],
          [ 9.4359e-01, -7.5644e-01,        -inf,        -inf],
          [-6.9516e-01,  3.9929e+00,  6.6513e-01,        -inf],
          [-6.0535e-01,  2.1112e+00, -8.5258e-01, -4.0041e+00]],

         [[ 3.7226e+00,        -inf,        -inf,        -inf],
          [-7.2671e-02,  3.0171e+00,        -inf,        -inf],
          [ 1.6624e+00, -3.5610e+00, -1.5989e+00,        -inf],
          [ 2.8259e+00,  1.7399e+00, -5.4818e-01, -2.4400e+00]],

         [[-1.5534e+00,        -inf,        -inf,        -inf],
          [ 1.4716e+00, -1.6144e+00,        -inf,        -inf],
          [ 4.7686e+00,  3.3437e+00, -4.6744e+00,        -inf],
          [ 1.0706e+00, -2.1016e+00, -4.8180e-01,  2.0086e+00]],

         [[ 6.9841e-01,        -inf,        -inf,        -inf],
          [-3.7078e-02,  1.5859e+00,        -inf,        -inf],
          [-2.5761e+00, -2.5985e-01,  1.2182e+00,        -inf],
          [ 3.5074e+00, -3.3285e+00, -3.8964e+00, -3.2301e+00]],

         [[ 3.3450e+00,        -inf,        -inf,        -inf],
          [ 2.8359e+00, -3.6014e+00,        -inf,        -inf],
          [-6.4650e-01,  1.4043e+00, -2.7634e+00,        -inf],
          [ 3.9809e+00, -2.0965e+00, -1.2877e+00,  3.2710e+00]],

         [[-1.1504e+00,        -inf,        -inf,        -inf],
          [ 4.5655e-01, -3.0980e+00,        -inf,        -inf],
          [ 1.8520e+00, -8.2402e-02,  6.7141e+00,        -inf],
          [-6.0750e+00, -2.9635e-01,  3.9180e+00, -3.7497e+00]],

         [[ 1.9900e+00,        -inf,        -inf,        -inf],
          [ 1.3731e+00, -7.6443e-01,        -inf,        -inf],
          [ 1.6222e+00,  1.5946e+00, -7.8226e-01,        -inf],
          [-9.7897e-01, -2.2994e+00, -1.9354e+00, -2.9180e+00]],

         [[-1.0571e+00,        -inf,        -inf,        -inf],
          [ 1.9565e+00,  6.0798e-01,        -inf,        -inf],
          [-4.5497e-01, -1.8143e+00,  1.4014e-01,        -inf],
          [ 2.1347e+00,  2.5272e+00, -3.0211e+00,  1.2029e+00]],

         [[ 9.3090e-01,        -inf,        -inf,        -inf],
          [ 4.4806e-02, -2.8750e+00,        -inf,        -inf],
          [-8.9387e-01, -2.9546e-01, -1.4590e+00,        -inf],
          [ 4.4328e+00, -2.8404e+00, -4.4092e+00, -1.6758e+00]],

         [[ 2.4090e+00,        -inf,        -inf,        -inf],
          [ 1.5756e+00,  4.0953e+00,        -inf,        -inf],
          [ 9.4926e-01,  1.1614e+00,  2.8318e+00,        -inf],
          [-3.0680e+00, -4.3733e+00, -1.5598e+00, -1.4194e+00]],

         [[ 6.8382e-03,        -inf,        -inf,        -inf],
          [-2.5927e+00,  5.2821e+00,        -inf,        -inf],
          [-3.4656e+00,  1.5387e+00, -5.1420e+00,        -inf],
          [ 2.1440e+00, -5.5723e+00,  4.8815e+00, -1.2710e+00]],

         [[ 7.8548e-01,        -inf,        -inf,        -inf],
          [-1.6144e+00,  1.8148e+00,        -inf,        -inf],
          [ 3.9158e+00,  3.1984e-02, -2.7220e-01,        -inf],
          [ 2.9121e+00, -5.4350e-01, -2.2585e+00,  9.4035e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.5078e+00,        -inf,        -inf,        -inf],
          [ 1.7456e+00,  7.9463e-01,        -inf,        -inf],
          [-6.7122e-01, -4.6583e-01, -1.1462e-01,        -inf],
          [-9.9068e-01,  5.7364e+00,  2.0020e+00,  3.1056e+00]],

         [[ 1.0958e-01,        -inf,        -inf,        -inf],
          [-2.1037e+00,  4.2784e+00,        -inf,        -inf],
          [ 2.1332e+00,  2.9375e+00,  2.8176e+00,        -inf],
          [-1.6862e+00, -4.4133e+00,  4.8784e+00, -2.0407e+00]],

         [[ 3.3354e-01,        -inf,        -inf,        -inf],
          [-2.8704e-01, -5.1742e+00,        -inf,        -inf],
          [ 8.1999e-01,  5.4675e+00,  4.3005e+00,        -inf],
          [-9.2357e-01, -2.5192e+00,  1.1628e+00, -2.0765e+00]],

         [[-2.2492e+00,        -inf,        -inf,        -inf],
          [-6.0912e-01, -4.7457e-01,        -inf,        -inf],
          [-2.3870e+00, -1.9542e+00, -1.1243e+00,        -inf],
          [ 1.1479e+00, -7.2445e-02,  8.7728e-01, -1.5542e+00]],

         [[-3.3870e+00,        -inf,        -inf,        -inf],
          [-3.5863e+00, -5.2753e+00,        -inf,        -inf],
          [-2.2909e+00,  1.8100e-01,  2.6036e+00,        -inf],
          [-7.8533e-01,  1.6020e+00,  2.6061e+00, -1.5357e+00]],

         [[-1.0846e+00,        -inf,        -inf,        -inf],
          [ 5.3511e+00,  3.3276e+00,        -inf,        -inf],
          [-3.6759e-01, -3.3701e+00,  3.8988e+00,        -inf],
          [ 3.7783e+00, -2.5093e+00, -7.1184e-01, -6.0246e-01]],

         [[ 1.3497e+00,        -inf,        -inf,        -inf],
          [ 2.8782e+00, -1.9216e+00,        -inf,        -inf],
          [ 1.2115e+00,  1.3281e+00, -4.6412e+00,        -inf],
          [-4.4098e+00,  2.1534e-01, -4.0980e+00, -2.8635e-01]],

         [[ 1.2884e+00,        -inf,        -inf,        -inf],
          [-2.0822e+00,  1.6040e+00,        -inf,        -inf],
          [ 3.1671e+00,  8.0462e-01, -2.3928e+00,        -inf],
          [-5.1771e+00, -5.5430e-01, -2.1326e-01, -7.3816e-01]],

         [[ 4.3372e-01,        -inf,        -inf,        -inf],
          [-2.0154e+00,  2.8983e+00,        -inf,        -inf],
          [-1.5276e-02,  1.4719e+00,  3.2782e+00,        -inf],
          [-6.2381e-01, -1.5054e+00,  1.2991e+00, -3.6964e+00]],

         [[-4.3402e-01,        -inf,        -inf,        -inf],
          [ 5.2696e-01, -3.3880e+00,        -inf,        -inf],
          [ 2.8322e+00, -2.5878e+00, -1.7078e+00,        -inf],
          [-1.8386e+00,  4.6313e+00,  3.5126e-02, -7.0198e+00]],

         [[-1.8037e+00,        -inf,        -inf,        -inf],
          [ 2.0549e+00, -4.7725e+00,        -inf,        -inf],
          [ 1.0743e+00,  5.1930e-02,  6.0908e+00,        -inf],
          [-2.3254e+00,  8.8105e-01, -3.0156e+00,  1.0169e+00]],

         [[ 2.7159e-01,        -inf,        -inf,        -inf],
          [ 1.0596e+00,  1.3054e+00,        -inf,        -inf],
          [-1.2823e-01, -7.2808e-01,  1.3692e+00,        -inf],
          [ 1.2348e+00,  2.6069e-01,  5.0772e+00,  4.6308e-01]],

         [[-2.7061e+00,        -inf,        -inf,        -inf],
          [ 2.0162e+00,  1.8186e+00,        -inf,        -inf],
          [ 3.6670e+00, -2.0532e+00, -5.2122e-01,        -inf],
          [ 1.2327e+00, -1.8285e+00, -4.4038e-01, -3.3595e-01]],

         [[ 5.2374e-01,        -inf,        -inf,        -inf],
          [ 1.7987e+00, -1.9935e+00,        -inf,        -inf],
          [ 2.1159e-01,  9.2489e-01, -3.7294e+00,        -inf],
          [ 1.8189e+00, -2.0708e-01,  5.6535e+00, -4.5543e+00]],

         [[ 4.0565e+00,        -inf,        -inf,        -inf],
          [ 2.1722e+00,  2.0849e+00,        -inf,        -inf],
          [-2.6767e+00,  1.6618e+00, -2.9346e+00,        -inf],
          [ 2.4534e+00,  4.2280e+00,  3.3937e-01, -7.2682e-03]],

         [[ 3.2529e-01,        -inf,        -inf,        -inf],
          [-3.3120e+00, -3.4231e+00,        -inf,        -inf],
          [ 2.0799e+00,  2.3598e+00, -3.5784e+00,        -inf],
          [ 2.4797e+00,  2.7841e+00, -4.9855e-01, -3.3923e+00]],

         [[-2.1907e+00,        -inf,        -inf,        -inf],
          [-8.1425e-01,  1.0822e+00,        -inf,        -inf],
          [-2.9734e+00, -2.7023e+00, -3.3645e+00,        -inf],
          [ 2.5887e+00, -1.0178e+00,  6.0353e-01, -2.3115e+00]],

         [[ 2.0559e+00,        -inf,        -inf,        -inf],
          [ 2.8231e-01,  1.6527e+00,        -inf,        -inf],
          [-3.1235e+00, -4.9677e+00,  1.2241e+00,        -inf],
          [ 6.0050e-01,  1.6204e+00, -1.3008e+00,  1.1575e+00]],

         [[-7.2944e-01,        -inf,        -inf,        -inf],
          [ 3.2691e+00,  4.8303e-01,        -inf,        -inf],
          [ 1.6691e+00, -1.3819e+00,  4.6489e+00,        -inf],
          [ 2.2420e+00, -3.8558e+00, -2.7038e+00,  4.5550e-01]],

         [[ 1.7791e+00,        -inf,        -inf,        -inf],
          [-3.9284e-01, -2.2865e+00,        -inf,        -inf],
          [-1.9825e+00,  4.3270e+00,  2.0246e+00,        -inf],
          [ 1.7634e+00, -9.6161e-02,  6.2216e-01,  1.5886e+00]],

         [[ 9.8338e-01,        -inf,        -inf,        -inf],
          [ 3.9788e+00,  8.3609e+00,        -inf,        -inf],
          [ 1.2818e+00,  2.3094e+00,  2.8264e+00,        -inf],
          [ 8.7939e+00, -5.2657e-01,  2.1225e-01,  1.8071e+00]],

         [[ 1.5592e+00,        -inf,        -inf,        -inf],
          [-1.5548e+00, -1.5767e+00,        -inf,        -inf],
          [-2.3463e+00, -5.4746e+00,  1.9916e+00,        -inf],
          [ 2.2622e+00,  1.2433e+00, -4.4996e-01,  6.0155e-01]],

         [[ 1.1713e+00,        -inf,        -inf,        -inf],
          [-1.3458e+00,  3.2432e+00,        -inf,        -inf],
          [ 1.9991e+00, -1.1271e+00,  3.3839e+00,        -inf],
          [-8.8798e-01, -4.3390e+00,  2.6583e+00,  9.3180e+00]],

         [[-3.3413e+00,        -inf,        -inf,        -inf],
          [-4.5910e-01, -9.1125e-01,        -inf,        -inf],
          [-6.8320e+00, -2.1984e-01,  5.2269e-01,        -inf],
          [ 1.6771e+00, -1.8978e+00, -3.5583e+00,  3.7253e+00]],

         [[ 3.2598e+00,        -inf,        -inf,        -inf],
          [-1.2980e+00, -4.9116e+00,        -inf,        -inf],
          [-4.2531e+00,  7.5146e-01, -1.5657e+00,        -inf],
          [ 1.9347e+00,  2.3438e+00, -1.0273e-01,  3.4401e+00]]],


        [[[ 1.1306e+00,        -inf,        -inf,        -inf],
          [-3.5578e-01,  3.0855e-01,        -inf,        -inf],
          [-2.0742e+00, -8.3689e-02,  1.1966e+00,        -inf],
          [ 1.0607e+00, -1.0001e+00,  8.7311e-01,  2.0639e+00]],

         [[ 1.4702e+00,        -inf,        -inf,        -inf],
          [-8.5863e-01, -3.4684e+00,        -inf,        -inf],
          [ 1.3130e+00, -2.7124e-01,  4.3424e-01,        -inf],
          [-8.0551e-01, -4.6194e+00,  1.1751e+00,  1.9250e+00]],

         [[ 2.2239e-01,        -inf,        -inf,        -inf],
          [-2.9701e-01,  8.8507e-01,        -inf,        -inf],
          [ 3.6841e+00,  2.0533e+00, -3.7492e+00,        -inf],
          [-2.1577e-01,  1.6458e+00, -3.7394e+00,  1.6854e+00]],

         [[-1.6459e+00,        -inf,        -inf,        -inf],
          [ 1.1227e+00, -5.5255e-01,        -inf,        -inf],
          [ 3.5443e+00, -3.0843e+00,  7.2188e-01,        -inf],
          [-2.6052e-01,  3.0565e-01,  3.7256e+00,  1.0955e+00]],

         [[-1.4244e+00,        -inf,        -inf,        -inf],
          [-1.1754e-01,  3.2652e-01,        -inf,        -inf],
          [-9.9786e-01, -7.1044e-01, -5.7814e+00,        -inf],
          [-1.0216e+00,  2.7860e+00,  4.9612e+00,  5.3185e+00]],

         [[-2.1358e+00,        -inf,        -inf,        -inf],
          [ 6.9030e+00,  6.9276e-01,        -inf,        -inf],
          [ 9.1356e-02, -2.4962e+00,  1.3019e+00,        -inf],
          [-4.2486e-01,  3.8670e-01,  3.9696e-01, -3.6587e+00]],

         [[-6.7428e-01,        -inf,        -inf,        -inf],
          [ 1.4451e+00,  1.2091e+00,        -inf,        -inf],
          [ 4.3783e+00,  8.0861e-01,  2.6172e+00,        -inf],
          [-2.3979e+00,  1.8849e+00,  2.5074e+00,  2.2942e+00]],

         [[-1.2918e+00,        -inf,        -inf,        -inf],
          [-2.2075e+00, -1.5209e+00,        -inf,        -inf],
          [ 7.3140e-01,  4.3133e-01, -2.4872e+00,        -inf],
          [-5.6523e+00, -1.3835e+00, -5.3304e-01, -4.9844e+00]],

         [[-1.2694e+00,        -inf,        -inf,        -inf],
          [ 1.1315e+00, -1.9371e+00,        -inf,        -inf],
          [ 1.0378e+00, -4.7198e+00, -1.6115e+00,        -inf],
          [-2.3699e+00,  4.1051e+00, -1.2245e+00,  6.9775e-01]],

         [[-2.3732e+00,        -inf,        -inf,        -inf],
          [ 6.8042e-01, -5.7382e+00,        -inf,        -inf],
          [ 4.7152e-02,  2.1052e+00, -5.6258e-01,        -inf],
          [-5.8601e-01,  2.7265e+00,  1.1331e+00, -2.2969e+00]],

         [[-3.2431e+00,        -inf,        -inf,        -inf],
          [-3.1490e+00,  1.0037e-01,        -inf,        -inf],
          [ 1.9039e+00, -8.1168e-01,  1.1894e+00,        -inf],
          [-2.1033e+00,  2.4691e+00,  3.5034e+00,  2.9036e+00]],

         [[ 1.8611e+00,        -inf,        -inf,        -inf],
          [-7.3949e-01, -1.1517e+00,        -inf,        -inf],
          [-9.0443e+00,  6.2285e+00,  1.3742e+00,        -inf],
          [ 1.9484e-01,  3.0802e+00, -2.5825e+00, -6.4344e-01]],

         [[-1.7774e+00,        -inf,        -inf,        -inf],
          [-2.3726e+00,  1.3714e+00,        -inf,        -inf],
          [ 1.8113e+00,  3.8658e+00,  1.5233e+00,        -inf],
          [ 4.2296e+00, -8.2673e-01, -1.1991e-02, -6.4393e-01]],

         [[-1.2694e+00,        -inf,        -inf,        -inf],
          [ 9.4359e-01, -7.5644e-01,        -inf,        -inf],
          [-6.9516e-01,  3.9929e+00,  6.6513e-01,        -inf],
          [-6.0535e-01,  2.1112e+00, -8.5258e-01, -4.0041e+00]],

         [[ 3.7226e+00,        -inf,        -inf,        -inf],
          [-7.2671e-02,  3.0171e+00,        -inf,        -inf],
          [ 1.6624e+00, -3.5610e+00, -1.5989e+00,        -inf],
          [ 2.8259e+00,  1.7399e+00, -5.4818e-01, -2.4400e+00]],

         [[-1.5534e+00,        -inf,        -inf,        -inf],
          [ 1.4716e+00, -1.6144e+00,        -inf,        -inf],
          [ 4.7686e+00,  3.3437e+00, -4.6744e+00,        -inf],
          [ 1.0706e+00, -2.1016e+00, -4.8180e-01,  2.0086e+00]],

         [[ 6.9841e-01,        -inf,        -inf,        -inf],
          [-3.7078e-02,  1.5859e+00,        -inf,        -inf],
          [-2.5761e+00, -2.5985e-01,  1.2182e+00,        -inf],
          [ 3.5074e+00, -3.3285e+00, -3.8964e+00, -3.2301e+00]],

         [[ 3.3450e+00,        -inf,        -inf,        -inf],
          [ 2.8359e+00, -3.6014e+00,        -inf,        -inf],
          [-6.4650e-01,  1.4043e+00, -2.7634e+00,        -inf],
          [ 3.9809e+00, -2.0965e+00, -1.2877e+00,  3.2710e+00]],

         [[-1.1504e+00,        -inf,        -inf,        -inf],
          [ 4.5655e-01, -3.0980e+00,        -inf,        -inf],
          [ 1.8520e+00, -8.2402e-02,  6.7141e+00,        -inf],
          [-6.0750e+00, -2.9635e-01,  3.9180e+00, -3.7497e+00]],

         [[ 1.9900e+00,        -inf,        -inf,        -inf],
          [ 1.3731e+00, -7.6443e-01,        -inf,        -inf],
          [ 1.6222e+00,  1.5946e+00, -7.8226e-01,        -inf],
          [-9.7897e-01, -2.2994e+00, -1.9354e+00, -2.9180e+00]],

         [[-1.0571e+00,        -inf,        -inf,        -inf],
          [ 1.9565e+00,  6.0798e-01,        -inf,        -inf],
          [-4.5497e-01, -1.8143e+00,  1.4014e-01,        -inf],
          [ 2.1347e+00,  2.5272e+00, -3.0211e+00,  1.2029e+00]],

         [[ 9.3090e-01,        -inf,        -inf,        -inf],
          [ 4.4806e-02, -2.8750e+00,        -inf,        -inf],
          [-8.9387e-01, -2.9546e-01, -1.4590e+00,        -inf],
          [ 4.4328e+00, -2.8404e+00, -4.4092e+00, -1.6758e+00]],

         [[ 2.4090e+00,        -inf,        -inf,        -inf],
          [ 1.5756e+00,  4.0953e+00,        -inf,        -inf],
          [ 9.4926e-01,  1.1614e+00,  2.8318e+00,        -inf],
          [-3.0680e+00, -4.3733e+00, -1.5598e+00, -1.4194e+00]],

         [[ 6.8382e-03,        -inf,        -inf,        -inf],
          [-2.5927e+00,  5.2821e+00,        -inf,        -inf],
          [-3.4656e+00,  1.5387e+00, -5.1420e+00,        -inf],
          [ 2.1440e+00, -5.5723e+00,  4.8815e+00, -1.2710e+00]],

         [[ 7.8548e-01,        -inf,        -inf,        -inf],
          [-1.6144e+00,  1.8148e+00,        -inf,        -inf],
          [ 3.9158e+00,  3.1984e-02, -2.7220e-01,        -inf],
          [ 2.9121e+00, -5.4350e-01, -2.2585e+00,  9.4035e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 3.0531e-01, -1.9250e-01,  5.6510e-01,  ...,  2.3549e-02,
            8.6076e-01, -2.3267e-01],
          [-2.0731e-01, -7.5245e-02, -7.0016e-01,  ...,  5.4409e-01,
            6.1486e-01,  4.1405e-01],
          [-8.7677e-01, -3.3913e-01,  2.0521e-01,  ...,  7.5567e-01,
            7.1226e-01, -1.0156e+00],
          ...,
          [ 8.6354e-02, -7.8057e-03, -2.0971e-02,  ...,  9.4767e-02,
           -3.6761e-01,  7.8575e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-8.8328e-02,  1.1362e-01,  7.3766e-01,  ..., -1.3666e-01,
            5.3161e-02, -2.3041e-01]],

         [[ 3.1661e-03, -8.1154e-02,  8.6046e-02,  ..., -1.1002e-01,
            7.3240e-01, -2.6244e-01],
          [ 3.3714e-01,  1.1273e-01, -4.0181e-01,  ..., -4.4364e-01,
            1.5599e-02,  5.0617e-01],
          [-8.1489e-01,  3.7683e-02,  3.6173e-01,  ...,  5.6340e-01,
            5.7647e-01, -8.5711e-01],
          ...,
          [ 5.4612e-01,  1.0877e-01, -2.4798e-01,  ...,  7.7024e-01,
            8.2656e-03,  4.7978e-02],
          [ 5.6025e-02, -8.8970e-01,  2.9954e-01,  ..., -2.0022e-01,
            4.3778e-01, -8.0339e-01],
          [-2.1911e-02, -1.9255e-01,  2.5735e-02,  ...,  3.7585e-02,
           -4.4434e-03,  6.4213e-01]],

         [[-2.0393e-01, -1.7020e-01, -3.3461e-02,  ..., -7.1551e-02,
            9.2314e-01, -2.1824e-01],
          [ 1.3665e-01,  4.4761e-02, -3.1170e-01,  ..., -1.3719e-01,
            1.0444e-01,  3.1912e-01],
          [-6.6981e-01, -4.4608e-02, -1.6538e-01,  ...,  1.6299e-01,
            2.1221e-01, -4.4972e-01],
          ...,
          [ 1.8912e-01, -3.8818e-01,  3.4013e-02,  ...,  5.3847e-01,
            2.0981e-01,  5.4105e-01],
          [ 4.4926e-01, -1.3839e-01, -8.0466e-02,  ..., -4.5364e-01,
            2.2531e-01,  1.6151e-01],
          [-3.9174e-01, -2.7539e-01, -2.0595e-01,  ..., -2.3485e-01,
           -1.9076e-01,  5.8318e-01]],

         [[-2.9643e-01,  8.5502e-02,  8.5007e-02,  ..., -3.0215e-01,
            5.5382e-01, -2.2955e-01],
          [-1.5730e-01, -7.6961e-01, -1.2930e-01,  ..., -4.2833e-01,
            5.4110e-01, -1.5416e-02],
          [-4.5329e-01, -7.5727e-02, -3.3699e-01,  ...,  7.9885e-02,
            1.8826e-01, -2.0524e-01],
          ...,
          [ 9.2351e-02,  6.4699e-01,  1.1080e-01,  ..., -2.5050e-01,
           -5.0952e-01,  1.1301e-01],
          [ 6.3936e-01, -4.0479e-01, -2.7375e-01,  ...,  3.1675e-01,
            2.0926e-01, -3.8880e-01],
          [-3.7645e-02, -3.9316e-01, -5.9359e-02,  ..., -5.1164e-01,
           -1.0133e-01,  5.6469e-01]]],


        [[[ 3.2364e-01, -3.3468e-01,  6.9948e-01,  ..., -5.9781e-02,
            5.1121e-01, -8.4603e-02],
          [-1.3558e-01, -2.9968e-01, -5.6839e-01,  ...,  5.1152e-01,
            5.4044e-02,  2.6127e-01],
          [-6.3678e-01, -5.9190e-03,  9.3103e-02,  ...,  1.7952e-01,
            3.1374e-01, -1.0115e+00],
          ...,
          [ 3.8704e-01,  1.8177e-01,  2.2731e-01,  ...,  3.7713e-01,
           -1.9282e-01,  1.1089e+00],
          [ 2.5332e-01, -1.1286e+00, -3.0145e-01,  ..., -3.1073e-01,
            3.7669e-01, -8.0754e-01],
          [-1.6136e-01,  3.4847e-02,  5.8918e-01,  ..., -5.8404e-01,
           -9.8364e-02, -2.6577e-01]],

         [[ 1.5510e-01, -1.6040e-01,  3.3523e-01,  ..., -2.8650e-02,
            2.4500e-01, -4.0546e-02],
          [-7.8750e-02, -1.7407e-01, -3.3015e-01,  ...,  2.9711e-01,
            3.1391e-02,  1.5175e-01],
          [-7.8075e-01,  1.4901e-01,  1.2167e-01,  ...,  4.0566e-01,
           -1.7681e-01, -8.7333e-01],
          ...,
          [-4.0001e-01,  1.4259e-01,  2.5023e-01,  ..., -1.6952e-01,
           -1.6839e-01, -2.6882e-02],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-2.3000e-01, -2.8023e-02,  4.0794e-01,  ...,  1.5229e-01,
           -9.3652e-02,  6.8660e-01]],

         [[ 1.7653e-02, -6.8745e-01, -1.9434e-01,  ..., -2.6153e-01,
            1.0828e-01, -4.0893e-02],
          [-7.5759e-02, -5.6480e-01, -3.9239e-01,  ..., -1.3030e-01,
            3.7148e-01,  4.3167e-01],
          [-4.9405e-01, -2.3257e-02,  9.5802e-02,  ...,  2.0818e-01,
           -1.7774e-01, -1.1403e-01],
          ...,
          [-5.5486e-02, -8.1925e-02,  6.6826e-02,  ..., -8.1203e-02,
            9.7964e-02,  3.8327e-01],
          [ 2.2058e-01, -5.0908e-01,  5.5135e-01,  ...,  2.3838e-01,
            4.0942e-01, -6.8574e-01],
          [-3.2693e-01, -1.4489e-01,  2.4533e-01,  ...,  2.3761e-01,
           -5.5064e-01,  2.4221e-01]],

         [[ 2.9586e-02, -4.4924e-01, -4.7504e-02,  ..., -1.7492e-01,
            1.0931e-01, -3.9443e-02],
          [-7.6986e-03, -2.5351e-01,  2.4354e-01,  ..., -1.6900e-01,
           -4.3409e-02,  4.1334e-01],
          [-5.0139e-01,  2.7262e-01,  1.8729e-01,  ..., -1.6799e-01,
           -3.0761e-01, -2.5773e-01],
          ...,
          [-1.0282e-01,  6.5007e-02,  1.0595e-01,  ..., -2.4675e-02,
           -7.4833e-02,  8.9120e-02],
          [ 1.7929e-01, -1.0717e-01,  1.4026e-01,  ..., -5.6450e-02,
            1.3805e-01, -5.1258e-03],
          [-2.1355e-04, -4.6410e-02,  2.2339e-01,  ...,  3.5226e-01,
           -5.1788e-01,  2.7924e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.3053, -0.1925,  0.5651,  ..., -0.1367,  0.0532, -0.2304],
         [ 0.0032, -0.0812,  0.0860,  ...,  0.0376, -0.0044,  0.6421],
         [-0.2039, -0.1702, -0.0335,  ..., -0.2348, -0.1908,  0.5832],
         [-0.2964,  0.0855,  0.0850,  ..., -0.5116, -0.1013,  0.5647]],

        [[ 0.3236, -0.3347,  0.6995,  ..., -0.5840, -0.0984, -0.2658],
         [ 0.1551, -0.1604,  0.3352,  ...,  0.1523, -0.0937,  0.6866],
         [ 0.0177, -0.6875, -0.1943,  ...,  0.2376, -0.5506,  0.2422],
         [ 0.0296, -0.4492, -0.0475,  ...,  0.3523, -0.5179,  0.2792]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1505,  0.1062,  0.1711,  ..., -0.2021, -0.3646, -0.2871],
         [ 0.1509, -0.0215, -0.0957,  ..., -0.1693, -0.2346,  0.0971],
         [ 0.3474, -0.0476,  0.0077,  ..., -0.2645, -0.1865,  0.0375],
         [ 0.2047,  0.1910,  0.1337,  ..., -0.3404, -0.2313, -0.2797]],

        [[ 0.2999,  0.4003,  0.2878,  ...,  0.1063, -0.6648,  0.0409],
         [ 0.1611,  0.0752, -0.1430,  ...,  0.2862, -0.1187,  0.1566],
         [-0.1117,  0.0275, -0.2139,  ...,  0.2324,  0.2101, -0.1721],
         [-0.0706, -0.2783, -0.1249,  ...,  0.0032,  0.1629, -0.1852]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 2.3615e+00,        -inf,        -inf,        -inf],
          [-3.6750e-02,  2.1913e+00,        -inf,        -inf],
          [-3.2010e-01,  5.8444e+00,  1.4924e-01,        -inf],
          [ 1.1892e+00, -2.2155e+00, -2.1948e+00, -5.4119e-01]],

         [[ 1.5109e+00,        -inf,        -inf,        -inf],
          [ 2.2814e-01,  2.9890e-02,        -inf,        -inf],
          [-4.5264e-01,  9.2284e-01, -1.1200e+00,        -inf],
          [ 7.6332e-01, -3.4221e+00, -4.5015e+00, -6.4677e-01]],

         [[ 4.8277e-01,        -inf,        -inf,        -inf],
          [ 2.5228e+00,  2.4949e+00,        -inf,        -inf],
          [ 4.0452e-01, -2.0226e+00, -8.2459e-01,        -inf],
          [ 1.2910e+00,  1.8301e+00,  1.5735e+00,  3.2640e+00]],

         [[ 6.4222e-01,        -inf,        -inf,        -inf],
          [ 1.5021e+00,  9.5436e-02,        -inf,        -inf],
          [ 2.6984e+00,  7.1176e-03,  5.5590e+00,        -inf],
          [ 9.1242e-01,  1.7936e+00,  4.4997e-01,  1.9307e+00]],

         [[-1.1198e+00,        -inf,        -inf,        -inf],
          [ 4.8587e-01,  4.0773e-01,        -inf,        -inf],
          [ 1.0266e+00, -3.0829e+00, -7.0716e-01,        -inf],
          [ 5.2812e+00,  1.8849e+00,  5.1311e-01, -2.4514e+00]],

         [[-1.6439e+00,        -inf,        -inf,        -inf],
          [ 4.1466e+00,  4.8063e+00,        -inf,        -inf],
          [ 4.4868e+00, -2.1116e+00,  2.9152e-01,        -inf],
          [ 2.6258e+00,  3.3070e+00,  5.1924e-01,  1.8851e-01]],

         [[-1.2781e+00,        -inf,        -inf,        -inf],
          [-4.8725e-01,  4.6734e+00,        -inf,        -inf],
          [ 2.5922e-01,  2.7710e+00, -3.3926e-01,        -inf],
          [-2.7047e+00, -2.9937e+00,  2.9464e+00, -1.6083e+00]],

         [[-1.0140e+01,        -inf,        -inf,        -inf],
          [-2.0900e+00,  2.8889e+00,        -inf,        -inf],
          [-3.8655e+00, -1.5538e+00,  8.9731e-01,        -inf],
          [-4.3093e+00, -2.8366e+00,  4.0860e+00, -1.1261e+00]],

         [[-4.6214e+00,        -inf,        -inf,        -inf],
          [ 1.5272e+00,  2.9663e+00,        -inf,        -inf],
          [-2.2817e+00,  1.3888e+00, -3.5307e+00,        -inf],
          [-4.1220e-01,  5.1511e-01,  1.7069e+00, -1.2289e+00]],

         [[-4.2393e+00,        -inf,        -inf,        -inf],
          [ 5.0328e+00, -3.2734e+00,        -inf,        -inf],
          [-3.5904e+00, -1.3949e+00, -1.2731e+00,        -inf],
          [ 5.2811e-01, -1.3549e+00, -1.5701e+00, -1.4925e+00]],

         [[ 1.6370e+00,        -inf,        -inf,        -inf],
          [-6.0845e+00,  2.1817e+00,        -inf,        -inf],
          [ 9.0710e-01, -3.6386e+00,  1.7458e+00,        -inf],
          [ 3.1541e+00, -2.4369e+00,  1.6054e+00,  2.2678e+00]],

         [[ 5.3977e+00,        -inf,        -inf,        -inf],
          [-3.5312e-01,  1.8427e+00,        -inf,        -inf],
          [-1.5989e+00,  4.2227e-01, -1.0084e+00,        -inf],
          [ 5.3922e+00,  3.5589e+00,  1.5897e+00, -2.3212e+00]],

         [[ 3.1362e-01,        -inf,        -inf,        -inf],
          [ 3.6833e+00,  7.0633e-01,        -inf,        -inf],
          [ 2.6900e+00, -5.2375e-01,  1.0262e+00,        -inf],
          [ 2.4808e+00,  1.5295e-01, -4.2241e+00, -3.5807e+00]],

         [[-3.3103e+00,        -inf,        -inf,        -inf],
          [ 2.5351e+00, -1.9595e-01,        -inf,        -inf],
          [ 1.7014e+00,  3.5852e+00,  2.0164e+00,        -inf],
          [ 4.7176e-01,  2.0258e+00,  7.4399e-02,  5.1867e+00]],

         [[-2.7388e-01,        -inf,        -inf,        -inf],
          [-1.4767e-01, -1.3298e-01,        -inf,        -inf],
          [ 3.0129e+00, -3.3749e-01,  2.0266e+00,        -inf],
          [ 2.5920e+00,  1.1880e+00,  3.8376e+00,  4.2901e+00]],

         [[-1.3865e+00,        -inf,        -inf,        -inf],
          [-1.9914e+00, -2.6432e+00,        -inf,        -inf],
          [ 3.4629e+00,  1.0114e+00,  1.4026e+00,        -inf],
          [ 1.2999e-01,  3.4845e+00, -1.2406e-01,  6.0507e-01]],

         [[ 3.2831e+00,        -inf,        -inf,        -inf],
          [-9.2684e+00, -1.9909e+00,        -inf,        -inf],
          [-3.2273e+00, -2.0161e+00,  1.4774e+00,        -inf],
          [ 1.5659e+00, -1.3386e+00,  3.4660e+00, -9.3998e-01]],

         [[-5.5398e+00,        -inf,        -inf,        -inf],
          [-1.6404e+00, -2.3932e+00,        -inf,        -inf],
          [ 2.9453e+00, -2.3062e+00,  2.6109e+00,        -inf],
          [-4.0431e+00,  1.3199e+00, -1.9210e+00, -4.2383e+00]],

         [[ 1.7926e+00,        -inf,        -inf,        -inf],
          [ 2.2477e+00,  4.7820e-01,        -inf,        -inf],
          [-3.8953e+00, -8.5108e-01, -2.8880e+00,        -inf],
          [-1.7105e-01, -3.0132e+00,  5.8429e-02,  7.1031e-01]],

         [[ 4.4479e-01,        -inf,        -inf,        -inf],
          [-1.1237e+00,  2.3183e+00,        -inf,        -inf],
          [ 1.6602e+00, -4.1885e+00,  1.1890e+00,        -inf],
          [ 1.3726e+00, -1.0403e+00, -1.6001e+00, -1.0224e+00]],

         [[-9.1142e-01,        -inf,        -inf,        -inf],
          [ 1.9026e+00, -2.1092e+00,        -inf,        -inf],
          [-6.1480e+00,  1.5133e+00, -6.6412e-01,        -inf],
          [-2.2568e+00,  7.7361e-02, -5.1516e-01,  4.2176e+00]],

         [[-5.1669e+00,        -inf,        -inf,        -inf],
          [-5.5866e+00,  1.8792e+00,        -inf,        -inf],
          [ 1.3957e+00, -5.3807e-01,  1.4385e+00,        -inf],
          [ 1.7399e+00, -2.1051e+00,  7.9696e-01, -6.1108e+00]],

         [[-1.1054e+00,        -inf,        -inf,        -inf],
          [-3.7328e-01, -3.9720e+00,        -inf,        -inf],
          [-2.1959e+00, -2.1694e+00,  3.9366e+00,        -inf],
          [ 1.0921e+00,  4.8834e-01, -3.1535e-02, -5.0577e+00]],

         [[ 1.5128e+00,        -inf,        -inf,        -inf],
          [-5.3030e-01,  1.9668e+00,        -inf,        -inf],
          [-2.7083e+00, -1.9026e+00,  2.0985e+00,        -inf],
          [ 1.2966e+00,  3.1747e+00, -2.1145e+00,  3.4456e+00]],

         [[ 1.5043e-02,        -inf,        -inf,        -inf],
          [ 6.0479e+00,  1.1588e+00,        -inf,        -inf],
          [-5.2599e+00, -7.1997e+00, -2.2343e+00,        -inf],
          [-1.1101e+00, -3.6343e-01, -1.0990e+00,  2.1983e-01]]],


        [[[ 1.2047e+00,        -inf,        -inf,        -inf],
          [ 2.9535e+00, -1.7894e+00,        -inf,        -inf],
          [ 1.5026e-01, -1.5690e+00,  1.0091e+00,        -inf],
          [-1.1103e+00,  2.2027e+00,  2.9141e+00, -3.1124e+00]],

         [[ 8.8521e-01,        -inf,        -inf,        -inf],
          [ 6.3180e-01,  3.8652e+00,        -inf,        -inf],
          [-1.2943e+00,  5.4497e+00,  3.2926e+00,        -inf],
          [-7.9301e-01,  7.6619e-01, -3.3708e+00,  4.1526e+00]],

         [[-6.1168e-04,        -inf,        -inf,        -inf],
          [ 4.5474e+00,  2.8218e+00,        -inf,        -inf],
          [-2.3729e-03, -5.1054e-01, -4.2200e+00,        -inf],
          [ 2.7009e+00, -2.3366e-01, -1.4739e+00,  1.2037e+00]],

         [[-1.4532e+00,        -inf,        -inf,        -inf],
          [-7.1058e+00, -4.8108e-01,        -inf,        -inf],
          [ 3.7233e+00,  7.0754e+00, -8.4139e-01,        -inf],
          [ 1.4712e-01, -1.8138e-01,  1.7783e+00, -1.3036e-02]],

         [[ 3.5617e-01,        -inf,        -inf,        -inf],
          [-1.1891e+00,  2.0231e+00,        -inf,        -inf],
          [ 2.9736e+00, -4.2988e+00,  3.8284e-01,        -inf],
          [-1.1080e+00,  8.3586e+00, -3.3307e+00,  3.1884e+00]],

         [[-1.1311e+00,        -inf,        -inf,        -inf],
          [ 3.5898e+00,  1.1506e+00,        -inf,        -inf],
          [ 2.2009e+00, -3.8343e+00,  8.3053e-01,        -inf],
          [ 3.2384e+00, -1.4139e+00,  4.0282e+00, -8.6176e-01]],

         [[-3.5931e+00,        -inf,        -inf,        -inf],
          [-2.8255e+00,  1.8933e+00,        -inf,        -inf],
          [-2.6183e+00, -3.8181e+00, -3.6872e+00,        -inf],
          [-3.2657e+00, -1.6164e+00,  2.6908e+00, -3.1297e+00]],

         [[-4.8600e+00,        -inf,        -inf,        -inf],
          [-1.5899e+00, -1.2641e+00,        -inf,        -inf],
          [-1.3207e+00, -1.4821e+00, -2.1074e+00,        -inf],
          [-5.2451e+00,  1.0572e+00,  2.0308e+00,  1.7864e+00]],

         [[-1.2900e+00,        -inf,        -inf,        -inf],
          [ 6.5322e+00,  1.9514e+00,        -inf,        -inf],
          [-4.5766e+00,  3.4416e-03, -2.1517e+00,        -inf],
          [-9.6485e-01, -3.0499e+00,  3.1314e+00, -2.8398e+00]],

         [[-3.1549e+00,        -inf,        -inf,        -inf],
          [ 1.0907e+00,  2.7202e+00,        -inf,        -inf],
          [-2.9134e+00, -4.4008e+00,  3.9067e+00,        -inf],
          [ 1.5583e+00, -3.4251e+00, -1.3648e+00,  3.7970e+00]],

         [[ 2.4248e-01,        -inf,        -inf,        -inf],
          [ 1.2109e+00,  8.7765e-01,        -inf,        -inf],
          [ 9.9777e-02, -4.0617e-01,  4.3716e-01,        -inf],
          [ 4.4886e-01, -4.4002e+00,  3.0460e+00,  2.2933e+00]],

         [[ 5.2600e+00,        -inf,        -inf,        -inf],
          [-1.0504e+00,  4.8276e-01,        -inf,        -inf],
          [ 1.8062e-01, -2.9124e+00, -7.6516e-01,        -inf],
          [ 4.7209e+00, -4.3914e-01, -2.2320e+00, -2.6928e-01]],

         [[ 3.9120e-02,        -inf,        -inf,        -inf],
          [ 3.4048e+00,  3.3965e+00,        -inf,        -inf],
          [ 4.5588e+00, -5.1062e-01,  8.3087e-01,        -inf],
          [ 1.4161e-01,  1.9211e-01, -1.8660e+00,  1.4172e+00]],

         [[-3.7596e+00,        -inf,        -inf,        -inf],
          [ 5.0299e-01,  2.0739e+00,        -inf,        -inf],
          [ 2.7589e+00, -4.0202e-01,  1.6014e+00,        -inf],
          [ 1.4510e+00, -6.6057e+00, -1.0838e+00,  5.9989e+00]],

         [[ 2.2212e+00,        -inf,        -inf,        -inf],
          [ 2.9639e-02,  1.3050e+00,        -inf,        -inf],
          [-8.6482e-02,  7.3785e-01, -5.7205e+00,        -inf],
          [ 1.1246e+00,  4.6698e+00, -1.5469e+00,  1.0356e-01]],

         [[-2.5388e+00,        -inf,        -inf,        -inf],
          [-1.9724e+00,  2.5589e+00,        -inf,        -inf],
          [ 7.1463e+00,  8.1357e-01, -2.8255e+00,        -inf],
          [-5.3231e-02,  2.8795e+00,  1.7438e+00, -4.5382e+00]],

         [[ 3.2958e+00,        -inf,        -inf,        -inf],
          [-3.3045e+00, -2.2867e+00,        -inf,        -inf],
          [-1.1110e+00, -1.9665e+00,  2.2510e+00,        -inf],
          [ 2.6878e+00,  5.6548e+00, -1.4684e+00,  2.0541e+00]],

         [[-5.7551e+00,        -inf,        -inf,        -inf],
          [ 3.3419e+00, -2.2739e+00,        -inf,        -inf],
          [-3.5009e-01, -8.4794e-01,  5.8602e-01,        -inf],
          [-2.3840e+00,  5.6784e+00, -1.8328e+00,  6.5010e+00]],

         [[ 7.2519e-01,        -inf,        -inf,        -inf],
          [-1.0743e+00, -8.0388e-01,        -inf,        -inf],
          [ 5.0431e+00,  1.2879e+00, -5.8666e-01,        -inf],
          [-2.2467e+00,  1.1553e+00, -8.4501e-01,  5.3622e+00]],

         [[-2.0769e-01,        -inf,        -inf,        -inf],
          [ 5.8400e-02,  3.3684e+00,        -inf,        -inf],
          [-2.4653e+00,  3.5079e+00, -2.4558e+00,        -inf],
          [ 2.0511e+00,  2.6890e+00,  2.7423e+00, -5.3247e+00]],

         [[-2.7656e-01,        -inf,        -inf,        -inf],
          [ 5.2152e-02, -5.6054e-02,        -inf,        -inf],
          [-5.7194e+00, -3.5269e+00, -1.5359e+00,        -inf],
          [-4.3449e+00, -2.3971e+00,  3.6888e+00,  8.9190e-01]],

         [[-3.7411e+00,        -inf,        -inf,        -inf],
          [-6.6466e-01,  3.7668e+00,        -inf,        -inf],
          [ 3.0199e+00, -3.1365e-02, -3.6465e+00,        -inf],
          [ 2.4339e+00,  2.9661e+00,  1.7453e+00, -9.6473e-01]],

         [[-1.1827e+00,        -inf,        -inf,        -inf],
          [ 5.1838e-01, -4.5148e+00,        -inf,        -inf],
          [ 4.0896e+00, -2.0015e+00,  3.9972e+00,        -inf],
          [-4.6337e+00,  2.4440e+00, -3.6221e-01, -3.9592e+00]],

         [[ 2.1301e+00,        -inf,        -inf,        -inf],
          [ 4.3313e-01, -4.6027e+00,        -inf,        -inf],
          [-6.5294e+00, -1.4804e-01,  7.1179e+00,        -inf],
          [-2.1592e-01, -1.8870e+00, -1.6577e+00,  3.9376e+00]],

         [[-1.6816e+00,        -inf,        -inf,        -inf],
          [ 4.7463e+00,  1.9164e+00,        -inf,        -inf],
          [-1.8480e-01,  2.0985e+00, -6.8108e-01,        -inf],
          [-3.5706e+00, -3.6783e+00,  2.8711e+00, -2.3503e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 2.3615e+00,        -inf,        -inf,        -inf],
          [-3.6750e-02,  2.1913e+00,        -inf,        -inf],
          [-3.2010e-01,  5.8444e+00,  1.4924e-01,        -inf],
          [ 1.1892e+00, -2.2155e+00, -2.1948e+00, -5.4119e-01]],

         [[ 1.5109e+00,        -inf,        -inf,        -inf],
          [ 2.2814e-01,  2.9890e-02,        -inf,        -inf],
          [-4.5264e-01,  9.2284e-01, -1.1200e+00,        -inf],
          [ 7.6332e-01, -3.4221e+00, -4.5015e+00, -6.4677e-01]],

         [[ 4.8277e-01,        -inf,        -inf,        -inf],
          [ 2.5228e+00,  2.4949e+00,        -inf,        -inf],
          [ 4.0452e-01, -2.0226e+00, -8.2459e-01,        -inf],
          [ 1.2910e+00,  1.8301e+00,  1.5735e+00,  3.2640e+00]],

         [[ 6.4222e-01,        -inf,        -inf,        -inf],
          [ 1.5021e+00,  9.5436e-02,        -inf,        -inf],
          [ 2.6984e+00,  7.1176e-03,  5.5590e+00,        -inf],
          [ 9.1242e-01,  1.7936e+00,  4.4997e-01,  1.9307e+00]],

         [[-1.1198e+00,        -inf,        -inf,        -inf],
          [ 4.8587e-01,  4.0773e-01,        -inf,        -inf],
          [ 1.0266e+00, -3.0829e+00, -7.0716e-01,        -inf],
          [ 5.2812e+00,  1.8849e+00,  5.1311e-01, -2.4514e+00]],

         [[-1.6439e+00,        -inf,        -inf,        -inf],
          [ 4.1466e+00,  4.8063e+00,        -inf,        -inf],
          [ 4.4868e+00, -2.1116e+00,  2.9152e-01,        -inf],
          [ 2.6258e+00,  3.3070e+00,  5.1924e-01,  1.8851e-01]],

         [[-1.2781e+00,        -inf,        -inf,        -inf],
          [-4.8725e-01,  4.6734e+00,        -inf,        -inf],
          [ 2.5922e-01,  2.7710e+00, -3.3926e-01,        -inf],
          [-2.7047e+00, -2.9937e+00,  2.9464e+00, -1.6083e+00]],

         [[-1.0140e+01,        -inf,        -inf,        -inf],
          [-2.0900e+00,  2.8889e+00,        -inf,        -inf],
          [-3.8655e+00, -1.5538e+00,  8.9731e-01,        -inf],
          [-4.3093e+00, -2.8366e+00,  4.0860e+00, -1.1261e+00]],

         [[-4.6214e+00,        -inf,        -inf,        -inf],
          [ 1.5272e+00,  2.9663e+00,        -inf,        -inf],
          [-2.2817e+00,  1.3888e+00, -3.5307e+00,        -inf],
          [-4.1220e-01,  5.1511e-01,  1.7069e+00, -1.2289e+00]],

         [[-4.2393e+00,        -inf,        -inf,        -inf],
          [ 5.0328e+00, -3.2734e+00,        -inf,        -inf],
          [-3.5904e+00, -1.3949e+00, -1.2731e+00,        -inf],
          [ 5.2811e-01, -1.3549e+00, -1.5701e+00, -1.4925e+00]],

         [[ 1.6370e+00,        -inf,        -inf,        -inf],
          [-6.0845e+00,  2.1817e+00,        -inf,        -inf],
          [ 9.0710e-01, -3.6386e+00,  1.7458e+00,        -inf],
          [ 3.1541e+00, -2.4369e+00,  1.6054e+00,  2.2678e+00]],

         [[ 5.3977e+00,        -inf,        -inf,        -inf],
          [-3.5312e-01,  1.8427e+00,        -inf,        -inf],
          [-1.5989e+00,  4.2227e-01, -1.0084e+00,        -inf],
          [ 5.3922e+00,  3.5589e+00,  1.5897e+00, -2.3212e+00]],

         [[ 3.1362e-01,        -inf,        -inf,        -inf],
          [ 3.6833e+00,  7.0633e-01,        -inf,        -inf],
          [ 2.6900e+00, -5.2375e-01,  1.0262e+00,        -inf],
          [ 2.4808e+00,  1.5295e-01, -4.2241e+00, -3.5807e+00]],

         [[-3.3103e+00,        -inf,        -inf,        -inf],
          [ 2.5351e+00, -1.9595e-01,        -inf,        -inf],
          [ 1.7014e+00,  3.5852e+00,  2.0164e+00,        -inf],
          [ 4.7176e-01,  2.0258e+00,  7.4399e-02,  5.1867e+00]],

         [[-2.7388e-01,        -inf,        -inf,        -inf],
          [-1.4767e-01, -1.3298e-01,        -inf,        -inf],
          [ 3.0129e+00, -3.3749e-01,  2.0266e+00,        -inf],
          [ 2.5920e+00,  1.1880e+00,  3.8376e+00,  4.2901e+00]],

         [[-1.3865e+00,        -inf,        -inf,        -inf],
          [-1.9914e+00, -2.6432e+00,        -inf,        -inf],
          [ 3.4629e+00,  1.0114e+00,  1.4026e+00,        -inf],
          [ 1.2999e-01,  3.4845e+00, -1.2406e-01,  6.0507e-01]],

         [[ 3.2831e+00,        -inf,        -inf,        -inf],
          [-9.2684e+00, -1.9909e+00,        -inf,        -inf],
          [-3.2273e+00, -2.0161e+00,  1.4774e+00,        -inf],
          [ 1.5659e+00, -1.3386e+00,  3.4660e+00, -9.3998e-01]],

         [[-5.5398e+00,        -inf,        -inf,        -inf],
          [-1.6404e+00, -2.3932e+00,        -inf,        -inf],
          [ 2.9453e+00, -2.3062e+00,  2.6109e+00,        -inf],
          [-4.0431e+00,  1.3199e+00, -1.9210e+00, -4.2383e+00]],

         [[ 1.7926e+00,        -inf,        -inf,        -inf],
          [ 2.2477e+00,  4.7820e-01,        -inf,        -inf],
          [-3.8953e+00, -8.5108e-01, -2.8880e+00,        -inf],
          [-1.7105e-01, -3.0132e+00,  5.8429e-02,  7.1031e-01]],

         [[ 4.4479e-01,        -inf,        -inf,        -inf],
          [-1.1237e+00,  2.3183e+00,        -inf,        -inf],
          [ 1.6602e+00, -4.1885e+00,  1.1890e+00,        -inf],
          [ 1.3726e+00, -1.0403e+00, -1.6001e+00, -1.0224e+00]],

         [[-9.1142e-01,        -inf,        -inf,        -inf],
          [ 1.9026e+00, -2.1092e+00,        -inf,        -inf],
          [-6.1480e+00,  1.5133e+00, -6.6412e-01,        -inf],
          [-2.2568e+00,  7.7361e-02, -5.1516e-01,  4.2176e+00]],

         [[-5.1669e+00,        -inf,        -inf,        -inf],
          [-5.5866e+00,  1.8792e+00,        -inf,        -inf],
          [ 1.3957e+00, -5.3807e-01,  1.4385e+00,        -inf],
          [ 1.7399e+00, -2.1051e+00,  7.9696e-01, -6.1108e+00]],

         [[-1.1054e+00,        -inf,        -inf,        -inf],
          [-3.7328e-01, -3.9720e+00,        -inf,        -inf],
          [-2.1959e+00, -2.1694e+00,  3.9366e+00,        -inf],
          [ 1.0921e+00,  4.8834e-01, -3.1535e-02, -5.0577e+00]],

         [[ 1.5128e+00,        -inf,        -inf,        -inf],
          [-5.3030e-01,  1.9668e+00,        -inf,        -inf],
          [-2.7083e+00, -1.9026e+00,  2.0985e+00,        -inf],
          [ 1.2966e+00,  3.1747e+00, -2.1145e+00,  3.4456e+00]],

         [[ 1.5043e-02,        -inf,        -inf,        -inf],
          [ 6.0479e+00,  1.1588e+00,        -inf,        -inf],
          [-5.2599e+00, -7.1997e+00, -2.2343e+00,        -inf],
          [-1.1101e+00, -3.6343e-01, -1.0990e+00,  2.1983e-01]]],


        [[[ 1.2047e+00,        -inf,        -inf,        -inf],
          [ 2.9535e+00, -1.7894e+00,        -inf,        -inf],
          [ 1.5026e-01, -1.5690e+00,  1.0091e+00,        -inf],
          [-1.1103e+00,  2.2027e+00,  2.9141e+00, -3.1124e+00]],

         [[ 8.8521e-01,        -inf,        -inf,        -inf],
          [ 6.3180e-01,  3.8652e+00,        -inf,        -inf],
          [-1.2943e+00,  5.4497e+00,  3.2926e+00,        -inf],
          [-7.9301e-01,  7.6619e-01, -3.3708e+00,  4.1526e+00]],

         [[-6.1168e-04,        -inf,        -inf,        -inf],
          [ 4.5474e+00,  2.8218e+00,        -inf,        -inf],
          [-2.3729e-03, -5.1054e-01, -4.2200e+00,        -inf],
          [ 2.7009e+00, -2.3366e-01, -1.4739e+00,  1.2037e+00]],

         [[-1.4532e+00,        -inf,        -inf,        -inf],
          [-7.1058e+00, -4.8108e-01,        -inf,        -inf],
          [ 3.7233e+00,  7.0754e+00, -8.4139e-01,        -inf],
          [ 1.4712e-01, -1.8138e-01,  1.7783e+00, -1.3036e-02]],

         [[ 3.5617e-01,        -inf,        -inf,        -inf],
          [-1.1891e+00,  2.0231e+00,        -inf,        -inf],
          [ 2.9736e+00, -4.2988e+00,  3.8284e-01,        -inf],
          [-1.1080e+00,  8.3586e+00, -3.3307e+00,  3.1884e+00]],

         [[-1.1311e+00,        -inf,        -inf,        -inf],
          [ 3.5898e+00,  1.1506e+00,        -inf,        -inf],
          [ 2.2009e+00, -3.8343e+00,  8.3053e-01,        -inf],
          [ 3.2384e+00, -1.4139e+00,  4.0282e+00, -8.6176e-01]],

         [[-3.5931e+00,        -inf,        -inf,        -inf],
          [-2.8255e+00,  1.8933e+00,        -inf,        -inf],
          [-2.6183e+00, -3.8181e+00, -3.6872e+00,        -inf],
          [-3.2657e+00, -1.6164e+00,  2.6908e+00, -3.1297e+00]],

         [[-4.8600e+00,        -inf,        -inf,        -inf],
          [-1.5899e+00, -1.2641e+00,        -inf,        -inf],
          [-1.3207e+00, -1.4821e+00, -2.1074e+00,        -inf],
          [-5.2451e+00,  1.0572e+00,  2.0308e+00,  1.7864e+00]],

         [[-1.2900e+00,        -inf,        -inf,        -inf],
          [ 6.5322e+00,  1.9514e+00,        -inf,        -inf],
          [-4.5766e+00,  3.4416e-03, -2.1517e+00,        -inf],
          [-9.6485e-01, -3.0499e+00,  3.1314e+00, -2.8398e+00]],

         [[-3.1549e+00,        -inf,        -inf,        -inf],
          [ 1.0907e+00,  2.7202e+00,        -inf,        -inf],
          [-2.9134e+00, -4.4008e+00,  3.9067e+00,        -inf],
          [ 1.5583e+00, -3.4251e+00, -1.3648e+00,  3.7970e+00]],

         [[ 2.4248e-01,        -inf,        -inf,        -inf],
          [ 1.2109e+00,  8.7765e-01,        -inf,        -inf],
          [ 9.9777e-02, -4.0617e-01,  4.3716e-01,        -inf],
          [ 4.4886e-01, -4.4002e+00,  3.0460e+00,  2.2933e+00]],

         [[ 5.2600e+00,        -inf,        -inf,        -inf],
          [-1.0504e+00,  4.8276e-01,        -inf,        -inf],
          [ 1.8062e-01, -2.9124e+00, -7.6516e-01,        -inf],
          [ 4.7209e+00, -4.3914e-01, -2.2320e+00, -2.6928e-01]],

         [[ 3.9120e-02,        -inf,        -inf,        -inf],
          [ 3.4048e+00,  3.3965e+00,        -inf,        -inf],
          [ 4.5588e+00, -5.1062e-01,  8.3087e-01,        -inf],
          [ 1.4161e-01,  1.9211e-01, -1.8660e+00,  1.4172e+00]],

         [[-3.7596e+00,        -inf,        -inf,        -inf],
          [ 5.0299e-01,  2.0739e+00,        -inf,        -inf],
          [ 2.7589e+00, -4.0202e-01,  1.6014e+00,        -inf],
          [ 1.4510e+00, -6.6057e+00, -1.0838e+00,  5.9989e+00]],

         [[ 2.2212e+00,        -inf,        -inf,        -inf],
          [ 2.9639e-02,  1.3050e+00,        -inf,        -inf],
          [-8.6482e-02,  7.3785e-01, -5.7205e+00,        -inf],
          [ 1.1246e+00,  4.6698e+00, -1.5469e+00,  1.0356e-01]],

         [[-2.5388e+00,        -inf,        -inf,        -inf],
          [-1.9724e+00,  2.5589e+00,        -inf,        -inf],
          [ 7.1463e+00,  8.1357e-01, -2.8255e+00,        -inf],
          [-5.3231e-02,  2.8795e+00,  1.7438e+00, -4.5382e+00]],

         [[ 3.2958e+00,        -inf,        -inf,        -inf],
          [-3.3045e+00, -2.2867e+00,        -inf,        -inf],
          [-1.1110e+00, -1.9665e+00,  2.2510e+00,        -inf],
          [ 2.6878e+00,  5.6548e+00, -1.4684e+00,  2.0541e+00]],

         [[-5.7551e+00,        -inf,        -inf,        -inf],
          [ 3.3419e+00, -2.2739e+00,        -inf,        -inf],
          [-3.5009e-01, -8.4794e-01,  5.8602e-01,        -inf],
          [-2.3840e+00,  5.6784e+00, -1.8328e+00,  6.5010e+00]],

         [[ 7.2519e-01,        -inf,        -inf,        -inf],
          [-1.0743e+00, -8.0388e-01,        -inf,        -inf],
          [ 5.0431e+00,  1.2879e+00, -5.8666e-01,        -inf],
          [-2.2467e+00,  1.1553e+00, -8.4501e-01,  5.3622e+00]],

         [[-2.0769e-01,        -inf,        -inf,        -inf],
          [ 5.8400e-02,  3.3684e+00,        -inf,        -inf],
          [-2.4653e+00,  3.5079e+00, -2.4558e+00,        -inf],
          [ 2.0511e+00,  2.6890e+00,  2.7423e+00, -5.3247e+00]],

         [[-2.7656e-01,        -inf,        -inf,        -inf],
          [ 5.2152e-02, -5.6054e-02,        -inf,        -inf],
          [-5.7194e+00, -3.5269e+00, -1.5359e+00,        -inf],
          [-4.3449e+00, -2.3971e+00,  3.6888e+00,  8.9190e-01]],

         [[-3.7411e+00,        -inf,        -inf,        -inf],
          [-6.6466e-01,  3.7668e+00,        -inf,        -inf],
          [ 3.0199e+00, -3.1365e-02, -3.6465e+00,        -inf],
          [ 2.4339e+00,  2.9661e+00,  1.7453e+00, -9.6473e-01]],

         [[-1.1827e+00,        -inf,        -inf,        -inf],
          [ 5.1838e-01, -4.5148e+00,        -inf,        -inf],
          [ 4.0896e+00, -2.0015e+00,  3.9972e+00,        -inf],
          [-4.6337e+00,  2.4440e+00, -3.6221e-01, -3.9592e+00]],

         [[ 2.1301e+00,        -inf,        -inf,        -inf],
          [ 4.3313e-01, -4.6027e+00,        -inf,        -inf],
          [-6.5294e+00, -1.4804e-01,  7.1179e+00,        -inf],
          [-2.1592e-01, -1.8870e+00, -1.6577e+00,  3.9376e+00]],

         [[-1.6816e+00,        -inf,        -inf,        -inf],
          [ 4.7463e+00,  1.9164e+00,        -inf,        -inf],
          [-1.8480e-01,  2.0985e+00, -6.8108e-01,        -inf],
          [-3.5706e+00, -3.6783e+00,  2.8711e+00, -2.3503e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.1317e+00,  5.6047e-01,  5.2986e-02,  ...,  6.8013e-01,
           -4.2014e-01,  8.8382e-01],
          [ 3.7522e-01, -6.7652e-01,  6.2172e-01,  ...,  9.2972e-02,
           -2.4590e-01,  3.7363e-01],
          [-2.2427e-01,  1.1680e+00, -2.2125e-01,  ..., -6.6799e-01,
            1.6832e+00, -6.9232e-01],
          ...,
          [-3.3498e-01, -1.8568e-01, -4.3550e-01,  ..., -4.2758e-01,
           -2.8185e-01,  2.6997e-01],
          [-4.4822e-01, -8.2110e-01,  4.1909e-01,  ...,  1.0297e+00,
           -1.3321e+00,  2.1048e-02],
          [-2.7585e-01, -4.8375e-01, -1.6614e-01,  ..., -2.4279e-01,
           -2.0228e-01,  4.7109e-01]],

         [[-6.0113e-01,  1.7727e-01,  2.1171e-01,  ...,  1.6598e-01,
           -3.3995e-01,  2.2812e-01],
          [ 2.1004e-01, -4.9810e-01,  7.2112e-01,  ...,  5.5904e-01,
           -4.8612e-01, -1.5137e-01],
          [ 2.2713e-01,  4.9797e-01,  2.1486e-01,  ..., -1.2198e-01,
            8.4009e-01, -3.0417e-01],
          ...,
          [-2.9570e-01, -2.7667e-01, -3.5834e-02,  ..., -3.5033e-01,
           -1.1324e-01,  3.5986e-01],
          [ 2.4427e-01, -6.9762e-01, -2.9224e-03,  ...,  9.6327e-01,
           -8.0948e-01,  3.2962e-01],
          [-2.0732e-01, -4.9373e-02,  2.3902e-02,  ..., -1.5308e-02,
           -2.6147e-01, -3.8558e-02]],

         [[-1.7677e-01,  1.2205e-01,  1.4999e-01,  ...,  3.0786e-01,
            2.0519e-02, -1.5905e-02],
          [ 1.3630e-01, -3.3816e-01,  5.1459e-01,  ...,  4.2615e-01,
           -3.5901e-01, -1.4328e-01],
          [ 1.5517e-01,  5.5209e-01,  5.1461e-01,  ..., -2.1604e-01,
            4.1685e-01, -4.1826e-01],
          ...,
          [ 4.3697e-01, -2.1549e-01, -1.9022e-01,  ...,  1.3245e-01,
           -3.4904e-01,  5.8071e-01],
          [ 3.9661e-01, -5.4955e-01,  1.5010e-01,  ...,  1.2398e-01,
           -5.0662e-01,  3.1716e-01],
          [-5.2426e-01, -1.2414e-01,  3.7141e-01,  ..., -3.2625e-01,
           -7.3209e-02,  5.6581e-02]],

         [[-5.0176e-01,  2.1794e-01,  3.2042e-01,  ...,  2.7197e-01,
           -1.8021e-01,  1.8152e-01],
          [ 1.4406e-01, -1.8075e-01,  8.9821e-01,  ...,  2.7283e-01,
           -3.8957e-02, -2.6593e-01],
          [ 2.3593e-01,  1.1997e-01,  4.2848e-01,  ..., -1.3670e-01,
           -2.8721e-01,  3.4491e-01],
          ...,
          [ 1.3519e-01, -1.6365e-01,  3.8993e-03,  ..., -4.0938e-02,
           -3.1783e-01,  5.3568e-01],
          [ 1.7906e-01, -5.8544e-01,  2.8390e-01,  ...,  4.7956e-01,
           -2.5585e-01, -4.0182e-02],
          [-3.2811e-01, -2.8621e-01,  2.2953e-01,  ..., -2.1833e-01,
           -9.2988e-02,  3.4580e-01]]],


        [[[-1.0591e+00,  1.0229e+00,  5.5271e-01,  ...,  4.7179e-01,
           -4.2928e-01,  5.8006e-01],
          [ 4.8661e-01, -9.2207e-01,  6.9305e-01,  ..., -1.3728e-01,
           -5.4995e-01,  4.6399e-01],
          [-2.6492e-02,  1.2951e+00,  4.4266e-01,  ..., -8.8553e-01,
            2.0117e+00, -3.2047e-01],
          ...,
          [-6.6675e-01, -7.6723e-02, -9.9220e-01,  ..., -5.9934e-01,
           -3.2902e-01,  2.4725e-01],
          [-1.0904e-01, -5.5780e-01,  2.7003e-01,  ...,  9.6684e-01,
           -1.4824e+00, -3.8237e-01],
          [-3.8594e-01, -5.5254e-01,  5.1014e-01,  ..., -2.4259e-01,
           -1.5198e-01,  5.8620e-01]],

         [[-4.9121e-01,  5.1427e-01,  3.3912e-01,  ...,  1.1478e-01,
           -4.8092e-01,  2.1272e-01],
          [-1.6122e-01,  6.4497e-01,  4.0031e-01,  ..., -3.1442e-01,
           -9.4222e-01,  7.3486e-01],
          [-1.4669e-02,  7.1712e-01,  2.4511e-01,  ..., -4.9033e-01,
            1.1139e+00, -1.7745e-01],
          ...,
          [-3.0739e-01, -3.1081e-01, -6.7815e-01,  ..., -5.0690e-01,
           -3.2766e-01,  3.9245e-01],
          [ 3.1291e-01, -5.7450e-01,  2.3180e-01,  ...,  9.8873e-01,
           -9.8843e-01, -1.7092e-01],
          [-6.5870e-01, -7.3102e-01,  3.3909e-01,  ...,  1.1460e-01,
           -6.6346e-01,  6.3232e-01]],

         [[-4.4305e-01,  7.4954e-02, -2.2444e-02,  ...,  9.0429e-02,
           -4.2629e-01, -2.1936e-01],
          [-1.7511e-01,  5.8983e-01,  2.2935e-01,  ..., -2.2413e-01,
           -6.5667e-01,  5.0836e-01],
          [ 1.5530e-02,  8.1632e-01,  1.9454e-01,  ...,  9.4677e-02,
            3.3672e-01, -5.3261e-01],
          ...,
          [-2.0177e-01, -1.7388e-01, -4.2099e-01,  ..., -3.0750e-01,
           -1.9583e-01,  2.2714e-01],
          [ 2.6610e-01, -4.8702e-01, -3.8762e-03,  ...,  2.5106e-01,
           -1.6508e-01, -1.0553e-01],
          [-3.9418e-01, -3.5004e-01,  4.0247e-01,  ...,  2.1876e-01,
           -7.0677e-01,  5.2400e-01]],

         [[-2.4200e-01,  3.2061e-02, -3.6090e-02,  ..., -9.6519e-02,
           -4.8215e-01, -2.6262e-01],
          [-1.9820e-01,  4.0669e-01, -1.1029e-01,  ..., -1.5882e-01,
           -1.0687e-01,  1.3247e-01],
          [ 3.1036e-02,  5.7886e-01, -4.6606e-02,  ...,  9.4041e-04,
            2.2728e-01, -2.7172e-01],
          ...,
          [ 4.0206e-01, -4.9035e-03, -3.1057e-01,  ...,  2.2128e-01,
           -3.0975e-01,  5.6804e-01],
          [ 7.7813e-01, -3.4439e-01,  3.7237e-01,  ...,  8.7500e-01,
           -2.7926e-01,  7.3462e-02],
          [ 3.8556e-02,  9.8993e-02,  3.3867e-01,  ...,  3.9681e-02,
           -2.5589e-01,  1.3981e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.1317,  0.5605,  0.0530,  ..., -0.2428, -0.2023,  0.4711],
         [-0.6011,  0.1773,  0.2117,  ..., -0.0153, -0.2615, -0.0386],
         [-0.1768,  0.1221,  0.1500,  ..., -0.3262, -0.0732,  0.0566],
         [-0.5018,  0.2179,  0.3204,  ..., -0.2183, -0.0930,  0.3458]],

        [[-1.0591,  1.0229,  0.5527,  ..., -0.2426, -0.1520,  0.5862],
         [-0.4912,  0.5143,  0.3391,  ...,  0.1146, -0.6635,  0.6323],
         [-0.4430,  0.0750, -0.0224,  ...,  0.2188, -0.7068,  0.5240],
         [-0.2420,  0.0321, -0.0361,  ...,  0.0397, -0.2559,  0.1398]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.1945,  0.4596, -0.3925,  ..., -0.3736,  0.2125,  0.0502],
         [-0.4087,  0.4436, -0.2004,  ..., -0.3379, -0.3514,  0.1132],
         [-0.2656,  0.2074, -0.0479,  ..., -0.0784,  0.0435,  0.1044],
         [-0.1189,  0.1303,  0.1373,  ...,  0.1460, -0.0294, -0.0900]],

        [[-0.3227,  0.2757, -0.4914,  ..., -0.2525, -0.0310, -0.0509],
         [-0.1176,  0.1173,  0.0653,  ...,  0.0369,  0.0605, -0.4749],
         [-0.0867,  0.1320, -0.2056,  ..., -0.1576, -0.0255, -0.2277],
         [-0.0613,  0.0864, -0.0974,  ..., -0.0908,  0.1196,  0.0458]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.8394,    -inf,    -inf,    -inf],
          [ 0.7334,  4.9999,    -inf,    -inf],
          [-4.7642, -1.3647, -4.3974,    -inf],
          [ 1.2880,  1.9807, -4.0467, -2.5017]],

         [[ 2.3662,    -inf,    -inf,    -inf],
          [-1.5073,  0.8634,    -inf,    -inf],
          [-1.1021, -0.4824,  3.8043,    -inf],
          [ 0.4144, -1.1588, -0.4596,  0.0535]],

         [[ 1.2090,    -inf,    -inf,    -inf],
          [-5.0461, -1.1192,    -inf,    -inf],
          [-6.8600, -5.0838, -1.4440,    -inf],
          [ 2.2526,  1.2868, -0.0744, -2.9602]],

         [[ 4.4944,    -inf,    -inf,    -inf],
          [-0.9574,  5.3704,    -inf,    -inf],
          [-2.6472,  3.0131, -0.0832,    -inf],
          [-4.1010, -0.3562, -3.3603, -1.2769]],

         [[ 4.0146,    -inf,    -inf,    -inf],
          [ 5.8258, -3.2999,    -inf,    -inf],
          [-1.2656,  3.7721,  1.6837,    -inf],
          [ 0.4144,  2.3718, -4.1113,  0.2744]],

         [[ 0.0791,    -inf,    -inf,    -inf],
          [-1.9350,  0.0826,    -inf,    -inf],
          [-0.7409,  1.7243, -1.5021,    -inf],
          [-0.4369,  5.6139,  2.0024,  1.4937]],

         [[ 0.7035,    -inf,    -inf,    -inf],
          [-1.7693, -1.6201,    -inf,    -inf],
          [-0.4489, -0.3611,  0.3602,    -inf],
          [ 1.3968,  1.9855,  4.4842, -2.2546]],

         [[-1.1960,    -inf,    -inf,    -inf],
          [ 0.3321,  4.0340,    -inf,    -inf],
          [-0.6888, -2.6278, -0.5421,    -inf],
          [-5.5069, -0.4704,  4.8826, -6.3039]],

         [[-2.3174,    -inf,    -inf,    -inf],
          [ 2.2223,  2.4091,    -inf,    -inf],
          [ 1.8857,  0.0143,  4.7532,    -inf],
          [-2.1303,  1.3700,  0.4516,  0.1591]],

         [[ 2.0140,    -inf,    -inf,    -inf],
          [-2.1380,  1.5886,    -inf,    -inf],
          [ 6.5194,  0.9092,  1.4679,    -inf],
          [-0.0948,  1.3827, -7.1518,  2.2422]],

         [[ 0.9389,    -inf,    -inf,    -inf],
          [-0.7956,  2.0517,    -inf,    -inf],
          [ 0.8948,  0.6796, -0.1691,    -inf],
          [-1.5791, -1.1185, -3.1409,  3.6596]],

         [[ 0.9834,    -inf,    -inf,    -inf],
          [ 3.6073,  1.2661,    -inf,    -inf],
          [-0.7890, -4.4132, -3.0870,    -inf],
          [-4.1020,  0.7440,  0.8280, -1.6090]],

         [[-1.6191,    -inf,    -inf,    -inf],
          [ 1.8552,  1.2519,    -inf,    -inf],
          [-4.0877, -2.2655,  1.6170,    -inf],
          [ 1.2650, -2.0694, -0.0963,  2.4351]],

         [[ 0.4885,    -inf,    -inf,    -inf],
          [ 2.1053, -0.7185,    -inf,    -inf],
          [ 4.5649,  0.2105, -6.6344,    -inf],
          [ 2.0368,  1.3099, -1.5086, -2.7917]],

         [[-4.6169,    -inf,    -inf,    -inf],
          [ 2.3485, -3.2948,    -inf,    -inf],
          [ 4.2984, -0.0421, -5.4309,    -inf],
          [-0.1014, -0.1205,  0.6872,  0.3371]],

         [[ 0.2583,    -inf,    -inf,    -inf],
          [ 0.3158, -2.2291,    -inf,    -inf],
          [ 3.3242,  0.3484,  0.2452,    -inf],
          [ 1.4410,  4.3321, -1.6464,  1.2802]],

         [[ 3.7733,    -inf,    -inf,    -inf],
          [-2.4216,  2.2035,    -inf,    -inf],
          [-1.8623, -0.1739, -4.3415,    -inf],
          [ 1.9960, -0.2946, -0.0127, -1.3432]],

         [[-0.0627,    -inf,    -inf,    -inf],
          [ 0.5396,  1.7981,    -inf,    -inf],
          [-1.9727, -0.0834, -3.1731,    -inf],
          [-1.4855, -1.1315, -2.6602,  2.8757]],

         [[ 1.1741,    -inf,    -inf,    -inf],
          [ 0.0665,  2.2191,    -inf,    -inf],
          [-1.8570,  1.8437, -0.1185,    -inf],
          [ 7.2637, -0.9056,  3.0583,  0.9992]],

         [[ 1.2823,    -inf,    -inf,    -inf],
          [-1.0284,  2.8593,    -inf,    -inf],
          [-2.3073, -0.5890,  0.3708,    -inf],
          [ 1.3622, -0.3693, -0.9122, -2.8205]],

         [[-2.7895,    -inf,    -inf,    -inf],
          [-0.2733, -1.2701,    -inf,    -inf],
          [-1.3799, -6.1023,  5.3334,    -inf],
          [-2.9637, -1.0716,  0.9552, -1.1664]],

         [[-0.1740,    -inf,    -inf,    -inf],
          [-3.2314, -1.9729,    -inf,    -inf],
          [-1.5033, -0.4632,  1.3429,    -inf],
          [-0.1146,  5.2253, -0.4893, -1.1808]],

         [[-3.6463,    -inf,    -inf,    -inf],
          [ 0.6402, -1.6735,    -inf,    -inf],
          [ 2.7074,  0.6456,  1.8800,    -inf],
          [ 2.2864, -2.4772,  1.3991, -0.8351]],

         [[-5.0079,    -inf,    -inf,    -inf],
          [ 2.0582,  5.1381,    -inf,    -inf],
          [ 0.7559,  3.9331,  1.9309,    -inf],
          [ 0.2691, -0.0130, -0.8196,  1.1864]],

         [[ 0.9860,    -inf,    -inf,    -inf],
          [-3.2664, -2.0573,    -inf,    -inf],
          [-1.9335,  4.9986,  2.8641,    -inf],
          [-7.2031,  2.8240, -1.4501,  0.3082]]],


        [[[ 3.5487,    -inf,    -inf,    -inf],
          [-1.9724, -0.7899,    -inf,    -inf],
          [-3.6594, -1.5344, -6.5140,    -inf],
          [ 1.5909,  4.7520,  3.2002, -0.8922]],

         [[ 1.7590,    -inf,    -inf,    -inf],
          [-2.0334, -2.6194,    -inf,    -inf],
          [-3.1067,  0.1365, -1.0289,    -inf],
          [-2.5601,  3.9179,  0.5978, -3.2529]],

         [[ 0.8097,    -inf,    -inf,    -inf],
          [-3.4196,  2.6324,    -inf,    -inf],
          [-4.4509, -2.1011,  0.0551,    -inf],
          [ 0.4276, -0.9924,  2.9287, -5.7359]],

         [[ 6.4190,    -inf,    -inf,    -inf],
          [ 3.7254, -1.9646,    -inf,    -inf],
          [-4.2516, -1.6924, -1.8230,    -inf],
          [ 0.8321,  0.4436,  2.6740, -3.6845]],

         [[ 2.5987,    -inf,    -inf,    -inf],
          [ 5.3891, -1.0862,    -inf,    -inf],
          [-1.2381,  2.2420, -0.0782,    -inf],
          [ 0.4410,  1.6110, -3.1757, -2.1001]],

         [[-0.8431,    -inf,    -inf,    -inf],
          [-0.8376,  2.2011,    -inf,    -inf],
          [ 1.1891, -0.2863, -3.5779,    -inf],
          [-1.1022,  2.3655, -1.2100,  0.9650]],

         [[-1.7573,    -inf,    -inf,    -inf],
          [ 2.1499, -2.0407,    -inf,    -inf],
          [ 1.7250,  2.2497, -4.4575,    -inf],
          [-0.4517, -0.4993, -0.8182,  1.8921]],

         [[-1.5268,    -inf,    -inf,    -inf],
          [ 0.3747,  2.8808,    -inf,    -inf],
          [ 0.2815,  0.9190,  3.1005,    -inf],
          [-1.7950,  4.6657, -1.1533, -5.5821]],

         [[-0.7012,    -inf,    -inf,    -inf],
          [ 4.1149, -2.9458,    -inf,    -inf],
          [ 0.8024,  2.0035,  0.0979,    -inf],
          [ 0.1852, -0.3733, -0.4380,  0.7739]],

         [[ 1.8937,    -inf,    -inf,    -inf],
          [ 2.2795, -0.7541,    -inf,    -inf],
          [ 6.1218, -0.3777, -0.4952,    -inf],
          [-0.0700,  2.7785, -2.2065,  2.7572]],

         [[ 1.1624,    -inf,    -inf,    -inf],
          [-2.1488,  0.8126,    -inf,    -inf],
          [ 1.4979, -1.5391, -3.1614,    -inf],
          [ 0.7960, -1.9827, -4.7349, -1.4529]],

         [[ 2.0320,    -inf,    -inf,    -inf],
          [ 0.5247, -5.1519,    -inf,    -inf],
          [-3.5610, -5.8824, -0.3794,    -inf],
          [-3.1316, -1.5661,  4.6539,  2.4795]],

         [[ 0.5525,    -inf,    -inf,    -inf],
          [-2.4619,  6.5425,    -inf,    -inf],
          [-4.2121, -0.1447,  1.7037,    -inf],
          [ 1.3442, -2.1078, -2.1872,  2.9258]],

         [[ 1.8458,    -inf,    -inf,    -inf],
          [ 1.0599, -5.1838,    -inf,    -inf],
          [-0.6093,  5.7583,  0.4203,    -inf],
          [ 0.4482,  3.6935, -3.5085,  2.3883]],

         [[-3.5159,    -inf,    -inf,    -inf],
          [ 3.4601, -3.8077,    -inf,    -inf],
          [ 2.0196,  1.3130, -1.2264,    -inf],
          [-6.4500, -1.8577,  1.5434,  3.9000]],

         [[ 0.4183,    -inf,    -inf,    -inf],
          [ 2.3424,  0.2949,    -inf,    -inf],
          [-2.5337, -1.6090,  2.4371,    -inf],
          [ 1.3065,  2.4169,  0.5615, -1.9542]],

         [[ 4.0045,    -inf,    -inf,    -inf],
          [-3.2449, -1.2162,    -inf,    -inf],
          [-4.5610, -0.5519, -0.3098,    -inf],
          [-0.6273, -1.8345,  3.0094, -5.6246]],

         [[-0.2920,    -inf,    -inf,    -inf],
          [ 0.8243, -1.0072,    -inf,    -inf],
          [ 0.3072,  2.3338, -3.3267,    -inf],
          [-3.1548, -1.7978,  1.4506,  0.3614]],

         [[ 0.7161,    -inf,    -inf,    -inf],
          [ 1.8839,  2.0613,    -inf,    -inf],
          [-1.7024,  0.7876,  3.8647,    -inf],
          [ 3.6308, -2.3403, -0.5320, -0.5622]],

         [[ 0.5137,    -inf,    -inf,    -inf],
          [-2.5302,  0.6408,    -inf,    -inf],
          [-1.1001,  1.5793, -0.1183,    -inf],
          [ 1.1496,  1.3801, -1.1621, -1.3670]],

         [[-0.5397,    -inf,    -inf,    -inf],
          [-0.3200,  2.6402,    -inf,    -inf],
          [-0.3470,  3.5869,  2.7016,    -inf],
          [-2.7708,  3.3274, -1.6999,  0.3432]],

         [[ 0.7629,    -inf,    -inf,    -inf],
          [-3.4681,  2.8678,    -inf,    -inf],
          [-1.7304, -2.1951, -5.4561,    -inf],
          [ 2.5417,  0.5915,  3.3388,  0.5492]],

         [[-5.2707,    -inf,    -inf,    -inf],
          [-1.0135,  0.2754,    -inf,    -inf],
          [ 1.9475,  0.5589, -2.5826,    -inf],
          [-2.4998, -1.5454, -1.6926, -0.8386]],

         [[-3.1365,    -inf,    -inf,    -inf],
          [ 1.4721,  1.4336,    -inf,    -inf],
          [-1.2286,  0.8815,  3.2998,    -inf],
          [ 2.3967,  1.5257, -4.5963, -3.9099]],

         [[-0.1276,    -inf,    -inf,    -inf],
          [-2.3937, -2.5797,    -inf,    -inf],
          [-1.7544,  1.5476,  1.4439,    -inf],
          [-1.2786,  1.2802,  0.4568, -4.8252]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.8394,    -inf,    -inf,    -inf],
          [ 0.7334,  4.9999,    -inf,    -inf],
          [-4.7642, -1.3647, -4.3974,    -inf],
          [ 1.2880,  1.9807, -4.0467, -2.5017]],

         [[ 2.3662,    -inf,    -inf,    -inf],
          [-1.5073,  0.8634,    -inf,    -inf],
          [-1.1021, -0.4824,  3.8043,    -inf],
          [ 0.4144, -1.1588, -0.4596,  0.0535]],

         [[ 1.2090,    -inf,    -inf,    -inf],
          [-5.0461, -1.1192,    -inf,    -inf],
          [-6.8600, -5.0838, -1.4440,    -inf],
          [ 2.2526,  1.2868, -0.0744, -2.9602]],

         [[ 4.4944,    -inf,    -inf,    -inf],
          [-0.9574,  5.3704,    -inf,    -inf],
          [-2.6472,  3.0131, -0.0832,    -inf],
          [-4.1010, -0.3562, -3.3603, -1.2769]],

         [[ 4.0146,    -inf,    -inf,    -inf],
          [ 5.8258, -3.2999,    -inf,    -inf],
          [-1.2656,  3.7721,  1.6837,    -inf],
          [ 0.4144,  2.3718, -4.1113,  0.2744]],

         [[ 0.0791,    -inf,    -inf,    -inf],
          [-1.9350,  0.0826,    -inf,    -inf],
          [-0.7409,  1.7243, -1.5021,    -inf],
          [-0.4369,  5.6139,  2.0024,  1.4937]],

         [[ 0.7035,    -inf,    -inf,    -inf],
          [-1.7693, -1.6201,    -inf,    -inf],
          [-0.4489, -0.3611,  0.3602,    -inf],
          [ 1.3968,  1.9855,  4.4842, -2.2546]],

         [[-1.1960,    -inf,    -inf,    -inf],
          [ 0.3321,  4.0340,    -inf,    -inf],
          [-0.6888, -2.6278, -0.5421,    -inf],
          [-5.5069, -0.4704,  4.8826, -6.3039]],

         [[-2.3174,    -inf,    -inf,    -inf],
          [ 2.2223,  2.4091,    -inf,    -inf],
          [ 1.8857,  0.0143,  4.7532,    -inf],
          [-2.1303,  1.3700,  0.4516,  0.1591]],

         [[ 2.0140,    -inf,    -inf,    -inf],
          [-2.1380,  1.5886,    -inf,    -inf],
          [ 6.5194,  0.9092,  1.4679,    -inf],
          [-0.0948,  1.3827, -7.1518,  2.2422]],

         [[ 0.9389,    -inf,    -inf,    -inf],
          [-0.7956,  2.0517,    -inf,    -inf],
          [ 0.8948,  0.6796, -0.1691,    -inf],
          [-1.5791, -1.1185, -3.1409,  3.6596]],

         [[ 0.9834,    -inf,    -inf,    -inf],
          [ 3.6073,  1.2661,    -inf,    -inf],
          [-0.7890, -4.4132, -3.0870,    -inf],
          [-4.1020,  0.7440,  0.8280, -1.6090]],

         [[-1.6191,    -inf,    -inf,    -inf],
          [ 1.8552,  1.2519,    -inf,    -inf],
          [-4.0877, -2.2655,  1.6170,    -inf],
          [ 1.2650, -2.0694, -0.0963,  2.4351]],

         [[ 0.4885,    -inf,    -inf,    -inf],
          [ 2.1053, -0.7185,    -inf,    -inf],
          [ 4.5649,  0.2105, -6.6344,    -inf],
          [ 2.0368,  1.3099, -1.5086, -2.7917]],

         [[-4.6169,    -inf,    -inf,    -inf],
          [ 2.3485, -3.2948,    -inf,    -inf],
          [ 4.2984, -0.0421, -5.4309,    -inf],
          [-0.1014, -0.1205,  0.6872,  0.3371]],

         [[ 0.2583,    -inf,    -inf,    -inf],
          [ 0.3158, -2.2291,    -inf,    -inf],
          [ 3.3242,  0.3484,  0.2452,    -inf],
          [ 1.4410,  4.3321, -1.6464,  1.2802]],

         [[ 3.7733,    -inf,    -inf,    -inf],
          [-2.4216,  2.2035,    -inf,    -inf],
          [-1.8623, -0.1739, -4.3415,    -inf],
          [ 1.9960, -0.2946, -0.0127, -1.3432]],

         [[-0.0627,    -inf,    -inf,    -inf],
          [ 0.5396,  1.7981,    -inf,    -inf],
          [-1.9727, -0.0834, -3.1731,    -inf],
          [-1.4855, -1.1315, -2.6602,  2.8757]],

         [[ 1.1741,    -inf,    -inf,    -inf],
          [ 0.0665,  2.2191,    -inf,    -inf],
          [-1.8570,  1.8437, -0.1185,    -inf],
          [ 7.2637, -0.9056,  3.0583,  0.9992]],

         [[ 1.2823,    -inf,    -inf,    -inf],
          [-1.0284,  2.8593,    -inf,    -inf],
          [-2.3073, -0.5890,  0.3708,    -inf],
          [ 1.3622, -0.3693, -0.9122, -2.8205]],

         [[-2.7895,    -inf,    -inf,    -inf],
          [-0.2733, -1.2701,    -inf,    -inf],
          [-1.3799, -6.1023,  5.3334,    -inf],
          [-2.9637, -1.0716,  0.9552, -1.1664]],

         [[-0.1740,    -inf,    -inf,    -inf],
          [-3.2314, -1.9729,    -inf,    -inf],
          [-1.5033, -0.4632,  1.3429,    -inf],
          [-0.1146,  5.2253, -0.4893, -1.1808]],

         [[-3.6463,    -inf,    -inf,    -inf],
          [ 0.6402, -1.6735,    -inf,    -inf],
          [ 2.7074,  0.6456,  1.8800,    -inf],
          [ 2.2864, -2.4772,  1.3991, -0.8351]],

         [[-5.0079,    -inf,    -inf,    -inf],
          [ 2.0582,  5.1381,    -inf,    -inf],
          [ 0.7559,  3.9331,  1.9309,    -inf],
          [ 0.2691, -0.0130, -0.8196,  1.1864]],

         [[ 0.9860,    -inf,    -inf,    -inf],
          [-3.2664, -2.0573,    -inf,    -inf],
          [-1.9335,  4.9986,  2.8641,    -inf],
          [-7.2031,  2.8240, -1.4501,  0.3082]]],


        [[[ 3.5487,    -inf,    -inf,    -inf],
          [-1.9724, -0.7899,    -inf,    -inf],
          [-3.6594, -1.5344, -6.5140,    -inf],
          [ 1.5909,  4.7520,  3.2002, -0.8922]],

         [[ 1.7590,    -inf,    -inf,    -inf],
          [-2.0334, -2.6194,    -inf,    -inf],
          [-3.1067,  0.1365, -1.0289,    -inf],
          [-2.5601,  3.9179,  0.5978, -3.2529]],

         [[ 0.8097,    -inf,    -inf,    -inf],
          [-3.4196,  2.6324,    -inf,    -inf],
          [-4.4509, -2.1011,  0.0551,    -inf],
          [ 0.4276, -0.9924,  2.9287, -5.7359]],

         [[ 6.4190,    -inf,    -inf,    -inf],
          [ 3.7254, -1.9646,    -inf,    -inf],
          [-4.2516, -1.6924, -1.8230,    -inf],
          [ 0.8321,  0.4436,  2.6740, -3.6845]],

         [[ 2.5987,    -inf,    -inf,    -inf],
          [ 5.3891, -1.0862,    -inf,    -inf],
          [-1.2381,  2.2420, -0.0782,    -inf],
          [ 0.4410,  1.6110, -3.1757, -2.1001]],

         [[-0.8431,    -inf,    -inf,    -inf],
          [-0.8376,  2.2011,    -inf,    -inf],
          [ 1.1891, -0.2863, -3.5779,    -inf],
          [-1.1022,  2.3655, -1.2100,  0.9650]],

         [[-1.7573,    -inf,    -inf,    -inf],
          [ 2.1499, -2.0407,    -inf,    -inf],
          [ 1.7250,  2.2497, -4.4575,    -inf],
          [-0.4517, -0.4993, -0.8182,  1.8921]],

         [[-1.5268,    -inf,    -inf,    -inf],
          [ 0.3747,  2.8808,    -inf,    -inf],
          [ 0.2815,  0.9190,  3.1005,    -inf],
          [-1.7950,  4.6657, -1.1533, -5.5821]],

         [[-0.7012,    -inf,    -inf,    -inf],
          [ 4.1149, -2.9458,    -inf,    -inf],
          [ 0.8024,  2.0035,  0.0979,    -inf],
          [ 0.1852, -0.3733, -0.4380,  0.7739]],

         [[ 1.8937,    -inf,    -inf,    -inf],
          [ 2.2795, -0.7541,    -inf,    -inf],
          [ 6.1218, -0.3777, -0.4952,    -inf],
          [-0.0700,  2.7785, -2.2065,  2.7572]],

         [[ 1.1624,    -inf,    -inf,    -inf],
          [-2.1488,  0.8126,    -inf,    -inf],
          [ 1.4979, -1.5391, -3.1614,    -inf],
          [ 0.7960, -1.9827, -4.7349, -1.4529]],

         [[ 2.0320,    -inf,    -inf,    -inf],
          [ 0.5247, -5.1519,    -inf,    -inf],
          [-3.5610, -5.8824, -0.3794,    -inf],
          [-3.1316, -1.5661,  4.6539,  2.4795]],

         [[ 0.5525,    -inf,    -inf,    -inf],
          [-2.4619,  6.5425,    -inf,    -inf],
          [-4.2121, -0.1447,  1.7037,    -inf],
          [ 1.3442, -2.1078, -2.1872,  2.9258]],

         [[ 1.8458,    -inf,    -inf,    -inf],
          [ 1.0599, -5.1838,    -inf,    -inf],
          [-0.6093,  5.7583,  0.4203,    -inf],
          [ 0.4482,  3.6935, -3.5085,  2.3883]],

         [[-3.5159,    -inf,    -inf,    -inf],
          [ 3.4601, -3.8077,    -inf,    -inf],
          [ 2.0196,  1.3130, -1.2264,    -inf],
          [-6.4500, -1.8577,  1.5434,  3.9000]],

         [[ 0.4183,    -inf,    -inf,    -inf],
          [ 2.3424,  0.2949,    -inf,    -inf],
          [-2.5337, -1.6090,  2.4371,    -inf],
          [ 1.3065,  2.4169,  0.5615, -1.9542]],

         [[ 4.0045,    -inf,    -inf,    -inf],
          [-3.2449, -1.2162,    -inf,    -inf],
          [-4.5610, -0.5519, -0.3098,    -inf],
          [-0.6273, -1.8345,  3.0094, -5.6246]],

         [[-0.2920,    -inf,    -inf,    -inf],
          [ 0.8243, -1.0072,    -inf,    -inf],
          [ 0.3072,  2.3338, -3.3267,    -inf],
          [-3.1548, -1.7978,  1.4506,  0.3614]],

         [[ 0.7161,    -inf,    -inf,    -inf],
          [ 1.8839,  2.0613,    -inf,    -inf],
          [-1.7024,  0.7876,  3.8647,    -inf],
          [ 3.6308, -2.3403, -0.5320, -0.5622]],

         [[ 0.5137,    -inf,    -inf,    -inf],
          [-2.5302,  0.6408,    -inf,    -inf],
          [-1.1001,  1.5793, -0.1183,    -inf],
          [ 1.1496,  1.3801, -1.1621, -1.3670]],

         [[-0.5397,    -inf,    -inf,    -inf],
          [-0.3200,  2.6402,    -inf,    -inf],
          [-0.3470,  3.5869,  2.7016,    -inf],
          [-2.7708,  3.3274, -1.6999,  0.3432]],

         [[ 0.7629,    -inf,    -inf,    -inf],
          [-3.4681,  2.8678,    -inf,    -inf],
          [-1.7304, -2.1951, -5.4561,    -inf],
          [ 2.5417,  0.5915,  3.3388,  0.5492]],

         [[-5.2707,    -inf,    -inf,    -inf],
          [-1.0135,  0.2754,    -inf,    -inf],
          [ 1.9475,  0.5589, -2.5826,    -inf],
          [-2.4998, -1.5454, -1.6926, -0.8386]],

         [[-3.1365,    -inf,    -inf,    -inf],
          [ 1.4721,  1.4336,    -inf,    -inf],
          [-1.2286,  0.8815,  3.2998,    -inf],
          [ 2.3967,  1.5257, -4.5963, -3.9099]],

         [[-0.1276,    -inf,    -inf,    -inf],
          [-2.3937, -2.5797,    -inf,    -inf],
          [-1.7544,  1.5476,  1.4439,    -inf],
          [-1.2786,  1.2802,  0.4568, -4.8252]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 7.0496e-01,  8.9442e-01, -3.4874e-01,  ...,  4.6304e-01,
           -2.5633e-01, -1.9978e-01],
          [-3.8696e-01, -8.4339e-01, -6.1064e-01,  ...,  6.5650e-01,
           -1.0106e+00, -5.5731e-01],
          [ 5.7985e-01,  2.2063e-01,  2.4319e-01,  ...,  1.5252e-01,
           -5.1969e-02, -7.3143e-01],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.1991e+00,  7.1390e-01,  1.2426e+00,  ...,  2.6799e-02,
           -5.3273e-02,  6.8024e-01],
          [ 5.1111e-02,  1.0477e-01, -7.8838e-02,  ...,  3.2452e-01,
            6.1466e-01, -5.1518e-01]],

         [[ 3.5851e-01,  1.1464e-01, -5.1566e-01,  ...,  6.2135e-02,
            2.1997e-01,  4.5911e-01],
          [ 1.1005e-01, -1.2533e-01, -5.3454e-01,  ...,  4.1515e-01,
           -1.8980e-01, -4.1638e-01],
          [ 8.1108e-01, -1.6998e-01,  9.2759e-04,  ...,  6.6525e-03,
           -2.2267e-01, -7.2391e-01],
          ...,
          [-9.3590e-01, -1.0801e-01, -5.6349e-01,  ...,  7.6641e-02,
           -5.3458e-02, -9.9449e-01],
          [-5.7905e-01,  4.8067e-01, -1.5646e-01,  ...,  6.9575e-01,
           -3.1568e-01,  2.8341e-01],
          [-6.2271e-01,  6.9740e-01, -5.5816e-01,  ...,  6.2715e-03,
           -1.7609e-02,  2.9100e-01]],

         [[ 2.1062e-01,  2.5884e-01, -6.1800e-01,  ...,  2.1238e-01,
           -5.1181e-03, -6.1206e-02],
          [ 7.9041e-01, -7.8905e-02, -1.2666e-01,  ..., -2.9208e-01,
           -2.2047e-01, -5.8169e-02],
          [ 8.1779e-01,  8.6139e-02, -5.3283e-01,  ...,  7.8046e-02,
           -3.4781e-01, -2.3753e-01],
          ...,
          [-5.5338e-01, -3.5934e-01,  1.3707e-01,  ..., -6.4687e-02,
           -5.8924e-01, -4.4360e-02],
          [-3.9301e-01,  3.2719e-01, -1.1145e-01,  ...,  4.7697e-01,
           -2.1628e-01,  1.9204e-01],
          [-2.9527e-01,  1.4317e-02, -4.7182e-01,  ..., -1.3865e-01,
           -4.0133e-02,  4.6436e-01]],

         [[ 3.2595e-01,  1.4113e-01, -5.3364e-01,  ...,  2.5981e-01,
            7.0291e-02, -1.8896e-02],
          [ 6.5607e-01, -3.3648e-01, -2.6346e-01,  ..., -4.8218e-02,
           -2.3055e-01, -3.4926e-01],
          [ 5.8262e-01,  3.4242e-01, -3.8979e-01,  ..., -4.3403e-02,
           -1.8319e-01, -1.6085e-01],
          ...,
          [-3.1857e-01, -1.7419e-01, -2.3082e-01,  ...,  1.9209e-01,
           -6.8942e-03, -6.1071e-01],
          [-3.0265e-01,  2.0100e-01, -1.6941e-01,  ...,  1.1366e-01,
           -1.9949e-01,  3.5871e-01],
          [ 1.0774e-01,  2.5815e-01,  3.1491e-01,  ..., -1.6515e-01,
            1.3105e-01, -1.6938e-01]]],


        [[[ 1.7678e-01,  8.3832e-01, -1.1203e+00,  ...,  4.5493e-01,
           -7.5945e-02, -6.6013e-02],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 4.3466e-01,  6.1916e-01,  2.2882e-01,  ...,  1.5454e-01,
           -1.9357e-01, -6.8410e-01],
          ...,
          [-8.3458e-01, -5.7351e-01, -1.3904e+00,  ...,  3.7361e-01,
            3.3205e-01, -9.8062e-01],
          [-1.5526e+00,  4.9234e-01,  8.8760e-01,  ...,  4.2586e-01,
            2.4168e-01,  1.1247e+00],
          [-1.6973e-01,  6.0925e-01, -1.0131e-01,  ...,  2.5459e-02,
            6.6113e-01, -5.4167e-01]],

         [[ 2.7214e-01,  1.0496e-01, -8.5153e-01,  ...,  1.5536e-02,
           -2.5517e-01, -3.3010e-01],
          [-3.6040e-01, -2.9074e-02,  2.4684e-01,  ...,  3.2572e-01,
            2.6148e-01, -9.1764e-02],
          [ 5.7713e-01, -6.1050e-01, -2.2720e-01,  ...,  2.2244e-01,
           -3.2206e-01, -1.1879e-01],
          ...,
          [-8.9691e-01, -7.3756e-01, -1.0263e+00,  ...,  4.9302e-04,
            1.9881e-01, -3.7185e-01],
          [-1.0574e+00,  5.5722e-01,  2.4156e-01,  ...,  1.0950e+00,
           -3.3244e-01,  6.9261e-01],
          [-1.7429e-01,  4.8460e-01, -6.4267e-01,  ...,  1.6371e-01,
            5.1098e-01, -2.2919e-01]],

         [[ 3.0878e-01,  1.6960e-01, -8.6837e-01,  ...,  1.0262e-01,
           -1.5987e-01, -4.9857e-01],
          [-9.6745e-02, -2.5759e-01,  1.8358e-01,  ...,  3.1856e-01,
            5.4493e-02, -3.2888e-01],
          [ 5.2350e-01, -2.8737e-01, -9.7333e-02,  ...,  1.9415e-01,
           -2.8585e-01,  6.0134e-01],
          ...,
          [-6.6047e-01, -7.4868e-01, -8.3217e-01,  ..., -9.5056e-02,
            4.9968e-02, -8.0653e-02],
          [-5.6698e-01,  4.5570e-02,  4.1276e-01,  ...,  1.2604e+00,
           -1.9352e-01,  2.4410e-02],
          [ 1.2430e-01, -7.4304e-02, -1.3519e-01,  ...,  1.8464e-01,
            3.2651e-01, -2.8368e-01]],

         [[ 1.0506e-01,  2.2077e-02, -7.6935e-01,  ...,  2.4762e-01,
           -1.7692e-01, -4.0175e-01],
          [-9.0104e-02, -2.1161e-01,  1.6359e-01,  ...,  3.2588e-01,
            5.3103e-02, -2.0471e-01],
          [ 6.1546e-01,  1.3558e-01, -1.2196e-01,  ...,  2.2376e-01,
           -2.9940e-01,  3.1719e-01],
          ...,
          [-1.4831e-01, -7.3952e-01, -5.4917e-01,  ..., -1.7797e-01,
           -2.7225e-01,  1.8575e-01],
          [-6.3727e-01,  8.5349e-02,  1.2304e-01,  ...,  1.0233e+00,
           -2.4708e-01,  4.9860e-01],
          [ 1.0116e-01,  2.4420e-02, -3.8518e-01,  ...,  2.9003e-01,
            4.2318e-01, -2.0077e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.7050,  0.8944, -0.3487,  ...,  0.3245,  0.6147, -0.5152],
         [ 0.3585,  0.1146, -0.5157,  ...,  0.0063, -0.0176,  0.2910],
         [ 0.2106,  0.2588, -0.6180,  ..., -0.1387, -0.0401,  0.4644],
         [ 0.3260,  0.1411, -0.5336,  ..., -0.1652,  0.1311, -0.1694]],

        [[ 0.1768,  0.8383, -1.1203,  ...,  0.0255,  0.6611, -0.5417],
         [ 0.2721,  0.1050, -0.8515,  ...,  0.1637,  0.5110, -0.2292],
         [ 0.3088,  0.1696, -0.8684,  ...,  0.1846,  0.3265, -0.2837],
         [ 0.1051,  0.0221, -0.7693,  ...,  0.2900,  0.4232, -0.2008]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.5344,  0.3326,  0.2580,  ..., -0.3300,  0.1036,  0.2385],
         [-0.0520,  0.0781,  0.3224,  ..., -0.0542, -0.3505,  0.2932],
         [ 0.0977, -0.0545,  0.1414,  ..., -0.0850, -0.0819, -0.0624],
         [ 0.0312,  0.0800,  0.2184,  ..., -0.0292,  0.0456, -0.0140]],

        [[-0.6392, -0.0039,  0.4798,  ..., -0.3193,  0.3946,  0.1497],
         [-0.0237, -0.0186,  0.2283,  ..., -0.3250,  0.0409,  0.0394],
         [-0.0180,  0.0708,  0.1917,  ..., -0.0406,  0.4263,  0.0978],
         [-0.1079,  0.1405,  0.3468,  ...,  0.0303,  0.3866, -0.0318]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-5.2174e+00,        -inf,        -inf,        -inf],
          [ 6.6365e-01,  4.2741e-01,        -inf,        -inf],
          [ 5.4411e+00,  1.3335e-01, -2.5471e+00,        -inf],
          [ 4.4660e+00, -1.4464e+00,  3.2798e+00, -5.0080e-01]],

         [[ 3.7913e-01,        -inf,        -inf,        -inf],
          [-1.0316e+00,  2.6135e+00,        -inf,        -inf],
          [-1.0699e+00, -2.8154e+00,  2.1787e+00,        -inf],
          [ 2.8474e+00, -1.6697e+00,  1.3467e+00, -3.4810e+00]],

         [[-8.3488e-02,        -inf,        -inf,        -inf],
          [ 2.5325e+00,  1.3912e+00,        -inf,        -inf],
          [ 9.2187e-01,  9.8966e-01, -9.5960e-01,        -inf],
          [ 2.6910e+00,  2.3268e+00, -1.6979e-01,  1.4985e-01]],

         [[-5.1261e-01,        -inf,        -inf,        -inf],
          [ 2.6315e+00, -4.8884e-01,        -inf,        -inf],
          [ 6.9616e+00,  4.5160e+00,  2.9652e+00,        -inf],
          [ 1.1948e+00, -1.5375e-02,  4.6416e-01, -7.8794e-01]],

         [[ 2.4252e+00,        -inf,        -inf,        -inf],
          [ 5.1389e+00,  2.3524e+00,        -inf,        -inf],
          [-8.3224e-01,  2.1418e+00, -2.3315e+00,        -inf],
          [-1.9469e+00,  1.6183e+00, -3.6177e+00, -1.4633e+00]],

         [[ 3.3055e+00,        -inf,        -inf,        -inf],
          [ 3.7020e-01, -7.4937e-01,        -inf,        -inf],
          [-3.2275e+00,  3.5727e+00, -4.4529e+00,        -inf],
          [-6.4577e-01,  6.2402e+00, -1.7843e+00,  2.3370e-03]],

         [[-4.7437e-02,        -inf,        -inf,        -inf],
          [-1.2497e+00, -4.0556e-01,        -inf,        -inf],
          [ 1.0343e+00,  2.8104e-01,  2.2651e+00,        -inf],
          [-4.2941e+00, -4.5573e+00, -4.4669e+00,  5.6007e-02]],

         [[-2.4571e+00,        -inf,        -inf,        -inf],
          [-1.3932e+00,  1.3421e-01,        -inf,        -inf],
          [-2.7720e+00, -2.7811e+00, -4.9464e+00,        -inf],
          [-4.8542e-01, -1.3504e+00, -3.5317e-01, -2.4023e+00]],

         [[ 2.3742e-01,        -inf,        -inf,        -inf],
          [ 2.4745e+00,  4.9779e+00,        -inf,        -inf],
          [-8.0150e-01, -1.7771e+00,  4.3131e+00,        -inf],
          [ 2.6905e+00, -4.0428e+00,  2.0393e+00,  1.1192e+00]],

         [[-4.9962e-01,        -inf,        -inf,        -inf],
          [ 1.5530e+00,  3.0807e+00,        -inf,        -inf],
          [-7.1052e-01, -1.0131e+00, -2.9242e+00,        -inf],
          [-1.4631e+00,  9.0267e-01,  5.0408e-01, -2.6147e+00]],

         [[ 8.9465e-01,        -inf,        -inf,        -inf],
          [-3.1888e+00, -3.2743e+00,        -inf,        -inf],
          [ 4.0178e+00, -1.2821e+00,  3.7588e+00,        -inf],
          [-3.4243e+00,  1.1642e-01,  1.2260e+00, -3.1556e+00]],

         [[ 2.3351e+00,        -inf,        -inf,        -inf],
          [-3.5629e-01,  7.9451e-01,        -inf,        -inf],
          [-2.1641e+00,  2.0129e+00,  1.3656e+00,        -inf],
          [-2.5614e+00,  2.3844e+00,  6.8538e-02,  5.0613e+00]],

         [[-2.1918e+00,        -inf,        -inf,        -inf],
          [-7.7740e-02,  7.4308e-01,        -inf,        -inf],
          [-1.7494e+00, -1.1726e+00,  1.9887e+00,        -inf],
          [ 2.7886e+00, -7.9344e-01,  1.3771e+00, -1.6588e+00]],

         [[-6.4744e-01,        -inf,        -inf,        -inf],
          [ 4.1586e+00, -4.4646e-01,        -inf,        -inf],
          [-1.7159e+00, -4.1102e-01, -3.8370e+00,        -inf],
          [-7.4947e-01, -1.0347e-01,  2.2092e+00, -2.5085e+00]],

         [[ 9.0362e-02,        -inf,        -inf,        -inf],
          [-3.5565e+00,  5.1477e-01,        -inf,        -inf],
          [ 9.2736e-01,  4.3399e+00, -1.9606e+00,        -inf],
          [ 7.1538e-02, -9.3887e-01, -2.5819e-02,  6.7134e-01]],

         [[ 1.6652e+00,        -inf,        -inf,        -inf],
          [-2.7893e+00, -7.9877e-01,        -inf,        -inf],
          [ 7.5940e+00, -2.1243e+00,  2.6308e+00,        -inf],
          [ 3.6560e-01, -1.2790e+00,  9.7846e-01, -2.6721e-01]],

         [[-4.6707e+00,        -inf,        -inf,        -inf],
          [-2.3248e+00, -2.3485e-01,        -inf,        -inf],
          [ 4.5376e+00, -7.7627e-01, -8.9125e-01,        -inf],
          [ 8.4269e-01, -8.3016e-01, -1.1818e+00,  1.7275e+00]],

         [[ 1.8348e-01,        -inf,        -inf,        -inf],
          [ 4.6236e+00,  1.4937e+00,        -inf,        -inf],
          [ 4.5251e+00,  2.5936e+00,  2.8810e+00,        -inf],
          [ 1.5462e+00,  5.7580e-02, -1.9003e+00,  1.5311e+00]],

         [[ 3.2645e+00,        -inf,        -inf,        -inf],
          [ 6.8302e-01, -3.4147e+00,        -inf,        -inf],
          [-2.8100e+00,  2.5461e+00,  1.9078e+00,        -inf],
          [ 3.8951e-01,  7.2849e+00,  1.0826e+00,  3.4067e+00]],

         [[ 4.2731e-01,        -inf,        -inf,        -inf],
          [ 5.0250e-01,  5.5587e-01,        -inf,        -inf],
          [ 3.2991e-01,  5.1496e+00, -2.5618e+00,        -inf],
          [ 2.2790e+00,  1.2699e+00, -2.6835e+00, -1.5066e+00]],

         [[ 9.6382e-01,        -inf,        -inf,        -inf],
          [ 1.4559e+00,  4.3917e-01,        -inf,        -inf],
          [-3.5909e+00, -2.9236e+00, -4.3611e+00,        -inf],
          [-1.9322e+00, -4.5460e+00,  7.1767e-01, -3.2446e+00]],

         [[-5.8454e+00,        -inf,        -inf,        -inf],
          [ 1.1645e+00,  4.1136e+00,        -inf,        -inf],
          [-2.9470e+00,  1.0907e+00, -2.3431e+00,        -inf],
          [-2.0106e+00,  2.6379e+00,  1.0247e+00,  8.6846e-01]],

         [[ 7.9212e-01,        -inf,        -inf,        -inf],
          [-3.4506e+00, -2.6986e+00,        -inf,        -inf],
          [-1.1085e+00,  3.8747e+00, -2.3851e+00,        -inf],
          [ 1.3345e+00,  1.2414e-01, -2.4742e+00,  7.0279e-02]],

         [[-1.8012e+00,        -inf,        -inf,        -inf],
          [ 1.2803e+00, -5.2868e+00,        -inf,        -inf],
          [ 3.5180e-01, -3.6156e-02,  9.6572e-01,        -inf],
          [ 2.5062e+00, -4.2701e-01, -1.7208e+00,  2.9840e+00]],

         [[ 2.3595e-01,        -inf,        -inf,        -inf],
          [-3.4378e+00, -5.2371e-01,        -inf,        -inf],
          [ 5.7943e-01, -1.7893e+00, -7.4473e-02,        -inf],
          [-3.4163e+00, -3.4801e+00,  1.9753e+00,  7.9341e-01]]],


        [[[-4.7991e+00,        -inf,        -inf,        -inf],
          [ 1.1153e+00, -1.0378e+00,        -inf,        -inf],
          [ 3.4770e+00, -2.3089e+00,  9.7604e-01,        -inf],
          [ 1.3747e+00, -5.8666e+00, -8.4140e-01,  2.9695e-01]],

         [[-2.8808e+00,        -inf,        -inf,        -inf],
          [ 2.1172e+00,  4.7193e+00,        -inf,        -inf],
          [ 2.0586e+00,  6.4089e-02, -3.6288e-01,        -inf],
          [ 1.0563e+00,  2.2575e+00, -7.0650e-01, -2.4400e+00]],

         [[-1.3087e-01,        -inf,        -inf,        -inf],
          [-1.8878e+00,  8.0750e-01,        -inf,        -inf],
          [-2.7615e-01,  3.0167e+00, -2.9791e+00,        -inf],
          [-2.2129e+00, -3.1163e+00, -3.7098e+00,  2.0720e+00]],

         [[ 8.6309e-01,        -inf,        -inf,        -inf],
          [ 4.6465e+00,  4.1598e+00,        -inf,        -inf],
          [ 3.5933e+00,  2.8353e+00, -1.6421e+00,        -inf],
          [ 4.8641e+00,  1.8546e+00,  1.0703e+00, -2.5553e+00]],

         [[-4.1368e-01,        -inf,        -inf,        -inf],
          [ 3.1213e+00,  5.9935e-01,        -inf,        -inf],
          [ 2.0980e+00,  3.1219e+00,  1.4866e+00,        -inf],
          [ 9.9488e-01,  1.0383e+00,  1.6030e+00,  1.0831e+00]],

         [[ 2.3889e+00,        -inf,        -inf,        -inf],
          [ 1.5800e+00, -2.1611e+00,        -inf,        -inf],
          [ 2.0995e+00,  2.2090e+00, -2.7473e+00,        -inf],
          [-5.7195e+00,  3.8735e+00, -1.2620e+00,  4.7541e-01]],

         [[-1.7336e+00,        -inf,        -inf,        -inf],
          [ 1.2647e+00,  2.5817e-01,        -inf,        -inf],
          [-2.7155e+00, -4.1406e-01,  6.7065e-01,        -inf],
          [-8.5261e+00, -2.7244e+00, -1.8167e+00, -3.1327e-01]],

         [[-4.7671e+00,        -inf,        -inf,        -inf],
          [-5.3383e+00,  8.2071e-01,        -inf,        -inf],
          [-5.2943e-01,  2.3751e+00, -3.3085e+00,        -inf],
          [-4.3813e+00,  3.0321e+00, -5.0243e+00,  2.0543e+00]],

         [[-3.4369e-01,        -inf,        -inf,        -inf],
          [ 6.5334e+00,  6.0080e+00,        -inf,        -inf],
          [-3.8618e-01, -3.6142e+00,  5.9021e+00,        -inf],
          [ 8.6628e-01, -2.5389e+00, -3.8884e+00,  8.1743e-01]],

         [[-9.1330e-01,        -inf,        -inf,        -inf],
          [ 3.5755e+00,  1.1769e+00,        -inf,        -inf],
          [-5.1767e+00, -8.0576e-01, -1.7815e+00,        -inf],
          [-1.5903e-01, -2.5667e+00,  9.7686e-01,  2.8279e+00]],

         [[-9.0884e-01,        -inf,        -inf,        -inf],
          [-3.6638e-01, -3.1650e+00,        -inf,        -inf],
          [-1.5211e-01,  2.4134e-01,  4.2386e+00,        -inf],
          [-2.6246e+00, -4.2088e+00, -9.7095e-01, -2.2399e+00]],

         [[ 1.2858e+00,        -inf,        -inf,        -inf],
          [-2.7131e+00,  2.8523e-01,        -inf,        -inf],
          [-1.7167e+00,  3.5748e+00,  2.3981e+00,        -inf],
          [-1.9855e+00, -2.9854e+00,  3.2523e+00, -2.8609e+00]],

         [[-3.9483e+00,        -inf,        -inf,        -inf],
          [-1.4553e+00,  1.7682e+00,        -inf,        -inf],
          [-3.6903e+00, -3.3527e+00, -1.2819e+00,        -inf],
          [ 3.9497e+00, -2.6136e+00, -4.4865e+00,  3.5563e+00]],

         [[-9.8563e-02,        -inf,        -inf,        -inf],
          [ 1.2341e+00,  4.1239e+00,        -inf,        -inf],
          [-4.2146e-01, -3.3573e+00, -1.0540e+00,        -inf],
          [ 1.1414e+00, -6.5383e-01, -1.4926e+00, -2.2162e+00]],

         [[-9.9866e-01,        -inf,        -inf,        -inf],
          [ 5.3668e-01,  8.6742e-01,        -inf,        -inf],
          [-3.3969e+00,  1.2229e+00, -1.5559e+00,        -inf],
          [-4.8214e-01, -6.0790e-01,  5.1293e+00, -5.9480e+00]],

         [[-6.1828e-01,        -inf,        -inf,        -inf],
          [-1.2189e+00, -8.7182e-02,        -inf,        -inf],
          [ 2.1710e+00,  2.9091e+00,  4.6486e+00,        -inf],
          [ 2.1703e+00, -2.0618e+00,  1.1641e+00, -2.6588e+00]],

         [[-5.3754e+00,        -inf,        -inf,        -inf],
          [ 1.1999e+00, -1.3863e+00,        -inf,        -inf],
          [-2.2347e+00, -2.6404e-01, -1.0594e+00,        -inf],
          [-3.0592e-01,  1.9612e+00,  4.9537e+00, -7.9090e-01]],

         [[-9.2861e-01,        -inf,        -inf,        -inf],
          [ 4.4216e+00, -1.0919e+00,        -inf,        -inf],
          [ 3.3168e+00, -1.0363e+00,  3.8293e+00,        -inf],
          [ 3.0453e+00, -9.8192e-01,  3.3049e+00, -5.6449e-01]],

         [[-2.4284e-01,        -inf,        -inf,        -inf],
          [ 1.4642e+00, -2.6328e+00,        -inf,        -inf],
          [-1.2274e+00,  5.8399e-01, -2.5330e+00,        -inf],
          [ 1.4264e+00,  7.0092e-02, -5.4101e-01, -4.9581e+00]],

         [[ 1.0883e+00,        -inf,        -inf,        -inf],
          [-4.3961e-01, -9.6113e-01,        -inf,        -inf],
          [ 1.4150e+00,  9.0980e-01,  2.0630e+00,        -inf],
          [ 5.6398e+00,  1.3267e+00, -1.4436e+00, -4.0662e+00]],

         [[-7.6752e-02,        -inf,        -inf,        -inf],
          [-4.2131e+00,  2.1742e-01,        -inf,        -inf],
          [ 7.4436e-01,  6.0140e-01,  3.1076e+00,        -inf],
          [ 8.4049e-01, -3.6096e+00, -3.5004e-01,  1.3298e+00]],

         [[-4.8137e+00,        -inf,        -inf,        -inf],
          [ 1.1270e+00, -2.3899e+00,        -inf,        -inf],
          [-3.8344e-01, -7.2021e+00,  1.9077e+00,        -inf],
          [-1.4465e+00,  2.3795e+00, -3.2525e+00,  1.9265e+00]],

         [[-2.7439e+00,        -inf,        -inf,        -inf],
          [-1.6881e+00, -1.8252e+00,        -inf,        -inf],
          [ 5.5365e-01, -4.9644e-01, -4.5492e-01,        -inf],
          [ 5.1732e+00,  2.9067e+00, -1.4061e+00,  2.5729e+00]],

         [[-1.4722e+00,        -inf,        -inf,        -inf],
          [ 8.9375e-01,  5.9736e+00,        -inf,        -inf],
          [-3.2081e+00,  1.1830e+00,  3.5038e+00,        -inf],
          [ 1.4462e+00,  2.7480e+00, -4.7829e+00,  2.2024e+00]],

         [[ 1.5349e+00,        -inf,        -inf,        -inf],
          [-4.5983e+00, -4.9340e+00,        -inf,        -inf],
          [ 1.2500e+00,  1.6795e+00,  3.3722e+00,        -inf],
          [-3.8921e+00,  1.9474e+00,  1.9836e+00,  7.7690e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-5.2174e+00,        -inf,        -inf,        -inf],
          [ 6.6365e-01,  4.2741e-01,        -inf,        -inf],
          [ 5.4411e+00,  1.3335e-01, -2.5471e+00,        -inf],
          [ 4.4660e+00, -1.4464e+00,  3.2798e+00, -5.0080e-01]],

         [[ 3.7913e-01,        -inf,        -inf,        -inf],
          [-1.0316e+00,  2.6135e+00,        -inf,        -inf],
          [-1.0699e+00, -2.8154e+00,  2.1787e+00,        -inf],
          [ 2.8474e+00, -1.6697e+00,  1.3467e+00, -3.4810e+00]],

         [[-8.3488e-02,        -inf,        -inf,        -inf],
          [ 2.5325e+00,  1.3912e+00,        -inf,        -inf],
          [ 9.2187e-01,  9.8966e-01, -9.5960e-01,        -inf],
          [ 2.6910e+00,  2.3268e+00, -1.6979e-01,  1.4985e-01]],

         [[-5.1261e-01,        -inf,        -inf,        -inf],
          [ 2.6315e+00, -4.8884e-01,        -inf,        -inf],
          [ 6.9616e+00,  4.5160e+00,  2.9652e+00,        -inf],
          [ 1.1948e+00, -1.5375e-02,  4.6416e-01, -7.8794e-01]],

         [[ 2.4252e+00,        -inf,        -inf,        -inf],
          [ 5.1389e+00,  2.3524e+00,        -inf,        -inf],
          [-8.3224e-01,  2.1418e+00, -2.3315e+00,        -inf],
          [-1.9469e+00,  1.6183e+00, -3.6177e+00, -1.4633e+00]],

         [[ 3.3055e+00,        -inf,        -inf,        -inf],
          [ 3.7020e-01, -7.4937e-01,        -inf,        -inf],
          [-3.2275e+00,  3.5727e+00, -4.4529e+00,        -inf],
          [-6.4577e-01,  6.2402e+00, -1.7843e+00,  2.3370e-03]],

         [[-4.7437e-02,        -inf,        -inf,        -inf],
          [-1.2497e+00, -4.0556e-01,        -inf,        -inf],
          [ 1.0343e+00,  2.8104e-01,  2.2651e+00,        -inf],
          [-4.2941e+00, -4.5573e+00, -4.4669e+00,  5.6007e-02]],

         [[-2.4571e+00,        -inf,        -inf,        -inf],
          [-1.3932e+00,  1.3421e-01,        -inf,        -inf],
          [-2.7720e+00, -2.7811e+00, -4.9464e+00,        -inf],
          [-4.8542e-01, -1.3504e+00, -3.5317e-01, -2.4023e+00]],

         [[ 2.3742e-01,        -inf,        -inf,        -inf],
          [ 2.4745e+00,  4.9779e+00,        -inf,        -inf],
          [-8.0150e-01, -1.7771e+00,  4.3131e+00,        -inf],
          [ 2.6905e+00, -4.0428e+00,  2.0393e+00,  1.1192e+00]],

         [[-4.9962e-01,        -inf,        -inf,        -inf],
          [ 1.5530e+00,  3.0807e+00,        -inf,        -inf],
          [-7.1052e-01, -1.0131e+00, -2.9242e+00,        -inf],
          [-1.4631e+00,  9.0267e-01,  5.0408e-01, -2.6147e+00]],

         [[ 8.9465e-01,        -inf,        -inf,        -inf],
          [-3.1888e+00, -3.2743e+00,        -inf,        -inf],
          [ 4.0178e+00, -1.2821e+00,  3.7588e+00,        -inf],
          [-3.4243e+00,  1.1642e-01,  1.2260e+00, -3.1556e+00]],

         [[ 2.3351e+00,        -inf,        -inf,        -inf],
          [-3.5629e-01,  7.9451e-01,        -inf,        -inf],
          [-2.1641e+00,  2.0129e+00,  1.3656e+00,        -inf],
          [-2.5614e+00,  2.3844e+00,  6.8538e-02,  5.0613e+00]],

         [[-2.1918e+00,        -inf,        -inf,        -inf],
          [-7.7740e-02,  7.4308e-01,        -inf,        -inf],
          [-1.7494e+00, -1.1726e+00,  1.9887e+00,        -inf],
          [ 2.7886e+00, -7.9344e-01,  1.3771e+00, -1.6588e+00]],

         [[-6.4744e-01,        -inf,        -inf,        -inf],
          [ 4.1586e+00, -4.4646e-01,        -inf,        -inf],
          [-1.7159e+00, -4.1102e-01, -3.8370e+00,        -inf],
          [-7.4947e-01, -1.0347e-01,  2.2092e+00, -2.5085e+00]],

         [[ 9.0362e-02,        -inf,        -inf,        -inf],
          [-3.5565e+00,  5.1477e-01,        -inf,        -inf],
          [ 9.2736e-01,  4.3399e+00, -1.9606e+00,        -inf],
          [ 7.1538e-02, -9.3887e-01, -2.5819e-02,  6.7134e-01]],

         [[ 1.6652e+00,        -inf,        -inf,        -inf],
          [-2.7893e+00, -7.9877e-01,        -inf,        -inf],
          [ 7.5940e+00, -2.1243e+00,  2.6308e+00,        -inf],
          [ 3.6560e-01, -1.2790e+00,  9.7846e-01, -2.6721e-01]],

         [[-4.6707e+00,        -inf,        -inf,        -inf],
          [-2.3248e+00, -2.3485e-01,        -inf,        -inf],
          [ 4.5376e+00, -7.7627e-01, -8.9125e-01,        -inf],
          [ 8.4269e-01, -8.3016e-01, -1.1818e+00,  1.7275e+00]],

         [[ 1.8348e-01,        -inf,        -inf,        -inf],
          [ 4.6236e+00,  1.4937e+00,        -inf,        -inf],
          [ 4.5251e+00,  2.5936e+00,  2.8810e+00,        -inf],
          [ 1.5462e+00,  5.7580e-02, -1.9003e+00,  1.5311e+00]],

         [[ 3.2645e+00,        -inf,        -inf,        -inf],
          [ 6.8302e-01, -3.4147e+00,        -inf,        -inf],
          [-2.8100e+00,  2.5461e+00,  1.9078e+00,        -inf],
          [ 3.8951e-01,  7.2849e+00,  1.0826e+00,  3.4067e+00]],

         [[ 4.2731e-01,        -inf,        -inf,        -inf],
          [ 5.0250e-01,  5.5587e-01,        -inf,        -inf],
          [ 3.2991e-01,  5.1496e+00, -2.5618e+00,        -inf],
          [ 2.2790e+00,  1.2699e+00, -2.6835e+00, -1.5066e+00]],

         [[ 9.6382e-01,        -inf,        -inf,        -inf],
          [ 1.4559e+00,  4.3917e-01,        -inf,        -inf],
          [-3.5909e+00, -2.9236e+00, -4.3611e+00,        -inf],
          [-1.9322e+00, -4.5460e+00,  7.1767e-01, -3.2446e+00]],

         [[-5.8454e+00,        -inf,        -inf,        -inf],
          [ 1.1645e+00,  4.1136e+00,        -inf,        -inf],
          [-2.9470e+00,  1.0907e+00, -2.3431e+00,        -inf],
          [-2.0106e+00,  2.6379e+00,  1.0247e+00,  8.6846e-01]],

         [[ 7.9212e-01,        -inf,        -inf,        -inf],
          [-3.4506e+00, -2.6986e+00,        -inf,        -inf],
          [-1.1085e+00,  3.8747e+00, -2.3851e+00,        -inf],
          [ 1.3345e+00,  1.2414e-01, -2.4742e+00,  7.0279e-02]],

         [[-1.8012e+00,        -inf,        -inf,        -inf],
          [ 1.2803e+00, -5.2868e+00,        -inf,        -inf],
          [ 3.5180e-01, -3.6156e-02,  9.6572e-01,        -inf],
          [ 2.5062e+00, -4.2701e-01, -1.7208e+00,  2.9840e+00]],

         [[ 2.3595e-01,        -inf,        -inf,        -inf],
          [-3.4378e+00, -5.2371e-01,        -inf,        -inf],
          [ 5.7943e-01, -1.7893e+00, -7.4473e-02,        -inf],
          [-3.4163e+00, -3.4801e+00,  1.9753e+00,  7.9341e-01]]],


        [[[-4.7991e+00,        -inf,        -inf,        -inf],
          [ 1.1153e+00, -1.0378e+00,        -inf,        -inf],
          [ 3.4770e+00, -2.3089e+00,  9.7604e-01,        -inf],
          [ 1.3747e+00, -5.8666e+00, -8.4140e-01,  2.9695e-01]],

         [[-2.8808e+00,        -inf,        -inf,        -inf],
          [ 2.1172e+00,  4.7193e+00,        -inf,        -inf],
          [ 2.0586e+00,  6.4089e-02, -3.6288e-01,        -inf],
          [ 1.0563e+00,  2.2575e+00, -7.0650e-01, -2.4400e+00]],

         [[-1.3087e-01,        -inf,        -inf,        -inf],
          [-1.8878e+00,  8.0750e-01,        -inf,        -inf],
          [-2.7615e-01,  3.0167e+00, -2.9791e+00,        -inf],
          [-2.2129e+00, -3.1163e+00, -3.7098e+00,  2.0720e+00]],

         [[ 8.6309e-01,        -inf,        -inf,        -inf],
          [ 4.6465e+00,  4.1598e+00,        -inf,        -inf],
          [ 3.5933e+00,  2.8353e+00, -1.6421e+00,        -inf],
          [ 4.8641e+00,  1.8546e+00,  1.0703e+00, -2.5553e+00]],

         [[-4.1368e-01,        -inf,        -inf,        -inf],
          [ 3.1213e+00,  5.9935e-01,        -inf,        -inf],
          [ 2.0980e+00,  3.1219e+00,  1.4866e+00,        -inf],
          [ 9.9488e-01,  1.0383e+00,  1.6030e+00,  1.0831e+00]],

         [[ 2.3889e+00,        -inf,        -inf,        -inf],
          [ 1.5800e+00, -2.1611e+00,        -inf,        -inf],
          [ 2.0995e+00,  2.2090e+00, -2.7473e+00,        -inf],
          [-5.7195e+00,  3.8735e+00, -1.2620e+00,  4.7541e-01]],

         [[-1.7336e+00,        -inf,        -inf,        -inf],
          [ 1.2647e+00,  2.5817e-01,        -inf,        -inf],
          [-2.7155e+00, -4.1406e-01,  6.7065e-01,        -inf],
          [-8.5261e+00, -2.7244e+00, -1.8167e+00, -3.1327e-01]],

         [[-4.7671e+00,        -inf,        -inf,        -inf],
          [-5.3383e+00,  8.2071e-01,        -inf,        -inf],
          [-5.2943e-01,  2.3751e+00, -3.3085e+00,        -inf],
          [-4.3813e+00,  3.0321e+00, -5.0243e+00,  2.0543e+00]],

         [[-3.4369e-01,        -inf,        -inf,        -inf],
          [ 6.5334e+00,  6.0080e+00,        -inf,        -inf],
          [-3.8618e-01, -3.6142e+00,  5.9021e+00,        -inf],
          [ 8.6628e-01, -2.5389e+00, -3.8884e+00,  8.1743e-01]],

         [[-9.1330e-01,        -inf,        -inf,        -inf],
          [ 3.5755e+00,  1.1769e+00,        -inf,        -inf],
          [-5.1767e+00, -8.0576e-01, -1.7815e+00,        -inf],
          [-1.5903e-01, -2.5667e+00,  9.7686e-01,  2.8279e+00]],

         [[-9.0884e-01,        -inf,        -inf,        -inf],
          [-3.6638e-01, -3.1650e+00,        -inf,        -inf],
          [-1.5211e-01,  2.4134e-01,  4.2386e+00,        -inf],
          [-2.6246e+00, -4.2088e+00, -9.7095e-01, -2.2399e+00]],

         [[ 1.2858e+00,        -inf,        -inf,        -inf],
          [-2.7131e+00,  2.8523e-01,        -inf,        -inf],
          [-1.7167e+00,  3.5748e+00,  2.3981e+00,        -inf],
          [-1.9855e+00, -2.9854e+00,  3.2523e+00, -2.8609e+00]],

         [[-3.9483e+00,        -inf,        -inf,        -inf],
          [-1.4553e+00,  1.7682e+00,        -inf,        -inf],
          [-3.6903e+00, -3.3527e+00, -1.2819e+00,        -inf],
          [ 3.9497e+00, -2.6136e+00, -4.4865e+00,  3.5563e+00]],

         [[-9.8563e-02,        -inf,        -inf,        -inf],
          [ 1.2341e+00,  4.1239e+00,        -inf,        -inf],
          [-4.2146e-01, -3.3573e+00, -1.0540e+00,        -inf],
          [ 1.1414e+00, -6.5383e-01, -1.4926e+00, -2.2162e+00]],

         [[-9.9866e-01,        -inf,        -inf,        -inf],
          [ 5.3668e-01,  8.6742e-01,        -inf,        -inf],
          [-3.3969e+00,  1.2229e+00, -1.5559e+00,        -inf],
          [-4.8214e-01, -6.0790e-01,  5.1293e+00, -5.9480e+00]],

         [[-6.1828e-01,        -inf,        -inf,        -inf],
          [-1.2189e+00, -8.7182e-02,        -inf,        -inf],
          [ 2.1710e+00,  2.9091e+00,  4.6486e+00,        -inf],
          [ 2.1703e+00, -2.0618e+00,  1.1641e+00, -2.6588e+00]],

         [[-5.3754e+00,        -inf,        -inf,        -inf],
          [ 1.1999e+00, -1.3863e+00,        -inf,        -inf],
          [-2.2347e+00, -2.6404e-01, -1.0594e+00,        -inf],
          [-3.0592e-01,  1.9612e+00,  4.9537e+00, -7.9090e-01]],

         [[-9.2861e-01,        -inf,        -inf,        -inf],
          [ 4.4216e+00, -1.0919e+00,        -inf,        -inf],
          [ 3.3168e+00, -1.0363e+00,  3.8293e+00,        -inf],
          [ 3.0453e+00, -9.8192e-01,  3.3049e+00, -5.6449e-01]],

         [[-2.4284e-01,        -inf,        -inf,        -inf],
          [ 1.4642e+00, -2.6328e+00,        -inf,        -inf],
          [-1.2274e+00,  5.8399e-01, -2.5330e+00,        -inf],
          [ 1.4264e+00,  7.0092e-02, -5.4101e-01, -4.9581e+00]],

         [[ 1.0883e+00,        -inf,        -inf,        -inf],
          [-4.3961e-01, -9.6113e-01,        -inf,        -inf],
          [ 1.4150e+00,  9.0980e-01,  2.0630e+00,        -inf],
          [ 5.6398e+00,  1.3267e+00, -1.4436e+00, -4.0662e+00]],

         [[-7.6752e-02,        -inf,        -inf,        -inf],
          [-4.2131e+00,  2.1742e-01,        -inf,        -inf],
          [ 7.4436e-01,  6.0140e-01,  3.1076e+00,        -inf],
          [ 8.4049e-01, -3.6096e+00, -3.5004e-01,  1.3298e+00]],

         [[-4.8137e+00,        -inf,        -inf,        -inf],
          [ 1.1270e+00, -2.3899e+00,        -inf,        -inf],
          [-3.8344e-01, -7.2021e+00,  1.9077e+00,        -inf],
          [-1.4465e+00,  2.3795e+00, -3.2525e+00,  1.9265e+00]],

         [[-2.7439e+00,        -inf,        -inf,        -inf],
          [-1.6881e+00, -1.8252e+00,        -inf,        -inf],
          [ 5.5365e-01, -4.9644e-01, -4.5492e-01,        -inf],
          [ 5.1732e+00,  2.9067e+00, -1.4061e+00,  2.5729e+00]],

         [[-1.4722e+00,        -inf,        -inf,        -inf],
          [ 8.9375e-01,  5.9736e+00,        -inf,        -inf],
          [-3.2081e+00,  1.1830e+00,  3.5038e+00,        -inf],
          [ 1.4462e+00,  2.7480e+00, -4.7829e+00,  2.2024e+00]],

         [[ 1.5349e+00,        -inf,        -inf,        -inf],
          [-4.5983e+00, -4.9340e+00,        -inf,        -inf],
          [ 1.2500e+00,  1.6795e+00,  3.3722e+00,        -inf],
          [-3.8921e+00,  1.9474e+00,  1.9836e+00,  7.7690e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 1.5365, -0.3676,  0.4804,  ...,  0.0899, -0.3899, -0.6288],
          [-0.5336,  0.8425,  0.0247,  ...,  0.8644,  0.4295, -0.4325],
          [ 0.4709, -0.2596,  0.2466,  ...,  0.4456,  0.3254, -0.3299],
          ...,
          [ 0.1104,  1.3394, -0.5031,  ...,  0.0472,  0.9667,  1.1264],
          [ 0.0640,  0.6883, -0.1134,  ...,  0.5330,  0.1293,  0.2213],
          [ 0.5690, -0.1623,  0.3010,  ..., -0.9110, -0.9593,  0.4622]],

         [[ 0.8344,  0.0423, -0.1118,  ..., -0.2156, -0.9890, -0.6180],
          [-0.3107,  0.9455, -0.1024,  ...,  1.0715, -0.3938, -0.3611],
          [ 0.1335, -0.1078, -0.3208,  ...,  0.6210,  0.0802, -0.1786],
          ...,
          [-0.1620,  1.2870, -0.1935,  ..., -0.0898,  0.6137,  0.3565],
          [ 0.2555,  0.3889, -0.2141,  ...,  0.3203,  0.3279,  0.1580],
          [ 0.4475, -0.3438, -0.2295,  ..., -0.7172, -1.0839, -0.0354]],

         [[ 0.8408, -0.1121,  0.2580,  ..., -0.0241, -0.7705, -0.5695],
          [-0.0191,  0.2455,  0.2262,  ...,  0.7679, -0.0748,  0.6581],
          [-0.0719, -0.0443, -0.4318,  ...,  0.8018, -0.2000, -0.2613],
          ...,
          [-0.3187,  1.1407,  0.0206,  ..., -0.0766,  0.6234,  0.1512],
          [ 0.5182,  0.0944, -0.2202,  ...,  0.1056,  0.3077,  0.1849],
          [ 0.3759, -0.3325,  0.2364,  ..., -0.3650, -0.5924,  0.2457]],

         [[ 0.7033,  0.0307,  0.3012,  ...,  0.0617, -0.7407, -0.3687],
          [-0.1485,  0.5550,  0.2604,  ...,  0.8429, -0.1377,  0.3352],
          [ 0.0786, -0.0845, -0.4551,  ...,  0.7605,  0.0871, -0.1694],
          ...,
          [-0.3088,  0.9298, -0.2269,  ...,  0.0959,  0.4245,  0.4742],
          [ 0.3045,  0.5733, -0.1785,  ...,  0.5648,  0.4404,  0.5580],
          [ 0.3253,  0.0897,  0.1881,  ..., -0.3071,  0.1526,  0.2093]]],


        [[[ 1.1693, -0.1821,  0.3155,  ...,  0.0322, -0.5736, -0.4986],
          [-0.3081,  0.3309, -0.1339,  ...,  0.8348,  0.0799, -0.5625],
          [ 0.1548, -0.7401,  0.1630,  ...,  0.7188,  0.2687, -0.4238],
          ...,
          [ 0.4600,  1.0878, -0.6488,  ..., -0.0060,  1.0749,  1.3181],
          [ 0.2111,  0.1326, -0.1112,  ...,  0.6691, -0.0983,  0.2257],
          [ 0.8241, -0.2086,  0.0273,  ..., -0.8303, -0.7264, -0.0749]],

         [[ 0.9698, -0.2169, -0.1650,  ...,  0.3044, -0.4624, -0.3946],
          [-0.1104,  0.0674, -0.0775,  ...,  0.1480, -0.1983, -0.0069],
          [ 0.1376, -0.3800, -0.4030,  ...,  0.7345, -0.0174,  0.0761],
          ...,
          [-0.0467,  0.5637,  0.0713,  ..., -0.0639,  0.7908,  0.6398],
          [ 0.6051,  0.8182, -1.0143,  ...,  0.7549, -0.4697, -0.3741],
          [ 0.5897, -0.3717,  0.2353,  ..., -0.7811, -0.6289,  0.0844]],

         [[ 0.8638,  0.4132,  0.0612,  ...,  0.2206, -0.1485, -0.0935],
          [-0.1115,  0.0052,  0.2298,  ...,  0.6324, -0.2462, -0.2411],
          [ 0.1424, -0.1764, -0.5390,  ...,  0.6383, -0.1892, -0.0199],
          ...,
          [-0.2271, -0.1650,  0.3841,  ...,  0.1580,  0.4692, -0.1451],
          [ 0.5816,  0.3557, -0.5652,  ...,  0.6177, -0.1316, -0.3582],
          [ 0.5898, -0.0608,  0.2393,  ..., -0.3767, -0.2825,  0.1175]],

         [[ 0.6165,  0.3233,  0.0683,  ...,  0.1451, -0.0952, -0.0564],
          [-0.0346,  0.1695,  0.1749,  ...,  0.4480, -0.2327, -0.1438],
          [-0.0757, -0.2482, -0.3098,  ...,  0.5301, -0.3161,  0.1112],
          ...,
          [-0.2966,  0.3851, -0.0625,  ...,  0.1311,  0.3885,  0.5540],
          [ 0.3939,  0.3944, -0.5143,  ...,  0.5233, -0.2103, -0.1900],
          [ 0.3056, -0.0037, -0.0765,  ..., -0.2924,  0.2803, -0.2606]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 1.5365, -0.3676,  0.4804,  ..., -0.9110, -0.9593,  0.4622],
         [ 0.8344,  0.0423, -0.1118,  ..., -0.7172, -1.0839, -0.0354],
         [ 0.8408, -0.1121,  0.2580,  ..., -0.3650, -0.5924,  0.2457],
         [ 0.7033,  0.0307,  0.3012,  ..., -0.3071,  0.1526,  0.2093]],

        [[ 1.1693, -0.1821,  0.3155,  ..., -0.8303, -0.7264, -0.0749],
         [ 0.9698, -0.2169, -0.1650,  ..., -0.7811, -0.6289,  0.0844],
         [ 0.8638,  0.4132,  0.0612,  ..., -0.3767, -0.2825,  0.1175],
         [ 0.6165,  0.3233,  0.0683,  ..., -0.2924,  0.2803, -0.2606]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2195, -0.1185,  0.5335,  ..., -0.3726, -0.5258,  0.6888],
         [ 0.1686, -0.2513,  0.2373,  ..., -0.3039, -0.0487,  0.3122],
         [ 0.2068, -0.1085,  0.1219,  ..., -0.1047, -0.1558,  0.5353],
         [ 0.1122, -0.1651,  0.1673,  ..., -0.0900, -0.1325,  0.4289]],

        [[ 0.0843, -0.1483,  0.9051,  ..., -0.0134, -0.1482,  0.2022],
         [ 0.2295, -0.4496,  0.0651,  ..., -0.1398, -0.0359,  0.3063],
         [ 0.2741, -0.2699,  0.1427,  ...,  0.1974,  0.0977,  0.3927],
         [ 0.1414, -0.4316,  0.2640,  ...,  0.0941,  0.0234,  0.2435]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ -0.3941,     -inf,     -inf,     -inf],
          [  3.6336,   2.3869,     -inf,     -inf],
          [  6.4198, -10.1603,  -0.0141,     -inf],
          [ -1.9689,   0.7877,  -2.6715,   0.7122]],

         [[  1.1946,     -inf,     -inf,     -inf],
          [  3.5689,   1.5771,     -inf,     -inf],
          [  2.6769,   0.2614,  -0.6351,     -inf],
          [  0.6084,   3.9222,  -2.0487,  -1.0998]],

         [[  0.2128,     -inf,     -inf,     -inf],
          [ -0.1234,  -1.4046,     -inf,     -inf],
          [  0.7359,  -3.1542,  -1.7675,     -inf],
          [ -1.1816,   0.8995,  -1.5568,  -1.9125]],

         [[  0.9216,     -inf,     -inf,     -inf],
          [ -1.9240,   1.6665,     -inf,     -inf],
          [ -3.3245,   0.0427,  -2.4617,     -inf],
          [ -1.8543,   1.5717,  -2.4936,   2.5628]],

         [[ -0.0832,     -inf,     -inf,     -inf],
          [ -2.9769,  -2.6974,     -inf,     -inf],
          [  3.0962,   0.5876,  -5.3059,     -inf],
          [ -0.1222,   0.6202,  -6.0882,   3.7581]],

         [[ -1.0542,     -inf,     -inf,     -inf],
          [  2.8242,   2.2389,     -inf,     -inf],
          [  0.6952,   0.3900,   1.5543,     -inf],
          [ -0.6420,  -1.7868,  -2.9294,  -4.1525]],

         [[  0.5463,     -inf,     -inf,     -inf],
          [  1.4910,  -0.7919,     -inf,     -inf],
          [  0.4408,  -1.9137,  -0.8927,     -inf],
          [  2.8604,   0.9292,  -1.0706,  -3.1416]],

         [[ -0.6053,     -inf,     -inf,     -inf],
          [  0.2496,   1.1284,     -inf,     -inf],
          [ -4.5146,  -1.4693,   1.9811,     -inf],
          [ -3.5613,   1.0199,   1.5327,   5.4447]],

         [[ -0.3107,     -inf,     -inf,     -inf],
          [ -0.5649,  -1.6866,     -inf,     -inf],
          [  4.4789,   3.8047,  -0.3540,     -inf],
          [ -2.2626,   1.5276,  -4.0854,  -2.3281]],

         [[  0.8734,     -inf,     -inf,     -inf],
          [ -2.2043,  -0.1073,     -inf,     -inf],
          [ -8.6905,  -1.5387,  -3.7122,     -inf],
          [ -2.4936,   1.3521,  -0.2560,  -4.9460]],

         [[ -1.2030,     -inf,     -inf,     -inf],
          [ -2.0084,   6.5748,     -inf,     -inf],
          [  4.5839,  -1.3478,  -2.5463,     -inf],
          [ -0.9705,   1.3668,  -1.0499,  -8.0146]],

         [[ -0.1894,     -inf,     -inf,     -inf],
          [  2.0145,  -1.2869,     -inf,     -inf],
          [ -2.3307,   1.8633,   3.1668,     -inf],
          [ -0.4539,   2.7724,  -2.1616,   2.4275]],

         [[ -0.1590,     -inf,     -inf,     -inf],
          [  5.1151,   1.2699,     -inf,     -inf],
          [ -0.3488,  -0.7980,  -2.9170,     -inf],
          [  1.7976,   0.0849,   1.8435,  -0.1487]],

         [[ -1.9766,     -inf,     -inf,     -inf],
          [ -0.0471,  -1.4905,     -inf,     -inf],
          [  1.5596,  -1.2424,  -4.9106,     -inf],
          [ -1.0483,   1.4494,  -5.2168,  -1.7058]],

         [[ -1.3147,     -inf,     -inf,     -inf],
          [ -0.6983,  -3.5304,     -inf,     -inf],
          [ -2.0615,  -0.6221,  -3.9989,     -inf],
          [  3.8629,  -0.4220,   0.0754,  -0.4961]],

         [[  1.6984,     -inf,     -inf,     -inf],
          [ -1.5279,  -1.9041,     -inf,     -inf],
          [  1.4227,  -0.6747,   0.6485,     -inf],
          [ -4.2581,   2.3889,   0.1058,   2.5723]],

         [[ -8.3686,     -inf,     -inf,     -inf],
          [  1.6377,  -1.2735,     -inf,     -inf],
          [ -0.5900,   3.2753,   0.7359,     -inf],
          [  1.5698,  -2.0888,   2.0133,   1.8670]],

         [[  4.0691,     -inf,     -inf,     -inf],
          [ -2.1724,   1.0827,     -inf,     -inf],
          [ -0.4890,  -1.0171,  -0.8679,     -inf],
          [  1.6352,  -2.5052,   3.6638,  -4.6656]],

         [[ -1.6324,     -inf,     -inf,     -inf],
          [  1.6698,  -3.6880,     -inf,     -inf],
          [  2.3243,  -6.3252,   1.1010,     -inf],
          [ -0.6408,   1.5622,  -2.0555,  -1.4278]],

         [[  2.1458,     -inf,     -inf,     -inf],
          [  1.4435,  -1.8280,     -inf,     -inf],
          [ -1.0850,   5.6637,   3.1514,     -inf],
          [  2.2531,  -3.4925,  -6.0255,  -2.4473]],

         [[ -1.4923,     -inf,     -inf,     -inf],
          [ -2.4516,  -0.1484,     -inf,     -inf],
          [  0.3203,  -3.1224,   2.8197,     -inf],
          [ -1.6371,   0.5512,  -1.4718,  -6.7808]],

         [[  2.3397,     -inf,     -inf,     -inf],
          [ -0.3135,  -0.3851,     -inf,     -inf],
          [ -2.5087,  -1.2078,   2.4521,     -inf],
          [  1.5682,   2.6256,   1.7824,  -2.3507]],

         [[ -3.2980,     -inf,     -inf,     -inf],
          [ -3.6156,   7.5504,     -inf,     -inf],
          [  0.1906,  -3.9944,  -5.6694,     -inf],
          [  1.6662,  -1.8249,  -1.0739,  -0.9680]],

         [[  0.3059,     -inf,     -inf,     -inf],
          [ -2.4000,  -2.1842,     -inf,     -inf],
          [ -1.1071,   0.5594,   0.9872,     -inf],
          [  1.4859,  -0.4141,   1.0724,  -0.3323]],

         [[  4.6695,     -inf,     -inf,     -inf],
          [  1.7662,   1.0456,     -inf,     -inf],
          [  1.7172,  -1.2092,  -0.9385,     -inf],
          [  2.5222,  -2.7439,  -0.9971,   3.7976]]],


        [[[ -0.9568,     -inf,     -inf,     -inf],
          [  3.7143,  -1.9945,     -inf,     -inf],
          [  3.6903,   1.3659,   0.3479,     -inf],
          [ -3.3030,   0.2717,   2.0655,  -0.5097]],

         [[  0.0315,     -inf,     -inf,     -inf],
          [  2.0625,   1.6686,     -inf,     -inf],
          [ -2.4221,  -2.0818,   1.8405,     -inf],
          [ -1.9027,   0.2525,  -1.4421,   2.1358]],

         [[  0.2813,     -inf,     -inf,     -inf],
          [  2.0935,   5.5225,     -inf,     -inf],
          [ -0.4168,   1.1868,  -4.5701,     -inf],
          [ -4.2182,   1.5938,  -5.0717,  -1.7291]],

         [[  0.1217,     -inf,     -inf,     -inf],
          [ -3.7386,   0.6133,     -inf,     -inf],
          [  3.4943,  -4.0441,  -0.5680,     -inf],
          [  2.5783,  -0.0687,   1.7078,  -4.1734]],

         [[ -1.1552,     -inf,     -inf,     -inf],
          [ -2.0960,  -1.4698,     -inf,     -inf],
          [  3.0125,   2.1559,  -4.9233,     -inf],
          [ -1.7222,  -0.1379,   2.2046,  -0.9257]],

         [[ -1.2010,     -inf,     -inf,     -inf],
          [  1.7654,   3.8718,     -inf,     -inf],
          [  0.9499,  -1.3744,  -2.0855,     -inf],
          [ -3.2143,   0.0858,   2.7145,  -2.2857]],

         [[  0.4091,     -inf,     -inf,     -inf],
          [  2.4607,   1.6059,     -inf,     -inf],
          [  1.7007,   1.5220,  -1.9418,     -inf],
          [  1.2538,   5.0692,  -6.3281,   1.0474]],

         [[ -1.1884,     -inf,     -inf,     -inf],
          [  0.1878,   4.4818,     -inf,     -inf],
          [  0.2932,   1.7273,  -0.9983,     -inf],
          [ -2.0687,   3.3820,  -2.8545,   3.1375]],

         [[  4.4839,     -inf,     -inf,     -inf],
          [ -0.8344,   4.6533,     -inf,     -inf],
          [  2.5439,   3.3281,   1.3675,     -inf],
          [  0.6642,   1.2807,  -4.6142,  -1.2842]],

         [[  1.4914,     -inf,     -inf,     -inf],
          [  1.3718,   0.5430,     -inf,     -inf],
          [ -3.5655,   0.3409,  -1.2857,     -inf],
          [  0.8608,   0.9837,  -1.5625,  -1.0361]],

         [[ -0.6206,     -inf,     -inf,     -inf],
          [ -2.1833,   1.6969,     -inf,     -inf],
          [  2.1604,  -2.8901,  -0.6110,     -inf],
          [  2.7181,  -0.2062,  -3.3910,  -1.3186]],

         [[ -2.2280,     -inf,     -inf,     -inf],
          [  2.6544,   0.7552,     -inf,     -inf],
          [ -2.4998,   0.8456,  -0.4537,     -inf],
          [ -2.2588,   5.9837,   0.4701,  -2.1526]],

         [[ -0.9975,     -inf,     -inf,     -inf],
          [  1.5297,  -3.1993,     -inf,     -inf],
          [ -0.3572,  -4.0372,  -1.6430,     -inf],
          [  0.0783,   1.0105,   2.6355,   3.3162]],

         [[  1.0599,     -inf,     -inf,     -inf],
          [ -4.5409,  -0.8293,     -inf,     -inf],
          [  3.3017,  -1.4295,   1.4131,     -inf],
          [  4.5065,   4.5876,   1.2911,   2.5077]],

         [[  0.4690,     -inf,     -inf,     -inf],
          [  3.1880,  -2.0386,     -inf,     -inf],
          [ -2.0541,   2.7021,   0.3837,     -inf],
          [  0.3533,  -2.7069,  -1.5009,  -0.7622]],

         [[  0.9213,     -inf,     -inf,     -inf],
          [ -1.9061,  -1.8496,     -inf,     -inf],
          [ -1.0974,  -0.9697,   1.2393,     -inf],
          [  0.9286,   3.1734,  -4.7437,   3.4216]],

         [[ -5.6657,     -inf,     -inf,     -inf],
          [  1.8434,   1.0854,     -inf,     -inf],
          [  1.6973,   0.7090,  -2.6393,     -inf],
          [  0.0908,  -2.3159,  -6.1206,  -0.0257]],

         [[  5.1456,     -inf,     -inf,     -inf],
          [ -1.2645,   2.7130,     -inf,     -inf],
          [ -2.9723,  -1.8682,  -0.1847,     -inf],
          [  1.3428,  -5.5525,  -1.7906,  -2.4358]],

         [[  1.2082,     -inf,     -inf,     -inf],
          [  3.3893,  -1.7327,     -inf,     -inf],
          [  5.7746,   0.0866,   3.4962,     -inf],
          [ -2.4109,   2.6956,  -3.1625,   2.6849]],

         [[  2.1420,     -inf,     -inf,     -inf],
          [  3.7827,  -1.2318,     -inf,     -inf],
          [ -1.0026,   2.4404,   0.6435,     -inf],
          [  1.3900,   0.1835,   0.6719,  -0.6611]],

         [[ -1.6144,     -inf,     -inf,     -inf],
          [  0.9010,  -2.4394,     -inf,     -inf],
          [ -3.5124,  -1.7675,   1.0502,     -inf],
          [ -3.0539,   2.5046,   3.2200,  -1.9521]],

         [[  1.5834,     -inf,     -inf,     -inf],
          [  2.0353,   1.0134,     -inf,     -inf],
          [ -5.5041,  -4.6809,  -6.1610,     -inf],
          [ -3.5270,   0.1585,  -3.0936,  -0.5363]],

         [[ -0.4647,     -inf,     -inf,     -inf],
          [ -1.0072,  -0.5084,     -inf,     -inf],
          [ -0.8733,   2.1684,   1.4566,     -inf],
          [  2.1607,  -1.5764,  -1.4181,  -1.9651]],

         [[  1.8336,     -inf,     -inf,     -inf],
          [ -4.3731,  -0.3728,     -inf,     -inf],
          [ -1.4994,  -1.0229,  -1.9780,     -inf],
          [  2.5277,  -0.8708,  -0.6790,   1.0807]],

         [[  4.9008,     -inf,     -inf,     -inf],
          [ -0.8084,  -2.7771,     -inf,     -inf],
          [ -1.0080,   0.6932,   0.0268,     -inf],
          [  5.4383,  -1.7750,  -3.8686,  -0.6979]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ -0.3941,     -inf,     -inf,     -inf],
          [  3.6336,   2.3869,     -inf,     -inf],
          [  6.4198, -10.1603,  -0.0141,     -inf],
          [ -1.9689,   0.7877,  -2.6715,   0.7122]],

         [[  1.1946,     -inf,     -inf,     -inf],
          [  3.5689,   1.5771,     -inf,     -inf],
          [  2.6769,   0.2614,  -0.6351,     -inf],
          [  0.6084,   3.9222,  -2.0487,  -1.0998]],

         [[  0.2128,     -inf,     -inf,     -inf],
          [ -0.1234,  -1.4046,     -inf,     -inf],
          [  0.7359,  -3.1542,  -1.7675,     -inf],
          [ -1.1816,   0.8995,  -1.5568,  -1.9125]],

         [[  0.9216,     -inf,     -inf,     -inf],
          [ -1.9240,   1.6665,     -inf,     -inf],
          [ -3.3245,   0.0427,  -2.4617,     -inf],
          [ -1.8543,   1.5717,  -2.4936,   2.5628]],

         [[ -0.0832,     -inf,     -inf,     -inf],
          [ -2.9769,  -2.6974,     -inf,     -inf],
          [  3.0962,   0.5876,  -5.3059,     -inf],
          [ -0.1222,   0.6202,  -6.0882,   3.7581]],

         [[ -1.0542,     -inf,     -inf,     -inf],
          [  2.8242,   2.2389,     -inf,     -inf],
          [  0.6952,   0.3900,   1.5543,     -inf],
          [ -0.6420,  -1.7868,  -2.9294,  -4.1525]],

         [[  0.5463,     -inf,     -inf,     -inf],
          [  1.4910,  -0.7919,     -inf,     -inf],
          [  0.4408,  -1.9137,  -0.8927,     -inf],
          [  2.8604,   0.9292,  -1.0706,  -3.1416]],

         [[ -0.6053,     -inf,     -inf,     -inf],
          [  0.2496,   1.1284,     -inf,     -inf],
          [ -4.5146,  -1.4693,   1.9811,     -inf],
          [ -3.5613,   1.0199,   1.5327,   5.4447]],

         [[ -0.3107,     -inf,     -inf,     -inf],
          [ -0.5649,  -1.6866,     -inf,     -inf],
          [  4.4789,   3.8047,  -0.3540,     -inf],
          [ -2.2626,   1.5276,  -4.0854,  -2.3281]],

         [[  0.8734,     -inf,     -inf,     -inf],
          [ -2.2043,  -0.1073,     -inf,     -inf],
          [ -8.6905,  -1.5387,  -3.7122,     -inf],
          [ -2.4936,   1.3521,  -0.2560,  -4.9460]],

         [[ -1.2030,     -inf,     -inf,     -inf],
          [ -2.0084,   6.5748,     -inf,     -inf],
          [  4.5839,  -1.3478,  -2.5463,     -inf],
          [ -0.9705,   1.3668,  -1.0499,  -8.0146]],

         [[ -0.1894,     -inf,     -inf,     -inf],
          [  2.0145,  -1.2869,     -inf,     -inf],
          [ -2.3307,   1.8633,   3.1668,     -inf],
          [ -0.4539,   2.7724,  -2.1616,   2.4275]],

         [[ -0.1590,     -inf,     -inf,     -inf],
          [  5.1151,   1.2699,     -inf,     -inf],
          [ -0.3488,  -0.7980,  -2.9170,     -inf],
          [  1.7976,   0.0849,   1.8435,  -0.1487]],

         [[ -1.9766,     -inf,     -inf,     -inf],
          [ -0.0471,  -1.4905,     -inf,     -inf],
          [  1.5596,  -1.2424,  -4.9106,     -inf],
          [ -1.0483,   1.4494,  -5.2168,  -1.7058]],

         [[ -1.3147,     -inf,     -inf,     -inf],
          [ -0.6983,  -3.5304,     -inf,     -inf],
          [ -2.0615,  -0.6221,  -3.9989,     -inf],
          [  3.8629,  -0.4220,   0.0754,  -0.4961]],

         [[  1.6984,     -inf,     -inf,     -inf],
          [ -1.5279,  -1.9041,     -inf,     -inf],
          [  1.4227,  -0.6747,   0.6485,     -inf],
          [ -4.2581,   2.3889,   0.1058,   2.5723]],

         [[ -8.3686,     -inf,     -inf,     -inf],
          [  1.6377,  -1.2735,     -inf,     -inf],
          [ -0.5900,   3.2753,   0.7359,     -inf],
          [  1.5698,  -2.0888,   2.0133,   1.8670]],

         [[  4.0691,     -inf,     -inf,     -inf],
          [ -2.1724,   1.0827,     -inf,     -inf],
          [ -0.4890,  -1.0171,  -0.8679,     -inf],
          [  1.6352,  -2.5052,   3.6638,  -4.6656]],

         [[ -1.6324,     -inf,     -inf,     -inf],
          [  1.6698,  -3.6880,     -inf,     -inf],
          [  2.3243,  -6.3252,   1.1010,     -inf],
          [ -0.6408,   1.5622,  -2.0555,  -1.4278]],

         [[  2.1458,     -inf,     -inf,     -inf],
          [  1.4435,  -1.8280,     -inf,     -inf],
          [ -1.0850,   5.6637,   3.1514,     -inf],
          [  2.2531,  -3.4925,  -6.0255,  -2.4473]],

         [[ -1.4923,     -inf,     -inf,     -inf],
          [ -2.4516,  -0.1484,     -inf,     -inf],
          [  0.3203,  -3.1224,   2.8197,     -inf],
          [ -1.6371,   0.5512,  -1.4718,  -6.7808]],

         [[  2.3397,     -inf,     -inf,     -inf],
          [ -0.3135,  -0.3851,     -inf,     -inf],
          [ -2.5087,  -1.2078,   2.4521,     -inf],
          [  1.5682,   2.6256,   1.7824,  -2.3507]],

         [[ -3.2980,     -inf,     -inf,     -inf],
          [ -3.6156,   7.5504,     -inf,     -inf],
          [  0.1906,  -3.9944,  -5.6694,     -inf],
          [  1.6662,  -1.8249,  -1.0739,  -0.9680]],

         [[  0.3059,     -inf,     -inf,     -inf],
          [ -2.4000,  -2.1842,     -inf,     -inf],
          [ -1.1071,   0.5594,   0.9872,     -inf],
          [  1.4859,  -0.4141,   1.0724,  -0.3323]],

         [[  4.6695,     -inf,     -inf,     -inf],
          [  1.7662,   1.0456,     -inf,     -inf],
          [  1.7172,  -1.2092,  -0.9385,     -inf],
          [  2.5222,  -2.7439,  -0.9971,   3.7976]]],


        [[[ -0.9568,     -inf,     -inf,     -inf],
          [  3.7143,  -1.9945,     -inf,     -inf],
          [  3.6903,   1.3659,   0.3479,     -inf],
          [ -3.3030,   0.2717,   2.0655,  -0.5097]],

         [[  0.0315,     -inf,     -inf,     -inf],
          [  2.0625,   1.6686,     -inf,     -inf],
          [ -2.4221,  -2.0818,   1.8405,     -inf],
          [ -1.9027,   0.2525,  -1.4421,   2.1358]],

         [[  0.2813,     -inf,     -inf,     -inf],
          [  2.0935,   5.5225,     -inf,     -inf],
          [ -0.4168,   1.1868,  -4.5701,     -inf],
          [ -4.2182,   1.5938,  -5.0717,  -1.7291]],

         [[  0.1217,     -inf,     -inf,     -inf],
          [ -3.7386,   0.6133,     -inf,     -inf],
          [  3.4943,  -4.0441,  -0.5680,     -inf],
          [  2.5783,  -0.0687,   1.7078,  -4.1734]],

         [[ -1.1552,     -inf,     -inf,     -inf],
          [ -2.0960,  -1.4698,     -inf,     -inf],
          [  3.0125,   2.1559,  -4.9233,     -inf],
          [ -1.7222,  -0.1379,   2.2046,  -0.9257]],

         [[ -1.2010,     -inf,     -inf,     -inf],
          [  1.7654,   3.8718,     -inf,     -inf],
          [  0.9499,  -1.3744,  -2.0855,     -inf],
          [ -3.2143,   0.0858,   2.7145,  -2.2857]],

         [[  0.4091,     -inf,     -inf,     -inf],
          [  2.4607,   1.6059,     -inf,     -inf],
          [  1.7007,   1.5220,  -1.9418,     -inf],
          [  1.2538,   5.0692,  -6.3281,   1.0474]],

         [[ -1.1884,     -inf,     -inf,     -inf],
          [  0.1878,   4.4818,     -inf,     -inf],
          [  0.2932,   1.7273,  -0.9983,     -inf],
          [ -2.0687,   3.3820,  -2.8545,   3.1375]],

         [[  4.4839,     -inf,     -inf,     -inf],
          [ -0.8344,   4.6533,     -inf,     -inf],
          [  2.5439,   3.3281,   1.3675,     -inf],
          [  0.6642,   1.2807,  -4.6142,  -1.2842]],

         [[  1.4914,     -inf,     -inf,     -inf],
          [  1.3718,   0.5430,     -inf,     -inf],
          [ -3.5655,   0.3409,  -1.2857,     -inf],
          [  0.8608,   0.9837,  -1.5625,  -1.0361]],

         [[ -0.6206,     -inf,     -inf,     -inf],
          [ -2.1833,   1.6969,     -inf,     -inf],
          [  2.1604,  -2.8901,  -0.6110,     -inf],
          [  2.7181,  -0.2062,  -3.3910,  -1.3186]],

         [[ -2.2280,     -inf,     -inf,     -inf],
          [  2.6544,   0.7552,     -inf,     -inf],
          [ -2.4998,   0.8456,  -0.4537,     -inf],
          [ -2.2588,   5.9837,   0.4701,  -2.1526]],

         [[ -0.9975,     -inf,     -inf,     -inf],
          [  1.5297,  -3.1993,     -inf,     -inf],
          [ -0.3572,  -4.0372,  -1.6430,     -inf],
          [  0.0783,   1.0105,   2.6355,   3.3162]],

         [[  1.0599,     -inf,     -inf,     -inf],
          [ -4.5409,  -0.8293,     -inf,     -inf],
          [  3.3017,  -1.4295,   1.4131,     -inf],
          [  4.5065,   4.5876,   1.2911,   2.5077]],

         [[  0.4690,     -inf,     -inf,     -inf],
          [  3.1880,  -2.0386,     -inf,     -inf],
          [ -2.0541,   2.7021,   0.3837,     -inf],
          [  0.3533,  -2.7069,  -1.5009,  -0.7622]],

         [[  0.9213,     -inf,     -inf,     -inf],
          [ -1.9061,  -1.8496,     -inf,     -inf],
          [ -1.0974,  -0.9697,   1.2393,     -inf],
          [  0.9286,   3.1734,  -4.7437,   3.4216]],

         [[ -5.6657,     -inf,     -inf,     -inf],
          [  1.8434,   1.0854,     -inf,     -inf],
          [  1.6973,   0.7090,  -2.6393,     -inf],
          [  0.0908,  -2.3159,  -6.1206,  -0.0257]],

         [[  5.1456,     -inf,     -inf,     -inf],
          [ -1.2645,   2.7130,     -inf,     -inf],
          [ -2.9723,  -1.8682,  -0.1847,     -inf],
          [  1.3428,  -5.5525,  -1.7906,  -2.4358]],

         [[  1.2082,     -inf,     -inf,     -inf],
          [  3.3893,  -1.7327,     -inf,     -inf],
          [  5.7746,   0.0866,   3.4962,     -inf],
          [ -2.4109,   2.6956,  -3.1625,   2.6849]],

         [[  2.1420,     -inf,     -inf,     -inf],
          [  3.7827,  -1.2318,     -inf,     -inf],
          [ -1.0026,   2.4404,   0.6435,     -inf],
          [  1.3900,   0.1835,   0.6719,  -0.6611]],

         [[ -1.6144,     -inf,     -inf,     -inf],
          [  0.9010,  -2.4394,     -inf,     -inf],
          [ -3.5124,  -1.7675,   1.0502,     -inf],
          [ -3.0539,   2.5046,   3.2200,  -1.9521]],

         [[  1.5834,     -inf,     -inf,     -inf],
          [  2.0353,   1.0134,     -inf,     -inf],
          [ -5.5041,  -4.6809,  -6.1610,     -inf],
          [ -3.5270,   0.1585,  -3.0936,  -0.5363]],

         [[ -0.4647,     -inf,     -inf,     -inf],
          [ -1.0072,  -0.5084,     -inf,     -inf],
          [ -0.8733,   2.1684,   1.4566,     -inf],
          [  2.1607,  -1.5764,  -1.4181,  -1.9651]],

         [[  1.8336,     -inf,     -inf,     -inf],
          [ -4.3731,  -0.3728,     -inf,     -inf],
          [ -1.4994,  -1.0229,  -1.9780,     -inf],
          [  2.5277,  -0.8708,  -0.6790,   1.0807]],

         [[  4.9008,     -inf,     -inf,     -inf],
          [ -0.8084,  -2.7771,     -inf,     -inf],
          [ -1.0080,   0.6932,   0.0268,     -inf],
          [  5.4383,  -1.7750,  -3.8686,  -0.6979]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 6.7451e-01,  3.3170e-01, -7.0456e-01,  ...,  2.0416e-01,
            2.0703e-01, -5.8588e-01],
          [-4.0205e-01,  8.1887e-01,  3.5912e-02,  ..., -1.3300e+00,
           -7.3810e-01,  1.1994e+00],
          [ 3.3823e-01,  9.2907e-01,  1.2061e+00,  ..., -3.1010e-01,
            3.9310e-01, -5.3577e-01],
          ...,
          [ 7.9455e-02,  1.3884e-01, -5.7629e-01,  ...,  6.7361e-01,
           -1.8575e-01, -4.2436e-01],
          [ 1.1750e+00,  3.7956e-01,  1.4730e+00,  ...,  5.2069e-01,
           -5.0712e-01, -2.9199e-01],
          [-1.3219e-03, -8.5571e-01,  9.9678e-01,  ...,  4.0988e-01,
           -5.5046e-02, -1.4737e-01]],

         [[ 2.5693e-01,  1.0135e-01,  3.2784e-02,  ..., -2.7006e-01,
           -3.0195e-01, -9.7441e-01],
          [ 1.8820e-01,  9.3721e-01, -5.0337e-01,  ..., -5.6656e-01,
           -2.1088e-01,  6.6120e-01],
          [-5.4591e-02,  4.8606e-01,  5.3805e-01,  ..., -6.7928e-01,
            1.4322e-01, -8.7679e-01],
          ...,
          [ 6.4638e-01, -2.6316e-01,  5.1547e-01,  ..., -2.9672e-01,
           -5.6332e-01, -5.6694e-01],
          [ 5.9310e-01,  1.9922e-02,  7.4439e-01,  ...,  4.6041e-01,
           -8.4310e-02, -9.0087e-01],
          [-1.3316e-01, -2.8741e-01,  6.6182e-01,  ...,  3.3088e-02,
           -2.6255e-01, -7.1070e-01]],

         [[ 4.0824e-01,  1.0397e-01, -3.6894e-01,  ...,  5.4201e-02,
            2.9158e-01, -3.6743e-01],
          [ 1.2369e-01,  6.7659e-01, -3.5317e-01,  ..., -4.2695e-01,
           -1.6414e-01,  4.9069e-01],
          [-1.2133e-01, -3.3073e-02, -1.9619e-01,  ..., -3.7132e-01,
            2.3781e-01, -4.3603e-01],
          ...,
          [ 1.6270e-01, -1.7826e-01, -4.6784e-02,  ...,  3.5747e-02,
           -5.1956e-01, -2.4194e-01],
          [ 8.1940e-01,  3.5617e-02,  1.1272e+00,  ...,  8.2385e-01,
           -3.9631e-03, -1.0217e+00],
          [ 1.2253e-01, -2.8445e-01,  2.8519e-01,  ...,  6.4922e-01,
           -3.0591e-01,  2.7552e-01]],

         [[ 4.7657e-01, -1.0418e-01, -2.2344e-01,  ...,  3.4826e-01,
           -7.8997e-02,  4.1259e-02],
          [ 4.9432e-01,  5.3020e-01, -5.3066e-01,  ..., -2.6413e-03,
            3.3707e-01,  1.8022e-01],
          [-2.2046e-01,  2.2185e-01,  1.7094e-01,  ..., -4.7746e-01,
            1.6977e-01, -5.5350e-01],
          ...,
          [-5.9090e-02, -4.6049e-01, -7.2161e-02,  ...,  1.8298e-01,
           -4.2571e-01, -3.5608e-01],
          [ 5.2778e-01, -8.3728e-02,  9.5617e-01,  ...,  5.7798e-01,
           -1.4620e-01, -8.2871e-01],
          [ 1.4541e-01, -3.1336e-02,  4.2798e-01,  ...,  3.5882e-01,
           -3.3995e-01, -2.5110e-01]]],


        [[[ 1.1245e+00, -2.2716e-01, -2.9835e-01,  ..., -1.4645e-01,
            1.1343e-01, -9.1255e-01],
          [-4.7937e-02,  7.5301e-01, -1.4109e-01,  ..., -1.3218e+00,
           -9.9974e-03,  1.0946e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 1.7788e-01,  3.5950e-01, -5.6639e-01,  ...,  4.6632e-01,
           -1.2419e-01,  5.1638e-02],
          [ 6.7625e-01,  3.8281e-01,  1.2531e+00,  ...,  4.1519e-01,
            2.6723e-01, -3.9956e-01],
          [-4.4809e-02, -8.8945e-01,  1.2245e+00,  ...,  5.6914e-01,
           -3.5150e-01, -1.2861e-01]],

         [[ 1.0888e+00, -2.4086e-01, -3.0399e-01,  ..., -4.7339e-01,
            1.4348e-01, -1.0789e+00],
          [ 2.3896e-01,  7.4554e-01, -3.5522e-01,  ..., -4.9456e-01,
           -2.5746e-01,  7.1832e-02],
          [-2.3815e-01,  4.3895e-01,  4.0449e-02,  ..., -7.9363e-01,
            1.4659e-01,  1.6552e-01],
          ...,
          [ 4.6148e-02,  3.4406e-01, -3.9496e-01,  ...,  2.2921e-01,
           -3.1077e-01, -1.3319e-01],
          [ 5.2171e-01,  1.9338e-01,  6.8755e-01,  ...,  8.2611e-02,
           -3.1425e-01, -6.6911e-01],
          [-1.7000e-01, -3.9015e-01,  7.8861e-01,  ..., -7.5588e-02,
           -1.0198e-01, -5.4558e-01]],

         [[ 6.4236e-01, -3.8260e-01, -6.8859e-01,  ..., -6.6088e-01,
            2.6922e-01, -7.1096e-01],
          [-9.1283e-02,  5.3974e-01,  1.5388e-01,  ..., -4.5927e-01,
            3.3761e-01,  6.4103e-01],
          [-1.2310e-01,  8.6981e-01,  3.3626e-01,  ..., -7.5741e-01,
            3.6776e-01, -2.8885e-01],
          ...,
          [-3.9014e-02,  6.4558e-02, -1.8868e-01,  ...,  2.9938e-01,
           -6.4938e-01, -5.1895e-02],
          [ 5.7260e-01,  1.8774e-01,  8.7859e-01,  ...,  2.5356e-01,
            1.7648e-01, -5.7885e-01],
          [-8.1214e-02, -3.7943e-01,  3.8280e-01,  ...,  1.6320e-02,
           -2.2871e-01, -3.3038e-01]],

         [[ 3.9086e-01, -6.0132e-01, -8.7178e-01,  ..., -4.7112e-01,
            1.7820e-01, -5.3416e-01],
          [ 1.5518e-02,  3.6416e-01, -2.2192e-01,  ..., -2.6702e-01,
           -5.6875e-01,  3.1337e-01],
          [-2.0190e-02,  9.0979e-01,  3.5822e-01,  ..., -8.0510e-01,
            2.5401e-01, -1.5099e-01],
          ...,
          [ 6.0596e-02, -3.7523e-02, -3.3611e-01,  ...,  5.9676e-01,
           -3.7288e-01, -6.7824e-03],
          [ 5.2846e-01,  3.8301e-01,  6.3909e-01,  ...,  2.7918e-01,
            1.7587e-01, -5.7980e-01],
          [ 5.7831e-02, -5.3765e-01,  7.7402e-01,  ...,  2.8620e-01,
           -1.1391e-01, -1.8635e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.6745,  0.3317, -0.7046,  ...,  0.4099, -0.0550, -0.1474],
         [ 0.2569,  0.1014,  0.0328,  ...,  0.0331, -0.2625, -0.7107],
         [ 0.4082,  0.1040, -0.3689,  ...,  0.6492, -0.3059,  0.2755],
         [ 0.4766, -0.1042, -0.2234,  ...,  0.3588, -0.3399, -0.2511]],

        [[ 1.1245, -0.2272, -0.2983,  ...,  0.5691, -0.3515, -0.1286],
         [ 1.0888, -0.2409, -0.3040,  ..., -0.0756, -0.1020, -0.5456],
         [ 0.6424, -0.3826, -0.6886,  ...,  0.0163, -0.2287, -0.3304],
         [ 0.3909, -0.6013, -0.8718,  ...,  0.2862, -0.1139, -0.1864]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.5099, -0.0966,  0.1372,  ...,  0.1250, -0.0286,  0.3199],
         [ 0.3933,  0.0657, -0.0465,  ..., -0.1779,  0.2437,  0.3737],
         [ 0.1275, -0.1645, -0.2260,  ...,  0.1393,  0.1754,  0.3323],
         [ 0.2203, -0.1091, -0.0973,  ..., -0.0225,  0.4884,  0.2995]],

        [[ 0.1880,  0.2439,  0.2397,  ..., -0.0438, -0.1405,  0.0653],
         [ 0.3637,  0.0762,  0.2278,  ..., -0.0806,  0.1478,  0.4102],
         [ 0.4016,  0.0674, -0.0611,  ...,  0.0490,  0.0054,  0.3260],
         [ 0.4439,  0.1235,  0.0497,  ..., -0.0872,  0.1200,  0.2685]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.6348,    -inf,    -inf,    -inf],
          [-3.4106, -0.6626,    -inf,    -inf],
          [ 2.7173, -7.0697,  1.2829,    -inf],
          [-2.9491, -3.8626, -2.9069,  3.3685]],

         [[-1.3066,    -inf,    -inf,    -inf],
          [ 0.6024, -4.4893,    -inf,    -inf],
          [-2.0838,  0.2074, -1.1030,    -inf],
          [ 3.7033,  5.3171,  1.6168, -3.9108]],

         [[ 4.2708,    -inf,    -inf,    -inf],
          [-2.5898,  0.5333,    -inf,    -inf],
          [-3.6266,  0.4645,  4.5326,    -inf],
          [ 1.5359, -1.9205, -0.1247, -1.4187]],

         [[-0.8236,    -inf,    -inf,    -inf],
          [-1.2755, -0.6934,    -inf,    -inf],
          [ 1.1845,  0.3037, -2.5842,    -inf],
          [ 1.9755, -0.3369, -1.9558, -2.1387]],

         [[-2.1264,    -inf,    -inf,    -inf],
          [-4.3885,  0.8072,    -inf,    -inf],
          [-0.9275, -2.2691, -0.9500,    -inf],
          [-0.0886,  0.7449, -2.1170,  2.9751]],

         [[ 1.9208,    -inf,    -inf,    -inf],
          [-1.4500,  0.0305,    -inf,    -inf],
          [-1.9363, -3.3356, -3.1021,    -inf],
          [ 1.0324, -0.4724, -1.4345, -2.8579]],

         [[ 0.6687,    -inf,    -inf,    -inf],
          [ 1.3577, -0.6811,    -inf,    -inf],
          [ 3.5064,  2.0645,  2.7070,    -inf],
          [ 0.7555, -0.1039, -0.8699,  4.4575]],

         [[ 2.6844,    -inf,    -inf,    -inf],
          [ 6.1241, -1.5135,    -inf,    -inf],
          [-2.2222,  3.5342,  1.5964,    -inf],
          [ 4.5227, -3.2622,  4.2720, -0.4728]],

         [[-2.1145,    -inf,    -inf,    -inf],
          [ 1.8168,  0.5691,    -inf,    -inf],
          [ 2.0811,  0.7769, -3.1465,    -inf],
          [ 7.4088, -1.1380,  0.1618,  3.1411]],

         [[ 0.4033,    -inf,    -inf,    -inf],
          [-0.6583, -2.4916,    -inf,    -inf],
          [ 2.2058, -1.0299, -1.6899,    -inf],
          [-1.0660, -0.4202, -0.2934,  0.9275]],

         [[-0.9520,    -inf,    -inf,    -inf],
          [ 1.3079, -1.9923,    -inf,    -inf],
          [ 0.8385, -0.7879, -1.4547,    -inf],
          [ 0.0665,  3.3522,  0.9852, -0.6255]],

         [[-2.4397,    -inf,    -inf,    -inf],
          [-2.8005,  0.7204,    -inf,    -inf],
          [ 2.3828,  0.2828,  2.9819,    -inf],
          [ 1.0716,  0.8630,  2.9363, -3.0034]],

         [[-0.1934,    -inf,    -inf,    -inf],
          [ 2.5496,  1.6178,    -inf,    -inf],
          [-4.3116, -1.3063, -2.9944,    -inf],
          [-2.1655, -0.0154,  1.6177, -1.0811]],

         [[ 3.8588,    -inf,    -inf,    -inf],
          [-1.7861, -5.9923,    -inf,    -inf],
          [ 1.6461, -1.9627,  3.8647,    -inf],
          [ 3.2635, -0.1561,  1.7535, -0.2817]],

         [[-1.8159,    -inf,    -inf,    -inf],
          [ 5.0793,  1.2164,    -inf,    -inf],
          [ 0.5473,  5.4698, -0.0954,    -inf],
          [ 3.1186, -5.3109, -6.6738, -4.7858]],

         [[ 4.8607,    -inf,    -inf,    -inf],
          [-1.2161, -1.9067,    -inf,    -inf],
          [ 1.5071,  5.2789,  0.4837,    -inf],
          [ 3.2875, -0.0434, -5.1419, -1.8912]],

         [[-4.9446,    -inf,    -inf,    -inf],
          [-2.3020, -0.8472,    -inf,    -inf],
          [ 0.6477,  1.8433, -3.2133,    -inf],
          [ 3.8913,  0.6516,  2.1760, -1.6402]],

         [[ 0.8144,    -inf,    -inf,    -inf],
          [ 0.2629, -0.8381,    -inf,    -inf],
          [ 0.4602, -2.3159, -2.7001,    -inf],
          [ 1.0994, -1.4216,  5.4875, -0.5751]],

         [[-0.9183,    -inf,    -inf,    -inf],
          [ 1.4451, -0.2994,    -inf,    -inf],
          [-0.9993, -4.3530,  5.0910,    -inf],
          [ 1.5960, -0.6566,  2.4597,  1.5873]],

         [[-2.3297,    -inf,    -inf,    -inf],
          [-1.0927, -0.9491,    -inf,    -inf],
          [-0.9239,  3.1073, -0.5020,    -inf],
          [ 3.5206, -1.8495,  0.6305,  1.2618]],

         [[ 1.4263,    -inf,    -inf,    -inf],
          [-0.7052,  4.0366,    -inf,    -inf],
          [ 1.2568, -1.8239, -0.6695,    -inf],
          [ 1.0074, -0.6366,  1.3768,  2.7032]],

         [[ 2.0285,    -inf,    -inf,    -inf],
          [-3.6160, -4.2559,    -inf,    -inf],
          [-0.7491,  2.3045, -3.5420,    -inf],
          [-2.4110,  1.6118,  0.8561, -4.1373]],

         [[ 2.8717,    -inf,    -inf,    -inf],
          [ 1.0926,  4.3924,    -inf,    -inf],
          [ 0.2595,  3.0411, -2.1005,    -inf],
          [-0.4063, -1.1944, -0.4196, -1.8400]],

         [[ 2.7345,    -inf,    -inf,    -inf],
          [-1.3772, -0.3782,    -inf,    -inf],
          [-2.6366, -0.9368, -4.0899,    -inf],
          [ 2.4780,  0.9025, -1.7240,  1.5428]],

         [[-0.1524,    -inf,    -inf,    -inf],
          [-7.0907, -4.6884,    -inf,    -inf],
          [ 0.0251, -2.0425,  3.7827,    -inf],
          [-1.0696,  4.7968,  5.6512, -3.4218]]],


        [[[-1.0632,    -inf,    -inf,    -inf],
          [ 0.4089, -0.2514,    -inf,    -inf],
          [ 1.1268, -3.1994, -0.0212,    -inf],
          [-3.1376, -4.0966, -0.9338,  0.6357]],

         [[ 0.4657,    -inf,    -inf,    -inf],
          [ 0.3980,  1.3280,    -inf,    -inf],
          [-3.7202, -1.0068, -4.7252,    -inf],
          [ 2.4825,  4.8807,  3.2207,  2.2519]],

         [[ 3.1775,    -inf,    -inf,    -inf],
          [-4.5526,  1.0494,    -inf,    -inf],
          [-1.5167,  3.6260,  0.6581,    -inf],
          [ 2.2290,  1.2609,  4.3125,  5.4218]],

         [[-0.0857,    -inf,    -inf,    -inf],
          [-0.6473, -1.0624,    -inf,    -inf],
          [-2.3350, -1.7099, -2.7965,    -inf],
          [ 0.3586,  0.7939, -1.2099,  1.1019]],

         [[-1.2402,    -inf,    -inf,    -inf],
          [-3.7099, -0.4791,    -inf,    -inf],
          [-1.7305,  1.3323, -0.5407,    -inf],
          [ 0.5708,  0.2830, -2.3945,  2.1128]],

         [[ 0.9445,    -inf,    -inf,    -inf],
          [ 0.2462, -0.2584,    -inf,    -inf],
          [-1.9687,  2.2464,  1.0802,    -inf],
          [ 3.5208,  2.0349, -0.6589,  2.5284]],

         [[ 1.3877,    -inf,    -inf,    -inf],
          [-1.9461, -1.7120,    -inf,    -inf],
          [ 0.5877, -2.8659, -1.2199,    -inf],
          [ 0.8905,  2.9509, -0.2883,  2.2470]],

         [[ 2.4657,    -inf,    -inf,    -inf],
          [ 2.9944, -2.1803,    -inf,    -inf],
          [ 1.1995,  0.2651, -4.3568,    -inf],
          [ 4.2732, -2.2420, -2.6357, -2.5037]],

         [[ 1.5283,    -inf,    -inf,    -inf],
          [ 1.2838,  3.9763,    -inf,    -inf],
          [ 1.7011, -1.4442, -3.7716,    -inf],
          [ 4.7038,  1.8075,  2.0691,  3.0700]],

         [[ 3.0496,    -inf,    -inf,    -inf],
          [-1.4428,  3.7436,    -inf,    -inf],
          [ 2.5523,  3.0888, -1.0421,    -inf],
          [ 4.3051,  0.1166, -1.5126,  1.8808]],

         [[-3.8284,    -inf,    -inf,    -inf],
          [ 3.9862, -2.9276,    -inf,    -inf],
          [ 0.4681,  1.6307, -0.3503,    -inf],
          [ 0.3214, -2.5841, -1.7677,  2.1854]],

         [[ 0.2819,    -inf,    -inf,    -inf],
          [-2.9191, -3.5070,    -inf,    -inf],
          [-2.7985, -0.9649, -0.5832,    -inf],
          [-0.4699,  2.1552,  2.5755, -0.2286]],

         [[ 2.5264,    -inf,    -inf,    -inf],
          [-0.9116,  2.9967,    -inf,    -inf],
          [-0.1084,  0.7306, -2.0067,    -inf],
          [-0.0712, -1.5656,  1.0229, -2.0957]],

         [[ 1.7544,    -inf,    -inf,    -inf],
          [-1.0083, -2.8757,    -inf,    -inf],
          [-2.5870, -1.2458,  8.5691,    -inf],
          [ 2.2813, -7.2377,  4.9451,  6.0935]],

         [[-2.2196,    -inf,    -inf,    -inf],
          [ 1.3942,  3.1611,    -inf,    -inf],
          [ 0.2684,  0.8989,  3.4100,    -inf],
          [ 0.1939, -3.1684, -1.7240,  0.2468]],

         [[ 2.4802,    -inf,    -inf,    -inf],
          [-4.9607,  1.2991,    -inf,    -inf],
          [ 2.2325,  1.2098,  1.1223,    -inf],
          [ 6.5150,  4.9692, -5.3308, -0.7267]],

         [[-6.7631,    -inf,    -inf,    -inf],
          [-2.5722, -0.2572,    -inf,    -inf],
          [-3.6048,  0.3780,  1.7137,    -inf],
          [-1.4078,  2.8744,  2.6239, -2.9781]],

         [[-1.2399,    -inf,    -inf,    -inf],
          [-1.0446,  1.7780,    -inf,    -inf],
          [ 2.5660, -4.1990, -1.6472,    -inf],
          [ 1.1232,  0.2576,  0.7196,  2.2676]],

         [[-1.5034,    -inf,    -inf,    -inf],
          [ 1.1821,  4.6804,    -inf,    -inf],
          [-0.1113, -1.1372,  2.0581,    -inf],
          [ 3.2901, -2.5743,  1.4458, -0.8430]],

         [[-4.0464,    -inf,    -inf,    -inf],
          [-1.6788,  0.6050,    -inf,    -inf],
          [-1.0906, -0.8547, -2.2835,    -inf],
          [ 0.8155,  0.3277,  0.8207, -1.2566]],

         [[ 0.9462,    -inf,    -inf,    -inf],
          [ 1.2951,  1.3283,    -inf,    -inf],
          [ 5.7154,  0.9889, -1.4388,    -inf],
          [ 1.4630, -2.3719, -3.5331,  2.2879]],

         [[-1.9632,    -inf,    -inf,    -inf],
          [-3.4344, -4.5382,    -inf,    -inf],
          [-1.8720,  6.6104, -2.4503,    -inf],
          [-3.0585, -1.5917, -2.9267, -3.7758]],

         [[-0.6375,    -inf,    -inf,    -inf],
          [ 0.4853,  0.3076,    -inf,    -inf],
          [-0.1142,  2.5040, -1.7967,    -inf],
          [-0.1620,  2.8697,  1.4278, -1.7632]],

         [[ 2.4529,    -inf,    -inf,    -inf],
          [ 1.4676,  0.6198,    -inf,    -inf],
          [-2.7552,  2.2258, -1.7635,    -inf],
          [ 0.0972, -0.5763, -6.9293, -4.3529]],

         [[-2.0571,    -inf,    -inf,    -inf],
          [-4.6738, -2.4437,    -inf,    -inf],
          [ 0.4525,  1.3872,  0.1916,    -inf],
          [ 0.1321, -3.5653,  4.4799,  1.3139]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.6348,    -inf,    -inf,    -inf],
          [-3.4106, -0.6626,    -inf,    -inf],
          [ 2.7173, -7.0697,  1.2829,    -inf],
          [-2.9491, -3.8626, -2.9069,  3.3685]],

         [[-1.3066,    -inf,    -inf,    -inf],
          [ 0.6024, -4.4893,    -inf,    -inf],
          [-2.0838,  0.2074, -1.1030,    -inf],
          [ 3.7033,  5.3171,  1.6168, -3.9108]],

         [[ 4.2708,    -inf,    -inf,    -inf],
          [-2.5898,  0.5333,    -inf,    -inf],
          [-3.6266,  0.4645,  4.5326,    -inf],
          [ 1.5359, -1.9205, -0.1247, -1.4187]],

         [[-0.8236,    -inf,    -inf,    -inf],
          [-1.2755, -0.6934,    -inf,    -inf],
          [ 1.1845,  0.3037, -2.5842,    -inf],
          [ 1.9755, -0.3369, -1.9558, -2.1387]],

         [[-2.1264,    -inf,    -inf,    -inf],
          [-4.3885,  0.8072,    -inf,    -inf],
          [-0.9275, -2.2691, -0.9500,    -inf],
          [-0.0886,  0.7449, -2.1170,  2.9751]],

         [[ 1.9208,    -inf,    -inf,    -inf],
          [-1.4500,  0.0305,    -inf,    -inf],
          [-1.9363, -3.3356, -3.1021,    -inf],
          [ 1.0324, -0.4724, -1.4345, -2.8579]],

         [[ 0.6687,    -inf,    -inf,    -inf],
          [ 1.3577, -0.6811,    -inf,    -inf],
          [ 3.5064,  2.0645,  2.7070,    -inf],
          [ 0.7555, -0.1039, -0.8699,  4.4575]],

         [[ 2.6844,    -inf,    -inf,    -inf],
          [ 6.1241, -1.5135,    -inf,    -inf],
          [-2.2222,  3.5342,  1.5964,    -inf],
          [ 4.5227, -3.2622,  4.2720, -0.4728]],

         [[-2.1145,    -inf,    -inf,    -inf],
          [ 1.8168,  0.5691,    -inf,    -inf],
          [ 2.0811,  0.7769, -3.1465,    -inf],
          [ 7.4088, -1.1380,  0.1618,  3.1411]],

         [[ 0.4033,    -inf,    -inf,    -inf],
          [-0.6583, -2.4916,    -inf,    -inf],
          [ 2.2058, -1.0299, -1.6899,    -inf],
          [-1.0660, -0.4202, -0.2934,  0.9275]],

         [[-0.9520,    -inf,    -inf,    -inf],
          [ 1.3079, -1.9923,    -inf,    -inf],
          [ 0.8385, -0.7879, -1.4547,    -inf],
          [ 0.0665,  3.3522,  0.9852, -0.6255]],

         [[-2.4397,    -inf,    -inf,    -inf],
          [-2.8005,  0.7204,    -inf,    -inf],
          [ 2.3828,  0.2828,  2.9819,    -inf],
          [ 1.0716,  0.8630,  2.9363, -3.0034]],

         [[-0.1934,    -inf,    -inf,    -inf],
          [ 2.5496,  1.6178,    -inf,    -inf],
          [-4.3116, -1.3063, -2.9944,    -inf],
          [-2.1655, -0.0154,  1.6177, -1.0811]],

         [[ 3.8588,    -inf,    -inf,    -inf],
          [-1.7861, -5.9923,    -inf,    -inf],
          [ 1.6461, -1.9627,  3.8647,    -inf],
          [ 3.2635, -0.1561,  1.7535, -0.2817]],

         [[-1.8159,    -inf,    -inf,    -inf],
          [ 5.0793,  1.2164,    -inf,    -inf],
          [ 0.5473,  5.4698, -0.0954,    -inf],
          [ 3.1186, -5.3109, -6.6738, -4.7858]],

         [[ 4.8607,    -inf,    -inf,    -inf],
          [-1.2161, -1.9067,    -inf,    -inf],
          [ 1.5071,  5.2789,  0.4837,    -inf],
          [ 3.2875, -0.0434, -5.1419, -1.8912]],

         [[-4.9446,    -inf,    -inf,    -inf],
          [-2.3020, -0.8472,    -inf,    -inf],
          [ 0.6477,  1.8433, -3.2133,    -inf],
          [ 3.8913,  0.6516,  2.1760, -1.6402]],

         [[ 0.8144,    -inf,    -inf,    -inf],
          [ 0.2629, -0.8381,    -inf,    -inf],
          [ 0.4602, -2.3159, -2.7001,    -inf],
          [ 1.0994, -1.4216,  5.4875, -0.5751]],

         [[-0.9183,    -inf,    -inf,    -inf],
          [ 1.4451, -0.2994,    -inf,    -inf],
          [-0.9993, -4.3530,  5.0910,    -inf],
          [ 1.5960, -0.6566,  2.4597,  1.5873]],

         [[-2.3297,    -inf,    -inf,    -inf],
          [-1.0927, -0.9491,    -inf,    -inf],
          [-0.9239,  3.1073, -0.5020,    -inf],
          [ 3.5206, -1.8495,  0.6305,  1.2618]],

         [[ 1.4263,    -inf,    -inf,    -inf],
          [-0.7052,  4.0366,    -inf,    -inf],
          [ 1.2568, -1.8239, -0.6695,    -inf],
          [ 1.0074, -0.6366,  1.3768,  2.7032]],

         [[ 2.0285,    -inf,    -inf,    -inf],
          [-3.6160, -4.2559,    -inf,    -inf],
          [-0.7491,  2.3045, -3.5420,    -inf],
          [-2.4110,  1.6118,  0.8561, -4.1373]],

         [[ 2.8717,    -inf,    -inf,    -inf],
          [ 1.0926,  4.3924,    -inf,    -inf],
          [ 0.2595,  3.0411, -2.1005,    -inf],
          [-0.4063, -1.1944, -0.4196, -1.8400]],

         [[ 2.7345,    -inf,    -inf,    -inf],
          [-1.3772, -0.3782,    -inf,    -inf],
          [-2.6366, -0.9368, -4.0899,    -inf],
          [ 2.4780,  0.9025, -1.7240,  1.5428]],

         [[-0.1524,    -inf,    -inf,    -inf],
          [-7.0907, -4.6884,    -inf,    -inf],
          [ 0.0251, -2.0425,  3.7827,    -inf],
          [-1.0696,  4.7968,  5.6512, -3.4218]]],


        [[[-1.0632,    -inf,    -inf,    -inf],
          [ 0.4089, -0.2514,    -inf,    -inf],
          [ 1.1268, -3.1994, -0.0212,    -inf],
          [-3.1376, -4.0966, -0.9338,  0.6357]],

         [[ 0.4657,    -inf,    -inf,    -inf],
          [ 0.3980,  1.3280,    -inf,    -inf],
          [-3.7202, -1.0068, -4.7252,    -inf],
          [ 2.4825,  4.8807,  3.2207,  2.2519]],

         [[ 3.1775,    -inf,    -inf,    -inf],
          [-4.5526,  1.0494,    -inf,    -inf],
          [-1.5167,  3.6260,  0.6581,    -inf],
          [ 2.2290,  1.2609,  4.3125,  5.4218]],

         [[-0.0857,    -inf,    -inf,    -inf],
          [-0.6473, -1.0624,    -inf,    -inf],
          [-2.3350, -1.7099, -2.7965,    -inf],
          [ 0.3586,  0.7939, -1.2099,  1.1019]],

         [[-1.2402,    -inf,    -inf,    -inf],
          [-3.7099, -0.4791,    -inf,    -inf],
          [-1.7305,  1.3323, -0.5407,    -inf],
          [ 0.5708,  0.2830, -2.3945,  2.1128]],

         [[ 0.9445,    -inf,    -inf,    -inf],
          [ 0.2462, -0.2584,    -inf,    -inf],
          [-1.9687,  2.2464,  1.0802,    -inf],
          [ 3.5208,  2.0349, -0.6589,  2.5284]],

         [[ 1.3877,    -inf,    -inf,    -inf],
          [-1.9461, -1.7120,    -inf,    -inf],
          [ 0.5877, -2.8659, -1.2199,    -inf],
          [ 0.8905,  2.9509, -0.2883,  2.2470]],

         [[ 2.4657,    -inf,    -inf,    -inf],
          [ 2.9944, -2.1803,    -inf,    -inf],
          [ 1.1995,  0.2651, -4.3568,    -inf],
          [ 4.2732, -2.2420, -2.6357, -2.5037]],

         [[ 1.5283,    -inf,    -inf,    -inf],
          [ 1.2838,  3.9763,    -inf,    -inf],
          [ 1.7011, -1.4442, -3.7716,    -inf],
          [ 4.7038,  1.8075,  2.0691,  3.0700]],

         [[ 3.0496,    -inf,    -inf,    -inf],
          [-1.4428,  3.7436,    -inf,    -inf],
          [ 2.5523,  3.0888, -1.0421,    -inf],
          [ 4.3051,  0.1166, -1.5126,  1.8808]],

         [[-3.8284,    -inf,    -inf,    -inf],
          [ 3.9862, -2.9276,    -inf,    -inf],
          [ 0.4681,  1.6307, -0.3503,    -inf],
          [ 0.3214, -2.5841, -1.7677,  2.1854]],

         [[ 0.2819,    -inf,    -inf,    -inf],
          [-2.9191, -3.5070,    -inf,    -inf],
          [-2.7985, -0.9649, -0.5832,    -inf],
          [-0.4699,  2.1552,  2.5755, -0.2286]],

         [[ 2.5264,    -inf,    -inf,    -inf],
          [-0.9116,  2.9967,    -inf,    -inf],
          [-0.1084,  0.7306, -2.0067,    -inf],
          [-0.0712, -1.5656,  1.0229, -2.0957]],

         [[ 1.7544,    -inf,    -inf,    -inf],
          [-1.0083, -2.8757,    -inf,    -inf],
          [-2.5870, -1.2458,  8.5691,    -inf],
          [ 2.2813, -7.2377,  4.9451,  6.0935]],

         [[-2.2196,    -inf,    -inf,    -inf],
          [ 1.3942,  3.1611,    -inf,    -inf],
          [ 0.2684,  0.8989,  3.4100,    -inf],
          [ 0.1939, -3.1684, -1.7240,  0.2468]],

         [[ 2.4802,    -inf,    -inf,    -inf],
          [-4.9607,  1.2991,    -inf,    -inf],
          [ 2.2325,  1.2098,  1.1223,    -inf],
          [ 6.5150,  4.9692, -5.3308, -0.7267]],

         [[-6.7631,    -inf,    -inf,    -inf],
          [-2.5722, -0.2572,    -inf,    -inf],
          [-3.6048,  0.3780,  1.7137,    -inf],
          [-1.4078,  2.8744,  2.6239, -2.9781]],

         [[-1.2399,    -inf,    -inf,    -inf],
          [-1.0446,  1.7780,    -inf,    -inf],
          [ 2.5660, -4.1990, -1.6472,    -inf],
          [ 1.1232,  0.2576,  0.7196,  2.2676]],

         [[-1.5034,    -inf,    -inf,    -inf],
          [ 1.1821,  4.6804,    -inf,    -inf],
          [-0.1113, -1.1372,  2.0581,    -inf],
          [ 3.2901, -2.5743,  1.4458, -0.8430]],

         [[-4.0464,    -inf,    -inf,    -inf],
          [-1.6788,  0.6050,    -inf,    -inf],
          [-1.0906, -0.8547, -2.2835,    -inf],
          [ 0.8155,  0.3277,  0.8207, -1.2566]],

         [[ 0.9462,    -inf,    -inf,    -inf],
          [ 1.2951,  1.3283,    -inf,    -inf],
          [ 5.7154,  0.9889, -1.4388,    -inf],
          [ 1.4630, -2.3719, -3.5331,  2.2879]],

         [[-1.9632,    -inf,    -inf,    -inf],
          [-3.4344, -4.5382,    -inf,    -inf],
          [-1.8720,  6.6104, -2.4503,    -inf],
          [-3.0585, -1.5917, -2.9267, -3.7758]],

         [[-0.6375,    -inf,    -inf,    -inf],
          [ 0.4853,  0.3076,    -inf,    -inf],
          [-0.1142,  2.5040, -1.7967,    -inf],
          [-0.1620,  2.8697,  1.4278, -1.7632]],

         [[ 2.4529,    -inf,    -inf,    -inf],
          [ 1.4676,  0.6198,    -inf,    -inf],
          [-2.7552,  2.2258, -1.7635,    -inf],
          [ 0.0972, -0.5763, -6.9293, -4.3529]],

         [[-2.0571,    -inf,    -inf,    -inf],
          [-4.6738, -2.4437,    -inf,    -inf],
          [ 0.4525,  1.3872,  0.1916,    -inf],
          [ 0.1321, -3.5653,  4.4799,  1.3139]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-7.1989e-01,  2.3247e-01,  5.4329e-01,  ..., -1.1585e+00,
           -2.9560e-01,  1.4346e-02],
          [-1.0076e+00, -7.0560e-01, -8.5346e-01,  ...,  1.0358e+00,
           -1.1901e+00, -6.2028e-02],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 2.4903e-01, -6.4218e-01, -5.7273e-01,  ...,  9.4333e-01,
           -5.7477e-02,  6.9766e-01],
          [ 9.2507e-01,  2.0409e-02, -7.0274e-01,  ..., -1.1503e+00,
            1.1597e-01, -3.9848e-02],
          [-2.4986e-01, -5.9722e-01, -5.8139e-02,  ..., -4.8041e-01,
           -1.3221e+00, -8.1508e-01]],

         [[-3.5891e-01,  3.6184e-01,  1.3107e-01,  ..., -1.1713e+00,
            2.6169e-01, -2.1266e-01],
          [-4.3254e-01, -5.0434e-01, -6.2069e-01,  ...,  3.1465e-01,
           -1.0104e+00,  1.4707e-01],
          [-4.9270e-01,  3.4965e-02,  2.9962e-01,  ...,  2.4526e-01,
            4.6759e-01, -7.0091e-01],
          ...,
          [-2.7649e-02,  1.0036e-01,  6.1413e-01,  ...,  6.7459e-01,
            7.5536e-02,  6.7439e-01],
          [ 3.9301e-01, -1.3270e-01, -4.8064e-01,  ..., -5.7593e-01,
           -5.8975e-02, -4.4078e-02],
          [-3.2767e-02,  2.9621e-01, -1.9594e-01,  ...,  6.6971e-02,
           -1.0496e+00, -1.9477e-02]],

         [[-5.4611e-01,  1.4127e-01,  1.5145e-01,  ..., -7.9432e-01,
           -2.0168e-01, -2.2786e-01],
          [ 4.5405e-01,  1.1789e-01, -1.3207e-01,  ..., -3.7516e-01,
            1.0055e-01,  5.4606e-01],
          [ 8.7390e-02,  4.4416e-01, -2.8976e-01,  ...,  3.7817e-01,
            6.9118e-01, -3.4248e-01],
          ...,
          [ 5.2236e-02, -4.6349e-02,  3.2322e-01,  ...,  5.1552e-01,
            1.9401e-01,  5.4105e-01],
          [-1.5494e-01, -1.1444e-01, -8.1861e-02,  ...,  1.6176e-01,
           -8.5907e-02,  1.5216e-01],
          [ 2.6585e-01,  3.1244e-01, -1.5304e-01,  ..., -5.0229e-02,
           -6.5234e-01,  3.9493e-01]],

         [[-2.2334e-01,  2.4793e-01, -3.4537e-01,  ..., -4.2272e-01,
           -2.4261e-01, -2.9514e-01],
          [ 8.0007e-02, -1.3806e-01, -3.6160e-01,  ..., -5.3425e-02,
           -3.4462e-01,  4.1353e-01],
          [-2.0141e-01,  2.8756e-01,  1.4524e-02,  ...,  7.2545e-02,
            3.8999e-01, -2.1226e-01],
          ...,
          [ 1.6563e-02, -5.0281e-02, -4.1840e-02,  ...,  6.2691e-01,
            1.2153e-01,  2.4394e-01],
          [-1.7863e-01, -5.0412e-01, -2.8865e-01,  ..., -8.6099e-02,
            9.3815e-02,  1.7394e-01],
          [ 1.3133e-01,  5.6598e-01, -1.3320e-01,  ...,  1.2856e-01,
           -5.3242e-01,  4.7346e-01]]],


        [[[-3.7590e-01, -4.7036e-01,  8.4309e-02,  ..., -6.7446e-01,
           -6.0277e-01, -4.7568e-01],
          [-1.1376e+00, -5.6268e-01, -4.8356e-01,  ...,  1.4691e+00,
           -9.2490e-01,  1.5890e-01],
          [-7.5062e-01, -9.0224e-02,  9.0566e-01,  ...,  7.2049e-02,
            4.3738e-01, -9.2462e-01],
          ...,
          [ 4.0688e-01, -5.5176e-01,  7.8728e-03,  ...,  1.2136e+00,
           -4.3158e-01,  4.1832e-01],
          [ 5.1843e-01,  2.3959e-01, -4.5101e-01,  ..., -1.2233e+00,
           -1.3077e-01, -2.9798e-01],
          [-7.7086e-02, -7.9972e-01, -7.0059e-01,  ...,  4.7189e-01,
           -1.1659e+00, -1.0544e+00]],

         [[ 8.0069e-02,  4.6317e-01,  7.7506e-02,  ..., -2.6826e-02,
           -3.6608e-01,  3.3088e-01],
          [-3.2941e-01, -2.9255e-01, -4.4508e-01,  ...,  4.6833e-01,
           -4.8420e-01,  4.3708e-01],
          [ 1.7586e-01, -1.8615e-01, -4.6229e-02,  ...,  1.3560e-01,
            2.5313e-01,  1.2024e-01],
          ...,
          [ 5.9176e-02, -3.8327e-01,  5.8856e-01,  ...,  6.5765e-01,
           -2.6447e-01,  1.6886e-01],
          [ 2.3547e-01, -3.1401e-02, -2.7470e-01,  ..., -5.3267e-01,
           -4.8359e-01, -3.4598e-01],
          [ 1.1724e-01,  2.7433e-01, -5.0046e-01,  ...,  9.7616e-02,
           -8.8917e-01, -1.2276e-01]],

         [[-1.8484e-03, -2.1812e-01, -4.1880e-02,  ...,  1.0691e-01,
           -3.7677e-01, -2.2289e-02],
          [ 3.8528e-02, -5.1162e-02, -2.9658e-01,  ...,  2.2478e-01,
           -2.1706e-01,  2.3938e-01],
          [-1.7812e-01, -2.1409e-02,  2.1490e-01,  ...,  1.7097e-02,
            1.0379e-01, -2.1940e-01],
          ...,
          [-1.3127e-03, -2.6409e-01,  5.1538e-01,  ...,  4.1824e-01,
           -1.7558e-01,  9.3427e-02],
          [ 3.7784e-02,  1.7112e-01, -1.0094e-01,  ..., -3.5319e-02,
           -3.2251e-01, -1.9032e-01],
          [ 3.3294e-01,  2.5826e-01, -2.7133e-01,  ..., -3.5527e-02,
           -5.3166e-01, -1.8276e-02]],

         [[ 3.4697e-02,  6.7207e-01, -5.1211e-01,  ..., -2.3813e-01,
           -2.4953e-01,  3.6451e-02],
          [-5.5814e-02,  4.2669e-03, -8.5307e-02,  ...,  2.9389e-01,
           -1.1348e-01, -5.7921e-02],
          [-1.5950e-01,  4.6561e-01,  8.6372e-02,  ..., -1.0097e-01,
            4.3010e-01, -1.6111e-01],
          ...,
          [-2.9323e-01, -5.6468e-01,  2.1620e-01,  ...,  2.3701e-01,
           -1.1815e-01, -2.5318e-03],
          [ 6.3223e-02,  6.5597e-02, -2.1025e-01,  ..., -3.6740e-01,
           -3.2282e-01, -1.5108e-01],
          [ 4.3371e-01,  3.8717e-01,  5.7748e-02,  ..., -1.8059e-01,
            5.2061e-02,  9.3973e-02]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.7199,  0.2325,  0.5433,  ..., -0.4804, -1.3221, -0.8151],
         [-0.3589,  0.3618,  0.1311,  ...,  0.0670, -1.0496, -0.0195],
         [-0.5461,  0.1413,  0.1515,  ..., -0.0502, -0.6523,  0.3949],
         [-0.2233,  0.2479, -0.3454,  ...,  0.1286, -0.5324,  0.4735]],

        [[-0.3759, -0.4704,  0.0843,  ...,  0.4719, -1.1659, -1.0544],
         [ 0.0801,  0.4632,  0.0775,  ...,  0.0976, -0.8892, -0.1228],
         [-0.0018, -0.2181, -0.0419,  ..., -0.0355, -0.5317, -0.0183],
         [ 0.0347,  0.6721, -0.5121,  ..., -0.1806,  0.0521,  0.0940]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.1363,  0.0844,  0.3219,  ..., -0.4388, -0.3206,  0.0581],
         [-0.0176,  0.2156,  0.1478,  ..., -0.4170, -0.4290, -0.2095],
         [ 0.1690,  0.0658,  0.2420,  ..., -0.5036, -0.3472, -0.0825],
         [ 0.1774,  0.0370,  0.1424,  ..., -0.2748, -0.2679,  0.0018]],

        [[-0.5693, -0.0137,  0.4301,  ..., -0.4844, -0.2843,  0.1009],
         [-0.3852, -0.2652,  0.4183,  ..., -0.2601, -0.3299, -0.0384],
         [-0.0145, -0.1146,  0.2147,  ..., -0.3551,  0.0402,  0.2547],
         [-0.0497,  0.1142,  0.3233,  ..., -0.2163, -0.0942,  0.1830]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 2.2538e+00,        -inf,        -inf,        -inf],
          [ 8.5031e-01,  1.8456e+00,        -inf,        -inf],
          [ 3.5584e+00, -1.0855e+00,  6.6116e+00,        -inf],
          [ 2.7805e+00,  2.3868e+00,  9.9259e-02,  2.4125e+00]],

         [[ 1.8930e+00,        -inf,        -inf,        -inf],
          [ 4.8751e+00, -2.9288e+00,        -inf,        -inf],
          [-3.1781e+00,  3.8071e-01, -2.0830e+00,        -inf],
          [-1.0347e+00, -1.8656e+00, -1.2378e-01, -3.3386e-01]],

         [[-2.2315e-01,        -inf,        -inf,        -inf],
          [ 1.2529e+00, -4.7698e-01,        -inf,        -inf],
          [ 1.6962e+00, -9.7368e-01,  7.6744e-01,        -inf],
          [-6.2501e-01, -5.2975e-01,  1.0485e+00,  1.4158e+00]],

         [[-4.9849e+00,        -inf,        -inf,        -inf],
          [-1.1269e+00, -2.4495e+00,        -inf,        -inf],
          [-3.0416e+00, -4.2935e+00, -2.3818e+00,        -inf],
          [-1.3374e-01, -2.4701e+00, -1.2232e+00,  6.1717e-01]],

         [[ 4.5116e+00,        -inf,        -inf,        -inf],
          [-6.9326e-01,  3.4159e-01,        -inf,        -inf],
          [ 9.0321e-01, -3.6642e+00, -9.3511e-02,        -inf],
          [ 2.7020e+00, -2.1317e+00,  3.4961e+00, -3.3181e+00]],

         [[-2.5645e+00,        -inf,        -inf,        -inf],
          [ 8.4575e-01, -1.0612e+00,        -inf,        -inf],
          [ 3.7774e+00,  2.2064e+00, -1.0908e+00,        -inf],
          [ 3.2646e-01,  3.1740e-01,  1.0499e+00, -9.2935e+00]],

         [[ 6.9889e-01,        -inf,        -inf,        -inf],
          [ 1.0202e-01,  4.9537e+00,        -inf,        -inf],
          [ 3.8390e+00,  1.0552e+00, -2.9891e+00,        -inf],
          [ 1.3420e+00, -2.4195e+00, -6.2410e-01,  2.9902e-01]],

         [[-1.6121e+00,        -inf,        -inf,        -inf],
          [ 1.5086e+00,  2.6382e+00,        -inf,        -inf],
          [-2.2301e+00,  3.7181e+00, -3.5452e-01,        -inf],
          [-8.2598e-01,  2.4325e+00,  2.2211e+00,  3.0387e+00]],

         [[-1.4733e+00,        -inf,        -inf,        -inf],
          [ 1.5705e+00, -1.8000e+00,        -inf,        -inf],
          [-2.3374e+00, -8.4151e-01,  1.6879e+00,        -inf],
          [ 2.3150e-01, -2.5785e+00,  2.3386e+00,  1.7662e+00]],

         [[ 3.9070e+00,        -inf,        -inf,        -inf],
          [-2.0600e+00,  1.6488e+00,        -inf,        -inf],
          [ 3.1465e+00,  1.0390e+00, -3.9843e+00,        -inf],
          [ 1.6832e+00,  2.3431e+00, -1.9002e+00,  8.2317e-01]],

         [[-4.7752e+00,        -inf,        -inf,        -inf],
          [-4.2126e-01, -2.2634e-01,        -inf,        -inf],
          [ 3.1686e-01, -2.0837e+00, -1.5052e+00,        -inf],
          [-9.0741e-01, -4.7534e+00,  8.0255e-01, -1.5896e-01]],

         [[-4.3912e+00,        -inf,        -inf,        -inf],
          [-6.3547e+00,  1.8532e+00,        -inf,        -inf],
          [-4.6897e+00, -2.4134e-01, -2.2742e+00,        -inf],
          [-2.4381e+00,  1.9601e+00,  9.0581e-01,  1.1214e+00]],

         [[-8.4656e-01,        -inf,        -inf,        -inf],
          [ 9.2554e-01,  1.4059e+00,        -inf,        -inf],
          [-1.4578e-01, -2.1989e+00,  2.8810e+00,        -inf],
          [ 4.1414e+00, -3.2450e+00, -1.9834e+00,  4.4200e+00]],

         [[-7.7165e-01,        -inf,        -inf,        -inf],
          [-3.4277e-01, -3.4823e+00,        -inf,        -inf],
          [ 1.4431e+00,  3.3655e+00,  1.2973e+00,        -inf],
          [-1.9476e+00, -4.1020e+00, -9.3566e-01, -5.8682e-01]],

         [[ 2.3003e+00,        -inf,        -inf,        -inf],
          [ 1.5411e+00,  5.7336e-01,        -inf,        -inf],
          [ 1.7579e+00,  1.3117e+00, -3.5987e+00,        -inf],
          [-1.4633e+00,  1.1663e+00,  7.9556e-01,  8.0339e+00]],

         [[ 5.4232e+00,        -inf,        -inf,        -inf],
          [ 2.8503e+00,  1.5527e+00,        -inf,        -inf],
          [-4.3617e+00,  3.6084e+00, -9.8881e-01,        -inf],
          [-2.7800e+00, -1.9627e+00,  1.6986e+00,  1.9350e+00]],

         [[-4.0190e+00,        -inf,        -inf,        -inf],
          [ 1.6600e+00, -5.9747e+00,        -inf,        -inf],
          [ 9.7017e-01, -6.7034e+00, -2.4486e+00,        -inf],
          [-5.3590e-01,  2.0668e+00, -1.1710e+00, -2.4966e+00]],

         [[-2.6095e+00,        -inf,        -inf,        -inf],
          [ 8.6247e-01,  6.3727e+00,        -inf,        -inf],
          [-4.1360e+00,  2.6726e+00,  1.7079e+00,        -inf],
          [-3.1857e-01,  1.4728e+00,  3.8340e-01, -1.7254e+00]],

         [[-1.7797e+00,        -inf,        -inf,        -inf],
          [-5.6052e+00, -1.0340e+00,        -inf,        -inf],
          [ 2.0826e+00, -4.5950e+00, -2.5832e+00,        -inf],
          [ 1.6789e+00, -2.0496e+00, -7.0754e-01, -3.0742e+00]],

         [[ 6.1580e+00,        -inf,        -inf,        -inf],
          [ 1.8792e+00, -2.6400e+00,        -inf,        -inf],
          [-1.2540e+00,  7.7475e-01, -1.1519e+00,        -inf],
          [ 2.2494e+00,  1.7707e-03,  6.7982e+00,  1.8325e+00]],

         [[-1.6573e+00,        -inf,        -inf,        -inf],
          [ 7.7941e-01, -2.2411e+00,        -inf,        -inf],
          [-1.7477e+00, -1.7458e+00,  8.4680e+00,        -inf],
          [-1.5231e+00,  9.4817e-01,  4.5466e+00,  6.5975e+00]],

         [[ 5.8120e-01,        -inf,        -inf,        -inf],
          [-3.1702e+00, -1.0784e+00,        -inf,        -inf],
          [-1.9976e+00, -1.3824e+00, -1.4525e+00,        -inf],
          [ 4.7188e+00, -2.6583e+00,  1.8694e+00, -1.7302e-01]],

         [[ 2.3431e-01,        -inf,        -inf,        -inf],
          [-9.9616e-01, -2.2340e+00,        -inf,        -inf],
          [-7.5426e-01,  1.2631e+00, -3.2454e+00,        -inf],
          [-4.9135e+00, -3.6454e+00,  6.0977e-01, -2.2493e+00]],

         [[ 2.5581e+00,        -inf,        -inf,        -inf],
          [ 5.7073e+00, -4.0310e+00,        -inf,        -inf],
          [ 7.3747e-01,  2.3686e+00, -2.4120e+00,        -inf],
          [-8.4494e+00,  5.5602e-01,  5.7955e-02, -4.3004e-01]],

         [[-1.8929e+00,        -inf,        -inf,        -inf],
          [-3.3313e+00,  6.0584e-01,        -inf,        -inf],
          [-1.7995e-01,  5.0189e+00, -3.2713e+00,        -inf],
          [ 2.4719e-01, -2.2659e+00, -2.8509e-01, -1.4910e+00]]],


        [[[ 3.2440e+00,        -inf,        -inf,        -inf],
          [ 3.0683e+00,  4.3489e+00,        -inf,        -inf],
          [-3.8621e-01,  6.9858e+00,  7.8640e-02,        -inf],
          [-8.9614e-01,  1.0777e+00, -1.6522e+00,  4.2278e+00]],

         [[ 3.5289e-01,        -inf,        -inf,        -inf],
          [ 1.9831e+00, -8.0503e-01,        -inf,        -inf],
          [ 1.9843e+00, -1.5828e-01, -1.3210e+00,        -inf],
          [-4.6016e+00,  2.1101e-01, -1.2642e+00, -1.6843e+00]],

         [[ 4.8792e-01,        -inf,        -inf,        -inf],
          [ 7.5824e-01,  1.8459e+00,        -inf,        -inf],
          [ 3.5006e+00, -3.5438e+00,  7.3645e-03,        -inf],
          [-7.4918e-01,  1.7393e+00,  6.8715e-01,  4.5930e+00]],

         [[-3.4186e-01,        -inf,        -inf,        -inf],
          [-9.4940e-01,  4.0933e+00,        -inf,        -inf],
          [-4.9481e+00,  2.8730e+00, -9.4600e-02,        -inf],
          [-3.0102e+00,  5.7036e-01, -2.3415e-01,  1.0384e+00]],

         [[ 2.0747e+00,        -inf,        -inf,        -inf],
          [-1.6655e+00, -2.4535e+00,        -inf,        -inf],
          [ 8.7198e-01, -3.8757e+00, -4.8714e-02,        -inf],
          [-2.0465e+00,  2.8007e+00, -4.3459e+00, -5.5462e-01]],

         [[-1.2143e+00,        -inf,        -inf,        -inf],
          [ 2.5131e+00, -3.7197e-01,        -inf,        -inf],
          [ 2.7617e+00,  2.4572e+00,  5.0429e+00,        -inf],
          [-1.6805e+00,  9.5863e-01,  6.4922e-01,  3.8072e+00]],

         [[ 2.1042e+00,        -inf,        -inf,        -inf],
          [ 3.5992e+00,  2.5289e+00,        -inf,        -inf],
          [ 7.7130e+00,  6.2397e+00, -1.3471e+00,        -inf],
          [ 3.9842e-01, -3.2972e+00, -5.7035e+00, -7.4746e-02]],

         [[-9.4689e-01,        -inf,        -inf,        -inf],
          [-1.1470e+00, -6.0227e+00,        -inf,        -inf],
          [-7.8371e-01,  1.4401e+00,  3.0916e+00,        -inf],
          [-3.7823e+00, -3.0377e+00, -1.0110e-01,  2.2176e-02]],

         [[-2.3807e+00,        -inf,        -inf,        -inf],
          [ 1.1892e+00, -2.5615e-01,        -inf,        -inf],
          [ 4.9985e-01, -3.0391e+00,  2.4833e-01,        -inf],
          [ 5.9043e-01,  1.0808e-01, -8.7477e-01,  1.3454e+00]],

         [[ 9.2258e-01,        -inf,        -inf,        -inf],
          [-5.9728e+00,  1.3114e+00,        -inf,        -inf],
          [ 3.8949e+00, -3.2028e-01, -2.2825e-01,        -inf],
          [-7.2408e-02,  5.0986e+00,  1.0997e+00,  5.8430e+00]],

         [[-2.9868e+00,        -inf,        -inf,        -inf],
          [-2.2804e+00,  5.7932e-03,        -inf,        -inf],
          [ 1.8393e+00,  3.6622e-01, -8.5819e-01,        -inf],
          [-3.5424e+00, -1.6674e+00, -6.4246e-01, -3.9543e+00]],

         [[-1.3779e-03,        -inf,        -inf,        -inf],
          [-4.1181e+00,  8.7944e-01,        -inf,        -inf],
          [-3.3133e+00, -2.2892e+00, -3.3263e+00,        -inf],
          [-2.3974e+00,  1.6184e-01,  4.0870e+00,  5.9191e-01]],

         [[-4.9634e-01,        -inf,        -inf,        -inf],
          [ 1.5559e+00,  2.9540e+00,        -inf,        -inf],
          [-1.4828e+00, -6.6966e-01,  2.6214e+00,        -inf],
          [ 4.2182e+00, -3.4693e+00, -7.2992e-01,  3.2344e+00]],

         [[-3.5470e+00,        -inf,        -inf,        -inf],
          [ 1.5035e+00, -2.2884e+00,        -inf,        -inf],
          [-6.7603e-01, -9.6638e-02,  1.8452e+00,        -inf],
          [ 3.6858e-01,  2.4661e-01, -3.3990e+00, -2.1387e+00]],

         [[ 2.4569e+00,        -inf,        -inf,        -inf],
          [-9.3760e-02, -2.2179e+00,        -inf,        -inf],
          [ 3.7309e+00, -2.3672e+00, -1.0551e+00,        -inf],
          [ 2.8455e+00,  3.2040e+00,  1.2477e+00,  6.4111e+00]],

         [[ 5.6136e+00,        -inf,        -inf,        -inf],
          [ 1.5793e+00, -1.7492e-01,        -inf,        -inf],
          [-6.0491e+00,  8.0976e-01,  2.0872e+00,        -inf],
          [-2.6108e+00, -2.2268e+00,  2.3305e+00, -5.3645e-01]],

         [[-4.9344e+00,        -inf,        -inf,        -inf],
          [ 1.4008e+00,  1.1688e+00,        -inf,        -inf],
          [ 1.1255e+00,  3.4699e+00,  2.4247e+00,        -inf],
          [-2.3704e+00,  9.5523e-01, -2.1101e+00, -4.5880e-01]],

         [[-5.4724e-01,        -inf,        -inf,        -inf],
          [ 9.8615e-01,  3.6941e+00,        -inf,        -inf],
          [-5.8841e+00, -2.4843e+00,  3.8674e+00,        -inf],
          [-8.3466e-01, -1.5085e+00, -2.3446e+00, -2.9860e+00]],

         [[ 1.5498e-01,        -inf,        -inf,        -inf],
          [-1.7287e+00, -2.3749e+00,        -inf,        -inf],
          [ 4.6665e+00, -6.4202e-01, -5.1787e+00,        -inf],
          [ 8.0497e-01, -1.0031e+00, -1.3628e+00, -3.4153e+00]],

         [[ 5.2593e+00,        -inf,        -inf,        -inf],
          [-1.1959e+00,  8.5265e-01,        -inf,        -inf],
          [ 3.2163e-02, -8.3834e-02, -1.6914e+00,        -inf],
          [-1.6398e+00, -3.4021e+00, -5.3533e-01, -3.9500e+00]],

         [[-9.9067e-01,        -inf,        -inf,        -inf],
          [ 7.4251e-01,  7.6887e-01,        -inf,        -inf],
          [-4.8785e+00, -2.3856e+00, -2.1608e+00,        -inf],
          [-3.4573e-01, -4.5867e+00,  4.5039e+00,  4.8167e+00]],

         [[-3.6422e-01,        -inf,        -inf,        -inf],
          [-6.0497e-01,  3.5313e+00,        -inf,        -inf],
          [-4.7775e+00, -4.3372e+00, -4.0653e+00,        -inf],
          [ 2.3306e+00,  2.2591e+00,  1.6725e+00,  5.2210e-01]],

         [[-1.1777e+00,        -inf,        -inf,        -inf],
          [ 4.5569e-01, -2.7326e+00,        -inf,        -inf],
          [ 4.8611e-01, -1.9774e+00, -4.0051e+00,        -inf],
          [-7.0189e+00, -1.1099e+00,  2.0746e+00,  3.6899e+00]],

         [[ 1.5640e+00,        -inf,        -inf,        -inf],
          [ 4.9616e+00,  3.8526e+00,        -inf,        -inf],
          [ 4.5548e+00,  1.5816e+00,  6.3077e-01,        -inf],
          [-3.7984e+00,  1.7232e+00, -5.2235e-02,  2.7756e+00]],

         [[ 4.8371e-01,        -inf,        -inf,        -inf],
          [-3.5719e+00,  2.1292e+00,        -inf,        -inf],
          [ 3.6763e+00, -3.1519e+00,  1.1757e+00,        -inf],
          [ 3.3321e+00,  6.7183e-01,  8.7715e-01,  2.9022e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 2.2538e+00,        -inf,        -inf,        -inf],
          [ 8.5031e-01,  1.8456e+00,        -inf,        -inf],
          [ 3.5584e+00, -1.0855e+00,  6.6116e+00,        -inf],
          [ 2.7805e+00,  2.3868e+00,  9.9259e-02,  2.4125e+00]],

         [[ 1.8930e+00,        -inf,        -inf,        -inf],
          [ 4.8751e+00, -2.9288e+00,        -inf,        -inf],
          [-3.1781e+00,  3.8071e-01, -2.0830e+00,        -inf],
          [-1.0347e+00, -1.8656e+00, -1.2378e-01, -3.3386e-01]],

         [[-2.2315e-01,        -inf,        -inf,        -inf],
          [ 1.2529e+00, -4.7698e-01,        -inf,        -inf],
          [ 1.6962e+00, -9.7368e-01,  7.6744e-01,        -inf],
          [-6.2501e-01, -5.2975e-01,  1.0485e+00,  1.4158e+00]],

         [[-4.9849e+00,        -inf,        -inf,        -inf],
          [-1.1269e+00, -2.4495e+00,        -inf,        -inf],
          [-3.0416e+00, -4.2935e+00, -2.3818e+00,        -inf],
          [-1.3374e-01, -2.4701e+00, -1.2232e+00,  6.1717e-01]],

         [[ 4.5116e+00,        -inf,        -inf,        -inf],
          [-6.9326e-01,  3.4159e-01,        -inf,        -inf],
          [ 9.0321e-01, -3.6642e+00, -9.3511e-02,        -inf],
          [ 2.7020e+00, -2.1317e+00,  3.4961e+00, -3.3181e+00]],

         [[-2.5645e+00,        -inf,        -inf,        -inf],
          [ 8.4575e-01, -1.0612e+00,        -inf,        -inf],
          [ 3.7774e+00,  2.2064e+00, -1.0908e+00,        -inf],
          [ 3.2646e-01,  3.1740e-01,  1.0499e+00, -9.2935e+00]],

         [[ 6.9889e-01,        -inf,        -inf,        -inf],
          [ 1.0202e-01,  4.9537e+00,        -inf,        -inf],
          [ 3.8390e+00,  1.0552e+00, -2.9891e+00,        -inf],
          [ 1.3420e+00, -2.4195e+00, -6.2410e-01,  2.9902e-01]],

         [[-1.6121e+00,        -inf,        -inf,        -inf],
          [ 1.5086e+00,  2.6382e+00,        -inf,        -inf],
          [-2.2301e+00,  3.7181e+00, -3.5452e-01,        -inf],
          [-8.2598e-01,  2.4325e+00,  2.2211e+00,  3.0387e+00]],

         [[-1.4733e+00,        -inf,        -inf,        -inf],
          [ 1.5705e+00, -1.8000e+00,        -inf,        -inf],
          [-2.3374e+00, -8.4151e-01,  1.6879e+00,        -inf],
          [ 2.3150e-01, -2.5785e+00,  2.3386e+00,  1.7662e+00]],

         [[ 3.9070e+00,        -inf,        -inf,        -inf],
          [-2.0600e+00,  1.6488e+00,        -inf,        -inf],
          [ 3.1465e+00,  1.0390e+00, -3.9843e+00,        -inf],
          [ 1.6832e+00,  2.3431e+00, -1.9002e+00,  8.2317e-01]],

         [[-4.7752e+00,        -inf,        -inf,        -inf],
          [-4.2126e-01, -2.2634e-01,        -inf,        -inf],
          [ 3.1686e-01, -2.0837e+00, -1.5052e+00,        -inf],
          [-9.0741e-01, -4.7534e+00,  8.0255e-01, -1.5896e-01]],

         [[-4.3912e+00,        -inf,        -inf,        -inf],
          [-6.3547e+00,  1.8532e+00,        -inf,        -inf],
          [-4.6897e+00, -2.4134e-01, -2.2742e+00,        -inf],
          [-2.4381e+00,  1.9601e+00,  9.0581e-01,  1.1214e+00]],

         [[-8.4656e-01,        -inf,        -inf,        -inf],
          [ 9.2554e-01,  1.4059e+00,        -inf,        -inf],
          [-1.4578e-01, -2.1989e+00,  2.8810e+00,        -inf],
          [ 4.1414e+00, -3.2450e+00, -1.9834e+00,  4.4200e+00]],

         [[-7.7165e-01,        -inf,        -inf,        -inf],
          [-3.4277e-01, -3.4823e+00,        -inf,        -inf],
          [ 1.4431e+00,  3.3655e+00,  1.2973e+00,        -inf],
          [-1.9476e+00, -4.1020e+00, -9.3566e-01, -5.8682e-01]],

         [[ 2.3003e+00,        -inf,        -inf,        -inf],
          [ 1.5411e+00,  5.7336e-01,        -inf,        -inf],
          [ 1.7579e+00,  1.3117e+00, -3.5987e+00,        -inf],
          [-1.4633e+00,  1.1663e+00,  7.9556e-01,  8.0339e+00]],

         [[ 5.4232e+00,        -inf,        -inf,        -inf],
          [ 2.8503e+00,  1.5527e+00,        -inf,        -inf],
          [-4.3617e+00,  3.6084e+00, -9.8881e-01,        -inf],
          [-2.7800e+00, -1.9627e+00,  1.6986e+00,  1.9350e+00]],

         [[-4.0190e+00,        -inf,        -inf,        -inf],
          [ 1.6600e+00, -5.9747e+00,        -inf,        -inf],
          [ 9.7017e-01, -6.7034e+00, -2.4486e+00,        -inf],
          [-5.3590e-01,  2.0668e+00, -1.1710e+00, -2.4966e+00]],

         [[-2.6095e+00,        -inf,        -inf,        -inf],
          [ 8.6247e-01,  6.3727e+00,        -inf,        -inf],
          [-4.1360e+00,  2.6726e+00,  1.7079e+00,        -inf],
          [-3.1857e-01,  1.4728e+00,  3.8340e-01, -1.7254e+00]],

         [[-1.7797e+00,        -inf,        -inf,        -inf],
          [-5.6052e+00, -1.0340e+00,        -inf,        -inf],
          [ 2.0826e+00, -4.5950e+00, -2.5832e+00,        -inf],
          [ 1.6789e+00, -2.0496e+00, -7.0754e-01, -3.0742e+00]],

         [[ 6.1580e+00,        -inf,        -inf,        -inf],
          [ 1.8792e+00, -2.6400e+00,        -inf,        -inf],
          [-1.2540e+00,  7.7475e-01, -1.1519e+00,        -inf],
          [ 2.2494e+00,  1.7707e-03,  6.7982e+00,  1.8325e+00]],

         [[-1.6573e+00,        -inf,        -inf,        -inf],
          [ 7.7941e-01, -2.2411e+00,        -inf,        -inf],
          [-1.7477e+00, -1.7458e+00,  8.4680e+00,        -inf],
          [-1.5231e+00,  9.4817e-01,  4.5466e+00,  6.5975e+00]],

         [[ 5.8120e-01,        -inf,        -inf,        -inf],
          [-3.1702e+00, -1.0784e+00,        -inf,        -inf],
          [-1.9976e+00, -1.3824e+00, -1.4525e+00,        -inf],
          [ 4.7188e+00, -2.6583e+00,  1.8694e+00, -1.7302e-01]],

         [[ 2.3431e-01,        -inf,        -inf,        -inf],
          [-9.9616e-01, -2.2340e+00,        -inf,        -inf],
          [-7.5426e-01,  1.2631e+00, -3.2454e+00,        -inf],
          [-4.9135e+00, -3.6454e+00,  6.0977e-01, -2.2493e+00]],

         [[ 2.5581e+00,        -inf,        -inf,        -inf],
          [ 5.7073e+00, -4.0310e+00,        -inf,        -inf],
          [ 7.3747e-01,  2.3686e+00, -2.4120e+00,        -inf],
          [-8.4494e+00,  5.5602e-01,  5.7955e-02, -4.3004e-01]],

         [[-1.8929e+00,        -inf,        -inf,        -inf],
          [-3.3313e+00,  6.0584e-01,        -inf,        -inf],
          [-1.7995e-01,  5.0189e+00, -3.2713e+00,        -inf],
          [ 2.4719e-01, -2.2659e+00, -2.8509e-01, -1.4910e+00]]],


        [[[ 3.2440e+00,        -inf,        -inf,        -inf],
          [ 3.0683e+00,  4.3489e+00,        -inf,        -inf],
          [-3.8621e-01,  6.9858e+00,  7.8640e-02,        -inf],
          [-8.9614e-01,  1.0777e+00, -1.6522e+00,  4.2278e+00]],

         [[ 3.5289e-01,        -inf,        -inf,        -inf],
          [ 1.9831e+00, -8.0503e-01,        -inf,        -inf],
          [ 1.9843e+00, -1.5828e-01, -1.3210e+00,        -inf],
          [-4.6016e+00,  2.1101e-01, -1.2642e+00, -1.6843e+00]],

         [[ 4.8792e-01,        -inf,        -inf,        -inf],
          [ 7.5824e-01,  1.8459e+00,        -inf,        -inf],
          [ 3.5006e+00, -3.5438e+00,  7.3645e-03,        -inf],
          [-7.4918e-01,  1.7393e+00,  6.8715e-01,  4.5930e+00]],

         [[-3.4186e-01,        -inf,        -inf,        -inf],
          [-9.4940e-01,  4.0933e+00,        -inf,        -inf],
          [-4.9481e+00,  2.8730e+00, -9.4600e-02,        -inf],
          [-3.0102e+00,  5.7036e-01, -2.3415e-01,  1.0384e+00]],

         [[ 2.0747e+00,        -inf,        -inf,        -inf],
          [-1.6655e+00, -2.4535e+00,        -inf,        -inf],
          [ 8.7198e-01, -3.8757e+00, -4.8714e-02,        -inf],
          [-2.0465e+00,  2.8007e+00, -4.3459e+00, -5.5462e-01]],

         [[-1.2143e+00,        -inf,        -inf,        -inf],
          [ 2.5131e+00, -3.7197e-01,        -inf,        -inf],
          [ 2.7617e+00,  2.4572e+00,  5.0429e+00,        -inf],
          [-1.6805e+00,  9.5863e-01,  6.4922e-01,  3.8072e+00]],

         [[ 2.1042e+00,        -inf,        -inf,        -inf],
          [ 3.5992e+00,  2.5289e+00,        -inf,        -inf],
          [ 7.7130e+00,  6.2397e+00, -1.3471e+00,        -inf],
          [ 3.9842e-01, -3.2972e+00, -5.7035e+00, -7.4746e-02]],

         [[-9.4689e-01,        -inf,        -inf,        -inf],
          [-1.1470e+00, -6.0227e+00,        -inf,        -inf],
          [-7.8371e-01,  1.4401e+00,  3.0916e+00,        -inf],
          [-3.7823e+00, -3.0377e+00, -1.0110e-01,  2.2176e-02]],

         [[-2.3807e+00,        -inf,        -inf,        -inf],
          [ 1.1892e+00, -2.5615e-01,        -inf,        -inf],
          [ 4.9985e-01, -3.0391e+00,  2.4833e-01,        -inf],
          [ 5.9043e-01,  1.0808e-01, -8.7477e-01,  1.3454e+00]],

         [[ 9.2258e-01,        -inf,        -inf,        -inf],
          [-5.9728e+00,  1.3114e+00,        -inf,        -inf],
          [ 3.8949e+00, -3.2028e-01, -2.2825e-01,        -inf],
          [-7.2408e-02,  5.0986e+00,  1.0997e+00,  5.8430e+00]],

         [[-2.9868e+00,        -inf,        -inf,        -inf],
          [-2.2804e+00,  5.7932e-03,        -inf,        -inf],
          [ 1.8393e+00,  3.6622e-01, -8.5819e-01,        -inf],
          [-3.5424e+00, -1.6674e+00, -6.4246e-01, -3.9543e+00]],

         [[-1.3779e-03,        -inf,        -inf,        -inf],
          [-4.1181e+00,  8.7944e-01,        -inf,        -inf],
          [-3.3133e+00, -2.2892e+00, -3.3263e+00,        -inf],
          [-2.3974e+00,  1.6184e-01,  4.0870e+00,  5.9191e-01]],

         [[-4.9634e-01,        -inf,        -inf,        -inf],
          [ 1.5559e+00,  2.9540e+00,        -inf,        -inf],
          [-1.4828e+00, -6.6966e-01,  2.6214e+00,        -inf],
          [ 4.2182e+00, -3.4693e+00, -7.2992e-01,  3.2344e+00]],

         [[-3.5470e+00,        -inf,        -inf,        -inf],
          [ 1.5035e+00, -2.2884e+00,        -inf,        -inf],
          [-6.7603e-01, -9.6638e-02,  1.8452e+00,        -inf],
          [ 3.6858e-01,  2.4661e-01, -3.3990e+00, -2.1387e+00]],

         [[ 2.4569e+00,        -inf,        -inf,        -inf],
          [-9.3760e-02, -2.2179e+00,        -inf,        -inf],
          [ 3.7309e+00, -2.3672e+00, -1.0551e+00,        -inf],
          [ 2.8455e+00,  3.2040e+00,  1.2477e+00,  6.4111e+00]],

         [[ 5.6136e+00,        -inf,        -inf,        -inf],
          [ 1.5793e+00, -1.7492e-01,        -inf,        -inf],
          [-6.0491e+00,  8.0976e-01,  2.0872e+00,        -inf],
          [-2.6108e+00, -2.2268e+00,  2.3305e+00, -5.3645e-01]],

         [[-4.9344e+00,        -inf,        -inf,        -inf],
          [ 1.4008e+00,  1.1688e+00,        -inf,        -inf],
          [ 1.1255e+00,  3.4699e+00,  2.4247e+00,        -inf],
          [-2.3704e+00,  9.5523e-01, -2.1101e+00, -4.5880e-01]],

         [[-5.4724e-01,        -inf,        -inf,        -inf],
          [ 9.8615e-01,  3.6941e+00,        -inf,        -inf],
          [-5.8841e+00, -2.4843e+00,  3.8674e+00,        -inf],
          [-8.3466e-01, -1.5085e+00, -2.3446e+00, -2.9860e+00]],

         [[ 1.5498e-01,        -inf,        -inf,        -inf],
          [-1.7287e+00, -2.3749e+00,        -inf,        -inf],
          [ 4.6665e+00, -6.4202e-01, -5.1787e+00,        -inf],
          [ 8.0497e-01, -1.0031e+00, -1.3628e+00, -3.4153e+00]],

         [[ 5.2593e+00,        -inf,        -inf,        -inf],
          [-1.1959e+00,  8.5265e-01,        -inf,        -inf],
          [ 3.2163e-02, -8.3834e-02, -1.6914e+00,        -inf],
          [-1.6398e+00, -3.4021e+00, -5.3533e-01, -3.9500e+00]],

         [[-9.9067e-01,        -inf,        -inf,        -inf],
          [ 7.4251e-01,  7.6887e-01,        -inf,        -inf],
          [-4.8785e+00, -2.3856e+00, -2.1608e+00,        -inf],
          [-3.4573e-01, -4.5867e+00,  4.5039e+00,  4.8167e+00]],

         [[-3.6422e-01,        -inf,        -inf,        -inf],
          [-6.0497e-01,  3.5313e+00,        -inf,        -inf],
          [-4.7775e+00, -4.3372e+00, -4.0653e+00,        -inf],
          [ 2.3306e+00,  2.2591e+00,  1.6725e+00,  5.2210e-01]],

         [[-1.1777e+00,        -inf,        -inf,        -inf],
          [ 4.5569e-01, -2.7326e+00,        -inf,        -inf],
          [ 4.8611e-01, -1.9774e+00, -4.0051e+00,        -inf],
          [-7.0189e+00, -1.1099e+00,  2.0746e+00,  3.6899e+00]],

         [[ 1.5640e+00,        -inf,        -inf,        -inf],
          [ 4.9616e+00,  3.8526e+00,        -inf,        -inf],
          [ 4.5548e+00,  1.5816e+00,  6.3077e-01,        -inf],
          [-3.7984e+00,  1.7232e+00, -5.2235e-02,  2.7756e+00]],

         [[ 4.8371e-01,        -inf,        -inf,        -inf],
          [-3.5719e+00,  2.1292e+00,        -inf,        -inf],
          [ 3.6763e+00, -3.1519e+00,  1.1757e+00,        -inf],
          [ 3.3321e+00,  6.7183e-01,  8.7715e-01,  2.9022e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.3606, -0.4076, -0.8635,  ..., -0.1979, -0.3239,  0.4315],
          [-1.0094, -0.5769, -0.0155,  ..., -0.4885, -0.5776,  0.5398],
          [ 0.2122, -0.5944, -0.8485,  ..., -0.2617,  0.2549, -0.4891],
          ...,
          [-0.1012, -0.8258, -0.1439,  ..., -0.3250, -1.2989, -0.9245],
          [-0.8519,  0.1715, -1.5677,  ...,  0.1504, -1.2286, -0.8654],
          [ 0.6169,  0.8406,  0.5408,  ..., -0.1890, -1.9131,  0.0201]],

         [[-0.1691, -0.1911, -0.4049,  ..., -0.0928, -0.1519,  0.2023],
          [-0.7180, -0.0192,  0.0069,  ..., -0.8621, -0.4549,  0.5122],
          [ 0.7079, -0.5270, -0.6337,  ..., -0.1310, -0.0796, -0.2259],
          ...,
          [-0.1327, -0.8778, -0.1395,  ..., -0.4425, -0.3999, -0.8939],
          [-0.5075, -0.3653, -1.2391,  ...,  0.0545, -0.9962, -0.5214],
          [-0.3006,  0.5195,  0.3487,  ..., -0.2310, -1.1952, -0.2957]],

         [[-0.1643, -0.2886,  0.1921,  ..., -0.0533,  0.2565,  0.2893],
          [-0.0740,  0.7374,  0.1534,  ..., -0.7399, -0.3558,  0.5175],
          [ 0.3636, -0.1218, -0.1008,  ...,  0.0086, -0.1360,  0.0277],
          ...,
          [-0.2479, -0.7485,  0.0247,  ..., -0.4745, -0.3043, -0.7692],
          [-0.4987,  0.1615, -0.4676,  ...,  0.1789, -0.4728, -0.2275],
          [-0.4320,  0.3504,  0.2466,  ..., -0.1548, -0.9688, -0.2482]],

         [[-0.2186, -0.1174, -0.1214,  ..., -0.1894,  0.4627,  0.0113],
          [-0.1441,  0.4975,  0.0370,  ..., -0.6171, -0.0878,  0.1252],
          [ 0.3191, -0.2034, -0.3976,  ..., -0.4449, -0.1776,  0.0402],
          ...,
          [-0.4074, -0.3959,  0.4216,  ..., -0.3356, -0.3890, -0.3847],
          [-0.3788, -0.4148,  0.1906,  ...,  0.1878, -0.2352,  0.3118],
          [-0.2023,  0.0060, -0.0286,  ..., -0.1074, -0.4319, -0.1370]]],


        [[[-0.2807, -0.5943, -0.5192,  ..., -0.0596,  0.2740,  0.9012],
          [-0.9962, -1.0392,  0.1697,  ..., -0.1756, -0.3944,  0.6675],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [-0.4697, -0.8935, -0.4430,  ..., -0.1261, -1.1284, -0.6305],
          [-0.9706,  0.1591, -2.0061,  ...,  0.6641, -1.3246, -0.5771],
          [ 0.8948,  0.0616,  0.6003,  ..., -0.1938, -1.6742,  0.1126]],

         [[ 0.1265, -0.0482, -0.5989,  ..., -0.0819,  0.4382,  0.3635],
          [ 0.2504,  0.1526, -0.2121,  ..., -0.5161, -0.3627,  0.2801],
          [ 0.7054, -0.5363, -0.6911,  ...,  0.0365,  0.0885, -0.1444],
          ...,
          [-0.2811, -0.5346, -0.2651,  ..., -0.0754, -0.6751, -0.3772],
          [-0.5731, -0.3563, -1.3140,  ...,  0.4226, -0.9071, -0.0898],
          [ 0.1040, -0.7892, -0.0512,  ..., -0.1927, -1.4109,  0.8862]],

         [[ 0.4334,  0.0665, -0.4399,  ..., -0.2688,  0.5764,  0.1766],
          [-0.1174, -0.3648,  0.0846,  ..., -0.4980, -0.5094,  0.6757],
          [-0.2314,  0.0252, -0.2335,  ..., -0.3204, -0.3742,  0.3050],
          ...,
          [-0.4899, -0.3999, -0.3233,  ..., -0.1484, -0.5396, -0.2195],
          [-0.4565, -0.2150, -1.0270,  ...,  0.3320, -0.7035, -0.1099],
          [ 0.2704, -0.6115,  0.1266,  ..., -0.1822, -0.9564,  0.2220]],

         [[ 0.3372, -0.0625, -0.2705,  ..., -0.0546,  0.3614,  0.5249],
          [ 0.4942,  0.2133,  0.0892,  ..., -0.5688, -0.4682,  0.6669],
          [ 0.0667, -0.1607, -0.1988,  ..., -0.1704, -0.1599,  0.3527],
          ...,
          [-0.7371, -0.0608,  0.1526,  ..., -0.1221, -0.4183,  0.4111],
          [-0.6305, -0.5912, -0.3461,  ...,  0.2814, -0.5751, -0.2542],
          [ 0.3985,  0.0230, -0.0363,  ...,  0.1502, -1.0243,  0.5408]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.3606, -0.4076, -0.8635,  ..., -0.1890, -1.9131,  0.0201],
         [-0.1691, -0.1911, -0.4049,  ..., -0.2310, -1.1952, -0.2957],
         [-0.1643, -0.2886,  0.1921,  ..., -0.1548, -0.9688, -0.2482],
         [-0.2186, -0.1174, -0.1214,  ..., -0.1074, -0.4319, -0.1370]],

        [[-0.2807, -0.5943, -0.5192,  ..., -0.1938, -1.6742,  0.1126],
         [ 0.1265, -0.0482, -0.5989,  ..., -0.1927, -1.4109,  0.8862],
         [ 0.4334,  0.0665, -0.4399,  ..., -0.1822, -0.9564,  0.2220],
         [ 0.3372, -0.0625, -0.2705,  ...,  0.1502, -1.0243,  0.5408]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1901, -0.6195, -0.3571,  ..., -0.3222,  0.4267, -0.2161],
         [ 0.1095, -0.3362,  0.0438,  ...,  0.1578,  0.2099, -0.0532],
         [ 0.3283, -0.3141, -0.2406,  ...,  0.1462, -0.0290,  0.1675],
         [ 0.4120, -0.2862, -0.2067,  ..., -0.0826,  0.0867,  0.0386]],

        [[ 0.3529, -0.4255, -0.3593,  ..., -0.2845,  0.3332,  0.0313],
         [-0.0467,  0.0335, -0.4786,  ...,  0.4945,  0.3271, -0.0422],
         [ 0.0101, -0.0101, -0.8067,  ..., -0.0998,  0.2026,  0.1760],
         [ 0.0485,  0.2043, -0.3081,  ..., -0.1081,  0.1641,  0.1844]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.5139e+00,        -inf,        -inf,        -inf],
          [ 1.2806e+00,  1.8170e+00,        -inf,        -inf],
          [ 2.0922e+00,  2.6868e+00,  2.9201e+00,        -inf],
          [ 5.5697e-01,  1.9108e+00,  8.0673e-01,  1.0766e-01]],

         [[ 2.4612e+00,        -inf,        -inf,        -inf],
          [-4.5551e+00, -2.6844e+00,        -inf,        -inf],
          [ 1.5375e+00,  1.2453e+00,  1.1114e+00,        -inf],
          [ 2.3383e+00, -1.9799e+00, -3.1178e+00, -2.1762e+00]],

         [[-9.8370e-01,        -inf,        -inf,        -inf],
          [-3.5848e+00, -1.1749e+00,        -inf,        -inf],
          [ 1.1150e+00, -7.6364e-01,  1.6882e-01,        -inf],
          [ 2.2645e+00,  1.9328e+00, -1.9446e+00,  7.9320e+00]],

         [[-3.7934e+00,        -inf,        -inf,        -inf],
          [-2.2072e+00,  2.1055e-01,        -inf,        -inf],
          [-1.0225e+00, -1.4513e+00, -2.0211e+00,        -inf],
          [-2.7689e+00,  2.7121e+00, -1.0033e+00, -1.9236e+00]],

         [[ 5.5787e-01,        -inf,        -inf,        -inf],
          [ 3.5626e-01,  8.3006e-01,        -inf,        -inf],
          [ 5.7275e+00,  3.8437e+00, -1.9861e+00,        -inf],
          [ 1.1653e+00, -4.1882e+00,  2.2372e+00, -1.0941e+00]],

         [[-3.9495e+00,        -inf,        -inf,        -inf],
          [-5.2310e+00, -2.2908e+00,        -inf,        -inf],
          [-2.5211e+00,  4.4554e+00, -1.4991e+00,        -inf],
          [ 3.7902e+00, -3.5718e+00, -2.7780e+00, -6.2912e+00]],

         [[ 7.0892e+00,        -inf,        -inf,        -inf],
          [ 9.2321e-01, -2.0390e+00,        -inf,        -inf],
          [-4.2653e-02,  9.3551e-02,  2.1174e+00,        -inf],
          [ 2.8726e+00, -1.0889e+00,  5.4691e-01, -4.8677e-01]],

         [[-1.8067e+00,        -inf,        -inf,        -inf],
          [-6.9281e+00, -3.9543e+00,        -inf,        -inf],
          [-3.8092e+00,  1.2194e-02,  2.2130e-01,        -inf],
          [-3.1608e-01, -1.3990e+00, -3.3139e+00, -2.0481e+00]],

         [[ 1.6398e+00,        -inf,        -inf,        -inf],
          [ 9.5269e-01,  7.2825e+00,        -inf,        -inf],
          [ 2.2474e+00,  1.1601e+00, -2.5183e+00,        -inf],
          [ 1.7057e+00,  3.8154e+00, -1.3485e-01, -1.4387e+00]],

         [[-1.9822e+00,        -inf,        -inf,        -inf],
          [-5.7760e+00, -2.1375e+00,        -inf,        -inf],
          [ 1.2724e+00, -3.7477e+00, -1.7010e-01,        -inf],
          [-4.4325e+00,  2.1727e+00,  1.7811e+00,  3.1343e-01]],

         [[-1.2336e+00,        -inf,        -inf,        -inf],
          [ 4.9397e-01,  7.0255e-01,        -inf,        -inf],
          [ 4.6461e+00, -7.8166e-01, -3.3083e+00,        -inf],
          [-3.5195e+00, -1.9265e+00,  6.6342e-01, -1.0333e+00]],

         [[-2.8829e+00,        -inf,        -inf,        -inf],
          [-5.8407e-01, -4.2372e+00,        -inf,        -inf],
          [-2.0157e+00, -1.8480e+00,  2.2930e+00,        -inf],
          [ 2.5768e-01,  4.6468e+00,  1.7726e+00,  8.4707e-01]],

         [[-2.5769e+00,        -inf,        -inf,        -inf],
          [ 1.0307e+00,  7.6788e-01,        -inf,        -inf],
          [-2.4796e+00, -3.8509e+00,  5.2154e+00,        -inf],
          [-2.9607e+00,  3.0754e-01, -1.4083e+00, -5.2053e+00]],

         [[ 5.4522e+00,        -inf,        -inf,        -inf],
          [ 6.5177e-01,  3.3755e+00,        -inf,        -inf],
          [-7.9491e+00, -1.3368e-01,  1.0809e-01,        -inf],
          [-2.8642e-03, -7.3182e-01, -2.4467e+00,  1.1141e+00]],

         [[ 2.8786e+00,        -inf,        -inf,        -inf],
          [-2.8231e+00, -4.8003e+00,        -inf,        -inf],
          [-6.6610e+00, -4.6621e+00, -1.9465e+00,        -inf],
          [-3.0406e+00,  1.2088e+00, -1.6388e+00, -1.0930e+00]],

         [[ 1.7794e+00,        -inf,        -inf,        -inf],
          [ 1.4191e+00, -3.7322e+00,        -inf,        -inf],
          [-1.2343e+00,  1.5418e+00, -5.1502e+00,        -inf],
          [ 2.6303e+00,  1.5299e+00, -4.2041e+00,  5.1420e+00]],

         [[ 5.2722e-01,        -inf,        -inf,        -inf],
          [ 1.9110e+00,  1.7161e+00,        -inf,        -inf],
          [-3.3484e+00,  4.8135e+00,  1.3020e+00,        -inf],
          [-1.2528e+00,  7.8089e-01, -1.9032e+00, -1.1092e+00]],

         [[ 2.2446e+00,        -inf,        -inf,        -inf],
          [-9.5180e-01, -7.0161e-01,        -inf,        -inf],
          [-2.1831e-01,  1.3477e+00,  1.3816e+00,        -inf],
          [ 1.6906e+00,  2.8395e+00,  2.8345e+00,  3.6821e+00]],

         [[-1.0530e+00,        -inf,        -inf,        -inf],
          [ 4.1510e+00,  2.4359e+00,        -inf,        -inf],
          [ 3.7646e+00,  8.4408e-01,  1.6268e+00,        -inf],
          [-6.0313e-01,  4.8984e-01,  1.2665e+00, -1.4014e+00]],

         [[ 1.0217e-02,        -inf,        -inf,        -inf],
          [ 3.2927e+00, -1.0522e+00,        -inf,        -inf],
          [ 2.5230e-01,  3.8107e+00, -1.2347e-01,        -inf],
          [-9.3138e-01,  3.1359e-01,  3.1654e-01, -1.2693e+00]],

         [[ 1.4602e+00,        -inf,        -inf,        -inf],
          [ 2.3432e+00,  4.9209e+00,        -inf,        -inf],
          [ 4.9830e+00,  2.0054e+00,  1.1096e+00,        -inf],
          [-7.8102e-01, -8.3283e-01, -1.7173e+00,  5.1749e+00]],

         [[-6.1633e-01,        -inf,        -inf,        -inf],
          [-2.3952e+00, -8.4358e-01,        -inf,        -inf],
          [-5.3468e+00,  4.2850e+00,  4.7481e+00,        -inf],
          [-1.5957e+00, -1.5297e+00,  2.3364e+00,  2.8531e+00]],

         [[ 5.8437e-01,        -inf,        -inf,        -inf],
          [-1.7443e+00,  7.4997e-01,        -inf,        -inf],
          [ 3.4167e+00,  2.4060e+00,  3.1317e+00,        -inf],
          [-9.1906e-01,  3.9058e+00,  7.6278e-01,  1.4804e+00]],

         [[-1.4002e+00,        -inf,        -inf,        -inf],
          [-3.6021e+00, -1.1493e+00,        -inf,        -inf],
          [-9.0233e-01, -4.6775e+00,  6.7591e+00,        -inf],
          [ 2.1857e+00,  2.9746e+00,  9.8923e-01,  3.4681e-01]],

         [[-3.9825e-01,        -inf,        -inf,        -inf],
          [-2.6602e+00, -4.7455e+00,        -inf,        -inf],
          [ 1.0567e+00, -6.4589e+00,  5.9182e+00,        -inf],
          [-1.0533e+00, -4.4917e+00, -1.4457e+00, -8.3038e-02]]],


        [[[-1.6350e+00,        -inf,        -inf,        -inf],
          [ 3.0517e+00,  8.2475e-01,        -inf,        -inf],
          [ 6.7577e-01, -3.4114e-01,  5.7366e-01,        -inf],
          [ 1.8254e+00,  9.9478e-01, -1.4766e+00, -1.9084e+00]],

         [[ 1.6498e+00,        -inf,        -inf,        -inf],
          [ 8.6624e-01, -3.5112e+00,        -inf,        -inf],
          [-2.0588e+00,  1.9087e+00,  1.6190e+00,        -inf],
          [ 1.3121e+00, -4.3997e+00, -4.0783e+00, -2.3609e+00]],

         [[-5.6289e-01,        -inf,        -inf,        -inf],
          [-8.6722e-01,  1.6225e+00,        -inf,        -inf],
          [ 4.3710e+00,  2.7998e+00, -2.8452e+00,        -inf],
          [ 4.3467e+00, -1.0097e+00, -7.8348e-01,  6.8935e-01]],

         [[-3.7899e+00,        -inf,        -inf,        -inf],
          [-1.4157e+00, -2.0800e+00,        -inf,        -inf],
          [ 9.2319e-01, -1.9101e+00, -1.6748e-01,        -inf],
          [-1.2509e+00,  3.6099e+00,  4.4278e+00, -3.8277e+00]],

         [[-4.1700e+00,        -inf,        -inf,        -inf],
          [-9.7689e-01,  1.3699e+00,        -inf,        -inf],
          [ 3.0791e+00, -1.1628e+00, -1.0356e+00,        -inf],
          [-1.0682e+00, -2.1026e+00,  1.9277e+00, -1.7029e+00]],

         [[-2.4405e+00,        -inf,        -inf,        -inf],
          [-6.3045e+00,  3.0338e-01,        -inf,        -inf],
          [-3.3319e+00,  1.1836e+00, -3.6456e-01,        -inf],
          [ 2.4852e+00,  1.7108e+00,  7.0539e-01,  4.2780e+00]],

         [[ 6.4804e+00,        -inf,        -inf,        -inf],
          [ 1.8594e+00, -2.7009e+00,        -inf,        -inf],
          [-3.5483e+00, -8.2099e-02, -4.4627e+00,        -inf],
          [-3.6715e-01, -1.5858e+00,  1.3280e+00,  1.3696e+00]],

         [[ 4.2559e-01,        -inf,        -inf,        -inf],
          [-2.1604e+00,  2.0655e+00,        -inf,        -inf],
          [-6.0774e+00,  2.5771e+00, -1.9766e+00,        -inf],
          [-5.1883e+00, -1.1541e+00, -4.7463e+00,  1.2388e+00]],

         [[ 3.2597e-02,        -inf,        -inf,        -inf],
          [ 1.0546e+00,  3.7479e-01,        -inf,        -inf],
          [ 5.6351e-02,  6.2804e+00, -1.2718e+00,        -inf],
          [-9.6141e-01,  2.0948e+00, -2.3706e-01, -2.6586e-01]],

         [[-2.2255e-01,        -inf,        -inf,        -inf],
          [-7.1776e-01, -3.6968e+00,        -inf,        -inf],
          [ 3.0825e+00,  1.8375e+00, -1.4696e+00,        -inf],
          [-1.3222e-02,  1.2109e+00, -1.2248e+00, -6.2758e+00]],

         [[-3.2393e+00,        -inf,        -inf,        -inf],
          [ 1.7221e+00,  5.4654e+00,        -inf,        -inf],
          [ 1.1534e+00,  1.0065e-01, -2.0976e+00,        -inf],
          [ 1.4141e+00,  5.0201e+00, -1.0944e+00, -8.5104e-01]],

         [[-2.3828e+00,        -inf,        -inf,        -inf],
          [ 1.8322e+00, -1.4375e+00,        -inf,        -inf],
          [ 3.0802e+00, -2.3115e-01, -1.2896e+00,        -inf],
          [ 2.1704e+00,  1.5323e+00, -5.8149e-01, -3.0071e+00]],

         [[-1.9370e+00,        -inf,        -inf,        -inf],
          [ 1.8360e+00, -1.5817e+00,        -inf,        -inf],
          [-6.1665e-01, -4.9618e+00, -2.1759e+00,        -inf],
          [-4.3750e+00, -2.4661e+00, -8.9572e-01, -2.1859e+00]],

         [[ 6.4315e-01,        -inf,        -inf,        -inf],
          [-1.5673e+00,  1.9059e+00,        -inf,        -inf],
          [-4.0206e+00, -7.1980e-02,  3.1369e+00,        -inf],
          [ 3.0046e+00, -9.6439e-01,  3.6129e+00,  1.0879e-01]],

         [[ 3.4541e+00,        -inf,        -inf,        -inf],
          [-3.4227e-01, -1.1057e+00,        -inf,        -inf],
          [-5.3577e+00, -4.4629e+00,  1.9320e+00,        -inf],
          [ 1.9352e+00,  2.6384e+00,  1.7206e+00,  3.7647e+00]],

         [[ 1.5954e+00,        -inf,        -inf,        -inf],
          [ 3.1088e+00, -2.0778e+00,        -inf,        -inf],
          [ 3.3780e-01, -2.7014e+00, -6.8967e-01,        -inf],
          [ 3.0758e+00,  5.9860e+00,  7.1896e+00, -8.9383e-01]],

         [[-2.1660e+00,        -inf,        -inf,        -inf],
          [-7.2732e-01,  8.7284e-01,        -inf,        -inf],
          [ 1.0933e+00,  3.6734e+00,  5.2979e+00,        -inf],
          [-4.9157e-01,  2.9658e-01,  9.1507e-01,  8.3446e-01]],

         [[-8.6043e-01,        -inf,        -inf,        -inf],
          [ 3.1907e-01,  3.2407e-01,        -inf,        -inf],
          [ 3.0299e+00,  1.8697e+00, -5.3656e-01,        -inf],
          [ 6.1839e+00,  7.1377e-02, -1.1871e+00, -1.8722e+00]],

         [[ 1.9187e-01,        -inf,        -inf,        -inf],
          [ 2.5090e+00, -4.9030e+00,        -inf,        -inf],
          [ 2.5872e+00, -2.8957e+00, -7.3552e-01,        -inf],
          [-3.2310e+00,  2.2829e+00,  5.7012e-01, -5.0555e+00]],

         [[ 1.3454e+00,        -inf,        -inf,        -inf],
          [ 3.7509e-01,  4.6565e+00,        -inf,        -inf],
          [ 1.2604e+00, -1.7207e+00,  1.1527e+00,        -inf],
          [-2.2226e-01,  2.9871e-01,  1.1246e+00,  4.9946e+00]],

         [[ 3.6690e+00,        -inf,        -inf,        -inf],
          [-2.9203e+00,  2.6805e+00,        -inf,        -inf],
          [ 1.4158e+00,  6.0573e+00,  9.8115e-01,        -inf],
          [-1.6417e+00, -3.0302e+00, -7.6965e-01, -4.0082e-01]],

         [[-5.5052e-01,        -inf,        -inf,        -inf],
          [-3.6637e+00, -2.6952e+00,        -inf,        -inf],
          [-3.9566e-01,  2.4702e+00,  2.3113e-01,        -inf],
          [-5.5824e-02, -1.7698e+00, -1.9845e+00,  1.1813e+00]],

         [[ 2.9262e-01,        -inf,        -inf,        -inf],
          [-3.5784e+00, -5.4598e-01,        -inf,        -inf],
          [ 3.5645e-01,  2.3407e+00, -1.5052e+00,        -inf],
          [-2.9487e+00,  5.9660e-01, -6.0184e+00, -3.8954e+00]],

         [[-1.0252e+00,        -inf,        -inf,        -inf],
          [-8.2935e-01, -2.8851e-01,        -inf,        -inf],
          [-1.8279e+00, -6.0264e-01,  9.8186e-01,        -inf],
          [-1.9398e-01, -1.5511e-01,  1.6805e+00,  2.5040e+00]],

         [[-1.5744e+00,        -inf,        -inf,        -inf],
          [-1.1563e+00, -5.9414e+00,        -inf,        -inf],
          [ 2.3119e+00,  2.8561e+00, -1.2820e+00,        -inf],
          [ 2.7386e+00,  2.7654e+00,  1.2641e+00,  6.0502e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.5139e+00,        -inf,        -inf,        -inf],
          [ 1.2806e+00,  1.8170e+00,        -inf,        -inf],
          [ 2.0922e+00,  2.6868e+00,  2.9201e+00,        -inf],
          [ 5.5697e-01,  1.9108e+00,  8.0673e-01,  1.0766e-01]],

         [[ 2.4612e+00,        -inf,        -inf,        -inf],
          [-4.5551e+00, -2.6844e+00,        -inf,        -inf],
          [ 1.5375e+00,  1.2453e+00,  1.1114e+00,        -inf],
          [ 2.3383e+00, -1.9799e+00, -3.1178e+00, -2.1762e+00]],

         [[-9.8370e-01,        -inf,        -inf,        -inf],
          [-3.5848e+00, -1.1749e+00,        -inf,        -inf],
          [ 1.1150e+00, -7.6364e-01,  1.6882e-01,        -inf],
          [ 2.2645e+00,  1.9328e+00, -1.9446e+00,  7.9320e+00]],

         [[-3.7934e+00,        -inf,        -inf,        -inf],
          [-2.2072e+00,  2.1055e-01,        -inf,        -inf],
          [-1.0225e+00, -1.4513e+00, -2.0211e+00,        -inf],
          [-2.7689e+00,  2.7121e+00, -1.0033e+00, -1.9236e+00]],

         [[ 5.5787e-01,        -inf,        -inf,        -inf],
          [ 3.5626e-01,  8.3006e-01,        -inf,        -inf],
          [ 5.7275e+00,  3.8437e+00, -1.9861e+00,        -inf],
          [ 1.1653e+00, -4.1882e+00,  2.2372e+00, -1.0941e+00]],

         [[-3.9495e+00,        -inf,        -inf,        -inf],
          [-5.2310e+00, -2.2908e+00,        -inf,        -inf],
          [-2.5211e+00,  4.4554e+00, -1.4991e+00,        -inf],
          [ 3.7902e+00, -3.5718e+00, -2.7780e+00, -6.2912e+00]],

         [[ 7.0892e+00,        -inf,        -inf,        -inf],
          [ 9.2321e-01, -2.0390e+00,        -inf,        -inf],
          [-4.2653e-02,  9.3551e-02,  2.1174e+00,        -inf],
          [ 2.8726e+00, -1.0889e+00,  5.4691e-01, -4.8677e-01]],

         [[-1.8067e+00,        -inf,        -inf,        -inf],
          [-6.9281e+00, -3.9543e+00,        -inf,        -inf],
          [-3.8092e+00,  1.2194e-02,  2.2130e-01,        -inf],
          [-3.1608e-01, -1.3990e+00, -3.3139e+00, -2.0481e+00]],

         [[ 1.6398e+00,        -inf,        -inf,        -inf],
          [ 9.5269e-01,  7.2825e+00,        -inf,        -inf],
          [ 2.2474e+00,  1.1601e+00, -2.5183e+00,        -inf],
          [ 1.7057e+00,  3.8154e+00, -1.3485e-01, -1.4387e+00]],

         [[-1.9822e+00,        -inf,        -inf,        -inf],
          [-5.7760e+00, -2.1375e+00,        -inf,        -inf],
          [ 1.2724e+00, -3.7477e+00, -1.7010e-01,        -inf],
          [-4.4325e+00,  2.1727e+00,  1.7811e+00,  3.1343e-01]],

         [[-1.2336e+00,        -inf,        -inf,        -inf],
          [ 4.9397e-01,  7.0255e-01,        -inf,        -inf],
          [ 4.6461e+00, -7.8166e-01, -3.3083e+00,        -inf],
          [-3.5195e+00, -1.9265e+00,  6.6342e-01, -1.0333e+00]],

         [[-2.8829e+00,        -inf,        -inf,        -inf],
          [-5.8407e-01, -4.2372e+00,        -inf,        -inf],
          [-2.0157e+00, -1.8480e+00,  2.2930e+00,        -inf],
          [ 2.5768e-01,  4.6468e+00,  1.7726e+00,  8.4707e-01]],

         [[-2.5769e+00,        -inf,        -inf,        -inf],
          [ 1.0307e+00,  7.6788e-01,        -inf,        -inf],
          [-2.4796e+00, -3.8509e+00,  5.2154e+00,        -inf],
          [-2.9607e+00,  3.0754e-01, -1.4083e+00, -5.2053e+00]],

         [[ 5.4522e+00,        -inf,        -inf,        -inf],
          [ 6.5177e-01,  3.3755e+00,        -inf,        -inf],
          [-7.9491e+00, -1.3368e-01,  1.0809e-01,        -inf],
          [-2.8642e-03, -7.3182e-01, -2.4467e+00,  1.1141e+00]],

         [[ 2.8786e+00,        -inf,        -inf,        -inf],
          [-2.8231e+00, -4.8003e+00,        -inf,        -inf],
          [-6.6610e+00, -4.6621e+00, -1.9465e+00,        -inf],
          [-3.0406e+00,  1.2088e+00, -1.6388e+00, -1.0930e+00]],

         [[ 1.7794e+00,        -inf,        -inf,        -inf],
          [ 1.4191e+00, -3.7322e+00,        -inf,        -inf],
          [-1.2343e+00,  1.5418e+00, -5.1502e+00,        -inf],
          [ 2.6303e+00,  1.5299e+00, -4.2041e+00,  5.1420e+00]],

         [[ 5.2722e-01,        -inf,        -inf,        -inf],
          [ 1.9110e+00,  1.7161e+00,        -inf,        -inf],
          [-3.3484e+00,  4.8135e+00,  1.3020e+00,        -inf],
          [-1.2528e+00,  7.8089e-01, -1.9032e+00, -1.1092e+00]],

         [[ 2.2446e+00,        -inf,        -inf,        -inf],
          [-9.5180e-01, -7.0161e-01,        -inf,        -inf],
          [-2.1831e-01,  1.3477e+00,  1.3816e+00,        -inf],
          [ 1.6906e+00,  2.8395e+00,  2.8345e+00,  3.6821e+00]],

         [[-1.0530e+00,        -inf,        -inf,        -inf],
          [ 4.1510e+00,  2.4359e+00,        -inf,        -inf],
          [ 3.7646e+00,  8.4408e-01,  1.6268e+00,        -inf],
          [-6.0313e-01,  4.8984e-01,  1.2665e+00, -1.4014e+00]],

         [[ 1.0217e-02,        -inf,        -inf,        -inf],
          [ 3.2927e+00, -1.0522e+00,        -inf,        -inf],
          [ 2.5230e-01,  3.8107e+00, -1.2347e-01,        -inf],
          [-9.3138e-01,  3.1359e-01,  3.1654e-01, -1.2693e+00]],

         [[ 1.4602e+00,        -inf,        -inf,        -inf],
          [ 2.3432e+00,  4.9209e+00,        -inf,        -inf],
          [ 4.9830e+00,  2.0054e+00,  1.1096e+00,        -inf],
          [-7.8102e-01, -8.3283e-01, -1.7173e+00,  5.1749e+00]],

         [[-6.1633e-01,        -inf,        -inf,        -inf],
          [-2.3952e+00, -8.4358e-01,        -inf,        -inf],
          [-5.3468e+00,  4.2850e+00,  4.7481e+00,        -inf],
          [-1.5957e+00, -1.5297e+00,  2.3364e+00,  2.8531e+00]],

         [[ 5.8437e-01,        -inf,        -inf,        -inf],
          [-1.7443e+00,  7.4997e-01,        -inf,        -inf],
          [ 3.4167e+00,  2.4060e+00,  3.1317e+00,        -inf],
          [-9.1906e-01,  3.9058e+00,  7.6278e-01,  1.4804e+00]],

         [[-1.4002e+00,        -inf,        -inf,        -inf],
          [-3.6021e+00, -1.1493e+00,        -inf,        -inf],
          [-9.0233e-01, -4.6775e+00,  6.7591e+00,        -inf],
          [ 2.1857e+00,  2.9746e+00,  9.8923e-01,  3.4681e-01]],

         [[-3.9825e-01,        -inf,        -inf,        -inf],
          [-2.6602e+00, -4.7455e+00,        -inf,        -inf],
          [ 1.0567e+00, -6.4589e+00,  5.9182e+00,        -inf],
          [-1.0533e+00, -4.4917e+00, -1.4457e+00, -8.3038e-02]]],


        [[[-1.6350e+00,        -inf,        -inf,        -inf],
          [ 3.0517e+00,  8.2475e-01,        -inf,        -inf],
          [ 6.7577e-01, -3.4114e-01,  5.7366e-01,        -inf],
          [ 1.8254e+00,  9.9478e-01, -1.4766e+00, -1.9084e+00]],

         [[ 1.6498e+00,        -inf,        -inf,        -inf],
          [ 8.6624e-01, -3.5112e+00,        -inf,        -inf],
          [-2.0588e+00,  1.9087e+00,  1.6190e+00,        -inf],
          [ 1.3121e+00, -4.3997e+00, -4.0783e+00, -2.3609e+00]],

         [[-5.6289e-01,        -inf,        -inf,        -inf],
          [-8.6722e-01,  1.6225e+00,        -inf,        -inf],
          [ 4.3710e+00,  2.7998e+00, -2.8452e+00,        -inf],
          [ 4.3467e+00, -1.0097e+00, -7.8348e-01,  6.8935e-01]],

         [[-3.7899e+00,        -inf,        -inf,        -inf],
          [-1.4157e+00, -2.0800e+00,        -inf,        -inf],
          [ 9.2319e-01, -1.9101e+00, -1.6748e-01,        -inf],
          [-1.2509e+00,  3.6099e+00,  4.4278e+00, -3.8277e+00]],

         [[-4.1700e+00,        -inf,        -inf,        -inf],
          [-9.7689e-01,  1.3699e+00,        -inf,        -inf],
          [ 3.0791e+00, -1.1628e+00, -1.0356e+00,        -inf],
          [-1.0682e+00, -2.1026e+00,  1.9277e+00, -1.7029e+00]],

         [[-2.4405e+00,        -inf,        -inf,        -inf],
          [-6.3045e+00,  3.0338e-01,        -inf,        -inf],
          [-3.3319e+00,  1.1836e+00, -3.6456e-01,        -inf],
          [ 2.4852e+00,  1.7108e+00,  7.0539e-01,  4.2780e+00]],

         [[ 6.4804e+00,        -inf,        -inf,        -inf],
          [ 1.8594e+00, -2.7009e+00,        -inf,        -inf],
          [-3.5483e+00, -8.2099e-02, -4.4627e+00,        -inf],
          [-3.6715e-01, -1.5858e+00,  1.3280e+00,  1.3696e+00]],

         [[ 4.2559e-01,        -inf,        -inf,        -inf],
          [-2.1604e+00,  2.0655e+00,        -inf,        -inf],
          [-6.0774e+00,  2.5771e+00, -1.9766e+00,        -inf],
          [-5.1883e+00, -1.1541e+00, -4.7463e+00,  1.2388e+00]],

         [[ 3.2597e-02,        -inf,        -inf,        -inf],
          [ 1.0546e+00,  3.7479e-01,        -inf,        -inf],
          [ 5.6351e-02,  6.2804e+00, -1.2718e+00,        -inf],
          [-9.6141e-01,  2.0948e+00, -2.3706e-01, -2.6586e-01]],

         [[-2.2255e-01,        -inf,        -inf,        -inf],
          [-7.1776e-01, -3.6968e+00,        -inf,        -inf],
          [ 3.0825e+00,  1.8375e+00, -1.4696e+00,        -inf],
          [-1.3222e-02,  1.2109e+00, -1.2248e+00, -6.2758e+00]],

         [[-3.2393e+00,        -inf,        -inf,        -inf],
          [ 1.7221e+00,  5.4654e+00,        -inf,        -inf],
          [ 1.1534e+00,  1.0065e-01, -2.0976e+00,        -inf],
          [ 1.4141e+00,  5.0201e+00, -1.0944e+00, -8.5104e-01]],

         [[-2.3828e+00,        -inf,        -inf,        -inf],
          [ 1.8322e+00, -1.4375e+00,        -inf,        -inf],
          [ 3.0802e+00, -2.3115e-01, -1.2896e+00,        -inf],
          [ 2.1704e+00,  1.5323e+00, -5.8149e-01, -3.0071e+00]],

         [[-1.9370e+00,        -inf,        -inf,        -inf],
          [ 1.8360e+00, -1.5817e+00,        -inf,        -inf],
          [-6.1665e-01, -4.9618e+00, -2.1759e+00,        -inf],
          [-4.3750e+00, -2.4661e+00, -8.9572e-01, -2.1859e+00]],

         [[ 6.4315e-01,        -inf,        -inf,        -inf],
          [-1.5673e+00,  1.9059e+00,        -inf,        -inf],
          [-4.0206e+00, -7.1980e-02,  3.1369e+00,        -inf],
          [ 3.0046e+00, -9.6439e-01,  3.6129e+00,  1.0879e-01]],

         [[ 3.4541e+00,        -inf,        -inf,        -inf],
          [-3.4227e-01, -1.1057e+00,        -inf,        -inf],
          [-5.3577e+00, -4.4629e+00,  1.9320e+00,        -inf],
          [ 1.9352e+00,  2.6384e+00,  1.7206e+00,  3.7647e+00]],

         [[ 1.5954e+00,        -inf,        -inf,        -inf],
          [ 3.1088e+00, -2.0778e+00,        -inf,        -inf],
          [ 3.3780e-01, -2.7014e+00, -6.8967e-01,        -inf],
          [ 3.0758e+00,  5.9860e+00,  7.1896e+00, -8.9383e-01]],

         [[-2.1660e+00,        -inf,        -inf,        -inf],
          [-7.2732e-01,  8.7284e-01,        -inf,        -inf],
          [ 1.0933e+00,  3.6734e+00,  5.2979e+00,        -inf],
          [-4.9157e-01,  2.9658e-01,  9.1507e-01,  8.3446e-01]],

         [[-8.6043e-01,        -inf,        -inf,        -inf],
          [ 3.1907e-01,  3.2407e-01,        -inf,        -inf],
          [ 3.0299e+00,  1.8697e+00, -5.3656e-01,        -inf],
          [ 6.1839e+00,  7.1377e-02, -1.1871e+00, -1.8722e+00]],

         [[ 1.9187e-01,        -inf,        -inf,        -inf],
          [ 2.5090e+00, -4.9030e+00,        -inf,        -inf],
          [ 2.5872e+00, -2.8957e+00, -7.3552e-01,        -inf],
          [-3.2310e+00,  2.2829e+00,  5.7012e-01, -5.0555e+00]],

         [[ 1.3454e+00,        -inf,        -inf,        -inf],
          [ 3.7509e-01,  4.6565e+00,        -inf,        -inf],
          [ 1.2604e+00, -1.7207e+00,  1.1527e+00,        -inf],
          [-2.2226e-01,  2.9871e-01,  1.1246e+00,  4.9946e+00]],

         [[ 3.6690e+00,        -inf,        -inf,        -inf],
          [-2.9203e+00,  2.6805e+00,        -inf,        -inf],
          [ 1.4158e+00,  6.0573e+00,  9.8115e-01,        -inf],
          [-1.6417e+00, -3.0302e+00, -7.6965e-01, -4.0082e-01]],

         [[-5.5052e-01,        -inf,        -inf,        -inf],
          [-3.6637e+00, -2.6952e+00,        -inf,        -inf],
          [-3.9566e-01,  2.4702e+00,  2.3113e-01,        -inf],
          [-5.5824e-02, -1.7698e+00, -1.9845e+00,  1.1813e+00]],

         [[ 2.9262e-01,        -inf,        -inf,        -inf],
          [-3.5784e+00, -5.4598e-01,        -inf,        -inf],
          [ 3.5645e-01,  2.3407e+00, -1.5052e+00,        -inf],
          [-2.9487e+00,  5.9660e-01, -6.0184e+00, -3.8954e+00]],

         [[-1.0252e+00,        -inf,        -inf,        -inf],
          [-8.2935e-01, -2.8851e-01,        -inf,        -inf],
          [-1.8279e+00, -6.0264e-01,  9.8186e-01,        -inf],
          [-1.9398e-01, -1.5511e-01,  1.6805e+00,  2.5040e+00]],

         [[-1.5744e+00,        -inf,        -inf,        -inf],
          [-1.1563e+00, -5.9414e+00,        -inf,        -inf],
          [ 2.3119e+00,  2.8561e+00, -1.2820e+00,        -inf],
          [ 2.7386e+00,  2.7654e+00,  1.2641e+00,  6.0502e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 1.2728,  0.4923, -0.2572,  ...,  0.3564,  0.5078, -0.2651],
          [ 0.7465,  0.7146, -0.0531,  ...,  0.2817, -0.4435, -0.5786],
          [ 0.5178,  0.4017,  0.2135,  ...,  0.4200,  0.1219, -0.6684],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.3150, -1.0358,  0.6548,  ...,  0.1144, -0.9717,  0.3838],
          [-0.1982, -0.8403,  0.3284,  ..., -0.0085,  0.1172, -0.5309]],

         [[ 0.7981, -0.4625, -0.1610,  ...,  0.5136,  0.3418, -0.3745],
          [ 0.3298,  0.3157, -0.0234,  ...,  0.1244, -0.1959, -0.2556],
          [ 0.4348, -0.0846,  0.3283,  ..., -0.1302, -0.5052, -0.5933],
          ...,
          [-1.0241,  1.0909, -0.1851,  ...,  0.2697, -0.6386, -0.3888],
          [-0.3598, -0.4606, -0.0124,  ...,  0.2152, -0.8650,  0.5781],
          [-0.3086, -0.7465,  0.0884,  ..., -0.4403,  0.3285,  0.3403]],

         [[ 0.9689, -0.5473, -0.2610,  ...,  0.2359,  0.4290, -0.1655],
          [ 0.0768,  0.2178,  0.2123,  ...,  0.4344, -0.2366, -0.5226],
          [ 0.3785,  0.6914,  0.1874,  ..., -0.0606, -0.0393, -0.4859],
          ...,
          [-0.6001,  0.6989, -0.1007,  ...,  0.1172, -0.5209, -0.1637],
          [ 0.8670, -0.0976,  0.1040,  ...,  0.1805, -0.0741,  0.1702],
          [ 0.0533, -0.0144,  0.3594,  ..., -0.2510,  0.3712,  0.4319]],

         [[ 0.6046, -0.1852, -0.5247,  ...,  0.1225,  0.4600,  0.0900],
          [ 0.3369,  0.6192,  0.0276,  ...,  0.3726, -0.3268, -0.5382],
          [-0.4410,  0.0911, -0.2077,  ..., -0.1550,  0.2371, -0.5427],
          ...,
          [-0.5976,  0.0617,  0.1189,  ...,  0.0758, -0.0361, -0.7670],
          [ 0.1056, -0.3508, -0.1607,  ...,  0.1072, -0.5833,  0.3520],
          [ 0.0503,  0.0786, -0.2936,  ...,  0.1581,  0.2987,  0.2973]]],


        [[[ 0.8153,  0.3176, -0.0044,  ..., -0.2563,  0.7603, -0.3955],
          [ 0.6383,  0.6265, -0.9113,  ...,  0.6470, -0.3437, -0.3765],
          [ 0.4400,  0.1147,  0.1434,  ...,  0.2831,  0.4867, -0.9405],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.0919, -0.3431,  0.4646,  ...,  0.3817, -0.2481, -1.0951]],

         [[ 0.5598, -0.1967,  0.1328,  ..., -0.4428,  0.5441, -0.1064],
          [ 0.2752,  0.3136, -0.5644,  ...,  0.2923, -0.5460, -0.6788],
          [ 0.0382, -0.5222,  0.0728,  ...,  0.0221, -0.3279, -0.3600],
          ...,
          [-0.6696,  0.5204,  0.1084,  ..., -0.0351, -0.1097, -0.0292],
          [-0.1201, -0.1883, -0.4120,  ..., -0.3763,  0.2224,  0.0765],
          [-0.1282, -0.3792,  0.3557,  ...,  0.0211, -0.0904, -0.3259]],

         [[-0.0040, -0.6697, -0.1164,  ..., -0.1388,  0.0686,  0.1202],
          [ 0.0287, -0.0489,  0.2193,  ...,  0.2471, -0.2919, -0.5547],
          [ 0.1050, -0.3881,  0.1217,  ..., -0.0502, -0.4143,  0.0323],
          ...,
          [-0.4323,  0.6168,  0.0995,  ..., -0.3044,  0.0136, -0.1674],
          [ 0.0416, -0.3293, -0.0064,  ..., -0.2351,  0.1323,  0.3250],
          [ 0.1021,  0.0900,  0.0541,  ...,  0.2178, -0.2679, -0.3287]],

         [[ 0.3240, -0.2504, -0.0613,  ..., -0.1777,  0.4635, -0.0905],
          [ 0.2628,  0.0132, -0.5083,  ..., -0.1253, -0.3042, -0.0789],
          [ 0.3315, -0.1718,  0.1810,  ...,  0.0867, -0.0742, -0.3306],
          ...,
          [-0.3931,  0.4749,  0.0847,  ..., -0.2292,  0.0269, -0.1429],
          [-0.2308, -0.5569, -0.1851,  ..., -0.5709,  0.0277,  0.1869],
          [ 0.3494, -0.0873, -0.2270,  ...,  0.0223, -0.3609,  0.8427]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 1.2728,  0.4923, -0.2572,  ..., -0.0085,  0.1172, -0.5309],
         [ 0.7981, -0.4625, -0.1610,  ..., -0.4403,  0.3285,  0.3403],
         [ 0.9689, -0.5473, -0.2610,  ..., -0.2510,  0.3712,  0.4319],
         [ 0.6046, -0.1852, -0.5247,  ...,  0.1581,  0.2987,  0.2973]],

        [[ 0.8153,  0.3176, -0.0044,  ...,  0.3817, -0.2481, -1.0951],
         [ 0.5598, -0.1967,  0.1328,  ...,  0.0211, -0.0904, -0.3259],
         [-0.0040, -0.6697, -0.1164,  ...,  0.2178, -0.2679, -0.3287],
         [ 0.3240, -0.2504, -0.0613,  ...,  0.0223, -0.3609,  0.8427]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2186, -0.4308, -0.1419,  ...,  0.3447, -0.0777, -0.0686],
         [ 0.3421, -0.2213, -0.0986,  ...,  0.2361, -0.4441, -0.0500],
         [ 0.1547, -0.2854, -0.2622,  ..., -0.0077, -0.1096, -0.2756],
         [ 0.4179, -0.1626, -0.0323,  ..., -0.0600, -0.2497, -0.3827]],

        [[ 0.3911, -0.2975,  0.0138,  ...,  0.5119, -0.0756, -0.0488],
         [-0.1650, -0.0293,  0.0423,  ..., -0.0561, -0.3881,  0.1077],
         [-0.2855,  0.0954, -0.2163,  ..., -0.0288, -0.0624,  0.1435],
         [-0.2929, -0.0018,  0.0369,  ..., -0.0515, -0.0185, -0.0086]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 9.9634e-02,        -inf,        -inf,        -inf],
          [-3.3606e+00, -4.8555e-01,        -inf,        -inf],
          [ 8.7913e-01,  2.7381e+00,  1.9665e+00,        -inf],
          [-1.9529e+00,  4.2398e+00,  4.8635e+00,  1.2239e+00]],

         [[-3.6052e+00,        -inf,        -inf,        -inf],
          [ 1.8772e+00,  3.9482e+00,        -inf,        -inf],
          [-5.2886e-02,  8.7916e-01, -3.3660e+00,        -inf],
          [-1.2882e+00, -8.6329e-01,  8.6372e-02, -3.5029e+00]],

         [[-5.3021e-01,        -inf,        -inf,        -inf],
          [-2.5248e+00, -1.7590e+00,        -inf,        -inf],
          [-3.4437e+00,  1.0150e+00, -7.6773e-01,        -inf],
          [ 3.3293e+00, -2.4040e+00, -9.3553e-01, -6.1002e-02]],

         [[ 1.4441e+00,        -inf,        -inf,        -inf],
          [-2.3588e-01,  8.4732e-01,        -inf,        -inf],
          [ 2.9889e+00,  4.5134e+00,  1.6256e+00,        -inf],
          [-1.3070e+00,  2.0220e+00,  4.5236e-01, -9.8247e-01]],

         [[-8.1048e-01,        -inf,        -inf,        -inf],
          [-2.1372e+00, -3.9323e-01,        -inf,        -inf],
          [ 2.1533e+00,  3.2042e+00,  2.1631e+00,        -inf],
          [-7.2820e-01,  2.2861e-01, -2.5134e+00,  1.6415e+00]],

         [[-3.3353e+00,        -inf,        -inf,        -inf],
          [-1.9322e-01, -1.0752e+00,        -inf,        -inf],
          [ 3.0714e+00,  5.4353e-01,  3.3709e+00,        -inf],
          [ 4.6727e-01,  5.4916e+00,  4.1205e-01,  2.3851e+00]],

         [[-1.8185e+00,        -inf,        -inf,        -inf],
          [-1.7038e-01, -3.7546e+00,        -inf,        -inf],
          [ 2.8736e+00,  5.7926e+00,  6.1471e-01,        -inf],
          [ 1.2917e+00, -1.9087e+00, -5.4515e-01, -4.5663e+00]],

         [[-4.8035e-01,        -inf,        -inf,        -inf],
          [-1.4287e+00, -2.1444e+00,        -inf,        -inf],
          [ 1.2399e-01, -1.9698e+00,  3.7736e-01,        -inf],
          [ 6.1984e-01, -1.3326e+00, -2.1525e+00, -1.9321e+00]],

         [[-1.7466e+00,        -inf,        -inf,        -inf],
          [-1.7595e+00, -3.5320e+00,        -inf,        -inf],
          [-2.1792e+00, -1.2244e+00,  2.8322e-01,        -inf],
          [-3.2047e+00, -2.4029e+00, -2.8878e+00, -9.6412e-01]],

         [[ 4.7501e+00,        -inf,        -inf,        -inf],
          [-4.0099e-02,  4.7133e+00,        -inf,        -inf],
          [ 7.7331e-01, -2.8228e+00,  1.2376e+00,        -inf],
          [-2.7652e+00,  1.4856e+00,  3.9219e+00,  1.5371e+00]],

         [[ 5.0538e-02,        -inf,        -inf,        -inf],
          [-1.5580e+00, -1.5061e+00,        -inf,        -inf],
          [ 2.6356e+00, -2.3652e-01,  1.9018e-01,        -inf],
          [-1.4324e+00, -1.8946e+00,  2.4743e+00,  5.5082e+00]],

         [[ 1.9309e+00,        -inf,        -inf,        -inf],
          [-1.5168e+00, -2.6235e+00,        -inf,        -inf],
          [-3.4790e+00, -2.8215e+00, -1.9615e+00,        -inf],
          [ 1.1521e+00, -5.9706e+00,  3.2125e+00, -2.6156e-01]],

         [[-4.2487e+00,        -inf,        -inf,        -inf],
          [-3.3569e+00, -6.7802e-01,        -inf,        -inf],
          [-7.2927e+00, -3.1237e+00, -2.1195e+00,        -inf],
          [-2.9891e+00,  3.3263e+00,  1.7269e+00,  4.9300e+00]],

         [[-1.0082e+00,        -inf,        -inf,        -inf],
          [ 5.6595e+00,  2.5985e+00,        -inf,        -inf],
          [-5.8397e+00, -2.6057e+00,  2.3532e+00,        -inf],
          [ 2.8140e-02, -4.3568e+00,  1.5672e+00,  4.4665e+00]],

         [[-3.6396e+00,        -inf,        -inf,        -inf],
          [-5.6387e-01, -2.0534e+00,        -inf,        -inf],
          [ 1.9059e+00, -4.6578e-01,  7.1745e-01,        -inf],
          [ 2.1926e+00,  1.5357e+00, -4.6405e+00,  2.0958e+00]],

         [[-1.3383e+00,        -inf,        -inf,        -inf],
          [ 2.5978e+00,  3.9855e+00,        -inf,        -inf],
          [ 4.6942e+00,  2.5092e+00, -3.5085e-01,        -inf],
          [-1.9089e+00,  1.8181e+00,  1.3654e+00,  1.3218e+00]],

         [[ 1.8580e+00,        -inf,        -inf,        -inf],
          [ 3.4342e+00, -2.3614e+00,        -inf,        -inf],
          [-3.2144e+00, -1.0243e+00, -3.3979e+00,        -inf],
          [ 1.0814e+00,  1.8901e-01,  1.1039e+00, -3.3549e+00]],

         [[-4.4992e+00,        -inf,        -inf,        -inf],
          [-2.2586e+00, -7.7840e-01,        -inf,        -inf],
          [ 1.5730e+00,  7.0156e-01,  2.7437e+00,        -inf],
          [ 1.3060e-01, -3.3273e+00, -4.6817e-01,  5.8453e-01]],

         [[ 3.1675e+00,        -inf,        -inf,        -inf],
          [ 4.0251e+00,  2.4638e+00,        -inf,        -inf],
          [ 5.1571e-01,  3.2087e+00,  1.5981e+00,        -inf],
          [-3.5834e+00, -5.3678e-01, -2.0699e+00,  4.0183e+00]],

         [[-1.7978e-01,        -inf,        -inf,        -inf],
          [-1.3302e+00, -3.5047e-01,        -inf,        -inf],
          [ 3.3940e+00,  1.3710e+00,  1.5977e+00,        -inf],
          [-2.6046e+00,  1.9553e+00, -9.4262e-01,  5.0833e-01]],

         [[ 3.1795e+00,        -inf,        -inf,        -inf],
          [ 3.5485e+00, -2.9824e+00,        -inf,        -inf],
          [-4.6994e+00,  3.0648e+00, -4.6282e+00,        -inf],
          [-2.9704e+00, -2.8950e+00,  2.1895e+00, -2.9587e+00]],

         [[-1.5605e+00,        -inf,        -inf,        -inf],
          [ 1.7661e+00, -4.8931e+00,        -inf,        -inf],
          [-1.9208e+00, -4.0202e+00, -4.8041e+00,        -inf],
          [ 5.8446e+00, -4.8154e+00,  3.9477e+00, -3.7031e-01]],

         [[ 2.4144e+00,        -inf,        -inf,        -inf],
          [-2.5754e+00,  5.7342e-02,        -inf,        -inf],
          [-7.6210e-01, -1.5792e+00, -4.7346e-01,        -inf],
          [ 2.2202e+00,  2.7639e+00,  2.1740e+00,  4.6105e-01]],

         [[-4.4282e+00,        -inf,        -inf,        -inf],
          [ 1.6638e+00, -4.1216e+00,        -inf,        -inf],
          [-2.2734e+00, -2.1448e+00, -7.2911e-01,        -inf],
          [-2.3988e+00, -6.0198e-01, -4.7737e+00,  2.2395e+00]],

         [[-2.2747e+00,        -inf,        -inf,        -inf],
          [ 3.5971e+00,  1.6499e+00,        -inf,        -inf],
          [ 6.1396e-01,  7.6791e-01, -7.6802e-02,        -inf],
          [ 3.6873e-01, -1.5888e+00, -2.1954e-01, -6.8574e-01]]],


        [[[-1.2419e+00,        -inf,        -inf,        -inf],
          [-2.0303e+00,  2.2324e+00,        -inf,        -inf],
          [ 1.6034e+00,  5.2040e-01,  2.5490e+00,        -inf],
          [-6.1669e-01,  2.7540e+00,  1.0341e+00, -1.9036e+00]],

         [[-1.6565e+00,        -inf,        -inf,        -inf],
          [-9.8331e-02,  1.7707e+00,        -inf,        -inf],
          [-2.3054e+00,  8.8691e-01, -2.3883e-02,        -inf],
          [-7.0033e-01, -2.5588e+00,  1.4237e+00, -1.6846e-02]],

         [[-2.2585e+00,        -inf,        -inf,        -inf],
          [-2.1345e+00, -9.5107e-01,        -inf,        -inf],
          [-2.6311e+00,  1.8002e+00,  1.8364e+00,        -inf],
          [-2.4678e+00, -3.3562e+00,  1.8761e-01,  2.7233e+00]],

         [[-1.8984e+00,        -inf,        -inf,        -inf],
          [-1.3886e+00, -3.4586e+00,        -inf,        -inf],
          [ 4.3832e+00,  6.4446e-01,  2.1467e+00,        -inf],
          [-1.3645e-01, -5.4037e-01, -4.5184e+00, -4.0516e+00]],

         [[-2.3121e+00,        -inf,        -inf,        -inf],
          [-1.5386e-01, -2.0628e+00,        -inf,        -inf],
          [ 4.2921e+00,  3.7207e+00,  2.2622e+00,        -inf],
          [-7.2317e-01, -1.3842e+00, -4.4332e+00, -1.4478e+00]],

         [[-2.0167e+00,        -inf,        -inf,        -inf],
          [-2.2683e+00,  1.8770e+00,        -inf,        -inf],
          [ 6.6356e-01,  1.1070e+00, -6.0583e+00,        -inf],
          [-2.1954e+00,  7.8001e+00, -4.0555e+00,  2.3749e+00]],

         [[-1.1289e-01,        -inf,        -inf,        -inf],
          [-2.0002e+00,  1.7654e+00,        -inf,        -inf],
          [-2.1843e+00, -2.5768e+00,  9.0317e-01,        -inf],
          [-2.2615e+00, -2.0279e+00,  4.7322e+00,  2.5913e-01]],

         [[ 2.5443e+00,        -inf,        -inf,        -inf],
          [-4.6191e+00,  1.8204e+00,        -inf,        -inf],
          [-6.4716e-02,  2.1163e+00, -1.6780e+00,        -inf],
          [ 1.5021e+00,  1.4458e-02, -2.1513e+00,  7.5971e-01]],

         [[-2.0107e+00,        -inf,        -inf,        -inf],
          [ 1.3113e+00,  1.7807e+00,        -inf,        -inf],
          [-3.9165e+00, -2.1544e+00, -1.9681e+00,        -inf],
          [-1.9832e+00, -5.3016e-01,  4.4489e+00,  2.3216e+00]],

         [[ 2.8559e+00,        -inf,        -inf,        -inf],
          [-5.5598e+00, -5.9313e+00,        -inf,        -inf],
          [-1.4288e-01, -3.7096e+00, -1.2355e+00,        -inf],
          [-2.1663e+00, -8.3740e-01,  3.6435e+00, -2.4803e+00]],

         [[-5.6076e-01,        -inf,        -inf,        -inf],
          [-2.3627e+00, -2.4689e+00,        -inf,        -inf],
          [-3.4615e+00, -2.2824e+00,  2.2201e+00,        -inf],
          [ 1.6496e+00, -2.8018e+00,  8.7677e-02,  1.0769e+00]],

         [[ 5.8171e+00,        -inf,        -inf,        -inf],
          [-4.2826e+00,  1.3377e+00,        -inf,        -inf],
          [-6.9154e+00,  2.6402e+00,  8.1087e-01,        -inf],
          [-2.8931e+00, -3.1332e+00, -3.3551e+00,  8.8526e-01]],

         [[-4.4415e+00,        -inf,        -inf,        -inf],
          [-4.0645e+00, -2.8622e+00,        -inf,        -inf],
          [-4.9843e+00, -1.3505e+00,  2.3116e+00,        -inf],
          [-3.3277e+00, -3.4363e+00,  1.2753e+00,  1.0566e+00]],

         [[ 1.4428e+00,        -inf,        -inf,        -inf],
          [ 2.5834e+00,  8.0906e-02,        -inf,        -inf],
          [ 3.3905e+00,  1.3599e+00,  2.9122e+00,        -inf],
          [ 9.4816e-01, -5.6411e+00, -6.0499e-01,  3.0470e+00]],

         [[-4.6026e+00,        -inf,        -inf,        -inf],
          [ 1.7101e-03, -3.2747e+00,        -inf,        -inf],
          [ 3.6898e+00, -3.2136e-02,  5.4511e+00,        -inf],
          [-6.9806e-02,  2.7205e+00,  6.5199e-01,  4.7141e+00]],

         [[ 9.1726e-01,        -inf,        -inf,        -inf],
          [-2.9239e+00, -5.1008e+00,        -inf,        -inf],
          [ 3.6568e+00,  2.7051e+00, -1.8595e+00,        -inf],
          [-4.2960e+00, -5.7093e-01, -1.5541e+00, -2.0768e+00]],

         [[ 2.4994e-01,        -inf,        -inf,        -inf],
          [ 9.8263e-01, -5.2521e+00,        -inf,        -inf],
          [ 7.8761e-01, -8.0336e-02, -2.3211e+00,        -inf],
          [ 3.9061e+00,  1.5326e+00, -3.1099e+00, -3.5641e-01]],

         [[-5.3074e+00,        -inf,        -inf,        -inf],
          [-3.0154e+00,  2.7699e+00,        -inf,        -inf],
          [ 1.7705e-01, -1.8633e+00,  3.2963e-01,        -inf],
          [ 6.8516e-01,  5.9461e-01,  2.5260e+00, -6.6873e-01]],

         [[-1.4764e+00,        -inf,        -inf,        -inf],
          [-2.3974e+00, -3.3331e+00,        -inf,        -inf],
          [-1.8510e+00,  2.2747e+00,  5.4991e+00,        -inf],
          [-6.9418e+00, -1.4876e+00, -7.7870e-01,  1.0806e+00]],

         [[ 1.8478e+00,        -inf,        -inf,        -inf],
          [-3.7340e+00,  6.4841e-01,        -inf,        -inf],
          [-4.2844e+00,  2.7758e+00, -3.0787e+00,        -inf],
          [-4.3686e+00,  1.2275e+00,  5.3944e-01, -6.3827e+00]],

         [[-3.0843e+00,        -inf,        -inf,        -inf],
          [-1.2681e+00, -2.0847e+00,        -inf,        -inf],
          [-4.6867e+00, -2.6762e+00, -2.7286e+00,        -inf],
          [-1.3098e+00, -2.2455e+00,  1.4167e+00, -3.6365e+00]],

         [[-1.4530e+00,        -inf,        -inf,        -inf],
          [ 1.4922e+00, -9.9287e-01,        -inf,        -inf],
          [-1.1959e+00,  2.9494e+00,  1.5402e+00,        -inf],
          [ 9.1983e-01,  5.3348e-01, -5.3423e+00,  3.9609e+00]],

         [[ 1.3754e+00,        -inf,        -inf,        -inf],
          [-5.6665e+00, -3.3789e+00,        -inf,        -inf],
          [ 2.3161e-01, -1.7354e+00,  1.3041e+00,        -inf],
          [-3.4624e+00,  3.4866e+00,  3.4900e+00, -2.5645e+00]],

         [[-8.4855e-01,        -inf,        -inf,        -inf],
          [ 7.2324e-01, -1.1609e+00,        -inf,        -inf],
          [-2.2150e+00,  2.5542e-01, -2.3889e+00,        -inf],
          [ 9.5341e-01, -2.3571e+00,  1.6454e+00,  1.1270e+00]],

         [[-7.5195e-01,        -inf,        -inf,        -inf],
          [ 1.3650e+00,  2.4931e+00,        -inf,        -inf],
          [ 7.0756e+00,  5.7871e+00, -2.7058e-01,        -inf],
          [-1.6249e+00, -8.6750e-01,  3.2130e+00,  1.1096e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 9.9634e-02,        -inf,        -inf,        -inf],
          [-3.3606e+00, -4.8555e-01,        -inf,        -inf],
          [ 8.7913e-01,  2.7381e+00,  1.9665e+00,        -inf],
          [-1.9529e+00,  4.2398e+00,  4.8635e+00,  1.2239e+00]],

         [[-3.6052e+00,        -inf,        -inf,        -inf],
          [ 1.8772e+00,  3.9482e+00,        -inf,        -inf],
          [-5.2886e-02,  8.7916e-01, -3.3660e+00,        -inf],
          [-1.2882e+00, -8.6329e-01,  8.6372e-02, -3.5029e+00]],

         [[-5.3021e-01,        -inf,        -inf,        -inf],
          [-2.5248e+00, -1.7590e+00,        -inf,        -inf],
          [-3.4437e+00,  1.0150e+00, -7.6773e-01,        -inf],
          [ 3.3293e+00, -2.4040e+00, -9.3553e-01, -6.1002e-02]],

         [[ 1.4441e+00,        -inf,        -inf,        -inf],
          [-2.3588e-01,  8.4732e-01,        -inf,        -inf],
          [ 2.9889e+00,  4.5134e+00,  1.6256e+00,        -inf],
          [-1.3070e+00,  2.0220e+00,  4.5236e-01, -9.8247e-01]],

         [[-8.1048e-01,        -inf,        -inf,        -inf],
          [-2.1372e+00, -3.9323e-01,        -inf,        -inf],
          [ 2.1533e+00,  3.2042e+00,  2.1631e+00,        -inf],
          [-7.2820e-01,  2.2861e-01, -2.5134e+00,  1.6415e+00]],

         [[-3.3353e+00,        -inf,        -inf,        -inf],
          [-1.9322e-01, -1.0752e+00,        -inf,        -inf],
          [ 3.0714e+00,  5.4353e-01,  3.3709e+00,        -inf],
          [ 4.6727e-01,  5.4916e+00,  4.1205e-01,  2.3851e+00]],

         [[-1.8185e+00,        -inf,        -inf,        -inf],
          [-1.7038e-01, -3.7546e+00,        -inf,        -inf],
          [ 2.8736e+00,  5.7926e+00,  6.1471e-01,        -inf],
          [ 1.2917e+00, -1.9087e+00, -5.4515e-01, -4.5663e+00]],

         [[-4.8035e-01,        -inf,        -inf,        -inf],
          [-1.4287e+00, -2.1444e+00,        -inf,        -inf],
          [ 1.2399e-01, -1.9698e+00,  3.7736e-01,        -inf],
          [ 6.1984e-01, -1.3326e+00, -2.1525e+00, -1.9321e+00]],

         [[-1.7466e+00,        -inf,        -inf,        -inf],
          [-1.7595e+00, -3.5320e+00,        -inf,        -inf],
          [-2.1792e+00, -1.2244e+00,  2.8322e-01,        -inf],
          [-3.2047e+00, -2.4029e+00, -2.8878e+00, -9.6412e-01]],

         [[ 4.7501e+00,        -inf,        -inf,        -inf],
          [-4.0099e-02,  4.7133e+00,        -inf,        -inf],
          [ 7.7331e-01, -2.8228e+00,  1.2376e+00,        -inf],
          [-2.7652e+00,  1.4856e+00,  3.9219e+00,  1.5371e+00]],

         [[ 5.0538e-02,        -inf,        -inf,        -inf],
          [-1.5580e+00, -1.5061e+00,        -inf,        -inf],
          [ 2.6356e+00, -2.3652e-01,  1.9018e-01,        -inf],
          [-1.4324e+00, -1.8946e+00,  2.4743e+00,  5.5082e+00]],

         [[ 1.9309e+00,        -inf,        -inf,        -inf],
          [-1.5168e+00, -2.6235e+00,        -inf,        -inf],
          [-3.4790e+00, -2.8215e+00, -1.9615e+00,        -inf],
          [ 1.1521e+00, -5.9706e+00,  3.2125e+00, -2.6156e-01]],

         [[-4.2487e+00,        -inf,        -inf,        -inf],
          [-3.3569e+00, -6.7802e-01,        -inf,        -inf],
          [-7.2927e+00, -3.1237e+00, -2.1195e+00,        -inf],
          [-2.9891e+00,  3.3263e+00,  1.7269e+00,  4.9300e+00]],

         [[-1.0082e+00,        -inf,        -inf,        -inf],
          [ 5.6595e+00,  2.5985e+00,        -inf,        -inf],
          [-5.8397e+00, -2.6057e+00,  2.3532e+00,        -inf],
          [ 2.8140e-02, -4.3568e+00,  1.5672e+00,  4.4665e+00]],

         [[-3.6396e+00,        -inf,        -inf,        -inf],
          [-5.6387e-01, -2.0534e+00,        -inf,        -inf],
          [ 1.9059e+00, -4.6578e-01,  7.1745e-01,        -inf],
          [ 2.1926e+00,  1.5357e+00, -4.6405e+00,  2.0958e+00]],

         [[-1.3383e+00,        -inf,        -inf,        -inf],
          [ 2.5978e+00,  3.9855e+00,        -inf,        -inf],
          [ 4.6942e+00,  2.5092e+00, -3.5085e-01,        -inf],
          [-1.9089e+00,  1.8181e+00,  1.3654e+00,  1.3218e+00]],

         [[ 1.8580e+00,        -inf,        -inf,        -inf],
          [ 3.4342e+00, -2.3614e+00,        -inf,        -inf],
          [-3.2144e+00, -1.0243e+00, -3.3979e+00,        -inf],
          [ 1.0814e+00,  1.8901e-01,  1.1039e+00, -3.3549e+00]],

         [[-4.4992e+00,        -inf,        -inf,        -inf],
          [-2.2586e+00, -7.7840e-01,        -inf,        -inf],
          [ 1.5730e+00,  7.0156e-01,  2.7437e+00,        -inf],
          [ 1.3060e-01, -3.3273e+00, -4.6817e-01,  5.8453e-01]],

         [[ 3.1675e+00,        -inf,        -inf,        -inf],
          [ 4.0251e+00,  2.4638e+00,        -inf,        -inf],
          [ 5.1571e-01,  3.2087e+00,  1.5981e+00,        -inf],
          [-3.5834e+00, -5.3678e-01, -2.0699e+00,  4.0183e+00]],

         [[-1.7978e-01,        -inf,        -inf,        -inf],
          [-1.3302e+00, -3.5047e-01,        -inf,        -inf],
          [ 3.3940e+00,  1.3710e+00,  1.5977e+00,        -inf],
          [-2.6046e+00,  1.9553e+00, -9.4262e-01,  5.0833e-01]],

         [[ 3.1795e+00,        -inf,        -inf,        -inf],
          [ 3.5485e+00, -2.9824e+00,        -inf,        -inf],
          [-4.6994e+00,  3.0648e+00, -4.6282e+00,        -inf],
          [-2.9704e+00, -2.8950e+00,  2.1895e+00, -2.9587e+00]],

         [[-1.5605e+00,        -inf,        -inf,        -inf],
          [ 1.7661e+00, -4.8931e+00,        -inf,        -inf],
          [-1.9208e+00, -4.0202e+00, -4.8041e+00,        -inf],
          [ 5.8446e+00, -4.8154e+00,  3.9477e+00, -3.7031e-01]],

         [[ 2.4144e+00,        -inf,        -inf,        -inf],
          [-2.5754e+00,  5.7342e-02,        -inf,        -inf],
          [-7.6210e-01, -1.5792e+00, -4.7346e-01,        -inf],
          [ 2.2202e+00,  2.7639e+00,  2.1740e+00,  4.6105e-01]],

         [[-4.4282e+00,        -inf,        -inf,        -inf],
          [ 1.6638e+00, -4.1216e+00,        -inf,        -inf],
          [-2.2734e+00, -2.1448e+00, -7.2911e-01,        -inf],
          [-2.3988e+00, -6.0198e-01, -4.7737e+00,  2.2395e+00]],

         [[-2.2747e+00,        -inf,        -inf,        -inf],
          [ 3.5971e+00,  1.6499e+00,        -inf,        -inf],
          [ 6.1396e-01,  7.6791e-01, -7.6802e-02,        -inf],
          [ 3.6873e-01, -1.5888e+00, -2.1954e-01, -6.8574e-01]]],


        [[[-1.2419e+00,        -inf,        -inf,        -inf],
          [-2.0303e+00,  2.2324e+00,        -inf,        -inf],
          [ 1.6034e+00,  5.2040e-01,  2.5490e+00,        -inf],
          [-6.1669e-01,  2.7540e+00,  1.0341e+00, -1.9036e+00]],

         [[-1.6565e+00,        -inf,        -inf,        -inf],
          [-9.8331e-02,  1.7707e+00,        -inf,        -inf],
          [-2.3054e+00,  8.8691e-01, -2.3883e-02,        -inf],
          [-7.0033e-01, -2.5588e+00,  1.4237e+00, -1.6846e-02]],

         [[-2.2585e+00,        -inf,        -inf,        -inf],
          [-2.1345e+00, -9.5107e-01,        -inf,        -inf],
          [-2.6311e+00,  1.8002e+00,  1.8364e+00,        -inf],
          [-2.4678e+00, -3.3562e+00,  1.8761e-01,  2.7233e+00]],

         [[-1.8984e+00,        -inf,        -inf,        -inf],
          [-1.3886e+00, -3.4586e+00,        -inf,        -inf],
          [ 4.3832e+00,  6.4446e-01,  2.1467e+00,        -inf],
          [-1.3645e-01, -5.4037e-01, -4.5184e+00, -4.0516e+00]],

         [[-2.3121e+00,        -inf,        -inf,        -inf],
          [-1.5386e-01, -2.0628e+00,        -inf,        -inf],
          [ 4.2921e+00,  3.7207e+00,  2.2622e+00,        -inf],
          [-7.2317e-01, -1.3842e+00, -4.4332e+00, -1.4478e+00]],

         [[-2.0167e+00,        -inf,        -inf,        -inf],
          [-2.2683e+00,  1.8770e+00,        -inf,        -inf],
          [ 6.6356e-01,  1.1070e+00, -6.0583e+00,        -inf],
          [-2.1954e+00,  7.8001e+00, -4.0555e+00,  2.3749e+00]],

         [[-1.1289e-01,        -inf,        -inf,        -inf],
          [-2.0002e+00,  1.7654e+00,        -inf,        -inf],
          [-2.1843e+00, -2.5768e+00,  9.0317e-01,        -inf],
          [-2.2615e+00, -2.0279e+00,  4.7322e+00,  2.5913e-01]],

         [[ 2.5443e+00,        -inf,        -inf,        -inf],
          [-4.6191e+00,  1.8204e+00,        -inf,        -inf],
          [-6.4716e-02,  2.1163e+00, -1.6780e+00,        -inf],
          [ 1.5021e+00,  1.4458e-02, -2.1513e+00,  7.5971e-01]],

         [[-2.0107e+00,        -inf,        -inf,        -inf],
          [ 1.3113e+00,  1.7807e+00,        -inf,        -inf],
          [-3.9165e+00, -2.1544e+00, -1.9681e+00,        -inf],
          [-1.9832e+00, -5.3016e-01,  4.4489e+00,  2.3216e+00]],

         [[ 2.8559e+00,        -inf,        -inf,        -inf],
          [-5.5598e+00, -5.9313e+00,        -inf,        -inf],
          [-1.4288e-01, -3.7096e+00, -1.2355e+00,        -inf],
          [-2.1663e+00, -8.3740e-01,  3.6435e+00, -2.4803e+00]],

         [[-5.6076e-01,        -inf,        -inf,        -inf],
          [-2.3627e+00, -2.4689e+00,        -inf,        -inf],
          [-3.4615e+00, -2.2824e+00,  2.2201e+00,        -inf],
          [ 1.6496e+00, -2.8018e+00,  8.7677e-02,  1.0769e+00]],

         [[ 5.8171e+00,        -inf,        -inf,        -inf],
          [-4.2826e+00,  1.3377e+00,        -inf,        -inf],
          [-6.9154e+00,  2.6402e+00,  8.1087e-01,        -inf],
          [-2.8931e+00, -3.1332e+00, -3.3551e+00,  8.8526e-01]],

         [[-4.4415e+00,        -inf,        -inf,        -inf],
          [-4.0645e+00, -2.8622e+00,        -inf,        -inf],
          [-4.9843e+00, -1.3505e+00,  2.3116e+00,        -inf],
          [-3.3277e+00, -3.4363e+00,  1.2753e+00,  1.0566e+00]],

         [[ 1.4428e+00,        -inf,        -inf,        -inf],
          [ 2.5834e+00,  8.0906e-02,        -inf,        -inf],
          [ 3.3905e+00,  1.3599e+00,  2.9122e+00,        -inf],
          [ 9.4816e-01, -5.6411e+00, -6.0499e-01,  3.0470e+00]],

         [[-4.6026e+00,        -inf,        -inf,        -inf],
          [ 1.7101e-03, -3.2747e+00,        -inf,        -inf],
          [ 3.6898e+00, -3.2136e-02,  5.4511e+00,        -inf],
          [-6.9806e-02,  2.7205e+00,  6.5199e-01,  4.7141e+00]],

         [[ 9.1726e-01,        -inf,        -inf,        -inf],
          [-2.9239e+00, -5.1008e+00,        -inf,        -inf],
          [ 3.6568e+00,  2.7051e+00, -1.8595e+00,        -inf],
          [-4.2960e+00, -5.7093e-01, -1.5541e+00, -2.0768e+00]],

         [[ 2.4994e-01,        -inf,        -inf,        -inf],
          [ 9.8263e-01, -5.2521e+00,        -inf,        -inf],
          [ 7.8761e-01, -8.0336e-02, -2.3211e+00,        -inf],
          [ 3.9061e+00,  1.5326e+00, -3.1099e+00, -3.5641e-01]],

         [[-5.3074e+00,        -inf,        -inf,        -inf],
          [-3.0154e+00,  2.7699e+00,        -inf,        -inf],
          [ 1.7705e-01, -1.8633e+00,  3.2963e-01,        -inf],
          [ 6.8516e-01,  5.9461e-01,  2.5260e+00, -6.6873e-01]],

         [[-1.4764e+00,        -inf,        -inf,        -inf],
          [-2.3974e+00, -3.3331e+00,        -inf,        -inf],
          [-1.8510e+00,  2.2747e+00,  5.4991e+00,        -inf],
          [-6.9418e+00, -1.4876e+00, -7.7870e-01,  1.0806e+00]],

         [[ 1.8478e+00,        -inf,        -inf,        -inf],
          [-3.7340e+00,  6.4841e-01,        -inf,        -inf],
          [-4.2844e+00,  2.7758e+00, -3.0787e+00,        -inf],
          [-4.3686e+00,  1.2275e+00,  5.3944e-01, -6.3827e+00]],

         [[-3.0843e+00,        -inf,        -inf,        -inf],
          [-1.2681e+00, -2.0847e+00,        -inf,        -inf],
          [-4.6867e+00, -2.6762e+00, -2.7286e+00,        -inf],
          [-1.3098e+00, -2.2455e+00,  1.4167e+00, -3.6365e+00]],

         [[-1.4530e+00,        -inf,        -inf,        -inf],
          [ 1.4922e+00, -9.9287e-01,        -inf,        -inf],
          [-1.1959e+00,  2.9494e+00,  1.5402e+00,        -inf],
          [ 9.1983e-01,  5.3348e-01, -5.3423e+00,  3.9609e+00]],

         [[ 1.3754e+00,        -inf,        -inf,        -inf],
          [-5.6665e+00, -3.3789e+00,        -inf,        -inf],
          [ 2.3161e-01, -1.7354e+00,  1.3041e+00,        -inf],
          [-3.4624e+00,  3.4866e+00,  3.4900e+00, -2.5645e+00]],

         [[-8.4855e-01,        -inf,        -inf,        -inf],
          [ 7.2324e-01, -1.1609e+00,        -inf,        -inf],
          [-2.2150e+00,  2.5542e-01, -2.3889e+00,        -inf],
          [ 9.5341e-01, -2.3571e+00,  1.6454e+00,  1.1270e+00]],

         [[-7.5195e-01,        -inf,        -inf,        -inf],
          [ 1.3650e+00,  2.4931e+00,        -inf,        -inf],
          [ 7.0756e+00,  5.7871e+00, -2.7058e-01,        -inf],
          [-1.6249e+00, -8.6750e-01,  3.2130e+00,  1.1096e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 3.0174e-01, -1.0627e-01, -2.8619e-01,  ...,  6.7440e-03,
            6.4754e-01, -1.2889e-01],
          [ 2.0742e-02,  5.9536e-01, -1.0020e+00,  ...,  5.3849e-01,
           -3.9045e-01, -3.5206e-01],
          [-3.0769e-01,  1.2238e+00, -9.2778e-01,  ..., -1.1362e-01,
            6.7620e-01,  4.4460e-01],
          ...,
          [ 7.8221e-02,  5.0271e-01,  3.5224e-02,  ...,  2.2053e-01,
           -1.4405e+00,  1.4894e+00],
          [ 5.5427e-01,  5.9747e-01, -1.2327e-03,  ...,  6.2718e-02,
            7.2607e-01, -6.0617e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],

         [[ 4.0241e-01, -1.9783e-01, -9.6725e-02,  ...,  5.7219e-02,
            6.4725e-01, -3.9173e-01],
          [-4.3395e-01,  2.6565e-01, -2.0393e-01,  ..., -2.4754e-01,
           -4.2626e-01,  1.7420e-01],
          [ 8.4934e-02,  1.2041e+00, -7.2503e-01,  ...,  4.1544e-01,
            7.0155e-01,  1.5245e-01],
          ...,
          [ 1.7150e-01,  8.3852e-01,  5.5377e-02,  ...,  9.9392e-02,
           -7.9037e-01,  6.9471e-01],
          [ 3.7319e-01,  4.0228e-01, -8.3000e-04,  ...,  4.2229e-02,
            4.8887e-01, -4.0814e-01],
          [ 6.1876e-01, -1.1165e-02, -7.8210e-01,  ..., -6.2485e-01,
           -4.7625e-01, -7.8466e-01]],

         [[ 4.7514e-01, -2.7058e-01, -3.0370e-01,  ...,  2.3344e-01,
            3.4184e-01,  6.6170e-02],
          [-2.4420e-01,  6.0169e-01, -7.0700e-01,  ...,  2.5730e-01,
           -4.7033e-01, -2.7557e-02],
          [-1.4790e-02,  3.9155e-01, -1.3850e-01,  ...,  1.2938e-01,
           -6.9633e-02,  3.7837e-01],
          ...,
          [ 4.1596e-01,  4.7496e-01, -1.2527e-01,  ...,  3.6710e-01,
           -2.9575e-01,  8.5288e-01],
          [ 2.0976e-01,  2.7780e-01,  4.0573e-01,  ...,  2.8035e-01,
            3.6829e-01, -1.8757e-01],
          [ 2.0981e-01,  2.9866e-02, -2.9782e-01,  ..., -3.6104e-01,
           -2.2401e-01, -5.2410e-01]],

         [[ 6.0130e-01,  2.6487e-02, -3.4742e-01,  ..., -1.6613e-02,
            4.0973e-01,  3.3226e-02],
          [-3.1637e-01,  5.7565e-01, -5.5903e-01,  ...,  2.1505e-01,
           -4.2857e-01,  9.6336e-02],
          [ 4.2184e-03,  7.2186e-01, -3.8218e-01,  ...,  2.1867e-01,
            2.2894e-01,  3.1544e-01],
          ...,
          [ 3.7214e-01,  5.2907e-01,  1.0109e-01,  ...,  7.7327e-02,
           -3.0567e-01,  6.7737e-01],
          [ 3.0437e-01,  6.8173e-01,  7.1004e-01,  ...,  2.2026e-01,
            4.0357e-01, -2.3416e-01],
          [ 3.9996e-01,  3.6238e-01, -6.1522e-02,  ..., -4.6842e-01,
           -3.6064e-01, -5.2398e-01]]],


        [[[ 6.7099e-02,  1.3897e-02, -3.9906e-01,  ...,  2.0060e-01,
            1.6802e-01, -3.0496e-01],
          [ 6.1470e-02,  8.6378e-01, -8.0803e-01,  ..., -6.3714e-02,
           -4.2056e-01, -7.5727e-01],
          [-1.4170e-01,  7.7190e-01, -8.1142e-01,  ..., -4.2936e-01,
            1.5895e+00,  2.2099e-01],
          ...,
          [-2.2683e-01,  1.3940e-02, -5.0430e-01,  ...,  2.3160e-01,
           -8.3881e-01,  1.3534e+00],
          [ 2.5584e-01,  4.9789e-01, -2.1185e-01,  ..., -7.8011e-02,
            5.5303e-01, -1.0385e+00],
          [ 6.4758e-01, -2.1989e-01, -3.8497e-01,  ..., -5.1346e-01,
           -9.9892e-02,  3.2880e-02]],

         [[-3.1863e-01, -1.9569e-01,  1.0927e-01,  ...,  7.4667e-01,
            1.1165e-01,  3.3654e-02],
          [ 4.8502e-01,  6.4300e-01, -8.8294e-01,  ..., -6.4731e-01,
           -3.3600e-01, -3.0277e-01],
          [ 1.8078e-01, -2.4426e-02, -4.2629e-01,  ..., -2.8769e-01,
            8.3035e-01,  1.4587e-01],
          ...,
          [-9.7308e-02,  5.9801e-03, -2.1634e-01,  ...,  9.9355e-02,
           -3.5984e-01,  5.8061e-01],
          [ 4.5745e-01,  4.6619e-01, -2.1822e-01,  ...,  8.5175e-02,
            3.3735e-01, -6.6427e-01],
          [-2.3455e-01, -2.3907e-01, -5.2475e-01,  ..., -8.0111e-01,
           -5.4218e-02, -4.1502e-01]],

         [[ 2.1822e-01, -4.1311e-02, -8.7944e-02,  ...,  9.4003e-02,
           -3.7458e-02,  1.0666e-02],
          [ 3.8152e-01,  3.8862e-01, -7.5668e-01,  ..., -2.6150e-01,
           -1.0521e-01, -1.0521e-02],
          [ 1.3906e-01, -3.9449e-01, -2.6388e-01,  ...,  4.3347e-03,
           -5.5554e-02, -5.0572e-04],
          ...,
          [ 1.2280e-01,  2.4757e-01,  1.4441e-01,  ...,  1.7563e-01,
            5.4983e-01, -1.3492e-01],
          [ 2.6963e-01, -1.0742e-01,  7.3585e-02,  ...,  5.9031e-02,
            3.2966e-01, -2.6092e-01],
          [-1.6881e-01, -1.4627e-02, -3.2233e-01,  ..., -6.2466e-01,
           -1.3653e-01, -4.5123e-01]],

         [[ 2.8441e-01,  6.1386e-02,  2.6616e-01,  ...,  4.3509e-01,
            2.0483e-01,  1.4612e-02],
          [ 1.5041e-01,  3.2684e-01, -6.7202e-01,  ...,  1.2336e-01,
           -2.6972e-01, -1.7519e-01],
          [ 1.1523e-01, -4.6829e-02, -1.8288e-01,  ...,  5.3914e-02,
            4.0659e-02,  3.9365e-02],
          ...,
          [ 1.6510e-01,  5.8576e-02,  3.4405e-02,  ..., -5.0274e-02,
            5.2571e-01, -6.2769e-02],
          [ 4.0733e-01, -5.3126e-02,  2.7811e-01,  ...,  1.3072e-01,
            2.5372e-01, -7.1625e-01],
          [-3.2914e-01,  3.0101e-01, -2.7342e-02,  ..., -5.7644e-01,
           -1.4484e-01, -2.1999e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.3017, -0.1063, -0.2862,  ...,  0.0000,  0.0000,  0.0000],
         [ 0.4024, -0.1978, -0.0967,  ..., -0.6248, -0.4762, -0.7847],
         [ 0.4751, -0.2706, -0.3037,  ..., -0.3610, -0.2240, -0.5241],
         [ 0.6013,  0.0265, -0.3474,  ..., -0.4684, -0.3606, -0.5240]],

        [[ 0.0671,  0.0139, -0.3991,  ..., -0.5135, -0.0999,  0.0329],
         [-0.3186, -0.1957,  0.1093,  ..., -0.8011, -0.0542, -0.4150],
         [ 0.2182, -0.0413, -0.0879,  ..., -0.6247, -0.1365, -0.4512],
         [ 0.2844,  0.0614,  0.2662,  ..., -0.5764, -0.1448, -0.2200]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1063,  0.2946,  0.6221,  ..., -0.4443, -0.1561,  0.5226],
         [ 0.1278,  0.1862,  0.4236,  ..., -0.3424,  0.1803,  0.7426],
         [ 0.1916,  0.0896,  0.3061,  ..., -0.3105,  0.0326,  0.2586],
         [ 0.2012,  0.2469,  0.2116,  ..., -0.2513,  0.4093,  0.1539]],

        [[ 0.3083,  0.1603,  0.5388,  ..., -0.3206,  0.0793,  0.3141],
         [ 0.2560,  0.0272,  0.2333,  ..., -0.2469,  0.1730,  0.3916],
         [ 0.2609,  0.3073,  0.4829,  ..., -0.3029, -0.0635,  0.2524],
         [ 0.3007,  0.3898,  0.6164,  ..., -0.2747,  0.2474,  0.1950]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-8.8507e-01,        -inf,        -inf,        -inf],
          [ 1.7257e-01,  1.5387e+00,        -inf,        -inf],
          [-4.6570e+00,  1.3332e+00, -2.4823e+00,        -inf],
          [ 2.0453e+00,  8.2234e-01,  3.6430e-01,  2.2346e+00]],

         [[ 2.7421e+00,        -inf,        -inf,        -inf],
          [-7.6395e-01,  2.6309e+00,        -inf,        -inf],
          [-1.3740e+00, -2.9162e+00,  2.4481e+00,        -inf],
          [ 1.7463e+00,  7.8696e-01,  4.1831e-01,  3.5487e+00]],

         [[ 1.7317e+00,        -inf,        -inf,        -inf],
          [ 3.5481e+00,  2.8159e+00,        -inf,        -inf],
          [ 1.5083e-01,  7.1260e-01,  8.0884e-01,        -inf],
          [ 6.9774e-01, -1.5403e+00, -2.1756e+00, -3.1093e+00]],

         [[ 6.6634e-01,        -inf,        -inf,        -inf],
          [ 9.7498e-01, -1.7951e+00,        -inf,        -inf],
          [ 1.4046e+00, -1.9975e+00,  2.2518e-01,        -inf],
          [-1.2762e+00,  4.9085e+00,  8.9976e-01,  4.3261e-01]],

         [[-2.4506e+00,        -inf,        -inf,        -inf],
          [-5.4635e-02,  4.2589e-01,        -inf,        -inf],
          [-3.3188e+00, -2.6366e+00, -2.2193e+00,        -inf],
          [-1.5352e+00, -2.2066e+00, -5.1029e+00, -1.0782e+00]],

         [[ 6.8967e+00,        -inf,        -inf,        -inf],
          [-2.7710e+00,  8.7118e-01,        -inf,        -inf],
          [-1.6403e+00,  4.2110e+00,  7.1419e+00,        -inf],
          [ 1.1889e+00,  5.3623e+00,  2.5835e+00, -1.8930e-01]],

         [[ 5.0669e-01,        -inf,        -inf,        -inf],
          [-3.2823e+00,  6.3702e+00,        -inf,        -inf],
          [-1.5145e+00, -3.5678e-01, -1.5606e+00,        -inf],
          [-1.8962e+00,  5.6198e-02,  2.2862e-01, -1.4159e-02]],

         [[ 1.3045e+00,        -inf,        -inf,        -inf],
          [-2.0937e+00,  1.2478e-01,        -inf,        -inf],
          [-1.2055e+00, -6.6727e-01,  5.2847e+00,        -inf],
          [ 2.2517e+00,  4.2538e+00, -3.2007e-02,  2.6468e+00]],

         [[ 5.8489e-02,        -inf,        -inf,        -inf],
          [-4.5242e+00,  3.3207e+00,        -inf,        -inf],
          [-2.1432e+00,  2.8501e+00,  1.9293e+00,        -inf],
          [-2.4116e+00,  3.0953e+00, -6.9842e-01,  9.8009e-01]],

         [[-4.6496e+00,        -inf,        -inf,        -inf],
          [ 2.0075e+00,  1.7568e+00,        -inf,        -inf],
          [-3.0449e+00,  6.6323e-01,  2.7524e+00,        -inf],
          [-1.0224e+00,  8.3457e-01,  9.0115e-01, -4.5959e+00]],

         [[-5.3891e-01,        -inf,        -inf,        -inf],
          [ 1.9879e+00,  1.7752e+00,        -inf,        -inf],
          [-2.3206e-01, -2.9684e+00,  2.6743e+00,        -inf],
          [ 1.1114e+00,  7.3679e-01,  9.7908e-01, -4.2434e+00]],

         [[ 5.1120e-01,        -inf,        -inf,        -inf],
          [-2.0542e+00,  1.9253e+00,        -inf,        -inf],
          [ 2.4692e-01,  2.8237e+00, -1.7827e-01,        -inf],
          [-2.4883e-01,  2.2779e+00,  3.4464e+00, -3.8055e+00]],

         [[-8.3151e-01,        -inf,        -inf,        -inf],
          [ 1.9703e+00,  2.4761e+00,        -inf,        -inf],
          [-1.1565e+00,  2.4200e+00,  1.3020e+00,        -inf],
          [ 2.3707e+00, -5.1966e+00, -6.6398e-01,  3.7064e+00]],

         [[ 3.5682e-01,        -inf,        -inf,        -inf],
          [-1.8102e+00, -2.8936e+00,        -inf,        -inf],
          [ 1.9799e+00,  2.6438e-01,  7.3039e-01,        -inf],
          [ 8.2087e-02, -2.4032e+00,  1.3987e+00, -6.7224e+00]],

         [[-3.3176e-02,        -inf,        -inf,        -inf],
          [-1.5836e+00, -8.1431e-01,        -inf,        -inf],
          [-5.3563e-01, -2.1671e+00, -2.8271e+00,        -inf],
          [-1.3342e+00, -2.4943e+00, -2.9998e+00,  5.2045e-02]],

         [[ 9.2108e-01,        -inf,        -inf,        -inf],
          [ 5.8534e-01,  1.0982e+00,        -inf,        -inf],
          [-1.8653e-01,  1.4801e+00,  3.4109e+00,        -inf],
          [ 6.2366e-01,  6.2656e-02,  2.5600e+00,  3.1908e+00]],

         [[-5.8444e+00,        -inf,        -inf,        -inf],
          [-1.9270e+00,  1.2044e+00,        -inf,        -inf],
          [-2.5660e+00, -1.4370e-01, -1.8966e+00,        -inf],
          [ 2.6027e-01, -2.5658e+00, -1.2692e+00,  1.1884e+00]],

         [[-6.5560e-01,        -inf,        -inf,        -inf],
          [-1.6746e+00,  2.2915e-01,        -inf,        -inf],
          [ 1.8327e+00, -6.5297e-01,  6.9494e-01,        -inf],
          [ 2.1982e+00, -2.3285e+00, -1.2983e+00,  1.5313e+00]],

         [[-2.5749e+00,        -inf,        -inf,        -inf],
          [-3.5796e+00, -1.0195e+00,        -inf,        -inf],
          [ 2.1144e+00, -4.0431e+00,  5.9296e+00,        -inf],
          [-2.4033e+00,  1.6363e+00, -3.4115e-01, -2.0026e+00]],

         [[ 2.3144e+00,        -inf,        -inf,        -inf],
          [ 4.9541e+00,  6.0480e+00,        -inf,        -inf],
          [ 2.3454e+00,  5.1202e+00,  1.0275e+00,        -inf],
          [ 1.0173e+00, -2.5110e+00, -6.6065e-01, -3.1073e+00]],

         [[ 5.8273e+00,        -inf,        -inf,        -inf],
          [ 1.1168e+00,  7.8745e-01,        -inf,        -inf],
          [ 2.4962e+00,  2.2756e+00,  2.0068e+00,        -inf],
          [ 4.7191e-01, -4.5608e-01, -6.8909e-02,  1.7766e-01]],

         [[-8.2240e-01,        -inf,        -inf,        -inf],
          [ 5.4019e+00,  3.6515e-01,        -inf,        -inf],
          [ 4.0331e+00,  3.4203e+00, -2.8858e+00,        -inf],
          [ 2.0844e+00,  1.4056e+00, -9.1670e-01, -2.5825e+00]],

         [[ 3.4895e+00,        -inf,        -inf,        -inf],
          [-1.3318e+00,  1.9052e+00,        -inf,        -inf],
          [ 4.0777e+00,  1.0032e+00,  1.0805e+00,        -inf],
          [ 3.4509e+00,  3.5691e+00, -2.5332e+00,  8.0667e-01]],

         [[ 1.3811e-01,        -inf,        -inf,        -inf],
          [-2.5887e+00,  2.0294e+00,        -inf,        -inf],
          [ 3.5555e+00, -2.8383e+00,  6.0957e-01,        -inf],
          [-3.9200e+00,  1.8227e+00,  5.5962e-02, -3.0830e+00]],

         [[-4.7027e-01,        -inf,        -inf,        -inf],
          [-2.4336e+00, -6.9587e+00,        -inf,        -inf],
          [-1.8994e+00,  1.6286e-01,  2.7787e+00,        -inf],
          [-1.7770e+00, -3.3212e+00,  2.7901e+00, -1.4748e+00]]],


        [[[ 1.0809e+00,        -inf,        -inf,        -inf],
          [ 1.7209e+00,  5.0018e-01,        -inf,        -inf],
          [-7.6198e-01,  7.7467e-02,  5.2667e+00,        -inf],
          [ 6.4647e-01,  1.8518e+00,  2.0092e+00,  1.3630e+00]],

         [[ 3.1661e-01,        -inf,        -inf,        -inf],
          [-1.6010e+00, -1.8194e+00,        -inf,        -inf],
          [ 2.5605e+00, -2.5829e+00,  1.3222e+00,        -inf],
          [-2.7097e+00,  4.2649e+00, -3.5125e+00,  2.7418e+00]],

         [[ 2.0318e+00,        -inf,        -inf,        -inf],
          [ 5.3824e+00,  1.8623e+00,        -inf,        -inf],
          [ 2.9139e+00, -1.8496e+00, -3.4466e+00,        -inf],
          [ 4.0854e+00,  1.9063e+00,  4.0032e-01, -2.8228e+00]],

         [[-2.1873e+00,        -inf,        -inf,        -inf],
          [-7.5399e+00, -2.1219e+00,        -inf,        -inf],
          [ 1.3728e+00, -9.5878e-01,  2.1780e+00,        -inf],
          [-2.9725e+00, -1.8426e+00,  9.8961e-01,  3.8984e+00]],

         [[ 3.7772e-01,        -inf,        -inf,        -inf],
          [-4.9913e+00, -4.7978e+00,        -inf,        -inf],
          [-2.7238e+00, -9.8685e-02, -2.7734e+00,        -inf],
          [-4.8143e+00, -2.8501e+00, -9.6580e-01,  1.7480e+00]],

         [[ 5.5499e+00,        -inf,        -inf,        -inf],
          [ 3.0729e+00,  2.5095e+00,        -inf,        -inf],
          [ 2.2268e+00,  4.7473e+00,  5.3308e+00,        -inf],
          [ 5.8212e+00,  3.6020e+00,  1.9021e+00,  2.7043e+00]],

         [[ 1.2940e+00,        -inf,        -inf,        -inf],
          [ 3.1286e-01,  2.8391e+00,        -inf,        -inf],
          [ 4.9119e-02,  1.8907e+00,  2.9671e+00,        -inf],
          [-2.0150e-01, -3.0321e+00,  2.4844e+00,  3.6750e+00]],

         [[-1.0075e+00,        -inf,        -inf,        -inf],
          [-2.1094e+00,  2.4845e-01,        -inf,        -inf],
          [-2.1086e-02, -2.3575e+00, -2.6079e+00,        -inf],
          [-3.4689e+00,  1.4088e+00,  3.1170e+00, -2.4248e+00]],

         [[ 7.7689e-01,        -inf,        -inf,        -inf],
          [-3.6189e+00,  3.8193e-01,        -inf,        -inf],
          [-1.5482e+00, -8.4734e-01, -6.3315e+00,        -inf],
          [-3.5344e+00,  5.5147e+00,  2.5440e+00, -5.0426e-01]],

         [[-5.4875e+00,        -inf,        -inf,        -inf],
          [ 2.6399e+00, -1.8298e+00,        -inf,        -inf],
          [-2.7168e-01, -1.6041e+00,  5.0015e-01,        -inf],
          [-3.1073e+00, -1.7777e+00,  2.4721e+00,  2.1912e+00]],

         [[-1.7910e+00,        -inf,        -inf,        -inf],
          [ 3.5674e-01, -2.7187e+00,        -inf,        -inf],
          [-1.5798e+00,  1.8316e+00,  1.9325e+00,        -inf],
          [-7.7279e-01, -4.4082e-01, -6.2463e-01, -1.2969e+00]],

         [[-6.0322e-01,        -inf,        -inf,        -inf],
          [-3.9492e-01,  4.3593e+00,        -inf,        -inf],
          [-4.3147e+00, -6.7097e-01,  3.3860e-01,        -inf],
          [-2.4053e-02,  9.6319e-02, -2.0002e-01,  1.6486e+00]],

         [[-2.8748e-01,        -inf,        -inf,        -inf],
          [ 1.2914e-01,  5.5262e-01,        -inf,        -inf],
          [-7.8082e-01, -2.4192e+00, -6.2808e-01,        -inf],
          [-1.7131e+00,  2.4538e+00, -1.3393e+00,  5.6594e-01]],

         [[-2.1729e+00,        -inf,        -inf,        -inf],
          [-1.6062e+00, -5.2848e-01,        -inf,        -inf],
          [ 1.0275e+00, -3.0324e+00, -1.6342e+00,        -inf],
          [-6.6807e-01,  8.7115e-01,  5.1012e-01, -3.9080e+00]],

         [[-2.6914e+00,        -inf,        -inf,        -inf],
          [-1.8234e+00, -1.3704e+00,        -inf,        -inf],
          [ 1.1332e+00,  3.0845e+00, -2.2620e+00,        -inf],
          [-8.3503e-01, -1.4785e+00,  5.9848e-01,  3.5028e+00]],

         [[ 2.5041e+00,        -inf,        -inf,        -inf],
          [ 3.1712e-01, -3.4697e+00,        -inf,        -inf],
          [-3.9332e+00, -2.4598e+00,  1.2329e+00,        -inf],
          [ 3.7192e-01,  2.0493e-01,  3.3763e+00,  9.6109e-01]],

         [[-7.6328e+00,        -inf,        -inf,        -inf],
          [-2.3786e+00, -2.4913e-01,        -inf,        -inf],
          [ 1.6736e+00,  4.2599e-02,  3.7067e+00,        -inf],
          [ 4.1411e+00,  3.7135e+00, -8.8671e-02,  4.9117e-01]],

         [[ 9.0043e-01,        -inf,        -inf,        -inf],
          [-3.9494e+00,  2.8256e+00,        -inf,        -inf],
          [ 1.7021e+00, -1.9812e+00, -1.5637e+00,        -inf],
          [-1.8662e+00,  6.8420e-01,  5.0987e+00, -1.6052e+00]],

         [[-3.7509e+00,        -inf,        -inf,        -inf],
          [-5.3444e+00, -1.0469e+00,        -inf,        -inf],
          [-2.2707e+00, -3.2862e+00,  1.6480e+00,        -inf],
          [ 6.6694e-01, -8.3932e+00,  2.6655e-01, -4.3680e+00]],

         [[ 3.2586e-01,        -inf,        -inf,        -inf],
          [ 5.3582e-01, -8.8339e-01,        -inf,        -inf],
          [ 2.0795e+00,  3.5978e+00, -7.7006e+00,        -inf],
          [ 7.1433e-01, -9.3292e-01,  8.2081e-01, -1.9270e+00]],

         [[ 5.0372e+00,        -inf,        -inf,        -inf],
          [ 1.9671e+00,  6.1372e+00,        -inf,        -inf],
          [ 4.4719e+00,  3.3893e+00,  3.2457e+00,        -inf],
          [ 3.9139e+00,  2.0246e+00,  6.3857e-01, -2.0884e-01]],

         [[ 1.0173e+00,        -inf,        -inf,        -inf],
          [ 3.7541e+00,  1.1484e+00,        -inf,        -inf],
          [ 2.4518e+00,  3.7847e+00,  5.3426e+00,        -inf],
          [-2.2681e+00,  2.6802e-03,  1.4481e+00,  1.2069e+00]],

         [[ 2.5102e+00,        -inf,        -inf,        -inf],
          [-2.3552e-01, -1.6064e+00,        -inf,        -inf],
          [ 4.8280e+00,  3.6871e+00,  1.0129e+00,        -inf],
          [ 8.8652e-01, -3.7726e-01, -3.7942e+00,  4.8679e-01]],

         [[-5.8723e-01,        -inf,        -inf,        -inf],
          [-2.5173e+00,  4.0047e+00,        -inf,        -inf],
          [ 7.7166e+00,  1.0625e+00,  3.4574e+00,        -inf],
          [-3.7946e+00, -2.7029e+00, -3.7448e+00,  2.6942e+00]],

         [[ 1.7702e+00,        -inf,        -inf,        -inf],
          [ 3.7218e+00,  1.1824e+00,        -inf,        -inf],
          [-2.8558e+00, -1.4702e+00,  1.4502e+00,        -inf],
          [ 5.6708e-01, -4.9162e-01,  3.9052e+00, -7.1444e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-8.8507e-01,        -inf,        -inf,        -inf],
          [ 1.7257e-01,  1.5387e+00,        -inf,        -inf],
          [-4.6570e+00,  1.3332e+00, -2.4823e+00,        -inf],
          [ 2.0453e+00,  8.2234e-01,  3.6430e-01,  2.2346e+00]],

         [[ 2.7421e+00,        -inf,        -inf,        -inf],
          [-7.6395e-01,  2.6309e+00,        -inf,        -inf],
          [-1.3740e+00, -2.9162e+00,  2.4481e+00,        -inf],
          [ 1.7463e+00,  7.8696e-01,  4.1831e-01,  3.5487e+00]],

         [[ 1.7317e+00,        -inf,        -inf,        -inf],
          [ 3.5481e+00,  2.8159e+00,        -inf,        -inf],
          [ 1.5083e-01,  7.1260e-01,  8.0884e-01,        -inf],
          [ 6.9774e-01, -1.5403e+00, -2.1756e+00, -3.1093e+00]],

         [[ 6.6634e-01,        -inf,        -inf,        -inf],
          [ 9.7498e-01, -1.7951e+00,        -inf,        -inf],
          [ 1.4046e+00, -1.9975e+00,  2.2518e-01,        -inf],
          [-1.2762e+00,  4.9085e+00,  8.9976e-01,  4.3261e-01]],

         [[-2.4506e+00,        -inf,        -inf,        -inf],
          [-5.4635e-02,  4.2589e-01,        -inf,        -inf],
          [-3.3188e+00, -2.6366e+00, -2.2193e+00,        -inf],
          [-1.5352e+00, -2.2066e+00, -5.1029e+00, -1.0782e+00]],

         [[ 6.8967e+00,        -inf,        -inf,        -inf],
          [-2.7710e+00,  8.7118e-01,        -inf,        -inf],
          [-1.6403e+00,  4.2110e+00,  7.1419e+00,        -inf],
          [ 1.1889e+00,  5.3623e+00,  2.5835e+00, -1.8930e-01]],

         [[ 5.0669e-01,        -inf,        -inf,        -inf],
          [-3.2823e+00,  6.3702e+00,        -inf,        -inf],
          [-1.5145e+00, -3.5678e-01, -1.5606e+00,        -inf],
          [-1.8962e+00,  5.6198e-02,  2.2862e-01, -1.4159e-02]],

         [[ 1.3045e+00,        -inf,        -inf,        -inf],
          [-2.0937e+00,  1.2478e-01,        -inf,        -inf],
          [-1.2055e+00, -6.6727e-01,  5.2847e+00,        -inf],
          [ 2.2517e+00,  4.2538e+00, -3.2007e-02,  2.6468e+00]],

         [[ 5.8489e-02,        -inf,        -inf,        -inf],
          [-4.5242e+00,  3.3207e+00,        -inf,        -inf],
          [-2.1432e+00,  2.8501e+00,  1.9293e+00,        -inf],
          [-2.4116e+00,  3.0953e+00, -6.9842e-01,  9.8009e-01]],

         [[-4.6496e+00,        -inf,        -inf,        -inf],
          [ 2.0075e+00,  1.7568e+00,        -inf,        -inf],
          [-3.0449e+00,  6.6323e-01,  2.7524e+00,        -inf],
          [-1.0224e+00,  8.3457e-01,  9.0115e-01, -4.5959e+00]],

         [[-5.3891e-01,        -inf,        -inf,        -inf],
          [ 1.9879e+00,  1.7752e+00,        -inf,        -inf],
          [-2.3206e-01, -2.9684e+00,  2.6743e+00,        -inf],
          [ 1.1114e+00,  7.3679e-01,  9.7908e-01, -4.2434e+00]],

         [[ 5.1120e-01,        -inf,        -inf,        -inf],
          [-2.0542e+00,  1.9253e+00,        -inf,        -inf],
          [ 2.4692e-01,  2.8237e+00, -1.7827e-01,        -inf],
          [-2.4883e-01,  2.2779e+00,  3.4464e+00, -3.8055e+00]],

         [[-8.3151e-01,        -inf,        -inf,        -inf],
          [ 1.9703e+00,  2.4761e+00,        -inf,        -inf],
          [-1.1565e+00,  2.4200e+00,  1.3020e+00,        -inf],
          [ 2.3707e+00, -5.1966e+00, -6.6398e-01,  3.7064e+00]],

         [[ 3.5682e-01,        -inf,        -inf,        -inf],
          [-1.8102e+00, -2.8936e+00,        -inf,        -inf],
          [ 1.9799e+00,  2.6438e-01,  7.3039e-01,        -inf],
          [ 8.2087e-02, -2.4032e+00,  1.3987e+00, -6.7224e+00]],

         [[-3.3176e-02,        -inf,        -inf,        -inf],
          [-1.5836e+00, -8.1431e-01,        -inf,        -inf],
          [-5.3563e-01, -2.1671e+00, -2.8271e+00,        -inf],
          [-1.3342e+00, -2.4943e+00, -2.9998e+00,  5.2045e-02]],

         [[ 9.2108e-01,        -inf,        -inf,        -inf],
          [ 5.8534e-01,  1.0982e+00,        -inf,        -inf],
          [-1.8653e-01,  1.4801e+00,  3.4109e+00,        -inf],
          [ 6.2366e-01,  6.2656e-02,  2.5600e+00,  3.1908e+00]],

         [[-5.8444e+00,        -inf,        -inf,        -inf],
          [-1.9270e+00,  1.2044e+00,        -inf,        -inf],
          [-2.5660e+00, -1.4370e-01, -1.8966e+00,        -inf],
          [ 2.6027e-01, -2.5658e+00, -1.2692e+00,  1.1884e+00]],

         [[-6.5560e-01,        -inf,        -inf,        -inf],
          [-1.6746e+00,  2.2915e-01,        -inf,        -inf],
          [ 1.8327e+00, -6.5297e-01,  6.9494e-01,        -inf],
          [ 2.1982e+00, -2.3285e+00, -1.2983e+00,  1.5313e+00]],

         [[-2.5749e+00,        -inf,        -inf,        -inf],
          [-3.5796e+00, -1.0195e+00,        -inf,        -inf],
          [ 2.1144e+00, -4.0431e+00,  5.9296e+00,        -inf],
          [-2.4033e+00,  1.6363e+00, -3.4115e-01, -2.0026e+00]],

         [[ 2.3144e+00,        -inf,        -inf,        -inf],
          [ 4.9541e+00,  6.0480e+00,        -inf,        -inf],
          [ 2.3454e+00,  5.1202e+00,  1.0275e+00,        -inf],
          [ 1.0173e+00, -2.5110e+00, -6.6065e-01, -3.1073e+00]],

         [[ 5.8273e+00,        -inf,        -inf,        -inf],
          [ 1.1168e+00,  7.8745e-01,        -inf,        -inf],
          [ 2.4962e+00,  2.2756e+00,  2.0068e+00,        -inf],
          [ 4.7191e-01, -4.5608e-01, -6.8909e-02,  1.7766e-01]],

         [[-8.2240e-01,        -inf,        -inf,        -inf],
          [ 5.4019e+00,  3.6515e-01,        -inf,        -inf],
          [ 4.0331e+00,  3.4203e+00, -2.8858e+00,        -inf],
          [ 2.0844e+00,  1.4056e+00, -9.1670e-01, -2.5825e+00]],

         [[ 3.4895e+00,        -inf,        -inf,        -inf],
          [-1.3318e+00,  1.9052e+00,        -inf,        -inf],
          [ 4.0777e+00,  1.0032e+00,  1.0805e+00,        -inf],
          [ 3.4509e+00,  3.5691e+00, -2.5332e+00,  8.0667e-01]],

         [[ 1.3811e-01,        -inf,        -inf,        -inf],
          [-2.5887e+00,  2.0294e+00,        -inf,        -inf],
          [ 3.5555e+00, -2.8383e+00,  6.0957e-01,        -inf],
          [-3.9200e+00,  1.8227e+00,  5.5962e-02, -3.0830e+00]],

         [[-4.7027e-01,        -inf,        -inf,        -inf],
          [-2.4336e+00, -6.9587e+00,        -inf,        -inf],
          [-1.8994e+00,  1.6286e-01,  2.7787e+00,        -inf],
          [-1.7770e+00, -3.3212e+00,  2.7901e+00, -1.4748e+00]]],


        [[[ 1.0809e+00,        -inf,        -inf,        -inf],
          [ 1.7209e+00,  5.0018e-01,        -inf,        -inf],
          [-7.6198e-01,  7.7467e-02,  5.2667e+00,        -inf],
          [ 6.4647e-01,  1.8518e+00,  2.0092e+00,  1.3630e+00]],

         [[ 3.1661e-01,        -inf,        -inf,        -inf],
          [-1.6010e+00, -1.8194e+00,        -inf,        -inf],
          [ 2.5605e+00, -2.5829e+00,  1.3222e+00,        -inf],
          [-2.7097e+00,  4.2649e+00, -3.5125e+00,  2.7418e+00]],

         [[ 2.0318e+00,        -inf,        -inf,        -inf],
          [ 5.3824e+00,  1.8623e+00,        -inf,        -inf],
          [ 2.9139e+00, -1.8496e+00, -3.4466e+00,        -inf],
          [ 4.0854e+00,  1.9063e+00,  4.0032e-01, -2.8228e+00]],

         [[-2.1873e+00,        -inf,        -inf,        -inf],
          [-7.5399e+00, -2.1219e+00,        -inf,        -inf],
          [ 1.3728e+00, -9.5878e-01,  2.1780e+00,        -inf],
          [-2.9725e+00, -1.8426e+00,  9.8961e-01,  3.8984e+00]],

         [[ 3.7772e-01,        -inf,        -inf,        -inf],
          [-4.9913e+00, -4.7978e+00,        -inf,        -inf],
          [-2.7238e+00, -9.8685e-02, -2.7734e+00,        -inf],
          [-4.8143e+00, -2.8501e+00, -9.6580e-01,  1.7480e+00]],

         [[ 5.5499e+00,        -inf,        -inf,        -inf],
          [ 3.0729e+00,  2.5095e+00,        -inf,        -inf],
          [ 2.2268e+00,  4.7473e+00,  5.3308e+00,        -inf],
          [ 5.8212e+00,  3.6020e+00,  1.9021e+00,  2.7043e+00]],

         [[ 1.2940e+00,        -inf,        -inf,        -inf],
          [ 3.1286e-01,  2.8391e+00,        -inf,        -inf],
          [ 4.9119e-02,  1.8907e+00,  2.9671e+00,        -inf],
          [-2.0150e-01, -3.0321e+00,  2.4844e+00,  3.6750e+00]],

         [[-1.0075e+00,        -inf,        -inf,        -inf],
          [-2.1094e+00,  2.4845e-01,        -inf,        -inf],
          [-2.1086e-02, -2.3575e+00, -2.6079e+00,        -inf],
          [-3.4689e+00,  1.4088e+00,  3.1170e+00, -2.4248e+00]],

         [[ 7.7689e-01,        -inf,        -inf,        -inf],
          [-3.6189e+00,  3.8193e-01,        -inf,        -inf],
          [-1.5482e+00, -8.4734e-01, -6.3315e+00,        -inf],
          [-3.5344e+00,  5.5147e+00,  2.5440e+00, -5.0426e-01]],

         [[-5.4875e+00,        -inf,        -inf,        -inf],
          [ 2.6399e+00, -1.8298e+00,        -inf,        -inf],
          [-2.7168e-01, -1.6041e+00,  5.0015e-01,        -inf],
          [-3.1073e+00, -1.7777e+00,  2.4721e+00,  2.1912e+00]],

         [[-1.7910e+00,        -inf,        -inf,        -inf],
          [ 3.5674e-01, -2.7187e+00,        -inf,        -inf],
          [-1.5798e+00,  1.8316e+00,  1.9325e+00,        -inf],
          [-7.7279e-01, -4.4082e-01, -6.2463e-01, -1.2969e+00]],

         [[-6.0322e-01,        -inf,        -inf,        -inf],
          [-3.9492e-01,  4.3593e+00,        -inf,        -inf],
          [-4.3147e+00, -6.7097e-01,  3.3860e-01,        -inf],
          [-2.4053e-02,  9.6319e-02, -2.0002e-01,  1.6486e+00]],

         [[-2.8748e-01,        -inf,        -inf,        -inf],
          [ 1.2914e-01,  5.5262e-01,        -inf,        -inf],
          [-7.8082e-01, -2.4192e+00, -6.2808e-01,        -inf],
          [-1.7131e+00,  2.4538e+00, -1.3393e+00,  5.6594e-01]],

         [[-2.1729e+00,        -inf,        -inf,        -inf],
          [-1.6062e+00, -5.2848e-01,        -inf,        -inf],
          [ 1.0275e+00, -3.0324e+00, -1.6342e+00,        -inf],
          [-6.6807e-01,  8.7115e-01,  5.1012e-01, -3.9080e+00]],

         [[-2.6914e+00,        -inf,        -inf,        -inf],
          [-1.8234e+00, -1.3704e+00,        -inf,        -inf],
          [ 1.1332e+00,  3.0845e+00, -2.2620e+00,        -inf],
          [-8.3503e-01, -1.4785e+00,  5.9848e-01,  3.5028e+00]],

         [[ 2.5041e+00,        -inf,        -inf,        -inf],
          [ 3.1712e-01, -3.4697e+00,        -inf,        -inf],
          [-3.9332e+00, -2.4598e+00,  1.2329e+00,        -inf],
          [ 3.7192e-01,  2.0493e-01,  3.3763e+00,  9.6109e-01]],

         [[-7.6328e+00,        -inf,        -inf,        -inf],
          [-2.3786e+00, -2.4913e-01,        -inf,        -inf],
          [ 1.6736e+00,  4.2599e-02,  3.7067e+00,        -inf],
          [ 4.1411e+00,  3.7135e+00, -8.8671e-02,  4.9117e-01]],

         [[ 9.0043e-01,        -inf,        -inf,        -inf],
          [-3.9494e+00,  2.8256e+00,        -inf,        -inf],
          [ 1.7021e+00, -1.9812e+00, -1.5637e+00,        -inf],
          [-1.8662e+00,  6.8420e-01,  5.0987e+00, -1.6052e+00]],

         [[-3.7509e+00,        -inf,        -inf,        -inf],
          [-5.3444e+00, -1.0469e+00,        -inf,        -inf],
          [-2.2707e+00, -3.2862e+00,  1.6480e+00,        -inf],
          [ 6.6694e-01, -8.3932e+00,  2.6655e-01, -4.3680e+00]],

         [[ 3.2586e-01,        -inf,        -inf,        -inf],
          [ 5.3582e-01, -8.8339e-01,        -inf,        -inf],
          [ 2.0795e+00,  3.5978e+00, -7.7006e+00,        -inf],
          [ 7.1433e-01, -9.3292e-01,  8.2081e-01, -1.9270e+00]],

         [[ 5.0372e+00,        -inf,        -inf,        -inf],
          [ 1.9671e+00,  6.1372e+00,        -inf,        -inf],
          [ 4.4719e+00,  3.3893e+00,  3.2457e+00,        -inf],
          [ 3.9139e+00,  2.0246e+00,  6.3857e-01, -2.0884e-01]],

         [[ 1.0173e+00,        -inf,        -inf,        -inf],
          [ 3.7541e+00,  1.1484e+00,        -inf,        -inf],
          [ 2.4518e+00,  3.7847e+00,  5.3426e+00,        -inf],
          [-2.2681e+00,  2.6802e-03,  1.4481e+00,  1.2069e+00]],

         [[ 2.5102e+00,        -inf,        -inf,        -inf],
          [-2.3552e-01, -1.6064e+00,        -inf,        -inf],
          [ 4.8280e+00,  3.6871e+00,  1.0129e+00,        -inf],
          [ 8.8652e-01, -3.7726e-01, -3.7942e+00,  4.8679e-01]],

         [[-5.8723e-01,        -inf,        -inf,        -inf],
          [-2.5173e+00,  4.0047e+00,        -inf,        -inf],
          [ 7.7166e+00,  1.0625e+00,  3.4574e+00,        -inf],
          [-3.7946e+00, -2.7029e+00, -3.7448e+00,  2.6942e+00]],

         [[ 1.7702e+00,        -inf,        -inf,        -inf],
          [ 3.7218e+00,  1.1824e+00,        -inf,        -inf],
          [-2.8558e+00, -1.4702e+00,  1.4502e+00,        -inf],
          [ 5.6708e-01, -4.9162e-01,  3.9052e+00, -7.1444e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 1.0027,  0.2623, -1.2827,  ...,  0.6528, -0.8865, -0.3594],
          [-0.8739,  0.3525, -0.8380,  ...,  0.5433,  1.0016, -0.1615],
          ...,
          [-0.6459,  0.9878,  0.1373,  ...,  0.6403, -0.0482, -0.3886],
          [ 0.1507,  0.2458, -0.5726,  ..., -0.5252,  0.0369, -0.5452],
          [ 0.8683,  0.6136,  0.1669,  ...,  0.1810,  1.0682, -1.1444]],

         [[ 0.3715,  0.3534, -0.2683,  ...,  0.2115,  0.8320, -0.0877],
          [ 0.2064,  0.4475, -0.7415,  ...,  0.7175, -0.2069, -0.3301],
          [-0.5955, -0.0222, -0.2447,  ...,  0.0297,  0.0377, -0.3177],
          ...,
          [ 0.0561,  1.0711,  0.5594,  ...,  1.1241,  0.6745, -0.2561],
          [ 0.0022,  0.2902, -0.2222,  ...,  0.1515, -0.4200, -1.1993],
          [ 0.7025,  0.4423,  0.1074,  ..., -0.0281,  1.0891, -0.8784]],

         [[ 0.1515,  0.6964,  0.0589,  ...,  0.7027,  0.8232,  0.3426],
          [ 0.4379, -0.0566,  0.0882,  ..., -0.1086,  0.5339,  0.0310],
          [-0.4923, -0.0976,  0.0565,  ...,  0.1117,  0.0165, -0.2943],
          ...,
          [ 0.0351,  0.9866,  0.2200,  ...,  0.8037,  0.2100,  0.1260],
          [ 0.0533,  0.1809, -0.2727,  ..., -0.1337, -0.1248, -0.5835],
          [ 0.8398,  0.4254,  0.4746,  ...,  0.4510,  0.9519, -0.2513]],

         [[ 0.0348,  0.7992,  0.2133,  ...,  0.6888,  0.8297, -0.0267],
          [ 0.5752, -0.1119, -0.0154,  ...,  0.2121,  0.1145,  0.0868],
          [-0.7484,  0.1574, -0.0226,  ...,  0.1206,  0.1188, -0.2817],
          ...,
          [-0.0312,  0.9907,  0.2657,  ...,  0.9942,  0.6089, -0.2969],
          [ 0.0305,  0.2166, -0.0287,  ...,  0.1418,  0.3047, -0.9624],
          [ 0.7426,  0.2973,  0.4612,  ...,  0.1756,  1.1044, -0.2149]]],


        [[[ 0.5101,  0.0569,  0.0768,  ...,  0.2009,  1.1373, -0.3120],
          [ 1.3774,  0.0828, -1.0258,  ...,  0.1123, -0.2296, -0.2933],
          [-0.8065, -0.1097, -0.5560,  ..., -0.2326,  1.1616,  0.1578],
          ...,
          [-0.5648,  0.8152, -0.1493,  ...,  0.3982,  0.1175, -0.5762],
          [ 0.1677,  0.3871, -1.0602,  ..., -0.6809,  0.2016, -0.6158],
          [ 1.0314,  0.8058, -0.0541,  ...,  0.4190,  1.0205, -0.4337]],

         [[ 0.5985,  0.1617,  0.2124,  ...,  0.4908,  0.6930,  0.3960],
          [ 0.5947,  0.2052, -0.7180,  ...,  0.3863,  0.0029, -0.1221],
          [-0.4477, -0.3781, -0.1320,  ..., -0.0685,  1.2104,  0.0917],
          ...,
          [-0.3065,  0.4425, -0.0810,  ...,  0.2161,  0.0638, -0.3127],
          [-0.3916,  0.4070, -0.1839,  ..., -0.8169, -0.2070, -0.8558],
          [ 0.7041,  0.8057, -0.3001,  ...,  0.1074,  0.7999,  0.0184]],

         [[ 0.6328,  0.0333,  0.6960,  ...,  0.6506,  0.9787,  0.0657],
          [ 0.7720, -0.0201, -0.4798,  ..., -0.2271,  0.0476, -0.3403],
          [-0.1653, -0.5578,  0.1910,  ..., -0.1661,  0.9409, -0.0429],
          ...,
          [-0.2198,  0.4580,  0.0673,  ...,  0.3238,  0.1511, -0.1761],
          [ 0.2198,  0.5440, -0.5682,  ..., -0.5906, -0.0281, -0.6250],
          [ 0.7546,  0.5608,  0.1449,  ...,  0.2398,  1.1891,  0.2158]],

         [[ 0.3979,  0.3623,  0.4027,  ...,  0.5185,  0.5223, -0.0994],
          [ 0.1863,  0.1412, -0.1726,  ...,  0.2499,  0.1259, -0.1020],
          [-0.0943, -0.5136,  0.3019,  ...,  0.0162,  0.8022,  0.0482],
          ...,
          [-0.3504, -0.1479,  0.3617,  ...,  0.3758,  0.1995, -0.3096],
          [-0.1081,  0.6767, -0.0863,  ..., -0.4023, -0.1193, -0.5852],
          [ 0.6008,  0.2593,  0.1341,  ...,  0.0609,  1.0956,  0.1387]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.0000,  0.0000,  0.0000,  ...,  0.1810,  1.0682, -1.1444],
         [ 0.3715,  0.3534, -0.2683,  ..., -0.0281,  1.0891, -0.8784],
         [ 0.1515,  0.6964,  0.0589,  ...,  0.4510,  0.9519, -0.2513],
         [ 0.0348,  0.7992,  0.2133,  ...,  0.1756,  1.1044, -0.2149]],

        [[ 0.5101,  0.0569,  0.0768,  ...,  0.4190,  1.0205, -0.4337],
         [ 0.5985,  0.1617,  0.2124,  ...,  0.1074,  0.7999,  0.0184],
         [ 0.6328,  0.0333,  0.6960,  ...,  0.2398,  1.1891,  0.2158],
         [ 0.3979,  0.3623,  0.4027,  ...,  0.0609,  1.0956,  0.1387]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.3177, -0.7520, -0.5616,  ..., -0.2002,  0.2270,  0.1650],
         [ 0.0086, -0.2565,  0.0030,  ...,  0.1767, -0.0571,  0.3151],
         [ 0.0549,  0.0031, -0.0813,  ...,  0.0352,  0.1825,  0.1219],
         [ 0.1309, -0.1623, -0.2901,  ...,  0.1082,  0.0897,  0.0503]],

        [[-0.3157, -0.6101, -0.3540,  ..., -0.3965, -0.0727,  0.0594],
         [-0.2306, -0.4301,  0.3665,  ..., -0.2813, -0.0622,  0.4819],
         [-0.0706, -0.4340,  0.0211,  ..., -0.2992,  0.0157,  0.2746],
         [ 0.1202, -0.3577, -0.1512,  ..., -0.2277,  0.0155,  0.0567]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.2981,    -inf,    -inf,    -inf],
          [-2.9624,  2.2883,    -inf,    -inf],
          [ 4.0827, -4.7345,  3.7245,    -inf],
          [ 4.6830,  5.9955, -1.2728,  1.3511]],

         [[ 0.5192,    -inf,    -inf,    -inf],
          [-0.1325, -1.6400,    -inf,    -inf],
          [-1.1904,  2.9354,  2.5503,    -inf],
          [-0.0297,  1.5523,  1.3947, -4.3096]],

         [[ 0.2200,    -inf,    -inf,    -inf],
          [-0.3115,  2.7804,    -inf,    -inf],
          [-0.7718, -2.1286,  2.7850,    -inf],
          [-0.8808, -2.2853, -2.1344,  0.8467]],

         [[-0.3499,    -inf,    -inf,    -inf],
          [ 1.3868, -2.9675,    -inf,    -inf],
          [ 0.0630, -4.1057,  3.2724,    -inf],
          [-1.9306, -1.1974, -2.7539, -5.7562]],

         [[-3.3395,    -inf,    -inf,    -inf],
          [-2.5301,  0.3005,    -inf,    -inf],
          [ 0.2209, -0.3722, -1.0516,    -inf],
          [-3.4242, -1.5078,  3.8530, -5.8917]],

         [[ 1.5875,    -inf,    -inf,    -inf],
          [-0.1198, -1.0473,    -inf,    -inf],
          [ 4.7533, -2.5991,  0.9854,    -inf],
          [ 0.6211,  0.0962, -0.0381, -1.1779]],

         [[ 2.3640,    -inf,    -inf,    -inf],
          [ 2.5433, -2.0397,    -inf,    -inf],
          [ 0.7201,  0.1837, -2.6463,    -inf],
          [ 0.3557, -3.9128, -3.3418, -0.2459]],

         [[ 1.2495,    -inf,    -inf,    -inf],
          [-0.8775, -5.0318,    -inf,    -inf],
          [ 1.4064,  1.3294, -0.7875,    -inf],
          [ 1.9932,  1.4872, -1.0955, -2.6445]],

         [[-5.6792,    -inf,    -inf,    -inf],
          [ 1.4563,  0.7404,    -inf,    -inf],
          [ 0.1791,  1.6591, -0.7113,    -inf],
          [-3.7689,  0.4530,  1.0971, -3.5644]],

         [[-0.3788,    -inf,    -inf,    -inf],
          [ 2.6002,  4.0632,    -inf,    -inf],
          [ 1.3512,  2.7351,  2.1330,    -inf],
          [-0.7711,  2.5755, -3.0161, -1.0604]],

         [[-5.3317,    -inf,    -inf,    -inf],
          [-3.4642,  2.9553,    -inf,    -inf],
          [ 1.0688,  0.5179,  0.9141,    -inf],
          [-5.2974, -2.5679, -0.1124,  1.1131]],

         [[-0.0775,    -inf,    -inf,    -inf],
          [-2.0198, -4.0990,    -inf,    -inf],
          [-0.0639, -1.4735,  1.5482,    -inf],
          [-3.2975, -2.0221, -1.3362, -3.3386]],

         [[ 0.6430,    -inf,    -inf,    -inf],
          [-4.2691, -7.1964,    -inf,    -inf],
          [ 1.4729, -1.0252, -1.1480,    -inf],
          [ 3.6347,  1.5775, -0.9376,  1.6505]],

         [[ 5.3499,    -inf,    -inf,    -inf],
          [-0.4928, -0.0321,    -inf,    -inf],
          [-3.8456, -1.4481, -3.5215,    -inf],
          [-4.4908, -1.2398, -1.0931, -7.6517]],

         [[ 0.7733,    -inf,    -inf,    -inf],
          [-0.0676, -0.1295,    -inf,    -inf],
          [-2.2029, -1.7362, -1.9740,    -inf],
          [-0.1326,  2.5434, -0.7650,  2.5921]],

         [[-2.7927,    -inf,    -inf,    -inf],
          [ 4.5720,  3.7662,    -inf,    -inf],
          [-3.6829,  1.3209,  4.0221,    -inf],
          [-1.7773, -0.1429,  1.8057,  2.6783]],

         [[-1.9624,    -inf,    -inf,    -inf],
          [-0.2685,  1.9123,    -inf,    -inf],
          [ 1.7160,  2.3669, -4.8653,    -inf],
          [-3.5231,  3.8699, -3.8546, -2.3865]],

         [[ 0.8610,    -inf,    -inf,    -inf],
          [ 3.2716,  2.9797,    -inf,    -inf],
          [ 4.9522,  0.0311, -1.1820,    -inf],
          [ 1.2247, -0.4400,  0.9147,  2.4192]],

         [[-3.5850,    -inf,    -inf,    -inf],
          [-3.1125, -1.3479,    -inf,    -inf],
          [ 0.7624,  2.8464, -2.9740,    -inf],
          [ 0.3252,  0.0714,  2.1752,  1.2764]],

         [[ 3.2871,    -inf,    -inf,    -inf],
          [-0.2115, -0.2232,    -inf,    -inf],
          [ 1.3361, -1.5792, -0.8254,    -inf],
          [ 3.2787,  2.7698, -0.3260, -3.0088]],

         [[ 1.5017,    -inf,    -inf,    -inf],
          [-2.9870,  3.0598,    -inf,    -inf],
          [-2.2950, -0.1458, -1.8684,    -inf],
          [-3.1431, -0.6717, -1.7272,  1.8430]],

         [[-0.0584,    -inf,    -inf,    -inf],
          [-2.5388,  2.7813,    -inf,    -inf],
          [ 0.7251, -5.0488,  2.2179,    -inf],
          [ 0.8956,  1.5228, -0.9611, -0.3271]],

         [[ 6.1095,    -inf,    -inf,    -inf],
          [-0.4188, -0.0495,    -inf,    -inf],
          [ 4.0540,  6.1060,  0.0248,    -inf],
          [-3.1942, -2.0395,  0.1709, -5.4670]],

         [[ 5.1084,    -inf,    -inf,    -inf],
          [-0.9931,  1.9708,    -inf,    -inf],
          [-2.9665,  5.9175, -0.3554,    -inf],
          [-3.8909,  0.4088,  0.7819, -1.4476]],

         [[ 3.7074,    -inf,    -inf,    -inf],
          [ 3.4962,  0.9430,    -inf,    -inf],
          [ 2.9002,  0.9524,  0.0614,    -inf],
          [-5.1601,  3.5552,  1.1042,  1.8955]]],


        [[[ 3.0104,    -inf,    -inf,    -inf],
          [ 1.9110,  2.9336,    -inf,    -inf],
          [ 2.5249,  4.8520,  0.1923,    -inf],
          [ 1.8877,  1.5978, -2.4086,  2.3320]],

         [[ 0.3171,    -inf,    -inf,    -inf],
          [ 2.5859, -4.2195,    -inf,    -inf],
          [ 3.0274,  4.1928,  1.6400,    -inf],
          [ 4.2073,  0.6182, -2.2800,  3.0252]],

         [[-1.6350,    -inf,    -inf,    -inf],
          [ 0.0818, -2.6698,    -inf,    -inf],
          [ 0.1333, -4.7107, -1.8689,    -inf],
          [-0.3168, -0.1844,  2.5524,  7.6079]],

         [[-1.7342,    -inf,    -inf,    -inf],
          [-0.5408,  4.7035,    -inf,    -inf],
          [ 2.7512,  1.0222,  2.8894,    -inf],
          [-2.4499, -5.5004, -2.7588, -2.1112]],

         [[-4.5197,    -inf,    -inf,    -inf],
          [-0.8751,  1.6027,    -inf,    -inf],
          [-0.1122, -1.6549, -2.1311,    -inf],
          [-1.5850, -1.6490,  0.7502,  0.0571]],

         [[ 3.9596,    -inf,    -inf,    -inf],
          [ 0.0316,  1.9823,    -inf,    -inf],
          [ 6.8148,  0.1686, -5.4497,    -inf],
          [ 3.6928, -2.2705, -0.6785,  1.0980]],

         [[ 2.2966,    -inf,    -inf,    -inf],
          [ 0.7433, -2.5425,    -inf,    -inf],
          [ 0.4243,  2.3769, -3.7525,    -inf],
          [ 3.2386, -3.9234,  5.6896, -2.5477]],

         [[ 0.4060,    -inf,    -inf,    -inf],
          [-2.0763, -1.7407,    -inf,    -inf],
          [-3.6452, -1.0054,  2.9403,    -inf],
          [-1.3950, -2.1286,  0.1681, -0.3132]],

         [[-5.4202,    -inf,    -inf,    -inf],
          [ 3.3252,  1.1271,    -inf,    -inf],
          [ 0.4958, -0.0475,  0.1970,    -inf],
          [ 1.7800,  4.1826, -1.1338,  0.5878]],

         [[-0.2588,    -inf,    -inf,    -inf],
          [ 0.5140,  4.0775,    -inf,    -inf],
          [-1.5265, -0.6738, -1.5551,    -inf],
          [-1.8666, -3.0945,  0.0877,  4.1797]],

         [[-5.8610,    -inf,    -inf,    -inf],
          [ 0.5232,  1.7335,    -inf,    -inf],
          [-1.0571, -1.5885,  2.9865,    -inf],
          [-3.5469, -3.2631, -0.4562,  4.1430]],

         [[-1.4825,    -inf,    -inf,    -inf],
          [ 0.5392, -2.8851,    -inf,    -inf],
          [ 1.2771, -1.4815,  0.7616,    -inf],
          [-0.5475, -5.7596,  1.2933,  0.1274]],

         [[ 3.5934,    -inf,    -inf,    -inf],
          [ 1.8142,  2.0114,    -inf,    -inf],
          [ 1.4027, -2.5396,  2.0580,    -inf],
          [ 0.1270,  2.1973,  2.5270, -1.2702]],

         [[ 2.8691,    -inf,    -inf,    -inf],
          [ 1.1508, -0.0566,    -inf,    -inf],
          [-1.9473, -1.1498, -0.0307,    -inf],
          [-0.2051, -0.9015,  0.7890,  3.5611]],

         [[-1.2230,    -inf,    -inf,    -inf],
          [-1.3718, -0.3865,    -inf,    -inf],
          [-2.1008, -0.5590,  2.0944,    -inf],
          [-2.9608, -0.3639, -2.6346, -3.9629]],

         [[ 1.1658,    -inf,    -inf,    -inf],
          [ 3.0267,  5.9434,    -inf,    -inf],
          [ 0.9767,  4.5106,  1.0726,    -inf],
          [-1.0519,  2.2972, -2.8194,  3.4337]],

         [[ 0.0179,    -inf,    -inf,    -inf],
          [ 2.4239,  2.7727,    -inf,    -inf],
          [-0.3290,  0.5420,  1.5810,    -inf],
          [ 1.0383,  0.6365, -2.3022, -0.2843]],

         [[ 0.7907,    -inf,    -inf,    -inf],
          [ 6.6352,  0.2338,    -inf,    -inf],
          [ 2.1014, -1.7517, -0.4384,    -inf],
          [-0.0112,  1.2483,  0.8984, -0.0587]],

         [[-3.4218,    -inf,    -inf,    -inf],
          [-1.1336,  0.1992,    -inf,    -inf],
          [-2.6612, -0.7365,  1.8548,    -inf],
          [ 1.7621, -1.7195,  0.9070, -0.2429]],

         [[ 1.9304,    -inf,    -inf,    -inf],
          [-0.9084,  1.4210,    -inf,    -inf],
          [-1.0300, -1.0369,  1.7060,    -inf],
          [ 2.8366,  2.4894, -1.7133,  0.8026]],

         [[ 1.8883,    -inf,    -inf,    -inf],
          [-2.5978,  1.9474,    -inf,    -inf],
          [ 0.1615, -0.6446,  0.2730,    -inf],
          [ 0.9474,  0.3530, -1.0788, -3.2629]],

         [[-2.3531,    -inf,    -inf,    -inf],
          [-1.7220, -0.4355,    -inf,    -inf],
          [ 1.6181,  0.9397, -1.4788,    -inf],
          [ 2.2040, -4.6803, -1.1675,  2.2824]],

         [[ 5.3121,    -inf,    -inf,    -inf],
          [ 0.0200,  0.6758,    -inf,    -inf],
          [ 1.6406,  4.3398,  1.6205,    -inf],
          [-5.4384,  1.4701, -0.0610, -1.4084]],

         [[ 5.9188,    -inf,    -inf,    -inf],
          [ 2.5475,  2.8831,    -inf,    -inf],
          [-1.3119,  0.6728,  0.9914,    -inf],
          [-3.6147, -1.4427, -1.3346, -1.8527]],

         [[ 2.9239,    -inf,    -inf,    -inf],
          [ 0.7179, -2.2116,    -inf,    -inf],
          [ 2.9810, -2.9227, -0.0217,    -inf],
          [-1.5464,  0.6871,  0.7320,  3.1667]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 0.2981,    -inf,    -inf,    -inf],
          [-2.9624,  2.2883,    -inf,    -inf],
          [ 4.0827, -4.7345,  3.7245,    -inf],
          [ 4.6830,  5.9955, -1.2728,  1.3511]],

         [[ 0.5192,    -inf,    -inf,    -inf],
          [-0.1325, -1.6400,    -inf,    -inf],
          [-1.1904,  2.9354,  2.5503,    -inf],
          [-0.0297,  1.5523,  1.3947, -4.3096]],

         [[ 0.2200,    -inf,    -inf,    -inf],
          [-0.3115,  2.7804,    -inf,    -inf],
          [-0.7718, -2.1286,  2.7850,    -inf],
          [-0.8808, -2.2853, -2.1344,  0.8467]],

         [[-0.3499,    -inf,    -inf,    -inf],
          [ 1.3868, -2.9675,    -inf,    -inf],
          [ 0.0630, -4.1057,  3.2724,    -inf],
          [-1.9306, -1.1974, -2.7539, -5.7562]],

         [[-3.3395,    -inf,    -inf,    -inf],
          [-2.5301,  0.3005,    -inf,    -inf],
          [ 0.2209, -0.3722, -1.0516,    -inf],
          [-3.4242, -1.5078,  3.8530, -5.8917]],

         [[ 1.5875,    -inf,    -inf,    -inf],
          [-0.1198, -1.0473,    -inf,    -inf],
          [ 4.7533, -2.5991,  0.9854,    -inf],
          [ 0.6211,  0.0962, -0.0381, -1.1779]],

         [[ 2.3640,    -inf,    -inf,    -inf],
          [ 2.5433, -2.0397,    -inf,    -inf],
          [ 0.7201,  0.1837, -2.6463,    -inf],
          [ 0.3557, -3.9128, -3.3418, -0.2459]],

         [[ 1.2495,    -inf,    -inf,    -inf],
          [-0.8775, -5.0318,    -inf,    -inf],
          [ 1.4064,  1.3294, -0.7875,    -inf],
          [ 1.9932,  1.4872, -1.0955, -2.6445]],

         [[-5.6792,    -inf,    -inf,    -inf],
          [ 1.4563,  0.7404,    -inf,    -inf],
          [ 0.1791,  1.6591, -0.7113,    -inf],
          [-3.7689,  0.4530,  1.0971, -3.5644]],

         [[-0.3788,    -inf,    -inf,    -inf],
          [ 2.6002,  4.0632,    -inf,    -inf],
          [ 1.3512,  2.7351,  2.1330,    -inf],
          [-0.7711,  2.5755, -3.0161, -1.0604]],

         [[-5.3317,    -inf,    -inf,    -inf],
          [-3.4642,  2.9553,    -inf,    -inf],
          [ 1.0688,  0.5179,  0.9141,    -inf],
          [-5.2974, -2.5679, -0.1124,  1.1131]],

         [[-0.0775,    -inf,    -inf,    -inf],
          [-2.0198, -4.0990,    -inf,    -inf],
          [-0.0639, -1.4735,  1.5482,    -inf],
          [-3.2975, -2.0221, -1.3362, -3.3386]],

         [[ 0.6430,    -inf,    -inf,    -inf],
          [-4.2691, -7.1964,    -inf,    -inf],
          [ 1.4729, -1.0252, -1.1480,    -inf],
          [ 3.6347,  1.5775, -0.9376,  1.6505]],

         [[ 5.3499,    -inf,    -inf,    -inf],
          [-0.4928, -0.0321,    -inf,    -inf],
          [-3.8456, -1.4481, -3.5215,    -inf],
          [-4.4908, -1.2398, -1.0931, -7.6517]],

         [[ 0.7733,    -inf,    -inf,    -inf],
          [-0.0676, -0.1295,    -inf,    -inf],
          [-2.2029, -1.7362, -1.9740,    -inf],
          [-0.1326,  2.5434, -0.7650,  2.5921]],

         [[-2.7927,    -inf,    -inf,    -inf],
          [ 4.5720,  3.7662,    -inf,    -inf],
          [-3.6829,  1.3209,  4.0221,    -inf],
          [-1.7773, -0.1429,  1.8057,  2.6783]],

         [[-1.9624,    -inf,    -inf,    -inf],
          [-0.2685,  1.9123,    -inf,    -inf],
          [ 1.7160,  2.3669, -4.8653,    -inf],
          [-3.5231,  3.8699, -3.8546, -2.3865]],

         [[ 0.8610,    -inf,    -inf,    -inf],
          [ 3.2716,  2.9797,    -inf,    -inf],
          [ 4.9522,  0.0311, -1.1820,    -inf],
          [ 1.2247, -0.4400,  0.9147,  2.4192]],

         [[-3.5850,    -inf,    -inf,    -inf],
          [-3.1125, -1.3479,    -inf,    -inf],
          [ 0.7624,  2.8464, -2.9740,    -inf],
          [ 0.3252,  0.0714,  2.1752,  1.2764]],

         [[ 3.2871,    -inf,    -inf,    -inf],
          [-0.2115, -0.2232,    -inf,    -inf],
          [ 1.3361, -1.5792, -0.8254,    -inf],
          [ 3.2787,  2.7698, -0.3260, -3.0088]],

         [[ 1.5017,    -inf,    -inf,    -inf],
          [-2.9870,  3.0598,    -inf,    -inf],
          [-2.2950, -0.1458, -1.8684,    -inf],
          [-3.1431, -0.6717, -1.7272,  1.8430]],

         [[-0.0584,    -inf,    -inf,    -inf],
          [-2.5388,  2.7813,    -inf,    -inf],
          [ 0.7251, -5.0488,  2.2179,    -inf],
          [ 0.8956,  1.5228, -0.9611, -0.3271]],

         [[ 6.1095,    -inf,    -inf,    -inf],
          [-0.4188, -0.0495,    -inf,    -inf],
          [ 4.0540,  6.1060,  0.0248,    -inf],
          [-3.1942, -2.0395,  0.1709, -5.4670]],

         [[ 5.1084,    -inf,    -inf,    -inf],
          [-0.9931,  1.9708,    -inf,    -inf],
          [-2.9665,  5.9175, -0.3554,    -inf],
          [-3.8909,  0.4088,  0.7819, -1.4476]],

         [[ 3.7074,    -inf,    -inf,    -inf],
          [ 3.4962,  0.9430,    -inf,    -inf],
          [ 2.9002,  0.9524,  0.0614,    -inf],
          [-5.1601,  3.5552,  1.1042,  1.8955]]],


        [[[ 3.0104,    -inf,    -inf,    -inf],
          [ 1.9110,  2.9336,    -inf,    -inf],
          [ 2.5249,  4.8520,  0.1923,    -inf],
          [ 1.8877,  1.5978, -2.4086,  2.3320]],

         [[ 0.3171,    -inf,    -inf,    -inf],
          [ 2.5859, -4.2195,    -inf,    -inf],
          [ 3.0274,  4.1928,  1.6400,    -inf],
          [ 4.2073,  0.6182, -2.2800,  3.0252]],

         [[-1.6350,    -inf,    -inf,    -inf],
          [ 0.0818, -2.6698,    -inf,    -inf],
          [ 0.1333, -4.7107, -1.8689,    -inf],
          [-0.3168, -0.1844,  2.5524,  7.6079]],

         [[-1.7342,    -inf,    -inf,    -inf],
          [-0.5408,  4.7035,    -inf,    -inf],
          [ 2.7512,  1.0222,  2.8894,    -inf],
          [-2.4499, -5.5004, -2.7588, -2.1112]],

         [[-4.5197,    -inf,    -inf,    -inf],
          [-0.8751,  1.6027,    -inf,    -inf],
          [-0.1122, -1.6549, -2.1311,    -inf],
          [-1.5850, -1.6490,  0.7502,  0.0571]],

         [[ 3.9596,    -inf,    -inf,    -inf],
          [ 0.0316,  1.9823,    -inf,    -inf],
          [ 6.8148,  0.1686, -5.4497,    -inf],
          [ 3.6928, -2.2705, -0.6785,  1.0980]],

         [[ 2.2966,    -inf,    -inf,    -inf],
          [ 0.7433, -2.5425,    -inf,    -inf],
          [ 0.4243,  2.3769, -3.7525,    -inf],
          [ 3.2386, -3.9234,  5.6896, -2.5477]],

         [[ 0.4060,    -inf,    -inf,    -inf],
          [-2.0763, -1.7407,    -inf,    -inf],
          [-3.6452, -1.0054,  2.9403,    -inf],
          [-1.3950, -2.1286,  0.1681, -0.3132]],

         [[-5.4202,    -inf,    -inf,    -inf],
          [ 3.3252,  1.1271,    -inf,    -inf],
          [ 0.4958, -0.0475,  0.1970,    -inf],
          [ 1.7800,  4.1826, -1.1338,  0.5878]],

         [[-0.2588,    -inf,    -inf,    -inf],
          [ 0.5140,  4.0775,    -inf,    -inf],
          [-1.5265, -0.6738, -1.5551,    -inf],
          [-1.8666, -3.0945,  0.0877,  4.1797]],

         [[-5.8610,    -inf,    -inf,    -inf],
          [ 0.5232,  1.7335,    -inf,    -inf],
          [-1.0571, -1.5885,  2.9865,    -inf],
          [-3.5469, -3.2631, -0.4562,  4.1430]],

         [[-1.4825,    -inf,    -inf,    -inf],
          [ 0.5392, -2.8851,    -inf,    -inf],
          [ 1.2771, -1.4815,  0.7616,    -inf],
          [-0.5475, -5.7596,  1.2933,  0.1274]],

         [[ 3.5934,    -inf,    -inf,    -inf],
          [ 1.8142,  2.0114,    -inf,    -inf],
          [ 1.4027, -2.5396,  2.0580,    -inf],
          [ 0.1270,  2.1973,  2.5270, -1.2702]],

         [[ 2.8691,    -inf,    -inf,    -inf],
          [ 1.1508, -0.0566,    -inf,    -inf],
          [-1.9473, -1.1498, -0.0307,    -inf],
          [-0.2051, -0.9015,  0.7890,  3.5611]],

         [[-1.2230,    -inf,    -inf,    -inf],
          [-1.3718, -0.3865,    -inf,    -inf],
          [-2.1008, -0.5590,  2.0944,    -inf],
          [-2.9608, -0.3639, -2.6346, -3.9629]],

         [[ 1.1658,    -inf,    -inf,    -inf],
          [ 3.0267,  5.9434,    -inf,    -inf],
          [ 0.9767,  4.5106,  1.0726,    -inf],
          [-1.0519,  2.2972, -2.8194,  3.4337]],

         [[ 0.0179,    -inf,    -inf,    -inf],
          [ 2.4239,  2.7727,    -inf,    -inf],
          [-0.3290,  0.5420,  1.5810,    -inf],
          [ 1.0383,  0.6365, -2.3022, -0.2843]],

         [[ 0.7907,    -inf,    -inf,    -inf],
          [ 6.6352,  0.2338,    -inf,    -inf],
          [ 2.1014, -1.7517, -0.4384,    -inf],
          [-0.0112,  1.2483,  0.8984, -0.0587]],

         [[-3.4218,    -inf,    -inf,    -inf],
          [-1.1336,  0.1992,    -inf,    -inf],
          [-2.6612, -0.7365,  1.8548,    -inf],
          [ 1.7621, -1.7195,  0.9070, -0.2429]],

         [[ 1.9304,    -inf,    -inf,    -inf],
          [-0.9084,  1.4210,    -inf,    -inf],
          [-1.0300, -1.0369,  1.7060,    -inf],
          [ 2.8366,  2.4894, -1.7133,  0.8026]],

         [[ 1.8883,    -inf,    -inf,    -inf],
          [-2.5978,  1.9474,    -inf,    -inf],
          [ 0.1615, -0.6446,  0.2730,    -inf],
          [ 0.9474,  0.3530, -1.0788, -3.2629]],

         [[-2.3531,    -inf,    -inf,    -inf],
          [-1.7220, -0.4355,    -inf,    -inf],
          [ 1.6181,  0.9397, -1.4788,    -inf],
          [ 2.2040, -4.6803, -1.1675,  2.2824]],

         [[ 5.3121,    -inf,    -inf,    -inf],
          [ 0.0200,  0.6758,    -inf,    -inf],
          [ 1.6406,  4.3398,  1.6205,    -inf],
          [-5.4384,  1.4701, -0.0610, -1.4084]],

         [[ 5.9188,    -inf,    -inf,    -inf],
          [ 2.5475,  2.8831,    -inf,    -inf],
          [-1.3119,  0.6728,  0.9914,    -inf],
          [-3.6147, -1.4427, -1.3346, -1.8527]],

         [[ 2.9239,    -inf,    -inf,    -inf],
          [ 0.7179, -2.2116,    -inf,    -inf],
          [ 2.9810, -2.9227, -0.0217,    -inf],
          [-1.5464,  0.6871,  0.7320,  3.1667]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.2592,  0.5219,  0.3117,  ...,  0.2722, -0.0954, -0.5689],
          [ 0.5067, -0.1622,  0.0727,  ..., -1.0763, -0.9415, -0.0041],
          [-0.4067,  0.1595,  0.5064,  ...,  0.3205,  0.2697,  0.1458],
          ...,
          [ 0.0377,  1.1512,  0.2974,  ...,  0.8415, -0.1000, -0.4633],
          [-1.0000,  0.6346,  0.7965,  ..., -0.2374, -0.2494, -0.9194],
          [ 0.5067,  0.2207, -0.0078,  ..., -0.8331, -0.7055,  0.0569]],

         [[ 0.3984,  0.2329, -0.5755,  ...,  0.1085, -0.7106,  0.1435],
          [ 0.2448,  0.0132,  0.2713,  ..., -0.9685, -0.3473, -0.0815],
          [ 0.8447, -0.3116,  0.4496,  ...,  0.2244, -0.5427,  0.2826],
          ...,
          [ 0.0184,  0.5623,  0.1453,  ...,  0.4110, -0.0489, -0.2263],
          [-0.0166,  0.1719,  0.6653,  ..., -0.3901, -0.1431, -0.9241],
          [ 0.1866,  0.1020, -0.3300,  ...,  0.2521,  0.2999, -0.1840]],

         [[ 0.6796,  0.1112, -0.1189,  ...,  0.3004, -0.4212,  0.3360],
          [ 0.0248,  0.0810, -0.1941,  ..., -0.1624, -0.6549, -0.2312],
          [ 0.3768, -0.3608,  0.9254,  ..., -0.1187, -0.3388,  0.1281],
          ...,
          [ 0.0261,  0.4673,  0.1377,  ...,  0.3558, -0.1493, -0.2594],
          [ 0.0448,  0.0636,  0.6570,  ..., -0.2959, -0.2356, -0.6003],
          [ 0.3316,  0.0606, -0.0640,  ..., -0.3374,  0.0289, -0.0466]],

         [[ 0.0324,  0.1014, -0.2449,  ...,  0.1666, -0.5679, -0.0429],
          [ 0.1472,  0.1993,  0.1201,  ..., -0.6628, -0.6610, -0.2773],
          [-0.0706, -0.2415,  0.7248,  ...,  0.0451, -0.3858,  0.1056],
          ...,
          [-0.0470,  0.7419,  0.3394,  ..., -0.0065, -0.0715, -0.2286],
          [-0.0207,  0.0071,  0.5230,  ..., -0.2358, -0.1829, -0.3689],
          [-0.0645, -0.1162, -0.2013,  ...,  0.3127,  0.4884,  0.1213]]],


        [[[ 0.6394,  0.6448,  0.0774,  ...,  0.2110, -0.0474, -0.2324],
          [ 0.5658, -0.0109,  0.1883,  ..., -1.0697, -0.9499, -0.1305],
          [ 0.2208,  0.7621,  0.0535,  ...,  0.9358, -0.0824,  0.6675],
          ...,
          [-0.0300,  1.5830, -0.1511,  ...,  0.3635, -0.4078, -0.1461],
          [-0.9209,  0.8633,  1.1410,  ..., -0.1530, -0.6796, -0.6578],
          [ 0.4564,  0.0154,  0.6532,  ..., -0.6508, -0.8104, -0.0482]],

         [[ 0.9203,  0.5325, -0.6010,  ...,  0.3293, -0.1823, -0.8008],
          [ 0.4930, -0.1410,  0.3179,  ..., -1.0472, -0.5244,  0.0444],
          [ 0.5645,  0.2504, -0.0439,  ...,  0.8529, -0.2817,  0.7503],
          ...,
          [ 0.1279,  0.8539,  0.0234,  ..., -0.6662, -0.1431,  0.0722],
          [-0.1605, -0.2699,  0.2955,  ...,  0.1005,  0.3066, -0.3353],
          [-0.1064,  0.0977, -0.1967,  ...,  0.2033,  0.2020,  0.0412]],

         [[ 0.9851,  0.3155, -0.4687,  ...,  0.2165, -0.0915, -0.4851],
          [ 0.3153,  0.0024, -0.2274,  ..., -0.0457, -0.3257, -0.0807],
          [ 0.2663, -0.1755,  0.2117,  ...,  0.1404, -0.2903,  0.5879],
          ...,
          [ 0.0658,  0.5492, -0.0386,  ..., -0.4087, -0.2146, -0.0511],
          [-0.3931,  0.2103,  0.6165,  ..., -0.1232, -0.5068, -0.4327],
          [ 0.0293,  0.0401,  0.1350,  ..., -0.4379,  0.0873, -0.1322]],

         [[ 0.9343, -0.0420, -0.3593,  ...,  0.0915,  0.3283, -0.1580],
          [ 0.6349,  0.1454,  0.2563,  ..., -0.7222, -0.5944,  0.1279],
          [-0.3608,  0.2491,  0.2583,  ...,  0.2537, -0.3114,  0.4536],
          ...,
          [ 0.0217,  0.3903,  0.2543,  ..., -0.5030, -0.1747, -0.1497],
          [-0.2026,  0.3596,  0.4665,  ..., -0.2005, -0.4100, -0.4898],
          [-0.1888, -0.0280,  0.1559,  ..., -0.0297,  0.1594,  0.2877]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.2592,  0.5219,  0.3117,  ..., -0.8331, -0.7055,  0.0569],
         [ 0.3984,  0.2329, -0.5755,  ...,  0.2521,  0.2999, -0.1840],
         [ 0.6796,  0.1112, -0.1189,  ..., -0.3374,  0.0289, -0.0466],
         [ 0.0324,  0.1014, -0.2449,  ...,  0.3127,  0.4884,  0.1213]],

        [[ 0.6394,  0.6448,  0.0774,  ..., -0.6508, -0.8104, -0.0482],
         [ 0.9203,  0.5325, -0.6010,  ...,  0.2033,  0.2020,  0.0412],
         [ 0.9851,  0.3155, -0.4687,  ..., -0.4379,  0.0873, -0.1322],
         [ 0.9343, -0.0420, -0.3593,  ..., -0.0297,  0.1594,  0.2877]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-3.8692e-01, -2.9194e-01,  1.1996e+00,  ...,  1.2495e-01,
          -2.5826e-01, -7.2685e-02],
         [-2.9915e-01, -4.1106e-01,  5.7545e-01,  ...,  3.2791e-01,
          -8.6099e-02, -5.0768e-01],
         [-5.4144e-01, -5.6900e-01,  7.4853e-01,  ...,  1.9110e-01,
           5.4937e-03, -2.0405e-01],
         [-3.6368e-01, -3.7225e-01,  4.5403e-01,  ...,  8.9342e-02,
           1.8606e-01, -3.6299e-01]],

        [[-3.6884e-01, -5.4419e-01,  1.3104e+00,  ..., -1.8310e-01,
          -1.0106e-01,  2.1461e-01],
         [ 1.1976e-03, -6.1972e-01,  7.3453e-01,  ..., -1.6390e-01,
           1.9178e-01, -4.5896e-02],
         [-1.2383e-01, -3.7517e-01,  6.3823e-01,  ..., -1.3297e-01,
           1.4201e-01, -1.7922e-01],
         [-2.3559e-01, -2.8294e-01,  3.8409e-01,  ..., -2.3824e-01,
           2.4804e-01, -9.8351e-02]]], grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.5015,    -inf,    -inf,    -inf],
          [-0.9818,  1.5695,    -inf,    -inf],
          [ 0.4874, -0.2392, -2.9699,    -inf],
          [-0.4076, -2.4803,  1.3824, -2.7040]],

         [[-3.7313,    -inf,    -inf,    -inf],
          [ 1.6242,  4.8968,    -inf,    -inf],
          [ 0.6585, -0.1468,  3.1387,    -inf],
          [-3.6524,  6.4481, -2.2610,  2.0557]],

         [[ 0.8723,    -inf,    -inf,    -inf],
          [-3.7378, -0.1043,    -inf,    -inf],
          [-1.1588, -1.6976, -1.7594,    -inf],
          [-2.5260, -1.6578, -0.4768, -2.5461]],

         [[-0.2516,    -inf,    -inf,    -inf],
          [-1.6638,  2.0189,    -inf,    -inf],
          [-1.3729,  0.4615, -1.4323,    -inf],
          [-1.3413, -0.3964,  1.2661,  7.1689]],

         [[ 1.2899,    -inf,    -inf,    -inf],
          [ 3.1951,  3.7040,    -inf,    -inf],
          [ 0.9781, -0.1847,  2.7033,    -inf],
          [ 0.1995,  0.8819,  1.7674, -2.9179]],

         [[-4.1610,    -inf,    -inf,    -inf],
          [-1.9518,  1.3222,    -inf,    -inf],
          [ 3.5166,  3.6226,  0.7232,    -inf],
          [ 0.7460, -2.5691,  0.8354,  4.3454]],

         [[ 0.1060,    -inf,    -inf,    -inf],
          [-5.7234, -1.0214,    -inf,    -inf],
          [ 0.8990, -3.6365,  1.9361,    -inf],
          [ 1.8442, -2.4468,  0.5534, -2.0293]],

         [[-3.0789,    -inf,    -inf,    -inf],
          [ 2.9864, -2.8789,    -inf,    -inf],
          [ 0.4283,  2.1107,  1.6869,    -inf],
          [ 2.1658, -3.7167, -4.7852,  1.4115]],

         [[-2.0770,    -inf,    -inf,    -inf],
          [ 7.1411,  3.1200,    -inf,    -inf],
          [-8.6964, -2.9645, -1.4856,    -inf],
          [-4.7885, -1.5497,  1.3749,  3.9868]],

         [[ 0.6950,    -inf,    -inf,    -inf],
          [-0.3963, -7.0757,    -inf,    -inf],
          [-3.9684, -0.7304, -3.8611,    -inf],
          [-2.4318, -0.4625,  1.0927,  2.7441]],

         [[ 0.4878,    -inf,    -inf,    -inf],
          [-6.9444, -2.2248,    -inf,    -inf],
          [-7.2006,  5.7126, -0.9916,    -inf],
          [ 0.8662, -1.2633,  2.5561,  2.8046]],

         [[ 1.5237,    -inf,    -inf,    -inf],
          [-1.6318, -3.6529,    -inf,    -inf],
          [-1.6232,  1.5965,  2.8817,    -inf],
          [-4.5984,  0.2240, -0.2902, -4.1624]],

         [[-0.1391,    -inf,    -inf,    -inf],
          [ 2.2917, -1.8930,    -inf,    -inf],
          [ 2.5587, -1.6605,  0.1269,    -inf],
          [ 0.8169, -1.7768,  3.5127, -2.9073]],

         [[-0.2925,    -inf,    -inf,    -inf],
          [ 0.5042,  2.9393,    -inf,    -inf],
          [-0.4800, -2.8847, -0.4149,    -inf],
          [ 4.5857,  2.4025, -0.1082,  2.9735]],

         [[ 0.1679,    -inf,    -inf,    -inf],
          [ 2.0176,  4.2253,    -inf,    -inf],
          [ 3.4514, -6.9529, -5.0979,    -inf],
          [-0.2492, -4.1809, -2.0731,  0.2889]],

         [[ 1.7738,    -inf,    -inf,    -inf],
          [-1.6195, -3.7371,    -inf,    -inf],
          [-0.4984,  1.4578,  2.7199,    -inf],
          [-0.2961, -2.9029, -1.4330,  2.7258]],

         [[ 2.0402,    -inf,    -inf,    -inf],
          [ 1.0095,  2.1177,    -inf,    -inf],
          [ 1.5709,  0.7983, -3.5577,    -inf],
          [ 1.5710, -1.8278, -2.3712,  0.1820]],

         [[-0.1456,    -inf,    -inf,    -inf],
          [ 1.5745, -0.1400,    -inf,    -inf],
          [ 2.8767, -1.1806,  0.2571,    -inf],
          [-0.2135, -1.2380,  0.7678, -0.5275]],

         [[-0.4905,    -inf,    -inf,    -inf],
          [ 3.3138,  1.4826,    -inf,    -inf],
          [ 1.2877,  3.0472,  3.3751,    -inf],
          [-1.9055,  3.6378, -1.0732,  1.4993]],

         [[-1.6486,    -inf,    -inf,    -inf],
          [-2.5487, -1.1651,    -inf,    -inf],
          [-4.2142, -1.0041,  0.7354,    -inf],
          [-4.6788,  0.1815,  4.1651, -1.0763]],

         [[-2.0066,    -inf,    -inf,    -inf],
          [ 1.3469,  2.1976,    -inf,    -inf],
          [ 1.7546,  0.1759, -0.0209,    -inf],
          [-0.7605,  0.9326, -0.7172,  1.4244]],

         [[ 3.3885,    -inf,    -inf,    -inf],
          [-0.2129, -0.9301,    -inf,    -inf],
          [ 2.4768, -3.0525, -2.2870,    -inf],
          [-6.1513,  0.6136, -3.0241,  1.4752]],

         [[-0.3013,    -inf,    -inf,    -inf],
          [ 1.5644, -3.3926,    -inf,    -inf],
          [-2.1837, -0.4421,  4.5096,    -inf],
          [ 2.0073, -0.4651,  1.6707,  2.4706]],

         [[ 2.8756,    -inf,    -inf,    -inf],
          [ 1.8079, -0.9320,    -inf,    -inf],
          [-5.4901,  1.8423,  2.0422,    -inf],
          [ 1.4013, -0.4004, -1.0794,  2.5676]],

         [[ 1.1369,    -inf,    -inf,    -inf],
          [ 1.9521,  0.0960,    -inf,    -inf],
          [ 3.4281, -2.6897,  1.9516,    -inf],
          [-0.6651, -0.3064,  0.2779,  0.3838]]],


        [[[ 0.5116,    -inf,    -inf,    -inf],
          [-1.1664, -4.8852,    -inf,    -inf],
          [ 0.8194, -5.0196, -3.2945,    -inf],
          [-0.7996, -1.8306, -1.0201, -0.1318]],

         [[-0.0096,    -inf,    -inf,    -inf],
          [ 5.1123,  2.7692,    -inf,    -inf],
          [ 1.8099,  1.0892, -1.1608,    -inf],
          [ 1.4488, -1.0591, -0.9503, -1.7277]],

         [[-2.9744,    -inf,    -inf,    -inf],
          [ 2.2282, -3.4472,    -inf,    -inf],
          [-3.5126, -2.9058, -1.4419,    -inf],
          [-2.1384,  3.4862, -1.9237,  4.5801]],

         [[ 1.1425,    -inf,    -inf,    -inf],
          [ 1.7196,  4.0728,    -inf,    -inf],
          [-0.9059,  0.5838,  2.3140,    -inf],
          [ 2.0565,  3.8318,  8.0537,  3.9897]],

         [[-0.6161,    -inf,    -inf,    -inf],
          [ 1.1932, -2.8095,    -inf,    -inf],
          [ 2.6057,  1.1040, -3.2301,    -inf],
          [ 1.1996, -2.4583, -5.5807, -2.8449]],

         [[-1.9959,    -inf,    -inf,    -inf],
          [ 3.5729,  7.5609,    -inf,    -inf],
          [ 1.3402,  8.9547, -0.3632,    -inf],
          [ 1.7913, -0.3948,  0.6119,  4.2862]],

         [[ 1.6809,    -inf,    -inf,    -inf],
          [-1.7715,  1.1658,    -inf,    -inf],
          [ 0.8250,  1.1398,  1.2755,    -inf],
          [ 3.9255, -2.0664, -2.4518, -0.3677]],

         [[-3.4603,    -inf,    -inf,    -inf],
          [ 3.0882,  1.1455,    -inf,    -inf],
          [ 0.2110,  2.0177, -0.4469,    -inf],
          [-1.3416, -2.3816, -0.7068,  2.4364]],

         [[-2.5192,    -inf,    -inf,    -inf],
          [-0.3258,  3.8904,    -inf,    -inf],
          [-7.3255,  2.7148, -0.6244,    -inf],
          [-1.6532, -1.0481, -0.1537, -0.8196]],

         [[ 4.7493,    -inf,    -inf,    -inf],
          [ 0.6176,  1.7387,    -inf,    -inf],
          [-1.1793,  5.1146,  0.3875,    -inf],
          [-1.4980, -2.1473,  1.2728,  3.4818]],

         [[-1.6278,    -inf,    -inf,    -inf],
          [-4.0387, -5.3832,    -inf,    -inf],
          [-0.1776, -2.1573,  4.3919,    -inf],
          [ 2.3672, -0.5036,  2.9646,  5.9204]],

         [[ 1.3923,    -inf,    -inf,    -inf],
          [-0.9139,  0.7479,    -inf,    -inf],
          [-1.0253, -2.9585, -1.4623,    -inf],
          [ 3.1637, -0.0575, -1.6632, -2.2241]],

         [[-0.2966,    -inf,    -inf,    -inf],
          [ 5.1072, -2.0576,    -inf,    -inf],
          [ 2.7476, -3.9372,  0.2160,    -inf],
          [ 2.8661, -2.8739,  1.7683,  4.2055]],

         [[ 1.8603,    -inf,    -inf,    -inf],
          [ 2.2148,  1.0700,    -inf,    -inf],
          [-1.6566, -0.3010, -1.0187,    -inf],
          [ 0.3065, -0.2456, -0.1362,  3.7146]],

         [[ 3.2673,    -inf,    -inf,    -inf],
          [-0.1296,  0.6871,    -inf,    -inf],
          [ 2.0387, -1.3803, -4.1178,    -inf],
          [ 0.2726,  1.1421, -0.2067,  4.6581]],

         [[ 2.1165,    -inf,    -inf,    -inf],
          [ 2.1416, -4.9646,    -inf,    -inf],
          [ 0.6310, -0.0937, -4.2192,    -inf],
          [ 0.9756,  0.3456,  3.3664, -2.7430]],

         [[ 2.1532,    -inf,    -inf,    -inf],
          [ 1.6577, -1.8539,    -inf,    -inf],
          [-1.7471, -0.0240,  0.6576,    -inf],
          [-0.8516,  2.7465,  6.2941,  0.5729]],

         [[ 2.9579,    -inf,    -inf,    -inf],
          [ 1.1419,  0.8492,    -inf,    -inf],
          [ 2.8252, -1.2154, -2.3327,    -inf],
          [-1.3800, -3.0540, -5.8608, -5.2914]],

         [[-1.3450,    -inf,    -inf,    -inf],
          [-0.8676,  2.8638,    -inf,    -inf],
          [ 0.9823,  0.0277, -0.4188,    -inf],
          [ 0.5057, -1.4957, -0.8260,  0.4111]],

         [[-1.2317,    -inf,    -inf,    -inf],
          [-2.9212, -4.7330,    -inf,    -inf],
          [-3.6535, -6.3060, -1.4107,    -inf],
          [-0.2347,  0.1875,  2.1911, -1.5206]],

         [[-2.2832,    -inf,    -inf,    -inf],
          [ 3.5761, -1.0840,    -inf,    -inf],
          [ 1.8649,  2.1802,  2.8426,    -inf],
          [-3.9918, -1.1172,  0.4910, -2.7708]],

         [[-0.3716,    -inf,    -inf,    -inf],
          [ 0.1603,  2.3093,    -inf,    -inf],
          [-2.2674,  3.1860,  2.1759,    -inf],
          [-2.0256,  2.1388, -1.0625,  3.6348]],

         [[-1.9784,    -inf,    -inf,    -inf],
          [-0.3058, -2.1252,    -inf,    -inf],
          [-3.1388, -2.3748, -2.6129,    -inf],
          [ 2.2437,  1.5051, -0.4619,  5.9818]],

         [[ 3.2593,    -inf,    -inf,    -inf],
          [ 6.8870, -1.6416,    -inf,    -inf],
          [-1.0752, -0.5561,  1.6089,    -inf],
          [ 0.8390, -1.2502, -2.8305, -1.1005]],

         [[ 1.0482,    -inf,    -inf,    -inf],
          [-2.1150,  2.6368,    -inf,    -inf],
          [ 0.8497,  0.3744,  0.0232,    -inf],
          [ 1.2276,  1.0204,  0.1450, -0.1858]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.5015,    -inf,    -inf,    -inf],
          [-0.9818,  1.5695,    -inf,    -inf],
          [ 0.4874, -0.2392, -2.9699,    -inf],
          [-0.4076, -2.4803,  1.3824, -2.7040]],

         [[-3.7313,    -inf,    -inf,    -inf],
          [ 1.6242,  4.8968,    -inf,    -inf],
          [ 0.6585, -0.1468,  3.1387,    -inf],
          [-3.6524,  6.4481, -2.2610,  2.0557]],

         [[ 0.8723,    -inf,    -inf,    -inf],
          [-3.7378, -0.1043,    -inf,    -inf],
          [-1.1588, -1.6976, -1.7594,    -inf],
          [-2.5260, -1.6578, -0.4768, -2.5461]],

         [[-0.2516,    -inf,    -inf,    -inf],
          [-1.6638,  2.0189,    -inf,    -inf],
          [-1.3729,  0.4615, -1.4323,    -inf],
          [-1.3413, -0.3964,  1.2661,  7.1689]],

         [[ 1.2899,    -inf,    -inf,    -inf],
          [ 3.1951,  3.7040,    -inf,    -inf],
          [ 0.9781, -0.1847,  2.7033,    -inf],
          [ 0.1995,  0.8819,  1.7674, -2.9179]],

         [[-4.1610,    -inf,    -inf,    -inf],
          [-1.9518,  1.3222,    -inf,    -inf],
          [ 3.5166,  3.6226,  0.7232,    -inf],
          [ 0.7460, -2.5691,  0.8354,  4.3454]],

         [[ 0.1060,    -inf,    -inf,    -inf],
          [-5.7234, -1.0214,    -inf,    -inf],
          [ 0.8990, -3.6365,  1.9361,    -inf],
          [ 1.8442, -2.4468,  0.5534, -2.0293]],

         [[-3.0789,    -inf,    -inf,    -inf],
          [ 2.9864, -2.8789,    -inf,    -inf],
          [ 0.4283,  2.1107,  1.6869,    -inf],
          [ 2.1658, -3.7167, -4.7852,  1.4115]],

         [[-2.0770,    -inf,    -inf,    -inf],
          [ 7.1411,  3.1200,    -inf,    -inf],
          [-8.6964, -2.9645, -1.4856,    -inf],
          [-4.7885, -1.5497,  1.3749,  3.9868]],

         [[ 0.6950,    -inf,    -inf,    -inf],
          [-0.3963, -7.0757,    -inf,    -inf],
          [-3.9684, -0.7304, -3.8611,    -inf],
          [-2.4318, -0.4625,  1.0927,  2.7441]],

         [[ 0.4878,    -inf,    -inf,    -inf],
          [-6.9444, -2.2248,    -inf,    -inf],
          [-7.2006,  5.7126, -0.9916,    -inf],
          [ 0.8662, -1.2633,  2.5561,  2.8046]],

         [[ 1.5237,    -inf,    -inf,    -inf],
          [-1.6318, -3.6529,    -inf,    -inf],
          [-1.6232,  1.5965,  2.8817,    -inf],
          [-4.5984,  0.2240, -0.2902, -4.1624]],

         [[-0.1391,    -inf,    -inf,    -inf],
          [ 2.2917, -1.8930,    -inf,    -inf],
          [ 2.5587, -1.6605,  0.1269,    -inf],
          [ 0.8169, -1.7768,  3.5127, -2.9073]],

         [[-0.2925,    -inf,    -inf,    -inf],
          [ 0.5042,  2.9393,    -inf,    -inf],
          [-0.4800, -2.8847, -0.4149,    -inf],
          [ 4.5857,  2.4025, -0.1082,  2.9735]],

         [[ 0.1679,    -inf,    -inf,    -inf],
          [ 2.0176,  4.2253,    -inf,    -inf],
          [ 3.4514, -6.9529, -5.0979,    -inf],
          [-0.2492, -4.1809, -2.0731,  0.2889]],

         [[ 1.7738,    -inf,    -inf,    -inf],
          [-1.6195, -3.7371,    -inf,    -inf],
          [-0.4984,  1.4578,  2.7199,    -inf],
          [-0.2961, -2.9029, -1.4330,  2.7258]],

         [[ 2.0402,    -inf,    -inf,    -inf],
          [ 1.0095,  2.1177,    -inf,    -inf],
          [ 1.5709,  0.7983, -3.5577,    -inf],
          [ 1.5710, -1.8278, -2.3712,  0.1820]],

         [[-0.1456,    -inf,    -inf,    -inf],
          [ 1.5745, -0.1400,    -inf,    -inf],
          [ 2.8767, -1.1806,  0.2571,    -inf],
          [-0.2135, -1.2380,  0.7678, -0.5275]],

         [[-0.4905,    -inf,    -inf,    -inf],
          [ 3.3138,  1.4826,    -inf,    -inf],
          [ 1.2877,  3.0472,  3.3751,    -inf],
          [-1.9055,  3.6378, -1.0732,  1.4993]],

         [[-1.6486,    -inf,    -inf,    -inf],
          [-2.5487, -1.1651,    -inf,    -inf],
          [-4.2142, -1.0041,  0.7354,    -inf],
          [-4.6788,  0.1815,  4.1651, -1.0763]],

         [[-2.0066,    -inf,    -inf,    -inf],
          [ 1.3469,  2.1976,    -inf,    -inf],
          [ 1.7546,  0.1759, -0.0209,    -inf],
          [-0.7605,  0.9326, -0.7172,  1.4244]],

         [[ 3.3885,    -inf,    -inf,    -inf],
          [-0.2129, -0.9301,    -inf,    -inf],
          [ 2.4768, -3.0525, -2.2870,    -inf],
          [-6.1513,  0.6136, -3.0241,  1.4752]],

         [[-0.3013,    -inf,    -inf,    -inf],
          [ 1.5644, -3.3926,    -inf,    -inf],
          [-2.1837, -0.4421,  4.5096,    -inf],
          [ 2.0073, -0.4651,  1.6707,  2.4706]],

         [[ 2.8756,    -inf,    -inf,    -inf],
          [ 1.8079, -0.9320,    -inf,    -inf],
          [-5.4901,  1.8423,  2.0422,    -inf],
          [ 1.4013, -0.4004, -1.0794,  2.5676]],

         [[ 1.1369,    -inf,    -inf,    -inf],
          [ 1.9521,  0.0960,    -inf,    -inf],
          [ 3.4281, -2.6897,  1.9516,    -inf],
          [-0.6651, -0.3064,  0.2779,  0.3838]]],


        [[[ 0.5116,    -inf,    -inf,    -inf],
          [-1.1664, -4.8852,    -inf,    -inf],
          [ 0.8194, -5.0196, -3.2945,    -inf],
          [-0.7996, -1.8306, -1.0201, -0.1318]],

         [[-0.0096,    -inf,    -inf,    -inf],
          [ 5.1123,  2.7692,    -inf,    -inf],
          [ 1.8099,  1.0892, -1.1608,    -inf],
          [ 1.4488, -1.0591, -0.9503, -1.7277]],

         [[-2.9744,    -inf,    -inf,    -inf],
          [ 2.2282, -3.4472,    -inf,    -inf],
          [-3.5126, -2.9058, -1.4419,    -inf],
          [-2.1384,  3.4862, -1.9237,  4.5801]],

         [[ 1.1425,    -inf,    -inf,    -inf],
          [ 1.7196,  4.0728,    -inf,    -inf],
          [-0.9059,  0.5838,  2.3140,    -inf],
          [ 2.0565,  3.8318,  8.0537,  3.9897]],

         [[-0.6161,    -inf,    -inf,    -inf],
          [ 1.1932, -2.8095,    -inf,    -inf],
          [ 2.6057,  1.1040, -3.2301,    -inf],
          [ 1.1996, -2.4583, -5.5807, -2.8449]],

         [[-1.9959,    -inf,    -inf,    -inf],
          [ 3.5729,  7.5609,    -inf,    -inf],
          [ 1.3402,  8.9547, -0.3632,    -inf],
          [ 1.7913, -0.3948,  0.6119,  4.2862]],

         [[ 1.6809,    -inf,    -inf,    -inf],
          [-1.7715,  1.1658,    -inf,    -inf],
          [ 0.8250,  1.1398,  1.2755,    -inf],
          [ 3.9255, -2.0664, -2.4518, -0.3677]],

         [[-3.4603,    -inf,    -inf,    -inf],
          [ 3.0882,  1.1455,    -inf,    -inf],
          [ 0.2110,  2.0177, -0.4469,    -inf],
          [-1.3416, -2.3816, -0.7068,  2.4364]],

         [[-2.5192,    -inf,    -inf,    -inf],
          [-0.3258,  3.8904,    -inf,    -inf],
          [-7.3255,  2.7148, -0.6244,    -inf],
          [-1.6532, -1.0481, -0.1537, -0.8196]],

         [[ 4.7493,    -inf,    -inf,    -inf],
          [ 0.6176,  1.7387,    -inf,    -inf],
          [-1.1793,  5.1146,  0.3875,    -inf],
          [-1.4980, -2.1473,  1.2728,  3.4818]],

         [[-1.6278,    -inf,    -inf,    -inf],
          [-4.0387, -5.3832,    -inf,    -inf],
          [-0.1776, -2.1573,  4.3919,    -inf],
          [ 2.3672, -0.5036,  2.9646,  5.9204]],

         [[ 1.3923,    -inf,    -inf,    -inf],
          [-0.9139,  0.7479,    -inf,    -inf],
          [-1.0253, -2.9585, -1.4623,    -inf],
          [ 3.1637, -0.0575, -1.6632, -2.2241]],

         [[-0.2966,    -inf,    -inf,    -inf],
          [ 5.1072, -2.0576,    -inf,    -inf],
          [ 2.7476, -3.9372,  0.2160,    -inf],
          [ 2.8661, -2.8739,  1.7683,  4.2055]],

         [[ 1.8603,    -inf,    -inf,    -inf],
          [ 2.2148,  1.0700,    -inf,    -inf],
          [-1.6566, -0.3010, -1.0187,    -inf],
          [ 0.3065, -0.2456, -0.1362,  3.7146]],

         [[ 3.2673,    -inf,    -inf,    -inf],
          [-0.1296,  0.6871,    -inf,    -inf],
          [ 2.0387, -1.3803, -4.1178,    -inf],
          [ 0.2726,  1.1421, -0.2067,  4.6581]],

         [[ 2.1165,    -inf,    -inf,    -inf],
          [ 2.1416, -4.9646,    -inf,    -inf],
          [ 0.6310, -0.0937, -4.2192,    -inf],
          [ 0.9756,  0.3456,  3.3664, -2.7430]],

         [[ 2.1532,    -inf,    -inf,    -inf],
          [ 1.6577, -1.8539,    -inf,    -inf],
          [-1.7471, -0.0240,  0.6576,    -inf],
          [-0.8516,  2.7465,  6.2941,  0.5729]],

         [[ 2.9579,    -inf,    -inf,    -inf],
          [ 1.1419,  0.8492,    -inf,    -inf],
          [ 2.8252, -1.2154, -2.3327,    -inf],
          [-1.3800, -3.0540, -5.8608, -5.2914]],

         [[-1.3450,    -inf,    -inf,    -inf],
          [-0.8676,  2.8638,    -inf,    -inf],
          [ 0.9823,  0.0277, -0.4188,    -inf],
          [ 0.5057, -1.4957, -0.8260,  0.4111]],

         [[-1.2317,    -inf,    -inf,    -inf],
          [-2.9212, -4.7330,    -inf,    -inf],
          [-3.6535, -6.3060, -1.4107,    -inf],
          [-0.2347,  0.1875,  2.1911, -1.5206]],

         [[-2.2832,    -inf,    -inf,    -inf],
          [ 3.5761, -1.0840,    -inf,    -inf],
          [ 1.8649,  2.1802,  2.8426,    -inf],
          [-3.9918, -1.1172,  0.4910, -2.7708]],

         [[-0.3716,    -inf,    -inf,    -inf],
          [ 0.1603,  2.3093,    -inf,    -inf],
          [-2.2674,  3.1860,  2.1759,    -inf],
          [-2.0256,  2.1388, -1.0625,  3.6348]],

         [[-1.9784,    -inf,    -inf,    -inf],
          [-0.3058, -2.1252,    -inf,    -inf],
          [-3.1388, -2.3748, -2.6129,    -inf],
          [ 2.2437,  1.5051, -0.4619,  5.9818]],

         [[ 3.2593,    -inf,    -inf,    -inf],
          [ 6.8870, -1.6416,    -inf,    -inf],
          [-1.0752, -0.5561,  1.6089,    -inf],
          [ 0.8390, -1.2502, -2.8305, -1.1005]],

         [[ 1.0482,    -inf,    -inf,    -inf],
          [-2.1150,  2.6368,    -inf,    -inf],
          [ 0.8497,  0.3744,  0.0232,    -inf],
          [ 1.2276,  1.0204,  0.1450, -0.1858]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 2.8810e-01, -8.1649e-01, -8.4913e-01,  ..., -6.9417e-02,
           -3.5223e-01, -4.7362e-01],
          [-6.2043e-01,  8.1394e-02,  7.4891e-01,  ...,  4.1952e-02,
            4.5911e-01,  6.1803e-02],
          [-3.4525e-01,  7.3533e-02, -7.3377e-01,  ...,  5.1395e-01,
           -5.5736e-01, -2.5020e-01],
          ...,
          [-3.2657e-01, -9.5011e-01,  1.3439e+00,  ...,  3.7457e-01,
            5.9121e-01, -1.3895e-02],
          [ 4.5746e-01, -6.1759e-01, -4.6419e-01,  ..., -1.4334e-01,
           -1.6143e-01, -1.6023e-01],
          [ 4.8730e-01, -1.0029e+00, -6.9808e-01,  ...,  5.1623e-01,
            7.7624e-01, -8.0535e-01]],

         [[ 8.8051e-02, -1.1010e+00, -9.7036e-01,  ...,  3.2908e-01,
            1.1372e-01, -2.0187e-01],
          [-2.1428e-01, -5.9575e-01,  4.7220e-01,  ...,  7.0683e-01,
            9.1062e-01, -2.0584e-01],
          [ 1.4850e-01, -2.0583e-01,  9.1983e-02,  ...,  1.0060e+00,
           -7.7230e-01,  1.2151e-02],
          ...,
          [-3.6994e-02, -8.6159e-01,  6.6712e-01,  ...,  1.5164e-01,
            6.5508e-01,  1.4772e-02],
          [ 2.5212e-01, -4.2977e-01, -8.0315e-03,  ..., -9.2209e-02,
           -7.3137e-02,  6.9027e-02],
          [-1.0607e-01, -8.2377e-01, -3.9132e-01,  ...,  5.0795e-01,
            6.2532e-01, -9.2170e-01]],

         [[-2.7907e-02, -6.7089e-01, -9.9342e-01,  ...,  1.8429e-01,
           -1.9547e-01, -3.2596e-01],
          [ 7.6118e-01, -1.0129e-01,  6.2875e-01,  ...,  5.2087e-02,
            8.1644e-02, -3.3612e-01],
          [-1.4102e-01,  9.6666e-02,  1.9976e-02,  ...,  7.6612e-01,
           -7.3330e-01, -3.3877e-01],
          ...,
          [-6.0636e-01, -5.4087e-01, -2.1584e-01,  ...,  2.9785e-01,
            5.9569e-01,  4.0853e-01],
          [-3.5163e-02, -3.9723e-01,  5.9200e-01,  ..., -7.1009e-01,
           -3.8120e-01,  2.7147e-01],
          [ 1.0448e-01, -4.4163e-01, -2.5129e-01,  ...,  5.5880e-01,
            5.3157e-01, -8.5941e-01]],

         [[ 2.3934e-02, -5.3740e-01, -7.0947e-01,  ...,  2.5288e-01,
           -5.0877e-02, -4.2100e-02],
          [ 2.1928e-01, -3.9634e-01,  4.2930e-01,  ...,  4.3054e-01,
            5.1706e-01, -2.5110e-01],
          [-2.0356e-01,  3.7968e-01,  2.0109e-01,  ...,  2.0473e-01,
           -4.3363e-01, -3.5310e-02],
          ...,
          [-4.2031e-01, -2.0577e-01,  1.9390e-01,  ...,  2.6291e-01,
            5.1467e-01,  2.5872e-01],
          [-1.5011e-01, -3.9505e-01,  8.2970e-02,  ..., -4.1708e-01,
           -4.9569e-01,  6.1857e-02],
          [-1.2324e-01, -3.5369e-01, -3.5623e-01,  ...,  6.6848e-01,
            5.3422e-01, -7.6056e-01]]],


        [[[ 8.9843e-04, -6.6937e-01, -1.0798e+00,  ..., -4.2239e-01,
           -2.2703e-01, -3.3376e-02],
          [-2.2093e-01,  5.9470e-01,  6.2649e-01,  ...,  2.2534e-01,
            2.3534e-01, -2.4446e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [-2.2106e-01, -9.1855e-01,  6.5017e-01,  ...,  7.9593e-01,
            4.8297e-01, -8.8720e-02],
          [ 4.8179e-01, -1.8119e-02, -4.9115e-01,  ...,  1.8435e-01,
            1.5813e-01, -8.2356e-02],
          [ 2.4791e-01, -1.6251e+00, -7.0385e-01,  ...,  6.7210e-01,
            1.2099e+00, -4.5992e-01]],

         [[ 1.8706e-02, -1.0839e+00, -1.0763e+00,  ..., -1.9236e-01,
           -4.8070e-01,  1.6263e-01],
          [-3.9123e-01,  6.3314e-01,  5.0265e-01,  ..., -8.8435e-02,
            2.5604e-01,  1.8283e-01],
          [ 2.1298e-02,  2.9671e-01, -4.2976e-01,  ...,  3.8420e-01,
           -4.0286e-01, -2.6554e-01],
          ...,
          [ 4.1838e-02, -8.7969e-01, -6.7018e-02,  ...,  5.0562e-01,
            2.0337e-01,  1.3641e-01],
          [ 5.0276e-01, -2.1075e-02, -4.2980e-01,  ...,  3.4079e-01,
            6.4836e-02,  5.0443e-03],
          [-4.9710e-01, -3.1080e-01,  1.3951e-02,  ..., -5.3463e-01,
            6.1979e-01, -9.2089e-01]],

         [[ 2.0271e-01, -6.3566e-01, -1.1214e+00,  ..., -3.3399e-01,
           -4.2508e-01,  4.6857e-02],
          [-1.1599e-01,  7.7664e-01,  7.1466e-01,  ..., -2.3820e-01,
           -3.8660e-03, -4.4268e-03],
          [ 1.3291e-01,  6.5014e-01, -1.2387e-01,  ...,  7.6234e-01,
           -4.0779e-01, -5.7922e-01],
          ...,
          [-2.2987e-01, -2.3209e-01, -4.7582e-02,  ...,  3.7946e-01,
            1.0583e-01,  1.7052e-01],
          [ 3.3528e-01, -4.7286e-01,  7.7153e-02,  ...,  2.8646e-01,
           -2.2046e-01,  4.2785e-01],
          [ 6.8212e-03, -1.0740e+00, -3.0598e-01,  ...,  3.2770e-01,
            5.6244e-01, -8.3303e-01]],

         [[ 1.8768e-01, -6.3137e-01, -9.3127e-01,  ..., -1.1458e-01,
           -3.8503e-01,  1.1405e-01],
          [ 1.7460e-02,  5.6616e-01,  8.4236e-01,  ..., -3.0143e-01,
           -1.8136e-01, -6.0276e-02],
          [-1.9632e-02,  2.9676e-01, -8.8394e-02,  ...,  1.9261e-01,
           -1.8201e-02, -3.0950e-01],
          ...,
          [-1.9827e-01, -2.1094e-01, -4.7257e-02,  ...,  3.8117e-01,
           -1.2174e-01,  2.0759e-01],
          [ 1.3960e-01, -8.1387e-02, -3.7331e-01,  ...,  2.6615e-01,
           -4.1257e-01,  1.5072e-01],
          [-1.1357e-01, -8.6905e-01, -3.1273e-01,  ...,  4.4077e-01,
            3.4781e-01, -7.9121e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 2.8810e-01, -8.1649e-01, -8.4913e-01,  ...,  5.1623e-01,
           7.7624e-01, -8.0535e-01],
         [ 8.8051e-02, -1.1010e+00, -9.7036e-01,  ...,  5.0795e-01,
           6.2532e-01, -9.2170e-01],
         [-2.7907e-02, -6.7089e-01, -9.9342e-01,  ...,  5.5880e-01,
           5.3157e-01, -8.5941e-01],
         [ 2.3934e-02, -5.3740e-01, -7.0947e-01,  ...,  6.6848e-01,
           5.3422e-01, -7.6056e-01]],

        [[ 8.9843e-04, -6.6937e-01, -1.0798e+00,  ...,  6.7210e-01,
           1.2099e+00, -4.5992e-01],
         [ 1.8706e-02, -1.0839e+00, -1.0763e+00,  ..., -5.3463e-01,
           6.1979e-01, -9.2089e-01],
         [ 2.0271e-01, -6.3566e-01, -1.1214e+00,  ...,  3.2770e-01,
           5.6244e-01, -8.3303e-01],
         [ 1.8768e-01, -6.3137e-01, -9.3127e-01,  ...,  4.4077e-01,
           3.4781e-01, -7.9121e-01]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.3925,  0.5039,  0.5540,  ..., -0.5254, -0.4681, -0.1123],
         [ 0.1242,  0.3716,  0.1022,  ..., -0.1277, -0.4608,  0.0572],
         [ 0.1149,  0.4071, -0.1019,  ..., -0.0389, -0.2879, -0.1396],
         [ 0.1403,  0.2822, -0.0599,  ...,  0.2589, -0.2884, -0.3241]],

        [[ 0.0703,  0.6121,  0.1980,  ..., -0.5573, -0.0436,  0.7149],
         [ 0.1360,  0.2688, -0.0415,  ..., -0.3598, -0.5337,  0.2481],
         [-0.0633,  0.2885, -0.2116,  ..., -0.0040, -0.3672,  0.2668],
         [-0.1366,  0.3013, -0.1984,  ...,  0.0981, -0.2907,  0.1501]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.5823e+00,        -inf,        -inf,        -inf],
          [-2.7772e+00,  1.9922e+00,        -inf,        -inf],
          [-4.1557e-01,  2.5934e+00,  3.9169e-01,        -inf],
          [-1.6977e+00,  3.4082e+00, -2.2898e-01,  1.1723e+00]],

         [[-1.5981e+00,        -inf,        -inf,        -inf],
          [ 5.7989e+00,  3.6200e+00,        -inf,        -inf],
          [-1.9919e-01,  2.1670e+00, -2.3015e+00,        -inf],
          [-1.5732e+00,  2.0061e+00, -3.4131e-01,  5.4236e-01]],

         [[-1.6075e+00,        -inf,        -inf,        -inf],
          [-1.2022e+00,  1.3357e+00,        -inf,        -inf],
          [-1.4234e+00, -3.5830e-01,  6.2510e+00,        -inf],
          [-5.4121e-01,  4.6428e+00,  2.3629e+00, -6.3923e+00]],

         [[ 1.6144e-01,        -inf,        -inf,        -inf],
          [-1.9696e+00, -3.5551e+00,        -inf,        -inf],
          [-8.4346e-01, -1.5150e+00, -6.1134e-01,        -inf],
          [-1.1243e+00, -5.1514e+00,  6.1712e-01, -8.1838e-01]],

         [[-9.4630e+00,        -inf,        -inf,        -inf],
          [-7.8382e+00,  1.0356e+00,        -inf,        -inf],
          [ 1.7061e+00, -3.3643e+00, -2.4521e+00,        -inf],
          [ 1.0997e+00, -3.3912e+00, -6.4297e-01,  3.4250e+00]],

         [[-1.6698e+00,        -inf,        -inf,        -inf],
          [ 2.5383e+00, -1.6270e+00,        -inf,        -inf],
          [ 8.7377e-02, -1.4629e-01, -1.0100e-01,        -inf],
          [ 3.3169e+00, -4.2725e-01, -2.7145e+00, -3.2070e+00]],

         [[-4.0469e+00,        -inf,        -inf,        -inf],
          [-5.6036e+00, -1.1323e+00,        -inf,        -inf],
          [ 1.7269e+00,  1.6055e+00,  1.8968e+00,        -inf],
          [-1.5607e+00, -2.8880e+00, -1.8530e+00, -2.8130e-01]],

         [[ 1.4666e+00,        -inf,        -inf,        -inf],
          [-3.6559e+00, -1.3913e+00,        -inf,        -inf],
          [ 3.8695e+00, -1.2081e+00,  2.7062e+00,        -inf],
          [ 2.6880e+00, -5.0956e-01,  9.7262e+00, -6.4130e-01]],

         [[ 3.2310e+00,        -inf,        -inf,        -inf],
          [ 2.5015e-01,  3.3627e+00,        -inf,        -inf],
          [-7.1584e+00, -4.8488e+00, -2.5737e-01,        -inf],
          [-9.0896e-02, -7.0541e+00,  2.0107e+00, -7.7720e-01]],

         [[ 2.5617e+00,        -inf,        -inf,        -inf],
          [-4.4401e+00, -2.2957e+00,        -inf,        -inf],
          [ 2.8846e+00,  2.8333e+00,  2.2882e+00,        -inf],
          [ 4.8941e-01,  1.5328e+00,  1.3854e+00, -6.9016e-01]],

         [[-2.1697e+00,        -inf,        -inf,        -inf],
          [-5.6813e+00, -9.0505e-01,        -inf,        -inf],
          [-1.7709e+00, -1.9611e+00,  1.1140e+00,        -inf],
          [-4.5636e-02,  1.1513e+00, -2.5024e+00, -2.9282e+00]],

         [[-1.6903e-01,        -inf,        -inf,        -inf],
          [-5.2528e+00, -2.0400e+00,        -inf,        -inf],
          [-9.0389e-01,  1.5750e+00,  1.8376e+00,        -inf],
          [-2.5835e-01, -1.6582e+00, -1.0102e+00,  8.9861e-01]],

         [[ 6.1094e-01,        -inf,        -inf,        -inf],
          [ 2.0341e+00,  4.5809e+00,        -inf,        -inf],
          [-9.3504e-01, -1.9103e+00, -1.5449e+00,        -inf],
          [-3.2753e+00, -8.1292e-01, -3.8326e+00,  5.6370e-01]],

         [[-1.1733e+00,        -inf,        -inf,        -inf],
          [ 6.4733e+00,  4.3558e+00,        -inf,        -inf],
          [ 5.3590e-01, -8.5855e-01, -1.6382e+00,        -inf],
          [ 2.7038e+00,  1.9150e+00,  4.0744e+00, -4.2440e-01]],

         [[ 4.1624e+00,        -inf,        -inf,        -inf],
          [ 2.3451e+00,  3.2944e+00,        -inf,        -inf],
          [ 4.2839e+00, -1.1610e-01, -1.7553e+00,        -inf],
          [ 2.8053e+00,  1.1993e+00, -3.8677e+00,  2.0825e+00]],

         [[ 2.2183e+00,        -inf,        -inf,        -inf],
          [-2.4519e+00, -4.2457e+00,        -inf,        -inf],
          [ 3.1255e+00,  1.1664e+00,  3.4639e+00,        -inf],
          [ 3.2123e+00,  1.0364e+00, -2.1475e+00,  3.0643e+00]],

         [[-5.8461e+00,        -inf,        -inf,        -inf],
          [-6.7067e+00, -1.9271e-03,        -inf,        -inf],
          [-1.5789e+00, -7.2442e-01, -1.4161e+00,        -inf],
          [-2.0039e+00,  1.3253e+00, -1.1161e+00,  1.6556e+00]],

         [[ 1.3029e-01,        -inf,        -inf,        -inf],
          [-3.7002e+00,  5.7016e+00,        -inf,        -inf],
          [ 1.4892e+00,  1.3900e+00, -1.3211e-02,        -inf],
          [ 2.8566e+00,  2.8100e-01,  2.5999e+00, -2.0197e+00]],

         [[-4.1363e+00,        -inf,        -inf,        -inf],
          [ 1.2900e+00,  1.5564e-01,        -inf,        -inf],
          [-6.0346e-01, -2.4337e+00, -7.9227e-01,        -inf],
          [-2.0422e+00,  1.2106e+00, -2.9557e+00, -7.9636e-01]],

         [[-4.1823e-01,        -inf,        -inf,        -inf],
          [-1.6933e+00, -4.3276e+00,        -inf,        -inf],
          [ 6.5722e+00, -5.1524e-01,  1.8441e+00,        -inf],
          [ 8.2870e-01, -4.9845e-01, -1.8431e+00,  2.4263e+00]],

         [[ 1.0646e+00,        -inf,        -inf,        -inf],
          [-1.0986e+00, -2.6933e+00,        -inf,        -inf],
          [-1.1183e+00, -6.5851e+00, -2.2034e+00,        -inf],
          [ 2.9985e-01,  1.2149e+00, -9.8345e-01,  4.7326e+00]],

         [[ 1.2076e+00,        -inf,        -inf,        -inf],
          [-2.7512e+00,  1.4259e+00,        -inf,        -inf],
          [-2.4799e-01,  1.9279e+00,  4.1550e+00,        -inf],
          [ 3.2445e+00,  8.2405e-02,  4.8293e+00,  1.5162e+00]],

         [[ 3.5263e+00,        -inf,        -inf,        -inf],
          [ 7.2184e-01,  3.2810e+00,        -inf,        -inf],
          [ 1.9996e-02, -1.8733e+00,  5.1974e+00,        -inf],
          [-2.7778e-01, -4.1183e+00, -1.1667e+00, -1.2411e+00]],

         [[ 4.2234e+00,        -inf,        -inf,        -inf],
          [ 4.6193e+00,  4.0330e+00,        -inf,        -inf],
          [ 2.5892e+00, -1.5950e-01, -2.9863e+00,        -inf],
          [ 5.9829e-01, -2.4095e+00, -1.5875e+00,  3.0835e+00]],

         [[ 3.7370e+00,        -inf,        -inf,        -inf],
          [-1.5920e+00,  5.4947e+00,        -inf,        -inf],
          [-4.1794e+00,  1.6394e+00, -2.1981e+00,        -inf],
          [-4.0420e+00, -3.4039e+00, -1.7401e+00, -2.1368e+00]]],


        [[[ 1.0627e+00,        -inf,        -inf,        -inf],
          [-2.6895e+00, -3.6585e-01,        -inf,        -inf],
          [-2.8839e-01,  7.4086e-02,  2.4481e+00,        -inf],
          [ 6.0218e-01, -1.6222e+00, -2.5736e+00, -1.8601e+00]],

         [[-9.8197e-01,        -inf,        -inf,        -inf],
          [ 4.9217e-01, -3.3269e+00,        -inf,        -inf],
          [-4.4493e-01, -1.0274e-01,  9.8534e-01,        -inf],
          [-9.0748e-01,  1.5099e+00, -1.9568e+00,  5.3803e-01]],

         [[-3.8514e+00,        -inf,        -inf,        -inf],
          [ 4.0161e-01,  1.8319e+00,        -inf,        -inf],
          [ 3.9758e-01,  6.8405e-01,  1.6104e-01,        -inf],
          [ 2.6883e+00,  1.1979e+00, -1.6688e+00, -3.5487e+00]],

         [[-4.7239e-01,        -inf,        -inf,        -inf],
          [-1.1071e+00, -3.3636e+00,        -inf,        -inf],
          [-2.1097e+00, -3.6973e+00, -2.0739e+00,        -inf],
          [ 1.5050e+00,  4.1756e+00,  4.2173e+00,  2.1048e+00]],

         [[-9.0768e+00,        -inf,        -inf,        -inf],
          [-1.4159e+00, -3.9187e+00,        -inf,        -inf],
          [ 1.3433e+00,  3.1033e+00, -2.4530e+00,        -inf],
          [ 4.0805e+00,  3.5108e+00, -9.1908e-01,  4.5642e-01]],

         [[ 1.0242e+00,        -inf,        -inf,        -inf],
          [ 2.1270e+00,  1.1205e+00,        -inf,        -inf],
          [ 1.4188e-01,  1.6324e+00, -3.0222e+00,        -inf],
          [ 1.0895e+00,  1.8002e+00,  4.2046e-01, -8.1392e-01]],

         [[-3.7321e+00,        -inf,        -inf,        -inf],
          [-2.8517e+00,  2.1288e+00,        -inf,        -inf],
          [ 2.4683e+00, -1.7842e+00, -3.6092e+00,        -inf],
          [-6.3999e-01, -2.6664e+00,  1.6982e+00,  1.7250e+00]],

         [[ 1.7991e+00,        -inf,        -inf,        -inf],
          [-2.5775e+00,  2.4304e+00,        -inf,        -inf],
          [ 5.3770e-01, -1.2965e-01,  3.4164e-01,        -inf],
          [ 6.6008e-02,  4.7873e+00,  4.7467e+00, -7.7123e-01]],

         [[ 1.7504e+00,        -inf,        -inf,        -inf],
          [ 8.9688e-01, -1.0221e+00,        -inf,        -inf],
          [-2.6017e+00,  4.6397e-01,  3.1299e+00,        -inf],
          [ 1.0005e+00, -5.5944e-01, -2.9326e-01, -1.1637e+00]],

         [[ 4.0932e+00,        -inf,        -inf,        -inf],
          [-1.3371e+00, -1.1017e+00,        -inf,        -inf],
          [ 8.1696e-01, -1.9421e+00,  2.0868e-01,        -inf],
          [ 2.3647e+00,  2.8124e+00,  8.2267e+00,  4.3723e+00]],

         [[-9.2952e-01,        -inf,        -inf,        -inf],
          [-3.4217e+00,  5.3996e+00,        -inf,        -inf],
          [-6.4910e-02,  3.0693e+00,  1.7565e+00,        -inf],
          [-2.2276e+00, -2.1898e+00, -1.9896e+00,  2.2937e+00]],

         [[-1.6105e-01,        -inf,        -inf,        -inf],
          [-3.6028e+00, -3.6151e-01,        -inf,        -inf],
          [ 5.1161e+00, -4.7847e-01,  7.8730e-01,        -inf],
          [ 2.0341e+00, -8.3357e-01, -3.7323e+00,  2.1951e+00]],

         [[ 3.6215e+00,        -inf,        -inf,        -inf],
          [ 5.7407e-01, -1.5895e+00,        -inf,        -inf],
          [ 1.6709e+00,  3.2230e+00, -1.2919e+00,        -inf],
          [ 7.6410e-01,  4.6060e+00,  5.2501e-01, -8.4319e-01]],

         [[-9.9815e-01,        -inf,        -inf,        -inf],
          [ 8.4463e-01,  3.5887e+00,        -inf,        -inf],
          [ 2.1263e+00,  2.0421e+00, -3.1131e+00,        -inf],
          [ 1.1493e+00, -2.2362e+00,  7.9367e-01,  5.8917e-01]],

         [[ 6.8969e+00,        -inf,        -inf,        -inf],
          [ 1.1886e+00, -3.5182e+00,        -inf,        -inf],
          [ 3.4996e+00, -2.8315e+00,  5.7555e+00,        -inf],
          [ 2.3210e+00,  2.3048e+00,  3.8686e-02,  5.6373e+00]],

         [[ 2.1761e+00,        -inf,        -inf,        -inf],
          [ 1.5745e+00,  9.6176e-01,        -inf,        -inf],
          [ 6.7298e+00,  1.2337e+00, -7.7826e-02,        -inf],
          [ 3.7924e+00,  6.1315e+00,  1.3614e+00,  3.8358e+00]],

         [[-5.2435e+00,        -inf,        -inf,        -inf],
          [-5.8271e+00,  2.5519e+00,        -inf,        -inf],
          [ 2.1868e+00,  4.0967e+00,  6.0056e-01,        -inf],
          [-1.8466e+00,  1.3949e+00, -3.1631e+00,  3.6005e-01]],

         [[ 1.1768e+00,        -inf,        -inf,        -inf],
          [ 4.1103e-01, -1.4656e+00,        -inf,        -inf],
          [-4.3235e+00,  2.1780e+00,  3.2388e+00,        -inf],
          [-1.1935e+00,  2.0271e+00, -6.0359e-01,  9.2598e-01]],

         [[-4.6266e+00,        -inf,        -inf,        -inf],
          [ 3.0465e-01,  1.8980e+00,        -inf,        -inf],
          [ 3.5688e+00, -3.5552e-01,  3.0607e-01,        -inf],
          [-1.1610e+00, -2.6556e+00, -1.9966e+00, -7.2319e-01]],

         [[-5.5253e-01,        -inf,        -inf,        -inf],
          [-3.2581e-01, -1.3986e+00,        -inf,        -inf],
          [-7.8960e-01, -1.2077e-01, -4.6753e-01,        -inf],
          [ 5.2628e+00, -1.0605e+00,  2.5097e+00,  3.0443e+00]],

         [[-6.6079e-01,        -inf,        -inf,        -inf],
          [-1.5839e+00,  4.1810e-01,        -inf,        -inf],
          [ 2.0213e-01, -6.1497e-01, -1.0903e+00,        -inf],
          [ 2.1491e-01,  4.9853e+00,  1.8561e+00,  5.3271e-01]],

         [[ 1.6327e+00,        -inf,        -inf,        -inf],
          [-3.2687e+00,  2.6497e+00,        -inf,        -inf],
          [-1.3505e+00,  3.5353e+00,  7.4271e-01,        -inf],
          [ 8.8323e-01, -1.7804e-01,  2.7559e-01,  1.5961e+00]],

         [[ 5.7800e-01,        -inf,        -inf,        -inf],
          [-4.5049e+00,  2.7915e+00,        -inf,        -inf],
          [-4.4496e-01,  2.2454e+00,  1.3343e+00,        -inf],
          [ 1.5126e+00, -2.3992e+00,  2.4311e+00,  9.2618e-01]],

         [[ 5.0964e+00,        -inf,        -inf,        -inf],
          [ 4.5252e+00,  1.1355e+00,        -inf,        -inf],
          [-3.2812e+00,  2.3223e+00, -3.5261e+00,        -inf],
          [-2.8015e+00, -2.8793e+00, -2.0589e+00,  3.4373e+00]],

         [[ 5.6002e+00,        -inf,        -inf,        -inf],
          [ 1.0663e+00,  5.0124e+00,        -inf,        -inf],
          [-7.9595e+00,  3.4697e-01, -3.7425e+00,        -inf],
          [-1.9489e+00, -1.1906e+00,  3.9359e-01, -1.2874e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.5823e+00,        -inf,        -inf,        -inf],
          [-2.7772e+00,  1.9922e+00,        -inf,        -inf],
          [-4.1557e-01,  2.5934e+00,  3.9169e-01,        -inf],
          [-1.6977e+00,  3.4082e+00, -2.2898e-01,  1.1723e+00]],

         [[-1.5981e+00,        -inf,        -inf,        -inf],
          [ 5.7989e+00,  3.6200e+00,        -inf,        -inf],
          [-1.9919e-01,  2.1670e+00, -2.3015e+00,        -inf],
          [-1.5732e+00,  2.0061e+00, -3.4131e-01,  5.4236e-01]],

         [[-1.6075e+00,        -inf,        -inf,        -inf],
          [-1.2022e+00,  1.3357e+00,        -inf,        -inf],
          [-1.4234e+00, -3.5830e-01,  6.2510e+00,        -inf],
          [-5.4121e-01,  4.6428e+00,  2.3629e+00, -6.3923e+00]],

         [[ 1.6144e-01,        -inf,        -inf,        -inf],
          [-1.9696e+00, -3.5551e+00,        -inf,        -inf],
          [-8.4346e-01, -1.5150e+00, -6.1134e-01,        -inf],
          [-1.1243e+00, -5.1514e+00,  6.1712e-01, -8.1838e-01]],

         [[-9.4630e+00,        -inf,        -inf,        -inf],
          [-7.8382e+00,  1.0356e+00,        -inf,        -inf],
          [ 1.7061e+00, -3.3643e+00, -2.4521e+00,        -inf],
          [ 1.0997e+00, -3.3912e+00, -6.4297e-01,  3.4250e+00]],

         [[-1.6698e+00,        -inf,        -inf,        -inf],
          [ 2.5383e+00, -1.6270e+00,        -inf,        -inf],
          [ 8.7377e-02, -1.4629e-01, -1.0100e-01,        -inf],
          [ 3.3169e+00, -4.2725e-01, -2.7145e+00, -3.2070e+00]],

         [[-4.0469e+00,        -inf,        -inf,        -inf],
          [-5.6036e+00, -1.1323e+00,        -inf,        -inf],
          [ 1.7269e+00,  1.6055e+00,  1.8968e+00,        -inf],
          [-1.5607e+00, -2.8880e+00, -1.8530e+00, -2.8130e-01]],

         [[ 1.4666e+00,        -inf,        -inf,        -inf],
          [-3.6559e+00, -1.3913e+00,        -inf,        -inf],
          [ 3.8695e+00, -1.2081e+00,  2.7062e+00,        -inf],
          [ 2.6880e+00, -5.0956e-01,  9.7262e+00, -6.4130e-01]],

         [[ 3.2310e+00,        -inf,        -inf,        -inf],
          [ 2.5015e-01,  3.3627e+00,        -inf,        -inf],
          [-7.1584e+00, -4.8488e+00, -2.5737e-01,        -inf],
          [-9.0896e-02, -7.0541e+00,  2.0107e+00, -7.7720e-01]],

         [[ 2.5617e+00,        -inf,        -inf,        -inf],
          [-4.4401e+00, -2.2957e+00,        -inf,        -inf],
          [ 2.8846e+00,  2.8333e+00,  2.2882e+00,        -inf],
          [ 4.8941e-01,  1.5328e+00,  1.3854e+00, -6.9016e-01]],

         [[-2.1697e+00,        -inf,        -inf,        -inf],
          [-5.6813e+00, -9.0505e-01,        -inf,        -inf],
          [-1.7709e+00, -1.9611e+00,  1.1140e+00,        -inf],
          [-4.5636e-02,  1.1513e+00, -2.5024e+00, -2.9282e+00]],

         [[-1.6903e-01,        -inf,        -inf,        -inf],
          [-5.2528e+00, -2.0400e+00,        -inf,        -inf],
          [-9.0389e-01,  1.5750e+00,  1.8376e+00,        -inf],
          [-2.5835e-01, -1.6582e+00, -1.0102e+00,  8.9861e-01]],

         [[ 6.1094e-01,        -inf,        -inf,        -inf],
          [ 2.0341e+00,  4.5809e+00,        -inf,        -inf],
          [-9.3504e-01, -1.9103e+00, -1.5449e+00,        -inf],
          [-3.2753e+00, -8.1292e-01, -3.8326e+00,  5.6370e-01]],

         [[-1.1733e+00,        -inf,        -inf,        -inf],
          [ 6.4733e+00,  4.3558e+00,        -inf,        -inf],
          [ 5.3590e-01, -8.5855e-01, -1.6382e+00,        -inf],
          [ 2.7038e+00,  1.9150e+00,  4.0744e+00, -4.2440e-01]],

         [[ 4.1624e+00,        -inf,        -inf,        -inf],
          [ 2.3451e+00,  3.2944e+00,        -inf,        -inf],
          [ 4.2839e+00, -1.1610e-01, -1.7553e+00,        -inf],
          [ 2.8053e+00,  1.1993e+00, -3.8677e+00,  2.0825e+00]],

         [[ 2.2183e+00,        -inf,        -inf,        -inf],
          [-2.4519e+00, -4.2457e+00,        -inf,        -inf],
          [ 3.1255e+00,  1.1664e+00,  3.4639e+00,        -inf],
          [ 3.2123e+00,  1.0364e+00, -2.1475e+00,  3.0643e+00]],

         [[-5.8461e+00,        -inf,        -inf,        -inf],
          [-6.7067e+00, -1.9271e-03,        -inf,        -inf],
          [-1.5789e+00, -7.2442e-01, -1.4161e+00,        -inf],
          [-2.0039e+00,  1.3253e+00, -1.1161e+00,  1.6556e+00]],

         [[ 1.3029e-01,        -inf,        -inf,        -inf],
          [-3.7002e+00,  5.7016e+00,        -inf,        -inf],
          [ 1.4892e+00,  1.3900e+00, -1.3211e-02,        -inf],
          [ 2.8566e+00,  2.8100e-01,  2.5999e+00, -2.0197e+00]],

         [[-4.1363e+00,        -inf,        -inf,        -inf],
          [ 1.2900e+00,  1.5564e-01,        -inf,        -inf],
          [-6.0346e-01, -2.4337e+00, -7.9227e-01,        -inf],
          [-2.0422e+00,  1.2106e+00, -2.9557e+00, -7.9636e-01]],

         [[-4.1823e-01,        -inf,        -inf,        -inf],
          [-1.6933e+00, -4.3276e+00,        -inf,        -inf],
          [ 6.5722e+00, -5.1524e-01,  1.8441e+00,        -inf],
          [ 8.2870e-01, -4.9845e-01, -1.8431e+00,  2.4263e+00]],

         [[ 1.0646e+00,        -inf,        -inf,        -inf],
          [-1.0986e+00, -2.6933e+00,        -inf,        -inf],
          [-1.1183e+00, -6.5851e+00, -2.2034e+00,        -inf],
          [ 2.9985e-01,  1.2149e+00, -9.8345e-01,  4.7326e+00]],

         [[ 1.2076e+00,        -inf,        -inf,        -inf],
          [-2.7512e+00,  1.4259e+00,        -inf,        -inf],
          [-2.4799e-01,  1.9279e+00,  4.1550e+00,        -inf],
          [ 3.2445e+00,  8.2405e-02,  4.8293e+00,  1.5162e+00]],

         [[ 3.5263e+00,        -inf,        -inf,        -inf],
          [ 7.2184e-01,  3.2810e+00,        -inf,        -inf],
          [ 1.9996e-02, -1.8733e+00,  5.1974e+00,        -inf],
          [-2.7778e-01, -4.1183e+00, -1.1667e+00, -1.2411e+00]],

         [[ 4.2234e+00,        -inf,        -inf,        -inf],
          [ 4.6193e+00,  4.0330e+00,        -inf,        -inf],
          [ 2.5892e+00, -1.5950e-01, -2.9863e+00,        -inf],
          [ 5.9829e-01, -2.4095e+00, -1.5875e+00,  3.0835e+00]],

         [[ 3.7370e+00,        -inf,        -inf,        -inf],
          [-1.5920e+00,  5.4947e+00,        -inf,        -inf],
          [-4.1794e+00,  1.6394e+00, -2.1981e+00,        -inf],
          [-4.0420e+00, -3.4039e+00, -1.7401e+00, -2.1368e+00]]],


        [[[ 1.0627e+00,        -inf,        -inf,        -inf],
          [-2.6895e+00, -3.6585e-01,        -inf,        -inf],
          [-2.8839e-01,  7.4086e-02,  2.4481e+00,        -inf],
          [ 6.0218e-01, -1.6222e+00, -2.5736e+00, -1.8601e+00]],

         [[-9.8197e-01,        -inf,        -inf,        -inf],
          [ 4.9217e-01, -3.3269e+00,        -inf,        -inf],
          [-4.4493e-01, -1.0274e-01,  9.8534e-01,        -inf],
          [-9.0748e-01,  1.5099e+00, -1.9568e+00,  5.3803e-01]],

         [[-3.8514e+00,        -inf,        -inf,        -inf],
          [ 4.0161e-01,  1.8319e+00,        -inf,        -inf],
          [ 3.9758e-01,  6.8405e-01,  1.6104e-01,        -inf],
          [ 2.6883e+00,  1.1979e+00, -1.6688e+00, -3.5487e+00]],

         [[-4.7239e-01,        -inf,        -inf,        -inf],
          [-1.1071e+00, -3.3636e+00,        -inf,        -inf],
          [-2.1097e+00, -3.6973e+00, -2.0739e+00,        -inf],
          [ 1.5050e+00,  4.1756e+00,  4.2173e+00,  2.1048e+00]],

         [[-9.0768e+00,        -inf,        -inf,        -inf],
          [-1.4159e+00, -3.9187e+00,        -inf,        -inf],
          [ 1.3433e+00,  3.1033e+00, -2.4530e+00,        -inf],
          [ 4.0805e+00,  3.5108e+00, -9.1908e-01,  4.5642e-01]],

         [[ 1.0242e+00,        -inf,        -inf,        -inf],
          [ 2.1270e+00,  1.1205e+00,        -inf,        -inf],
          [ 1.4188e-01,  1.6324e+00, -3.0222e+00,        -inf],
          [ 1.0895e+00,  1.8002e+00,  4.2046e-01, -8.1392e-01]],

         [[-3.7321e+00,        -inf,        -inf,        -inf],
          [-2.8517e+00,  2.1288e+00,        -inf,        -inf],
          [ 2.4683e+00, -1.7842e+00, -3.6092e+00,        -inf],
          [-6.3999e-01, -2.6664e+00,  1.6982e+00,  1.7250e+00]],

         [[ 1.7991e+00,        -inf,        -inf,        -inf],
          [-2.5775e+00,  2.4304e+00,        -inf,        -inf],
          [ 5.3770e-01, -1.2965e-01,  3.4164e-01,        -inf],
          [ 6.6008e-02,  4.7873e+00,  4.7467e+00, -7.7123e-01]],

         [[ 1.7504e+00,        -inf,        -inf,        -inf],
          [ 8.9688e-01, -1.0221e+00,        -inf,        -inf],
          [-2.6017e+00,  4.6397e-01,  3.1299e+00,        -inf],
          [ 1.0005e+00, -5.5944e-01, -2.9326e-01, -1.1637e+00]],

         [[ 4.0932e+00,        -inf,        -inf,        -inf],
          [-1.3371e+00, -1.1017e+00,        -inf,        -inf],
          [ 8.1696e-01, -1.9421e+00,  2.0868e-01,        -inf],
          [ 2.3647e+00,  2.8124e+00,  8.2267e+00,  4.3723e+00]],

         [[-9.2952e-01,        -inf,        -inf,        -inf],
          [-3.4217e+00,  5.3996e+00,        -inf,        -inf],
          [-6.4910e-02,  3.0693e+00,  1.7565e+00,        -inf],
          [-2.2276e+00, -2.1898e+00, -1.9896e+00,  2.2937e+00]],

         [[-1.6105e-01,        -inf,        -inf,        -inf],
          [-3.6028e+00, -3.6151e-01,        -inf,        -inf],
          [ 5.1161e+00, -4.7847e-01,  7.8730e-01,        -inf],
          [ 2.0341e+00, -8.3357e-01, -3.7323e+00,  2.1951e+00]],

         [[ 3.6215e+00,        -inf,        -inf,        -inf],
          [ 5.7407e-01, -1.5895e+00,        -inf,        -inf],
          [ 1.6709e+00,  3.2230e+00, -1.2919e+00,        -inf],
          [ 7.6410e-01,  4.6060e+00,  5.2501e-01, -8.4319e-01]],

         [[-9.9815e-01,        -inf,        -inf,        -inf],
          [ 8.4463e-01,  3.5887e+00,        -inf,        -inf],
          [ 2.1263e+00,  2.0421e+00, -3.1131e+00,        -inf],
          [ 1.1493e+00, -2.2362e+00,  7.9367e-01,  5.8917e-01]],

         [[ 6.8969e+00,        -inf,        -inf,        -inf],
          [ 1.1886e+00, -3.5182e+00,        -inf,        -inf],
          [ 3.4996e+00, -2.8315e+00,  5.7555e+00,        -inf],
          [ 2.3210e+00,  2.3048e+00,  3.8686e-02,  5.6373e+00]],

         [[ 2.1761e+00,        -inf,        -inf,        -inf],
          [ 1.5745e+00,  9.6176e-01,        -inf,        -inf],
          [ 6.7298e+00,  1.2337e+00, -7.7826e-02,        -inf],
          [ 3.7924e+00,  6.1315e+00,  1.3614e+00,  3.8358e+00]],

         [[-5.2435e+00,        -inf,        -inf,        -inf],
          [-5.8271e+00,  2.5519e+00,        -inf,        -inf],
          [ 2.1868e+00,  4.0967e+00,  6.0056e-01,        -inf],
          [-1.8466e+00,  1.3949e+00, -3.1631e+00,  3.6005e-01]],

         [[ 1.1768e+00,        -inf,        -inf,        -inf],
          [ 4.1103e-01, -1.4656e+00,        -inf,        -inf],
          [-4.3235e+00,  2.1780e+00,  3.2388e+00,        -inf],
          [-1.1935e+00,  2.0271e+00, -6.0359e-01,  9.2598e-01]],

         [[-4.6266e+00,        -inf,        -inf,        -inf],
          [ 3.0465e-01,  1.8980e+00,        -inf,        -inf],
          [ 3.5688e+00, -3.5552e-01,  3.0607e-01,        -inf],
          [-1.1610e+00, -2.6556e+00, -1.9966e+00, -7.2319e-01]],

         [[-5.5253e-01,        -inf,        -inf,        -inf],
          [-3.2581e-01, -1.3986e+00,        -inf,        -inf],
          [-7.8960e-01, -1.2077e-01, -4.6753e-01,        -inf],
          [ 5.2628e+00, -1.0605e+00,  2.5097e+00,  3.0443e+00]],

         [[-6.6079e-01,        -inf,        -inf,        -inf],
          [-1.5839e+00,  4.1810e-01,        -inf,        -inf],
          [ 2.0213e-01, -6.1497e-01, -1.0903e+00,        -inf],
          [ 2.1491e-01,  4.9853e+00,  1.8561e+00,  5.3271e-01]],

         [[ 1.6327e+00,        -inf,        -inf,        -inf],
          [-3.2687e+00,  2.6497e+00,        -inf,        -inf],
          [-1.3505e+00,  3.5353e+00,  7.4271e-01,        -inf],
          [ 8.8323e-01, -1.7804e-01,  2.7559e-01,  1.5961e+00]],

         [[ 5.7800e-01,        -inf,        -inf,        -inf],
          [-4.5049e+00,  2.7915e+00,        -inf,        -inf],
          [-4.4496e-01,  2.2454e+00,  1.3343e+00,        -inf],
          [ 1.5126e+00, -2.3992e+00,  2.4311e+00,  9.2618e-01]],

         [[ 5.0964e+00,        -inf,        -inf,        -inf],
          [ 4.5252e+00,  1.1355e+00,        -inf,        -inf],
          [-3.2812e+00,  2.3223e+00, -3.5261e+00,        -inf],
          [-2.8015e+00, -2.8793e+00, -2.0589e+00,  3.4373e+00]],

         [[ 5.6002e+00,        -inf,        -inf,        -inf],
          [ 1.0663e+00,  5.0124e+00,        -inf,        -inf],
          [-7.9595e+00,  3.4697e-01, -3.7425e+00,        -inf],
          [-1.9489e+00, -1.1906e+00,  3.9359e-01, -1.2874e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.1019, -0.4400,  1.2375,  ...,  0.3228, -0.9648,  0.3698],
          [-0.0710, -0.4782,  1.5319,  ..., -0.0321,  0.4690, -0.9972],
          [-0.1677,  0.1167,  0.2496,  ..., -0.1033,  0.9545,  0.4398],
          ...,
          [-1.0714,  0.0553,  1.2268,  ..., -0.5539, -0.2875, -0.4740],
          [-0.9933, -0.3939, -0.0414,  ...,  1.1103,  0.3551,  0.7470],
          [ 1.3977, -0.5911,  0.3018,  ..., -1.2546, -0.1348,  0.0731]],

         [[ 0.3313,  0.4235,  0.8129,  ...,  0.1973, -0.2371,  0.6791],
          [-0.3155, -0.4277,  0.4630,  ..., -0.4350,  0.0821,  0.0479],
          [-0.2565, -0.0448, -0.0561,  ...,  0.3524,  0.7792,  0.5320],
          ...,
          [-0.1475, -0.0654,  0.6790,  ..., -0.5168, -0.4922, -0.3664],
          [-0.5923,  0.0275,  0.3513,  ...,  0.3162,  0.2216,  0.5669],
          [ 0.0441, -0.6176,  0.4426,  ..., -0.5504, -0.1927,  1.1694]],

         [[ 0.2662,  0.2832,  0.7849,  ...,  0.1781, -0.0254,  0.5426],
          [-0.3492, -0.7592,  1.0395,  ..., -0.3418,  0.3149, -0.3261],
          [ 0.6082, -0.7558,  0.4747,  ...,  0.2615,  0.7440,  0.3776],
          ...,
          [ 0.1951,  0.1026,  0.2206,  ..., -0.6365, -0.0762, -0.1821],
          [ 0.0533, -0.0108, -0.1286,  ..., -0.1649,  0.0254,  0.2849],
          [-0.1246, -0.4678,  0.2599,  ..., -0.3036, -0.2050,  1.2408]],

         [[-0.1266,  0.3039,  0.5090,  ...,  0.0986, -0.2402,  0.5099],
          [ 0.0155, -0.7989,  1.0814,  ..., -0.4494, -0.0048, -0.2602],
          [ 0.1651, -0.4989,  0.0399,  ...,  0.4560,  0.7766,  0.4936],
          ...,
          [-0.0982, -0.1005,  0.2713,  ..., -0.6459, -0.1444, -0.3081],
          [ 0.1489, -0.0953, -0.3576,  ..., -0.4376,  0.2423,  0.4868],
          [ 0.5093, -0.1919, -0.1651,  ..., -0.3604, -0.4064,  0.1253]]],


        [[[ 0.3740, -0.1829,  0.7791,  ...,  0.5350, -0.3898,  0.7256],
          [ 0.1301,  0.3235,  1.2356,  ..., -0.6633,  0.7253, -0.7025],
          [-0.0495, -0.4338,  0.5575,  ..., -0.1255,  0.8136,  0.6813],
          ...,
          [-1.3683,  0.3019,  0.9922,  ..., -0.5827, -0.9140,  0.0044],
          [-0.3154, -0.0386,  0.2344,  ...,  0.9095,  0.6487,  0.4017],
          [ 0.9796, -0.2098,  0.5621,  ..., -1.2250,  0.0819, -0.2339]],

         [[ 0.4830,  0.6476,  0.1532,  ...,  0.2905, -0.2133, -0.3187],
          [ 0.0706,  0.2641,  0.8278,  ..., -0.5918,  0.3751, -0.3588],
          [-0.1543, -0.0195,  0.4073,  ...,  0.4817,  0.7086,  0.0071],
          ...,
          [-0.2970, -0.5328,  0.3754,  ..., -0.2601, -0.9773,  0.4198],
          [-0.2054, -0.1276,  0.6374,  ...,  0.3177,  0.7205,  0.2333],
          [-0.1144,  0.0958,  0.8454,  ..., -0.9697,  0.0472,  0.3120]],

         [[ 0.2363,  0.1963,  0.5492,  ...,  0.2506,  0.2453, -0.2815],
          [ 0.2022,  0.1631,  0.8602,  ..., -0.0407,  0.1290, -0.5194],
          [-0.3278, -0.1733,  0.6050,  ...,  0.3929,  0.5642,  0.0800],
          ...,
          [-0.4594, -0.3979,  0.4552,  ..., -0.5752, -0.8483,  0.4090],
          [ 0.0719, -0.0747, -0.1704,  ...,  0.2731,  0.0993,  0.0404],
          [-0.2130, -0.0658,  0.6377,  ..., -0.7541, -0.2156,  0.4832]],

         [[ 0.2309,  0.1754,  0.3893,  ...,  0.2277,  0.0569, -0.1165],
          [-0.0120,  0.0200,  0.8667,  ..., -0.2792, -0.2286, -0.2258],
          [-0.2471, -0.0399, -0.0484,  ...,  0.4428,  0.1429,  0.0276],
          ...,
          [-0.3406, -0.3146,  0.6486,  ..., -0.4245, -0.7812,  0.0878],
          [ 0.1897, -0.1577, -0.4225,  ...,  0.1008,  0.2153, -0.1006],
          [ 0.1069, -0.4800,  0.1552,  ..., -0.7761, -0.3174,  0.4822]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.1019, -0.4400,  1.2375,  ..., -1.2546, -0.1348,  0.0731],
         [ 0.3313,  0.4235,  0.8129,  ..., -0.5504, -0.1927,  1.1694],
         [ 0.2662,  0.2832,  0.7849,  ..., -0.3036, -0.2050,  1.2408],
         [-0.1266,  0.3039,  0.5090,  ..., -0.3604, -0.4064,  0.1253]],

        [[ 0.3740, -0.1829,  0.7791,  ..., -1.2250,  0.0819, -0.2339],
         [ 0.4830,  0.6476,  0.1532,  ..., -0.9697,  0.0472,  0.3120],
         [ 0.2363,  0.1963,  0.5492,  ..., -0.7541, -0.2156,  0.4832],
         [ 0.2309,  0.1754,  0.3893,  ..., -0.7761, -0.3174,  0.4822]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0475,  0.1698, -0.4384,  ..., -0.6286,  0.2587,  0.6374],
         [-0.0667,  0.2407, -0.4595,  ..., -0.1860,  0.2075,  0.1759],
         [ 0.1038,  0.1694, -0.3334,  ..., -0.0540,  0.2907,  0.2976],
         [-0.0328,  0.1253, -0.2320,  ..., -0.1669,  0.2449,  0.2367]],

        [[-0.1143,  0.1496, -0.2430,  ..., -0.5187,  0.2004,  0.5728],
         [-0.2457,  0.2811, -0.3176,  ...,  0.0456,  0.2840,  0.2707],
         [-0.2537,  0.2858, -0.2308,  ...,  0.1488,  0.0691, -0.0531],
         [-0.4772,  0.1388,  0.0212,  ...,  0.1957,  0.0534,  0.0305]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-2.2700e+00,        -inf,        -inf,        -inf],
          [-3.8469e+00, -1.8843e+00,        -inf,        -inf],
          [-2.6390e+00,  6.9289e-01, -2.2872e+00,        -inf],
          [ 1.1488e+00, -1.6679e+00, -1.0981e-01,  2.9911e+00]],

         [[-3.1712e-01,        -inf,        -inf,        -inf],
          [ 3.3876e+00,  6.4782e-01,        -inf,        -inf],
          [ 1.9613e-01,  1.2137e-01,  2.4399e+00,        -inf],
          [-1.1017e+00, -3.6904e+00,  2.3540e+00,  2.5129e+00]],

         [[-1.5942e+00,        -inf,        -inf,        -inf],
          [ 3.3985e+00,  3.5027e+00,        -inf,        -inf],
          [-3.2186e+00, -1.4415e+00, -1.3868e+00,        -inf],
          [-1.5593e+00, -3.7365e+00, -2.1390e+00, -4.0892e+00]],

         [[-1.6196e+00,        -inf,        -inf,        -inf],
          [-3.9527e+00,  1.0669e+00,        -inf,        -inf],
          [-1.8230e+00, -1.3696e+00, -2.5863e+00,        -inf],
          [ 2.7889e+00, -3.8996e+00, -3.2487e+00,  1.3941e-01]],

         [[ 2.3506e-02,        -inf,        -inf,        -inf],
          [ 4.0134e+00,  1.5221e+00,        -inf,        -inf],
          [ 2.3838e+00, -4.0876e+00,  5.6833e+00,        -inf],
          [ 5.9198e+00,  7.1135e-01,  2.1160e+00,  1.5730e+00]],

         [[-6.8486e-01,        -inf,        -inf,        -inf],
          [-1.2882e+00, -5.9502e-01,        -inf,        -inf],
          [-3.3384e+00, -8.1349e-01,  3.1386e+00,        -inf],
          [-1.3410e+00, -4.0143e+00, -1.8013e+00, -4.4906e-01]],

         [[ 1.3214e+00,        -inf,        -inf,        -inf],
          [-3.9383e+00,  4.3234e+00,        -inf,        -inf],
          [ 8.1675e-01,  1.4693e+00, -2.3992e+00,        -inf],
          [ 1.2632e+00, -1.1684e+00,  1.9024e-01, -1.2539e+00]],

         [[ 8.3843e-01,        -inf,        -inf,        -inf],
          [-4.3715e-01, -4.2954e+00,        -inf,        -inf],
          [-3.3910e+00,  1.1409e+00, -1.0798e-01,        -inf],
          [-4.0064e+00, -1.2443e+00,  1.6239e+00, -4.1569e-01]],

         [[ 2.4391e+00,        -inf,        -inf,        -inf],
          [ 8.0364e-01, -2.9789e+00,        -inf,        -inf],
          [ 8.3742e-01,  2.4618e+00,  3.5749e-01,        -inf],
          [ 3.3735e+00, -1.1156e+00, -3.4612e+00,  1.7370e-01]],

         [[ 3.3814e+00,        -inf,        -inf,        -inf],
          [ 4.5687e+00,  3.2043e+00,        -inf,        -inf],
          [ 1.3563e+00,  5.5137e-01,  1.7884e+00,        -inf],
          [-8.9177e-01,  3.0975e+00,  2.8970e+00,  3.5223e-01]],

         [[ 1.0561e+00,        -inf,        -inf,        -inf],
          [ 2.8867e+00,  1.9694e+00,        -inf,        -inf],
          [ 9.3176e-02,  1.6107e-01, -7.9206e-03,        -inf],
          [ 2.9890e-01, -2.1375e+00, -3.2362e+00, -5.8257e+00]],

         [[-8.2507e-01,        -inf,        -inf,        -inf],
          [ 5.8296e-01, -2.7904e+00,        -inf,        -inf],
          [ 2.5311e-01, -2.4882e+00, -2.1537e+00,        -inf],
          [-2.1104e+00, -2.0835e+00,  5.7579e-01,  2.5363e+00]],

         [[-4.4257e+00,        -inf,        -inf,        -inf],
          [-2.3745e-01, -1.1154e+00,        -inf,        -inf],
          [-6.8341e-01, -2.1222e+00, -1.9720e-01,        -inf],
          [-1.7887e+00, -3.2714e+00, -1.4877e+00, -4.5167e+00]],

         [[-4.5035e+00,        -inf,        -inf,        -inf],
          [-1.8799e+00,  1.9831e+00,        -inf,        -inf],
          [ 1.7991e-01,  7.8037e-01,  3.9716e+00,        -inf],
          [ 1.4096e+00,  1.0574e-01,  2.0024e+00, -3.6395e-01]],

         [[ 6.3817e+00,        -inf,        -inf,        -inf],
          [ 5.3330e-01,  2.9331e+00,        -inf,        -inf],
          [ 1.2653e+00, -3.0748e-01,  3.0606e-01,        -inf],
          [ 2.8559e+00,  1.4439e+00,  2.8261e+00,  3.4148e+00]],

         [[-2.8380e+00,        -inf,        -inf,        -inf],
          [-4.5203e-01, -3.4115e+00,        -inf,        -inf],
          [ 2.6864e+00,  5.1160e-02, -2.9251e+00,        -inf],
          [ 1.1117e+00, -4.4068e+00,  2.7910e+00,  7.3477e-01]],

         [[ 4.9215e+00,        -inf,        -inf,        -inf],
          [ 6.1257e+00,  1.2628e+00,        -inf,        -inf],
          [ 2.0252e+00,  3.6905e+00, -3.8744e-01,        -inf],
          [-8.2487e-01,  9.8921e-01, -4.1420e+00,  3.3924e+00]],

         [[-1.3827e+00,        -inf,        -inf,        -inf],
          [-5.7306e-01,  2.1517e+00,        -inf,        -inf],
          [-5.5526e+00,  8.9299e-01, -2.0221e+00,        -inf],
          [-2.5686e+00,  1.3099e+00, -4.0603e+00, -2.6003e+00]],

         [[-1.7672e+00,        -inf,        -inf,        -inf],
          [-5.9324e-01, -2.6891e+00,        -inf,        -inf],
          [-1.6698e+00, -4.9015e+00, -4.5752e-01,        -inf],
          [ 1.7569e+00,  1.8420e+00,  2.5472e+00, -1.4145e+00]],

         [[ 5.2814e-01,        -inf,        -inf,        -inf],
          [-1.3655e+00,  3.5847e+00,        -inf,        -inf],
          [ 3.7219e+00,  6.7779e+00,  4.5789e+00,        -inf],
          [-7.2422e-01,  3.6301e+00, -4.9707e-01, -5.8634e-01]],

         [[ 1.3489e+00,        -inf,        -inf,        -inf],
          [ 2.3606e+00,  8.0826e-01,        -inf,        -inf],
          [-1.0751e+00,  1.1239e+00, -2.4181e+00,        -inf],
          [ 1.0524e+00, -5.3982e-02,  2.5023e+00,  9.3322e-01]],

         [[-3.6117e+00,        -inf,        -inf,        -inf],
          [-7.2251e-01,  5.1178e+00,        -inf,        -inf],
          [ 8.4141e-01,  4.9974e-02,  3.9987e+00,        -inf],
          [ 1.7867e+00,  3.8605e+00,  4.2979e+00,  1.5967e+00]],

         [[ 6.1715e-01,        -inf,        -inf,        -inf],
          [-1.8425e+00,  3.9542e+00,        -inf,        -inf],
          [ 4.3249e+00,  6.1190e+00, -1.2488e+00,        -inf],
          [ 4.3758e-01,  5.2279e-03,  8.8062e-01,  4.6231e+00]],

         [[-7.9420e-01,        -inf,        -inf,        -inf],
          [-1.0858e+00, -1.6080e+00,        -inf,        -inf],
          [ 2.5984e+00, -7.2767e-02, -3.3699e+00,        -inf],
          [ 1.4316e+00,  2.5801e+00,  5.1825e+00,  1.2912e+00]],

         [[ 1.8529e+00,        -inf,        -inf,        -inf],
          [-2.3533e+00, -2.0749e+00,        -inf,        -inf],
          [ 3.4058e+00,  1.9390e+00, -3.6019e+00,        -inf],
          [-2.2362e+00,  3.7031e+00, -3.8892e+00, -4.4188e+00]]],


        [[[-8.4325e-01,        -inf,        -inf,        -inf],
          [-1.8549e+00, -3.7203e+00,        -inf,        -inf],
          [-4.0012e+00,  1.4178e+00,  4.0110e+00,        -inf],
          [-1.5840e+00,  4.0356e+00,  7.0530e+00, -2.9410e+00]],

         [[ 4.1238e-02,        -inf,        -inf,        -inf],
          [ 1.4973e+00, -1.9058e+00,        -inf,        -inf],
          [ 2.9270e+00, -3.5208e-01, -1.1407e+00,        -inf],
          [ 1.1492e+00, -2.5458e-02,  1.0655e+00, -2.5068e+00]],

         [[-4.0944e-02,        -inf,        -inf,        -inf],
          [ 4.5743e+00,  2.1454e+00,        -inf,        -inf],
          [-2.9378e+00,  3.9670e-01,  2.9760e+00,        -inf],
          [-1.3390e+00, -6.1384e-01,  2.1137e+00,  1.7752e+00]],

         [[-5.8799e+00,        -inf,        -inf,        -inf],
          [-1.0561e+00,  2.0264e-01,        -inf,        -inf],
          [-3.7200e+00,  8.0715e-01,  1.9856e+00,        -inf],
          [-1.2903e+00,  1.5055e+00, -2.8991e+00,  7.6563e-01]],

         [[-9.2162e-01,        -inf,        -inf,        -inf],
          [ 1.8434e+00,  6.1425e-02,        -inf,        -inf],
          [ 5.4555e+00,  4.2267e+00,  4.4871e+00,        -inf],
          [ 1.0424e+00, -2.9342e-01,  1.9347e+00, -3.4388e+00]],

         [[ 8.8799e-01,        -inf,        -inf,        -inf],
          [ 3.5899e-01, -3.9694e+00,        -inf,        -inf],
          [-3.4287e+00, -1.7848e+00, -3.5570e+00,        -inf],
          [ 7.0479e-01, -3.8541e+00,  2.6131e+00,  4.3149e-02]],

         [[ 2.9557e-01,        -inf,        -inf,        -inf],
          [-1.6159e+00, -2.2793e-01,        -inf,        -inf],
          [ 6.2343e+00, -1.0379e+00, -2.9794e+00,        -inf],
          [ 1.3438e+00,  5.7354e-01, -7.9121e-01,  7.0925e+00]],

         [[-1.9400e-01,        -inf,        -inf,        -inf],
          [-3.9114e+00,  6.8493e-01,        -inf,        -inf],
          [-4.7987e-01, -7.2324e-01,  1.8598e+00,        -inf],
          [-2.7445e+00, -1.1226e+00, -1.4889e+00, -3.5940e+00]],

         [[ 1.7459e+00,        -inf,        -inf,        -inf],
          [ 1.2442e+00, -2.6953e-01,        -inf,        -inf],
          [ 1.7133e+00, -3.4735e+00, -2.3740e+00,        -inf],
          [ 7.2716e-01,  1.9176e+00,  2.2752e+00,  4.2302e+00]],

         [[ 2.8251e+00,        -inf,        -inf,        -inf],
          [ 1.2305e+00,  4.4841e+00,        -inf,        -inf],
          [ 1.2094e+00, -6.1426e-02,  2.8120e+00,        -inf],
          [-2.5581e+00,  4.3976e+00,  2.0867e+00,  4.8287e+00]],

         [[ 4.4409e+00,        -inf,        -inf,        -inf],
          [ 1.3041e+00,  1.2271e+00,        -inf,        -inf],
          [-1.8908e+00, -1.9235e+00, -1.8139e+00,        -inf],
          [ 3.0257e+00, -3.7592e+00, -2.2576e+00, -4.8347e+00]],

         [[-3.5172e-01,        -inf,        -inf,        -inf],
          [ 2.3675e+00, -1.3470e+00,        -inf,        -inf],
          [-6.1411e-02,  1.8294e+00, -4.9059e-01,        -inf],
          [ 2.8271e+00, -1.5318e+00,  1.0084e+00, -1.6569e+00]],

         [[-2.7142e+00,        -inf,        -inf,        -inf],
          [ 1.4191e+00, -2.3527e+00,        -inf,        -inf],
          [-1.4683e+00,  2.8164e+00,  1.3287e+00,        -inf],
          [-3.2874e-01,  7.5186e-01,  1.3013e+00, -4.3028e+00]],

         [[-6.4234e+00,        -inf,        -inf,        -inf],
          [-1.8634e+00,  5.0337e+00,        -inf,        -inf],
          [-4.7154e+00,  2.3282e+00,  1.9050e+00,        -inf],
          [-2.7655e+00,  3.0832e+00,  3.9222e+00, -1.8103e+00]],

         [[ 6.1339e+00,        -inf,        -inf,        -inf],
          [ 3.3900e+00,  4.1751e+00,        -inf,        -inf],
          [ 2.2797e+00,  3.7881e+00,  5.2102e-01,        -inf],
          [ 2.4435e+00,  1.6260e+00,  3.4024e+00, -2.2775e+00]],

         [[-5.6347e+00,        -inf,        -inf,        -inf],
          [ 3.0812e-01, -2.9717e+00,        -inf,        -inf],
          [ 5.2846e+00, -1.6773e-01, -4.0906e+00,        -inf],
          [ 9.8470e-01, -1.4325e+00, -3.7850e+00, -1.1186e+00]],

         [[ 5.6389e+00,        -inf,        -inf,        -inf],
          [ 5.1174e+00,  2.8975e-01,        -inf,        -inf],
          [ 1.1904e+00,  1.0274e+00,  2.6316e+00,        -inf],
          [ 2.5651e+00, -1.0051e+00, -6.2616e+00, -1.9740e+00]],

         [[-1.3073e+00,        -inf,        -inf,        -inf],
          [ 2.6156e+00,  1.7280e+00,        -inf,        -inf],
          [-1.1097e+00,  1.3359e+00,  4.6783e+00,        -inf],
          [ 7.6340e-01,  1.7184e+00,  1.2247e+00, -2.4975e+00]],

         [[-3.2565e+00,        -inf,        -inf,        -inf],
          [ 3.3683e-01,  1.7216e+00,        -inf,        -inf],
          [-4.4213e-01, -1.4364e+00,  2.9429e-01,        -inf],
          [-3.8522e+00,  2.4738e+00, -4.4823e+00, -1.1523e+00]],

         [[-4.4106e-01,        -inf,        -inf,        -inf],
          [ 1.8853e+00,  1.5598e+00,        -inf,        -inf],
          [ 2.5596e+00,  2.2014e+00,  3.5095e+00,        -inf],
          [-6.3114e-01,  3.1968e+00,  1.2481e-01, -1.2705e-01]],

         [[ 2.8774e+00,        -inf,        -inf,        -inf],
          [-7.1655e-01, -1.1928e+00,        -inf,        -inf],
          [-1.2373e+00, -1.5176e+00, -4.8971e-01,        -inf],
          [ 1.5430e+00,  4.8460e-01, -2.7972e+00,  1.2484e+00]],

         [[-1.5465e+00,        -inf,        -inf,        -inf],
          [-1.2258e+00,  1.7953e+00,        -inf,        -inf],
          [-3.3631e+00, -1.7836e+00, -2.3249e+00,        -inf],
          [ 9.9377e-01,  3.5841e+00,  1.2642e+00, -3.5541e-01]],

         [[-1.9930e+00,        -inf,        -inf,        -inf],
          [ 2.8820e-01, -1.4972e+00,        -inf,        -inf],
          [ 5.4188e+00,  4.5656e+00,  5.8779e-01,        -inf],
          [ 3.8391e-01,  1.0131e+00,  1.6365e+00,  3.0152e+00]],

         [[-1.6160e+00,        -inf,        -inf,        -inf],
          [-2.5718e+00, -4.3731e+00,        -inf,        -inf],
          [ 2.3159e+00,  6.3456e+00,  1.9288e+00,        -inf],
          [ 1.9012e+00, -1.7632e+00,  1.5307e+00,  2.2781e+00]],

         [[ 2.4943e+00,        -inf,        -inf,        -inf],
          [-3.9105e-01,  2.8887e+00,        -inf,        -inf],
          [ 1.0744e+00,  2.3899e+00,  1.6321e+00,        -inf],
          [-8.6953e-01,  1.8552e+00, -2.8787e-01, -5.8443e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-2.2700e+00,        -inf,        -inf,        -inf],
          [-3.8469e+00, -1.8843e+00,        -inf,        -inf],
          [-2.6390e+00,  6.9289e-01, -2.2872e+00,        -inf],
          [ 1.1488e+00, -1.6679e+00, -1.0981e-01,  2.9911e+00]],

         [[-3.1712e-01,        -inf,        -inf,        -inf],
          [ 3.3876e+00,  6.4782e-01,        -inf,        -inf],
          [ 1.9613e-01,  1.2137e-01,  2.4399e+00,        -inf],
          [-1.1017e+00, -3.6904e+00,  2.3540e+00,  2.5129e+00]],

         [[-1.5942e+00,        -inf,        -inf,        -inf],
          [ 3.3985e+00,  3.5027e+00,        -inf,        -inf],
          [-3.2186e+00, -1.4415e+00, -1.3868e+00,        -inf],
          [-1.5593e+00, -3.7365e+00, -2.1390e+00, -4.0892e+00]],

         [[-1.6196e+00,        -inf,        -inf,        -inf],
          [-3.9527e+00,  1.0669e+00,        -inf,        -inf],
          [-1.8230e+00, -1.3696e+00, -2.5863e+00,        -inf],
          [ 2.7889e+00, -3.8996e+00, -3.2487e+00,  1.3941e-01]],

         [[ 2.3506e-02,        -inf,        -inf,        -inf],
          [ 4.0134e+00,  1.5221e+00,        -inf,        -inf],
          [ 2.3838e+00, -4.0876e+00,  5.6833e+00,        -inf],
          [ 5.9198e+00,  7.1135e-01,  2.1160e+00,  1.5730e+00]],

         [[-6.8486e-01,        -inf,        -inf,        -inf],
          [-1.2882e+00, -5.9502e-01,        -inf,        -inf],
          [-3.3384e+00, -8.1349e-01,  3.1386e+00,        -inf],
          [-1.3410e+00, -4.0143e+00, -1.8013e+00, -4.4906e-01]],

         [[ 1.3214e+00,        -inf,        -inf,        -inf],
          [-3.9383e+00,  4.3234e+00,        -inf,        -inf],
          [ 8.1675e-01,  1.4693e+00, -2.3992e+00,        -inf],
          [ 1.2632e+00, -1.1684e+00,  1.9024e-01, -1.2539e+00]],

         [[ 8.3843e-01,        -inf,        -inf,        -inf],
          [-4.3715e-01, -4.2954e+00,        -inf,        -inf],
          [-3.3910e+00,  1.1409e+00, -1.0798e-01,        -inf],
          [-4.0064e+00, -1.2443e+00,  1.6239e+00, -4.1569e-01]],

         [[ 2.4391e+00,        -inf,        -inf,        -inf],
          [ 8.0364e-01, -2.9789e+00,        -inf,        -inf],
          [ 8.3742e-01,  2.4618e+00,  3.5749e-01,        -inf],
          [ 3.3735e+00, -1.1156e+00, -3.4612e+00,  1.7370e-01]],

         [[ 3.3814e+00,        -inf,        -inf,        -inf],
          [ 4.5687e+00,  3.2043e+00,        -inf,        -inf],
          [ 1.3563e+00,  5.5137e-01,  1.7884e+00,        -inf],
          [-8.9177e-01,  3.0975e+00,  2.8970e+00,  3.5223e-01]],

         [[ 1.0561e+00,        -inf,        -inf,        -inf],
          [ 2.8867e+00,  1.9694e+00,        -inf,        -inf],
          [ 9.3176e-02,  1.6107e-01, -7.9206e-03,        -inf],
          [ 2.9890e-01, -2.1375e+00, -3.2362e+00, -5.8257e+00]],

         [[-8.2507e-01,        -inf,        -inf,        -inf],
          [ 5.8296e-01, -2.7904e+00,        -inf,        -inf],
          [ 2.5311e-01, -2.4882e+00, -2.1537e+00,        -inf],
          [-2.1104e+00, -2.0835e+00,  5.7579e-01,  2.5363e+00]],

         [[-4.4257e+00,        -inf,        -inf,        -inf],
          [-2.3745e-01, -1.1154e+00,        -inf,        -inf],
          [-6.8341e-01, -2.1222e+00, -1.9720e-01,        -inf],
          [-1.7887e+00, -3.2714e+00, -1.4877e+00, -4.5167e+00]],

         [[-4.5035e+00,        -inf,        -inf,        -inf],
          [-1.8799e+00,  1.9831e+00,        -inf,        -inf],
          [ 1.7991e-01,  7.8037e-01,  3.9716e+00,        -inf],
          [ 1.4096e+00,  1.0574e-01,  2.0024e+00, -3.6395e-01]],

         [[ 6.3817e+00,        -inf,        -inf,        -inf],
          [ 5.3330e-01,  2.9331e+00,        -inf,        -inf],
          [ 1.2653e+00, -3.0748e-01,  3.0606e-01,        -inf],
          [ 2.8559e+00,  1.4439e+00,  2.8261e+00,  3.4148e+00]],

         [[-2.8380e+00,        -inf,        -inf,        -inf],
          [-4.5203e-01, -3.4115e+00,        -inf,        -inf],
          [ 2.6864e+00,  5.1160e-02, -2.9251e+00,        -inf],
          [ 1.1117e+00, -4.4068e+00,  2.7910e+00,  7.3477e-01]],

         [[ 4.9215e+00,        -inf,        -inf,        -inf],
          [ 6.1257e+00,  1.2628e+00,        -inf,        -inf],
          [ 2.0252e+00,  3.6905e+00, -3.8744e-01,        -inf],
          [-8.2487e-01,  9.8921e-01, -4.1420e+00,  3.3924e+00]],

         [[-1.3827e+00,        -inf,        -inf,        -inf],
          [-5.7306e-01,  2.1517e+00,        -inf,        -inf],
          [-5.5526e+00,  8.9299e-01, -2.0221e+00,        -inf],
          [-2.5686e+00,  1.3099e+00, -4.0603e+00, -2.6003e+00]],

         [[-1.7672e+00,        -inf,        -inf,        -inf],
          [-5.9324e-01, -2.6891e+00,        -inf,        -inf],
          [-1.6698e+00, -4.9015e+00, -4.5752e-01,        -inf],
          [ 1.7569e+00,  1.8420e+00,  2.5472e+00, -1.4145e+00]],

         [[ 5.2814e-01,        -inf,        -inf,        -inf],
          [-1.3655e+00,  3.5847e+00,        -inf,        -inf],
          [ 3.7219e+00,  6.7779e+00,  4.5789e+00,        -inf],
          [-7.2422e-01,  3.6301e+00, -4.9707e-01, -5.8634e-01]],

         [[ 1.3489e+00,        -inf,        -inf,        -inf],
          [ 2.3606e+00,  8.0826e-01,        -inf,        -inf],
          [-1.0751e+00,  1.1239e+00, -2.4181e+00,        -inf],
          [ 1.0524e+00, -5.3982e-02,  2.5023e+00,  9.3322e-01]],

         [[-3.6117e+00,        -inf,        -inf,        -inf],
          [-7.2251e-01,  5.1178e+00,        -inf,        -inf],
          [ 8.4141e-01,  4.9974e-02,  3.9987e+00,        -inf],
          [ 1.7867e+00,  3.8605e+00,  4.2979e+00,  1.5967e+00]],

         [[ 6.1715e-01,        -inf,        -inf,        -inf],
          [-1.8425e+00,  3.9542e+00,        -inf,        -inf],
          [ 4.3249e+00,  6.1190e+00, -1.2488e+00,        -inf],
          [ 4.3758e-01,  5.2279e-03,  8.8062e-01,  4.6231e+00]],

         [[-7.9420e-01,        -inf,        -inf,        -inf],
          [-1.0858e+00, -1.6080e+00,        -inf,        -inf],
          [ 2.5984e+00, -7.2767e-02, -3.3699e+00,        -inf],
          [ 1.4316e+00,  2.5801e+00,  5.1825e+00,  1.2912e+00]],

         [[ 1.8529e+00,        -inf,        -inf,        -inf],
          [-2.3533e+00, -2.0749e+00,        -inf,        -inf],
          [ 3.4058e+00,  1.9390e+00, -3.6019e+00,        -inf],
          [-2.2362e+00,  3.7031e+00, -3.8892e+00, -4.4188e+00]]],


        [[[-8.4325e-01,        -inf,        -inf,        -inf],
          [-1.8549e+00, -3.7203e+00,        -inf,        -inf],
          [-4.0012e+00,  1.4178e+00,  4.0110e+00,        -inf],
          [-1.5840e+00,  4.0356e+00,  7.0530e+00, -2.9410e+00]],

         [[ 4.1238e-02,        -inf,        -inf,        -inf],
          [ 1.4973e+00, -1.9058e+00,        -inf,        -inf],
          [ 2.9270e+00, -3.5208e-01, -1.1407e+00,        -inf],
          [ 1.1492e+00, -2.5458e-02,  1.0655e+00, -2.5068e+00]],

         [[-4.0944e-02,        -inf,        -inf,        -inf],
          [ 4.5743e+00,  2.1454e+00,        -inf,        -inf],
          [-2.9378e+00,  3.9670e-01,  2.9760e+00,        -inf],
          [-1.3390e+00, -6.1384e-01,  2.1137e+00,  1.7752e+00]],

         [[-5.8799e+00,        -inf,        -inf,        -inf],
          [-1.0561e+00,  2.0264e-01,        -inf,        -inf],
          [-3.7200e+00,  8.0715e-01,  1.9856e+00,        -inf],
          [-1.2903e+00,  1.5055e+00, -2.8991e+00,  7.6563e-01]],

         [[-9.2162e-01,        -inf,        -inf,        -inf],
          [ 1.8434e+00,  6.1425e-02,        -inf,        -inf],
          [ 5.4555e+00,  4.2267e+00,  4.4871e+00,        -inf],
          [ 1.0424e+00, -2.9342e-01,  1.9347e+00, -3.4388e+00]],

         [[ 8.8799e-01,        -inf,        -inf,        -inf],
          [ 3.5899e-01, -3.9694e+00,        -inf,        -inf],
          [-3.4287e+00, -1.7848e+00, -3.5570e+00,        -inf],
          [ 7.0479e-01, -3.8541e+00,  2.6131e+00,  4.3149e-02]],

         [[ 2.9557e-01,        -inf,        -inf,        -inf],
          [-1.6159e+00, -2.2793e-01,        -inf,        -inf],
          [ 6.2343e+00, -1.0379e+00, -2.9794e+00,        -inf],
          [ 1.3438e+00,  5.7354e-01, -7.9121e-01,  7.0925e+00]],

         [[-1.9400e-01,        -inf,        -inf,        -inf],
          [-3.9114e+00,  6.8493e-01,        -inf,        -inf],
          [-4.7987e-01, -7.2324e-01,  1.8598e+00,        -inf],
          [-2.7445e+00, -1.1226e+00, -1.4889e+00, -3.5940e+00]],

         [[ 1.7459e+00,        -inf,        -inf,        -inf],
          [ 1.2442e+00, -2.6953e-01,        -inf,        -inf],
          [ 1.7133e+00, -3.4735e+00, -2.3740e+00,        -inf],
          [ 7.2716e-01,  1.9176e+00,  2.2752e+00,  4.2302e+00]],

         [[ 2.8251e+00,        -inf,        -inf,        -inf],
          [ 1.2305e+00,  4.4841e+00,        -inf,        -inf],
          [ 1.2094e+00, -6.1426e-02,  2.8120e+00,        -inf],
          [-2.5581e+00,  4.3976e+00,  2.0867e+00,  4.8287e+00]],

         [[ 4.4409e+00,        -inf,        -inf,        -inf],
          [ 1.3041e+00,  1.2271e+00,        -inf,        -inf],
          [-1.8908e+00, -1.9235e+00, -1.8139e+00,        -inf],
          [ 3.0257e+00, -3.7592e+00, -2.2576e+00, -4.8347e+00]],

         [[-3.5172e-01,        -inf,        -inf,        -inf],
          [ 2.3675e+00, -1.3470e+00,        -inf,        -inf],
          [-6.1411e-02,  1.8294e+00, -4.9059e-01,        -inf],
          [ 2.8271e+00, -1.5318e+00,  1.0084e+00, -1.6569e+00]],

         [[-2.7142e+00,        -inf,        -inf,        -inf],
          [ 1.4191e+00, -2.3527e+00,        -inf,        -inf],
          [-1.4683e+00,  2.8164e+00,  1.3287e+00,        -inf],
          [-3.2874e-01,  7.5186e-01,  1.3013e+00, -4.3028e+00]],

         [[-6.4234e+00,        -inf,        -inf,        -inf],
          [-1.8634e+00,  5.0337e+00,        -inf,        -inf],
          [-4.7154e+00,  2.3282e+00,  1.9050e+00,        -inf],
          [-2.7655e+00,  3.0832e+00,  3.9222e+00, -1.8103e+00]],

         [[ 6.1339e+00,        -inf,        -inf,        -inf],
          [ 3.3900e+00,  4.1751e+00,        -inf,        -inf],
          [ 2.2797e+00,  3.7881e+00,  5.2102e-01,        -inf],
          [ 2.4435e+00,  1.6260e+00,  3.4024e+00, -2.2775e+00]],

         [[-5.6347e+00,        -inf,        -inf,        -inf],
          [ 3.0812e-01, -2.9717e+00,        -inf,        -inf],
          [ 5.2846e+00, -1.6773e-01, -4.0906e+00,        -inf],
          [ 9.8470e-01, -1.4325e+00, -3.7850e+00, -1.1186e+00]],

         [[ 5.6389e+00,        -inf,        -inf,        -inf],
          [ 5.1174e+00,  2.8975e-01,        -inf,        -inf],
          [ 1.1904e+00,  1.0274e+00,  2.6316e+00,        -inf],
          [ 2.5651e+00, -1.0051e+00, -6.2616e+00, -1.9740e+00]],

         [[-1.3073e+00,        -inf,        -inf,        -inf],
          [ 2.6156e+00,  1.7280e+00,        -inf,        -inf],
          [-1.1097e+00,  1.3359e+00,  4.6783e+00,        -inf],
          [ 7.6340e-01,  1.7184e+00,  1.2247e+00, -2.4975e+00]],

         [[-3.2565e+00,        -inf,        -inf,        -inf],
          [ 3.3683e-01,  1.7216e+00,        -inf,        -inf],
          [-4.4213e-01, -1.4364e+00,  2.9429e-01,        -inf],
          [-3.8522e+00,  2.4738e+00, -4.4823e+00, -1.1523e+00]],

         [[-4.4106e-01,        -inf,        -inf,        -inf],
          [ 1.8853e+00,  1.5598e+00,        -inf,        -inf],
          [ 2.5596e+00,  2.2014e+00,  3.5095e+00,        -inf],
          [-6.3114e-01,  3.1968e+00,  1.2481e-01, -1.2705e-01]],

         [[ 2.8774e+00,        -inf,        -inf,        -inf],
          [-7.1655e-01, -1.1928e+00,        -inf,        -inf],
          [-1.2373e+00, -1.5176e+00, -4.8971e-01,        -inf],
          [ 1.5430e+00,  4.8460e-01, -2.7972e+00,  1.2484e+00]],

         [[-1.5465e+00,        -inf,        -inf,        -inf],
          [-1.2258e+00,  1.7953e+00,        -inf,        -inf],
          [-3.3631e+00, -1.7836e+00, -2.3249e+00,        -inf],
          [ 9.9377e-01,  3.5841e+00,  1.2642e+00, -3.5541e-01]],

         [[-1.9930e+00,        -inf,        -inf,        -inf],
          [ 2.8820e-01, -1.4972e+00,        -inf,        -inf],
          [ 5.4188e+00,  4.5656e+00,  5.8779e-01,        -inf],
          [ 3.8391e-01,  1.0131e+00,  1.6365e+00,  3.0152e+00]],

         [[-1.6160e+00,        -inf,        -inf,        -inf],
          [-2.5718e+00, -4.3731e+00,        -inf,        -inf],
          [ 2.3159e+00,  6.3456e+00,  1.9288e+00,        -inf],
          [ 1.9012e+00, -1.7632e+00,  1.5307e+00,  2.2781e+00]],

         [[ 2.4943e+00,        -inf,        -inf,        -inf],
          [-3.9105e-01,  2.8887e+00,        -inf,        -inf],
          [ 1.0744e+00,  2.3899e+00,  1.6321e+00,        -inf],
          [-8.6953e-01,  1.8552e+00, -2.8787e-01, -5.8443e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.1803,  0.7705,  0.4386,  ...,  0.0861,  0.1569, -0.0189],
          [-0.0055, -0.2087, -0.1750,  ..., -0.7327, -0.7523, -0.4263],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.3576, -0.6137, -0.3316,  ...,  1.0036,  0.4101, -0.2243],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[-0.0300,  0.0102,  0.8130,  ..., -0.1043,  0.0686, -0.5548],
          [ 0.4087, -0.0321, -0.2219,  ..., -0.4485,  0.5126, -0.7439],
          [ 0.4661, -0.2578,  0.2057,  ..., -0.4276,  0.2168, -0.0436],
          ...,
          [-0.0537,  0.4084, -0.8125,  ...,  0.5784,  0.8500, -0.6691],
          [-0.1962, -0.7259, -0.3345,  ...,  0.2352, -0.1074, -0.3462],
          [-0.2168, -0.1398, -0.1943,  ...,  0.4232,  1.1069, -0.1086]],

         [[-0.0769, -0.2014,  0.6696,  ...,  0.2016, -0.2256, -0.2145],
          [ 0.0909, -0.0930,  0.1496,  ..., -0.0496,  0.8841, -0.4629],
          [ 0.4574, -0.4199,  0.9106,  ..., -0.8696,  0.7512, -0.3601],
          ...,
          [ 0.0170,  0.5064, -0.7045,  ...,  0.3665,  0.6051, -0.6107],
          [-0.1222, -0.3194, -0.2936,  ..., -0.1931, -0.0827, -0.3192],
          [-0.1996, -0.1150, -0.2770,  ...,  0.4600,  0.9057, -0.1951]],

         [[ 0.1051, -0.4022,  0.3371,  ...,  0.3254, -0.3035,  0.2211],
          [ 0.1161, -0.2225,  0.1202,  ..., -0.1313,  0.3928, -0.5682],
          [ 0.3011, -0.1881,  0.7699,  ..., -0.7705,  0.7415, -0.4448],
          ...,
          [ 0.3101,  0.1800, -0.6365,  ...,  0.0586,  0.2353, -0.6504],
          [-0.3708, -0.5017, -0.6310,  ...,  0.1208,  0.1910, -0.5807],
          [-0.4544,  0.1548, -0.4701,  ...,  0.5239,  0.6393, -0.3724]]],


        [[[ 0.2451,  0.5231,  0.0930,  ...,  0.0697,  0.1493,  0.6087],
          [ 0.4860, -0.0996, -0.5617,  ..., -0.4089, -0.5874, -0.6178],
          [ 1.2543,  0.4007,  0.6489,  ..., -0.5248,  1.1177,  0.4451],
          ...,
          [-0.1593,  1.0838,  0.2350,  ...,  0.5232,  0.3076, -0.6804],
          [-0.4407, -0.8389,  0.0183,  ...,  0.7358,  0.1340,  0.2836],
          [ 0.5863, -0.5875,  0.5608,  ...,  0.4536,  0.8309,  0.2692]],

         [[ 0.1667,  0.4023,  0.4380,  ..., -0.0524,  0.0916, -0.0521],
          [ 0.2939, -0.0602, -0.3397,  ..., -0.2473, -0.3552, -0.3736],
          [ 0.8071,  0.1368,  0.3366,  ..., -0.2555,  0.4855,  0.6459],
          ...,
          [-0.0885,  0.6021,  0.1305,  ...,  0.2907,  0.1709, -0.3780],
          [-0.2270, -0.5283,  0.2532,  ...,  0.1896, -0.0130, -0.0990],
          [-0.2829, -0.2431, -0.0531,  ...,  0.6499,  0.5682, -0.4770]],

         [[ 0.3002, -0.1341,  0.3599,  ..., -0.1102, -0.0595, -0.0665],
          [ 0.2087,  0.0964, -0.3454,  ..., -0.2636,  0.2951, -0.1123],
          [ 0.1235,  0.0871,  0.0290,  ..., -0.1958,  0.4741,  0.4561],
          ...,
          [ 0.1256,  0.2588, -0.0295,  ...,  0.1819,  0.4428, -0.0727],
          [-0.2284, -0.2554, -0.2015,  ...,  0.1085,  0.1279, -0.1544],
          [-0.3518, -0.3621, -0.1980,  ...,  0.4776,  0.7200, -0.3765]],

         [[ 0.1740, -0.2454,  0.4571,  ..., -0.1427, -0.1145, -0.1839],
          [-0.1290, -0.0486, -0.4171,  ..., -0.2409,  0.0291, -0.0885],
          [-0.3130,  0.0536,  0.0275,  ...,  0.0758,  0.4289,  0.2106],
          ...,
          [ 0.1984,  0.1376, -0.3166,  ...,  0.0939,  0.2651, -0.4541],
          [-0.5243, -0.5543, -0.1980,  ...,  0.2220,  0.3688, -0.1788],
          [-0.4659, -0.2977, -0.2381,  ...,  0.3905,  0.3030, -0.5222]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.1803,  0.7705,  0.4386,  ...,  0.0000,  0.0000,  0.0000],
         [-0.0300,  0.0102,  0.8130,  ...,  0.4232,  1.1069, -0.1086],
         [-0.0769, -0.2014,  0.6696,  ...,  0.4600,  0.9057, -0.1951],
         [ 0.1051, -0.4022,  0.3371,  ...,  0.5239,  0.6393, -0.3724]],

        [[ 0.2451,  0.5231,  0.0930,  ...,  0.4536,  0.8309,  0.2692],
         [ 0.1667,  0.4023,  0.4380,  ...,  0.6499,  0.5682, -0.4770],
         [ 0.3002, -0.1341,  0.3599,  ...,  0.4776,  0.7200, -0.3765],
         [ 0.1740, -0.2454,  0.4571,  ...,  0.3905,  0.3030, -0.5222]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.3312, -0.1122,  0.4899,  ...,  0.0922,  0.1590, -0.2636],
         [-0.1315, -0.2530,  0.0888,  ..., -0.0881,  0.1691, -0.3299],
         [-0.1642, -0.0643, -0.0556,  ..., -0.3698,  0.2440, -0.1821],
         [-0.2607, -0.2336, -0.0184,  ..., -0.1085,  0.0430,  0.1390]],

        [[-0.1005,  0.0502,  0.1999,  ..., -0.3727,  0.8118, -0.5087],
         [-0.0433, -0.2589, -0.0899,  ..., -0.5772,  0.6196, -0.2915],
         [-0.5638,  0.0326, -0.2904,  ..., -0.7419,  0.4272,  0.0967],
         [-0.3810, -0.2825, -0.2974,  ..., -0.4268,  0.1051, -0.0528]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 2.6757e+00,        -inf,        -inf,        -inf],
          [ 1.7651e+00,  5.2447e-01,        -inf,        -inf],
          [-3.5335e+00,  9.7355e-01, -8.5222e-01,        -inf],
          [ 1.9279e+00, -4.1022e+00, -2.3986e-01,  3.0553e+00]],

         [[-4.1703e+00,        -inf,        -inf,        -inf],
          [-3.9410e-01,  1.7890e+00,        -inf,        -inf],
          [-1.0896e+00, -5.8571e-01,  9.5408e-01,        -inf],
          [-3.7634e+00,  6.4740e-01, -2.3104e+00, -2.2103e+00]],

         [[-1.1145e+00,        -inf,        -inf,        -inf],
          [ 3.8100e+00, -1.8014e+00,        -inf,        -inf],
          [-1.6780e+00, -3.3574e+00, -4.8693e+00,        -inf],
          [-1.7815e+00, -2.1011e+00,  3.1906e+00, -2.1302e+00]],

         [[ 6.4139e-01,        -inf,        -inf,        -inf],
          [ 3.2190e+00,  5.2044e+00,        -inf,        -inf],
          [-1.2316e+00,  1.1722e+00, -2.1718e+00,        -inf],
          [-1.3921e+00,  1.2874e+00,  1.7401e+00, -2.2757e+00]],

         [[-1.4687e+00,        -inf,        -inf,        -inf],
          [ 1.1951e+00,  1.2414e+00,        -inf,        -inf],
          [-5.2084e+00, -2.4990e+00, -3.2376e-01,        -inf],
          [-2.4226e+00, -1.8174e+00, -1.1078e+00, -3.1512e+00]],

         [[ 4.8932e-01,        -inf,        -inf,        -inf],
          [-2.3760e+00,  3.4276e+00,        -inf,        -inf],
          [-2.2596e+00, -4.7834e+00, -2.5595e+00,        -inf],
          [-5.0544e-01,  4.1693e-02,  1.2498e-01, -3.0167e+00]],

         [[ 2.4194e-01,        -inf,        -inf,        -inf],
          [-1.6260e-01, -4.2540e+00,        -inf,        -inf],
          [-1.5472e+00, -2.3857e+00,  1.0097e+00,        -inf],
          [-2.0559e+00, -2.0547e+00,  6.0697e-01, -4.0598e+00]],

         [[-1.2469e+00,        -inf,        -inf,        -inf],
          [ 9.7260e-01, -3.4085e-01,        -inf,        -inf],
          [-3.3712e+00, -1.1802e-02, -3.0369e-01,        -inf],
          [-4.8527e+00,  1.0085e-01,  4.3176e+00,  1.7640e+00]],

         [[ 1.3333e+00,        -inf,        -inf,        -inf],
          [-8.0530e-01, -5.7211e-01,        -inf,        -inf],
          [ 2.4163e+00,  8.7357e-01,  3.1120e+00,        -inf],
          [ 1.8687e+00,  4.1634e+00, -8.9292e-01,  4.7920e+00]],

         [[ 1.3901e+00,        -inf,        -inf,        -inf],
          [-4.9491e-01, -4.4191e+00,        -inf,        -inf],
          [ 2.0509e+00, -6.0117e+00, -2.4963e+00,        -inf],
          [-1.2645e+00, -6.1131e-01, -3.4796e+00,  4.5600e+00]],

         [[ 4.0233e-01,        -inf,        -inf,        -inf],
          [-1.8718e+00,  3.4589e+00,        -inf,        -inf],
          [ 2.1435e+00,  3.8179e+00, -3.3492e-01,        -inf],
          [-2.0075e+00,  2.9409e+00,  4.2248e+00,  4.5815e+00]],

         [[ 1.1640e+00,        -inf,        -inf,        -inf],
          [-2.7677e+00, -3.4797e+00,        -inf,        -inf],
          [-1.6263e+00, -2.6043e+00,  3.2004e-01,        -inf],
          [ 1.9095e+00, -1.7834e+00, -3.8372e+00, -3.8886e+00]],

         [[ 2.8759e+00,        -inf,        -inf,        -inf],
          [ 3.1946e+00,  1.5024e+00,        -inf,        -inf],
          [-1.3464e+00,  2.4257e-01,  3.2481e+00,        -inf],
          [-9.3288e-01,  1.5523e+00,  1.5130e+00,  3.1556e+00]],

         [[-2.1387e+00,        -inf,        -inf,        -inf],
          [-2.5607e-01,  2.3738e+00,        -inf,        -inf],
          [-2.0693e+00, -2.6630e+00, -1.2131e+00,        -inf],
          [ 5.6333e-01, -4.9767e+00, -3.1317e+00, -1.2200e+00]],

         [[ 3.5045e+00,        -inf,        -inf,        -inf],
          [-4.1668e-01,  1.9946e+00,        -inf,        -inf],
          [-2.4908e+00, -2.3867e+00, -3.5880e+00,        -inf],
          [ 1.1028e+00,  2.9541e+00,  3.0444e-02,  3.2010e+00]],

         [[-2.2665e+00,        -inf,        -inf,        -inf],
          [ 2.0628e+00, -1.3546e+00,        -inf,        -inf],
          [-2.0494e+00,  3.1681e+00, -1.5418e+00,        -inf],
          [ 1.6127e+00,  1.8061e+00, -2.6235e+00,  1.2412e+00]],

         [[ 2.9244e+00,        -inf,        -inf,        -inf],
          [ 2.2749e+00, -3.4336e+00,        -inf,        -inf],
          [-3.5886e+00, -2.9705e-01, -3.8556e+00,        -inf],
          [-5.0773e+00,  4.5340e-01, -3.3164e+00, -1.8420e+00]],

         [[-4.0522e+00,        -inf,        -inf,        -inf],
          [-3.0645e+00, -1.5873e-01,        -inf,        -inf],
          [ 1.5545e+00,  2.1875e+00, -2.7828e+00,        -inf],
          [-2.0303e+00, -2.0219e+00, -5.4518e-01,  1.1517e+00]],

         [[ 8.9730e-01,        -inf,        -inf,        -inf],
          [ 2.4334e-01,  4.5022e+00,        -inf,        -inf],
          [-1.3880e+00,  2.2017e+00, -1.2456e+00,        -inf],
          [-5.6650e+00, -9.4253e-01, -9.9405e-01, -1.0659e-01]],

         [[-8.8366e-02,        -inf,        -inf,        -inf],
          [ 2.8883e+00, -3.0283e+00,        -inf,        -inf],
          [-6.1305e+00,  1.3482e+00, -1.2404e+00,        -inf],
          [ 2.9667e+00,  2.7165e+00,  2.9500e+00, -2.0008e+00]],

         [[ 2.3443e+00,        -inf,        -inf,        -inf],
          [ 4.2109e+00, -7.2995e-02,        -inf,        -inf],
          [ 2.3744e+00, -4.0397e-01,  3.0717e+00,        -inf],
          [-2.7593e+00, -3.5102e+00,  2.3835e+00, -8.8546e-01]],

         [[ 2.2108e+00,        -inf,        -inf,        -inf],
          [-3.0983e+00, -1.6546e+00,        -inf,        -inf],
          [ 3.1656e+00, -2.7836e-01, -7.8725e-02,        -inf],
          [ 4.3665e+00,  3.2533e+00,  5.3033e+00, -9.7845e-02]],

         [[-3.7365e+00,        -inf,        -inf,        -inf],
          [ 3.5050e-01,  5.4019e-02,        -inf,        -inf],
          [ 1.3990e+00, -6.3894e-01, -4.5333e+00,        -inf],
          [ 7.0859e+00,  3.4843e+00,  5.0109e-02,  2.9998e+00]],

         [[ 3.4658e+00,        -inf,        -inf,        -inf],
          [ 1.8291e+00,  3.1002e+00,        -inf,        -inf],
          [ 4.8343e-01,  3.9157e+00,  7.4796e+00,        -inf],
          [ 2.8107e+00,  1.4081e+00,  3.0417e+00,  4.0346e+00]],

         [[ 2.6371e-01,        -inf,        -inf,        -inf],
          [-1.3469e+00, -3.4721e+00,        -inf,        -inf],
          [ 9.4244e-01, -4.1187e+00,  6.7536e-01,        -inf],
          [-1.4892e+00, -1.2136e+00,  8.6865e-01, -4.0053e-01]]],


        [[[ 8.4333e-01,        -inf,        -inf,        -inf],
          [ 1.5450e-01,  8.7636e-01,        -inf,        -inf],
          [-5.6291e+00, -3.5243e+00,  2.7370e-01,        -inf],
          [-2.5115e+00,  1.1986e+00, -1.2173e+00,  2.8666e+00]],

         [[-5.8124e+00,        -inf,        -inf,        -inf],
          [-2.3566e+00,  1.3887e+00,        -inf,        -inf],
          [ 1.7985e-01,  3.0451e+00, -8.1465e-01,        -inf],
          [-1.6315e+00,  6.3455e+00,  5.0283e+00,  3.1111e+00]],

         [[-1.3324e+00,        -inf,        -inf,        -inf],
          [ 2.9266e+00,  1.1092e+00,        -inf,        -inf],
          [ 2.4131e+00,  1.8278e+00, -2.2873e+00,        -inf],
          [-1.1131e-01, -1.4528e+00,  2.8462e+00, -5.5670e+00]],

         [[ 5.6258e-01,        -inf,        -inf,        -inf],
          [ 7.0948e+00,  3.7601e+00,        -inf,        -inf],
          [-2.3299e+00,  7.4795e-01, -2.6308e-01,        -inf],
          [ 6.6519e-01,  2.7611e+00, -1.8353e+00,  1.5375e+00]],

         [[-1.3184e+00,        -inf,        -inf,        -inf],
          [ 2.5403e-01,  1.5352e+00,        -inf,        -inf],
          [-2.7680e-01,  8.9752e-01,  3.1768e+00,        -inf],
          [ 7.5928e-01, -6.1088e+00, -1.9767e+00,  6.3895e-01]],

         [[-1.0441e+00,        -inf,        -inf,        -inf],
          [-2.5669e+00,  9.9147e-01,        -inf,        -inf],
          [-3.9104e+00, -3.7626e+00,  1.8076e+00,        -inf],
          [-1.3881e+00,  2.1237e+00, -4.9980e-01,  1.8322e+00]],

         [[-3.3004e+00,        -inf,        -inf,        -inf],
          [-3.8074e+00, -3.6587e+00,        -inf,        -inf],
          [ 1.4841e+00,  1.9399e+00,  3.4648e+00,        -inf],
          [-2.0747e+00,  1.2782e+00,  1.3659e+00, -1.3153e+00]],

         [[ 7.6891e-01,        -inf,        -inf,        -inf],
          [-2.1346e+00, -2.0854e+00,        -inf,        -inf],
          [-1.8177e+00, -1.1426e+00, -1.4921e+00,        -inf],
          [ 3.9040e+00,  2.1490e+00,  2.6051e+00,  9.9195e-01]],

         [[ 2.6004e-02,        -inf,        -inf,        -inf],
          [-2.8473e-01, -1.1935e+00,        -inf,        -inf],
          [-3.9657e-01, -1.8578e+00,  2.2127e+00,        -inf],
          [-1.4992e+00,  9.5315e-01, -2.1553e+00, -5.2883e+00]],

         [[ 1.9700e+00,        -inf,        -inf,        -inf],
          [-2.6120e+00, -1.8793e+00,        -inf,        -inf],
          [-1.9970e-01, -2.1469e+00, -1.9169e+00,        -inf],
          [-5.1760e-01, -1.3244e+00,  7.6548e-01, -1.1215e+00]],

         [[-5.0403e-01,        -inf,        -inf,        -inf],
          [ 9.3815e-01,  2.3007e-01,        -inf,        -inf],
          [-1.3120e+00,  4.2302e-02, -3.0705e+00,        -inf],
          [-1.5672e+00,  1.0666e+00,  7.2227e-01,  3.4110e+00]],

         [[-2.3535e+00,        -inf,        -inf,        -inf],
          [-1.8626e+00, -5.8418e+00,        -inf,        -inf],
          [-2.9415e+00, -5.1987e+00, -8.9092e-01,        -inf],
          [ 1.3721e+00, -6.0534e+00,  2.3103e+00, -2.0602e+00]],

         [[ 1.3314e+00,        -inf,        -inf,        -inf],
          [ 1.1891e+00, -1.0234e+00,        -inf,        -inf],
          [ 9.4076e-01,  1.5180e-01,  1.9821e+00,        -inf],
          [ 1.7207e+00,  4.1670e+00,  3.3253e-01,  1.4816e+00]],

         [[-1.4469e+00,        -inf,        -inf,        -inf],
          [-2.1687e+00, -1.4357e+00,        -inf,        -inf],
          [ 2.3911e-01, -3.7485e+00, -2.4497e+00,        -inf],
          [-4.2496e+00,  7.7158e-01,  7.9407e-01, -3.8775e-03]],

         [[ 1.8519e+00,        -inf,        -inf,        -inf],
          [ 3.0107e+00,  3.0274e+00,        -inf,        -inf],
          [-6.3901e-01,  2.8485e+00, -6.2860e-01,        -inf],
          [-6.0914e-01,  4.1350e-03,  5.9655e+00,  2.9260e+00]],

         [[-3.8513e-01,        -inf,        -inf,        -inf],
          [-3.8317e+00, -6.1319e+00,        -inf,        -inf],
          [-1.3528e+00, -1.8351e-01,  1.4250e+00,        -inf],
          [-4.1595e-01, -1.2027e+00, -3.4671e-01, -3.6197e-01]],

         [[ 5.2834e+00,        -inf,        -inf,        -inf],
          [ 5.0979e+00, -5.4680e-01,        -inf,        -inf],
          [ 2.2642e+00, -3.0282e+00, -5.7892e+00,        -inf],
          [-2.8448e+00, -2.2596e+00, -5.2780e+00, -3.2472e-01]],

         [[ 6.9232e-01,        -inf,        -inf,        -inf],
          [ 1.4816e-01, -3.5779e+00,        -inf,        -inf],
          [-2.2784e+00, -1.0590e+00,  9.7192e-01,        -inf],
          [ 1.3212e+00, -1.5903e-01,  4.2150e-01, -1.7206e+00]],

         [[-1.1172e+00,        -inf,        -inf,        -inf],
          [-8.0329e-01, -1.4285e+00,        -inf,        -inf],
          [-9.8978e-01,  9.4693e-02,  1.2378e-01,        -inf],
          [-2.2827e+00, -2.6575e+00, -3.3460e+00,  1.6292e+00]],

         [[ 9.1660e-02,        -inf,        -inf,        -inf],
          [ 5.6562e-01,  5.7613e-01,        -inf,        -inf],
          [-3.9948e+00, -3.1081e+00, -2.9848e+00,        -inf],
          [-2.5471e-01,  1.5540e+00,  4.1466e+00, -3.5935e+00]],

         [[ 2.8397e+00,        -inf,        -inf,        -inf],
          [ 3.9649e+00,  8.6658e-01,        -inf,        -inf],
          [ 1.5264e+00,  1.0265e+00,  3.6767e+00,        -inf],
          [-4.1088e-01, -4.8882e+00,  1.5540e+00, -3.4232e+00]],

         [[ 2.4921e+00,        -inf,        -inf,        -inf],
          [-2.0525e-01, -1.7637e+00,        -inf,        -inf],
          [ 1.8899e+00,  6.1368e-01, -2.2381e+00,        -inf],
          [ 3.1186e+00, -1.1007e+00, -1.7981e+00,  7.0993e-01]],

         [[-4.7249e+00,        -inf,        -inf,        -inf],
          [ 3.2763e+00,  3.2922e+00,        -inf,        -inf],
          [ 9.3815e-01,  1.1517e+00,  8.3175e+00,        -inf],
          [ 2.2048e+00, -1.4785e+00, -4.9788e-01,  5.6922e-01]],

         [[ 2.0161e+00,        -inf,        -inf,        -inf],
          [ 2.7917e+00,  2.8912e+00,        -inf,        -inf],
          [ 1.5740e+00,  2.0414e+00,  2.9787e+00,        -inf],
          [-2.0051e-01,  4.6825e+00,  3.0863e+00,  2.9096e+00]],

         [[ 1.4996e-01,        -inf,        -inf,        -inf],
          [-2.8782e+00,  2.4382e+00,        -inf,        -inf],
          [-3.2352e-01, -2.9276e+00, -7.4710e-01,        -inf],
          [ 3.9716e-01, -8.1713e-01, -5.8197e-01,  1.0417e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 2.6757e+00,        -inf,        -inf,        -inf],
          [ 1.7651e+00,  5.2447e-01,        -inf,        -inf],
          [-3.5335e+00,  9.7355e-01, -8.5222e-01,        -inf],
          [ 1.9279e+00, -4.1022e+00, -2.3986e-01,  3.0553e+00]],

         [[-4.1703e+00,        -inf,        -inf,        -inf],
          [-3.9410e-01,  1.7890e+00,        -inf,        -inf],
          [-1.0896e+00, -5.8571e-01,  9.5408e-01,        -inf],
          [-3.7634e+00,  6.4740e-01, -2.3104e+00, -2.2103e+00]],

         [[-1.1145e+00,        -inf,        -inf,        -inf],
          [ 3.8100e+00, -1.8014e+00,        -inf,        -inf],
          [-1.6780e+00, -3.3574e+00, -4.8693e+00,        -inf],
          [-1.7815e+00, -2.1011e+00,  3.1906e+00, -2.1302e+00]],

         [[ 6.4139e-01,        -inf,        -inf,        -inf],
          [ 3.2190e+00,  5.2044e+00,        -inf,        -inf],
          [-1.2316e+00,  1.1722e+00, -2.1718e+00,        -inf],
          [-1.3921e+00,  1.2874e+00,  1.7401e+00, -2.2757e+00]],

         [[-1.4687e+00,        -inf,        -inf,        -inf],
          [ 1.1951e+00,  1.2414e+00,        -inf,        -inf],
          [-5.2084e+00, -2.4990e+00, -3.2376e-01,        -inf],
          [-2.4226e+00, -1.8174e+00, -1.1078e+00, -3.1512e+00]],

         [[ 4.8932e-01,        -inf,        -inf,        -inf],
          [-2.3760e+00,  3.4276e+00,        -inf,        -inf],
          [-2.2596e+00, -4.7834e+00, -2.5595e+00,        -inf],
          [-5.0544e-01,  4.1693e-02,  1.2498e-01, -3.0167e+00]],

         [[ 2.4194e-01,        -inf,        -inf,        -inf],
          [-1.6260e-01, -4.2540e+00,        -inf,        -inf],
          [-1.5472e+00, -2.3857e+00,  1.0097e+00,        -inf],
          [-2.0559e+00, -2.0547e+00,  6.0697e-01, -4.0598e+00]],

         [[-1.2469e+00,        -inf,        -inf,        -inf],
          [ 9.7260e-01, -3.4085e-01,        -inf,        -inf],
          [-3.3712e+00, -1.1802e-02, -3.0369e-01,        -inf],
          [-4.8527e+00,  1.0085e-01,  4.3176e+00,  1.7640e+00]],

         [[ 1.3333e+00,        -inf,        -inf,        -inf],
          [-8.0530e-01, -5.7211e-01,        -inf,        -inf],
          [ 2.4163e+00,  8.7357e-01,  3.1120e+00,        -inf],
          [ 1.8687e+00,  4.1634e+00, -8.9292e-01,  4.7920e+00]],

         [[ 1.3901e+00,        -inf,        -inf,        -inf],
          [-4.9491e-01, -4.4191e+00,        -inf,        -inf],
          [ 2.0509e+00, -6.0117e+00, -2.4963e+00,        -inf],
          [-1.2645e+00, -6.1131e-01, -3.4796e+00,  4.5600e+00]],

         [[ 4.0233e-01,        -inf,        -inf,        -inf],
          [-1.8718e+00,  3.4589e+00,        -inf,        -inf],
          [ 2.1435e+00,  3.8179e+00, -3.3492e-01,        -inf],
          [-2.0075e+00,  2.9409e+00,  4.2248e+00,  4.5815e+00]],

         [[ 1.1640e+00,        -inf,        -inf,        -inf],
          [-2.7677e+00, -3.4797e+00,        -inf,        -inf],
          [-1.6263e+00, -2.6043e+00,  3.2004e-01,        -inf],
          [ 1.9095e+00, -1.7834e+00, -3.8372e+00, -3.8886e+00]],

         [[ 2.8759e+00,        -inf,        -inf,        -inf],
          [ 3.1946e+00,  1.5024e+00,        -inf,        -inf],
          [-1.3464e+00,  2.4257e-01,  3.2481e+00,        -inf],
          [-9.3288e-01,  1.5523e+00,  1.5130e+00,  3.1556e+00]],

         [[-2.1387e+00,        -inf,        -inf,        -inf],
          [-2.5607e-01,  2.3738e+00,        -inf,        -inf],
          [-2.0693e+00, -2.6630e+00, -1.2131e+00,        -inf],
          [ 5.6333e-01, -4.9767e+00, -3.1317e+00, -1.2200e+00]],

         [[ 3.5045e+00,        -inf,        -inf,        -inf],
          [-4.1668e-01,  1.9946e+00,        -inf,        -inf],
          [-2.4908e+00, -2.3867e+00, -3.5880e+00,        -inf],
          [ 1.1028e+00,  2.9541e+00,  3.0444e-02,  3.2010e+00]],

         [[-2.2665e+00,        -inf,        -inf,        -inf],
          [ 2.0628e+00, -1.3546e+00,        -inf,        -inf],
          [-2.0494e+00,  3.1681e+00, -1.5418e+00,        -inf],
          [ 1.6127e+00,  1.8061e+00, -2.6235e+00,  1.2412e+00]],

         [[ 2.9244e+00,        -inf,        -inf,        -inf],
          [ 2.2749e+00, -3.4336e+00,        -inf,        -inf],
          [-3.5886e+00, -2.9705e-01, -3.8556e+00,        -inf],
          [-5.0773e+00,  4.5340e-01, -3.3164e+00, -1.8420e+00]],

         [[-4.0522e+00,        -inf,        -inf,        -inf],
          [-3.0645e+00, -1.5873e-01,        -inf,        -inf],
          [ 1.5545e+00,  2.1875e+00, -2.7828e+00,        -inf],
          [-2.0303e+00, -2.0219e+00, -5.4518e-01,  1.1517e+00]],

         [[ 8.9730e-01,        -inf,        -inf,        -inf],
          [ 2.4334e-01,  4.5022e+00,        -inf,        -inf],
          [-1.3880e+00,  2.2017e+00, -1.2456e+00,        -inf],
          [-5.6650e+00, -9.4253e-01, -9.9405e-01, -1.0659e-01]],

         [[-8.8366e-02,        -inf,        -inf,        -inf],
          [ 2.8883e+00, -3.0283e+00,        -inf,        -inf],
          [-6.1305e+00,  1.3482e+00, -1.2404e+00,        -inf],
          [ 2.9667e+00,  2.7165e+00,  2.9500e+00, -2.0008e+00]],

         [[ 2.3443e+00,        -inf,        -inf,        -inf],
          [ 4.2109e+00, -7.2995e-02,        -inf,        -inf],
          [ 2.3744e+00, -4.0397e-01,  3.0717e+00,        -inf],
          [-2.7593e+00, -3.5102e+00,  2.3835e+00, -8.8546e-01]],

         [[ 2.2108e+00,        -inf,        -inf,        -inf],
          [-3.0983e+00, -1.6546e+00,        -inf,        -inf],
          [ 3.1656e+00, -2.7836e-01, -7.8725e-02,        -inf],
          [ 4.3665e+00,  3.2533e+00,  5.3033e+00, -9.7845e-02]],

         [[-3.7365e+00,        -inf,        -inf,        -inf],
          [ 3.5050e-01,  5.4019e-02,        -inf,        -inf],
          [ 1.3990e+00, -6.3894e-01, -4.5333e+00,        -inf],
          [ 7.0859e+00,  3.4843e+00,  5.0109e-02,  2.9998e+00]],

         [[ 3.4658e+00,        -inf,        -inf,        -inf],
          [ 1.8291e+00,  3.1002e+00,        -inf,        -inf],
          [ 4.8343e-01,  3.9157e+00,  7.4796e+00,        -inf],
          [ 2.8107e+00,  1.4081e+00,  3.0417e+00,  4.0346e+00]],

         [[ 2.6371e-01,        -inf,        -inf,        -inf],
          [-1.3469e+00, -3.4721e+00,        -inf,        -inf],
          [ 9.4244e-01, -4.1187e+00,  6.7536e-01,        -inf],
          [-1.4892e+00, -1.2136e+00,  8.6865e-01, -4.0053e-01]]],


        [[[ 8.4333e-01,        -inf,        -inf,        -inf],
          [ 1.5450e-01,  8.7636e-01,        -inf,        -inf],
          [-5.6291e+00, -3.5243e+00,  2.7370e-01,        -inf],
          [-2.5115e+00,  1.1986e+00, -1.2173e+00,  2.8666e+00]],

         [[-5.8124e+00,        -inf,        -inf,        -inf],
          [-2.3566e+00,  1.3887e+00,        -inf,        -inf],
          [ 1.7985e-01,  3.0451e+00, -8.1465e-01,        -inf],
          [-1.6315e+00,  6.3455e+00,  5.0283e+00,  3.1111e+00]],

         [[-1.3324e+00,        -inf,        -inf,        -inf],
          [ 2.9266e+00,  1.1092e+00,        -inf,        -inf],
          [ 2.4131e+00,  1.8278e+00, -2.2873e+00,        -inf],
          [-1.1131e-01, -1.4528e+00,  2.8462e+00, -5.5670e+00]],

         [[ 5.6258e-01,        -inf,        -inf,        -inf],
          [ 7.0948e+00,  3.7601e+00,        -inf,        -inf],
          [-2.3299e+00,  7.4795e-01, -2.6308e-01,        -inf],
          [ 6.6519e-01,  2.7611e+00, -1.8353e+00,  1.5375e+00]],

         [[-1.3184e+00,        -inf,        -inf,        -inf],
          [ 2.5403e-01,  1.5352e+00,        -inf,        -inf],
          [-2.7680e-01,  8.9752e-01,  3.1768e+00,        -inf],
          [ 7.5928e-01, -6.1088e+00, -1.9767e+00,  6.3895e-01]],

         [[-1.0441e+00,        -inf,        -inf,        -inf],
          [-2.5669e+00,  9.9147e-01,        -inf,        -inf],
          [-3.9104e+00, -3.7626e+00,  1.8076e+00,        -inf],
          [-1.3881e+00,  2.1237e+00, -4.9980e-01,  1.8322e+00]],

         [[-3.3004e+00,        -inf,        -inf,        -inf],
          [-3.8074e+00, -3.6587e+00,        -inf,        -inf],
          [ 1.4841e+00,  1.9399e+00,  3.4648e+00,        -inf],
          [-2.0747e+00,  1.2782e+00,  1.3659e+00, -1.3153e+00]],

         [[ 7.6891e-01,        -inf,        -inf,        -inf],
          [-2.1346e+00, -2.0854e+00,        -inf,        -inf],
          [-1.8177e+00, -1.1426e+00, -1.4921e+00,        -inf],
          [ 3.9040e+00,  2.1490e+00,  2.6051e+00,  9.9195e-01]],

         [[ 2.6004e-02,        -inf,        -inf,        -inf],
          [-2.8473e-01, -1.1935e+00,        -inf,        -inf],
          [-3.9657e-01, -1.8578e+00,  2.2127e+00,        -inf],
          [-1.4992e+00,  9.5315e-01, -2.1553e+00, -5.2883e+00]],

         [[ 1.9700e+00,        -inf,        -inf,        -inf],
          [-2.6120e+00, -1.8793e+00,        -inf,        -inf],
          [-1.9970e-01, -2.1469e+00, -1.9169e+00,        -inf],
          [-5.1760e-01, -1.3244e+00,  7.6548e-01, -1.1215e+00]],

         [[-5.0403e-01,        -inf,        -inf,        -inf],
          [ 9.3815e-01,  2.3007e-01,        -inf,        -inf],
          [-1.3120e+00,  4.2302e-02, -3.0705e+00,        -inf],
          [-1.5672e+00,  1.0666e+00,  7.2227e-01,  3.4110e+00]],

         [[-2.3535e+00,        -inf,        -inf,        -inf],
          [-1.8626e+00, -5.8418e+00,        -inf,        -inf],
          [-2.9415e+00, -5.1987e+00, -8.9092e-01,        -inf],
          [ 1.3721e+00, -6.0534e+00,  2.3103e+00, -2.0602e+00]],

         [[ 1.3314e+00,        -inf,        -inf,        -inf],
          [ 1.1891e+00, -1.0234e+00,        -inf,        -inf],
          [ 9.4076e-01,  1.5180e-01,  1.9821e+00,        -inf],
          [ 1.7207e+00,  4.1670e+00,  3.3253e-01,  1.4816e+00]],

         [[-1.4469e+00,        -inf,        -inf,        -inf],
          [-2.1687e+00, -1.4357e+00,        -inf,        -inf],
          [ 2.3911e-01, -3.7485e+00, -2.4497e+00,        -inf],
          [-4.2496e+00,  7.7158e-01,  7.9407e-01, -3.8775e-03]],

         [[ 1.8519e+00,        -inf,        -inf,        -inf],
          [ 3.0107e+00,  3.0274e+00,        -inf,        -inf],
          [-6.3901e-01,  2.8485e+00, -6.2860e-01,        -inf],
          [-6.0914e-01,  4.1350e-03,  5.9655e+00,  2.9260e+00]],

         [[-3.8513e-01,        -inf,        -inf,        -inf],
          [-3.8317e+00, -6.1319e+00,        -inf,        -inf],
          [-1.3528e+00, -1.8351e-01,  1.4250e+00,        -inf],
          [-4.1595e-01, -1.2027e+00, -3.4671e-01, -3.6197e-01]],

         [[ 5.2834e+00,        -inf,        -inf,        -inf],
          [ 5.0979e+00, -5.4680e-01,        -inf,        -inf],
          [ 2.2642e+00, -3.0282e+00, -5.7892e+00,        -inf],
          [-2.8448e+00, -2.2596e+00, -5.2780e+00, -3.2472e-01]],

         [[ 6.9232e-01,        -inf,        -inf,        -inf],
          [ 1.4816e-01, -3.5779e+00,        -inf,        -inf],
          [-2.2784e+00, -1.0590e+00,  9.7192e-01,        -inf],
          [ 1.3212e+00, -1.5903e-01,  4.2150e-01, -1.7206e+00]],

         [[-1.1172e+00,        -inf,        -inf,        -inf],
          [-8.0329e-01, -1.4285e+00,        -inf,        -inf],
          [-9.8978e-01,  9.4693e-02,  1.2378e-01,        -inf],
          [-2.2827e+00, -2.6575e+00, -3.3460e+00,  1.6292e+00]],

         [[ 9.1660e-02,        -inf,        -inf,        -inf],
          [ 5.6562e-01,  5.7613e-01,        -inf,        -inf],
          [-3.9948e+00, -3.1081e+00, -2.9848e+00,        -inf],
          [-2.5471e-01,  1.5540e+00,  4.1466e+00, -3.5935e+00]],

         [[ 2.8397e+00,        -inf,        -inf,        -inf],
          [ 3.9649e+00,  8.6658e-01,        -inf,        -inf],
          [ 1.5264e+00,  1.0265e+00,  3.6767e+00,        -inf],
          [-4.1088e-01, -4.8882e+00,  1.5540e+00, -3.4232e+00]],

         [[ 2.4921e+00,        -inf,        -inf,        -inf],
          [-2.0525e-01, -1.7637e+00,        -inf,        -inf],
          [ 1.8899e+00,  6.1368e-01, -2.2381e+00,        -inf],
          [ 3.1186e+00, -1.1007e+00, -1.7981e+00,  7.0993e-01]],

         [[-4.7249e+00,        -inf,        -inf,        -inf],
          [ 3.2763e+00,  3.2922e+00,        -inf,        -inf],
          [ 9.3815e-01,  1.1517e+00,  8.3175e+00,        -inf],
          [ 2.2048e+00, -1.4785e+00, -4.9788e-01,  5.6922e-01]],

         [[ 2.0161e+00,        -inf,        -inf,        -inf],
          [ 2.7917e+00,  2.8912e+00,        -inf,        -inf],
          [ 1.5740e+00,  2.0414e+00,  2.9787e+00,        -inf],
          [-2.0051e-01,  4.6825e+00,  3.0863e+00,  2.9096e+00]],

         [[ 1.4996e-01,        -inf,        -inf,        -inf],
          [-2.8782e+00,  2.4382e+00,        -inf,        -inf],
          [-3.2352e-01, -2.9276e+00, -7.4710e-01,        -inf],
          [ 3.9716e-01, -8.1713e-01, -5.8197e-01,  1.0417e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 4.1586e-01, -1.4062e-01, -1.0479e+00,  ..., -8.3980e-01,
           -3.4935e-02,  1.8976e-01],
          [ 7.1455e-01,  7.5965e-01,  1.0618e+00,  ..., -1.4834e-01,
           -6.4037e-01, -2.2607e-01],
          [-2.7062e-02,  4.1284e-01, -4.2829e-01,  ...,  9.7223e-03,
           -8.3579e-01,  7.1344e-01],
          ...,
          [-1.3477e+00, -2.8994e-01, -1.3363e+00,  ...,  2.0630e-01,
            5.6708e-01, -5.3539e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.1069e-01,  8.6894e-01, -5.5829e-01,  ..., -1.0093e+00,
            1.7538e-02,  4.4861e-02]],

         [[ 5.4043e-01,  4.5822e-01, -8.2965e-01,  ..., -4.9626e-01,
           -4.5547e-01, -2.1875e-01],
          [ 8.5640e-01,  6.8985e-01,  9.8800e-01,  ..., -1.6102e-01,
           -4.5284e-02, -3.1740e-01],
          [ 5.4102e-02,  4.0380e-01, -1.0170e-01,  ...,  2.3637e-01,
           -6.4694e-01,  9.1470e-01],
          ...,
          [-9.1872e-01,  3.6957e-01, -5.9526e-01,  ...,  1.6704e-01,
           -3.1349e-01, -3.5441e-01],
          [-9.0798e-02,  5.9986e-01,  2.5823e-01,  ..., -1.9737e-01,
            7.2090e-03, -1.6307e-01],
          [ 9.2272e-02,  7.3140e-01, -7.1394e-01,  ..., -3.9685e-01,
           -2.2321e-01, -8.9786e-02]],

         [[ 5.8913e-01,  4.0578e-01, -8.4933e-01,  ..., -4.6839e-01,
           -4.9324e-01, -5.5821e-01],
          [ 5.2553e-01,  6.3237e-01,  6.4724e-01,  ...,  1.5700e-01,
           -5.5832e-02, -5.5033e-02],
          [-1.5574e-01,  6.5982e-01,  1.1605e-01,  ...,  1.1060e-01,
           -4.8691e-01,  6.2096e-01],
          ...,
          [-9.2436e-01,  3.5465e-01, -8.0821e-01,  ...,  1.7430e-01,
           -1.6220e-01, -3.1207e-01],
          [ 5.2835e-02, -1.6574e-01,  7.1564e-01,  ...,  5.8995e-03,
           -4.2090e-01,  1.0318e-01],
          [-8.4030e-02,  9.1325e-01, -4.0974e-01,  ..., -6.3648e-01,
           -3.3111e-01, -1.8313e-01]],

         [[ 7.1540e-01, -3.4651e-01, -3.9525e-01,  ..., -6.2034e-01,
           -2.7829e-01, -1.6837e-03],
          [ 6.0877e-02,  9.9779e-02, -2.1629e-01,  ...,  1.0012e-01,
            4.5842e-02,  1.6953e-01],
          [-6.3973e-01,  4.2187e-01,  2.2706e-01,  ..., -2.0365e-01,
           -2.8071e-01, -3.5946e-01],
          ...,
          [-8.2915e-01,  2.0364e-01, -7.9806e-01,  ...,  1.5600e-01,
           -1.9858e-01, -2.3190e-01],
          [ 3.3701e-02,  1.2417e-01,  6.5277e-01,  ..., -1.0451e-01,
            4.6183e-02, -8.5821e-02],
          [ 2.7489e-02,  5.1743e-01, -1.2079e-01,  ..., -4.3500e-01,
           -3.1212e-01, -2.3881e-01]]],


        [[[-1.8800e-01, -1.5014e-01, -1.5469e+00,  ..., -6.6096e-01,
           -5.3078e-01,  5.2511e-01],
          [ 4.5858e-01,  9.4860e-01,  5.7828e-01,  ..., -2.0300e-02,
           -4.6399e-01, -3.7726e-01],
          [-3.8412e-01,  2.4626e-02, -3.0545e-01,  ...,  7.0319e-02,
           -5.7348e-01,  4.9176e-01],
          ...,
          [-1.0618e+00, -6.2522e-02, -9.4298e-01,  ..., -1.1220e-01,
           -4.2103e-02, -7.0646e-01],
          [-3.0056e-01,  1.7111e+00, -1.9946e-01,  ..., -3.9789e-01,
            1.1985e-01, -7.7781e-01],
          [ 1.7924e-01,  6.7404e-01, -5.4849e-01,  ..., -7.9141e-01,
           -5.9037e-02, -1.3809e-01]],

         [[-4.7147e-01, -1.7818e-01, -5.6281e-01,  ..., -2.9822e-01,
           -8.7429e-01, -3.1930e-01],
          [ 4.5454e-01,  6.4191e-01,  4.0460e-01,  ..., -3.2461e-01,
           -6.9719e-01,  1.1761e-01],
          [-1.2315e-01, -2.5379e-01, -1.0566e-01,  ...,  2.8018e-01,
            4.9652e-01,  6.5895e-01],
          ...,
          [-5.0841e-01,  7.0948e-01, -5.8186e-01,  ..., -2.5431e-01,
           -4.4034e-01, -7.2136e-01],
          [ 6.2865e-01,  9.7294e-01, -4.0419e-01,  ...,  2.6596e-02,
           -9.6827e-02, -2.0864e-01],
          [ 5.1069e-01,  1.3362e-01, -6.2638e-01,  ..., -1.1261e-02,
           -6.0014e-01,  4.4893e-01]],

         [[-5.1556e-01,  4.5184e-01, -2.0572e-01,  ..., -3.2851e-01,
           -2.5652e-01, -3.9315e-01],
          [ 3.5804e-01,  9.4655e-01,  3.2399e-02,  ...,  1.2286e-02,
           -3.4041e-01,  2.1557e-02],
          [-2.5375e-01, -2.0442e-01,  1.7807e-02,  ...,  2.1501e-01,
            2.6581e-01,  6.9328e-01],
          ...,
          [-5.7860e-01,  2.9160e-01, -1.0502e+00,  ..., -7.3443e-01,
           -3.0261e-01, -2.5777e-01],
          [ 5.0150e-01,  1.5100e-01, -2.4650e-01,  ...,  1.2648e-01,
            1.7368e-01, -1.5960e-01],
          [-2.0014e-01,  5.9241e-01, -7.0208e-01,  ..., -1.3499e-01,
           -1.8925e-01,  2.8920e-01]],

         [[-7.4286e-02,  1.1709e-01, -1.8389e-01,  ...,  1.3829e-01,
           -2.1533e-01,  1.4137e-01],
          [ 2.0560e-01,  8.2184e-01, -4.6077e-01,  ...,  1.7338e-01,
           -1.2755e-01, -1.4527e-02],
          [-1.7069e-01, -7.9944e-02,  3.7100e-01,  ...,  1.1740e-01,
            3.0205e-01,  2.5860e-01],
          ...,
          [-4.3097e-01,  3.1078e-01, -7.9321e-01,  ..., -4.0077e-01,
           -3.3600e-01, -6.5156e-02],
          [ 2.3875e-02,  6.3804e-02,  3.3923e-02,  ..., -1.4877e-01,
            1.5978e-01, -5.7179e-03],
          [ 4.2436e-02,  2.4894e-01, -6.5867e-01,  ..., -7.5765e-02,
            1.5483e-01,  1.6545e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.4159, -0.1406, -1.0479,  ..., -1.0093,  0.0175,  0.0449],
         [ 0.5404,  0.4582, -0.8296,  ..., -0.3969, -0.2232, -0.0898],
         [ 0.5891,  0.4058, -0.8493,  ..., -0.6365, -0.3311, -0.1831],
         [ 0.7154, -0.3465, -0.3953,  ..., -0.4350, -0.3121, -0.2388]],

        [[-0.1880, -0.1501, -1.5469,  ..., -0.7914, -0.0590, -0.1381],
         [-0.4715, -0.1782, -0.5628,  ..., -0.0113, -0.6001,  0.4489],
         [-0.5156,  0.4518, -0.2057,  ..., -0.1350, -0.1892,  0.2892],
         [-0.0743,  0.1171, -0.1839,  ..., -0.0758,  0.1548,  0.1655]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.4817,  0.0213, -0.1854,  ..., -0.3305,  0.0515, -0.3644],
         [-0.2295, -0.2998,  0.2429,  ...,  0.0694, -0.1093, -0.3057],
         [-0.1877, -0.1481,  0.3838,  ..., -0.1999, -0.0430, -0.2727],
         [-0.2032, -0.1584,  0.2784,  ..., -0.1258,  0.2400, -0.3123]],

        [[-0.3820, -0.5799,  0.3360,  ..., -0.0995, -0.1026, -0.1234],
         [ 0.1419, -0.3698,  0.5591,  ..., -0.0389, -0.1296, -0.0665],
         [ 0.3090, -0.2804,  0.7598,  ..., -0.0565, -0.3308, -0.1712],
         [ 0.2530, -0.2879,  0.5844,  ..., -0.1708, -0.1310, -0.1530]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.5522e+00,        -inf,        -inf,        -inf],
          [ 1.7685e+00, -2.6060e+00,        -inf,        -inf],
          [-8.6754e-01,  4.2451e+00, -1.7931e+00,        -inf],
          [ 2.7795e-01,  1.6423e+00,  1.5054e+00,  7.7160e-02]],

         [[-5.3312e+00,        -inf,        -inf,        -inf],
          [-1.2915e+00, -3.1740e+00,        -inf,        -inf],
          [-2.8760e+00, -1.7674e+00,  1.2766e+00,        -inf],
          [-2.6617e+00, -2.4788e+00, -9.4025e-02, -2.3175e+00]],

         [[-5.5910e-03,        -inf,        -inf,        -inf],
          [ 1.5718e+00,  3.9801e+00,        -inf,        -inf],
          [-1.7898e+00,  3.9621e+00, -2.6038e+00,        -inf],
          [-1.0045e+00, -2.7376e+00, -1.7446e+00,  1.4519e+00]],

         [[ 4.1861e+00,        -inf,        -inf,        -inf],
          [ 8.0378e-01, -4.1374e-01,        -inf,        -inf],
          [-4.7393e+00,  2.1804e-01, -1.2621e+00,        -inf],
          [ 3.3317e+00,  4.8470e+00,  3.7543e+00, -1.2386e+00]],

         [[-3.6348e+00,        -inf,        -inf,        -inf],
          [-7.3737e-01, -2.5897e+00,        -inf,        -inf],
          [-5.8240e-01,  1.4156e+00,  4.0520e-01,        -inf],
          [ 3.6260e+00, -1.4425e+00, -2.4987e-01,  5.3674e+00]],

         [[ 3.8019e+00,        -inf,        -inf,        -inf],
          [-4.0623e-01, -4.8047e+00,        -inf,        -inf],
          [-5.7663e-01,  8.0606e-01, -1.0688e+00,        -inf],
          [ 1.6439e+00,  1.4755e+00,  1.8751e-01,  1.3322e+00]],

         [[-2.6727e+00,        -inf,        -inf,        -inf],
          [-8.7819e-01, -2.7978e-01,        -inf,        -inf],
          [-4.3208e+00,  4.9068e-01, -2.8439e+00,        -inf],
          [-1.4137e+00, -6.9840e-01,  8.0864e-01,  1.7175e-01]],

         [[-1.7551e+00,        -inf,        -inf,        -inf],
          [ 1.5568e+00, -1.0455e+00,        -inf,        -inf],
          [-2.4122e+00, -3.2322e-01,  5.7308e+00,        -inf],
          [-3.1114e-04, -5.9049e-01,  2.6792e+00,  5.3729e+00]],

         [[ 1.1822e+00,        -inf,        -inf,        -inf],
          [-2.2786e+00,  1.2373e+00,        -inf,        -inf],
          [-8.9872e-01, -1.5199e-01, -1.5405e+00,        -inf],
          [-9.8080e-01,  7.6861e-01, -3.9923e-02,  4.0928e+00]],

         [[-4.6209e+00,        -inf,        -inf,        -inf],
          [-5.6987e-01, -2.0295e+00,        -inf,        -inf],
          [ 1.3635e+00,  2.5992e+00, -1.5709e+00,        -inf],
          [-3.0375e+00, -3.6849e+00, -2.2305e+00,  3.4170e+00]],

         [[-2.1159e+00,        -inf,        -inf,        -inf],
          [ 2.5438e+00,  7.5742e-01,        -inf,        -inf],
          [-1.1482e+00,  1.9041e+00, -3.7712e+00,        -inf],
          [ 2.9569e+00,  1.3414e+00,  5.0504e+00,  4.8627e-03]],

         [[-1.9756e+00,        -inf,        -inf,        -inf],
          [ 4.7817e-01,  5.2646e-01,        -inf,        -inf],
          [ 1.4535e+00,  1.6925e+00, -3.4400e+00,        -inf],
          [-2.2217e+00,  1.0690e+00, -1.3456e+00, -6.9398e+00]],

         [[-1.7926e-01,        -inf,        -inf,        -inf],
          [-2.9514e-01, -3.7943e+00,        -inf,        -inf],
          [ 1.8065e-01,  2.6069e+00,  1.3879e+00,        -inf],
          [ 3.7018e+00,  2.6950e+00, -1.6163e-01,  1.7903e+00]],

         [[ 4.9204e-01,        -inf,        -inf,        -inf],
          [-2.9167e+00, -1.8205e+00,        -inf,        -inf],
          [ 1.7507e+00,  2.1551e+00, -8.0634e-01,        -inf],
          [ 1.1365e+00,  4.5968e+00, -1.3788e+00,  5.2683e-01]],

         [[-1.2542e+00,        -inf,        -inf,        -inf],
          [-1.2250e-01,  2.7110e+00,        -inf,        -inf],
          [-4.4181e-01, -1.7573e+00, -8.2268e-01,        -inf],
          [-3.7894e-01, -1.5783e+00,  4.7551e-02, -1.4423e+00]],

         [[ 1.1769e+00,        -inf,        -inf,        -inf],
          [-2.5965e+00, -8.9774e-01,        -inf,        -inf],
          [-3.0074e+00, -1.6388e+00,  1.3161e+00,        -inf],
          [-9.8980e-01, -3.2139e+00,  9.4632e-01,  1.2223e+00]],

         [[-9.8995e-01,        -inf,        -inf,        -inf],
          [-2.6532e+00,  3.9102e+00,        -inf,        -inf],
          [-1.5985e+00,  4.9375e-01,  1.6285e+00,        -inf],
          [ 2.8583e+00, -4.1109e+00, -2.8440e+00, -9.5317e-01]],

         [[ 4.5355e+00,        -inf,        -inf,        -inf],
          [ 2.6598e+00, -3.9616e-01,        -inf,        -inf],
          [-5.0244e-01, -4.5545e+00,  1.7518e+00,        -inf],
          [ 4.5365e+00, -4.2642e-01, -2.0998e+00,  3.8574e+00]],

         [[-2.1356e-01,        -inf,        -inf,        -inf],
          [-5.5017e-01, -3.8553e+00,        -inf,        -inf],
          [-5.5345e-01,  1.1598e+00, -2.1488e+00,        -inf],
          [ 3.9503e-01,  8.6287e-01, -1.1575e+00,  1.5515e+00]],

         [[-1.5483e-01,        -inf,        -inf,        -inf],
          [-1.0503e+00, -3.2490e+00,        -inf,        -inf],
          [-3.3072e+00,  2.3276e+00, -1.3744e+00,        -inf],
          [-2.3996e+00, -1.6712e+00, -4.6976e+00,  2.3596e+00]],

         [[-2.6671e+00,        -inf,        -inf,        -inf],
          [-4.4716e+00, -1.1624e+00,        -inf,        -inf],
          [-3.5542e+00, -1.9411e+00, -5.8328e+00,        -inf],
          [-8.6833e-01, -3.4542e-01, -1.7282e+00, -2.9219e+00]],

         [[-2.2652e+00,        -inf,        -inf,        -inf],
          [ 1.3554e+00,  4.3988e+00,        -inf,        -inf],
          [ 1.7387e-01,  1.8801e+00,  3.4088e-01,        -inf],
          [ 1.0104e+00,  1.9656e+00, -3.4731e+00, -5.6841e-02]],

         [[-1.7515e+00,        -inf,        -inf,        -inf],
          [-6.7951e-02,  3.5815e+00,        -inf,        -inf],
          [-2.5077e+00, -1.8893e-02, -9.1188e-01,        -inf],
          [-3.1178e+00, -1.1390e+00, -1.7182e-01,  6.8181e-01]],

         [[ 1.8630e+00,        -inf,        -inf,        -inf],
          [-2.1517e+00, -2.1925e+00,        -inf,        -inf],
          [ 1.1409e+00,  3.9151e+00, -2.5183e+00,        -inf],
          [-2.6006e+00,  2.2576e+00, -7.0570e+00,  3.6837e+00]],

         [[-1.4797e+00,        -inf,        -inf,        -inf],
          [-2.5591e+00,  2.0748e+00,        -inf,        -inf],
          [-5.3826e-01, -6.6780e-01, -3.2024e+00,        -inf],
          [-1.3418e+00,  1.3193e+00,  8.8592e-02,  1.0566e+00]]],


        [[[ 1.9465e+00,        -inf,        -inf,        -inf],
          [-6.6140e-02, -4.8121e+00,        -inf,        -inf],
          [ 9.6498e-01, -1.0226e+00, -3.9025e+00,        -inf],
          [ 2.0066e+00, -3.1668e+00,  3.5304e-01,  1.1159e+00]],

         [[-6.9731e-01,        -inf,        -inf,        -inf],
          [ 3.5203e-01, -3.1812e+00,        -inf,        -inf],
          [-2.0460e+00, -4.4153e+00, -1.5015e+00,        -inf],
          [-3.1298e+00, -4.8376e-01, -2.4902e+00, -8.2482e-01]],

         [[-2.3943e+00,        -inf,        -inf,        -inf],
          [-3.7457e-01, -4.3989e+00,        -inf,        -inf],
          [-2.9273e+00,  6.5131e-01, -3.7822e+00,        -inf],
          [-3.4675e-01, -9.7040e-02, -2.8869e-01,  1.0276e+00]],

         [[ 1.7877e+00,        -inf,        -inf,        -inf],
          [-2.8023e+00, -1.4667e-01,        -inf,        -inf],
          [-4.5063e+00,  2.6223e-01,  9.5402e-01,        -inf],
          [ 1.4080e-01,  3.6062e+00,  1.6058e+00,  8.5314e-01]],

         [[-5.6110e+00,        -inf,        -inf,        -inf],
          [-4.1944e+00, -4.6685e+00,        -inf,        -inf],
          [ 1.5821e+00,  2.8349e+00, -5.0766e+00,        -inf],
          [ 2.0719e+00, -4.8003e+00,  4.7182e-01,  4.6351e+00]],

         [[ 1.4644e+00,        -inf,        -inf,        -inf],
          [-3.1007e+00, -2.2485e+00,        -inf,        -inf],
          [-3.4099e+00, -3.7909e-01,  3.5903e+00,        -inf],
          [-1.5564e+00, -2.7124e+00, -5.2947e+00, -3.3326e+00]],

         [[-2.7998e+00,        -inf,        -inf,        -inf],
          [-1.7155e+00,  4.8389e-01,        -inf,        -inf],
          [-2.5335e+00,  6.3580e-01, -2.3817e+00,        -inf],
          [-5.4305e+00,  1.3717e+00, -3.5635e+00, -1.4298e+00]],

         [[-1.9486e+00,        -inf,        -inf,        -inf],
          [ 1.0426e-01, -1.8051e+00,        -inf,        -inf],
          [ 3.1717e+00,  2.4558e-01,  7.2028e-01,        -inf],
          [-1.8362e-01,  7.1631e-01,  1.0786e+00,  1.9348e+00]],

         [[-2.9798e+00,        -inf,        -inf,        -inf],
          [-1.6650e-01,  1.1302e-01,        -inf,        -inf],
          [-1.8205e+00, -6.0643e+00,  3.3078e+00,        -inf],
          [-1.5858e+00,  2.1730e-01,  4.9270e+00,  2.4572e+00]],

         [[-2.2969e+00,        -inf,        -inf,        -inf],
          [-1.1014e+00,  1.5152e+00,        -inf,        -inf],
          [ 1.0526e+00,  5.4940e-01, -2.0948e+00,        -inf],
          [ 1.7188e+00,  8.9149e-01,  1.0079e-01, -1.5511e+00]],

         [[-2.1194e-01,        -inf,        -inf,        -inf],
          [ 2.3246e+00,  7.9184e-01,        -inf,        -inf],
          [ 4.3587e+00,  3.1723e+00, -2.2538e+00,        -inf],
          [ 5.6063e-01,  2.4287e+00,  2.5585e-01,  2.0617e+00]],

         [[-2.3104e+00,        -inf,        -inf,        -inf],
          [-3.2134e-01, -1.5501e+00,        -inf,        -inf],
          [ 4.6014e+00, -2.6382e+00, -2.3580e+00,        -inf],
          [-3.4428e-01, -1.0266e+00, -2.1655e+00, -1.4791e+00]],

         [[-3.0410e-01,        -inf,        -inf,        -inf],
          [-6.8587e-01, -4.3301e+00,        -inf,        -inf],
          [-2.3998e+00,  2.6122e+00, -4.7085e+00,        -inf],
          [-1.1555e+00,  3.8964e+00, -1.9237e+00, -2.9959e-04]],

         [[ 1.8489e+00,        -inf,        -inf,        -inf],
          [-1.7845e+00, -2.3418e+00,        -inf,        -inf],
          [ 3.4056e+00, -1.0759e+00, -1.9144e+00,        -inf],
          [-5.4561e+00, -3.2601e+00, -2.8963e+00, -2.0093e+00]],

         [[-2.1424e+00,        -inf,        -inf,        -inf],
          [-1.8906e+00, -1.0656e+00,        -inf,        -inf],
          [-8.7217e-01, -5.5340e-01,  4.6948e-01,        -inf],
          [ 4.0499e+00, -1.3637e+00,  1.9427e+00, -2.3335e+00]],

         [[ 1.8890e+00,        -inf,        -inf,        -inf],
          [-2.1887e+00,  1.3560e+00,        -inf,        -inf],
          [-2.0705e+00,  2.0313e+00,  6.3000e+00,        -inf],
          [ 1.2156e+00,  1.1839e+00,  4.6161e+00,  3.4717e-01]],

         [[ 2.7701e+00,        -inf,        -inf,        -inf],
          [ 1.3812e+00,  3.7350e+00,        -inf,        -inf],
          [ 2.7174e+00,  2.4014e+00,  2.9330e-01,        -inf],
          [ 2.1446e-01,  1.0467e+00, -1.2750e+00, -1.5961e+00]],

         [[ 1.2881e+00,        -inf,        -inf,        -inf],
          [-1.5933e+00, -4.8348e-01,        -inf,        -inf],
          [ 2.1884e-01,  1.9662e-01, -1.6157e+00,        -inf],
          [-2.7206e+00, -5.1372e-01,  7.4243e-01,  4.5355e+00]],

         [[-1.1564e+00,        -inf,        -inf,        -inf],
          [-2.1995e+00, -1.0270e+00,        -inf,        -inf],
          [-6.8771e+00,  1.1009e+00,  2.3888e+00,        -inf],
          [ 2.5348e+00, -3.0100e+00, -6.9423e-02,  9.2008e-01]],

         [[-2.4399e+00,        -inf,        -inf,        -inf],
          [-5.4468e+00, -8.7128e+00,        -inf,        -inf],
          [-6.7569e+00,  8.7371e+00,  3.7279e+00,        -inf],
          [-7.9682e+00,  1.8890e+00, -1.9873e+00, -2.9416e+00]],

         [[ 1.2352e+00,        -inf,        -inf,        -inf],
          [ 7.3014e-01, -4.7236e+00,        -inf,        -inf],
          [-2.2175e+00,  1.1312e+00, -4.6755e+00,        -inf],
          [-3.8157e-01,  4.7105e+00, -5.7231e-01,  1.5262e+00]],

         [[-4.8511e+00,        -inf,        -inf,        -inf],
          [ 1.0973e+00,  1.4223e-01,        -inf,        -inf],
          [ 1.5774e-01,  4.7586e-02,  3.7174e+00,        -inf],
          [ 5.1117e-01, -4.4182e+00, -3.9748e+00, -6.3898e+00]],

         [[ 1.9111e+00,        -inf,        -inf,        -inf],
          [ 4.6566e-01, -1.0041e+00,        -inf,        -inf],
          [-2.4945e+00, -1.2842e+00, -5.2903e-01,        -inf],
          [-2.2589e+00, -9.5329e-01, -4.6848e+00,  1.2118e+00]],

         [[ 8.7164e-01,        -inf,        -inf,        -inf],
          [-2.2454e+00, -7.2574e+00,        -inf,        -inf],
          [-6.7529e-01, -5.3110e-01,  1.8539e+00,        -inf],
          [-5.8976e+00,  2.0583e+00,  2.6398e+00,  8.0288e-01]],

         [[-2.1748e+00,        -inf,        -inf,        -inf],
          [-1.3387e+00,  2.8293e+00,        -inf,        -inf],
          [ 1.6109e+00, -8.8671e-01,  8.2306e+00,        -inf],
          [-1.1374e+00,  2.2428e+00, -1.2313e+00,  2.9407e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.5522e+00,        -inf,        -inf,        -inf],
          [ 1.7685e+00, -2.6060e+00,        -inf,        -inf],
          [-8.6754e-01,  4.2451e+00, -1.7931e+00,        -inf],
          [ 2.7795e-01,  1.6423e+00,  1.5054e+00,  7.7160e-02]],

         [[-5.3312e+00,        -inf,        -inf,        -inf],
          [-1.2915e+00, -3.1740e+00,        -inf,        -inf],
          [-2.8760e+00, -1.7674e+00,  1.2766e+00,        -inf],
          [-2.6617e+00, -2.4788e+00, -9.4025e-02, -2.3175e+00]],

         [[-5.5910e-03,        -inf,        -inf,        -inf],
          [ 1.5718e+00,  3.9801e+00,        -inf,        -inf],
          [-1.7898e+00,  3.9621e+00, -2.6038e+00,        -inf],
          [-1.0045e+00, -2.7376e+00, -1.7446e+00,  1.4519e+00]],

         [[ 4.1861e+00,        -inf,        -inf,        -inf],
          [ 8.0378e-01, -4.1374e-01,        -inf,        -inf],
          [-4.7393e+00,  2.1804e-01, -1.2621e+00,        -inf],
          [ 3.3317e+00,  4.8470e+00,  3.7543e+00, -1.2386e+00]],

         [[-3.6348e+00,        -inf,        -inf,        -inf],
          [-7.3737e-01, -2.5897e+00,        -inf,        -inf],
          [-5.8240e-01,  1.4156e+00,  4.0520e-01,        -inf],
          [ 3.6260e+00, -1.4425e+00, -2.4987e-01,  5.3674e+00]],

         [[ 3.8019e+00,        -inf,        -inf,        -inf],
          [-4.0623e-01, -4.8047e+00,        -inf,        -inf],
          [-5.7663e-01,  8.0606e-01, -1.0688e+00,        -inf],
          [ 1.6439e+00,  1.4755e+00,  1.8751e-01,  1.3322e+00]],

         [[-2.6727e+00,        -inf,        -inf,        -inf],
          [-8.7819e-01, -2.7978e-01,        -inf,        -inf],
          [-4.3208e+00,  4.9068e-01, -2.8439e+00,        -inf],
          [-1.4137e+00, -6.9840e-01,  8.0864e-01,  1.7175e-01]],

         [[-1.7551e+00,        -inf,        -inf,        -inf],
          [ 1.5568e+00, -1.0455e+00,        -inf,        -inf],
          [-2.4122e+00, -3.2322e-01,  5.7308e+00,        -inf],
          [-3.1114e-04, -5.9049e-01,  2.6792e+00,  5.3729e+00]],

         [[ 1.1822e+00,        -inf,        -inf,        -inf],
          [-2.2786e+00,  1.2373e+00,        -inf,        -inf],
          [-8.9872e-01, -1.5199e-01, -1.5405e+00,        -inf],
          [-9.8080e-01,  7.6861e-01, -3.9923e-02,  4.0928e+00]],

         [[-4.6209e+00,        -inf,        -inf,        -inf],
          [-5.6987e-01, -2.0295e+00,        -inf,        -inf],
          [ 1.3635e+00,  2.5992e+00, -1.5709e+00,        -inf],
          [-3.0375e+00, -3.6849e+00, -2.2305e+00,  3.4170e+00]],

         [[-2.1159e+00,        -inf,        -inf,        -inf],
          [ 2.5438e+00,  7.5742e-01,        -inf,        -inf],
          [-1.1482e+00,  1.9041e+00, -3.7712e+00,        -inf],
          [ 2.9569e+00,  1.3414e+00,  5.0504e+00,  4.8627e-03]],

         [[-1.9756e+00,        -inf,        -inf,        -inf],
          [ 4.7817e-01,  5.2646e-01,        -inf,        -inf],
          [ 1.4535e+00,  1.6925e+00, -3.4400e+00,        -inf],
          [-2.2217e+00,  1.0690e+00, -1.3456e+00, -6.9398e+00]],

         [[-1.7926e-01,        -inf,        -inf,        -inf],
          [-2.9514e-01, -3.7943e+00,        -inf,        -inf],
          [ 1.8065e-01,  2.6069e+00,  1.3879e+00,        -inf],
          [ 3.7018e+00,  2.6950e+00, -1.6163e-01,  1.7903e+00]],

         [[ 4.9204e-01,        -inf,        -inf,        -inf],
          [-2.9167e+00, -1.8205e+00,        -inf,        -inf],
          [ 1.7507e+00,  2.1551e+00, -8.0634e-01,        -inf],
          [ 1.1365e+00,  4.5968e+00, -1.3788e+00,  5.2683e-01]],

         [[-1.2542e+00,        -inf,        -inf,        -inf],
          [-1.2250e-01,  2.7110e+00,        -inf,        -inf],
          [-4.4181e-01, -1.7573e+00, -8.2268e-01,        -inf],
          [-3.7894e-01, -1.5783e+00,  4.7551e-02, -1.4423e+00]],

         [[ 1.1769e+00,        -inf,        -inf,        -inf],
          [-2.5965e+00, -8.9774e-01,        -inf,        -inf],
          [-3.0074e+00, -1.6388e+00,  1.3161e+00,        -inf],
          [-9.8980e-01, -3.2139e+00,  9.4632e-01,  1.2223e+00]],

         [[-9.8995e-01,        -inf,        -inf,        -inf],
          [-2.6532e+00,  3.9102e+00,        -inf,        -inf],
          [-1.5985e+00,  4.9375e-01,  1.6285e+00,        -inf],
          [ 2.8583e+00, -4.1109e+00, -2.8440e+00, -9.5317e-01]],

         [[ 4.5355e+00,        -inf,        -inf,        -inf],
          [ 2.6598e+00, -3.9616e-01,        -inf,        -inf],
          [-5.0244e-01, -4.5545e+00,  1.7518e+00,        -inf],
          [ 4.5365e+00, -4.2642e-01, -2.0998e+00,  3.8574e+00]],

         [[-2.1356e-01,        -inf,        -inf,        -inf],
          [-5.5017e-01, -3.8553e+00,        -inf,        -inf],
          [-5.5345e-01,  1.1598e+00, -2.1488e+00,        -inf],
          [ 3.9503e-01,  8.6287e-01, -1.1575e+00,  1.5515e+00]],

         [[-1.5483e-01,        -inf,        -inf,        -inf],
          [-1.0503e+00, -3.2490e+00,        -inf,        -inf],
          [-3.3072e+00,  2.3276e+00, -1.3744e+00,        -inf],
          [-2.3996e+00, -1.6712e+00, -4.6976e+00,  2.3596e+00]],

         [[-2.6671e+00,        -inf,        -inf,        -inf],
          [-4.4716e+00, -1.1624e+00,        -inf,        -inf],
          [-3.5542e+00, -1.9411e+00, -5.8328e+00,        -inf],
          [-8.6833e-01, -3.4542e-01, -1.7282e+00, -2.9219e+00]],

         [[-2.2652e+00,        -inf,        -inf,        -inf],
          [ 1.3554e+00,  4.3988e+00,        -inf,        -inf],
          [ 1.7387e-01,  1.8801e+00,  3.4088e-01,        -inf],
          [ 1.0104e+00,  1.9656e+00, -3.4731e+00, -5.6841e-02]],

         [[-1.7515e+00,        -inf,        -inf,        -inf],
          [-6.7951e-02,  3.5815e+00,        -inf,        -inf],
          [-2.5077e+00, -1.8893e-02, -9.1188e-01,        -inf],
          [-3.1178e+00, -1.1390e+00, -1.7182e-01,  6.8181e-01]],

         [[ 1.8630e+00,        -inf,        -inf,        -inf],
          [-2.1517e+00, -2.1925e+00,        -inf,        -inf],
          [ 1.1409e+00,  3.9151e+00, -2.5183e+00,        -inf],
          [-2.6006e+00,  2.2576e+00, -7.0570e+00,  3.6837e+00]],

         [[-1.4797e+00,        -inf,        -inf,        -inf],
          [-2.5591e+00,  2.0748e+00,        -inf,        -inf],
          [-5.3826e-01, -6.6780e-01, -3.2024e+00,        -inf],
          [-1.3418e+00,  1.3193e+00,  8.8592e-02,  1.0566e+00]]],


        [[[ 1.9465e+00,        -inf,        -inf,        -inf],
          [-6.6140e-02, -4.8121e+00,        -inf,        -inf],
          [ 9.6498e-01, -1.0226e+00, -3.9025e+00,        -inf],
          [ 2.0066e+00, -3.1668e+00,  3.5304e-01,  1.1159e+00]],

         [[-6.9731e-01,        -inf,        -inf,        -inf],
          [ 3.5203e-01, -3.1812e+00,        -inf,        -inf],
          [-2.0460e+00, -4.4153e+00, -1.5015e+00,        -inf],
          [-3.1298e+00, -4.8376e-01, -2.4902e+00, -8.2482e-01]],

         [[-2.3943e+00,        -inf,        -inf,        -inf],
          [-3.7457e-01, -4.3989e+00,        -inf,        -inf],
          [-2.9273e+00,  6.5131e-01, -3.7822e+00,        -inf],
          [-3.4675e-01, -9.7040e-02, -2.8869e-01,  1.0276e+00]],

         [[ 1.7877e+00,        -inf,        -inf,        -inf],
          [-2.8023e+00, -1.4667e-01,        -inf,        -inf],
          [-4.5063e+00,  2.6223e-01,  9.5402e-01,        -inf],
          [ 1.4080e-01,  3.6062e+00,  1.6058e+00,  8.5314e-01]],

         [[-5.6110e+00,        -inf,        -inf,        -inf],
          [-4.1944e+00, -4.6685e+00,        -inf,        -inf],
          [ 1.5821e+00,  2.8349e+00, -5.0766e+00,        -inf],
          [ 2.0719e+00, -4.8003e+00,  4.7182e-01,  4.6351e+00]],

         [[ 1.4644e+00,        -inf,        -inf,        -inf],
          [-3.1007e+00, -2.2485e+00,        -inf,        -inf],
          [-3.4099e+00, -3.7909e-01,  3.5903e+00,        -inf],
          [-1.5564e+00, -2.7124e+00, -5.2947e+00, -3.3326e+00]],

         [[-2.7998e+00,        -inf,        -inf,        -inf],
          [-1.7155e+00,  4.8389e-01,        -inf,        -inf],
          [-2.5335e+00,  6.3580e-01, -2.3817e+00,        -inf],
          [-5.4305e+00,  1.3717e+00, -3.5635e+00, -1.4298e+00]],

         [[-1.9486e+00,        -inf,        -inf,        -inf],
          [ 1.0426e-01, -1.8051e+00,        -inf,        -inf],
          [ 3.1717e+00,  2.4558e-01,  7.2028e-01,        -inf],
          [-1.8362e-01,  7.1631e-01,  1.0786e+00,  1.9348e+00]],

         [[-2.9798e+00,        -inf,        -inf,        -inf],
          [-1.6650e-01,  1.1302e-01,        -inf,        -inf],
          [-1.8205e+00, -6.0643e+00,  3.3078e+00,        -inf],
          [-1.5858e+00,  2.1730e-01,  4.9270e+00,  2.4572e+00]],

         [[-2.2969e+00,        -inf,        -inf,        -inf],
          [-1.1014e+00,  1.5152e+00,        -inf,        -inf],
          [ 1.0526e+00,  5.4940e-01, -2.0948e+00,        -inf],
          [ 1.7188e+00,  8.9149e-01,  1.0079e-01, -1.5511e+00]],

         [[-2.1194e-01,        -inf,        -inf,        -inf],
          [ 2.3246e+00,  7.9184e-01,        -inf,        -inf],
          [ 4.3587e+00,  3.1723e+00, -2.2538e+00,        -inf],
          [ 5.6063e-01,  2.4287e+00,  2.5585e-01,  2.0617e+00]],

         [[-2.3104e+00,        -inf,        -inf,        -inf],
          [-3.2134e-01, -1.5501e+00,        -inf,        -inf],
          [ 4.6014e+00, -2.6382e+00, -2.3580e+00,        -inf],
          [-3.4428e-01, -1.0266e+00, -2.1655e+00, -1.4791e+00]],

         [[-3.0410e-01,        -inf,        -inf,        -inf],
          [-6.8587e-01, -4.3301e+00,        -inf,        -inf],
          [-2.3998e+00,  2.6122e+00, -4.7085e+00,        -inf],
          [-1.1555e+00,  3.8964e+00, -1.9237e+00, -2.9959e-04]],

         [[ 1.8489e+00,        -inf,        -inf,        -inf],
          [-1.7845e+00, -2.3418e+00,        -inf,        -inf],
          [ 3.4056e+00, -1.0759e+00, -1.9144e+00,        -inf],
          [-5.4561e+00, -3.2601e+00, -2.8963e+00, -2.0093e+00]],

         [[-2.1424e+00,        -inf,        -inf,        -inf],
          [-1.8906e+00, -1.0656e+00,        -inf,        -inf],
          [-8.7217e-01, -5.5340e-01,  4.6948e-01,        -inf],
          [ 4.0499e+00, -1.3637e+00,  1.9427e+00, -2.3335e+00]],

         [[ 1.8890e+00,        -inf,        -inf,        -inf],
          [-2.1887e+00,  1.3560e+00,        -inf,        -inf],
          [-2.0705e+00,  2.0313e+00,  6.3000e+00,        -inf],
          [ 1.2156e+00,  1.1839e+00,  4.6161e+00,  3.4717e-01]],

         [[ 2.7701e+00,        -inf,        -inf,        -inf],
          [ 1.3812e+00,  3.7350e+00,        -inf,        -inf],
          [ 2.7174e+00,  2.4014e+00,  2.9330e-01,        -inf],
          [ 2.1446e-01,  1.0467e+00, -1.2750e+00, -1.5961e+00]],

         [[ 1.2881e+00,        -inf,        -inf,        -inf],
          [-1.5933e+00, -4.8348e-01,        -inf,        -inf],
          [ 2.1884e-01,  1.9662e-01, -1.6157e+00,        -inf],
          [-2.7206e+00, -5.1372e-01,  7.4243e-01,  4.5355e+00]],

         [[-1.1564e+00,        -inf,        -inf,        -inf],
          [-2.1995e+00, -1.0270e+00,        -inf,        -inf],
          [-6.8771e+00,  1.1009e+00,  2.3888e+00,        -inf],
          [ 2.5348e+00, -3.0100e+00, -6.9423e-02,  9.2008e-01]],

         [[-2.4399e+00,        -inf,        -inf,        -inf],
          [-5.4468e+00, -8.7128e+00,        -inf,        -inf],
          [-6.7569e+00,  8.7371e+00,  3.7279e+00,        -inf],
          [-7.9682e+00,  1.8890e+00, -1.9873e+00, -2.9416e+00]],

         [[ 1.2352e+00,        -inf,        -inf,        -inf],
          [ 7.3014e-01, -4.7236e+00,        -inf,        -inf],
          [-2.2175e+00,  1.1312e+00, -4.6755e+00,        -inf],
          [-3.8157e-01,  4.7105e+00, -5.7231e-01,  1.5262e+00]],

         [[-4.8511e+00,        -inf,        -inf,        -inf],
          [ 1.0973e+00,  1.4223e-01,        -inf,        -inf],
          [ 1.5774e-01,  4.7586e-02,  3.7174e+00,        -inf],
          [ 5.1117e-01, -4.4182e+00, -3.9748e+00, -6.3898e+00]],

         [[ 1.9111e+00,        -inf,        -inf,        -inf],
          [ 4.6566e-01, -1.0041e+00,        -inf,        -inf],
          [-2.4945e+00, -1.2842e+00, -5.2903e-01,        -inf],
          [-2.2589e+00, -9.5329e-01, -4.6848e+00,  1.2118e+00]],

         [[ 8.7164e-01,        -inf,        -inf,        -inf],
          [-2.2454e+00, -7.2574e+00,        -inf,        -inf],
          [-6.7529e-01, -5.3110e-01,  1.8539e+00,        -inf],
          [-5.8976e+00,  2.0583e+00,  2.6398e+00,  8.0288e-01]],

         [[-2.1748e+00,        -inf,        -inf,        -inf],
          [-1.3387e+00,  2.8293e+00,        -inf,        -inf],
          [ 1.6109e+00, -8.8671e-01,  8.2306e+00,        -inf],
          [-1.1374e+00,  2.2428e+00, -1.2313e+00,  2.9407e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.4672,  0.4514, -0.4457,  ..., -0.8081, -0.6930, -0.1098],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0604,  0.2895, -0.1004,  ..., -0.4147,  0.4587,  0.1268],
          ...,
          [ 0.9108,  0.6847,  0.2350,  ..., -0.5237,  0.5437, -0.0224],
          [ 0.7275,  0.0556,  0.7373,  ..., -0.2001,  0.2857,  0.1459],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[-0.3130,  0.0963, -0.1077,  ...,  0.0881, -0.0146, -0.2612],
          [ 0.1228,  0.1284,  0.4167,  ...,  0.2027, -0.2390,  0.1265],
          [ 0.1272,  0.0049,  0.6895,  ..., -0.3982,  0.2437,  0.8066],
          ...,
          [ 0.4133,  0.4190, -0.0505,  ..., -0.0068, -0.2425, -0.5381],
          [ 0.2359, -0.3235,  0.2911,  ..., -0.5368, -0.0505,  0.0367],
          [-0.0022, -0.1306, -0.3837,  ...,  0.2508,  0.3179,  0.0908]],

         [[-0.7218,  0.3442, -0.2782,  ..., -0.0415, -0.1338, -0.2482],
          [ 0.4500, -0.0837, -0.2521,  ...,  0.3222, -0.2576, -0.2480],
          [ 0.2648,  0.0183,  0.4212,  ..., -0.4707,  0.2625,  0.8414],
          ...,
          [ 0.2379,  0.0609,  0.2099,  ..., -0.2699, -0.1054,  0.0074],
          [ 0.0373, -0.7055,  0.0969,  ..., -0.2055, -0.2143,  0.0725],
          [-0.0325, -0.1138, -0.4564,  ...,  0.2775,  0.2026,  0.4139]],

         [[-0.7081,  0.4191, -0.2356,  ..., -0.1918, -0.1501,  0.3625],
          [ 0.4325,  0.0185,  0.0670,  ...,  0.6469, -0.5492,  0.0854],
          [ 0.0130,  0.5944,  0.0726,  ..., -0.0208,  0.3714,  0.3572],
          ...,
          [ 0.0107, -0.0433,  0.0593,  ..., -0.0216, -0.3824, -0.1968],
          [ 0.0313, -0.2610,  0.2377,  ...,  0.2396, -0.1491,  0.5359],
          [-0.2319, -0.1977, -0.3928,  ...,  0.1868,  0.0097,  0.3998]]],


        [[[-0.2248,  0.0946, -0.5616,  ..., -0.1189, -0.8453, -0.4957],
          [ 0.0238,  0.1252,  1.0722,  ...,  0.0627, -0.6159, -0.2175],
          [-0.7487,  0.5681, -0.5768,  ...,  0.0678,  0.6315, -0.0166],
          ...,
          [ 1.1980,  0.4998,  0.0950,  ..., -0.3723,  0.0206,  0.3921],
          [ 0.6427, -0.1085,  0.7501,  ...,  0.2183,  0.9237,  0.1329],
          [-0.0495,  0.9143,  0.0731,  ..., -0.4161,  0.3045, -0.0596]],

         [[-0.2327,  0.2003, -0.3555,  ..., -0.0336, -0.7276, -0.2410],
          [ 0.1239, -0.0555,  0.6823,  ..., -0.1884, -0.6033, -0.0413],
          [-0.3471,  0.3510,  0.0067,  ..., -0.2320,  0.3741,  0.1963],
          ...,
          [ 0.3371,  0.1339, -0.3253,  ..., -0.1842, -0.3404,  0.4227],
          [ 0.5765, -0.3091,  0.6223,  ..., -0.2309,  0.6237,  0.0809],
          [ 0.2427, -0.3454, -0.1938,  ..., -0.0475,  0.1563, -0.0629]],

         [[-0.2410,  0.1916, -0.2911,  ..., -0.0502, -0.6181, -0.0076],
          [ 0.2324, -0.0098,  0.5750,  ...,  0.0735, -0.5640, -0.0989],
          [ 0.2682,  0.1620,  0.4114,  ..., -0.4008,  0.1959,  0.4190],
          ...,
          [-0.4403, -0.5170, -0.3475,  ..., -0.1860, -0.7265,  0.8524],
          [ 0.3255, -0.2376,  0.3364,  ..., -0.2574,  0.2912,  0.0343],
          [-0.5461, -0.1475, -0.0453,  ..., -0.5265,  0.2150,  0.1889]],

         [[-0.3992, -0.0267, -0.2779,  ...,  0.0765, -0.6028,  0.1143],
          [ 0.3039, -0.1881,  0.6687,  ..., -0.2128, -0.5714, -0.1215],
          [-0.2293,  0.3008, -0.1433,  ..., -0.0642,  0.1788,  0.2372],
          ...,
          [-0.4938, -0.0446, -0.4916,  ...,  0.1155, -0.5638,  0.2951],
          [ 0.3259, -0.5316, -0.1267,  ...,  0.0456,  0.1047,  0.3262],
          [-0.0517,  0.0669, -0.3169,  ..., -0.7369, -0.0422, -0.2183]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.4672,  0.4514, -0.4457,  ...,  0.0000,  0.0000,  0.0000],
         [-0.3130,  0.0963, -0.1077,  ...,  0.2508,  0.3179,  0.0908],
         [-0.7218,  0.3442, -0.2782,  ...,  0.2775,  0.2026,  0.4139],
         [-0.7081,  0.4191, -0.2356,  ...,  0.1868,  0.0097,  0.3998]],

        [[-0.2248,  0.0946, -0.5616,  ..., -0.4161,  0.3045, -0.0596],
         [-0.2327,  0.2003, -0.3555,  ..., -0.0475,  0.1563, -0.0629],
         [-0.2410,  0.1916, -0.2911,  ..., -0.5265,  0.2150,  0.1889],
         [-0.3992, -0.0267, -0.2779,  ..., -0.7369, -0.0422, -0.2183]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.1176,  0.0918, -0.2674,  ..., -0.5932,  0.0925, -0.1159],
         [ 0.2609,  0.0750, -0.1381,  ..., -0.1310, -0.3232,  0.0786],
         [ 0.2208,  0.1709, -0.0608,  ..., -0.1132, -0.1721,  0.1317],
         [ 0.2053,  0.0104, -0.3200,  ..., -0.0997, -0.0886,  0.1651]],

        [[-0.3408,  0.3774,  0.0279,  ..., -0.8703, -0.1014, -0.1847],
         [ 0.1849,  0.5104,  0.1122,  ..., -0.4439,  0.1661,  0.1145],
         [ 0.1741,  0.4343,  0.1274,  ..., -0.4909, -0.1799,  0.1195],
         [ 0.1412,  0.2027,  0.0856,  ..., -0.0959, -0.0967,  0.0460]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 8.0074e-01,        -inf,        -inf,        -inf],
          [-1.5696e-01, -2.0906e+00,        -inf,        -inf],
          [-4.2503e+00,  2.6587e+00,  1.1494e+00,        -inf],
          [ 1.9141e+00,  5.2276e+00,  1.2315e+00, -2.3217e+00]],

         [[-1.2416e+00,        -inf,        -inf,        -inf],
          [-1.2899e-01, -1.7180e+00,        -inf,        -inf],
          [-9.4787e-01, -6.0916e-01,  1.6728e+00,        -inf],
          [-1.0916e+00,  1.2202e+00,  1.6765e+00,  3.3443e-01]],

         [[ 3.3605e+00,        -inf,        -inf,        -inf],
          [-1.7183e+00,  7.4209e+00,        -inf,        -inf],
          [-2.5477e+00, -1.2087e+00, -1.6739e+00,        -inf],
          [ 1.3697e+00,  3.3775e+00,  2.1314e+00, -1.0034e+00]],

         [[-8.4823e-01,        -inf,        -inf,        -inf],
          [ 2.2563e+00,  8.2176e-01,        -inf,        -inf],
          [-2.0001e+00,  2.5448e+00, -1.1649e+00,        -inf],
          [-4.6496e+00, -2.3355e+00,  8.4947e-03, -2.0093e+00]],

         [[-7.1637e-02,        -inf,        -inf,        -inf],
          [-3.1693e+00, -3.0994e+00,        -inf,        -inf],
          [-1.4424e+00, -3.0343e+00, -2.2944e-01,        -inf],
          [-2.0813e+00,  5.1871e-01, -1.7993e+00, -4.0833e+00]],

         [[ 3.2806e+00,        -inf,        -inf,        -inf],
          [ 3.9946e+00,  4.7854e+00,        -inf,        -inf],
          [-2.5278e+00,  2.1580e+00, -1.5475e+00,        -inf],
          [ 2.3128e+00, -7.5248e-01, -5.8941e-01,  3.3227e+00]],

         [[ 6.7438e-01,        -inf,        -inf,        -inf],
          [ 2.4188e+00,  2.4658e+00,        -inf,        -inf],
          [ 1.8892e+00, -9.4244e-01, -3.9722e+00,        -inf],
          [-3.1318e+00, -1.5648e+00, -1.9885e+00,  3.6241e+00]],

         [[-3.3866e-01,        -inf,        -inf,        -inf],
          [ 2.3392e+00,  9.1552e-01,        -inf,        -inf],
          [ 1.2686e-02, -4.2096e+00, -4.4459e-01,        -inf],
          [-2.2382e+00, -1.6174e+00,  7.6237e-01,  2.3805e+00]],

         [[ 3.5654e+00,        -inf,        -inf,        -inf],
          [ 1.8546e+00,  2.6219e+00,        -inf,        -inf],
          [ 4.7025e+00,  1.6515e-02,  3.1106e+00,        -inf],
          [ 4.8555e-01,  3.5493e+00, -8.3585e-01,  1.1434e+00]],

         [[-3.7629e+00,        -inf,        -inf,        -inf],
          [-5.3042e+00,  5.5033e-01,        -inf,        -inf],
          [-1.0328e-01, -5.1245e-01,  2.1886e-01,        -inf],
          [-3.1551e+00, -1.3367e+00, -4.7379e+00, -1.4144e+00]],

         [[-2.2625e+00,        -inf,        -inf,        -inf],
          [-2.8416e-01,  6.0095e-01,        -inf,        -inf],
          [ 1.0500e-01,  1.3442e+00, -6.8618e-01,        -inf],
          [ 2.3093e+00, -1.3402e-01, -1.8259e+00, -4.7516e-01]],

         [[ 1.7045e+00,        -inf,        -inf,        -inf],
          [-7.2681e-01, -2.4289e-01,        -inf,        -inf],
          [ 1.9870e-01,  1.6619e+00,  3.4471e+00,        -inf],
          [ 3.8879e+00,  4.2279e+00,  5.4622e+00,  2.3649e+00]],

         [[ 2.2840e+00,        -inf,        -inf,        -inf],
          [ 4.0863e+00,  1.7723e+00,        -inf,        -inf],
          [ 6.4656e+00,  3.5110e+00,  4.1462e+00,        -inf],
          [ 2.7170e+00, -5.3304e-01,  3.5941e+00, -8.5514e-01]],

         [[ 6.2586e-01,        -inf,        -inf,        -inf],
          [-2.7598e+00,  2.2268e+00,        -inf,        -inf],
          [-1.9593e+00, -2.0951e+00, -1.7214e+00,        -inf],
          [-6.3928e-01,  3.8771e-01, -5.7511e+00, -3.1245e+00]],

         [[ 1.8089e+00,        -inf,        -inf,        -inf],
          [ 6.4205e-01, -2.9579e+00,        -inf,        -inf],
          [-1.7939e-01,  9.4241e-01, -1.5120e+00,        -inf],
          [ 2.5923e+00, -4.7183e-02,  2.3075e+00,  1.4943e+00]],

         [[-7.3070e+00,        -inf,        -inf,        -inf],
          [-1.2266e+00,  3.0938e+00,        -inf,        -inf],
          [-8.6935e+00,  6.5510e-01,  4.5467e-01,        -inf],
          [-5.5075e-01, -8.9655e-01,  1.5092e+00, -2.5920e-01]],

         [[ 4.1656e-01,        -inf,        -inf,        -inf],
          [-4.8753e-01, -2.9450e+00,        -inf,        -inf],
          [ 1.1152e+00, -2.2441e+00,  8.8369e-01,        -inf],
          [-2.7552e+00, -2.1104e+00,  3.2950e-01, -3.1154e+00]],

         [[ 3.6005e+00,        -inf,        -inf,        -inf],
          [ 1.6922e-01, -2.2187e-01,        -inf,        -inf],
          [ 2.7247e+00,  9.5422e+00,  3.1934e+00,        -inf],
          [ 3.2716e+00,  2.8216e+00,  5.5527e+00,  5.0841e+00]],

         [[-9.3302e-01,        -inf,        -inf,        -inf],
          [-4.0621e-01,  1.6249e+00,        -inf,        -inf],
          [-6.3365e-01,  2.2682e+00, -1.4148e+00,        -inf],
          [ 5.1170e-01, -8.7589e-02, -1.5950e+00,  8.0431e-01]],

         [[-2.1496e+00,        -inf,        -inf,        -inf],
          [ 4.2089e-01,  1.9035e-01,        -inf,        -inf],
          [-2.2997e+00,  8.7312e-01,  4.8519e+00,        -inf],
          [ 1.5661e+00, -1.8660e+00, -1.6066e+00, -2.9143e+00]],

         [[ 1.0318e+00,        -inf,        -inf,        -inf],
          [-2.8834e-01, -1.1447e+00,        -inf,        -inf],
          [ 4.4524e+00,  2.6376e+00,  3.7036e+00,        -inf],
          [-1.3632e+00,  8.4704e-01,  8.6970e-01, -1.4752e+00]],

         [[-5.1597e+00,        -inf,        -inf,        -inf],
          [ 2.8312e+00,  1.2388e+00,        -inf,        -inf],
          [-2.9815e+00, -8.3378e-03,  2.5262e+00,        -inf],
          [-2.2406e+00, -1.0704e+00, -1.2507e+00,  1.9376e+00]],

         [[ 4.1803e+00,        -inf,        -inf,        -inf],
          [ 3.5455e+00,  3.8513e+00,        -inf,        -inf],
          [-4.7325e-01, -1.9086e-01,  1.0189e+00,        -inf],
          [-1.3938e+00, -1.6040e+00,  1.1444e+00,  6.7589e-01]],

         [[-5.8547e+00,        -inf,        -inf,        -inf],
          [ 4.7836e-02, -1.5198e+00,        -inf,        -inf],
          [ 8.8059e-01, -3.2464e+00,  1.2731e+00,        -inf],
          [ 9.9365e-01, -1.3136e+00, -1.9031e+00, -5.9203e-01]],

         [[-9.1684e-02,        -inf,        -inf,        -inf],
          [-1.0873e+00, -2.5008e+00,        -inf,        -inf],
          [-7.3370e-01,  2.3790e+00,  4.2397e+00,        -inf],
          [-1.1648e+00, -1.1751e+00, -1.3256e+00,  3.3884e+00]]],


        [[[ 2.0433e+00,        -inf,        -inf,        -inf],
          [ 5.3235e+00,  1.3774e+00,        -inf,        -inf],
          [ 1.0421e+00,  5.2203e+00,  1.2624e+00,        -inf],
          [ 2.4302e+00,  1.3670e+00, -5.0185e-02, -1.3402e+00]],

         [[-5.1182e-01,        -inf,        -inf,        -inf],
          [ 2.5441e+00,  9.9527e-01,        -inf,        -inf],
          [ 1.2561e+00,  6.3231e-01, -7.3241e-02,        -inf],
          [-1.4819e+00,  3.2615e-01,  5.9917e-01, -3.2222e+00]],

         [[ 1.6285e+00,        -inf,        -inf,        -inf],
          [ 1.2183e+00,  3.9433e+00,        -inf,        -inf],
          [-3.8790e+00, -8.8762e-01, -1.7600e+00,        -inf],
          [-5.5696e+00, -1.2390e+00, -4.6165e+00, -1.2334e+00]],

         [[ 2.9089e-01,        -inf,        -inf,        -inf],
          [-1.4840e+00, -2.1032e+00,        -inf,        -inf],
          [ 5.3029e-01, -3.3979e-01,  2.1869e+00,        -inf],
          [-4.3309e+00, -4.0698e+00, -2.6401e+00, -4.4799e+00]],

         [[-2.6943e+00,        -inf,        -inf,        -inf],
          [-2.9681e+00, -3.5544e+00,        -inf,        -inf],
          [-1.0330e+00, -4.8454e+00,  2.3726e+00,        -inf],
          [-2.5181e-01, -1.8449e+00,  2.9330e+00, -2.4441e+00]],

         [[ 5.6359e+00,        -inf,        -inf,        -inf],
          [ 3.3037e+00,  7.6539e-01,        -inf,        -inf],
          [-1.2225e+00, -3.2972e+00, -7.1467e+00,        -inf],
          [ 1.2639e-01,  2.9669e-01,  8.4476e-01,  1.7001e+00]],

         [[-2.3352e+00,        -inf,        -inf,        -inf],
          [ 1.1058e-01,  4.6153e+00,        -inf,        -inf],
          [-9.0546e-01, -4.5374e+00, -6.7095e+00,        -inf],
          [-3.0937e+00,  7.2674e-01, -3.0715e+00,  2.0244e+00]],

         [[-1.6058e+00,        -inf,        -inf,        -inf],
          [-4.6498e-01,  1.6322e+00,        -inf,        -inf],
          [ 1.1989e+00, -4.5480e-01, -3.2500e+00,        -inf],
          [-3.7152e+00, -1.1927e+00,  1.0272e+00,  9.5983e-01]],

         [[ 1.6963e+00,        -inf,        -inf,        -inf],
          [-1.7645e+00, -2.0709e+00,        -inf,        -inf],
          [-8.7146e-02, -2.3210e+00, -2.7562e-01,        -inf],
          [-3.5072e+00, -1.5755e+00, -9.7881e-02, -8.3123e-01]],

         [[-1.9051e+00,        -inf,        -inf,        -inf],
          [ 3.9298e+00,  4.4495e+00,        -inf,        -inf],
          [ 1.2361e+00, -1.5352e-01,  4.0726e+00,        -inf],
          [-3.3105e-01, -1.8613e+00,  4.6272e+00, -1.2979e-01]],

         [[-4.1587e-01,        -inf,        -inf,        -inf],
          [ 2.1877e+00,  4.4516e+00,        -inf,        -inf],
          [ 1.2491e+00,  5.2972e+00, -2.5041e+00,        -inf],
          [-9.9432e-01,  1.7539e+00,  7.1976e-01, -3.3805e+00]],

         [[ 1.8716e+00,        -inf,        -inf,        -inf],
          [ 8.3325e-01, -8.9324e-01,        -inf,        -inf],
          [-5.5609e+00, -1.5190e+00, -1.4167e+00,        -inf],
          [ 2.6064e+00, -1.7788e+00, -1.1990e+00,  4.4428e+00]],

         [[ 3.9673e+00,        -inf,        -inf,        -inf],
          [ 3.8655e+00,  2.2140e-01,        -inf,        -inf],
          [ 2.0367e+00, -5.5303e-01, -6.2872e-02,        -inf],
          [ 2.0264e-01, -9.6694e-01,  5.6630e-01, -7.8056e-01]],

         [[-6.6370e-01,        -inf,        -inf,        -inf],
          [-1.3386e+00, -9.1697e-01,        -inf,        -inf],
          [ 3.6578e+00, -1.7396e+00,  3.7208e+00,        -inf],
          [-4.8519e+00, -4.7477e+00, -4.0204e+00, -6.1872e+00]],

         [[ 3.7262e+00,        -inf,        -inf,        -inf],
          [-2.8211e-03,  2.9643e+00,        -inf,        -inf],
          [ 1.7504e+00,  8.1325e-01, -1.9221e+00,        -inf],
          [ 5.5647e+00, -4.3206e+00, -2.5581e+00, -6.6367e+00]],

         [[-6.2282e+00,        -inf,        -inf,        -inf],
          [-2.1587e+00,  2.9929e-01,        -inf,        -inf],
          [-6.6470e+00,  1.7867e+00,  1.0737e+00,        -inf],
          [-1.3121e+00, -1.7633e+00, -1.6459e+00,  3.3153e+00]],

         [[-3.1312e+00,        -inf,        -inf,        -inf],
          [ 1.3074e+00,  2.6821e+00,        -inf,        -inf],
          [ 4.9418e+00,  2.9710e+00,  2.6171e+00,        -inf],
          [ 1.2932e+00,  9.1851e-01,  6.2312e+00,  3.6517e-01]],

         [[ 5.6984e+00,        -inf,        -inf,        -inf],
          [ 4.6600e+00, -1.9882e+00,        -inf,        -inf],
          [ 1.4937e+00,  2.0163e+00,  3.0286e+00,        -inf],
          [ 3.8324e+00,  2.7729e+00,  6.5511e+00,  6.6226e+00]],

         [[-1.6356e-01,        -inf,        -inf,        -inf],
          [ 3.6329e+00,  3.7729e+00,        -inf,        -inf],
          [ 1.4893e+00, -2.6036e-01, -2.6436e+00,        -inf],
          [ 1.7947e+00,  3.5312e+00, -5.9731e+00, -5.6497e-02]],

         [[-1.8440e+00,        -inf,        -inf,        -inf],
          [-9.4761e-01, -1.0312e+00,        -inf,        -inf],
          [-2.4484e+00,  8.1978e-01,  2.9752e+00,        -inf],
          [-2.4659e+00,  7.8136e-01, -2.0435e+00,  3.5569e+00]],

         [[ 2.5819e+00,        -inf,        -inf,        -inf],
          [-1.4027e+00, -1.7303e+00,        -inf,        -inf],
          [ 6.1101e-01,  1.7791e-01, -1.7709e+00,        -inf],
          [-2.6148e+00, -2.4110e+00,  8.3538e-01, -5.3048e-01]],

         [[-3.6047e+00,        -inf,        -inf,        -inf],
          [-5.1555e+00, -2.8692e+00,        -inf,        -inf],
          [ 5.8128e-01, -4.8531e+00, -1.4006e-02,        -inf],
          [-4.6855e+00, -3.6599e+00,  2.3442e+00, -1.2052e+00]],

         [[ 5.6584e+00,        -inf,        -inf,        -inf],
          [ 6.3435e+00,  2.0029e+00,        -inf,        -inf],
          [ 4.8855e+00,  2.1203e+00, -2.4299e+00,        -inf],
          [ 4.7450e+00, -3.0957e-01,  4.0272e+00,  3.4418e+00]],

         [[-5.7661e+00,        -inf,        -inf,        -inf],
          [ 8.8827e-01,  8.1687e-01,        -inf,        -inf],
          [ 1.5813e+00, -4.2829e+00,  3.3147e-01,        -inf],
          [ 3.3192e+00,  7.7260e-01, -1.4478e+00,  2.2758e+00]],

         [[-1.2146e+00,        -inf,        -inf,        -inf],
          [ 1.8869e+00, -4.8936e-01,        -inf,        -inf],
          [ 3.1409e-01,  1.1147e+00,  5.3776e-01,        -inf],
          [-1.6700e+00,  1.4542e+00,  1.0337e+00,  4.6730e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 8.0074e-01,        -inf,        -inf,        -inf],
          [-1.5696e-01, -2.0906e+00,        -inf,        -inf],
          [-4.2503e+00,  2.6587e+00,  1.1494e+00,        -inf],
          [ 1.9141e+00,  5.2276e+00,  1.2315e+00, -2.3217e+00]],

         [[-1.2416e+00,        -inf,        -inf,        -inf],
          [-1.2899e-01, -1.7180e+00,        -inf,        -inf],
          [-9.4787e-01, -6.0916e-01,  1.6728e+00,        -inf],
          [-1.0916e+00,  1.2202e+00,  1.6765e+00,  3.3443e-01]],

         [[ 3.3605e+00,        -inf,        -inf,        -inf],
          [-1.7183e+00,  7.4209e+00,        -inf,        -inf],
          [-2.5477e+00, -1.2087e+00, -1.6739e+00,        -inf],
          [ 1.3697e+00,  3.3775e+00,  2.1314e+00, -1.0034e+00]],

         [[-8.4823e-01,        -inf,        -inf,        -inf],
          [ 2.2563e+00,  8.2176e-01,        -inf,        -inf],
          [-2.0001e+00,  2.5448e+00, -1.1649e+00,        -inf],
          [-4.6496e+00, -2.3355e+00,  8.4947e-03, -2.0093e+00]],

         [[-7.1637e-02,        -inf,        -inf,        -inf],
          [-3.1693e+00, -3.0994e+00,        -inf,        -inf],
          [-1.4424e+00, -3.0343e+00, -2.2944e-01,        -inf],
          [-2.0813e+00,  5.1871e-01, -1.7993e+00, -4.0833e+00]],

         [[ 3.2806e+00,        -inf,        -inf,        -inf],
          [ 3.9946e+00,  4.7854e+00,        -inf,        -inf],
          [-2.5278e+00,  2.1580e+00, -1.5475e+00,        -inf],
          [ 2.3128e+00, -7.5248e-01, -5.8941e-01,  3.3227e+00]],

         [[ 6.7438e-01,        -inf,        -inf,        -inf],
          [ 2.4188e+00,  2.4658e+00,        -inf,        -inf],
          [ 1.8892e+00, -9.4244e-01, -3.9722e+00,        -inf],
          [-3.1318e+00, -1.5648e+00, -1.9885e+00,  3.6241e+00]],

         [[-3.3866e-01,        -inf,        -inf,        -inf],
          [ 2.3392e+00,  9.1552e-01,        -inf,        -inf],
          [ 1.2686e-02, -4.2096e+00, -4.4459e-01,        -inf],
          [-2.2382e+00, -1.6174e+00,  7.6237e-01,  2.3805e+00]],

         [[ 3.5654e+00,        -inf,        -inf,        -inf],
          [ 1.8546e+00,  2.6219e+00,        -inf,        -inf],
          [ 4.7025e+00,  1.6515e-02,  3.1106e+00,        -inf],
          [ 4.8555e-01,  3.5493e+00, -8.3585e-01,  1.1434e+00]],

         [[-3.7629e+00,        -inf,        -inf,        -inf],
          [-5.3042e+00,  5.5033e-01,        -inf,        -inf],
          [-1.0328e-01, -5.1245e-01,  2.1886e-01,        -inf],
          [-3.1551e+00, -1.3367e+00, -4.7379e+00, -1.4144e+00]],

         [[-2.2625e+00,        -inf,        -inf,        -inf],
          [-2.8416e-01,  6.0095e-01,        -inf,        -inf],
          [ 1.0500e-01,  1.3442e+00, -6.8618e-01,        -inf],
          [ 2.3093e+00, -1.3402e-01, -1.8259e+00, -4.7516e-01]],

         [[ 1.7045e+00,        -inf,        -inf,        -inf],
          [-7.2681e-01, -2.4289e-01,        -inf,        -inf],
          [ 1.9870e-01,  1.6619e+00,  3.4471e+00,        -inf],
          [ 3.8879e+00,  4.2279e+00,  5.4622e+00,  2.3649e+00]],

         [[ 2.2840e+00,        -inf,        -inf,        -inf],
          [ 4.0863e+00,  1.7723e+00,        -inf,        -inf],
          [ 6.4656e+00,  3.5110e+00,  4.1462e+00,        -inf],
          [ 2.7170e+00, -5.3304e-01,  3.5941e+00, -8.5514e-01]],

         [[ 6.2586e-01,        -inf,        -inf,        -inf],
          [-2.7598e+00,  2.2268e+00,        -inf,        -inf],
          [-1.9593e+00, -2.0951e+00, -1.7214e+00,        -inf],
          [-6.3928e-01,  3.8771e-01, -5.7511e+00, -3.1245e+00]],

         [[ 1.8089e+00,        -inf,        -inf,        -inf],
          [ 6.4205e-01, -2.9579e+00,        -inf,        -inf],
          [-1.7939e-01,  9.4241e-01, -1.5120e+00,        -inf],
          [ 2.5923e+00, -4.7183e-02,  2.3075e+00,  1.4943e+00]],

         [[-7.3070e+00,        -inf,        -inf,        -inf],
          [-1.2266e+00,  3.0938e+00,        -inf,        -inf],
          [-8.6935e+00,  6.5510e-01,  4.5467e-01,        -inf],
          [-5.5075e-01, -8.9655e-01,  1.5092e+00, -2.5920e-01]],

         [[ 4.1656e-01,        -inf,        -inf,        -inf],
          [-4.8753e-01, -2.9450e+00,        -inf,        -inf],
          [ 1.1152e+00, -2.2441e+00,  8.8369e-01,        -inf],
          [-2.7552e+00, -2.1104e+00,  3.2950e-01, -3.1154e+00]],

         [[ 3.6005e+00,        -inf,        -inf,        -inf],
          [ 1.6922e-01, -2.2187e-01,        -inf,        -inf],
          [ 2.7247e+00,  9.5422e+00,  3.1934e+00,        -inf],
          [ 3.2716e+00,  2.8216e+00,  5.5527e+00,  5.0841e+00]],

         [[-9.3302e-01,        -inf,        -inf,        -inf],
          [-4.0621e-01,  1.6249e+00,        -inf,        -inf],
          [-6.3365e-01,  2.2682e+00, -1.4148e+00,        -inf],
          [ 5.1170e-01, -8.7589e-02, -1.5950e+00,  8.0431e-01]],

         [[-2.1496e+00,        -inf,        -inf,        -inf],
          [ 4.2089e-01,  1.9035e-01,        -inf,        -inf],
          [-2.2997e+00,  8.7312e-01,  4.8519e+00,        -inf],
          [ 1.5661e+00, -1.8660e+00, -1.6066e+00, -2.9143e+00]],

         [[ 1.0318e+00,        -inf,        -inf,        -inf],
          [-2.8834e-01, -1.1447e+00,        -inf,        -inf],
          [ 4.4524e+00,  2.6376e+00,  3.7036e+00,        -inf],
          [-1.3632e+00,  8.4704e-01,  8.6970e-01, -1.4752e+00]],

         [[-5.1597e+00,        -inf,        -inf,        -inf],
          [ 2.8312e+00,  1.2388e+00,        -inf,        -inf],
          [-2.9815e+00, -8.3378e-03,  2.5262e+00,        -inf],
          [-2.2406e+00, -1.0704e+00, -1.2507e+00,  1.9376e+00]],

         [[ 4.1803e+00,        -inf,        -inf,        -inf],
          [ 3.5455e+00,  3.8513e+00,        -inf,        -inf],
          [-4.7325e-01, -1.9086e-01,  1.0189e+00,        -inf],
          [-1.3938e+00, -1.6040e+00,  1.1444e+00,  6.7589e-01]],

         [[-5.8547e+00,        -inf,        -inf,        -inf],
          [ 4.7836e-02, -1.5198e+00,        -inf,        -inf],
          [ 8.8059e-01, -3.2464e+00,  1.2731e+00,        -inf],
          [ 9.9365e-01, -1.3136e+00, -1.9031e+00, -5.9203e-01]],

         [[-9.1684e-02,        -inf,        -inf,        -inf],
          [-1.0873e+00, -2.5008e+00,        -inf,        -inf],
          [-7.3370e-01,  2.3790e+00,  4.2397e+00,        -inf],
          [-1.1648e+00, -1.1751e+00, -1.3256e+00,  3.3884e+00]]],


        [[[ 2.0433e+00,        -inf,        -inf,        -inf],
          [ 5.3235e+00,  1.3774e+00,        -inf,        -inf],
          [ 1.0421e+00,  5.2203e+00,  1.2624e+00,        -inf],
          [ 2.4302e+00,  1.3670e+00, -5.0185e-02, -1.3402e+00]],

         [[-5.1182e-01,        -inf,        -inf,        -inf],
          [ 2.5441e+00,  9.9527e-01,        -inf,        -inf],
          [ 1.2561e+00,  6.3231e-01, -7.3241e-02,        -inf],
          [-1.4819e+00,  3.2615e-01,  5.9917e-01, -3.2222e+00]],

         [[ 1.6285e+00,        -inf,        -inf,        -inf],
          [ 1.2183e+00,  3.9433e+00,        -inf,        -inf],
          [-3.8790e+00, -8.8762e-01, -1.7600e+00,        -inf],
          [-5.5696e+00, -1.2390e+00, -4.6165e+00, -1.2334e+00]],

         [[ 2.9089e-01,        -inf,        -inf,        -inf],
          [-1.4840e+00, -2.1032e+00,        -inf,        -inf],
          [ 5.3029e-01, -3.3979e-01,  2.1869e+00,        -inf],
          [-4.3309e+00, -4.0698e+00, -2.6401e+00, -4.4799e+00]],

         [[-2.6943e+00,        -inf,        -inf,        -inf],
          [-2.9681e+00, -3.5544e+00,        -inf,        -inf],
          [-1.0330e+00, -4.8454e+00,  2.3726e+00,        -inf],
          [-2.5181e-01, -1.8449e+00,  2.9330e+00, -2.4441e+00]],

         [[ 5.6359e+00,        -inf,        -inf,        -inf],
          [ 3.3037e+00,  7.6539e-01,        -inf,        -inf],
          [-1.2225e+00, -3.2972e+00, -7.1467e+00,        -inf],
          [ 1.2639e-01,  2.9669e-01,  8.4476e-01,  1.7001e+00]],

         [[-2.3352e+00,        -inf,        -inf,        -inf],
          [ 1.1058e-01,  4.6153e+00,        -inf,        -inf],
          [-9.0546e-01, -4.5374e+00, -6.7095e+00,        -inf],
          [-3.0937e+00,  7.2674e-01, -3.0715e+00,  2.0244e+00]],

         [[-1.6058e+00,        -inf,        -inf,        -inf],
          [-4.6498e-01,  1.6322e+00,        -inf,        -inf],
          [ 1.1989e+00, -4.5480e-01, -3.2500e+00,        -inf],
          [-3.7152e+00, -1.1927e+00,  1.0272e+00,  9.5983e-01]],

         [[ 1.6963e+00,        -inf,        -inf,        -inf],
          [-1.7645e+00, -2.0709e+00,        -inf,        -inf],
          [-8.7146e-02, -2.3210e+00, -2.7562e-01,        -inf],
          [-3.5072e+00, -1.5755e+00, -9.7881e-02, -8.3123e-01]],

         [[-1.9051e+00,        -inf,        -inf,        -inf],
          [ 3.9298e+00,  4.4495e+00,        -inf,        -inf],
          [ 1.2361e+00, -1.5352e-01,  4.0726e+00,        -inf],
          [-3.3105e-01, -1.8613e+00,  4.6272e+00, -1.2979e-01]],

         [[-4.1587e-01,        -inf,        -inf,        -inf],
          [ 2.1877e+00,  4.4516e+00,        -inf,        -inf],
          [ 1.2491e+00,  5.2972e+00, -2.5041e+00,        -inf],
          [-9.9432e-01,  1.7539e+00,  7.1976e-01, -3.3805e+00]],

         [[ 1.8716e+00,        -inf,        -inf,        -inf],
          [ 8.3325e-01, -8.9324e-01,        -inf,        -inf],
          [-5.5609e+00, -1.5190e+00, -1.4167e+00,        -inf],
          [ 2.6064e+00, -1.7788e+00, -1.1990e+00,  4.4428e+00]],

         [[ 3.9673e+00,        -inf,        -inf,        -inf],
          [ 3.8655e+00,  2.2140e-01,        -inf,        -inf],
          [ 2.0367e+00, -5.5303e-01, -6.2872e-02,        -inf],
          [ 2.0264e-01, -9.6694e-01,  5.6630e-01, -7.8056e-01]],

         [[-6.6370e-01,        -inf,        -inf,        -inf],
          [-1.3386e+00, -9.1697e-01,        -inf,        -inf],
          [ 3.6578e+00, -1.7396e+00,  3.7208e+00,        -inf],
          [-4.8519e+00, -4.7477e+00, -4.0204e+00, -6.1872e+00]],

         [[ 3.7262e+00,        -inf,        -inf,        -inf],
          [-2.8211e-03,  2.9643e+00,        -inf,        -inf],
          [ 1.7504e+00,  8.1325e-01, -1.9221e+00,        -inf],
          [ 5.5647e+00, -4.3206e+00, -2.5581e+00, -6.6367e+00]],

         [[-6.2282e+00,        -inf,        -inf,        -inf],
          [-2.1587e+00,  2.9929e-01,        -inf,        -inf],
          [-6.6470e+00,  1.7867e+00,  1.0737e+00,        -inf],
          [-1.3121e+00, -1.7633e+00, -1.6459e+00,  3.3153e+00]],

         [[-3.1312e+00,        -inf,        -inf,        -inf],
          [ 1.3074e+00,  2.6821e+00,        -inf,        -inf],
          [ 4.9418e+00,  2.9710e+00,  2.6171e+00,        -inf],
          [ 1.2932e+00,  9.1851e-01,  6.2312e+00,  3.6517e-01]],

         [[ 5.6984e+00,        -inf,        -inf,        -inf],
          [ 4.6600e+00, -1.9882e+00,        -inf,        -inf],
          [ 1.4937e+00,  2.0163e+00,  3.0286e+00,        -inf],
          [ 3.8324e+00,  2.7729e+00,  6.5511e+00,  6.6226e+00]],

         [[-1.6356e-01,        -inf,        -inf,        -inf],
          [ 3.6329e+00,  3.7729e+00,        -inf,        -inf],
          [ 1.4893e+00, -2.6036e-01, -2.6436e+00,        -inf],
          [ 1.7947e+00,  3.5312e+00, -5.9731e+00, -5.6497e-02]],

         [[-1.8440e+00,        -inf,        -inf,        -inf],
          [-9.4761e-01, -1.0312e+00,        -inf,        -inf],
          [-2.4484e+00,  8.1978e-01,  2.9752e+00,        -inf],
          [-2.4659e+00,  7.8136e-01, -2.0435e+00,  3.5569e+00]],

         [[ 2.5819e+00,        -inf,        -inf,        -inf],
          [-1.4027e+00, -1.7303e+00,        -inf,        -inf],
          [ 6.1101e-01,  1.7791e-01, -1.7709e+00,        -inf],
          [-2.6148e+00, -2.4110e+00,  8.3538e-01, -5.3048e-01]],

         [[-3.6047e+00,        -inf,        -inf,        -inf],
          [-5.1555e+00, -2.8692e+00,        -inf,        -inf],
          [ 5.8128e-01, -4.8531e+00, -1.4006e-02,        -inf],
          [-4.6855e+00, -3.6599e+00,  2.3442e+00, -1.2052e+00]],

         [[ 5.6584e+00,        -inf,        -inf,        -inf],
          [ 6.3435e+00,  2.0029e+00,        -inf,        -inf],
          [ 4.8855e+00,  2.1203e+00, -2.4299e+00,        -inf],
          [ 4.7450e+00, -3.0957e-01,  4.0272e+00,  3.4418e+00]],

         [[-5.7661e+00,        -inf,        -inf,        -inf],
          [ 8.8827e-01,  8.1687e-01,        -inf,        -inf],
          [ 1.5813e+00, -4.2829e+00,  3.3147e-01,        -inf],
          [ 3.3192e+00,  7.7260e-01, -1.4478e+00,  2.2758e+00]],

         [[-1.2146e+00,        -inf,        -inf,        -inf],
          [ 1.8869e+00, -4.8936e-01,        -inf,        -inf],
          [ 3.1409e-01,  1.1147e+00,  5.3776e-01,        -inf],
          [-1.6700e+00,  1.4542e+00,  1.0337e+00,  4.6730e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.1960e+00,  5.2773e-01, -1.1002e+00,  ...,  2.4848e-01,
            6.3813e-01, -2.7845e-01],
          [-9.3386e-01,  6.2978e-01, -7.1156e-01,  ..., -3.5331e-01,
           -2.0783e-03, -7.2309e-01],
          [-2.0546e-01,  4.7935e-01,  4.6656e-01,  ..., -1.2875e-01,
           -2.0353e-02,  2.3293e-01],
          ...,
          [ 9.8634e-01, -1.3232e-02, -1.6827e-01,  ..., -1.7269e+00,
           -9.0003e-02, -4.2306e-01],
          [ 1.6602e-01, -8.9894e-01,  6.6466e-01,  ...,  3.9103e-01,
           -2.4005e-01, -2.4655e-01],
          [ 7.0493e-01,  4.3160e-01,  1.1679e+00,  ...,  5.9807e-01,
           -2.1644e-01, -4.3373e-01]],

         [[-9.1229e-01, -1.2392e-01, -5.3135e-01,  ..., -2.9201e-02,
           -4.0000e-02, -3.1198e-01],
          [-5.2215e-01,  4.5469e-01,  5.5216e-02,  ...,  2.3962e-01,
           -1.2810e-01, -6.4996e-01],
          [ 1.1077e-01,  4.1799e-01, -5.6641e-01,  ..., -4.6003e-01,
            8.9690e-01,  6.8501e-02],
          ...,
          [ 7.9667e-01, -3.4252e-01, -2.3651e-01,  ..., -4.6514e-01,
           -7.6807e-03,  3.6463e-01],
          [ 9.7766e-02, -1.3643e-01, -9.9516e-03,  ...,  7.2238e-02,
           -3.5372e-03,  2.2216e-01],
          [ 3.7904e-01, -2.6277e-01,  6.3542e-01,  ...,  3.9750e-02,
           -1.4738e-01, -3.8852e-01]],

         [[-4.6907e-01, -3.2504e-01, -1.2038e-01,  ..., -1.2359e-01,
           -2.8203e-01, -2.0984e-01],
          [ 4.1443e-01, -5.3475e-01,  1.7603e-01,  ..., -2.8126e-01,
            9.1944e-02, -2.1598e-01],
          [ 1.3577e-02,  2.8819e-01, -1.7973e-01,  ..., -2.4186e-01,
            4.2028e-01,  7.6386e-02],
          ...,
          [ 1.0617e+00, -1.6451e-01, -4.5876e-02,  ..., -4.7793e-01,
           -1.2079e-01,  1.8298e-01],
          [ 1.1158e-01, -4.0777e-01,  2.4610e-01,  ...,  1.8382e-01,
           -9.2447e-02,  1.7907e-02],
          [ 1.5917e-01, -2.7176e-01,  2.6926e-01,  ..., -7.5241e-02,
           -7.2003e-02, -2.1381e-01]],

         [[-5.4114e-01, -3.5040e-01, -2.8249e-01,  ..., -1.4064e-01,
           -2.7994e-01, -2.3557e-01],
          [ 1.2904e-01, -2.6406e-01,  1.9048e-01,  ..., -1.9521e-01,
           -6.6591e-02, -4.7026e-01],
          [-1.5067e-01,  2.3122e-01, -5.1258e-01,  ..., -1.1023e-01,
            6.9169e-01,  1.0606e-01],
          ...,
          [ 5.5303e-01, -4.6371e-02, -9.0010e-02,  ..., -4.6933e-01,
           -6.0813e-02,  1.3332e-01],
          [ 5.3646e-01, -9.8051e-02,  7.2880e-02,  ...,  2.9795e-01,
            3.6918e-01,  1.5466e-01],
          [ 3.7545e-01, -2.7852e-01, -3.1960e-01,  ...,  1.3615e-01,
           -8.5141e-01, -3.6077e-01]]],


        [[[-9.3830e-01, -5.2385e-02, -1.3545e+00,  ...,  6.4597e-01,
            8.3057e-01, -3.5550e-01],
          [-6.9084e-01,  8.7713e-01, -9.2352e-02,  ..., -7.4399e-02,
           -1.9258e-01, -4.9777e-01],
          [-1.7127e-02,  6.3260e-01,  4.2360e-01,  ..., -1.7184e-03,
            4.0652e-01,  3.1708e-01],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 3.2573e-01, -1.1209e+00,  6.4497e-01,  ...,  3.6769e-01,
            3.4232e-01, -1.6699e-01],
          [ 5.2078e-01,  4.5200e-01,  1.2681e+00,  ...,  6.1875e-01,
           -4.0340e-01, -5.6968e-01]],

         [[-4.9579e-01, -3.8801e-01, -1.0732e+00,  ...,  3.3544e-01,
            6.2636e-01, -1.6462e-01],
          [-7.2302e-01,  7.1083e-01,  6.9690e-02,  ...,  3.0232e-01,
            1.5394e-01, -1.8854e-01],
          [-2.0323e-01,  3.0687e-01,  1.1044e-01,  ...,  5.4466e-02,
            7.2504e-01,  1.6648e-01],
          ...,
          [ 5.2320e-01, -2.4183e-01, -1.5144e-01,  ..., -9.4024e-01,
            2.5621e-01, -2.7913e-01],
          [ 7.4739e-01, -8.8023e-01,  2.9585e-01,  ...,  2.5583e-01,
            2.2535e-01,  5.4539e-01],
          [ 5.8439e-01, -2.4839e-01,  6.3505e-01,  ...,  3.0599e-01,
            2.3807e-02, -4.5907e-01]],

         [[-4.5258e-01, -6.4871e-01, -6.3853e-01,  ...,  2.6505e-01,
            1.2518e-01, -3.8687e-02],
          [-3.3994e-01,  3.9396e-01,  1.4848e-01,  ...,  1.1656e-01,
           -4.7595e-02, -2.8995e-01],
          [-1.3440e-01,  1.9748e-01,  6.9302e-02,  ...,  3.6077e-02,
            4.7638e-01,  1.0737e-01],
          ...,
          [ 2.7507e-01, -1.9842e-01, -2.2190e-01,  ...,  2.0610e-02,
            9.3981e-02, -1.3410e-01],
          [ 4.5883e-01, -1.0537e+00,  7.8174e-02,  ...,  1.6546e-01,
            3.3729e-01,  6.6147e-01],
          [ 7.6345e-01, -5.0338e-01,  1.3244e-01,  ..., -3.9716e-02,
            1.7615e-01, -2.8228e-01]],

         [[-6.5799e-01, -3.8408e-01, -5.8503e-01,  ...,  2.9959e-01,
            1.4852e-01, -2.6892e-01],
          [-4.6898e-01,  2.6934e-01,  3.6796e-01,  ...,  2.7324e-01,
            1.7132e-01, -7.6949e-02],
          [-1.3393e-01,  1.4283e-01, -2.1193e-01,  ..., -3.7969e-01,
            7.6944e-01,  1.6513e-01],
          ...,
          [ 4.2839e-01, -2.7458e-01, -5.2172e-01,  ..., -4.2269e-01,
           -2.8836e-01, -6.1921e-01],
          [ 4.4154e-01, -7.6848e-01, -1.1999e-02,  ...,  1.9479e-01,
            3.7074e-01,  5.3425e-01],
          [ 5.0135e-01, -3.7444e-01,  1.8276e-02,  ..., -6.4241e-02,
            1.4479e-01, -1.6256e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.1960,  0.5277, -1.1002,  ...,  0.5981, -0.2164, -0.4337],
         [-0.9123, -0.1239, -0.5314,  ...,  0.0397, -0.1474, -0.3885],
         [-0.4691, -0.3250, -0.1204,  ..., -0.0752, -0.0720, -0.2138],
         [-0.5411, -0.3504, -0.2825,  ...,  0.1361, -0.8514, -0.3608]],

        [[-0.9383, -0.0524, -1.3545,  ...,  0.6188, -0.4034, -0.5697],
         [-0.4958, -0.3880, -1.0732,  ...,  0.3060,  0.0238, -0.4591],
         [-0.4526, -0.6487, -0.6385,  ..., -0.0397,  0.1761, -0.2823],
         [-0.6580, -0.3841, -0.5850,  ..., -0.0642,  0.1448, -0.1626]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-7.8082e-01,  9.5551e-02,  3.7961e-01,  ...,  3.8295e-01,
          -1.3107e-03, -3.8674e-02],
         [-3.1226e-01, -2.3660e-01,  3.5334e-01,  ...,  1.6255e-01,
           1.2694e-01,  1.7327e-02],
         [-2.2311e-01, -1.8386e-01,  7.9694e-02,  ...,  1.4780e-01,
           2.7643e-01, -2.3894e-02],
         [-1.5524e-01, -5.5591e-02,  2.1642e-01,  ...,  1.5908e-01,
           2.1861e-01, -1.3000e-01]],

        [[ 3.3446e-02, -2.3579e-01,  8.7065e-01,  ...,  1.0465e-01,
          -4.7131e-02, -6.5815e-04],
         [-2.8025e-01,  3.5592e-02,  8.0161e-01,  ...,  2.0798e-02,
           3.6117e-01, -2.5464e-01],
         [-2.9783e-01, -1.7668e-01,  5.8645e-01,  ..., -1.3855e-01,
           3.9745e-01, -2.4486e-01],
         [-2.6222e-01,  1.6310e-02,  4.7624e-01,  ..., -1.8201e-01,
           4.5247e-01, -1.1758e-01]]], grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 4.0614e+00,        -inf,        -inf,        -inf],
          [ 3.3579e+00,  2.8520e+00,        -inf,        -inf],
          [ 2.2747e+00, -2.5467e+00, -5.9116e-01,        -inf],
          [ 2.5494e+00,  6.8395e-01, -4.5941e-01,  9.0027e-01]],

         [[-4.4309e-01,        -inf,        -inf,        -inf],
          [ 1.2309e+00,  6.6256e+00,        -inf,        -inf],
          [ 8.6878e-01,  6.7008e+00, -6.8394e-01,        -inf],
          [-2.5871e+00,  1.1555e+00,  2.2724e+00, -4.8600e-01]],

         [[ 1.8608e+00,        -inf,        -inf,        -inf],
          [ 1.5709e+00,  6.0877e+00,        -inf,        -inf],
          [ 6.2340e-01,  6.1706e+00, -2.3547e+00,        -inf],
          [ 2.7670e+00,  1.4514e+00, -3.6806e+00, -7.9645e-01]],

         [[ 9.6264e-01,        -inf,        -inf,        -inf],
          [ 8.6640e-01, -3.7395e-01,        -inf,        -inf],
          [-2.6210e+00, -3.7122e+00, -1.5593e+00,        -inf],
          [ 2.8972e+00, -2.1963e+00,  3.5359e+00, -2.3321e+00]],

         [[ 1.0430e+00,        -inf,        -inf,        -inf],
          [ 3.1741e+00, -1.3835e+00,        -inf,        -inf],
          [ 2.7336e+00, -2.2126e+00,  1.1870e+00,        -inf],
          [-2.6014e-01, -2.8494e+00, -2.7113e+00, -1.7194e+00]],

         [[ 4.8182e+00,        -inf,        -inf,        -inf],
          [ 2.4792e+00, -4.0749e-03,        -inf,        -inf],
          [-6.9945e-01,  3.5346e+00,  6.2654e+00,        -inf],
          [ 2.6589e+00,  1.1340e+00,  2.6731e+00,  3.5060e-01]],

         [[-2.8381e+00,        -inf,        -inf,        -inf],
          [-2.4384e+00,  1.9281e-01,        -inf,        -inf],
          [-8.2900e-01, -2.5014e+00, -1.0528e+00,        -inf],
          [-1.9449e+00, -3.6199e+00, -4.9841e+00, -2.7213e+00]],

         [[ 1.3547e+00,        -inf,        -inf,        -inf],
          [-1.3967e+00, -1.6977e+00,        -inf,        -inf],
          [ 4.5216e-01, -6.8154e-01, -1.8784e-01,        -inf],
          [-4.9517e+00, -1.4900e+00,  2.0992e+00,  1.4840e+00]],

         [[-2.7934e-01,        -inf,        -inf,        -inf],
          [ 2.2953e+00,  1.4314e-01,        -inf,        -inf],
          [ 2.2235e+00,  7.8699e-01,  1.5803e+00,        -inf],
          [ 1.1830e+00, -3.5357e+00,  2.6354e+00, -1.1284e+00]],

         [[ 1.1921e+00,        -inf,        -inf,        -inf],
          [ 2.5329e+00,  4.2938e+00,        -inf,        -inf],
          [ 1.9469e+00,  5.4452e+00,  6.3108e+00,        -inf],
          [-2.4957e+00,  3.7070e+00, -9.4120e-01, -4.2579e-01]],

         [[-6.8406e-01,        -inf,        -inf,        -inf],
          [-2.5451e-03,  1.8801e+00,        -inf,        -inf],
          [ 7.4353e+00,  1.5384e+00,  3.6486e+00,        -inf],
          [ 3.4644e+00,  3.5139e+00,  2.0280e+00,  2.9689e+00]],

         [[ 9.1140e-01,        -inf,        -inf,        -inf],
          [ 2.4387e+00, -7.8711e-01,        -inf,        -inf],
          [-9.5039e-01,  7.8055e-01, -5.5640e+00,        -inf],
          [-2.7441e+00,  5.7013e-01, -3.0269e-01, -1.6256e+00]],

         [[-2.2347e+00,        -inf,        -inf,        -inf],
          [-2.2953e+00,  4.2754e+00,        -inf,        -inf],
          [-1.4288e+00,  1.2973e-01, -5.4780e+00,        -inf],
          [-4.0002e+00, -2.1362e+00, -5.8261e+00, -6.9281e-01]],

         [[-1.3134e+00,        -inf,        -inf,        -inf],
          [ 3.7089e-01,  4.7362e+00,        -inf,        -inf],
          [-1.8181e+00,  6.4748e-01,  9.3142e-01,        -inf],
          [-1.3041e+00,  4.8031e+00,  1.8546e-01, -1.5019e+00]],

         [[-1.0202e-01,        -inf,        -inf,        -inf],
          [-5.1034e-01, -2.5950e+00,        -inf,        -inf],
          [ 4.3519e-01,  1.4858e+00, -1.8930e+00,        -inf],
          [-3.1218e+00, -2.0968e+00, -2.9160e+00,  3.1158e-01]],

         [[-1.4414e+00,        -inf,        -inf,        -inf],
          [-1.4236e+00, -3.4470e+00,        -inf,        -inf],
          [ 3.5570e+00,  6.6423e-01,  3.6873e+00,        -inf],
          [ 1.2457e+00, -1.0248e+00, -1.8267e+00,  3.7566e+00]],

         [[-3.9125e+00,        -inf,        -inf,        -inf],
          [-2.9967e+00, -1.4915e-01,        -inf,        -inf],
          [-3.5347e+00,  1.3313e+00,  2.4907e+00,        -inf],
          [ 2.9608e+00,  2.8085e+00,  9.4766e-01,  2.4160e+00]],

         [[ 1.0975e+00,        -inf,        -inf,        -inf],
          [ 5.0199e+00,  4.0064e+00,        -inf,        -inf],
          [ 5.4490e-01,  2.6732e+00, -6.5573e-01,        -inf],
          [ 5.7899e-02,  2.5722e+00, -2.1573e+00, -6.4679e-01]],

         [[-7.0208e+00,        -inf,        -inf,        -inf],
          [ 2.8360e+00,  2.6971e-01,        -inf,        -inf],
          [ 1.0766e+00, -2.4772e-01, -8.0827e-01,        -inf],
          [-3.0506e+00, -3.7838e+00, -5.8557e-02,  4.9506e-01]],

         [[-6.1815e-01,        -inf,        -inf,        -inf],
          [-1.0235e+00, -5.9600e+00,        -inf,        -inf],
          [ 8.4785e-01, -3.0463e-01,  1.0267e-01,        -inf],
          [-1.3030e+00, -3.1385e+00, -2.0019e+00,  1.3714e+00]],

         [[-4.9816e-01,        -inf,        -inf,        -inf],
          [ 1.0159e+00,  8.4893e-01,        -inf,        -inf],
          [-2.8283e-02,  3.5535e+00,  2.7481e-01,        -inf],
          [ 2.3680e+00, -2.0480e+00, -2.9624e+00,  7.9804e-01]],

         [[-3.5323e+00,        -inf,        -inf,        -inf],
          [-1.7307e+00,  1.3068e+00,        -inf,        -inf],
          [ 5.7938e-01, -2.3010e-01,  2.5740e+00,        -inf],
          [ 2.9993e-01,  4.7598e-01,  4.4990e+00, -4.6541e-01]],

         [[-1.8249e-01,        -inf,        -inf,        -inf],
          [-3.6764e+00,  2.2716e+00,        -inf,        -inf],
          [-5.3437e-01, -6.3489e-01, -1.5451e+00,        -inf],
          [-2.6091e+00,  3.1010e-01,  3.2768e+00,  7.7016e-01]],

         [[ 2.1458e+00,        -inf,        -inf,        -inf],
          [ 2.2932e+00,  3.3044e+00,        -inf,        -inf],
          [-4.1603e+00,  3.2053e+00, -4.4650e+00,        -inf],
          [ 5.3080e-01,  3.0781e+00,  8.9233e-01, -1.1645e+00]],

         [[-2.0546e+00,        -inf,        -inf,        -inf],
          [-3.3319e-02, -1.8952e-01,        -inf,        -inf],
          [-2.5604e+00, -4.2297e+00,  1.5536e+00,        -inf],
          [-7.9896e-01, -1.5253e+00, -1.3225e-01, -3.0128e+00]]],


        [[[ 1.4048e+00,        -inf,        -inf,        -inf],
          [ 7.4890e+00, -1.6487e+00,        -inf,        -inf],
          [ 2.0695e+00, -2.9312e+00, -8.2195e-01,        -inf],
          [ 2.0702e+00,  3.8926e-01, -2.8663e+00,  3.4904e+00]],

         [[ 8.9105e-01,        -inf,        -inf,        -inf],
          [ 1.5782e+00,  2.9394e+00,        -inf,        -inf],
          [ 1.1385e+00,  1.8099e+00,  1.6036e+00,        -inf],
          [-4.3606e+00, -5.8374e-01, -1.2091e+00,  6.5740e-01]],

         [[ 3.0209e+00,        -inf,        -inf,        -inf],
          [-1.9491e+00,  3.9836e-01,        -inf,        -inf],
          [-4.7280e+00, -3.2806e+00, -4.3895e+00,        -inf],
          [ 3.9103e+00, -1.1795e+00, -2.2046e+00,  8.2788e-01]],

         [[ 1.4532e+00,        -inf,        -inf,        -inf],
          [ 1.7871e+00, -1.1427e+00,        -inf,        -inf],
          [-1.9852e-01, -1.1207e+00,  1.6075e+00,        -inf],
          [ 3.0767e+00, -3.9381e+00, -1.0111e+00, -1.3168e+00]],

         [[-2.4246e+00,        -inf,        -inf,        -inf],
          [-8.9006e-01, -3.4630e+00,        -inf,        -inf],
          [ 3.6652e-01, -2.2725e+00,  3.0727e-01,        -inf],
          [ 2.4612e+00,  3.9192e-01, -2.2530e+00,  1.1218e+00]],

         [[ 2.6844e+00,        -inf,        -inf,        -inf],
          [-1.0913e+00,  4.1154e+00,        -inf,        -inf],
          [ 2.6509e-01,  8.7942e-01,  6.9815e-01,        -inf],
          [ 3.5914e-01, -1.7572e+00, -9.9790e-01,  2.0938e+00]],

         [[-1.8077e+00,        -inf,        -inf,        -inf],
          [-1.4272e+00,  2.2352e+00,        -inf,        -inf],
          [ 4.5336e+00,  5.8656e+00,  2.6775e+00,        -inf],
          [-2.3894e+00, -8.0086e-01,  1.2962e+00,  1.7161e+00]],

         [[-4.7199e-01,        -inf,        -inf,        -inf],
          [-2.6114e+00,  3.7076e+00,        -inf,        -inf],
          [ 4.1892e-01,  6.4324e+00,  3.1712e+00,        -inf],
          [ 8.4321e-01, -2.1685e+00, -3.7181e+00, -8.0992e-01]],

         [[-1.6236e+00,        -inf,        -inf,        -inf],
          [ 1.3607e+00, -4.7317e+00,        -inf,        -inf],
          [ 7.0054e-01,  1.7791e+00,  7.2801e-01,        -inf],
          [ 2.1387e+00, -4.0003e+00, -2.4905e-01,  9.5890e-01]],

         [[ 4.2024e+00,        -inf,        -inf,        -inf],
          [-1.4224e+00, -5.2038e+00,        -inf,        -inf],
          [ 2.7748e+00,  3.3685e+00,  9.3426e-02,        -inf],
          [-1.0938e+00,  1.8292e+00, -5.3052e-01,  5.6089e-01]],

         [[-1.0789e+00,        -inf,        -inf,        -inf],
          [ 3.0165e+00,  1.5612e+00,        -inf,        -inf],
          [ 2.2186e+00,  3.1815e-01, -7.1451e-01,        -inf],
          [-1.7559e+00, -2.5608e-01,  3.6030e+00, -4.6030e-01]],

         [[-2.3037e+00,        -inf,        -inf,        -inf],
          [-7.6746e-01, -3.8449e+00,        -inf,        -inf],
          [ 1.8375e+00,  4.1286e+00, -1.7718e+00,        -inf],
          [-8.8423e-01, -9.8451e-01, -5.9068e+00, -9.4618e-01]],

         [[-1.4524e+00,        -inf,        -inf,        -inf],
          [ 1.5183e+00,  5.6982e+00,        -inf,        -inf],
          [ 5.5413e-02,  3.8538e+00, -9.0407e-02,        -inf],
          [-3.0692e-01, -4.0395e+00,  7.8717e+00, -6.4087e-01]],

         [[-4.5189e+00,        -inf,        -inf,        -inf],
          [-2.1152e+00,  1.2366e+00,        -inf,        -inf],
          [ 1.1367e+00, -9.4154e-01, -5.3029e-02,        -inf],
          [-5.3423e+00, -1.2003e+00,  1.2523e+00,  1.3757e+00]],

         [[-2.8756e+00,        -inf,        -inf,        -inf],
          [ 1.5204e+00,  3.6412e+00,        -inf,        -inf],
          [ 2.4421e-01, -1.5165e+00,  6.7232e-01,        -inf],
          [-4.2636e+00, -2.9925e+00, -2.9626e+00, -8.7580e-01]],

         [[-1.7335e+00,        -inf,        -inf,        -inf],
          [ 2.1414e+00, -1.2507e+00,        -inf,        -inf],
          [-5.5207e-01, -3.6320e+00, -4.0113e-01,        -inf],
          [ 4.0766e+00,  1.4183e+00,  5.2448e+00, -3.0738e+00]],

         [[-3.9746e+00,        -inf,        -inf,        -inf],
          [ 1.8302e-01,  4.6616e+00,        -inf,        -inf],
          [ 3.2854e+00,  5.3618e+00,  3.0019e+00,        -inf],
          [-1.2377e+00, -6.3660e-01, -1.3324e+00,  5.0744e-01]],

         [[ 1.2106e+00,        -inf,        -inf,        -inf],
          [ 4.6937e+00,  1.0882e+00,        -inf,        -inf],
          [ 4.9937e+00, -9.4862e-01,  1.9211e+00,        -inf],
          [ 2.8451e+00,  3.1212e+00,  2.9726e-01, -1.9242e+00]],

         [[-7.8644e+00,        -inf,        -inf,        -inf],
          [ 3.3926e+00, -2.6871e+00,        -inf,        -inf],
          [-5.8435e-01, -3.2253e+00,  1.2298e+00,        -inf],
          [-1.6794e+00, -5.8310e+00, -3.5401e-01,  1.8178e-02]],

         [[-1.9751e+00,        -inf,        -inf,        -inf],
          [-1.9617e-01, -1.3961e+00,        -inf,        -inf],
          [-1.9386e+00, -4.1100e+00,  1.6072e+00,        -inf],
          [-2.7387e+00, -9.9825e-01, -3.7313e-02,  1.9431e+00]],

         [[-1.0858e+00,        -inf,        -inf,        -inf],
          [-1.4886e+00, -4.4709e+00,        -inf,        -inf],
          [ 3.9982e-04,  2.4619e-01, -2.4664e+00,        -inf],
          [ 9.0418e-01,  4.8344e+00, -7.7533e-01,  1.4010e+00]],

         [[-2.5285e+00,        -inf,        -inf,        -inf],
          [-1.1320e+00,  6.4258e+00,        -inf,        -inf],
          [ 9.0452e-01,  3.6781e-01,  4.7429e-01,        -inf],
          [-2.7128e+00,  2.3845e+00,  2.8291e+00,  1.3845e+00]],

         [[ 1.2028e-01,        -inf,        -inf,        -inf],
          [ 7.9691e-01, -2.7675e+00,        -inf,        -inf],
          [ 1.9105e+00, -2.3979e+00,  5.7145e+00,        -inf],
          [-1.8222e+00,  1.7315e+00,  2.3331e+00,  1.1066e+00]],

         [[ 1.6687e+00,        -inf,        -inf,        -inf],
          [-1.4876e+00, -1.4793e+00,        -inf,        -inf],
          [-1.6387e+00, -1.2953e+00, -1.6234e-02,        -inf],
          [-1.3682e+00,  2.1549e+00, -4.4237e+00,  1.8690e+00]],

         [[ 2.4136e+00,        -inf,        -inf,        -inf],
          [ 1.7110e-01, -4.1099e-01,        -inf,        -inf],
          [-3.5830e+00, -8.3798e-01, -6.3709e-02,        -inf],
          [ 6.6431e-01,  1.0809e+00, -3.5312e+00, -1.5340e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 4.0614e+00,        -inf,        -inf,        -inf],
          [ 3.3579e+00,  2.8520e+00,        -inf,        -inf],
          [ 2.2747e+00, -2.5467e+00, -5.9116e-01,        -inf],
          [ 2.5494e+00,  6.8395e-01, -4.5941e-01,  9.0027e-01]],

         [[-4.4309e-01,        -inf,        -inf,        -inf],
          [ 1.2309e+00,  6.6256e+00,        -inf,        -inf],
          [ 8.6878e-01,  6.7008e+00, -6.8394e-01,        -inf],
          [-2.5871e+00,  1.1555e+00,  2.2724e+00, -4.8600e-01]],

         [[ 1.8608e+00,        -inf,        -inf,        -inf],
          [ 1.5709e+00,  6.0877e+00,        -inf,        -inf],
          [ 6.2340e-01,  6.1706e+00, -2.3547e+00,        -inf],
          [ 2.7670e+00,  1.4514e+00, -3.6806e+00, -7.9645e-01]],

         [[ 9.6264e-01,        -inf,        -inf,        -inf],
          [ 8.6640e-01, -3.7395e-01,        -inf,        -inf],
          [-2.6210e+00, -3.7122e+00, -1.5593e+00,        -inf],
          [ 2.8972e+00, -2.1963e+00,  3.5359e+00, -2.3321e+00]],

         [[ 1.0430e+00,        -inf,        -inf,        -inf],
          [ 3.1741e+00, -1.3835e+00,        -inf,        -inf],
          [ 2.7336e+00, -2.2126e+00,  1.1870e+00,        -inf],
          [-2.6014e-01, -2.8494e+00, -2.7113e+00, -1.7194e+00]],

         [[ 4.8182e+00,        -inf,        -inf,        -inf],
          [ 2.4792e+00, -4.0749e-03,        -inf,        -inf],
          [-6.9945e-01,  3.5346e+00,  6.2654e+00,        -inf],
          [ 2.6589e+00,  1.1340e+00,  2.6731e+00,  3.5060e-01]],

         [[-2.8381e+00,        -inf,        -inf,        -inf],
          [-2.4384e+00,  1.9281e-01,        -inf,        -inf],
          [-8.2900e-01, -2.5014e+00, -1.0528e+00,        -inf],
          [-1.9449e+00, -3.6199e+00, -4.9841e+00, -2.7213e+00]],

         [[ 1.3547e+00,        -inf,        -inf,        -inf],
          [-1.3967e+00, -1.6977e+00,        -inf,        -inf],
          [ 4.5216e-01, -6.8154e-01, -1.8784e-01,        -inf],
          [-4.9517e+00, -1.4900e+00,  2.0992e+00,  1.4840e+00]],

         [[-2.7934e-01,        -inf,        -inf,        -inf],
          [ 2.2953e+00,  1.4314e-01,        -inf,        -inf],
          [ 2.2235e+00,  7.8699e-01,  1.5803e+00,        -inf],
          [ 1.1830e+00, -3.5357e+00,  2.6354e+00, -1.1284e+00]],

         [[ 1.1921e+00,        -inf,        -inf,        -inf],
          [ 2.5329e+00,  4.2938e+00,        -inf,        -inf],
          [ 1.9469e+00,  5.4452e+00,  6.3108e+00,        -inf],
          [-2.4957e+00,  3.7070e+00, -9.4120e-01, -4.2579e-01]],

         [[-6.8406e-01,        -inf,        -inf,        -inf],
          [-2.5451e-03,  1.8801e+00,        -inf,        -inf],
          [ 7.4353e+00,  1.5384e+00,  3.6486e+00,        -inf],
          [ 3.4644e+00,  3.5139e+00,  2.0280e+00,  2.9689e+00]],

         [[ 9.1140e-01,        -inf,        -inf,        -inf],
          [ 2.4387e+00, -7.8711e-01,        -inf,        -inf],
          [-9.5039e-01,  7.8055e-01, -5.5640e+00,        -inf],
          [-2.7441e+00,  5.7013e-01, -3.0269e-01, -1.6256e+00]],

         [[-2.2347e+00,        -inf,        -inf,        -inf],
          [-2.2953e+00,  4.2754e+00,        -inf,        -inf],
          [-1.4288e+00,  1.2973e-01, -5.4780e+00,        -inf],
          [-4.0002e+00, -2.1362e+00, -5.8261e+00, -6.9281e-01]],

         [[-1.3134e+00,        -inf,        -inf,        -inf],
          [ 3.7089e-01,  4.7362e+00,        -inf,        -inf],
          [-1.8181e+00,  6.4748e-01,  9.3142e-01,        -inf],
          [-1.3041e+00,  4.8031e+00,  1.8546e-01, -1.5019e+00]],

         [[-1.0202e-01,        -inf,        -inf,        -inf],
          [-5.1034e-01, -2.5950e+00,        -inf,        -inf],
          [ 4.3519e-01,  1.4858e+00, -1.8930e+00,        -inf],
          [-3.1218e+00, -2.0968e+00, -2.9160e+00,  3.1158e-01]],

         [[-1.4414e+00,        -inf,        -inf,        -inf],
          [-1.4236e+00, -3.4470e+00,        -inf,        -inf],
          [ 3.5570e+00,  6.6423e-01,  3.6873e+00,        -inf],
          [ 1.2457e+00, -1.0248e+00, -1.8267e+00,  3.7566e+00]],

         [[-3.9125e+00,        -inf,        -inf,        -inf],
          [-2.9967e+00, -1.4915e-01,        -inf,        -inf],
          [-3.5347e+00,  1.3313e+00,  2.4907e+00,        -inf],
          [ 2.9608e+00,  2.8085e+00,  9.4766e-01,  2.4160e+00]],

         [[ 1.0975e+00,        -inf,        -inf,        -inf],
          [ 5.0199e+00,  4.0064e+00,        -inf,        -inf],
          [ 5.4490e-01,  2.6732e+00, -6.5573e-01,        -inf],
          [ 5.7899e-02,  2.5722e+00, -2.1573e+00, -6.4679e-01]],

         [[-7.0208e+00,        -inf,        -inf,        -inf],
          [ 2.8360e+00,  2.6971e-01,        -inf,        -inf],
          [ 1.0766e+00, -2.4772e-01, -8.0827e-01,        -inf],
          [-3.0506e+00, -3.7838e+00, -5.8557e-02,  4.9506e-01]],

         [[-6.1815e-01,        -inf,        -inf,        -inf],
          [-1.0235e+00, -5.9600e+00,        -inf,        -inf],
          [ 8.4785e-01, -3.0463e-01,  1.0267e-01,        -inf],
          [-1.3030e+00, -3.1385e+00, -2.0019e+00,  1.3714e+00]],

         [[-4.9816e-01,        -inf,        -inf,        -inf],
          [ 1.0159e+00,  8.4893e-01,        -inf,        -inf],
          [-2.8283e-02,  3.5535e+00,  2.7481e-01,        -inf],
          [ 2.3680e+00, -2.0480e+00, -2.9624e+00,  7.9804e-01]],

         [[-3.5323e+00,        -inf,        -inf,        -inf],
          [-1.7307e+00,  1.3068e+00,        -inf,        -inf],
          [ 5.7938e-01, -2.3010e-01,  2.5740e+00,        -inf],
          [ 2.9993e-01,  4.7598e-01,  4.4990e+00, -4.6541e-01]],

         [[-1.8249e-01,        -inf,        -inf,        -inf],
          [-3.6764e+00,  2.2716e+00,        -inf,        -inf],
          [-5.3437e-01, -6.3489e-01, -1.5451e+00,        -inf],
          [-2.6091e+00,  3.1010e-01,  3.2768e+00,  7.7016e-01]],

         [[ 2.1458e+00,        -inf,        -inf,        -inf],
          [ 2.2932e+00,  3.3044e+00,        -inf,        -inf],
          [-4.1603e+00,  3.2053e+00, -4.4650e+00,        -inf],
          [ 5.3080e-01,  3.0781e+00,  8.9233e-01, -1.1645e+00]],

         [[-2.0546e+00,        -inf,        -inf,        -inf],
          [-3.3319e-02, -1.8952e-01,        -inf,        -inf],
          [-2.5604e+00, -4.2297e+00,  1.5536e+00,        -inf],
          [-7.9896e-01, -1.5253e+00, -1.3225e-01, -3.0128e+00]]],


        [[[ 1.4048e+00,        -inf,        -inf,        -inf],
          [ 7.4890e+00, -1.6487e+00,        -inf,        -inf],
          [ 2.0695e+00, -2.9312e+00, -8.2195e-01,        -inf],
          [ 2.0702e+00,  3.8926e-01, -2.8663e+00,  3.4904e+00]],

         [[ 8.9105e-01,        -inf,        -inf,        -inf],
          [ 1.5782e+00,  2.9394e+00,        -inf,        -inf],
          [ 1.1385e+00,  1.8099e+00,  1.6036e+00,        -inf],
          [-4.3606e+00, -5.8374e-01, -1.2091e+00,  6.5740e-01]],

         [[ 3.0209e+00,        -inf,        -inf,        -inf],
          [-1.9491e+00,  3.9836e-01,        -inf,        -inf],
          [-4.7280e+00, -3.2806e+00, -4.3895e+00,        -inf],
          [ 3.9103e+00, -1.1795e+00, -2.2046e+00,  8.2788e-01]],

         [[ 1.4532e+00,        -inf,        -inf,        -inf],
          [ 1.7871e+00, -1.1427e+00,        -inf,        -inf],
          [-1.9852e-01, -1.1207e+00,  1.6075e+00,        -inf],
          [ 3.0767e+00, -3.9381e+00, -1.0111e+00, -1.3168e+00]],

         [[-2.4246e+00,        -inf,        -inf,        -inf],
          [-8.9006e-01, -3.4630e+00,        -inf,        -inf],
          [ 3.6652e-01, -2.2725e+00,  3.0727e-01,        -inf],
          [ 2.4612e+00,  3.9192e-01, -2.2530e+00,  1.1218e+00]],

         [[ 2.6844e+00,        -inf,        -inf,        -inf],
          [-1.0913e+00,  4.1154e+00,        -inf,        -inf],
          [ 2.6509e-01,  8.7942e-01,  6.9815e-01,        -inf],
          [ 3.5914e-01, -1.7572e+00, -9.9790e-01,  2.0938e+00]],

         [[-1.8077e+00,        -inf,        -inf,        -inf],
          [-1.4272e+00,  2.2352e+00,        -inf,        -inf],
          [ 4.5336e+00,  5.8656e+00,  2.6775e+00,        -inf],
          [-2.3894e+00, -8.0086e-01,  1.2962e+00,  1.7161e+00]],

         [[-4.7199e-01,        -inf,        -inf,        -inf],
          [-2.6114e+00,  3.7076e+00,        -inf,        -inf],
          [ 4.1892e-01,  6.4324e+00,  3.1712e+00,        -inf],
          [ 8.4321e-01, -2.1685e+00, -3.7181e+00, -8.0992e-01]],

         [[-1.6236e+00,        -inf,        -inf,        -inf],
          [ 1.3607e+00, -4.7317e+00,        -inf,        -inf],
          [ 7.0054e-01,  1.7791e+00,  7.2801e-01,        -inf],
          [ 2.1387e+00, -4.0003e+00, -2.4905e-01,  9.5890e-01]],

         [[ 4.2024e+00,        -inf,        -inf,        -inf],
          [-1.4224e+00, -5.2038e+00,        -inf,        -inf],
          [ 2.7748e+00,  3.3685e+00,  9.3426e-02,        -inf],
          [-1.0938e+00,  1.8292e+00, -5.3052e-01,  5.6089e-01]],

         [[-1.0789e+00,        -inf,        -inf,        -inf],
          [ 3.0165e+00,  1.5612e+00,        -inf,        -inf],
          [ 2.2186e+00,  3.1815e-01, -7.1451e-01,        -inf],
          [-1.7559e+00, -2.5608e-01,  3.6030e+00, -4.6030e-01]],

         [[-2.3037e+00,        -inf,        -inf,        -inf],
          [-7.6746e-01, -3.8449e+00,        -inf,        -inf],
          [ 1.8375e+00,  4.1286e+00, -1.7718e+00,        -inf],
          [-8.8423e-01, -9.8451e-01, -5.9068e+00, -9.4618e-01]],

         [[-1.4524e+00,        -inf,        -inf,        -inf],
          [ 1.5183e+00,  5.6982e+00,        -inf,        -inf],
          [ 5.5413e-02,  3.8538e+00, -9.0407e-02,        -inf],
          [-3.0692e-01, -4.0395e+00,  7.8717e+00, -6.4087e-01]],

         [[-4.5189e+00,        -inf,        -inf,        -inf],
          [-2.1152e+00,  1.2366e+00,        -inf,        -inf],
          [ 1.1367e+00, -9.4154e-01, -5.3029e-02,        -inf],
          [-5.3423e+00, -1.2003e+00,  1.2523e+00,  1.3757e+00]],

         [[-2.8756e+00,        -inf,        -inf,        -inf],
          [ 1.5204e+00,  3.6412e+00,        -inf,        -inf],
          [ 2.4421e-01, -1.5165e+00,  6.7232e-01,        -inf],
          [-4.2636e+00, -2.9925e+00, -2.9626e+00, -8.7580e-01]],

         [[-1.7335e+00,        -inf,        -inf,        -inf],
          [ 2.1414e+00, -1.2507e+00,        -inf,        -inf],
          [-5.5207e-01, -3.6320e+00, -4.0113e-01,        -inf],
          [ 4.0766e+00,  1.4183e+00,  5.2448e+00, -3.0738e+00]],

         [[-3.9746e+00,        -inf,        -inf,        -inf],
          [ 1.8302e-01,  4.6616e+00,        -inf,        -inf],
          [ 3.2854e+00,  5.3618e+00,  3.0019e+00,        -inf],
          [-1.2377e+00, -6.3660e-01, -1.3324e+00,  5.0744e-01]],

         [[ 1.2106e+00,        -inf,        -inf,        -inf],
          [ 4.6937e+00,  1.0882e+00,        -inf,        -inf],
          [ 4.9937e+00, -9.4862e-01,  1.9211e+00,        -inf],
          [ 2.8451e+00,  3.1212e+00,  2.9726e-01, -1.9242e+00]],

         [[-7.8644e+00,        -inf,        -inf,        -inf],
          [ 3.3926e+00, -2.6871e+00,        -inf,        -inf],
          [-5.8435e-01, -3.2253e+00,  1.2298e+00,        -inf],
          [-1.6794e+00, -5.8310e+00, -3.5401e-01,  1.8178e-02]],

         [[-1.9751e+00,        -inf,        -inf,        -inf],
          [-1.9617e-01, -1.3961e+00,        -inf,        -inf],
          [-1.9386e+00, -4.1100e+00,  1.6072e+00,        -inf],
          [-2.7387e+00, -9.9825e-01, -3.7313e-02,  1.9431e+00]],

         [[-1.0858e+00,        -inf,        -inf,        -inf],
          [-1.4886e+00, -4.4709e+00,        -inf,        -inf],
          [ 3.9982e-04,  2.4619e-01, -2.4664e+00,        -inf],
          [ 9.0418e-01,  4.8344e+00, -7.7533e-01,  1.4010e+00]],

         [[-2.5285e+00,        -inf,        -inf,        -inf],
          [-1.1320e+00,  6.4258e+00,        -inf,        -inf],
          [ 9.0452e-01,  3.6781e-01,  4.7429e-01,        -inf],
          [-2.7128e+00,  2.3845e+00,  2.8291e+00,  1.3845e+00]],

         [[ 1.2028e-01,        -inf,        -inf,        -inf],
          [ 7.9691e-01, -2.7675e+00,        -inf,        -inf],
          [ 1.9105e+00, -2.3979e+00,  5.7145e+00,        -inf],
          [-1.8222e+00,  1.7315e+00,  2.3331e+00,  1.1066e+00]],

         [[ 1.6687e+00,        -inf,        -inf,        -inf],
          [-1.4876e+00, -1.4793e+00,        -inf,        -inf],
          [-1.6387e+00, -1.2953e+00, -1.6234e-02,        -inf],
          [-1.3682e+00,  2.1549e+00, -4.4237e+00,  1.8690e+00]],

         [[ 2.4136e+00,        -inf,        -inf,        -inf],
          [ 1.7110e-01, -4.1099e-01,        -inf,        -inf],
          [-3.5830e+00, -8.3798e-01, -6.3709e-02,        -inf],
          [ 6.6431e-01,  1.0809e+00, -3.5312e+00, -1.5340e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.5610e-01,  1.2288e+00, -2.2811e-02,  ...,  5.2668e-01,
            5.7396e-02,  2.4681e-01],
          [-5.6883e-01, -4.5562e-01, -5.3269e-02,  ..., -2.0609e-01,
           -1.0882e+00,  1.8043e-01],
          ...,
          [-6.3546e-02,  1.0583e-01, -9.7148e-01,  ...,  5.8468e-01,
           -6.8601e-02,  4.4943e-01],
          [ 1.0617e-01,  6.6977e-01,  2.3108e-01,  ...,  1.1029e+00,
            1.1620e+00,  2.9240e-01],
          [ 2.8902e-01, -6.3762e-01, -6.8079e-01,  ..., -1.1050e+00,
           -1.4795e+00, -1.3085e+00]],

         [[ 8.5119e-01, -4.3108e-01,  1.5982e-01,  ...,  6.9039e-01,
           -2.1669e-01,  4.1871e-01],
          [-4.5553e-01,  9.1235e-01,  1.7698e-01,  ...,  3.7269e-01,
           -1.9732e-01,  7.5684e-01],
          [-3.8517e-01, -2.3562e-01, -5.1709e-01,  ..., -8.8278e-01,
           -2.3010e-01,  4.3527e-01],
          ...,
          [-1.3563e-01,  2.3461e-01, -1.5658e-01,  ...,  4.3407e-02,
            5.1588e-01,  4.0642e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 5.7691e-01, -4.7681e-01, -1.0331e+00,  ..., -6.0846e-01,
           -1.1542e+00, -9.6234e-01]],

         [[ 1.0914e+00, -3.0585e-01, -3.0303e-01,  ...,  6.1064e-01,
           -3.3722e-01,  2.7357e-01],
          [-6.3814e-02,  5.2010e-01,  1.2179e-01,  ...,  1.5776e-01,
            9.8479e-02,  1.3892e-01],
          [-1.8487e-01,  3.3014e-02, -6.5543e-02,  ..., -1.2377e-01,
           -3.2014e-01,  2.5659e-01],
          ...,
          [-2.3126e-02,  4.1150e-01, -6.2600e-01,  ...,  1.1678e-01,
            1.5437e-01,  1.4404e-01],
          [-3.2373e-01,  1.9665e-01,  2.3323e-01,  ...,  3.0015e-01,
            2.7634e-01,  1.0007e-01],
          [ 2.2654e-01,  6.1408e-01, -4.4397e-01,  ..., -1.4962e-01,
           -7.2457e-01, -2.0048e-01]],

         [[ 6.8988e-01, -3.3763e-01, -4.9040e-04,  ...,  5.9865e-01,
           -2.3514e-01,  1.2578e-01],
          [-3.7445e-01,  5.5808e-01,  2.6542e-01,  ...,  1.5024e-01,
           -1.0085e-01,  4.2084e-01],
          [-2.9991e-01, -5.9663e-02, -2.8543e-01,  ..., -4.9184e-01,
           -3.1673e-01,  3.9831e-01],
          ...,
          [ 2.6273e-01,  2.6423e-01, -5.3275e-01,  ...,  2.6255e-01,
           -2.0680e-02,  2.2107e-01],
          [-1.1904e-02,  4.1906e-01,  3.1276e-01,  ...,  2.3218e-01,
            3.9977e-02,  3.8974e-01],
          [ 3.1426e-01,  3.6432e-01, -5.7017e-01,  ..., -3.2638e-01,
           -9.9016e-01, -7.3460e-01]]],


        [[[ 6.5728e-01, -1.3273e+00, -5.5708e-01,  ...,  8.1990e-01,
           -3.7046e-01,  4.3168e-01],
          [-5.2975e-01,  1.1937e+00, -4.7776e-01,  ...,  1.1141e+00,
            1.9083e-01,  7.9271e-01],
          [-2.4180e-01, -6.8566e-01, -1.2636e-01,  ...,  1.8722e-01,
           -1.0473e+00,  2.4489e-01],
          ...,
          [ 4.3283e-01,  4.8414e-02, -5.7250e-01,  ..., -7.6936e-02,
           -2.7271e-01,  8.2594e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 5.4274e-01, -3.9792e-01, -7.3737e-01,  ..., -6.0986e-01,
           -1.3446e+00, -1.2807e+00]],

         [[ 5.5621e-01, -1.2104e+00, -2.2985e-01,  ...,  8.1443e-01,
           -3.6121e-01,  2.9241e-01],
          [ 1.5783e-01,  1.2658e+00, -1.5361e-01,  ...,  2.1895e-01,
            1.5904e-01,  5.8458e-01],
          [-1.0329e-01, -2.9289e-01, -5.3977e-02,  ...,  7.9975e-02,
           -4.4736e-01,  1.0461e-01],
          ...,
          [ 5.4921e-02, -9.8795e-02, -1.7784e-01,  ...,  7.0964e-02,
            9.3970e-02,  1.0624e-01],
          [-5.4923e-03,  4.1051e-01, -2.0249e-01,  ..., -9.1203e-02,
            5.6313e-01,  4.4994e-01],
          [ 1.0880e+00, -2.7028e-01, -7.3263e-01,  ..., -3.6377e-01,
           -1.3341e+00, -1.1081e+00]],

         [[ 4.9683e-01, -9.1663e-01, -1.5277e-01,  ...,  6.6029e-01,
           -2.0489e-01,  1.7328e-01],
          [-2.8775e-01,  1.1447e+00,  7.9438e-02,  ...,  2.1671e-02,
            3.8892e-01,  5.7418e-01],
          [-1.4691e-01, -3.1024e-01, -2.3917e-01,  ..., -2.4780e-01,
           -2.7088e-01,  1.2300e+00],
          ...,
          [-2.2573e-01,  8.2175e-04, -6.7909e-01,  ..., -1.7500e-01,
           -5.0423e-01, -3.4541e-02],
          [-4.0368e-01,  3.6799e-01, -2.3225e-01,  ..., -4.2028e-01,
            4.6883e-01,  3.1937e-01],
          [ 1.2764e+00,  4.2412e-01, -2.2529e-01,  ..., -4.9773e-01,
           -8.2125e-01, -1.0833e+00]],

         [[ 7.0481e-02, -1.2624e+00,  4.4356e-02,  ...,  5.0560e-01,
            7.2780e-02,  1.7154e-01],
          [-1.8296e-01,  3.3396e-01, -2.8584e-02,  ...,  1.4250e-01,
            8.0072e-02,  1.6118e-01],
          [-2.0623e-01, -2.7917e-01, -1.8226e-01,  ..., -1.1661e-01,
           -3.7654e-01,  8.4351e-01],
          ...,
          [-5.7644e-02, -3.0057e-01, -5.0062e-01,  ..., -1.0636e-01,
           -1.2960e-01,  3.3886e-02],
          [-2.0784e-01,  4.6900e-01, -2.8162e-01,  ..., -1.8497e-01,
            3.7496e-01,  3.8146e-01],
          [ 1.2159e+00,  2.6919e-02, -3.3462e-01,  ..., -9.4588e-02,
           -1.0817e+00, -1.0343e+00]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ..., -1.1050e+00,
          -1.4795e+00, -1.3085e+00],
         [ 8.5119e-01, -4.3108e-01,  1.5982e-01,  ..., -6.0846e-01,
          -1.1542e+00, -9.6234e-01],
         [ 1.0914e+00, -3.0585e-01, -3.0303e-01,  ..., -1.4962e-01,
          -7.2457e-01, -2.0048e-01],
         [ 6.8988e-01, -3.3763e-01, -4.9040e-04,  ..., -3.2638e-01,
          -9.9016e-01, -7.3460e-01]],

        [[ 6.5728e-01, -1.3273e+00, -5.5708e-01,  ..., -6.0986e-01,
          -1.3446e+00, -1.2807e+00],
         [ 5.5621e-01, -1.2104e+00, -2.2985e-01,  ..., -3.6377e-01,
          -1.3341e+00, -1.1081e+00],
         [ 4.9683e-01, -9.1663e-01, -1.5277e-01,  ..., -4.9773e-01,
          -8.2125e-01, -1.0833e+00],
         [ 7.0481e-02, -1.2624e+00,  4.4356e-02,  ..., -9.4588e-02,
          -1.0817e+00, -1.0343e+00]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.1729,  0.9151,  0.2850,  ..., -0.0890, -0.3581, -0.3984],
         [-0.1931,  0.4127,  0.4163,  ..., -0.1038, -0.4921, -0.4787],
         [-0.4158,  0.1567,  0.3879,  ..., -0.1099, -0.2744, -0.1762],
         [-0.2694,  0.2826,  0.4090,  ...,  0.0097, -0.2781, -0.2152]],

        [[ 0.0989,  0.5171,  0.5339,  ...,  0.4043, -0.6026, -0.5808],
         [-0.0773,  0.3443,  0.6134,  ...,  0.3072, -0.7252, -0.5117],
         [-0.2178,  0.2843,  0.3942,  ...,  0.2058, -0.5673, -0.3920],
         [-0.1227,  0.4020,  0.3580,  ...,  0.0324, -0.6501, -0.4443]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.5618,    -inf,    -inf,    -inf],
          [ 1.3627, -1.7046,    -inf,    -inf],
          [-2.2005,  1.9439, -3.9732,    -inf],
          [ 0.7552, -3.2308,  1.6380, -1.0905]],

         [[-2.1327,    -inf,    -inf,    -inf],
          [-0.7219, -1.3965,    -inf,    -inf],
          [-1.2190, -0.0785,  2.9831,    -inf],
          [ 0.7378, -3.5208, -3.4806,  0.8480]],

         [[-0.7221,    -inf,    -inf,    -inf],
          [-2.4924, -1.0036,    -inf,    -inf],
          [-1.5064, -3.4141, -0.5230,    -inf],
          [-2.1242, -3.9608, -0.9557,  0.3485]],

         [[-0.5448,    -inf,    -inf,    -inf],
          [-0.2086, -5.6839,    -inf,    -inf],
          [-2.3270, -0.2844,  1.2610,    -inf],
          [ 0.6778, -4.6013, -4.2507,  3.0219]],

         [[-0.6808,    -inf,    -inf,    -inf],
          [-5.8051,  1.1198,    -inf,    -inf],
          [ 0.2672, -2.9884,  2.8583,    -inf],
          [ 6.4521, -3.1288, -1.0510,  0.3013]],

         [[ 0.4036,    -inf,    -inf,    -inf],
          [-2.1667,  0.7328,    -inf,    -inf],
          [ 0.7962, -2.5033,  0.0678,    -inf],
          [-1.7443,  1.3487, -0.0307, -1.5757]],

         [[ 1.9862,    -inf,    -inf,    -inf],
          [-0.2895, -5.7642,    -inf,    -inf],
          [ 3.6415,  1.6188,  6.5836,    -inf],
          [ 0.4084,  2.3581,  1.5853, -0.9709]],

         [[-2.4110,    -inf,    -inf,    -inf],
          [-3.0846, -3.0594,    -inf,    -inf],
          [-2.2028, -1.1158,  2.9931,    -inf],
          [-2.5427, -0.0874,  0.3143, -0.9610]],

         [[ 0.7847,    -inf,    -inf,    -inf],
          [ 3.5980,  1.1007,    -inf,    -inf],
          [-1.9964, -3.8584, -2.3021,    -inf],
          [ 0.3238,  1.0538,  2.9230,  0.3436]],

         [[ 0.2568,    -inf,    -inf,    -inf],
          [ 0.2078, -2.1235,    -inf,    -inf],
          [-0.9273,  2.8208, -2.5541,    -inf],
          [ 4.7493,  4.8283,  1.2366, -2.0866]],

         [[-2.2220,    -inf,    -inf,    -inf],
          [ 4.0600,  0.0683,    -inf,    -inf],
          [-0.6827, -0.1251,  4.0050,    -inf],
          [ 0.1190, -3.0031,  5.4527, -1.1711]],

         [[-1.5687,    -inf,    -inf,    -inf],
          [ 1.3631, -0.5049,    -inf,    -inf],
          [-0.5970, -2.4450, -1.5779,    -inf],
          [ 0.7439, -3.3181,  4.2999, -0.9085]],

         [[-2.3344,    -inf,    -inf,    -inf],
          [-0.1094, -0.6980,    -inf,    -inf],
          [-0.8454,  0.3761,  2.3850,    -inf],
          [-2.6076, -3.2609,  0.7595,  4.1231]],

         [[-3.4729,    -inf,    -inf,    -inf],
          [-0.9269, -3.2782,    -inf,    -inf],
          [-1.4478, -0.1365,  2.3467,    -inf],
          [-4.4532,  1.5027,  2.5487, -1.1693]],

         [[-4.5005,    -inf,    -inf,    -inf],
          [-0.7965, -3.3023,    -inf,    -inf],
          [ 1.2249, -1.0283,  0.6911,    -inf],
          [-0.4385, -1.7453,  1.0539, -0.3459]],

         [[-1.1415,    -inf,    -inf,    -inf],
          [-1.0639, -4.0220,    -inf,    -inf],
          [-4.3987, -2.6469, -5.6741,    -inf],
          [ 2.6485, -1.4150, -0.3751, -0.6839]],

         [[ 2.7997,    -inf,    -inf,    -inf],
          [ 2.9407, -1.1355,    -inf,    -inf],
          [ 7.6732,  2.6225,  3.9720,    -inf],
          [ 6.2411, -1.2326,  3.8689,  1.6544]],

         [[-3.2543,    -inf,    -inf,    -inf],
          [ 2.0277, -1.1340,    -inf,    -inf],
          [ 1.4040, -2.8419,  1.3079,    -inf],
          [ 3.6242,  1.0008,  0.0348,  1.4801]],

         [[ 0.2410,    -inf,    -inf,    -inf],
          [ 2.2572,  3.9607,    -inf,    -inf],
          [ 0.5037, -1.5090,  0.8575,    -inf],
          [-1.5387,  0.6281, -1.2513,  1.5505]],

         [[-3.2425,    -inf,    -inf,    -inf],
          [-2.3799,  0.3570,    -inf,    -inf],
          [ 0.3185, -1.5321,  2.7660,    -inf],
          [-5.6518, -4.8234, -5.3264,  0.6040]],

         [[-0.2053,    -inf,    -inf,    -inf],
          [ 2.8075, -1.2097,    -inf,    -inf],
          [-0.6525,  3.1020,  3.8769,    -inf],
          [-3.6290, -5.0465, -0.4636, -2.6467]],

         [[ 0.7284,    -inf,    -inf,    -inf],
          [-0.1788,  3.7452,    -inf,    -inf],
          [ 2.7337,  2.3775,  1.3943,    -inf],
          [-2.4306,  0.1448,  4.6209,  1.2696]],

         [[ 2.7879,    -inf,    -inf,    -inf],
          [ 0.5442, -3.1983,    -inf,    -inf],
          [ 0.9618, -0.8165,  1.9178,    -inf],
          [ 4.7787, -2.6467,  2.5467,  0.9613]],

         [[ 0.8221,    -inf,    -inf,    -inf],
          [-3.0062,  0.0399,    -inf,    -inf],
          [ 3.1348,  1.9057,  0.8822,    -inf],
          [-0.4425, -1.3991, -2.5316,  0.3568]],

         [[ 4.3262,    -inf,    -inf,    -inf],
          [ 2.9134, -0.6334,    -inf,    -inf],
          [ 4.5012,  2.5162,  0.4832,    -inf],
          [ 4.1504,  2.6070,  4.1413,  0.8409]]],


        [[[ 0.5077,    -inf,    -inf,    -inf],
          [ 0.8240, -4.0131,    -inf,    -inf],
          [-2.6198, -0.0571, -0.1388,    -inf],
          [-3.0502, -2.6237,  3.6448,  0.8048]],

         [[ 1.9096,    -inf,    -inf,    -inf],
          [-5.2016, -1.9068,    -inf,    -inf],
          [-1.5470,  1.5739,  3.2059,    -inf],
          [ 3.0860, -1.2529,  1.6003,  1.0353]],

         [[-1.4638,    -inf,    -inf,    -inf],
          [-2.5386, -1.3353,    -inf,    -inf],
          [-1.6379,  2.0643,  0.8254,    -inf],
          [ 1.8856, -3.0302,  2.7813, -0.5440]],

         [[-2.5223,    -inf,    -inf,    -inf],
          [ 0.4533,  1.0119,    -inf,    -inf],
          [ 2.7125,  2.9739,  1.1673,    -inf],
          [ 0.9877,  4.4191,  2.2163, -3.3381]],

         [[ 0.3204,    -inf,    -inf,    -inf],
          [-0.2779,  1.7470,    -inf,    -inf],
          [ 1.0091,  1.4507,  0.4893,    -inf],
          [ 0.4146,  0.6522, -1.0886, -0.9143]],

         [[-0.3876,    -inf,    -inf,    -inf],
          [-2.7378,  3.5800,    -inf,    -inf],
          [ 0.8423,  3.3239,  3.8971,    -inf],
          [ 0.7360, -1.4659, -0.6768,  0.9431]],

         [[ 1.3245,    -inf,    -inf,    -inf],
          [-1.9381, -3.9636,    -inf,    -inf],
          [-1.8774,  0.8068, -4.8731,    -inf],
          [-2.1526,  2.1041, -3.9788,  1.9225]],

         [[-0.1799,    -inf,    -inf,    -inf],
          [-1.6356, -0.5593,    -inf,    -inf],
          [-1.3366, -2.4376,  1.1301,    -inf],
          [ 3.8826, -0.9860,  2.4544, -3.4064]],

         [[-0.4634,    -inf,    -inf,    -inf],
          [ 3.2843, -2.3601,    -inf,    -inf],
          [-0.0756, -3.1393, -1.1082,    -inf],
          [ 1.3649, -3.9985,  3.2482,  7.0965]],

         [[ 1.7787,    -inf,    -inf,    -inf],
          [ 0.7828, -0.9574,    -inf,    -inf],
          [-0.3033,  2.3398, -0.9917,    -inf],
          [ 6.5522,  5.7076,  4.0767,  3.6516]],

         [[-0.0301,    -inf,    -inf,    -inf],
          [ 1.1108, -4.9521,    -inf,    -inf],
          [ 4.6981, -0.6657,  3.8286,    -inf],
          [-4.1740, -6.0776,  2.4619,  2.1497]],

         [[-2.2054,    -inf,    -inf,    -inf],
          [ 1.4702,  1.6262,    -inf,    -inf],
          [-1.6034,  0.3151,  4.1913,    -inf],
          [-3.8944,  0.6621, -2.5681, -1.6692]],

         [[-3.4664,    -inf,    -inf,    -inf],
          [-2.5595,  3.5717,    -inf,    -inf],
          [-0.8615,  0.3646,  4.5488,    -inf],
          [-0.9394, -0.8431, -1.4414,  1.6889]],

         [[-1.5548,    -inf,    -inf,    -inf],
          [-0.5127, -1.1044,    -inf,    -inf],
          [ 3.0975,  3.2770,  1.1050,    -inf],
          [-1.9775, -1.1658,  1.1326,  2.4810]],

         [[-3.2982,    -inf,    -inf,    -inf],
          [-0.9446, -2.4994,    -inf,    -inf],
          [ 0.8374,  3.8972,  4.2268,    -inf],
          [-0.4337,  0.5854,  1.7244,  1.7963]],

         [[ 0.8792,    -inf,    -inf,    -inf],
          [ 1.5708,  2.7362,    -inf,    -inf],
          [-2.9625,  4.3308, -2.8622,    -inf],
          [ 2.8694,  0.8078, -4.7524, -0.3427]],

         [[-0.9886,    -inf,    -inf,    -inf],
          [ 4.3139,  1.2068,    -inf,    -inf],
          [ 2.6597, -5.9761, -4.4671,    -inf],
          [ 8.6206,  2.5406,  3.1764,  2.3635]],

         [[-3.4935,    -inf,    -inf,    -inf],
          [ 0.1599, -2.4748,    -inf,    -inf],
          [ 3.0238, -0.0922,  0.1366,    -inf],
          [ 1.1570,  1.5110, -0.3921,  6.2076]],

         [[ 7.1821,    -inf,    -inf,    -inf],
          [ 1.8311,  4.6377,    -inf,    -inf],
          [-0.7712,  3.0259,  0.5157,    -inf],
          [-1.8771,  1.9906, -2.1111,  0.2827]],

         [[-3.7322,    -inf,    -inf,    -inf],
          [-3.1603,  2.6425,    -inf,    -inf],
          [-2.5532, -0.4466, -3.2467,    -inf],
          [-2.7208, -4.4715,  0.5187, -0.3274]],

         [[-2.7598,    -inf,    -inf,    -inf],
          [ 2.9718,  0.4431,    -inf,    -inf],
          [ 5.4211,  3.4159,  1.2937,    -inf],
          [-4.6467, -6.3684, -0.0133, -2.6514]],

         [[ 1.8225,    -inf,    -inf,    -inf],
          [ 3.8919,  3.8555,    -inf,    -inf],
          [-1.9703, -4.8796, -2.1753,    -inf],
          [-1.2534,  2.9972,  3.1459,  0.7239]],

         [[ 1.3584,    -inf,    -inf,    -inf],
          [ 3.5887,  1.0144,    -inf,    -inf],
          [-1.0975, -5.9372, -3.9194,    -inf],
          [-1.7788,  0.6426,  2.8740,  2.8006]],

         [[ 1.0804,    -inf,    -inf,    -inf],
          [-0.9057,  0.6297,    -inf,    -inf],
          [-1.2865, -1.0690, -1.9707,    -inf],
          [-1.4013,  0.4026,  2.8874,  7.0531]],

         [[ 1.3852,    -inf,    -inf,    -inf],
          [-3.6800, -1.5990,    -inf,    -inf],
          [-1.0577,  2.1490, -2.3006,    -inf],
          [ 0.5066,  2.2338,  5.7705,  5.8445]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.5618,    -inf,    -inf,    -inf],
          [ 1.3627, -1.7046,    -inf,    -inf],
          [-2.2005,  1.9439, -3.9732,    -inf],
          [ 0.7552, -3.2308,  1.6380, -1.0905]],

         [[-2.1327,    -inf,    -inf,    -inf],
          [-0.7219, -1.3965,    -inf,    -inf],
          [-1.2190, -0.0785,  2.9831,    -inf],
          [ 0.7378, -3.5208, -3.4806,  0.8480]],

         [[-0.7221,    -inf,    -inf,    -inf],
          [-2.4924, -1.0036,    -inf,    -inf],
          [-1.5064, -3.4141, -0.5230,    -inf],
          [-2.1242, -3.9608, -0.9557,  0.3485]],

         [[-0.5448,    -inf,    -inf,    -inf],
          [-0.2086, -5.6839,    -inf,    -inf],
          [-2.3270, -0.2844,  1.2610,    -inf],
          [ 0.6778, -4.6013, -4.2507,  3.0219]],

         [[-0.6808,    -inf,    -inf,    -inf],
          [-5.8051,  1.1198,    -inf,    -inf],
          [ 0.2672, -2.9884,  2.8583,    -inf],
          [ 6.4521, -3.1288, -1.0510,  0.3013]],

         [[ 0.4036,    -inf,    -inf,    -inf],
          [-2.1667,  0.7328,    -inf,    -inf],
          [ 0.7962, -2.5033,  0.0678,    -inf],
          [-1.7443,  1.3487, -0.0307, -1.5757]],

         [[ 1.9862,    -inf,    -inf,    -inf],
          [-0.2895, -5.7642,    -inf,    -inf],
          [ 3.6415,  1.6188,  6.5836,    -inf],
          [ 0.4084,  2.3581,  1.5853, -0.9709]],

         [[-2.4110,    -inf,    -inf,    -inf],
          [-3.0846, -3.0594,    -inf,    -inf],
          [-2.2028, -1.1158,  2.9931,    -inf],
          [-2.5427, -0.0874,  0.3143, -0.9610]],

         [[ 0.7847,    -inf,    -inf,    -inf],
          [ 3.5980,  1.1007,    -inf,    -inf],
          [-1.9964, -3.8584, -2.3021,    -inf],
          [ 0.3238,  1.0538,  2.9230,  0.3436]],

         [[ 0.2568,    -inf,    -inf,    -inf],
          [ 0.2078, -2.1235,    -inf,    -inf],
          [-0.9273,  2.8208, -2.5541,    -inf],
          [ 4.7493,  4.8283,  1.2366, -2.0866]],

         [[-2.2220,    -inf,    -inf,    -inf],
          [ 4.0600,  0.0683,    -inf,    -inf],
          [-0.6827, -0.1251,  4.0050,    -inf],
          [ 0.1190, -3.0031,  5.4527, -1.1711]],

         [[-1.5687,    -inf,    -inf,    -inf],
          [ 1.3631, -0.5049,    -inf,    -inf],
          [-0.5970, -2.4450, -1.5779,    -inf],
          [ 0.7439, -3.3181,  4.2999, -0.9085]],

         [[-2.3344,    -inf,    -inf,    -inf],
          [-0.1094, -0.6980,    -inf,    -inf],
          [-0.8454,  0.3761,  2.3850,    -inf],
          [-2.6076, -3.2609,  0.7595,  4.1231]],

         [[-3.4729,    -inf,    -inf,    -inf],
          [-0.9269, -3.2782,    -inf,    -inf],
          [-1.4478, -0.1365,  2.3467,    -inf],
          [-4.4532,  1.5027,  2.5487, -1.1693]],

         [[-4.5005,    -inf,    -inf,    -inf],
          [-0.7965, -3.3023,    -inf,    -inf],
          [ 1.2249, -1.0283,  0.6911,    -inf],
          [-0.4385, -1.7453,  1.0539, -0.3459]],

         [[-1.1415,    -inf,    -inf,    -inf],
          [-1.0639, -4.0220,    -inf,    -inf],
          [-4.3987, -2.6469, -5.6741,    -inf],
          [ 2.6485, -1.4150, -0.3751, -0.6839]],

         [[ 2.7997,    -inf,    -inf,    -inf],
          [ 2.9407, -1.1355,    -inf,    -inf],
          [ 7.6732,  2.6225,  3.9720,    -inf],
          [ 6.2411, -1.2326,  3.8689,  1.6544]],

         [[-3.2543,    -inf,    -inf,    -inf],
          [ 2.0277, -1.1340,    -inf,    -inf],
          [ 1.4040, -2.8419,  1.3079,    -inf],
          [ 3.6242,  1.0008,  0.0348,  1.4801]],

         [[ 0.2410,    -inf,    -inf,    -inf],
          [ 2.2572,  3.9607,    -inf,    -inf],
          [ 0.5037, -1.5090,  0.8575,    -inf],
          [-1.5387,  0.6281, -1.2513,  1.5505]],

         [[-3.2425,    -inf,    -inf,    -inf],
          [-2.3799,  0.3570,    -inf,    -inf],
          [ 0.3185, -1.5321,  2.7660,    -inf],
          [-5.6518, -4.8234, -5.3264,  0.6040]],

         [[-0.2053,    -inf,    -inf,    -inf],
          [ 2.8075, -1.2097,    -inf,    -inf],
          [-0.6525,  3.1020,  3.8769,    -inf],
          [-3.6290, -5.0465, -0.4636, -2.6467]],

         [[ 0.7284,    -inf,    -inf,    -inf],
          [-0.1788,  3.7452,    -inf,    -inf],
          [ 2.7337,  2.3775,  1.3943,    -inf],
          [-2.4306,  0.1448,  4.6209,  1.2696]],

         [[ 2.7879,    -inf,    -inf,    -inf],
          [ 0.5442, -3.1983,    -inf,    -inf],
          [ 0.9618, -0.8165,  1.9178,    -inf],
          [ 4.7787, -2.6467,  2.5467,  0.9613]],

         [[ 0.8221,    -inf,    -inf,    -inf],
          [-3.0062,  0.0399,    -inf,    -inf],
          [ 3.1348,  1.9057,  0.8822,    -inf],
          [-0.4425, -1.3991, -2.5316,  0.3568]],

         [[ 4.3262,    -inf,    -inf,    -inf],
          [ 2.9134, -0.6334,    -inf,    -inf],
          [ 4.5012,  2.5162,  0.4832,    -inf],
          [ 4.1504,  2.6070,  4.1413,  0.8409]]],


        [[[ 0.5077,    -inf,    -inf,    -inf],
          [ 0.8240, -4.0131,    -inf,    -inf],
          [-2.6198, -0.0571, -0.1388,    -inf],
          [-3.0502, -2.6237,  3.6448,  0.8048]],

         [[ 1.9096,    -inf,    -inf,    -inf],
          [-5.2016, -1.9068,    -inf,    -inf],
          [-1.5470,  1.5739,  3.2059,    -inf],
          [ 3.0860, -1.2529,  1.6003,  1.0353]],

         [[-1.4638,    -inf,    -inf,    -inf],
          [-2.5386, -1.3353,    -inf,    -inf],
          [-1.6379,  2.0643,  0.8254,    -inf],
          [ 1.8856, -3.0302,  2.7813, -0.5440]],

         [[-2.5223,    -inf,    -inf,    -inf],
          [ 0.4533,  1.0119,    -inf,    -inf],
          [ 2.7125,  2.9739,  1.1673,    -inf],
          [ 0.9877,  4.4191,  2.2163, -3.3381]],

         [[ 0.3204,    -inf,    -inf,    -inf],
          [-0.2779,  1.7470,    -inf,    -inf],
          [ 1.0091,  1.4507,  0.4893,    -inf],
          [ 0.4146,  0.6522, -1.0886, -0.9143]],

         [[-0.3876,    -inf,    -inf,    -inf],
          [-2.7378,  3.5800,    -inf,    -inf],
          [ 0.8423,  3.3239,  3.8971,    -inf],
          [ 0.7360, -1.4659, -0.6768,  0.9431]],

         [[ 1.3245,    -inf,    -inf,    -inf],
          [-1.9381, -3.9636,    -inf,    -inf],
          [-1.8774,  0.8068, -4.8731,    -inf],
          [-2.1526,  2.1041, -3.9788,  1.9225]],

         [[-0.1799,    -inf,    -inf,    -inf],
          [-1.6356, -0.5593,    -inf,    -inf],
          [-1.3366, -2.4376,  1.1301,    -inf],
          [ 3.8826, -0.9860,  2.4544, -3.4064]],

         [[-0.4634,    -inf,    -inf,    -inf],
          [ 3.2843, -2.3601,    -inf,    -inf],
          [-0.0756, -3.1393, -1.1082,    -inf],
          [ 1.3649, -3.9985,  3.2482,  7.0965]],

         [[ 1.7787,    -inf,    -inf,    -inf],
          [ 0.7828, -0.9574,    -inf,    -inf],
          [-0.3033,  2.3398, -0.9917,    -inf],
          [ 6.5522,  5.7076,  4.0767,  3.6516]],

         [[-0.0301,    -inf,    -inf,    -inf],
          [ 1.1108, -4.9521,    -inf,    -inf],
          [ 4.6981, -0.6657,  3.8286,    -inf],
          [-4.1740, -6.0776,  2.4619,  2.1497]],

         [[-2.2054,    -inf,    -inf,    -inf],
          [ 1.4702,  1.6262,    -inf,    -inf],
          [-1.6034,  0.3151,  4.1913,    -inf],
          [-3.8944,  0.6621, -2.5681, -1.6692]],

         [[-3.4664,    -inf,    -inf,    -inf],
          [-2.5595,  3.5717,    -inf,    -inf],
          [-0.8615,  0.3646,  4.5488,    -inf],
          [-0.9394, -0.8431, -1.4414,  1.6889]],

         [[-1.5548,    -inf,    -inf,    -inf],
          [-0.5127, -1.1044,    -inf,    -inf],
          [ 3.0975,  3.2770,  1.1050,    -inf],
          [-1.9775, -1.1658,  1.1326,  2.4810]],

         [[-3.2982,    -inf,    -inf,    -inf],
          [-0.9446, -2.4994,    -inf,    -inf],
          [ 0.8374,  3.8972,  4.2268,    -inf],
          [-0.4337,  0.5854,  1.7244,  1.7963]],

         [[ 0.8792,    -inf,    -inf,    -inf],
          [ 1.5708,  2.7362,    -inf,    -inf],
          [-2.9625,  4.3308, -2.8622,    -inf],
          [ 2.8694,  0.8078, -4.7524, -0.3427]],

         [[-0.9886,    -inf,    -inf,    -inf],
          [ 4.3139,  1.2068,    -inf,    -inf],
          [ 2.6597, -5.9761, -4.4671,    -inf],
          [ 8.6206,  2.5406,  3.1764,  2.3635]],

         [[-3.4935,    -inf,    -inf,    -inf],
          [ 0.1599, -2.4748,    -inf,    -inf],
          [ 3.0238, -0.0922,  0.1366,    -inf],
          [ 1.1570,  1.5110, -0.3921,  6.2076]],

         [[ 7.1821,    -inf,    -inf,    -inf],
          [ 1.8311,  4.6377,    -inf,    -inf],
          [-0.7712,  3.0259,  0.5157,    -inf],
          [-1.8771,  1.9906, -2.1111,  0.2827]],

         [[-3.7322,    -inf,    -inf,    -inf],
          [-3.1603,  2.6425,    -inf,    -inf],
          [-2.5532, -0.4466, -3.2467,    -inf],
          [-2.7208, -4.4715,  0.5187, -0.3274]],

         [[-2.7598,    -inf,    -inf,    -inf],
          [ 2.9718,  0.4431,    -inf,    -inf],
          [ 5.4211,  3.4159,  1.2937,    -inf],
          [-4.6467, -6.3684, -0.0133, -2.6514]],

         [[ 1.8225,    -inf,    -inf,    -inf],
          [ 3.8919,  3.8555,    -inf,    -inf],
          [-1.9703, -4.8796, -2.1753,    -inf],
          [-1.2534,  2.9972,  3.1459,  0.7239]],

         [[ 1.3584,    -inf,    -inf,    -inf],
          [ 3.5887,  1.0144,    -inf,    -inf],
          [-1.0975, -5.9372, -3.9194,    -inf],
          [-1.7788,  0.6426,  2.8740,  2.8006]],

         [[ 1.0804,    -inf,    -inf,    -inf],
          [-0.9057,  0.6297,    -inf,    -inf],
          [-1.2865, -1.0690, -1.9707,    -inf],
          [-1.4013,  0.4026,  2.8874,  7.0531]],

         [[ 1.3852,    -inf,    -inf,    -inf],
          [-3.6800, -1.5990,    -inf,    -inf],
          [-1.0577,  2.1490, -2.3006,    -inf],
          [ 0.5066,  2.2338,  5.7705,  5.8445]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-7.4149e-01, -1.5587e-01,  6.7868e-01,  ...,  1.4695e-01,
           -2.6677e-01,  1.9583e-01],
          [ 1.6153e-01,  2.6300e-01,  2.7107e-01,  ...,  7.8819e-01,
           -3.6910e-01, -2.9203e-01],
          [-2.3004e-01,  4.6088e-02, -8.4463e-01,  ...,  8.0261e-01,
           -7.4158e-01,  4.4168e-01],
          ...,
          [ 6.9175e-02, -1.3792e-01,  2.6190e-01,  ..., -6.3437e-01,
            1.0326e+00, -1.6501e-01],
          [-2.1769e-01,  2.2435e-01, -1.7342e-01,  ..., -9.5136e-01,
           -9.6834e-02,  7.7589e-02],
          [-8.6444e-01, -7.3769e-03, -4.4889e-04,  ...,  3.2699e-01,
           -6.4732e-01,  4.2480e-01]],

         [[-2.3858e-01,  2.2809e-01, -1.0361e-01,  ...,  9.0194e-02,
           -1.4726e-01,  5.0174e-03],
          [ 2.8142e-01, -2.0915e-01,  7.5079e-03,  ...,  3.0939e-01,
            7.2775e-02, -2.3744e-01],
          [-3.7889e-01,  1.2754e-01, -7.4022e-01,  ..., -1.4862e-01,
           -3.7390e-01,  2.5097e-01],
          ...,
          [ 4.2849e-01, -2.2667e-01, -1.7568e-01,  ..., -6.8452e-01,
            1.5793e-01, -4.5179e-01],
          [-2.8403e-01,  3.7256e-01, -4.9370e-01,  ..., -8.4144e-01,
           -2.4505e-01,  1.7179e-01],
          [-2.4319e-01,  1.1184e-02,  4.7046e-03,  ...,  6.0410e-02,
           -5.1407e-01,  1.3334e-01]],

         [[-1.1344e-01,  3.2898e-01, -7.0621e-01,  ...,  1.2187e-01,
           -2.9380e-01,  2.1489e-01],
          [ 1.5242e-01, -1.9211e-03,  3.2368e-01,  ...,  3.4605e-01,
           -6.6882e-02, -5.7000e-01],
          [-3.1936e-01, -2.4521e-01, -6.7467e-01,  ..., -8.2924e-02,
           -3.7606e-01,  5.9066e-02],
          ...,
          [ 5.0412e-01,  3.8603e-01, -2.9286e-01,  ..., -8.8644e-01,
           -2.5671e-01, -6.1509e-01],
          [ 1.8908e-01,  5.6423e-01, -4.0696e-01,  ..., -7.3854e-01,
           -4.5458e-02,  3.5587e-01],
          [ 9.6438e-02,  1.5381e-01, -9.6769e-02,  ...,  3.6632e-01,
           -3.1945e-01,  2.7792e-01]],

         [[-3.7483e-01,  3.1529e-01, -6.4987e-01,  ...,  4.3300e-01,
           -3.9575e-01,  5.8895e-01],
          [ 1.9146e-01,  2.2105e-01, -3.0345e-02,  ...,  2.0541e-01,
           -2.8687e-03, -7.6409e-01],
          [-1.6858e-01, -3.2712e-03, -6.9810e-01,  ...,  8.2745e-02,
           -2.8237e-01,  1.4781e-01],
          ...,
          [ 2.2630e-01, -7.1470e-02,  2.6524e-02,  ..., -7.2090e-01,
            4.6169e-02, -4.2234e-01],
          [-5.5173e-02,  5.2818e-01, -5.6035e-01,  ..., -7.0267e-01,
            1.6874e-02,  6.8123e-01],
          [ 3.6444e-01,  2.9812e-01, -3.2545e-02,  ...,  3.9982e-01,
           -2.7775e-01,  4.8707e-01]]],


        [[[-9.4403e-01, -1.5469e-01,  7.5646e-01,  ...,  3.7957e-01,
           -2.6286e-01,  1.1157e-01],
          [ 1.0927e-01,  3.7525e-01, -1.0076e-01,  ...,  8.2623e-01,
           -5.7584e-01,  6.3683e-01],
          [-1.8098e-01, -2.7878e-01, -6.8918e-01,  ..., -4.0963e-01,
           -1.1195e+00,  6.8097e-01],
          ...,
          [ 1.5399e-01, -2.9611e-01,  2.5348e-01,  ..., -6.8252e-01,
            1.0235e+00, -2.8777e-01],
          [-4.3712e-01,  3.9802e-02,  2.2830e-01,  ..., -7.0356e-01,
           -6.3164e-03,  2.1756e-02],
          [-1.0240e+00, -3.2967e-02,  2.4568e-01,  ..., -1.0116e-01,
            2.9622e-02,  6.3657e-01]],

         [[-5.4333e-01, -1.0432e-01,  4.6659e-01,  ...,  1.1717e-01,
           -2.9162e-01,  6.6677e-02],
          [ 4.3541e-02,  1.4953e-01, -4.0150e-02,  ...,  3.2923e-01,
           -2.2945e-01,  2.5375e-01],
          [-3.3664e-01, -2.0692e-01, -8.5233e-01,  ..., -9.5930e-01,
           -5.5512e-01,  4.6693e-01],
          ...,
          [ 5.8285e-01, -3.9918e-01, -2.5111e-01,  ..., -5.9863e-01,
            3.5809e-01, -8.2896e-02],
          [-3.3739e-01, -3.5136e-01,  4.3344e-01,  ..., -1.1423e+00,
            1.9275e-01,  3.5288e-01],
          [-2.0239e-01,  1.9948e-01, -7.8766e-02,  ...,  6.5727e-01,
            2.9261e-01,  6.9419e-01]],

         [[-2.8371e-01,  1.9507e-01, -3.5608e-01,  ...,  2.2040e-01,
           -2.2099e-02,  2.8815e-01],
          [-3.9916e-01, -3.9249e-01,  1.1176e-01,  ..., -1.9320e-01,
           -3.5713e-02, -2.1152e-01],
          [ 5.8904e-02, -1.0211e-01, -6.5495e-01,  ..., -7.4304e-01,
           -8.4505e-02,  6.2253e-01],
          ...,
          [ 3.3594e-01, -2.8473e-01, -2.4123e-01,  ..., -7.1616e-01,
            5.1652e-02, -3.7771e-01],
          [ 1.7670e-01, -1.9427e-02,  2.9166e-01,  ..., -9.9561e-01,
            1.5828e-01,  4.1022e-01],
          [-1.7158e-01,  4.6274e-02, -1.4838e-01,  ...,  7.9022e-01,
            3.4418e-01,  7.4684e-01]],

         [[-1.3612e-01,  1.8005e-01, -6.3624e-01,  ...,  4.8360e-02,
           -8.1402e-02,  3.4488e-01],
          [ 1.0999e-02, -6.6382e-02,  5.9884e-02,  ..., -7.7034e-02,
           -3.1697e-01, -1.3023e-01],
          [ 2.2238e-01,  7.4168e-02, -3.5049e-01,  ..., -3.7688e-01,
           -1.3321e-01,  5.8490e-01],
          ...,
          [ 3.2651e-01, -1.9063e-01,  2.6025e-01,  ..., -2.5779e-01,
            1.0843e-01,  8.7792e-02],
          [-3.7963e-02,  1.4012e-01, -1.8961e-01,  ..., -8.0076e-01,
            2.5861e-01,  6.3626e-01],
          [-1.6730e-01, -5.3861e-03,  4.0140e-02,  ..., -1.6527e-02,
            4.8396e-03,  1.0400e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.7415, -0.1559,  0.6787,  ...,  0.3270, -0.6473,  0.4248],
         [-0.2386,  0.2281, -0.1036,  ...,  0.0604, -0.5141,  0.1333],
         [-0.1134,  0.3290, -0.7062,  ...,  0.3663, -0.3194,  0.2779],
         [-0.3748,  0.3153, -0.6499,  ...,  0.3998, -0.2777,  0.4871]],

        [[-0.9440, -0.1547,  0.7565,  ..., -0.1012,  0.0296,  0.6366],
         [-0.5433, -0.1043,  0.4666,  ...,  0.6573,  0.2926,  0.6942],
         [-0.2837,  0.1951, -0.3561,  ...,  0.7902,  0.3442,  0.7468],
         [-0.1361,  0.1800, -0.6362,  ..., -0.0165,  0.0048,  0.1040]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.2068,  0.2716, -0.0036,  ...,  0.2967,  0.5440,  0.3020],
         [-0.1756,  0.4302, -0.2265,  ...,  0.0623,  0.5609,  0.4089],
         [-0.3460,  0.3418, -0.2018,  ...,  0.0614,  0.3532,  0.4174],
         [-0.1229,  0.2542, -0.1170,  ...,  0.1667,  0.2751,  0.2746]],

        [[-0.3028, -0.1387, -0.3594,  ...,  0.5217,  0.3774,  0.0815],
         [ 0.0195,  0.2372,  0.0648,  ...,  0.0516,  0.4807,  0.3869],
         [-0.3908,  0.1394, -0.2438,  ...,  0.1098,  0.4199,  0.1103],
         [-0.1497, -0.0298, -0.1607,  ...,  0.1976,  0.0453,  0.1707]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-2.1826e+00,        -inf,        -inf,        -inf],
          [ 1.0005e+00, -3.2844e+00,        -inf,        -inf],
          [ 1.3757e+00,  5.1827e-01,  4.4292e+00,        -inf],
          [ 2.4266e+00, -7.0669e-01,  2.7462e+00,  5.2471e-01]],

         [[-1.5803e+00,        -inf,        -inf,        -inf],
          [-1.0439e+00,  4.2752e-01,        -inf,        -inf],
          [-8.3884e-01,  1.1163e+00, -2.9348e+00,        -inf],
          [ 2.5941e+00,  2.7128e+00,  5.9689e+00,  4.2602e+00]],

         [[-3.3706e+00,        -inf,        -inf,        -inf],
          [ 1.8030e+00,  1.4285e+00,        -inf,        -inf],
          [ 5.3050e+00,  2.5507e+00,  1.3737e-01,        -inf],
          [-2.5057e+00, -3.8337e+00,  1.2464e+00, -1.8704e+00]],

         [[ 2.7082e+00,        -inf,        -inf,        -inf],
          [ 9.4688e-01,  1.4835e+00,        -inf,        -inf],
          [ 3.0463e+00,  6.7954e-01, -9.3828e-01,        -inf],
          [ 4.2138e+00, -8.7244e-01,  2.4259e+00,  1.2617e+00]],

         [[ 2.9137e+00,        -inf,        -inf,        -inf],
          [-8.0922e-01,  2.3269e+00,        -inf,        -inf],
          [-2.5980e+00, -6.2833e-01, -1.2762e+00,        -inf],
          [-5.3855e+00, -2.0311e+00, -1.3798e+00,  2.5836e+00]],

         [[-2.0190e+00,        -inf,        -inf,        -inf],
          [-3.4216e+00, -5.7771e-01,        -inf,        -inf],
          [-9.0327e-02,  2.0658e+00,  1.0508e-01,        -inf],
          [ 1.8040e+00,  1.5393e+00, -8.6644e-01,  5.8068e-01]],

         [[-5.0406e+00,        -inf,        -inf,        -inf],
          [-1.4472e+00, -7.1403e-01,        -inf,        -inf],
          [ 1.0133e+00,  4.2110e-02,  1.5355e-01,        -inf],
          [-2.5389e-01, -2.3659e+00, -3.3870e+00, -4.6464e+00]],

         [[-5.9210e+00,        -inf,        -inf,        -inf],
          [-2.2174e+00,  1.2770e+00,        -inf,        -inf],
          [ 4.6614e-01, -2.3607e+00,  4.2322e+00,        -inf],
          [-3.2596e+00, -1.1173e+00, -2.7859e+00, -3.3759e+00]],

         [[-1.0209e+00,        -inf,        -inf,        -inf],
          [-4.1504e+00,  8.8614e-01,        -inf,        -inf],
          [-5.9901e+00, -8.3404e-01, -4.8507e+00,        -inf],
          [-4.1485e+00, -6.9031e-01, -1.2981e+00,  5.7681e-01]],

         [[ 1.5437e+00,        -inf,        -inf,        -inf],
          [ 2.4492e+00,  2.7536e+00,        -inf,        -inf],
          [-1.2586e+00,  3.7600e+00, -3.4357e+00,        -inf],
          [ 1.0980e+00,  2.5156e+00, -3.0298e+00, -2.0795e+00]],

         [[-2.3404e+00,        -inf,        -inf,        -inf],
          [-1.3366e-01,  2.1454e+00,        -inf,        -inf],
          [-2.8336e+00,  2.2507e+00, -5.3791e+00,        -inf],
          [-3.2323e+00, -2.5252e+00, -3.7615e+00, -5.3022e+00]],

         [[-1.8490e-01,        -inf,        -inf,        -inf],
          [-3.1806e+00,  2.2810e+00,        -inf,        -inf],
          [-2.0125e+00, -1.4706e+00, -1.9456e+00,        -inf],
          [ 2.3886e+00,  3.0263e+00,  3.2415e+00,  3.8592e+00]],

         [[-1.1358e+00,        -inf,        -inf,        -inf],
          [ 1.4092e+00,  4.4569e+00,        -inf,        -inf],
          [ 9.8682e-01,  7.0104e-01,  1.2616e+00,        -inf],
          [ 5.3210e+00,  1.3592e+00,  2.4140e+00,  2.7058e+00]],

         [[ 5.4603e-01,        -inf,        -inf,        -inf],
          [ 6.9270e+00,  5.3344e+00,        -inf,        -inf],
          [ 5.2929e+00,  1.5865e+00, -2.6519e+00,        -inf],
          [ 6.0416e+00,  1.7897e+00, -2.7121e+00,  1.7492e+00]],

         [[ 4.4851e+00,        -inf,        -inf,        -inf],
          [ 3.5329e-01,  3.2106e+00,        -inf,        -inf],
          [ 2.9773e+00, -1.1894e+00,  2.5793e+00,        -inf],
          [ 3.8156e+00,  1.7759e+00, -2.2330e+00,  2.1434e+00]],

         [[ 2.6025e+00,        -inf,        -inf,        -inf],
          [ 3.6555e-01, -2.8685e+00,        -inf,        -inf],
          [-2.2239e+00, -1.3707e+00, -3.5625e+00,        -inf],
          [ 4.1233e+00,  2.3440e+00,  5.1277e-01, -4.4153e+00]],

         [[-9.4260e-01,        -inf,        -inf,        -inf],
          [ 3.9023e+00, -2.9497e+00,        -inf,        -inf],
          [ 3.7284e+00, -1.4138e+00,  2.2068e+00,        -inf],
          [-3.0292e+00,  5.2780e-01,  2.6821e+00,  1.8912e+00]],

         [[-1.5414e-01,        -inf,        -inf,        -inf],
          [ 3.1810e+00,  8.8575e-01,        -inf,        -inf],
          [ 5.1575e+00,  2.8891e+00, -3.2173e-01,        -inf],
          [ 9.5162e-01,  9.6865e-01, -2.8191e+00, -5.2231e-01]],

         [[-4.0207e+00,        -inf,        -inf,        -inf],
          [-2.4844e-01,  1.0962e+00,        -inf,        -inf],
          [-1.3118e+00,  4.0019e+00,  3.7568e+00,        -inf],
          [ 5.4048e-01,  5.3597e-01,  8.5387e-01, -5.3653e-01]],

         [[ 9.9117e-01,        -inf,        -inf,        -inf],
          [-4.0714e+00, -3.6856e+00,        -inf,        -inf],
          [-1.0229e+00,  1.6366e+00, -2.6326e+00,        -inf],
          [-1.0686e+00, -5.5381e-01,  2.1603e+00, -5.8247e+00]],

         [[-5.2747e+00,        -inf,        -inf,        -inf],
          [-2.6061e+00, -4.6093e-01,        -inf,        -inf],
          [-8.5159e-02,  3.0176e+00, -3.9506e-02,        -inf],
          [ 7.1523e-01,  4.7182e+00, -5.0029e-01, -1.6602e+00]],

         [[-2.3339e-01,        -inf,        -inf,        -inf],
          [ 2.6761e+00,  1.9317e+00,        -inf,        -inf],
          [ 7.2960e-01,  2.6719e+00,  1.9809e+00,        -inf],
          [-1.5041e+00,  2.8898e+00, -6.6050e-01,  2.0674e-01]],

         [[ 2.0979e-01,        -inf,        -inf,        -inf],
          [-1.2442e-01,  3.1478e+00,        -inf,        -inf],
          [-4.3231e-01,  5.4442e+00,  1.6387e+00,        -inf],
          [-1.0674e+00,  8.0940e-01,  2.9164e+00,  2.1902e-01]],

         [[-1.2269e+00,        -inf,        -inf,        -inf],
          [-2.9342e+00,  1.0206e+00,        -inf,        -inf],
          [-5.9202e+00, -2.5018e+00, -6.3214e+00,        -inf],
          [-1.2390e+00, -1.8316e+00, -5.9205e-01, -6.4209e-01]],

         [[-9.3178e-01,        -inf,        -inf,        -inf],
          [ 3.2697e+00,  1.7962e+00,        -inf,        -inf],
          [ 3.1114e+00,  2.2123e+00, -1.5551e-01,        -inf],
          [ 7.1183e-01,  1.8985e+00,  2.3042e-01,  6.5595e-01]]],


        [[[ 1.0335e+00,        -inf,        -inf,        -inf],
          [ 2.0898e+00, -5.1539e-01,        -inf,        -inf],
          [ 1.9894e+00, -2.9915e+00, -1.2675e+00,        -inf],
          [ 8.5137e-01,  1.7049e-01,  2.1024e+00, -3.1342e+00]],

         [[-5.4879e+00,        -inf,        -inf,        -inf],
          [-1.9148e+00, -7.4482e-01,        -inf,        -inf],
          [-2.1644e+00, -1.9495e+00,  4.3795e-01,        -inf],
          [-9.6096e-01, -2.3221e-01, -1.7224e+00,  2.7845e+00]],

         [[-3.9777e+00,        -inf,        -inf,        -inf],
          [ 1.3653e+00, -1.7393e+00,        -inf,        -inf],
          [-2.2825e+00, -3.4913e+00, -1.7335e+00,        -inf],
          [-1.6607e+00, -4.7883e+00, -2.0978e+00,  1.3663e+00]],

         [[-1.7345e+00,        -inf,        -inf,        -inf],
          [ 4.4402e+00,  1.8606e+00,        -inf,        -inf],
          [ 1.6304e+00,  2.9832e+00,  4.0100e+00,        -inf],
          [ 4.9400e+00,  2.0341e+00,  2.7117e+00,  3.7904e+00]],

         [[ 1.2051e+00,        -inf,        -inf,        -inf],
          [-1.6436e+00,  2.4159e+00,        -inf,        -inf],
          [-6.9379e-01, -2.0294e+00,  1.6433e+00,        -inf],
          [-3.4713e+00, -2.2070e+00, -4.7836e+00, -1.2694e+00]],

         [[-5.5500e+00,        -inf,        -inf,        -inf],
          [-4.0615e+00, -1.1415e+00,        -inf,        -inf],
          [ 6.5983e-01,  5.0030e-01, -9.0981e-01,        -inf],
          [-2.6777e+00, -3.0762e-01,  1.3402e+00, -3.5627e-01]],

         [[-4.9159e+00,        -inf,        -inf,        -inf],
          [-1.6771e+00,  1.0154e+00,        -inf,        -inf],
          [-1.0500e-01,  1.7078e+00,  1.8677e+00,        -inf],
          [-3.0017e+00,  2.0046e-01,  2.2979e+00, -2.5305e+00]],

         [[-4.2044e+00,        -inf,        -inf,        -inf],
          [-1.2286e+00,  5.5733e+00,        -inf,        -inf],
          [-2.1512e+00,  1.4884e+00, -1.5442e+00,        -inf],
          [-2.9560e+00,  2.7561e-02, -5.6943e+00, -1.8586e+00]],

         [[-3.9107e-01,        -inf,        -inf,        -inf],
          [-3.3592e+00, -1.0538e+00,        -inf,        -inf],
          [-4.0977e+00, -2.5775e-01, -2.5652e+00,        -inf],
          [-1.0528e+00,  1.7839e+00,  1.2208e+00,  1.3522e+00]],

         [[-1.7882e+00,        -inf,        -inf,        -inf],
          [-4.7858e+00, -5.8478e+00,        -inf,        -inf],
          [-9.6301e-01,  1.2948e+00,  1.9934e-03,        -inf],
          [ 1.9379e+00, -2.4368e+00,  1.9849e+00, -6.9551e-01]],

         [[-4.8363e+00,        -inf,        -inf,        -inf],
          [ 9.9465e-01,  2.8812e-01,        -inf,        -inf],
          [ 1.2519e+00, -1.9153e+00, -1.0981e-01,        -inf],
          [ 5.9758e+00,  3.7296e+00, -1.4014e+00,  2.8658e+00]],

         [[ 1.3670e+00,        -inf,        -inf,        -inf],
          [ 8.6472e-01,  3.0592e+00,        -inf,        -inf],
          [-3.1735e+00, -4.9947e+00, -2.5825e+00,        -inf],
          [ 1.8224e+00,  1.0937e+00, -2.5061e-01, -2.0556e-01]],

         [[-3.5053e+00,        -inf,        -inf,        -inf],
          [ 1.5324e+00,  4.8373e+00,        -inf,        -inf],
          [-3.5314e+00, -6.1095e-01, -1.5220e+00,        -inf],
          [ 7.5499e-01, -1.5286e+00,  8.5589e-01,  2.9560e+00]],

         [[-5.9211e-01,        -inf,        -inf,        -inf],
          [ 2.9938e+00,  5.1175e-01,        -inf,        -inf],
          [ 2.6577e+00, -8.2143e-01, -5.5815e-01,        -inf],
          [ 5.6316e+00,  7.1163e-01,  1.4563e+00,  8.2266e-01]],

         [[ 5.1131e+00,        -inf,        -inf,        -inf],
          [ 5.7436e-01,  1.0741e+00,        -inf,        -inf],
          [ 1.0729e-01, -8.6243e-02, -1.6448e+00,        -inf],
          [ 2.7838e+00,  5.1129e+00,  2.5897e+00, -1.9332e+00]],

         [[ 5.5965e+00,        -inf,        -inf,        -inf],
          [-4.3968e-01,  3.7708e-01,        -inf,        -inf],
          [ 2.9894e+00, -8.5139e-01,  2.9117e+00,        -inf],
          [ 4.9197e+00,  1.5906e+00,  3.1168e-01,  1.1162e+00]],

         [[-2.8249e-01,        -inf,        -inf,        -inf],
          [-4.9621e-01, -1.7247e+00,        -inf,        -inf],
          [ 2.4358e+00, -3.2586e-01, -2.1681e-01,        -inf],
          [-1.5275e+00,  1.9714e+00, -1.3757e+00, -3.2681e-02]],

         [[-2.6152e+00,        -inf,        -inf,        -inf],
          [-1.3247e+00, -3.5322e+00,        -inf,        -inf],
          [-2.0758e+00, -4.1176e+00, -5.0061e+00,        -inf],
          [-4.4426e+00, -1.7284e+00, -2.5688e+00, -3.0387e+00]],

         [[-1.0085e+00,        -inf,        -inf,        -inf],
          [ 6.2077e+00,  4.0412e+00,        -inf,        -inf],
          [ 3.2628e+00,  2.7036e+00,  6.4720e+00,        -inf],
          [ 2.6309e-01,  2.3746e+00,  2.3319e+00, -4.3012e-01]],

         [[-5.8407e-01,        -inf,        -inf,        -inf],
          [-3.0732e+00,  2.6135e+00,        -inf,        -inf],
          [-2.2344e+00,  4.7921e-01, -1.4995e+00,        -inf],
          [ 4.3236e+00,  2.6220e+00,  1.5424e+00, -3.6480e+00]],

         [[-4.3812e+00,        -inf,        -inf,        -inf],
          [-3.2682e+00,  1.9164e+00,        -inf,        -inf],
          [-3.8312e+00, -4.2142e-01,  4.8709e-01,        -inf],
          [ 1.1429e-02,  2.8095e-01, -2.1721e+00, -6.3892e+00]],

         [[ 4.7233e-01,        -inf,        -inf,        -inf],
          [ 1.4990e+00,  1.0254e+00,        -inf,        -inf],
          [-2.1158e-01, -1.8845e+00, -2.7218e-01,        -inf],
          [-2.8297e+00, -4.2831e+00, -1.7501e+00, -8.2421e-01]],

         [[-4.2344e-01,        -inf,        -inf,        -inf],
          [-4.5490e+00, -2.9362e+00,        -inf,        -inf],
          [-1.4192e+00,  1.1372e+00,  1.7536e+00,        -inf],
          [-1.6650e+00,  6.8918e-01,  5.8734e+00, -1.7321e+00]],

         [[ 2.5925e+00,        -inf,        -inf,        -inf],
          [-1.9621e+00,  4.6925e+00,        -inf,        -inf],
          [-2.0948e+00,  4.6640e+00,  5.5534e+00,        -inf],
          [-1.4093e+00,  5.8585e-01,  7.4261e-02, -2.6152e+00]],

         [[-2.6207e+00,        -inf,        -inf,        -inf],
          [ 1.1056e+00, -3.1639e+00,        -inf,        -inf],
          [ 2.5442e+00, -1.4860e+00,  9.6580e-02,        -inf],
          [-1.6531e+00, -3.2629e+00,  2.7298e+00,  2.6930e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-2.1826e+00,        -inf,        -inf,        -inf],
          [ 1.0005e+00, -3.2844e+00,        -inf,        -inf],
          [ 1.3757e+00,  5.1827e-01,  4.4292e+00,        -inf],
          [ 2.4266e+00, -7.0669e-01,  2.7462e+00,  5.2471e-01]],

         [[-1.5803e+00,        -inf,        -inf,        -inf],
          [-1.0439e+00,  4.2752e-01,        -inf,        -inf],
          [-8.3884e-01,  1.1163e+00, -2.9348e+00,        -inf],
          [ 2.5941e+00,  2.7128e+00,  5.9689e+00,  4.2602e+00]],

         [[-3.3706e+00,        -inf,        -inf,        -inf],
          [ 1.8030e+00,  1.4285e+00,        -inf,        -inf],
          [ 5.3050e+00,  2.5507e+00,  1.3737e-01,        -inf],
          [-2.5057e+00, -3.8337e+00,  1.2464e+00, -1.8704e+00]],

         [[ 2.7082e+00,        -inf,        -inf,        -inf],
          [ 9.4688e-01,  1.4835e+00,        -inf,        -inf],
          [ 3.0463e+00,  6.7954e-01, -9.3828e-01,        -inf],
          [ 4.2138e+00, -8.7244e-01,  2.4259e+00,  1.2617e+00]],

         [[ 2.9137e+00,        -inf,        -inf,        -inf],
          [-8.0922e-01,  2.3269e+00,        -inf,        -inf],
          [-2.5980e+00, -6.2833e-01, -1.2762e+00,        -inf],
          [-5.3855e+00, -2.0311e+00, -1.3798e+00,  2.5836e+00]],

         [[-2.0190e+00,        -inf,        -inf,        -inf],
          [-3.4216e+00, -5.7771e-01,        -inf,        -inf],
          [-9.0327e-02,  2.0658e+00,  1.0508e-01,        -inf],
          [ 1.8040e+00,  1.5393e+00, -8.6644e-01,  5.8068e-01]],

         [[-5.0406e+00,        -inf,        -inf,        -inf],
          [-1.4472e+00, -7.1403e-01,        -inf,        -inf],
          [ 1.0133e+00,  4.2110e-02,  1.5355e-01,        -inf],
          [-2.5389e-01, -2.3659e+00, -3.3870e+00, -4.6464e+00]],

         [[-5.9210e+00,        -inf,        -inf,        -inf],
          [-2.2174e+00,  1.2770e+00,        -inf,        -inf],
          [ 4.6614e-01, -2.3607e+00,  4.2322e+00,        -inf],
          [-3.2596e+00, -1.1173e+00, -2.7859e+00, -3.3759e+00]],

         [[-1.0209e+00,        -inf,        -inf,        -inf],
          [-4.1504e+00,  8.8614e-01,        -inf,        -inf],
          [-5.9901e+00, -8.3404e-01, -4.8507e+00,        -inf],
          [-4.1485e+00, -6.9031e-01, -1.2981e+00,  5.7681e-01]],

         [[ 1.5437e+00,        -inf,        -inf,        -inf],
          [ 2.4492e+00,  2.7536e+00,        -inf,        -inf],
          [-1.2586e+00,  3.7600e+00, -3.4357e+00,        -inf],
          [ 1.0980e+00,  2.5156e+00, -3.0298e+00, -2.0795e+00]],

         [[-2.3404e+00,        -inf,        -inf,        -inf],
          [-1.3366e-01,  2.1454e+00,        -inf,        -inf],
          [-2.8336e+00,  2.2507e+00, -5.3791e+00,        -inf],
          [-3.2323e+00, -2.5252e+00, -3.7615e+00, -5.3022e+00]],

         [[-1.8490e-01,        -inf,        -inf,        -inf],
          [-3.1806e+00,  2.2810e+00,        -inf,        -inf],
          [-2.0125e+00, -1.4706e+00, -1.9456e+00,        -inf],
          [ 2.3886e+00,  3.0263e+00,  3.2415e+00,  3.8592e+00]],

         [[-1.1358e+00,        -inf,        -inf,        -inf],
          [ 1.4092e+00,  4.4569e+00,        -inf,        -inf],
          [ 9.8682e-01,  7.0104e-01,  1.2616e+00,        -inf],
          [ 5.3210e+00,  1.3592e+00,  2.4140e+00,  2.7058e+00]],

         [[ 5.4603e-01,        -inf,        -inf,        -inf],
          [ 6.9270e+00,  5.3344e+00,        -inf,        -inf],
          [ 5.2929e+00,  1.5865e+00, -2.6519e+00,        -inf],
          [ 6.0416e+00,  1.7897e+00, -2.7121e+00,  1.7492e+00]],

         [[ 4.4851e+00,        -inf,        -inf,        -inf],
          [ 3.5329e-01,  3.2106e+00,        -inf,        -inf],
          [ 2.9773e+00, -1.1894e+00,  2.5793e+00,        -inf],
          [ 3.8156e+00,  1.7759e+00, -2.2330e+00,  2.1434e+00]],

         [[ 2.6025e+00,        -inf,        -inf,        -inf],
          [ 3.6555e-01, -2.8685e+00,        -inf,        -inf],
          [-2.2239e+00, -1.3707e+00, -3.5625e+00,        -inf],
          [ 4.1233e+00,  2.3440e+00,  5.1277e-01, -4.4153e+00]],

         [[-9.4260e-01,        -inf,        -inf,        -inf],
          [ 3.9023e+00, -2.9497e+00,        -inf,        -inf],
          [ 3.7284e+00, -1.4138e+00,  2.2068e+00,        -inf],
          [-3.0292e+00,  5.2780e-01,  2.6821e+00,  1.8912e+00]],

         [[-1.5414e-01,        -inf,        -inf,        -inf],
          [ 3.1810e+00,  8.8575e-01,        -inf,        -inf],
          [ 5.1575e+00,  2.8891e+00, -3.2173e-01,        -inf],
          [ 9.5162e-01,  9.6865e-01, -2.8191e+00, -5.2231e-01]],

         [[-4.0207e+00,        -inf,        -inf,        -inf],
          [-2.4844e-01,  1.0962e+00,        -inf,        -inf],
          [-1.3118e+00,  4.0019e+00,  3.7568e+00,        -inf],
          [ 5.4048e-01,  5.3597e-01,  8.5387e-01, -5.3653e-01]],

         [[ 9.9117e-01,        -inf,        -inf,        -inf],
          [-4.0714e+00, -3.6856e+00,        -inf,        -inf],
          [-1.0229e+00,  1.6366e+00, -2.6326e+00,        -inf],
          [-1.0686e+00, -5.5381e-01,  2.1603e+00, -5.8247e+00]],

         [[-5.2747e+00,        -inf,        -inf,        -inf],
          [-2.6061e+00, -4.6093e-01,        -inf,        -inf],
          [-8.5159e-02,  3.0176e+00, -3.9506e-02,        -inf],
          [ 7.1523e-01,  4.7182e+00, -5.0029e-01, -1.6602e+00]],

         [[-2.3339e-01,        -inf,        -inf,        -inf],
          [ 2.6761e+00,  1.9317e+00,        -inf,        -inf],
          [ 7.2960e-01,  2.6719e+00,  1.9809e+00,        -inf],
          [-1.5041e+00,  2.8898e+00, -6.6050e-01,  2.0674e-01]],

         [[ 2.0979e-01,        -inf,        -inf,        -inf],
          [-1.2442e-01,  3.1478e+00,        -inf,        -inf],
          [-4.3231e-01,  5.4442e+00,  1.6387e+00,        -inf],
          [-1.0674e+00,  8.0940e-01,  2.9164e+00,  2.1902e-01]],

         [[-1.2269e+00,        -inf,        -inf,        -inf],
          [-2.9342e+00,  1.0206e+00,        -inf,        -inf],
          [-5.9202e+00, -2.5018e+00, -6.3214e+00,        -inf],
          [-1.2390e+00, -1.8316e+00, -5.9205e-01, -6.4209e-01]],

         [[-9.3178e-01,        -inf,        -inf,        -inf],
          [ 3.2697e+00,  1.7962e+00,        -inf,        -inf],
          [ 3.1114e+00,  2.2123e+00, -1.5551e-01,        -inf],
          [ 7.1183e-01,  1.8985e+00,  2.3042e-01,  6.5595e-01]]],


        [[[ 1.0335e+00,        -inf,        -inf,        -inf],
          [ 2.0898e+00, -5.1539e-01,        -inf,        -inf],
          [ 1.9894e+00, -2.9915e+00, -1.2675e+00,        -inf],
          [ 8.5137e-01,  1.7049e-01,  2.1024e+00, -3.1342e+00]],

         [[-5.4879e+00,        -inf,        -inf,        -inf],
          [-1.9148e+00, -7.4482e-01,        -inf,        -inf],
          [-2.1644e+00, -1.9495e+00,  4.3795e-01,        -inf],
          [-9.6096e-01, -2.3221e-01, -1.7224e+00,  2.7845e+00]],

         [[-3.9777e+00,        -inf,        -inf,        -inf],
          [ 1.3653e+00, -1.7393e+00,        -inf,        -inf],
          [-2.2825e+00, -3.4913e+00, -1.7335e+00,        -inf],
          [-1.6607e+00, -4.7883e+00, -2.0978e+00,  1.3663e+00]],

         [[-1.7345e+00,        -inf,        -inf,        -inf],
          [ 4.4402e+00,  1.8606e+00,        -inf,        -inf],
          [ 1.6304e+00,  2.9832e+00,  4.0100e+00,        -inf],
          [ 4.9400e+00,  2.0341e+00,  2.7117e+00,  3.7904e+00]],

         [[ 1.2051e+00,        -inf,        -inf,        -inf],
          [-1.6436e+00,  2.4159e+00,        -inf,        -inf],
          [-6.9379e-01, -2.0294e+00,  1.6433e+00,        -inf],
          [-3.4713e+00, -2.2070e+00, -4.7836e+00, -1.2694e+00]],

         [[-5.5500e+00,        -inf,        -inf,        -inf],
          [-4.0615e+00, -1.1415e+00,        -inf,        -inf],
          [ 6.5983e-01,  5.0030e-01, -9.0981e-01,        -inf],
          [-2.6777e+00, -3.0762e-01,  1.3402e+00, -3.5627e-01]],

         [[-4.9159e+00,        -inf,        -inf,        -inf],
          [-1.6771e+00,  1.0154e+00,        -inf,        -inf],
          [-1.0500e-01,  1.7078e+00,  1.8677e+00,        -inf],
          [-3.0017e+00,  2.0046e-01,  2.2979e+00, -2.5305e+00]],

         [[-4.2044e+00,        -inf,        -inf,        -inf],
          [-1.2286e+00,  5.5733e+00,        -inf,        -inf],
          [-2.1512e+00,  1.4884e+00, -1.5442e+00,        -inf],
          [-2.9560e+00,  2.7561e-02, -5.6943e+00, -1.8586e+00]],

         [[-3.9107e-01,        -inf,        -inf,        -inf],
          [-3.3592e+00, -1.0538e+00,        -inf,        -inf],
          [-4.0977e+00, -2.5775e-01, -2.5652e+00,        -inf],
          [-1.0528e+00,  1.7839e+00,  1.2208e+00,  1.3522e+00]],

         [[-1.7882e+00,        -inf,        -inf,        -inf],
          [-4.7858e+00, -5.8478e+00,        -inf,        -inf],
          [-9.6301e-01,  1.2948e+00,  1.9934e-03,        -inf],
          [ 1.9379e+00, -2.4368e+00,  1.9849e+00, -6.9551e-01]],

         [[-4.8363e+00,        -inf,        -inf,        -inf],
          [ 9.9465e-01,  2.8812e-01,        -inf,        -inf],
          [ 1.2519e+00, -1.9153e+00, -1.0981e-01,        -inf],
          [ 5.9758e+00,  3.7296e+00, -1.4014e+00,  2.8658e+00]],

         [[ 1.3670e+00,        -inf,        -inf,        -inf],
          [ 8.6472e-01,  3.0592e+00,        -inf,        -inf],
          [-3.1735e+00, -4.9947e+00, -2.5825e+00,        -inf],
          [ 1.8224e+00,  1.0937e+00, -2.5061e-01, -2.0556e-01]],

         [[-3.5053e+00,        -inf,        -inf,        -inf],
          [ 1.5324e+00,  4.8373e+00,        -inf,        -inf],
          [-3.5314e+00, -6.1095e-01, -1.5220e+00,        -inf],
          [ 7.5499e-01, -1.5286e+00,  8.5589e-01,  2.9560e+00]],

         [[-5.9211e-01,        -inf,        -inf,        -inf],
          [ 2.9938e+00,  5.1175e-01,        -inf,        -inf],
          [ 2.6577e+00, -8.2143e-01, -5.5815e-01,        -inf],
          [ 5.6316e+00,  7.1163e-01,  1.4563e+00,  8.2266e-01]],

         [[ 5.1131e+00,        -inf,        -inf,        -inf],
          [ 5.7436e-01,  1.0741e+00,        -inf,        -inf],
          [ 1.0729e-01, -8.6243e-02, -1.6448e+00,        -inf],
          [ 2.7838e+00,  5.1129e+00,  2.5897e+00, -1.9332e+00]],

         [[ 5.5965e+00,        -inf,        -inf,        -inf],
          [-4.3968e-01,  3.7708e-01,        -inf,        -inf],
          [ 2.9894e+00, -8.5139e-01,  2.9117e+00,        -inf],
          [ 4.9197e+00,  1.5906e+00,  3.1168e-01,  1.1162e+00]],

         [[-2.8249e-01,        -inf,        -inf,        -inf],
          [-4.9621e-01, -1.7247e+00,        -inf,        -inf],
          [ 2.4358e+00, -3.2586e-01, -2.1681e-01,        -inf],
          [-1.5275e+00,  1.9714e+00, -1.3757e+00, -3.2681e-02]],

         [[-2.6152e+00,        -inf,        -inf,        -inf],
          [-1.3247e+00, -3.5322e+00,        -inf,        -inf],
          [-2.0758e+00, -4.1176e+00, -5.0061e+00,        -inf],
          [-4.4426e+00, -1.7284e+00, -2.5688e+00, -3.0387e+00]],

         [[-1.0085e+00,        -inf,        -inf,        -inf],
          [ 6.2077e+00,  4.0412e+00,        -inf,        -inf],
          [ 3.2628e+00,  2.7036e+00,  6.4720e+00,        -inf],
          [ 2.6309e-01,  2.3746e+00,  2.3319e+00, -4.3012e-01]],

         [[-5.8407e-01,        -inf,        -inf,        -inf],
          [-3.0732e+00,  2.6135e+00,        -inf,        -inf],
          [-2.2344e+00,  4.7921e-01, -1.4995e+00,        -inf],
          [ 4.3236e+00,  2.6220e+00,  1.5424e+00, -3.6480e+00]],

         [[-4.3812e+00,        -inf,        -inf,        -inf],
          [-3.2682e+00,  1.9164e+00,        -inf,        -inf],
          [-3.8312e+00, -4.2142e-01,  4.8709e-01,        -inf],
          [ 1.1429e-02,  2.8095e-01, -2.1721e+00, -6.3892e+00]],

         [[ 4.7233e-01,        -inf,        -inf,        -inf],
          [ 1.4990e+00,  1.0254e+00,        -inf,        -inf],
          [-2.1158e-01, -1.8845e+00, -2.7218e-01,        -inf],
          [-2.8297e+00, -4.2831e+00, -1.7501e+00, -8.2421e-01]],

         [[-4.2344e-01,        -inf,        -inf,        -inf],
          [-4.5490e+00, -2.9362e+00,        -inf,        -inf],
          [-1.4192e+00,  1.1372e+00,  1.7536e+00,        -inf],
          [-1.6650e+00,  6.8918e-01,  5.8734e+00, -1.7321e+00]],

         [[ 2.5925e+00,        -inf,        -inf,        -inf],
          [-1.9621e+00,  4.6925e+00,        -inf,        -inf],
          [-2.0948e+00,  4.6640e+00,  5.5534e+00,        -inf],
          [-1.4093e+00,  5.8585e-01,  7.4261e-02, -2.6152e+00]],

         [[-2.6207e+00,        -inf,        -inf,        -inf],
          [ 1.1056e+00, -3.1639e+00,        -inf,        -inf],
          [ 2.5442e+00, -1.4860e+00,  9.6580e-02,        -inf],
          [-1.6531e+00, -3.2629e+00,  2.7298e+00,  2.6930e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.3285, -0.3978,  0.2009,  ...,  0.1901,  0.1969,  0.0656],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.3033,  0.9373,  0.3848,  ...,  0.0434,  0.1542, -1.0972],
          ...,
          [-0.9234,  0.2839, -0.1074,  ...,  0.0671,  0.2864,  0.6569],
          [-0.1408,  0.4635,  0.1522,  ...,  0.1262, -0.2228, -0.6694],
          [ 0.1618,  0.0013, -0.0999,  ..., -0.7457, -0.7795, -0.0653]],

         [[-0.3571, -0.4401,  0.3787,  ...,  0.1446,  0.0439, -0.0437],
          [ 0.4646,  0.2288, -0.1688,  ..., -0.6421,  0.3073,  0.0688],
          [-0.0722,  1.1304,  0.1363,  ...,  0.0688, -0.2379, -0.2147],
          ...,
          [-0.8621,  1.0696,  0.0223,  ...,  0.0859, -0.3940, -0.1110],
          [-0.2702,  0.2775,  0.5757,  ..., -0.1921,  0.0069,  0.2589],
          [ 0.2470, -0.0735,  0.0457,  ..., -0.6718, -0.7781, -0.3942]],

         [[-0.0977, -0.1183,  0.0597,  ...,  0.0565,  0.0585,  0.0195],
          [ 0.1336,  0.2187, -0.3779,  ..., -0.7040,  0.2891, -0.0403],
          [-0.0560,  0.7936,  0.0710,  ..., -0.0830, -0.2309, -0.5961],
          ...,
          [-0.6349,  0.8304, -0.0170,  ...,  0.3048, -0.2690, -0.2803],
          [-0.1967,  0.2245,  0.4241,  ...,  0.0732, -0.0202, -0.1381],
          [ 0.0617,  0.2172,  0.0166,  ..., -0.6665, -0.7467, -0.3108]],

         [[-0.0237, -0.0085, -0.1475,  ..., -0.4045, -0.0635,  0.2134],
          [-0.5816, -0.0333,  0.0260,  ..., -0.2579, -0.2827, -0.0041],
          [ 0.1947,  0.0105, -0.0949,  ..., -0.2032, -0.1982,  0.2611],
          ...,
          [-0.4388, -0.1168, -0.0647,  ...,  0.3653,  0.3167,  0.0735],
          [-0.1993,  0.2389,  0.5653,  ...,  0.0261, -0.1467,  0.0135],
          [ 0.0660,  0.1088,  0.0063,  ..., -0.4665, -0.5083, -0.2929]]],


        [[[-0.3982, -0.3618,  0.1609,  ..., -0.3397,  0.3523,  0.1221],
          [-0.1906,  0.3403,  0.7251,  ...,  0.6627, -0.7141,  0.0395],
          [ 0.4007,  0.1442,  0.2771,  ...,  0.2775,  0.2169, -0.9810],
          ...,
          [-0.8987,  0.2138, -0.3066,  ..., -0.1460, -0.1356,  0.1427],
          [ 0.2847,  0.4652,  0.0335,  ...,  0.5787, -0.4231, -0.4320],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[-0.3347, -0.5390,  0.3224,  ..., -0.2203, -0.2243, -0.0284],
          [ 0.2605, -0.0696, -0.1031,  ...,  0.1740, -0.0936, -0.3563],
          [ 0.2046,  0.1013,  0.1850,  ..., -0.2725, -0.1138, -0.3450],
          ...,
          [-0.9023,  0.5402,  0.4547,  ..., -0.2496, -0.0899, -0.3114],
          [ 0.1315,  0.1074,  0.4926,  ...,  0.2191, -0.4177,  0.2345],
          [ 0.2212,  0.0791, -0.0715,  ..., -0.8971, -0.2599, -0.1223]],

         [[-0.1750, -0.7014,  0.0817,  ..., -0.1773,  0.2467,  0.0922],
          [ 0.6234,  0.2489,  0.3329,  ..., -0.0825,  0.1062,  0.0024],
          [-0.1009, -0.0013, -0.2813,  ..., -0.1791,  0.0085, -0.2368],
          ...,
          [-0.5841,  0.5673,  0.1526,  ..., -0.1150,  0.0215, -0.4791],
          [ 0.0735,  0.0595,  0.2775,  ...,  0.1222, -0.2344,  0.1331],
          [ 0.0155,  0.0761,  0.0040,  ..., -0.9457, -0.7292, -0.7752]],

         [[ 0.0073, -0.7479,  0.0909,  ..., -0.1837,  0.2212,  0.1732],
          [ 0.2401,  0.0601, -0.3337,  ...,  0.3491, -0.2349,  0.2322],
          [ 0.1429, -0.1297, -0.5849,  ..., -0.1519, -0.1129,  0.0956],
          ...,
          [-0.2874,  0.4785, -0.1272,  ..., -0.0929, -0.0406, -0.5857],
          [ 0.3560,  0.1452,  0.5378,  ...,  0.1590, -0.0666,  0.1668],
          [-0.2287,  0.2053,  0.0397,  ..., -0.5889, -0.6237, -0.7859]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.3285, -0.3978,  0.2009,  ..., -0.7457, -0.7795, -0.0653],
         [-0.3571, -0.4401,  0.3787,  ..., -0.6718, -0.7781, -0.3942],
         [-0.0977, -0.1183,  0.0597,  ..., -0.6665, -0.7467, -0.3108],
         [-0.0237, -0.0085, -0.1475,  ..., -0.4665, -0.5083, -0.2929]],

        [[-0.3982, -0.3618,  0.1609,  ...,  0.0000,  0.0000,  0.0000],
         [-0.3347, -0.5390,  0.3224,  ..., -0.8971, -0.2599, -0.1223],
         [-0.1750, -0.7014,  0.0817,  ..., -0.9457, -0.7292, -0.7752],
         [ 0.0073, -0.7479,  0.0909,  ..., -0.5889, -0.6237, -0.7859]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.5427, -0.1494,  0.0835,  ..., -0.4323,  0.3154,  0.0104],
         [ 0.3821, -0.1283,  0.0078,  ..., -0.4177,  0.3731,  0.2569],
         [ 0.2988, -0.3401,  0.0945,  ..., -0.4620,  0.3590, -0.0046],
         [ 0.0805, -0.4429,  0.0277,  ..., -0.3858,  0.3504, -0.0505]],

        [[ 0.4382, -0.1283,  0.0392,  ..., -0.2787,  0.8452, -0.1179],
         [ 0.5097, -0.2434,  0.0067,  ..., -0.3363,  0.2964,  0.1200],
         [ 0.3319, -0.1292, -0.1944,  ..., -0.4017,  0.2904, -0.0039],
         [ 0.1722, -0.2034, -0.0166,  ..., -0.1948,  0.3134,  0.0544]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-5.6229e-01,        -inf,        -inf,        -inf],
          [ 2.4845e+00,  1.4494e+00,        -inf,        -inf],
          [ 1.9182e+00,  6.3298e-01,  2.2750e+00,        -inf],
          [ 5.9204e-01,  5.6441e+00, -1.5393e+00, -7.1895e-01]],

         [[ 2.3277e-01,        -inf,        -inf,        -inf],
          [ 2.8836e+00,  4.6163e-01,        -inf,        -inf],
          [-5.1991e-01,  3.6551e+00, -3.2834e+00,        -inf],
          [-9.8032e-01, -3.2062e-01, -1.0546e+00, -1.3907e+00]],

         [[ 3.1955e+00,        -inf,        -inf,        -inf],
          [-2.2656e+00,  1.9663e+00,        -inf,        -inf],
          [-1.0852e+00,  1.3300e+00, -4.7951e+00,        -inf],
          [ 1.9207e+00,  1.5192e+00, -1.8861e+00, -1.8704e+00]],

         [[-2.8161e+00,        -inf,        -inf,        -inf],
          [-4.1647e+00, -3.6544e+00,        -inf,        -inf],
          [-3.2402e+00,  7.0465e-01, -6.8171e-01,        -inf],
          [-1.6366e+00,  6.5678e-01,  5.1307e+00, -1.6348e+00]],

         [[-1.3872e+00,        -inf,        -inf,        -inf],
          [ 2.7309e-01, -4.1843e+00,        -inf,        -inf],
          [-1.7619e+00, -1.1587e+00,  4.3354e-01,        -inf],
          [-2.8128e+00, -7.7990e-01,  4.4059e-01, -2.8578e-01]],

         [[-2.1824e+00,        -inf,        -inf,        -inf],
          [ 3.6947e+00, -1.9770e+00,        -inf,        -inf],
          [ 1.0952e+00, -2.1181e+00,  1.2171e+00,        -inf],
          [-5.9043e-01, -3.3601e+00,  1.6118e+00,  2.7446e+00]],

         [[ 8.5687e-01,        -inf,        -inf,        -inf],
          [-1.4657e+00,  2.8190e+00,        -inf,        -inf],
          [ 1.1110e+00,  3.6745e+00,  1.1655e+00,        -inf],
          [ 2.1761e+00,  1.8121e+00,  2.7114e+00, -2.0520e-01]],

         [[ 1.5521e+00,        -inf,        -inf,        -inf],
          [ 7.5746e-01,  1.9430e+00,        -inf,        -inf],
          [-7.6303e-01, -2.2054e+00, -4.5415e-01,        -inf],
          [ 1.7170e+00,  1.4170e+00,  1.3516e+00, -2.0783e+00]],

         [[ 1.2711e+00,        -inf,        -inf,        -inf],
          [-2.8329e+00, -3.6247e-01,        -inf,        -inf],
          [-3.5167e+00,  4.7013e+00, -3.1358e+00,        -inf],
          [-2.1204e+00,  1.8413e+00, -1.5545e+00, -2.3495e+00]],

         [[ 6.1772e-02,        -inf,        -inf,        -inf],
          [ 4.3125e+00,  2.6618e+00,        -inf,        -inf],
          [ 2.3590e+00,  9.4737e-01,  3.3924e+00,        -inf],
          [-5.0847e-01,  1.4494e-01, -2.0970e+00, -9.4866e-01]],

         [[-9.5536e-01,        -inf,        -inf,        -inf],
          [-2.1017e+00,  6.8972e-01,        -inf,        -inf],
          [ 3.7625e+00, -6.7505e-02,  2.3005e+00,        -inf],
          [ 6.2958e-02,  2.2992e+00,  4.7091e+00,  1.9692e-02]],

         [[-4.2866e+00,        -inf,        -inf,        -inf],
          [-4.9944e+00, -4.7806e+00,        -inf,        -inf],
          [ 2.7037e+00,  1.9970e+00, -4.3340e+00,        -inf],
          [-3.7269e+00,  2.0837e+00, -9.7756e+00,  1.9856e+00]],

         [[ 2.0889e+00,        -inf,        -inf,        -inf],
          [ 3.9514e+00,  9.0145e+00,        -inf,        -inf],
          [ 6.7277e+00,  6.1654e+00, -1.7833e+00,        -inf],
          [-5.2805e-01, -1.3460e+00, -3.3787e-01,  1.7877e+00]],

         [[-2.2805e+00,        -inf,        -inf,        -inf],
          [-6.2137e-01, -3.3340e+00,        -inf,        -inf],
          [-6.2847e+00, -4.5765e-01, -2.9174e+00,        -inf],
          [-3.8119e+00,  2.5936e+00, -2.3959e+00,  3.1391e+00]],

         [[-7.4140e+00,        -inf,        -inf,        -inf],
          [-1.6716e+00, -9.6165e-01,        -inf,        -inf],
          [-4.2480e+00, -4.4849e+00,  2.1224e+00,        -inf],
          [ 8.3947e-01, -1.2921e+00,  3.6498e+00,  2.3569e+00]],

         [[ 2.2519e+00,        -inf,        -inf,        -inf],
          [ 2.1459e+00,  7.2826e-01,        -inf,        -inf],
          [ 2.9107e+00,  1.7257e+00,  2.9121e+00,        -inf],
          [-9.4938e-01, -8.4960e-02, -1.3713e+00, -3.4391e+00]],

         [[-2.1615e+00,        -inf,        -inf,        -inf],
          [-1.1544e+00, -4.7499e+00,        -inf,        -inf],
          [-1.5908e+00, -3.3425e+00, -5.7011e+00,        -inf],
          [-3.1266e+00, -1.5635e+00, -8.7273e+00, -1.4281e+00]],

         [[ 7.1173e-01,        -inf,        -inf,        -inf],
          [ 4.2593e+00,  1.5112e+00,        -inf,        -inf],
          [ 1.3738e+00,  2.4080e-01,  1.2202e+00,        -inf],
          [ 5.6461e+00,  1.6417e+00, -4.9679e-02,  6.6823e+00]],

         [[ 2.3763e+00,        -inf,        -inf,        -inf],
          [-1.5935e+00, -2.0034e-01,        -inf,        -inf],
          [-4.0843e+00,  1.5583e+00,  2.1363e+00,        -inf],
          [ 2.8800e+00,  6.3929e-01,  2.6103e+00,  3.8732e+00]],

         [[-2.0400e+00,        -inf,        -inf,        -inf],
          [-9.3927e-01, -3.1999e+00,        -inf,        -inf],
          [ 4.5556e+00, -8.1159e-01,  2.5761e+00,        -inf],
          [-3.4484e-01, -3.5060e+00,  8.2975e-01, -4.6461e+00]],

         [[ 4.5542e-01,        -inf,        -inf,        -inf],
          [ 8.5302e-01,  2.1998e+00,        -inf,        -inf],
          [-3.6265e-01,  3.6418e-01,  1.6495e+00,        -inf],
          [ 3.2401e+00, -1.9241e+00,  3.0024e+00,  4.1838e+00]],

         [[-4.4954e+00,        -inf,        -inf,        -inf],
          [-7.8976e-01, -3.1026e+00,        -inf,        -inf],
          [-5.7401e+00, -8.6194e+00, -4.8912e+00,        -inf],
          [-3.3526e+00, -2.5121e+00, -2.7035e+00, -5.6573e-02]],

         [[-9.3031e-01,        -inf,        -inf,        -inf],
          [ 1.1353e+00, -1.3570e-01,        -inf,        -inf],
          [ 2.5257e+00, -1.6987e+00,  8.2668e-01,        -inf],
          [ 4.2465e+00,  9.4149e-01,  5.0489e+00, -2.4400e+00]],

         [[ 9.4542e-01,        -inf,        -inf,        -inf],
          [ 4.3974e-02,  2.9686e+00,        -inf,        -inf],
          [ 2.2470e+00,  1.1229e+00, -1.2168e+00,        -inf],
          [-1.9043e+00, -1.3267e+00,  5.9218e-01, -1.3177e+00]],

         [[ 8.3165e-01,        -inf,        -inf,        -inf],
          [ 3.2128e+00,  3.1219e+00,        -inf,        -inf],
          [-2.5068e+00,  2.0243e+00, -2.9035e+00,        -inf],
          [-4.7601e+00,  1.3600e+00,  2.4052e+00, -4.2092e+00]]],


        [[[ 3.5402e-01,        -inf,        -inf,        -inf],
          [ 1.7093e+00, -3.7149e-01,        -inf,        -inf],
          [ 3.6943e-01,  2.2203e+00,  1.3934e+00,        -inf],
          [-5.7080e-01, -1.9906e+00, -1.2798e+00,  1.8955e+00]],

         [[ 3.5521e+00,        -inf,        -inf,        -inf],
          [-8.5776e-01, -4.0115e+00,        -inf,        -inf],
          [ 2.4815e-01, -2.9667e+00,  2.1527e-01,        -inf],
          [-4.6353e+00, -4.2165e+00, -6.9419e-01, -5.4423e+00]],

         [[ 3.8103e+00,        -inf,        -inf,        -inf],
          [-1.8794e+00, -2.4922e+00,        -inf,        -inf],
          [-1.2830e+00, -1.1503e+00, -3.0237e+00,        -inf],
          [ 4.7897e-01,  2.8449e-01,  1.0887e+00, -4.0895e-01]],

         [[-6.2328e+00,        -inf,        -inf,        -inf],
          [-4.0022e+00,  7.8127e+00,        -inf,        -inf],
          [-3.0676e+00,  1.4869e+00, -2.6256e+00,        -inf],
          [ 3.5657e-01,  2.4920e+00,  1.1160e+00,  4.3594e+00]],

         [[-5.3422e-01,        -inf,        -inf,        -inf],
          [ 3.4801e+00,  9.8596e-01,        -inf,        -inf],
          [-3.5666e+00,  5.9836e-01, -1.2034e+00,        -inf],
          [-5.8397e+00,  1.1916e-01,  3.8365e+00,  6.1408e-01]],

         [[-2.0977e+00,        -inf,        -inf,        -inf],
          [ 1.1531e+00,  1.9583e+00,        -inf,        -inf],
          [-3.8880e-01, -4.6518e+00, -1.3427e+00,        -inf],
          [ 4.2220e-01, -3.2884e+00,  4.1018e-01, -1.7806e+00]],

         [[ 1.0188e+00,        -inf,        -inf,        -inf],
          [ 3.7183e-01,  3.3628e-01,        -inf,        -inf],
          [ 7.3748e-01,  1.7378e+00,  5.2597e+00,        -inf],
          [ 4.4374e+00,  3.8575e+00,  1.9439e+00,  2.5940e+00]],

         [[ 1.4830e+00,        -inf,        -inf,        -inf],
          [-2.8608e-01,  3.1330e+00,        -inf,        -inf],
          [-4.6793e+00,  1.0883e+00, -4.7096e-01,        -inf],
          [ 4.1576e+00,  1.8475e+00, -9.2093e-01,  3.5462e+00]],

         [[-1.6101e+00,        -inf,        -inf,        -inf],
          [-2.6291e+00,  8.8110e-01,        -inf,        -inf],
          [-1.0404e+00,  7.0855e-01, -1.7274e+00,        -inf],
          [ 1.6164e+00, -2.8681e+00, -2.6457e+00, -3.7182e+00]],

         [[ 2.0056e+00,        -inf,        -inf,        -inf],
          [ 6.9518e-01,  2.7956e+00,        -inf,        -inf],
          [-8.5111e-01,  1.4473e+00,  2.5020e+00,        -inf],
          [ 7.6206e-02, -1.0273e+00, -7.5949e-01,  1.6746e+00]],

         [[-9.9334e-01,        -inf,        -inf,        -inf],
          [ 2.3088e+00,  1.1696e+00,        -inf,        -inf],
          [ 2.7062e+00,  4.1230e+00,  1.1472e+00,        -inf],
          [-3.0535e+00, -3.9944e-02, -1.5073e+00, -3.1472e+00]],

         [[-3.0905e+00,        -inf,        -inf,        -inf],
          [-2.4317e+00, -3.7897e-01,        -inf,        -inf],
          [ 7.6146e-02, -1.6978e-01, -2.7028e+00,        -inf],
          [ 2.7332e+00,  3.7004e+00,  3.6241e-01, -5.4822e-02]],

         [[ 1.9524e+00,        -inf,        -inf,        -inf],
          [ 1.6428e+00,  5.7449e+00,        -inf,        -inf],
          [-1.3828e+00, -2.6751e-02, -2.6697e+00,        -inf],
          [-8.2879e-01, -2.6318e-02, -1.4936e+00,  2.2447e+00]],

         [[-2.7665e-01,        -inf,        -inf,        -inf],
          [-3.2656e+00, -5.2729e-01,        -inf,        -inf],
          [-3.0868e+00,  2.5095e+00, -3.2314e+00,        -inf],
          [ 8.5248e-02, -6.3818e-01,  2.8652e+00,  8.5073e-01]],

         [[-4.2300e+00,        -inf,        -inf,        -inf],
          [-1.8136e-01, -1.6013e+00,        -inf,        -inf],
          [-1.7242e+00,  2.8967e-01, -3.3377e-01,        -inf],
          [-5.1659e-01, -1.2322e+00,  1.5320e+00, -4.9550e+00]],

         [[ 4.8964e+00,        -inf,        -inf,        -inf],
          [ 6.6987e+00, -9.3460e-01,        -inf,        -inf],
          [ 3.2845e+00, -8.0280e-01, -4.8258e+00,        -inf],
          [ 1.9767e+00, -1.9802e+00, -3.4361e+00, -1.9759e+00]],

         [[ 5.3678e-01,        -inf,        -inf,        -inf],
          [ 1.9020e+00, -2.5621e+00,        -inf,        -inf],
          [ 3.4256e-01, -3.1878e+00,  6.4908e-01,        -inf],
          [ 1.6778e+00,  3.8935e+00,  1.3727e-01,  1.2445e+00]],

         [[ 1.1581e-01,        -inf,        -inf,        -inf],
          [ 3.5604e+00,  2.4599e+00,        -inf,        -inf],
          [ 1.0550e+00,  1.8302e+00,  3.5833e+00,        -inf],
          [ 3.4621e+00,  8.4802e-01,  4.0140e+00,  4.8783e+00]],

         [[-2.5743e+00,        -inf,        -inf,        -inf],
          [-2.4529e+00,  1.0291e+00,        -inf,        -inf],
          [-3.9018e+00, -4.5758e-01,  7.5802e-03,        -inf],
          [ 1.3939e+00,  1.7577e+00,  3.0696e-01,  3.4466e+00]],

         [[ 2.4871e+00,        -inf,        -inf,        -inf],
          [-6.4214e-01, -9.7675e-01,        -inf,        -inf],
          [ 7.3700e+00, -1.5693e+00,  2.5706e+00,        -inf],
          [ 4.1841e+00, -1.2708e+00,  2.0054e+00,  3.4525e+00]],

         [[-1.1639e+00,        -inf,        -inf,        -inf],
          [ 1.4352e+00,  1.8521e+00,        -inf,        -inf],
          [ 2.4576e+00,  4.6804e+00,  3.3145e+00,        -inf],
          [-1.2586e+00,  2.0665e+00,  2.6716e+00, -6.8139e-01]],

         [[-1.1361e+00,        -inf,        -inf,        -inf],
          [ 8.2148e-02,  1.3390e+00,        -inf,        -inf],
          [ 9.2963e-01,  1.3585e+00, -8.3501e-01,        -inf],
          [-1.6819e+00,  2.7792e+00,  1.9354e+00, -1.2182e-01]],

         [[-3.3464e-01,        -inf,        -inf,        -inf],
          [ 8.3446e-01, -1.2929e+00,        -inf,        -inf],
          [ 2.1890e+00, -5.0486e-01,  3.6343e+00,        -inf],
          [ 2.7454e+00,  2.0674e+00,  1.8106e+00,  1.8452e+00]],

         [[-4.7210e-01,        -inf,        -inf,        -inf],
          [ 2.1933e+00,  2.1922e+00,        -inf,        -inf],
          [ 3.6786e+00,  4.8000e-01,  7.5852e-02,        -inf],
          [-2.4362e+00, -4.5762e+00,  6.0511e-01, -1.6115e+00]],

         [[ 2.2153e+00,        -inf,        -inf,        -inf],
          [ 1.9019e+00,  9.9415e-01,        -inf,        -inf],
          [-2.7229e+00, -4.5197e+00, -1.4268e+00,        -inf],
          [-5.3899e-01, -9.9169e-01, -1.8738e+00, -5.0873e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-5.6229e-01,        -inf,        -inf,        -inf],
          [ 2.4845e+00,  1.4494e+00,        -inf,        -inf],
          [ 1.9182e+00,  6.3298e-01,  2.2750e+00,        -inf],
          [ 5.9204e-01,  5.6441e+00, -1.5393e+00, -7.1895e-01]],

         [[ 2.3277e-01,        -inf,        -inf,        -inf],
          [ 2.8836e+00,  4.6163e-01,        -inf,        -inf],
          [-5.1991e-01,  3.6551e+00, -3.2834e+00,        -inf],
          [-9.8032e-01, -3.2062e-01, -1.0546e+00, -1.3907e+00]],

         [[ 3.1955e+00,        -inf,        -inf,        -inf],
          [-2.2656e+00,  1.9663e+00,        -inf,        -inf],
          [-1.0852e+00,  1.3300e+00, -4.7951e+00,        -inf],
          [ 1.9207e+00,  1.5192e+00, -1.8861e+00, -1.8704e+00]],

         [[-2.8161e+00,        -inf,        -inf,        -inf],
          [-4.1647e+00, -3.6544e+00,        -inf,        -inf],
          [-3.2402e+00,  7.0465e-01, -6.8171e-01,        -inf],
          [-1.6366e+00,  6.5678e-01,  5.1307e+00, -1.6348e+00]],

         [[-1.3872e+00,        -inf,        -inf,        -inf],
          [ 2.7309e-01, -4.1843e+00,        -inf,        -inf],
          [-1.7619e+00, -1.1587e+00,  4.3354e-01,        -inf],
          [-2.8128e+00, -7.7990e-01,  4.4059e-01, -2.8578e-01]],

         [[-2.1824e+00,        -inf,        -inf,        -inf],
          [ 3.6947e+00, -1.9770e+00,        -inf,        -inf],
          [ 1.0952e+00, -2.1181e+00,  1.2171e+00,        -inf],
          [-5.9043e-01, -3.3601e+00,  1.6118e+00,  2.7446e+00]],

         [[ 8.5687e-01,        -inf,        -inf,        -inf],
          [-1.4657e+00,  2.8190e+00,        -inf,        -inf],
          [ 1.1110e+00,  3.6745e+00,  1.1655e+00,        -inf],
          [ 2.1761e+00,  1.8121e+00,  2.7114e+00, -2.0520e-01]],

         [[ 1.5521e+00,        -inf,        -inf,        -inf],
          [ 7.5746e-01,  1.9430e+00,        -inf,        -inf],
          [-7.6303e-01, -2.2054e+00, -4.5415e-01,        -inf],
          [ 1.7170e+00,  1.4170e+00,  1.3516e+00, -2.0783e+00]],

         [[ 1.2711e+00,        -inf,        -inf,        -inf],
          [-2.8329e+00, -3.6247e-01,        -inf,        -inf],
          [-3.5167e+00,  4.7013e+00, -3.1358e+00,        -inf],
          [-2.1204e+00,  1.8413e+00, -1.5545e+00, -2.3495e+00]],

         [[ 6.1772e-02,        -inf,        -inf,        -inf],
          [ 4.3125e+00,  2.6618e+00,        -inf,        -inf],
          [ 2.3590e+00,  9.4737e-01,  3.3924e+00,        -inf],
          [-5.0847e-01,  1.4494e-01, -2.0970e+00, -9.4866e-01]],

         [[-9.5536e-01,        -inf,        -inf,        -inf],
          [-2.1017e+00,  6.8972e-01,        -inf,        -inf],
          [ 3.7625e+00, -6.7505e-02,  2.3005e+00,        -inf],
          [ 6.2958e-02,  2.2992e+00,  4.7091e+00,  1.9692e-02]],

         [[-4.2866e+00,        -inf,        -inf,        -inf],
          [-4.9944e+00, -4.7806e+00,        -inf,        -inf],
          [ 2.7037e+00,  1.9970e+00, -4.3340e+00,        -inf],
          [-3.7269e+00,  2.0837e+00, -9.7756e+00,  1.9856e+00]],

         [[ 2.0889e+00,        -inf,        -inf,        -inf],
          [ 3.9514e+00,  9.0145e+00,        -inf,        -inf],
          [ 6.7277e+00,  6.1654e+00, -1.7833e+00,        -inf],
          [-5.2805e-01, -1.3460e+00, -3.3787e-01,  1.7877e+00]],

         [[-2.2805e+00,        -inf,        -inf,        -inf],
          [-6.2137e-01, -3.3340e+00,        -inf,        -inf],
          [-6.2847e+00, -4.5765e-01, -2.9174e+00,        -inf],
          [-3.8119e+00,  2.5936e+00, -2.3959e+00,  3.1391e+00]],

         [[-7.4140e+00,        -inf,        -inf,        -inf],
          [-1.6716e+00, -9.6165e-01,        -inf,        -inf],
          [-4.2480e+00, -4.4849e+00,  2.1224e+00,        -inf],
          [ 8.3947e-01, -1.2921e+00,  3.6498e+00,  2.3569e+00]],

         [[ 2.2519e+00,        -inf,        -inf,        -inf],
          [ 2.1459e+00,  7.2826e-01,        -inf,        -inf],
          [ 2.9107e+00,  1.7257e+00,  2.9121e+00,        -inf],
          [-9.4938e-01, -8.4960e-02, -1.3713e+00, -3.4391e+00]],

         [[-2.1615e+00,        -inf,        -inf,        -inf],
          [-1.1544e+00, -4.7499e+00,        -inf,        -inf],
          [-1.5908e+00, -3.3425e+00, -5.7011e+00,        -inf],
          [-3.1266e+00, -1.5635e+00, -8.7273e+00, -1.4281e+00]],

         [[ 7.1173e-01,        -inf,        -inf,        -inf],
          [ 4.2593e+00,  1.5112e+00,        -inf,        -inf],
          [ 1.3738e+00,  2.4080e-01,  1.2202e+00,        -inf],
          [ 5.6461e+00,  1.6417e+00, -4.9679e-02,  6.6823e+00]],

         [[ 2.3763e+00,        -inf,        -inf,        -inf],
          [-1.5935e+00, -2.0034e-01,        -inf,        -inf],
          [-4.0843e+00,  1.5583e+00,  2.1363e+00,        -inf],
          [ 2.8800e+00,  6.3929e-01,  2.6103e+00,  3.8732e+00]],

         [[-2.0400e+00,        -inf,        -inf,        -inf],
          [-9.3927e-01, -3.1999e+00,        -inf,        -inf],
          [ 4.5556e+00, -8.1159e-01,  2.5761e+00,        -inf],
          [-3.4484e-01, -3.5060e+00,  8.2975e-01, -4.6461e+00]],

         [[ 4.5542e-01,        -inf,        -inf,        -inf],
          [ 8.5302e-01,  2.1998e+00,        -inf,        -inf],
          [-3.6265e-01,  3.6418e-01,  1.6495e+00,        -inf],
          [ 3.2401e+00, -1.9241e+00,  3.0024e+00,  4.1838e+00]],

         [[-4.4954e+00,        -inf,        -inf,        -inf],
          [-7.8976e-01, -3.1026e+00,        -inf,        -inf],
          [-5.7401e+00, -8.6194e+00, -4.8912e+00,        -inf],
          [-3.3526e+00, -2.5121e+00, -2.7035e+00, -5.6573e-02]],

         [[-9.3031e-01,        -inf,        -inf,        -inf],
          [ 1.1353e+00, -1.3570e-01,        -inf,        -inf],
          [ 2.5257e+00, -1.6987e+00,  8.2668e-01,        -inf],
          [ 4.2465e+00,  9.4149e-01,  5.0489e+00, -2.4400e+00]],

         [[ 9.4542e-01,        -inf,        -inf,        -inf],
          [ 4.3974e-02,  2.9686e+00,        -inf,        -inf],
          [ 2.2470e+00,  1.1229e+00, -1.2168e+00,        -inf],
          [-1.9043e+00, -1.3267e+00,  5.9218e-01, -1.3177e+00]],

         [[ 8.3165e-01,        -inf,        -inf,        -inf],
          [ 3.2128e+00,  3.1219e+00,        -inf,        -inf],
          [-2.5068e+00,  2.0243e+00, -2.9035e+00,        -inf],
          [-4.7601e+00,  1.3600e+00,  2.4052e+00, -4.2092e+00]]],


        [[[ 3.5402e-01,        -inf,        -inf,        -inf],
          [ 1.7093e+00, -3.7149e-01,        -inf,        -inf],
          [ 3.6943e-01,  2.2203e+00,  1.3934e+00,        -inf],
          [-5.7080e-01, -1.9906e+00, -1.2798e+00,  1.8955e+00]],

         [[ 3.5521e+00,        -inf,        -inf,        -inf],
          [-8.5776e-01, -4.0115e+00,        -inf,        -inf],
          [ 2.4815e-01, -2.9667e+00,  2.1527e-01,        -inf],
          [-4.6353e+00, -4.2165e+00, -6.9419e-01, -5.4423e+00]],

         [[ 3.8103e+00,        -inf,        -inf,        -inf],
          [-1.8794e+00, -2.4922e+00,        -inf,        -inf],
          [-1.2830e+00, -1.1503e+00, -3.0237e+00,        -inf],
          [ 4.7897e-01,  2.8449e-01,  1.0887e+00, -4.0895e-01]],

         [[-6.2328e+00,        -inf,        -inf,        -inf],
          [-4.0022e+00,  7.8127e+00,        -inf,        -inf],
          [-3.0676e+00,  1.4869e+00, -2.6256e+00,        -inf],
          [ 3.5657e-01,  2.4920e+00,  1.1160e+00,  4.3594e+00]],

         [[-5.3422e-01,        -inf,        -inf,        -inf],
          [ 3.4801e+00,  9.8596e-01,        -inf,        -inf],
          [-3.5666e+00,  5.9836e-01, -1.2034e+00,        -inf],
          [-5.8397e+00,  1.1916e-01,  3.8365e+00,  6.1408e-01]],

         [[-2.0977e+00,        -inf,        -inf,        -inf],
          [ 1.1531e+00,  1.9583e+00,        -inf,        -inf],
          [-3.8880e-01, -4.6518e+00, -1.3427e+00,        -inf],
          [ 4.2220e-01, -3.2884e+00,  4.1018e-01, -1.7806e+00]],

         [[ 1.0188e+00,        -inf,        -inf,        -inf],
          [ 3.7183e-01,  3.3628e-01,        -inf,        -inf],
          [ 7.3748e-01,  1.7378e+00,  5.2597e+00,        -inf],
          [ 4.4374e+00,  3.8575e+00,  1.9439e+00,  2.5940e+00]],

         [[ 1.4830e+00,        -inf,        -inf,        -inf],
          [-2.8608e-01,  3.1330e+00,        -inf,        -inf],
          [-4.6793e+00,  1.0883e+00, -4.7096e-01,        -inf],
          [ 4.1576e+00,  1.8475e+00, -9.2093e-01,  3.5462e+00]],

         [[-1.6101e+00,        -inf,        -inf,        -inf],
          [-2.6291e+00,  8.8110e-01,        -inf,        -inf],
          [-1.0404e+00,  7.0855e-01, -1.7274e+00,        -inf],
          [ 1.6164e+00, -2.8681e+00, -2.6457e+00, -3.7182e+00]],

         [[ 2.0056e+00,        -inf,        -inf,        -inf],
          [ 6.9518e-01,  2.7956e+00,        -inf,        -inf],
          [-8.5111e-01,  1.4473e+00,  2.5020e+00,        -inf],
          [ 7.6206e-02, -1.0273e+00, -7.5949e-01,  1.6746e+00]],

         [[-9.9334e-01,        -inf,        -inf,        -inf],
          [ 2.3088e+00,  1.1696e+00,        -inf,        -inf],
          [ 2.7062e+00,  4.1230e+00,  1.1472e+00,        -inf],
          [-3.0535e+00, -3.9944e-02, -1.5073e+00, -3.1472e+00]],

         [[-3.0905e+00,        -inf,        -inf,        -inf],
          [-2.4317e+00, -3.7897e-01,        -inf,        -inf],
          [ 7.6146e-02, -1.6978e-01, -2.7028e+00,        -inf],
          [ 2.7332e+00,  3.7004e+00,  3.6241e-01, -5.4822e-02]],

         [[ 1.9524e+00,        -inf,        -inf,        -inf],
          [ 1.6428e+00,  5.7449e+00,        -inf,        -inf],
          [-1.3828e+00, -2.6751e-02, -2.6697e+00,        -inf],
          [-8.2879e-01, -2.6318e-02, -1.4936e+00,  2.2447e+00]],

         [[-2.7665e-01,        -inf,        -inf,        -inf],
          [-3.2656e+00, -5.2729e-01,        -inf,        -inf],
          [-3.0868e+00,  2.5095e+00, -3.2314e+00,        -inf],
          [ 8.5248e-02, -6.3818e-01,  2.8652e+00,  8.5073e-01]],

         [[-4.2300e+00,        -inf,        -inf,        -inf],
          [-1.8136e-01, -1.6013e+00,        -inf,        -inf],
          [-1.7242e+00,  2.8967e-01, -3.3377e-01,        -inf],
          [-5.1659e-01, -1.2322e+00,  1.5320e+00, -4.9550e+00]],

         [[ 4.8964e+00,        -inf,        -inf,        -inf],
          [ 6.6987e+00, -9.3460e-01,        -inf,        -inf],
          [ 3.2845e+00, -8.0280e-01, -4.8258e+00,        -inf],
          [ 1.9767e+00, -1.9802e+00, -3.4361e+00, -1.9759e+00]],

         [[ 5.3678e-01,        -inf,        -inf,        -inf],
          [ 1.9020e+00, -2.5621e+00,        -inf,        -inf],
          [ 3.4256e-01, -3.1878e+00,  6.4908e-01,        -inf],
          [ 1.6778e+00,  3.8935e+00,  1.3727e-01,  1.2445e+00]],

         [[ 1.1581e-01,        -inf,        -inf,        -inf],
          [ 3.5604e+00,  2.4599e+00,        -inf,        -inf],
          [ 1.0550e+00,  1.8302e+00,  3.5833e+00,        -inf],
          [ 3.4621e+00,  8.4802e-01,  4.0140e+00,  4.8783e+00]],

         [[-2.5743e+00,        -inf,        -inf,        -inf],
          [-2.4529e+00,  1.0291e+00,        -inf,        -inf],
          [-3.9018e+00, -4.5758e-01,  7.5802e-03,        -inf],
          [ 1.3939e+00,  1.7577e+00,  3.0696e-01,  3.4466e+00]],

         [[ 2.4871e+00,        -inf,        -inf,        -inf],
          [-6.4214e-01, -9.7675e-01,        -inf,        -inf],
          [ 7.3700e+00, -1.5693e+00,  2.5706e+00,        -inf],
          [ 4.1841e+00, -1.2708e+00,  2.0054e+00,  3.4525e+00]],

         [[-1.1639e+00,        -inf,        -inf,        -inf],
          [ 1.4352e+00,  1.8521e+00,        -inf,        -inf],
          [ 2.4576e+00,  4.6804e+00,  3.3145e+00,        -inf],
          [-1.2586e+00,  2.0665e+00,  2.6716e+00, -6.8139e-01]],

         [[-1.1361e+00,        -inf,        -inf,        -inf],
          [ 8.2148e-02,  1.3390e+00,        -inf,        -inf],
          [ 9.2963e-01,  1.3585e+00, -8.3501e-01,        -inf],
          [-1.6819e+00,  2.7792e+00,  1.9354e+00, -1.2182e-01]],

         [[-3.3464e-01,        -inf,        -inf,        -inf],
          [ 8.3446e-01, -1.2929e+00,        -inf,        -inf],
          [ 2.1890e+00, -5.0486e-01,  3.6343e+00,        -inf],
          [ 2.7454e+00,  2.0674e+00,  1.8106e+00,  1.8452e+00]],

         [[-4.7210e-01,        -inf,        -inf,        -inf],
          [ 2.1933e+00,  2.1922e+00,        -inf,        -inf],
          [ 3.6786e+00,  4.8000e-01,  7.5852e-02,        -inf],
          [-2.4362e+00, -4.5762e+00,  6.0511e-01, -1.6115e+00]],

         [[ 2.2153e+00,        -inf,        -inf,        -inf],
          [ 1.9019e+00,  9.9415e-01,        -inf,        -inf],
          [-2.7229e+00, -4.5197e+00, -1.4268e+00,        -inf],
          [-5.3899e-01, -9.9169e-01, -1.8738e+00, -5.0873e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.1114e+00,  5.7840e-01,  1.4011e+00,  ..., -1.2341e+00,
           -1.6199e-02, -7.4330e-02],
          [ 5.1680e-01,  7.9469e-01,  9.1051e-01,  ..., -1.8224e-01,
            1.2947e+00,  9.6010e-01],
          [-8.0214e-01, -2.8544e-01, -7.9450e-03,  ...,  3.5386e-01,
           -1.0350e+00, -6.9781e-02],
          ...,
          [ 1.0834e+00,  4.2683e-01, -2.9108e-01,  ..., -5.4742e-01,
            1.0121e+00,  7.9770e-01],
          [-7.4776e-01, -2.2853e-01, -3.9853e-02,  ...,  1.0377e+00,
           -4.6624e-01, -4.6161e-02],
          [-1.3737e-01,  5.3944e-01,  3.6144e-01,  ...,  2.1537e-01,
            4.7913e-02,  2.0232e-02]],

         [[-6.0776e-01,  3.3051e-02,  9.5873e-01,  ..., -8.3914e-01,
            6.7814e-02, -1.3557e-01],
          [ 4.1363e-01,  8.8139e-02,  6.3508e-01,  ...,  2.6061e-01,
            1.1994e+00,  8.7702e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [-3.0464e-01,  2.0973e-01, -5.0324e-01,  ...,  3.1925e-02,
            1.7127e-01, -7.7289e-02],
          [ 2.1866e-01, -2.7783e-01,  2.5463e-01,  ...,  7.3769e-02,
           -3.9869e-01,  3.7890e-01],
          [-4.2939e-02, -1.0381e-01,  2.3213e-01,  ..., -8.8235e-02,
           -4.4670e-02, -4.5649e-01]],

         [[-4.5766e-01, -3.8014e-01,  9.8556e-01,  ..., -5.1805e-01,
            2.5698e-01, -1.6761e-01],
          [ 3.4130e-01,  1.8121e-01,  3.9865e-01,  ..., -4.7424e-02,
            4.4415e-01,  4.9890e-01],
          [-4.4077e-01, -7.1128e-01, -8.6817e-01,  ...,  1.0825e-01,
           -5.0371e-01, -2.7337e-02],
          ...,
          [ 2.9994e-01,  1.3739e-01, -4.8936e-01,  ..., -4.2045e-01,
            5.8833e-01,  1.8998e-01],
          [-4.9568e-02, -1.2755e-01,  2.6249e-01,  ...,  5.3960e-01,
           -5.9329e-01,  2.8998e-01],
          [-3.1364e-01, -9.0900e-02,  3.5236e-02,  ..., -3.7221e-01,
            1.2359e-01, -4.1011e-01]],

         [[-3.3554e-01, -3.8375e-01,  6.7076e-01,  ..., -2.9097e-01,
            2.5470e-01, -2.4334e-01],
          [ 3.2395e-01, -1.0822e-01,  5.5640e-01,  ...,  4.8847e-01,
            7.8464e-01,  8.4835e-01],
          [-2.2287e-01, -4.5985e-01, -7.4380e-01,  ...,  8.5191e-02,
           -7.2022e-01, -1.3787e-02],
          ...,
          [ 7.7214e-02,  8.2647e-03, -3.5197e-01,  ..., -4.3737e-01,
            4.9607e-01,  1.8588e-01],
          [ 3.4068e-02, -1.6504e-01,  1.1823e-01,  ...,  3.4763e-01,
           -3.4222e-01,  1.5235e-01],
          [-4.2701e-01,  8.4053e-02,  4.8366e-02,  ..., -3.2328e-01,
            2.4583e-01, -3.8162e-02]]],


        [[[-9.4015e-01,  2.1640e-01,  1.1419e+00,  ..., -3.4301e-01,
           -6.3515e-04, -2.2859e-01],
          [ 6.7854e-01,  6.2465e-01,  1.1515e+00,  ...,  1.0035e-01,
            1.2999e+00,  8.8547e-01],
          [-4.3629e-01,  9.2772e-02,  2.0220e-01,  ...,  2.4223e-01,
           -1.4004e-01, -2.2329e-01],
          ...,
          [ 2.4769e-01,  4.0702e-01, -6.7378e-01,  ..., -3.4154e-01,
            7.1527e-01,  9.1159e-02],
          [-3.1408e-01, -2.9680e-01,  6.1509e-01,  ...,  8.4414e-01,
           -9.5933e-01,  7.9286e-01],
          [-8.4661e-01, -6.4338e-02, -1.3815e-01,  ...,  2.2589e-01,
            6.0751e-01, -3.7426e-01]],

         [[-1.0983e+00,  1.2873e-01,  7.3503e-01,  ..., -3.6259e-01,
            3.4602e-02, -2.4166e-01],
          [ 3.1562e-01,  1.8197e-01,  8.4993e-01,  ...,  3.9266e-01,
            8.0652e-01,  1.0204e+00],
          [-4.4555e-01,  2.2462e-02, -4.6962e-01,  ...,  2.6364e-01,
            2.2485e-02, -3.3114e-01],
          ...,
          [-1.1960e-01,  3.9382e-01, -9.1570e-01,  ..., -1.2641e-01,
            6.6353e-01, -4.1580e-02],
          [-2.5407e-01, -4.0874e-01,  6.1441e-01,  ...,  7.5183e-01,
           -5.4933e-01,  7.5966e-01],
          [-8.9375e-01,  2.4372e-02, -3.0073e-01,  ..., -2.2805e-01,
           -1.2770e-01, -4.0249e-01]],

         [[-8.3414e-01, -1.5676e-01,  5.8902e-01,  ..., -2.7703e-01,
            5.3412e-01, -2.3587e-01],
          [ 4.3217e-01, -1.4092e-01,  7.6109e-01,  ...,  3.9277e-01,
            5.3279e-01,  7.0974e-01],
          [-1.6418e-01, -1.9261e-02, -4.3064e-01,  ...,  1.0334e-01,
            7.1340e-02, -1.6130e-01],
          ...,
          [-4.5528e-01,  2.7970e-01, -9.2073e-01,  ..., -5.7825e-02,
            6.6032e-01, -1.4289e-01],
          [-2.0476e-01, -3.1511e-01,  6.8345e-01,  ...,  6.7323e-01,
           -6.3822e-01,  8.4739e-01],
          [-5.3879e-01,  1.1601e-02, -1.7611e-01,  ..., -1.2185e-01,
           -5.1227e-02, -2.4239e-01]],

         [[-4.4267e-01, -3.5686e-01,  2.7983e-01,  ..., -6.3554e-01,
            4.4038e-01, -5.4623e-01],
          [ 3.1916e-01, -2.1707e-01,  5.6023e-01,  ...,  3.5211e-01,
            3.2510e-01,  5.4039e-01],
          [-3.2481e-01, -2.1205e-02, -6.9401e-01,  ...,  1.9489e-01,
           -3.4546e-01,  6.5919e-02],
          ...,
          [-3.3661e-01,  2.2314e-01, -7.5647e-01,  ..., -1.8899e-01,
            4.5690e-01, -9.0849e-02],
          [-1.5127e-02, -3.6907e-01,  6.9366e-01,  ...,  5.6518e-01,
           -4.8322e-01,  9.8578e-01],
          [-9.9623e-01,  3.3952e-01, -1.9867e-01,  ...,  1.6626e-01,
            1.3470e-01, -4.0182e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.1114,  0.5784,  1.4011,  ...,  0.2154,  0.0479,  0.0202],
         [-0.6078,  0.0331,  0.9587,  ..., -0.0882, -0.0447, -0.4565],
         [-0.4577, -0.3801,  0.9856,  ..., -0.3722,  0.1236, -0.4101],
         [-0.3355, -0.3838,  0.6708,  ..., -0.3233,  0.2458, -0.0382]],

        [[-0.9402,  0.2164,  1.1419,  ...,  0.2259,  0.6075, -0.3743],
         [-1.0983,  0.1287,  0.7350,  ..., -0.2280, -0.1277, -0.4025],
         [-0.8341, -0.1568,  0.5890,  ..., -0.1219, -0.0512, -0.2424],
         [-0.4427, -0.3569,  0.2798,  ...,  0.1663,  0.1347, -0.4018]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.0811, -0.8946, -0.5506,  ..., -0.3970, -0.6809,  0.0057],
         [-0.1119, -0.5545, -0.2308,  ..., -0.4438, -0.4404, -0.2629],
         [-0.0735, -0.3176, -0.0516,  ..., -0.0312, -0.3534, -0.1764],
         [ 0.0746, -0.3028, -0.0558,  ..., -0.1573, -0.3330,  0.0850]],

        [[-0.0439, -0.6887, -0.3541,  ..., -0.0734, -0.1901, -0.0858],
         [ 0.2130, -0.5044, -0.0050,  ..., -0.0301,  0.1785,  0.1441],
         [ 0.3190, -0.3017, -0.0044,  ..., -0.0994,  0.3414, -0.0139],
         [ 0.3509, -0.2329,  0.1551,  ..., -0.1040,  0.0391, -0.1402]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-5.1044e-01,        -inf,        -inf,        -inf],
          [-1.2772e+00,  3.8117e+00,        -inf,        -inf],
          [ 2.2487e+00,  5.1461e+00,  3.6396e+00,        -inf],
          [ 2.6740e+00,  3.5031e+00,  7.6693e+00, -2.0244e+00]],

         [[ 3.8048e-01,        -inf,        -inf,        -inf],
          [ 2.9395e+00,  1.9346e+00,        -inf,        -inf],
          [ 3.8227e-01, -2.6654e+00,  1.6020e+00,        -inf],
          [-2.9580e+00, -3.1065e+00,  2.9771e+00,  3.0238e+00]],

         [[ 2.9184e+00,        -inf,        -inf,        -inf],
          [ 1.7573e+00, -2.3663e+00,        -inf,        -inf],
          [ 7.3022e-01, -1.4303e+00, -2.0993e+00,        -inf],
          [ 4.6523e+00,  8.8697e-01,  9.2163e-01, -1.3936e-01]],

         [[-1.9533e+00,        -inf,        -inf,        -inf],
          [ 1.6445e+00,  9.8914e-01,        -inf,        -inf],
          [ 3.8083e+00,  2.1075e+00,  4.0119e+00,        -inf],
          [ 1.8582e+00,  1.2750e+00,  3.1222e-01, -1.7893e+00]],

         [[ 1.5720e-01,        -inf,        -inf,        -inf],
          [ 5.2596e-01, -1.3715e-01,        -inf,        -inf],
          [-5.7668e-01, -9.1329e-01,  2.9968e+00,        -inf],
          [-1.6234e+00, -1.7574e-01,  2.7688e-01, -1.9195e+00]],

         [[-2.9718e+00,        -inf,        -inf,        -inf],
          [-7.1112e+00, -6.3582e+00,        -inf,        -inf],
          [-4.0122e-01, -5.9511e+00, -1.0993e+00,        -inf],
          [-3.7433e+00, -3.6045e+00, -4.8572e-01, -1.9644e+00]],

         [[-2.1165e-01,        -inf,        -inf,        -inf],
          [ 1.0618e+00,  6.4381e+00,        -inf,        -inf],
          [-3.2195e-01,  6.4069e+00,  2.8175e+00,        -inf],
          [ 1.6396e+00,  6.7739e+00, -6.5574e-01,  4.4254e+00]],

         [[ 8.3580e-01,        -inf,        -inf,        -inf],
          [ 2.2652e+00, -4.0708e+00,        -inf,        -inf],
          [-2.6680e+00, -3.6703e+00, -3.2770e+00,        -inf],
          [ 7.2624e-01, -4.8005e-01, -4.5407e+00, -2.5793e-01]],

         [[-3.3871e+00,        -inf,        -inf,        -inf],
          [-2.8064e+00,  3.9668e-01,        -inf,        -inf],
          [ 5.5980e-02,  2.8583e+00,  1.4094e+00,        -inf],
          [-3.7108e+00, -3.2342e+00, -2.6570e+00, -1.3003e+00]],

         [[-4.8879e-01,        -inf,        -inf,        -inf],
          [-1.4123e+00, -1.0906e-01,        -inf,        -inf],
          [-1.5166e+00, -2.7194e+00,  1.9107e+00,        -inf],
          [-3.3464e+00, -1.2388e+00, -4.1943e-01, -5.4547e-01]],

         [[ 1.3965e+00,        -inf,        -inf,        -inf],
          [ 3.1827e-02,  2.0139e+00,        -inf,        -inf],
          [ 6.9537e+00,  6.7060e+00,  8.1833e+00,        -inf],
          [ 1.9162e+00,  5.4923e-01, -9.4203e-02, -1.0115e+00]],

         [[-4.0731e+00,        -inf,        -inf,        -inf],
          [-2.1536e+00, -5.6033e-01,        -inf,        -inf],
          [-3.7238e+00, -5.4569e+00, -2.1783e-01,        -inf],
          [-7.6281e-01, -5.6447e-01,  3.4785e+00, -1.7680e-01]],

         [[-4.0354e+00,        -inf,        -inf,        -inf],
          [ 3.5388e-04, -2.6027e+00,        -inf,        -inf],
          [ 2.7496e+00,  2.6400e+00, -2.3946e+00,        -inf],
          [-4.5849e+00, -3.2730e+00,  9.0954e-02,  1.7798e+00]],

         [[-8.0270e-01,        -inf,        -inf,        -inf],
          [ 4.6844e+00,  2.6198e+00,        -inf,        -inf],
          [-1.4346e-01, -2.0846e+00, -1.6554e+00,        -inf],
          [-1.7444e+00, -1.4406e+00, -5.9838e-01,  6.5588e-01]],

         [[-3.4136e+00,        -inf,        -inf,        -inf],
          [-9.8745e-01, -3.0937e+00,        -inf,        -inf],
          [-2.1528e+00,  6.7720e-01, -1.0110e+00,        -inf],
          [-6.7210e+00, -3.6418e+00, -3.5483e+00, -8.3404e+00]],

         [[-1.9801e+00,        -inf,        -inf,        -inf],
          [ 2.2796e-01,  4.7728e+00,        -inf,        -inf],
          [-2.4001e+00,  6.9802e-01,  3.3870e+00,        -inf],
          [-1.0279e+00, -8.8742e-02,  6.2746e-01,  8.8584e-01]],

         [[ 3.3955e+00,        -inf,        -inf,        -inf],
          [ 3.3669e+00,  1.3911e+00,        -inf,        -inf],
          [ 3.5055e+00,  4.7573e+00,  2.6339e+00,        -inf],
          [ 2.3871e+00,  4.7609e-01,  2.4655e+00, -5.7768e-01]],

         [[ 3.4368e+00,        -inf,        -inf,        -inf],
          [ 4.0545e+00,  2.0168e+00,        -inf,        -inf],
          [-7.8933e-01,  1.1527e-01,  1.0844e+00,        -inf],
          [ 3.0902e+00, -2.4709e+00,  2.3271e+00,  1.0623e+00]],

         [[-1.8884e+00,        -inf,        -inf,        -inf],
          [ 2.3814e+00,  2.0378e+00,        -inf,        -inf],
          [ 3.6098e+00,  5.0821e+00,  2.7849e+00,        -inf],
          [-5.1378e+00, -3.6556e-01,  1.2167e+00, -6.3228e-01]],

         [[ 8.7447e-01,        -inf,        -inf,        -inf],
          [ 1.2664e+00, -1.2923e-01,        -inf,        -inf],
          [ 1.8698e+00,  4.9126e-01,  2.3556e+00,        -inf],
          [-1.2573e+00,  1.6975e+00,  1.8530e-01, -2.2316e+00]],

         [[-1.7608e+00,        -inf,        -inf,        -inf],
          [-2.4364e-01,  1.9080e+00,        -inf,        -inf],
          [ 1.0823e+00,  1.1476e+00, -1.2266e+00,        -inf],
          [-5.1477e-01,  1.9158e+00,  8.3217e-01,  1.8101e+00]],

         [[-1.9920e+00,        -inf,        -inf,        -inf],
          [ 1.3964e+00, -3.1198e+00,        -inf,        -inf],
          [ 4.3389e+00, -3.1392e+00, -1.7620e+00,        -inf],
          [ 8.2400e-01, -3.0527e+00, -8.4873e-02,  2.4759e-01]],

         [[ 1.5910e+00,        -inf,        -inf,        -inf],
          [ 5.4038e+00,  1.9099e+00,        -inf,        -inf],
          [ 7.7854e-01, -8.0281e-01, -1.8506e+00,        -inf],
          [ 7.9898e-01,  2.7746e+00,  1.8671e+00, -9.9338e-01]],

         [[-9.3843e-01,        -inf,        -inf,        -inf],
          [ 1.4953e+00, -4.6164e+00,        -inf,        -inf],
          [ 6.5471e-01, -9.5294e-01,  4.4345e+00,        -inf],
          [ 2.0294e+00, -2.9241e+00,  1.9261e+00,  3.5577e+00]],

         [[-7.4768e-01,        -inf,        -inf,        -inf],
          [ 1.9686e+00, -1.6624e+00,        -inf,        -inf],
          [-9.3714e-01, -1.0702e+00,  8.5238e-01,        -inf],
          [ 9.6883e-01, -4.5301e+00,  1.3280e+00,  2.8680e+00]]],


        [[[ 1.4833e+00,        -inf,        -inf,        -inf],
          [ 2.8031e+00,  2.6299e+00,        -inf,        -inf],
          [ 1.4199e+00,  5.2537e-01, -3.7883e+00,        -inf],
          [ 1.8446e+00, -9.7235e-01,  1.4064e+00, -1.2317e+00]],

         [[ 7.2129e-01,        -inf,        -inf,        -inf],
          [ 4.1286e+00, -5.5620e-01,        -inf,        -inf],
          [-9.9359e-01, -3.6052e+00,  8.6606e-01,        -inf],
          [-6.4783e-01, -2.1134e+00,  5.5996e+00,  1.4960e+00]],

         [[ 2.8925e-03,        -inf,        -inf,        -inf],
          [ 1.2002e+00,  1.2472e+00,        -inf,        -inf],
          [ 1.0773e+00,  1.2320e+00,  1.2704e+00,        -inf],
          [ 1.9216e+00,  8.9154e-01,  6.2153e-01, -9.9695e-01]],

         [[-5.8713e-01,        -inf,        -inf,        -inf],
          [ 2.8677e+00,  3.6659e+00,        -inf,        -inf],
          [ 4.0592e+00,  3.5218e+00,  2.8362e+00,        -inf],
          [-2.1546e+00,  2.1153e+00,  1.0828e+00,  7.9598e-01]],

         [[-3.7026e-01,        -inf,        -inf,        -inf],
          [ 1.5510e-01,  1.8763e+00,        -inf,        -inf],
          [ 5.9879e-01, -7.1820e-01,  9.7809e-01,        -inf],
          [ 2.4037e+00,  2.7758e+00, -1.1383e+00,  1.1302e+00]],

         [[-8.3863e-02,        -inf,        -inf,        -inf],
          [-4.1965e+00, -1.5018e+00,        -inf,        -inf],
          [-1.3108e+00, -1.3035e+00, -9.2313e-03,        -inf],
          [-4.3566e-01,  1.0791e-01,  2.8210e+00, -1.3371e+00]],

         [[-7.6247e-01,        -inf,        -inf,        -inf],
          [-4.1991e+00,  1.1718e+00,        -inf,        -inf],
          [-3.5187e+00,  5.0517e+00,  4.7987e+00,        -inf],
          [-3.3839e+00, -1.1219e+00, -1.5402e+00, -1.9286e+00]],

         [[ 1.2156e-01,        -inf,        -inf,        -inf],
          [-1.6873e+00, -3.1927e+00,        -inf,        -inf],
          [-1.1595e+00, -4.1941e+00, -4.9237e+00,        -inf],
          [ 2.5178e+00, -3.8143e-01, -5.2436e+00,  1.5397e+00]],

         [[-4.3952e+00,        -inf,        -inf,        -inf],
          [-2.2929e+00,  2.5718e+00,        -inf,        -inf],
          [ 7.2220e-01, -1.7275e+00,  5.4752e+00,        -inf],
          [-5.3115e+00,  2.7396e+00,  2.1571e+00,  6.1611e-01]],

         [[ 4.3054e-01,        -inf,        -inf,        -inf],
          [-8.8925e-01,  1.7656e+00,        -inf,        -inf],
          [ 5.9929e-01,  2.0345e-01, -4.6960e+00,        -inf],
          [-2.7677e+00, -3.9079e-01, -4.3203e+00, -2.9428e+00]],

         [[ 5.3564e+00,        -inf,        -inf,        -inf],
          [ 1.2864e+00, -9.3087e-01,        -inf,        -inf],
          [-4.4605e-01, -2.5344e+00, -2.2087e-02,        -inf],
          [ 1.9490e+00, -3.1826e+00, -8.7479e-01, -1.5319e+00]],

         [[-3.6700e+00,        -inf,        -inf,        -inf],
          [-2.3464e-01,  1.1897e+00,        -inf,        -inf],
          [ 5.2827e-01, -1.8332e+00, -2.2713e+00,        -inf],
          [-8.0092e-02,  1.3199e+00,  4.1668e+00, -1.0998e+00]],

         [[ 5.4171e-01,        -inf,        -inf,        -inf],
          [ 3.1284e-01,  1.2425e-01,        -inf,        -inf],
          [ 3.8095e-01, -1.0591e+00, -2.2563e+00,        -inf],
          [-3.3120e-01, -1.2404e+00, -4.5104e-03, -4.2055e+00]],

         [[-7.8147e-01,        -inf,        -inf,        -inf],
          [ 8.0888e-01,  1.1605e+00,        -inf,        -inf],
          [-5.3378e-01, -2.5719e+00, -1.4886e+00,        -inf],
          [ 2.7858e+00,  4.3601e+00, -1.6490e+00,  1.4727e+00]],

         [[-3.8806e-01,        -inf,        -inf,        -inf],
          [-4.0420e-01,  1.3771e+00,        -inf,        -inf],
          [-2.4308e+00,  2.6703e+00,  1.4691e+00,        -inf],
          [-2.9350e+00,  3.5193e+00,  1.3092e+00, -5.6233e+00]],

         [[-3.6061e+00,        -inf,        -inf,        -inf],
          [-7.5764e+00,  1.0402e+00,        -inf,        -inf],
          [-3.6024e+00, -3.7301e+00, -1.1344e+00,        -inf],
          [-3.4895e-01, -1.1372e+00, -3.8214e+00, -9.9142e-01]],

         [[ 4.2909e+00,        -inf,        -inf,        -inf],
          [ 1.5290e+00, -3.4141e-01,        -inf,        -inf],
          [ 2.0408e+00,  2.1342e+00,  5.8985e-01,        -inf],
          [ 2.0596e+00,  2.0849e+00,  6.6173e+00,  5.1722e+00]],

         [[ 4.9057e+00,        -inf,        -inf,        -inf],
          [ 7.0534e+00,  4.7338e+00,        -inf,        -inf],
          [-4.2974e+00,  1.9959e-01, -1.8281e+00,        -inf],
          [ 1.8186e+00, -2.3228e+00,  1.8709e+00,  4.0171e-01]],

         [[-3.9752e+00,        -inf,        -inf,        -inf],
          [-1.9088e+00,  7.4429e-01,        -inf,        -inf],
          [ 3.5321e+00,  1.6851e+00,  4.0645e+00,        -inf],
          [-4.0165e+00, -1.1863e+00,  5.0813e+00,  8.3309e+00]],

         [[-1.5514e+00,        -inf,        -inf,        -inf],
          [ 2.0204e+00,  2.1505e-01,        -inf,        -inf],
          [ 1.0199e+00, -2.3433e+00,  2.0918e+00,        -inf],
          [ 1.0934e+00,  4.1798e+00,  1.9878e+00,  2.9206e+00]],

         [[ 5.3090e-01,        -inf,        -inf,        -inf],
          [ 1.3025e+00, -3.1184e-01,        -inf,        -inf],
          [-1.3979e+00,  1.3865e+00, -5.1165e-01,        -inf],
          [-3.0769e+00, -3.0373e+00, -9.0732e-01, -2.0183e+00]],

         [[-2.4535e+00,        -inf,        -inf,        -inf],
          [ 1.6051e+00, -3.2377e+00,        -inf,        -inf],
          [ 4.2103e+00, -1.7815e+00, -8.4885e-01,        -inf],
          [ 3.6898e+00,  1.9391e+00,  4.1529e+00,  5.4002e+00]],

         [[ 3.7969e+00,        -inf,        -inf,        -inf],
          [ 9.6486e-01, -1.6443e-02,        -inf,        -inf],
          [-3.2322e+00, -2.5060e+00, -1.2968e+00,        -inf],
          [-7.0821e-01, -1.4342e+00,  3.2359e+00,  1.2163e+00]],

         [[-1.5196e-01,        -inf,        -inf,        -inf],
          [-6.3267e-01, -2.9357e+00,        -inf,        -inf],
          [-4.2679e+00,  3.2352e-01, -9.5655e-01,        -inf],
          [-1.2470e+00,  1.2587e+00,  4.3737e+00,  3.8848e+00]],

         [[-8.1521e-01,        -inf,        -inf,        -inf],
          [-3.3969e+00, -1.2519e+00,        -inf,        -inf],
          [-5.5964e-01, -1.5618e+00,  2.1038e+00,        -inf],
          [-3.4603e-02, -1.0830e+00,  2.2270e+00,  4.0274e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-5.1044e-01,        -inf,        -inf,        -inf],
          [-1.2772e+00,  3.8117e+00,        -inf,        -inf],
          [ 2.2487e+00,  5.1461e+00,  3.6396e+00,        -inf],
          [ 2.6740e+00,  3.5031e+00,  7.6693e+00, -2.0244e+00]],

         [[ 3.8048e-01,        -inf,        -inf,        -inf],
          [ 2.9395e+00,  1.9346e+00,        -inf,        -inf],
          [ 3.8227e-01, -2.6654e+00,  1.6020e+00,        -inf],
          [-2.9580e+00, -3.1065e+00,  2.9771e+00,  3.0238e+00]],

         [[ 2.9184e+00,        -inf,        -inf,        -inf],
          [ 1.7573e+00, -2.3663e+00,        -inf,        -inf],
          [ 7.3022e-01, -1.4303e+00, -2.0993e+00,        -inf],
          [ 4.6523e+00,  8.8697e-01,  9.2163e-01, -1.3936e-01]],

         [[-1.9533e+00,        -inf,        -inf,        -inf],
          [ 1.6445e+00,  9.8914e-01,        -inf,        -inf],
          [ 3.8083e+00,  2.1075e+00,  4.0119e+00,        -inf],
          [ 1.8582e+00,  1.2750e+00,  3.1222e-01, -1.7893e+00]],

         [[ 1.5720e-01,        -inf,        -inf,        -inf],
          [ 5.2596e-01, -1.3715e-01,        -inf,        -inf],
          [-5.7668e-01, -9.1329e-01,  2.9968e+00,        -inf],
          [-1.6234e+00, -1.7574e-01,  2.7688e-01, -1.9195e+00]],

         [[-2.9718e+00,        -inf,        -inf,        -inf],
          [-7.1112e+00, -6.3582e+00,        -inf,        -inf],
          [-4.0122e-01, -5.9511e+00, -1.0993e+00,        -inf],
          [-3.7433e+00, -3.6045e+00, -4.8572e-01, -1.9644e+00]],

         [[-2.1165e-01,        -inf,        -inf,        -inf],
          [ 1.0618e+00,  6.4381e+00,        -inf,        -inf],
          [-3.2195e-01,  6.4069e+00,  2.8175e+00,        -inf],
          [ 1.6396e+00,  6.7739e+00, -6.5574e-01,  4.4254e+00]],

         [[ 8.3580e-01,        -inf,        -inf,        -inf],
          [ 2.2652e+00, -4.0708e+00,        -inf,        -inf],
          [-2.6680e+00, -3.6703e+00, -3.2770e+00,        -inf],
          [ 7.2624e-01, -4.8005e-01, -4.5407e+00, -2.5793e-01]],

         [[-3.3871e+00,        -inf,        -inf,        -inf],
          [-2.8064e+00,  3.9668e-01,        -inf,        -inf],
          [ 5.5980e-02,  2.8583e+00,  1.4094e+00,        -inf],
          [-3.7108e+00, -3.2342e+00, -2.6570e+00, -1.3003e+00]],

         [[-4.8879e-01,        -inf,        -inf,        -inf],
          [-1.4123e+00, -1.0906e-01,        -inf,        -inf],
          [-1.5166e+00, -2.7194e+00,  1.9107e+00,        -inf],
          [-3.3464e+00, -1.2388e+00, -4.1943e-01, -5.4547e-01]],

         [[ 1.3965e+00,        -inf,        -inf,        -inf],
          [ 3.1827e-02,  2.0139e+00,        -inf,        -inf],
          [ 6.9537e+00,  6.7060e+00,  8.1833e+00,        -inf],
          [ 1.9162e+00,  5.4923e-01, -9.4203e-02, -1.0115e+00]],

         [[-4.0731e+00,        -inf,        -inf,        -inf],
          [-2.1536e+00, -5.6033e-01,        -inf,        -inf],
          [-3.7238e+00, -5.4569e+00, -2.1783e-01,        -inf],
          [-7.6281e-01, -5.6447e-01,  3.4785e+00, -1.7680e-01]],

         [[-4.0354e+00,        -inf,        -inf,        -inf],
          [ 3.5388e-04, -2.6027e+00,        -inf,        -inf],
          [ 2.7496e+00,  2.6400e+00, -2.3946e+00,        -inf],
          [-4.5849e+00, -3.2730e+00,  9.0954e-02,  1.7798e+00]],

         [[-8.0270e-01,        -inf,        -inf,        -inf],
          [ 4.6844e+00,  2.6198e+00,        -inf,        -inf],
          [-1.4346e-01, -2.0846e+00, -1.6554e+00,        -inf],
          [-1.7444e+00, -1.4406e+00, -5.9838e-01,  6.5588e-01]],

         [[-3.4136e+00,        -inf,        -inf,        -inf],
          [-9.8745e-01, -3.0937e+00,        -inf,        -inf],
          [-2.1528e+00,  6.7720e-01, -1.0110e+00,        -inf],
          [-6.7210e+00, -3.6418e+00, -3.5483e+00, -8.3404e+00]],

         [[-1.9801e+00,        -inf,        -inf,        -inf],
          [ 2.2796e-01,  4.7728e+00,        -inf,        -inf],
          [-2.4001e+00,  6.9802e-01,  3.3870e+00,        -inf],
          [-1.0279e+00, -8.8742e-02,  6.2746e-01,  8.8584e-01]],

         [[ 3.3955e+00,        -inf,        -inf,        -inf],
          [ 3.3669e+00,  1.3911e+00,        -inf,        -inf],
          [ 3.5055e+00,  4.7573e+00,  2.6339e+00,        -inf],
          [ 2.3871e+00,  4.7609e-01,  2.4655e+00, -5.7768e-01]],

         [[ 3.4368e+00,        -inf,        -inf,        -inf],
          [ 4.0545e+00,  2.0168e+00,        -inf,        -inf],
          [-7.8933e-01,  1.1527e-01,  1.0844e+00,        -inf],
          [ 3.0902e+00, -2.4709e+00,  2.3271e+00,  1.0623e+00]],

         [[-1.8884e+00,        -inf,        -inf,        -inf],
          [ 2.3814e+00,  2.0378e+00,        -inf,        -inf],
          [ 3.6098e+00,  5.0821e+00,  2.7849e+00,        -inf],
          [-5.1378e+00, -3.6556e-01,  1.2167e+00, -6.3228e-01]],

         [[ 8.7447e-01,        -inf,        -inf,        -inf],
          [ 1.2664e+00, -1.2923e-01,        -inf,        -inf],
          [ 1.8698e+00,  4.9126e-01,  2.3556e+00,        -inf],
          [-1.2573e+00,  1.6975e+00,  1.8530e-01, -2.2316e+00]],

         [[-1.7608e+00,        -inf,        -inf,        -inf],
          [-2.4364e-01,  1.9080e+00,        -inf,        -inf],
          [ 1.0823e+00,  1.1476e+00, -1.2266e+00,        -inf],
          [-5.1477e-01,  1.9158e+00,  8.3217e-01,  1.8101e+00]],

         [[-1.9920e+00,        -inf,        -inf,        -inf],
          [ 1.3964e+00, -3.1198e+00,        -inf,        -inf],
          [ 4.3389e+00, -3.1392e+00, -1.7620e+00,        -inf],
          [ 8.2400e-01, -3.0527e+00, -8.4873e-02,  2.4759e-01]],

         [[ 1.5910e+00,        -inf,        -inf,        -inf],
          [ 5.4038e+00,  1.9099e+00,        -inf,        -inf],
          [ 7.7854e-01, -8.0281e-01, -1.8506e+00,        -inf],
          [ 7.9898e-01,  2.7746e+00,  1.8671e+00, -9.9338e-01]],

         [[-9.3843e-01,        -inf,        -inf,        -inf],
          [ 1.4953e+00, -4.6164e+00,        -inf,        -inf],
          [ 6.5471e-01, -9.5294e-01,  4.4345e+00,        -inf],
          [ 2.0294e+00, -2.9241e+00,  1.9261e+00,  3.5577e+00]],

         [[-7.4768e-01,        -inf,        -inf,        -inf],
          [ 1.9686e+00, -1.6624e+00,        -inf,        -inf],
          [-9.3714e-01, -1.0702e+00,  8.5238e-01,        -inf],
          [ 9.6883e-01, -4.5301e+00,  1.3280e+00,  2.8680e+00]]],


        [[[ 1.4833e+00,        -inf,        -inf,        -inf],
          [ 2.8031e+00,  2.6299e+00,        -inf,        -inf],
          [ 1.4199e+00,  5.2537e-01, -3.7883e+00,        -inf],
          [ 1.8446e+00, -9.7235e-01,  1.4064e+00, -1.2317e+00]],

         [[ 7.2129e-01,        -inf,        -inf,        -inf],
          [ 4.1286e+00, -5.5620e-01,        -inf,        -inf],
          [-9.9359e-01, -3.6052e+00,  8.6606e-01,        -inf],
          [-6.4783e-01, -2.1134e+00,  5.5996e+00,  1.4960e+00]],

         [[ 2.8925e-03,        -inf,        -inf,        -inf],
          [ 1.2002e+00,  1.2472e+00,        -inf,        -inf],
          [ 1.0773e+00,  1.2320e+00,  1.2704e+00,        -inf],
          [ 1.9216e+00,  8.9154e-01,  6.2153e-01, -9.9695e-01]],

         [[-5.8713e-01,        -inf,        -inf,        -inf],
          [ 2.8677e+00,  3.6659e+00,        -inf,        -inf],
          [ 4.0592e+00,  3.5218e+00,  2.8362e+00,        -inf],
          [-2.1546e+00,  2.1153e+00,  1.0828e+00,  7.9598e-01]],

         [[-3.7026e-01,        -inf,        -inf,        -inf],
          [ 1.5510e-01,  1.8763e+00,        -inf,        -inf],
          [ 5.9879e-01, -7.1820e-01,  9.7809e-01,        -inf],
          [ 2.4037e+00,  2.7758e+00, -1.1383e+00,  1.1302e+00]],

         [[-8.3863e-02,        -inf,        -inf,        -inf],
          [-4.1965e+00, -1.5018e+00,        -inf,        -inf],
          [-1.3108e+00, -1.3035e+00, -9.2313e-03,        -inf],
          [-4.3566e-01,  1.0791e-01,  2.8210e+00, -1.3371e+00]],

         [[-7.6247e-01,        -inf,        -inf,        -inf],
          [-4.1991e+00,  1.1718e+00,        -inf,        -inf],
          [-3.5187e+00,  5.0517e+00,  4.7987e+00,        -inf],
          [-3.3839e+00, -1.1219e+00, -1.5402e+00, -1.9286e+00]],

         [[ 1.2156e-01,        -inf,        -inf,        -inf],
          [-1.6873e+00, -3.1927e+00,        -inf,        -inf],
          [-1.1595e+00, -4.1941e+00, -4.9237e+00,        -inf],
          [ 2.5178e+00, -3.8143e-01, -5.2436e+00,  1.5397e+00]],

         [[-4.3952e+00,        -inf,        -inf,        -inf],
          [-2.2929e+00,  2.5718e+00,        -inf,        -inf],
          [ 7.2220e-01, -1.7275e+00,  5.4752e+00,        -inf],
          [-5.3115e+00,  2.7396e+00,  2.1571e+00,  6.1611e-01]],

         [[ 4.3054e-01,        -inf,        -inf,        -inf],
          [-8.8925e-01,  1.7656e+00,        -inf,        -inf],
          [ 5.9929e-01,  2.0345e-01, -4.6960e+00,        -inf],
          [-2.7677e+00, -3.9079e-01, -4.3203e+00, -2.9428e+00]],

         [[ 5.3564e+00,        -inf,        -inf,        -inf],
          [ 1.2864e+00, -9.3087e-01,        -inf,        -inf],
          [-4.4605e-01, -2.5344e+00, -2.2087e-02,        -inf],
          [ 1.9490e+00, -3.1826e+00, -8.7479e-01, -1.5319e+00]],

         [[-3.6700e+00,        -inf,        -inf,        -inf],
          [-2.3464e-01,  1.1897e+00,        -inf,        -inf],
          [ 5.2827e-01, -1.8332e+00, -2.2713e+00,        -inf],
          [-8.0092e-02,  1.3199e+00,  4.1668e+00, -1.0998e+00]],

         [[ 5.4171e-01,        -inf,        -inf,        -inf],
          [ 3.1284e-01,  1.2425e-01,        -inf,        -inf],
          [ 3.8095e-01, -1.0591e+00, -2.2563e+00,        -inf],
          [-3.3120e-01, -1.2404e+00, -4.5104e-03, -4.2055e+00]],

         [[-7.8147e-01,        -inf,        -inf,        -inf],
          [ 8.0888e-01,  1.1605e+00,        -inf,        -inf],
          [-5.3378e-01, -2.5719e+00, -1.4886e+00,        -inf],
          [ 2.7858e+00,  4.3601e+00, -1.6490e+00,  1.4727e+00]],

         [[-3.8806e-01,        -inf,        -inf,        -inf],
          [-4.0420e-01,  1.3771e+00,        -inf,        -inf],
          [-2.4308e+00,  2.6703e+00,  1.4691e+00,        -inf],
          [-2.9350e+00,  3.5193e+00,  1.3092e+00, -5.6233e+00]],

         [[-3.6061e+00,        -inf,        -inf,        -inf],
          [-7.5764e+00,  1.0402e+00,        -inf,        -inf],
          [-3.6024e+00, -3.7301e+00, -1.1344e+00,        -inf],
          [-3.4895e-01, -1.1372e+00, -3.8214e+00, -9.9142e-01]],

         [[ 4.2909e+00,        -inf,        -inf,        -inf],
          [ 1.5290e+00, -3.4141e-01,        -inf,        -inf],
          [ 2.0408e+00,  2.1342e+00,  5.8985e-01,        -inf],
          [ 2.0596e+00,  2.0849e+00,  6.6173e+00,  5.1722e+00]],

         [[ 4.9057e+00,        -inf,        -inf,        -inf],
          [ 7.0534e+00,  4.7338e+00,        -inf,        -inf],
          [-4.2974e+00,  1.9959e-01, -1.8281e+00,        -inf],
          [ 1.8186e+00, -2.3228e+00,  1.8709e+00,  4.0171e-01]],

         [[-3.9752e+00,        -inf,        -inf,        -inf],
          [-1.9088e+00,  7.4429e-01,        -inf,        -inf],
          [ 3.5321e+00,  1.6851e+00,  4.0645e+00,        -inf],
          [-4.0165e+00, -1.1863e+00,  5.0813e+00,  8.3309e+00]],

         [[-1.5514e+00,        -inf,        -inf,        -inf],
          [ 2.0204e+00,  2.1505e-01,        -inf,        -inf],
          [ 1.0199e+00, -2.3433e+00,  2.0918e+00,        -inf],
          [ 1.0934e+00,  4.1798e+00,  1.9878e+00,  2.9206e+00]],

         [[ 5.3090e-01,        -inf,        -inf,        -inf],
          [ 1.3025e+00, -3.1184e-01,        -inf,        -inf],
          [-1.3979e+00,  1.3865e+00, -5.1165e-01,        -inf],
          [-3.0769e+00, -3.0373e+00, -9.0732e-01, -2.0183e+00]],

         [[-2.4535e+00,        -inf,        -inf,        -inf],
          [ 1.6051e+00, -3.2377e+00,        -inf,        -inf],
          [ 4.2103e+00, -1.7815e+00, -8.4885e-01,        -inf],
          [ 3.6898e+00,  1.9391e+00,  4.1529e+00,  5.4002e+00]],

         [[ 3.7969e+00,        -inf,        -inf,        -inf],
          [ 9.6486e-01, -1.6443e-02,        -inf,        -inf],
          [-3.2322e+00, -2.5060e+00, -1.2968e+00,        -inf],
          [-7.0821e-01, -1.4342e+00,  3.2359e+00,  1.2163e+00]],

         [[-1.5196e-01,        -inf,        -inf,        -inf],
          [-6.3267e-01, -2.9357e+00,        -inf,        -inf],
          [-4.2679e+00,  3.2352e-01, -9.5655e-01,        -inf],
          [-1.2470e+00,  1.2587e+00,  4.3737e+00,  3.8848e+00]],

         [[-8.1521e-01,        -inf,        -inf,        -inf],
          [-3.3969e+00, -1.2519e+00,        -inf,        -inf],
          [-5.5964e-01, -1.5618e+00,  2.1038e+00,        -inf],
          [-3.4603e-02, -1.0830e+00,  2.2270e+00,  4.0274e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-2.8653e-01, -2.5956e-01,  4.8922e-01,  ..., -1.0480e+00,
            9.4440e-01, -7.8343e-01],
          [ 2.8020e-02,  8.3589e-01,  4.2983e-01,  ..., -2.0615e-04,
           -9.8491e-01,  5.4321e-01],
          [ 8.0455e-01,  9.6271e-01,  9.8477e-01,  ...,  2.7630e-01,
            2.7575e-01, -2.0639e+00],
          ...,
          [-6.0235e-01, -3.9185e-01, -5.9132e-01,  ...,  3.7334e-01,
            3.9511e-01,  1.3616e+00],
          [-2.1152e-02,  4.2404e-01, -1.8360e-01,  ..., -1.3007e+00,
           -4.8679e-02,  8.8174e-01],
          [ 8.9154e-01,  4.7853e-01,  7.2430e-01,  ..., -7.2321e-01,
           -2.9396e-01,  7.8257e-01]],

         [[-7.2104e-01, -1.6398e-01,  5.0507e-01,  ..., -2.8865e-01,
            1.0069e+00,  1.3065e-01],
          [ 2.5858e-01,  1.7618e-01,  1.8220e-01,  ...,  5.5765e-02,
           -3.8732e-01,  4.5824e-01],
          [ 6.0043e-01,  9.8506e-01,  7.5261e-01,  ...,  3.5898e-02,
            2.0563e-01, -1.7166e+00],
          ...,
          [ 5.5056e-02,  1.9037e-01,  2.5538e-02,  ...,  5.5709e-01,
            7.2406e-02,  8.4026e-01],
          [ 1.6916e-01,  3.9097e-01,  6.7347e-02,  ..., -9.9205e-01,
            1.3610e-01,  5.0269e-01],
          [ 3.8957e-01,  4.6928e-01,  2.0979e-01,  ..., -7.1749e-01,
           -3.6767e-01,  3.6628e-01]],

         [[-5.2671e-01, -3.5684e-01,  3.1020e-01,  ..., -2.5167e-01,
            6.5629e-01, -1.1554e-01],
          [-2.3941e-01,  2.5733e-01,  6.2213e-02,  ...,  2.1060e-01,
           -3.4760e-01,  1.9826e-01],
          [ 5.4370e-01,  7.0961e-01,  7.1504e-01,  ..., -1.6510e-01,
            1.9801e-01, -1.2349e+00],
          ...,
          [ 1.0934e-01,  1.9832e-01,  8.3874e-02,  ...,  4.1876e-01,
            1.7585e-02,  5.4673e-01],
          [ 5.3010e-01,  3.2488e-01, -2.4392e-01,  ..., -4.8852e-01,
            7.8876e-02,  3.2504e-01],
          [-1.2903e-01,  5.9270e-01,  3.8277e-01,  ..., -8.0805e-01,
           -4.5203e-01,  3.4925e-01]],

         [[-3.8509e-01, -3.8679e-01,  1.9833e-01,  ..., -2.1299e-01,
            4.4271e-01, -2.0191e-01],
          [-2.2311e-01,  1.2806e-01, -1.6751e-04,  ...,  1.6980e-01,
           -1.7221e-01,  7.9318e-02],
          [ 3.9300e-01,  5.0667e-01,  6.0332e-01,  ..., -3.8646e-02,
            3.7265e-01, -1.2665e+00],
          ...,
          [ 2.2455e-01,  2.6396e-01,  2.5678e-01,  ...,  5.3873e-01,
            3.6852e-02,  3.3111e-01],
          [ 8.3341e-01,  1.6208e-01, -5.3110e-02,  ..., -6.4020e-01,
            2.1529e-01,  4.3379e-01],
          [-1.9638e-02,  4.0246e-01,  3.5257e-01,  ..., -5.4431e-01,
           -2.9243e-01,  3.0527e-01]]],


        [[[ 2.9856e-02, -1.4036e-01, -1.4468e-01,  ..., -9.0037e-01,
            1.1670e+00, -1.1413e+00],
          [ 2.6138e-01,  4.7690e-01,  7.8131e-01,  ..., -3.8550e-01,
           -1.8484e-01,  4.4855e-01],
          [ 1.0567e+00,  8.5402e-01,  1.1433e+00,  ..., -2.9009e-01,
            3.9168e-01, -1.4977e+00],
          ...,
          [-6.2934e-01, -3.3690e-01, -5.3713e-01,  ..., -1.7907e-02,
            4.5332e-01,  2.2897e-01],
          [-3.7713e-01,  4.9849e-01,  1.1038e-02,  ..., -9.0816e-01,
            3.5392e-02,  1.2479e+00],
          [ 9.2524e-01,  4.4100e-01,  3.6307e-01,  ..., -1.0255e-01,
           -9.2257e-01,  5.1063e-01]],

         [[-5.6241e-03, -1.8529e-01,  9.2190e-02,  ..., -1.0762e-01,
            1.5971e+00, -4.0405e-01],
          [ 4.2585e-01, -3.8953e-03,  4.1778e-01,  ..., -7.5613e-01,
           -9.3332e-02,  3.9904e-01],
          [ 2.4220e-01,  6.3427e-03, -3.0306e-01,  ...,  2.5296e-01,
           -1.4447e-01, -7.3104e-01],
          ...,
          [-2.0350e-01,  4.2899e-02,  1.6442e-01,  ..., -2.4642e-01,
           -1.7174e-01,  8.0151e-01],
          [-6.0894e-02,  1.1838e-01,  2.1959e-01,  ..., -6.0231e-01,
           -1.6606e-01,  8.6631e-01],
          [ 2.7904e-01,  4.3681e-01, -1.4708e-01,  ..., -5.1796e-01,
           -7.9170e-01, -2.8564e-01]],

         [[-1.5503e-02, -8.5583e-02,  1.2373e-01,  ...,  2.6004e-01,
            7.5392e-01,  1.2931e-01],
          [ 1.8620e-02, -5.9887e-01,  3.9981e-02,  ..., -2.7869e-01,
           -3.5661e-01, -1.8838e-01],
          [ 4.6814e-01,  3.0395e-01,  8.5316e-02,  ..., -3.0189e-01,
            5.9393e-02, -1.4061e+00],
          ...,
          [-3.8543e-03,  3.3096e-01,  5.4185e-01,  ..., -3.4577e-02,
           -8.9054e-03,  8.6880e-01],
          [ 6.1435e-02, -4.4603e-02,  2.0862e-01,  ..., -2.9229e-01,
           -1.7171e-01,  4.3899e-01],
          [ 3.0410e-01,  4.5935e-01,  2.4067e-01,  ..., -6.8316e-01,
           -3.8361e-01,  1.6220e-01]],

         [[ 2.1413e-01, -2.1210e-01, -1.1031e-01,  ..., -7.4787e-02,
            8.0468e-01, -3.3815e-01],
          [-7.4175e-02, -5.7846e-01, -5.0080e-02,  ..., -1.0626e-01,
           -3.2602e-01, -2.6849e-01],
          [ 4.0262e-01,  2.6684e-01,  1.1394e-01,  ..., -2.3224e-01,
            6.0499e-02, -1.1260e+00],
          ...,
          [-1.2498e-01,  4.5278e-01,  4.9675e-01,  ..., -1.1575e-01,
           -1.3274e-01,  6.2126e-01],
          [ 1.3389e-01, -6.6617e-02,  7.9609e-02,  ..., -4.9847e-01,
           -3.5908e-01,  3.8002e-01],
          [ 6.0032e-02,  4.2899e-01,  8.5071e-02,  ..., -2.8426e-01,
           -1.4846e-01,  2.6375e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.2865, -0.2596,  0.4892,  ..., -0.7232, -0.2940,  0.7826],
         [-0.7210, -0.1640,  0.5051,  ..., -0.7175, -0.3677,  0.3663],
         [-0.5267, -0.3568,  0.3102,  ..., -0.8081, -0.4520,  0.3492],
         [-0.3851, -0.3868,  0.1983,  ..., -0.5443, -0.2924,  0.3053]],

        [[ 0.0299, -0.1404, -0.1447,  ..., -0.1026, -0.9226,  0.5106],
         [-0.0056, -0.1853,  0.0922,  ..., -0.5180, -0.7917, -0.2856],
         [-0.0155, -0.0856,  0.1237,  ..., -0.6832, -0.3836,  0.1622],
         [ 0.2141, -0.2121, -0.1103,  ..., -0.2843, -0.1485,  0.2638]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.4977, -0.1744, -0.5697,  ...,  0.3151, -0.1324,  0.4511],
         [ 0.2591, -0.0591, -0.5121,  ...,  0.2026, -0.0764,  0.2391],
         [ 0.5088,  0.0241, -0.4388,  ...,  0.0134, -0.2641,  0.1747],
         [ 0.4816,  0.1070, -0.4435,  ...,  0.0842, -0.0773, -0.0879]],

        [[ 0.4865,  0.1870, -0.2996,  ...,  0.4975, -0.2440,  0.6432],
         [ 0.5125,  0.2750, -0.2416,  ..., -0.1122, -0.2563,  0.0998],
         [ 0.5187,  0.0535, -0.1467,  ...,  0.0424, -0.0984, -0.1181],
         [ 0.4667,  0.0567, -0.1191,  ..., -0.0978, -0.0572, -0.1121]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.8919e+00,        -inf,        -inf,        -inf],
          [ 2.8722e-01,  2.3148e+00,        -inf,        -inf],
          [-1.1605e+00, -3.0108e-01,  4.1317e+00,        -inf],
          [ 8.1741e-02, -1.9626e+00,  3.7943e+00,  3.5588e+00]],

         [[ 3.0164e+00,        -inf,        -inf,        -inf],
          [ 6.5214e+00, -1.7584e+00,        -inf,        -inf],
          [ 1.4250e+00, -4.4959e-01, -1.7409e+00,        -inf],
          [ 2.2067e+00, -4.6459e+00, -4.5854e-01, -4.7843e-01]],

         [[ 2.4864e+00,        -inf,        -inf,        -inf],
          [-1.8554e+00,  2.0821e+00,        -inf,        -inf],
          [-3.2862e+00, -1.2758e+00, -3.4284e+00,        -inf],
          [ 1.2753e+00,  3.7060e+00,  7.8450e+00,  4.7451e+00]],

         [[-1.5520e+00,        -inf,        -inf,        -inf],
          [ 2.0085e-02,  1.2161e+00,        -inf,        -inf],
          [-2.5804e+00,  1.3904e+00,  5.5150e+00,        -inf],
          [ 9.9321e-01, -1.1597e+00,  8.6214e-01, -2.3108e+00]],

         [[ 3.1648e+00,        -inf,        -inf,        -inf],
          [-9.6867e-01, -3.0740e+00,        -inf,        -inf],
          [-4.0490e-01, -1.0561e+00, -1.3220e+00,        -inf],
          [ 8.0357e-01,  1.3141e+00, -2.3547e-01, -1.2747e-01]],

         [[ 9.0168e-01,        -inf,        -inf,        -inf],
          [-2.8626e+00, -3.6198e+00,        -inf,        -inf],
          [-2.3703e-01,  1.5698e+00, -2.5054e+00,        -inf],
          [ 1.2869e+00,  4.5925e+00, -2.2030e+00,  1.3496e+00]],

         [[ 1.4126e+00,        -inf,        -inf,        -inf],
          [-6.7990e-01, -6.4953e-01,        -inf,        -inf],
          [ 2.4322e+00, -1.3278e+00, -2.8667e+00,        -inf],
          [-1.7689e+00, -7.5991e-01, -2.4139e+00,  1.3656e+00]],

         [[ 4.8207e-01,        -inf,        -inf,        -inf],
          [ 2.9905e+00, -1.8808e+00,        -inf,        -inf],
          [ 7.3794e+00,  2.2383e+00,  5.2669e+00,        -inf],
          [ 3.5704e-01, -2.8821e+00,  5.9113e-01,  1.0543e+00]],

         [[-2.9965e+00,        -inf,        -inf,        -inf],
          [ 2.1961e+00,  1.7719e-01,        -inf,        -inf],
          [-3.2014e+00, -2.1411e+00,  9.0945e-01,        -inf],
          [-1.8789e+00, -1.8538e+00, -3.0179e+00,  2.7189e-01]],

         [[ 1.1290e+00,        -inf,        -inf,        -inf],
          [ 4.6732e+00,  1.2659e+00,        -inf,        -inf],
          [ 2.6641e+00,  1.0436e+00, -1.6883e+00,        -inf],
          [-1.4147e-01, -8.8177e-01, -1.2774e+00, -2.8907e+00]],

         [[ 2.7272e+00,        -inf,        -inf,        -inf],
          [-1.3162e+00, -3.0906e+00,        -inf,        -inf],
          [ 1.4778e+00, -1.0949e+00, -1.5715e+00,        -inf],
          [-5.0064e+00, -6.6985e+00, -5.7364e-02, -2.6037e+00]],

         [[-1.7358e+00,        -inf,        -inf,        -inf],
          [-2.2861e+00,  4.8366e+00,        -inf,        -inf],
          [-7.8249e-01,  2.6670e+00,  4.8150e-01,        -inf],
          [-3.4290e+00,  1.8903e+00, -5.5304e-01,  3.7673e-01]],

         [[-2.3567e+00,        -inf,        -inf,        -inf],
          [ 9.0515e-01,  3.3912e+00,        -inf,        -inf],
          [ 3.3980e+00,  2.9744e+00,  2.9161e+00,        -inf],
          [ 2.0517e+00, -5.2827e-01, -1.6878e+00,  1.3677e+00]],

         [[ 6.5210e-01,        -inf,        -inf,        -inf],
          [-9.2921e-01, -2.4217e+00,        -inf,        -inf],
          [-1.5995e+00, -3.9609e+00,  6.7661e-01,        -inf],
          [ 3.1074e-01,  1.1941e-01,  5.6665e-02, -2.8500e-01]],

         [[-3.3426e+00,        -inf,        -inf,        -inf],
          [-1.7364e+00, -5.3258e+00,        -inf,        -inf],
          [-2.2124e+00, -7.0813e+00, -8.6694e-01,        -inf],
          [-6.4535e-01,  1.9229e+00,  1.5165e-01,  1.6728e+00]],

         [[ 2.1369e+00,        -inf,        -inf,        -inf],
          [ 4.1178e+00,  2.8859e+00,        -inf,        -inf],
          [ 1.7008e+00,  2.7589e+00,  1.5588e+00,        -inf],
          [ 3.9567e+00,  3.9401e+00,  4.7233e+00,  2.6860e+00]],

         [[-5.7498e+00,        -inf,        -inf,        -inf],
          [ 2.3496e+00, -6.4175e+00,        -inf,        -inf],
          [ 3.1657e-01,  1.4315e+00, -2.8595e+00,        -inf],
          [-1.6747e+00, -4.1860e+00, -2.4377e-01, -2.6552e+00]],

         [[ 2.4557e+00,        -inf,        -inf,        -inf],
          [-1.4857e+00,  7.1292e-01,        -inf,        -inf],
          [ 1.6370e+00, -7.0405e+00, -6.1625e+00,        -inf],
          [-7.0387e-01, -3.2755e-02, -1.1370e-01, -3.3515e-02]],

         [[ 2.4187e+00,        -inf,        -inf,        -inf],
          [ 2.1436e+00,  5.6914e-01,        -inf,        -inf],
          [ 2.3169e+00,  6.9324e-01, -6.5056e+00,        -inf],
          [ 1.0806e+00, -7.9602e+00, -5.8718e+00, -2.4609e-01]],

         [[-2.1916e+00,        -inf,        -inf,        -inf],
          [-2.8246e+00,  3.6835e+00,        -inf,        -inf],
          [ 3.2699e+00,  1.5361e+00, -1.6931e+00,        -inf],
          [-7.1288e+00, -1.8306e+00, -4.8021e+00, -4.6681e+00]],

         [[-5.8177e-01,        -inf,        -inf,        -inf],
          [-6.3020e+00, -4.9807e+00,        -inf,        -inf],
          [-4.0748e-01, -1.8774e-01,  5.5131e+00,        -inf],
          [-6.9418e-01, -2.3960e+00, -4.8842e-01, -4.0143e-01]],

         [[ 1.3088e+00,        -inf,        -inf,        -inf],
          [-1.7670e+00,  4.6104e-02,        -inf,        -inf],
          [ 5.4652e-01,  2.5958e+00,  3.1793e+00,        -inf],
          [-1.2599e+00, -1.1494e+00,  3.1541e-01, -4.1746e+00]],

         [[-7.1716e-01,        -inf,        -inf,        -inf],
          [ 2.4933e-01, -1.9861e+00,        -inf,        -inf],
          [-1.7298e+00, -1.3050e+00,  1.8890e+00,        -inf],
          [-2.7132e+00,  2.0173e+00, -4.5285e+00, -1.5606e-01]],

         [[-3.0907e-01,        -inf,        -inf,        -inf],
          [ 1.3037e+00, -1.0724e+00,        -inf,        -inf],
          [-4.8468e+00, -1.9074e+00, -4.2581e+00,        -inf],
          [-3.6917e+00, -6.0895e-01,  1.0053e-01,  2.7907e+00]],

         [[-4.1832e+00,        -inf,        -inf,        -inf],
          [ 2.1252e+00, -8.1903e-01,        -inf,        -inf],
          [ 5.5486e-01, -4.3013e-01, -2.2642e+00,        -inf],
          [-4.0023e-01, -2.1393e+00,  8.7447e-02, -8.6869e-02]]],


        [[[ 2.0289e+00,        -inf,        -inf,        -inf],
          [ 2.5862e-02, -1.4705e+00,        -inf,        -inf],
          [ 2.6323e-01, -3.0567e+00,  7.2975e-01,        -inf],
          [ 2.2372e+00,  2.8641e+00,  3.8724e+00,  5.9056e-01]],

         [[ 2.7029e+00,        -inf,        -inf,        -inf],
          [ 5.2757e-01, -8.6916e-01,        -inf,        -inf],
          [-4.7059e-01, -7.5564e-01,  1.8699e+00,        -inf],
          [ 1.5284e+00,  1.2773e+00, -1.7869e+00,  5.6280e-01]],

         [[-8.8647e-01,        -inf,        -inf,        -inf],
          [-5.9143e+00,  5.8307e-01,        -inf,        -inf],
          [-7.8987e-01, -2.9720e-01,  9.9280e-01,        -inf],
          [ 3.7359e+00,  4.0523e+00,  3.1903e+00,  4.3412e+00]],

         [[ 4.4613e-01,        -inf,        -inf,        -inf],
          [-4.5573e-01, -4.1567e+00,        -inf,        -inf],
          [-4.3752e+00, -2.8749e-01, -8.6237e-03,        -inf],
          [ 1.1865e-01, -1.3969e-01, -4.7674e-01,  5.6473e-01]],

         [[ 1.7957e+00,        -inf,        -inf,        -inf],
          [ 8.7436e-01, -1.2971e+00,        -inf,        -inf],
          [ 1.3605e+00,  2.7552e+00, -1.6365e-01,        -inf],
          [ 1.2489e+00,  5.6085e+00,  2.4059e+00,  7.9027e-01]],

         [[ 2.3315e-01,        -inf,        -inf,        -inf],
          [-4.7452e+00, -6.7850e+00,        -inf,        -inf],
          [-2.5935e+00, -8.3333e+00,  2.8140e+00,        -inf],
          [ 3.7693e-01, -5.0111e+00,  2.8957e+00,  1.3571e+00]],

         [[ 1.8460e+00,        -inf,        -inf,        -inf],
          [ 6.2270e-01, -2.6190e+00,        -inf,        -inf],
          [ 1.5538e-01, -2.2708e+00, -1.5377e+00,        -inf],
          [-1.1557e+00, -8.1943e-01, -1.8090e+00,  1.0760e+00]],

         [[ 2.9867e+00,        -inf,        -inf,        -inf],
          [ 3.4641e+00,  2.3380e-01,        -inf,        -inf],
          [ 6.1774e+00,  2.4124e+00,  2.5686e+00,        -inf],
          [ 3.9914e+00,  8.1025e-01,  3.9385e+00,  1.0499e+00]],

         [[-5.8244e+00,        -inf,        -inf,        -inf],
          [-1.3106e+00, -4.4855e-01,        -inf,        -inf],
          [-4.6505e-01,  1.9270e+00,  7.9039e-01,        -inf],
          [-6.3957e-01, -2.0271e+00, -1.6596e+00, -3.8814e+00]],

         [[ 3.8628e+00,        -inf,        -inf,        -inf],
          [ 1.7518e+00,  2.1539e-01,        -inf,        -inf],
          [-3.1953e-01,  8.4129e-01,  1.4815e+00,        -inf],
          [-1.0064e+00, -4.7329e+00, -1.0344e+00,  5.0961e-01]],

         [[ 4.1915e+00,        -inf,        -inf,        -inf],
          [-2.1563e+00, -3.2241e+00,        -inf,        -inf],
          [-8.1561e-01, -1.1690e-01, -5.1528e-01,        -inf],
          [-3.7990e+00, -4.7783e+00,  5.8877e-01,  2.3853e+00]],

         [[ 7.1998e-01,        -inf,        -inf,        -inf],
          [ 4.3307e-01,  9.1945e-01,        -inf,        -inf],
          [-3.5693e-01, -1.6922e+00, -3.4213e-01,        -inf],
          [-4.2889e+00,  4.7169e-01,  1.6172e+00,  9.8015e-01]],

         [[-3.1642e+00,        -inf,        -inf,        -inf],
          [-7.0594e-02,  8.7922e+00,        -inf,        -inf],
          [ 2.8286e+00,  1.6144e+00,  4.1900e+00,        -inf],
          [ 1.2379e+00,  5.0966e+00, -2.9406e+00,  2.3924e-01]],

         [[ 1.7580e+00,        -inf,        -inf,        -inf],
          [ 3.2276e+00,  5.3947e+00,        -inf,        -inf],
          [-6.1469e-01, -1.9546e+00, -6.8956e-01,        -inf],
          [-2.0660e+00,  2.2733e+00,  5.5073e+00,  3.0380e+00]],

         [[-9.8119e-02,        -inf,        -inf,        -inf],
          [ 2.7173e-01, -5.5654e-01,        -inf,        -inf],
          [-3.2376e+00, -2.8544e+00, -2.6477e+00,        -inf],
          [ 5.5414e-01,  1.4899e+00,  1.6778e+00, -2.1215e+00]],

         [[ 4.1999e+00,        -inf,        -inf,        -inf],
          [ 1.0477e+00,  2.7623e+00,        -inf,        -inf],
          [ 1.3851e+00,  3.5534e+00,  2.3620e+00,        -inf],
          [ 5.4499e+00,  7.4064e-01,  2.4791e+00,  2.1933e+00]],

         [[-4.3957e+00,        -inf,        -inf,        -inf],
          [ 2.9465e+00, -1.2424e+00,        -inf,        -inf],
          [ 4.8164e+00,  1.4008e+00, -5.1216e-02,        -inf],
          [-3.2888e-01, -2.1118e+00, -2.7010e+00, -5.0994e+00]],

         [[ 1.2059e+00,        -inf,        -inf,        -inf],
          [-3.2337e-01,  5.0370e-01,        -inf,        -inf],
          [ 1.2996e+00, -1.7535e+00,  2.7582e+00,        -inf],
          [ 2.6529e+00, -1.1150e+00,  1.5078e+00, -9.3995e+00]],

         [[ 1.8296e+00,        -inf,        -inf,        -inf],
          [ 1.5158e+00, -4.5017e+00,        -inf,        -inf],
          [ 3.0225e+00, -3.7500e-01, -2.4342e+00,        -inf],
          [-3.2558e-01,  1.2760e+00, -7.3130e+00, -3.4094e+00]],

         [[-3.5855e+00,        -inf,        -inf,        -inf],
          [-1.4222e+00, -2.8238e+00,        -inf,        -inf],
          [-4.8622e+00,  9.9744e-01, -4.5355e+00,        -inf],
          [-2.6538e+00,  1.0396e+00, -4.2993e+00, -8.5512e-01]],

         [[-4.3648e-01,        -inf,        -inf,        -inf],
          [-1.5349e+00, -2.4166e+00,        -inf,        -inf],
          [-2.8360e+00,  1.5339e+00,  3.6458e+00,        -inf],
          [ 7.8292e-01, -2.7811e+00, -8.4244e-01,  1.4165e+00]],

         [[-2.1751e+00,        -inf,        -inf,        -inf],
          [-2.4882e+00, -1.0452e+00,        -inf,        -inf],
          [ 1.1357e+00,  5.6870e-01,  3.0495e+00,        -inf],
          [-5.2263e+00, -2.8916e+00, -4.5474e-01, -7.2746e+00]],

         [[-2.7880e+00,        -inf,        -inf,        -inf],
          [-2.1300e+00, -2.2220e+00,        -inf,        -inf],
          [ 2.3127e+00,  2.4294e+00, -2.2503e+00,        -inf],
          [-1.4589e-01,  3.9646e-02, -1.2256e+00, -7.9549e-01]],

         [[ 1.2111e+00,        -inf,        -inf,        -inf],
          [-4.1500e-01, -2.4526e-01,        -inf,        -inf],
          [ 1.7268e+00,  1.7459e+00,  5.9102e+00,        -inf],
          [ 1.9109e+00,  4.7089e+00,  3.9686e+00, -3.7162e-01]],

         [[-2.5812e+00,        -inf,        -inf,        -inf],
          [-2.7708e-01, -6.2002e-01,        -inf,        -inf],
          [-3.9275e+00, -4.5104e+00, -4.5861e+00,        -inf],
          [-1.6656e+00, -3.2012e+00, -4.9693e+00, -1.0190e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.8919e+00,        -inf,        -inf,        -inf],
          [ 2.8722e-01,  2.3148e+00,        -inf,        -inf],
          [-1.1605e+00, -3.0108e-01,  4.1317e+00,        -inf],
          [ 8.1741e-02, -1.9626e+00,  3.7943e+00,  3.5588e+00]],

         [[ 3.0164e+00,        -inf,        -inf,        -inf],
          [ 6.5214e+00, -1.7584e+00,        -inf,        -inf],
          [ 1.4250e+00, -4.4959e-01, -1.7409e+00,        -inf],
          [ 2.2067e+00, -4.6459e+00, -4.5854e-01, -4.7843e-01]],

         [[ 2.4864e+00,        -inf,        -inf,        -inf],
          [-1.8554e+00,  2.0821e+00,        -inf,        -inf],
          [-3.2862e+00, -1.2758e+00, -3.4284e+00,        -inf],
          [ 1.2753e+00,  3.7060e+00,  7.8450e+00,  4.7451e+00]],

         [[-1.5520e+00,        -inf,        -inf,        -inf],
          [ 2.0085e-02,  1.2161e+00,        -inf,        -inf],
          [-2.5804e+00,  1.3904e+00,  5.5150e+00,        -inf],
          [ 9.9321e-01, -1.1597e+00,  8.6214e-01, -2.3108e+00]],

         [[ 3.1648e+00,        -inf,        -inf,        -inf],
          [-9.6867e-01, -3.0740e+00,        -inf,        -inf],
          [-4.0490e-01, -1.0561e+00, -1.3220e+00,        -inf],
          [ 8.0357e-01,  1.3141e+00, -2.3547e-01, -1.2747e-01]],

         [[ 9.0168e-01,        -inf,        -inf,        -inf],
          [-2.8626e+00, -3.6198e+00,        -inf,        -inf],
          [-2.3703e-01,  1.5698e+00, -2.5054e+00,        -inf],
          [ 1.2869e+00,  4.5925e+00, -2.2030e+00,  1.3496e+00]],

         [[ 1.4126e+00,        -inf,        -inf,        -inf],
          [-6.7990e-01, -6.4953e-01,        -inf,        -inf],
          [ 2.4322e+00, -1.3278e+00, -2.8667e+00,        -inf],
          [-1.7689e+00, -7.5991e-01, -2.4139e+00,  1.3656e+00]],

         [[ 4.8207e-01,        -inf,        -inf,        -inf],
          [ 2.9905e+00, -1.8808e+00,        -inf,        -inf],
          [ 7.3794e+00,  2.2383e+00,  5.2669e+00,        -inf],
          [ 3.5704e-01, -2.8821e+00,  5.9113e-01,  1.0543e+00]],

         [[-2.9965e+00,        -inf,        -inf,        -inf],
          [ 2.1961e+00,  1.7719e-01,        -inf,        -inf],
          [-3.2014e+00, -2.1411e+00,  9.0945e-01,        -inf],
          [-1.8789e+00, -1.8538e+00, -3.0179e+00,  2.7189e-01]],

         [[ 1.1290e+00,        -inf,        -inf,        -inf],
          [ 4.6732e+00,  1.2659e+00,        -inf,        -inf],
          [ 2.6641e+00,  1.0436e+00, -1.6883e+00,        -inf],
          [-1.4147e-01, -8.8177e-01, -1.2774e+00, -2.8907e+00]],

         [[ 2.7272e+00,        -inf,        -inf,        -inf],
          [-1.3162e+00, -3.0906e+00,        -inf,        -inf],
          [ 1.4778e+00, -1.0949e+00, -1.5715e+00,        -inf],
          [-5.0064e+00, -6.6985e+00, -5.7364e-02, -2.6037e+00]],

         [[-1.7358e+00,        -inf,        -inf,        -inf],
          [-2.2861e+00,  4.8366e+00,        -inf,        -inf],
          [-7.8249e-01,  2.6670e+00,  4.8150e-01,        -inf],
          [-3.4290e+00,  1.8903e+00, -5.5304e-01,  3.7673e-01]],

         [[-2.3567e+00,        -inf,        -inf,        -inf],
          [ 9.0515e-01,  3.3912e+00,        -inf,        -inf],
          [ 3.3980e+00,  2.9744e+00,  2.9161e+00,        -inf],
          [ 2.0517e+00, -5.2827e-01, -1.6878e+00,  1.3677e+00]],

         [[ 6.5210e-01,        -inf,        -inf,        -inf],
          [-9.2921e-01, -2.4217e+00,        -inf,        -inf],
          [-1.5995e+00, -3.9609e+00,  6.7661e-01,        -inf],
          [ 3.1074e-01,  1.1941e-01,  5.6665e-02, -2.8500e-01]],

         [[-3.3426e+00,        -inf,        -inf,        -inf],
          [-1.7364e+00, -5.3258e+00,        -inf,        -inf],
          [-2.2124e+00, -7.0813e+00, -8.6694e-01,        -inf],
          [-6.4535e-01,  1.9229e+00,  1.5165e-01,  1.6728e+00]],

         [[ 2.1369e+00,        -inf,        -inf,        -inf],
          [ 4.1178e+00,  2.8859e+00,        -inf,        -inf],
          [ 1.7008e+00,  2.7589e+00,  1.5588e+00,        -inf],
          [ 3.9567e+00,  3.9401e+00,  4.7233e+00,  2.6860e+00]],

         [[-5.7498e+00,        -inf,        -inf,        -inf],
          [ 2.3496e+00, -6.4175e+00,        -inf,        -inf],
          [ 3.1657e-01,  1.4315e+00, -2.8595e+00,        -inf],
          [-1.6747e+00, -4.1860e+00, -2.4377e-01, -2.6552e+00]],

         [[ 2.4557e+00,        -inf,        -inf,        -inf],
          [-1.4857e+00,  7.1292e-01,        -inf,        -inf],
          [ 1.6370e+00, -7.0405e+00, -6.1625e+00,        -inf],
          [-7.0387e-01, -3.2755e-02, -1.1370e-01, -3.3515e-02]],

         [[ 2.4187e+00,        -inf,        -inf,        -inf],
          [ 2.1436e+00,  5.6914e-01,        -inf,        -inf],
          [ 2.3169e+00,  6.9324e-01, -6.5056e+00,        -inf],
          [ 1.0806e+00, -7.9602e+00, -5.8718e+00, -2.4609e-01]],

         [[-2.1916e+00,        -inf,        -inf,        -inf],
          [-2.8246e+00,  3.6835e+00,        -inf,        -inf],
          [ 3.2699e+00,  1.5361e+00, -1.6931e+00,        -inf],
          [-7.1288e+00, -1.8306e+00, -4.8021e+00, -4.6681e+00]],

         [[-5.8177e-01,        -inf,        -inf,        -inf],
          [-6.3020e+00, -4.9807e+00,        -inf,        -inf],
          [-4.0748e-01, -1.8774e-01,  5.5131e+00,        -inf],
          [-6.9418e-01, -2.3960e+00, -4.8842e-01, -4.0143e-01]],

         [[ 1.3088e+00,        -inf,        -inf,        -inf],
          [-1.7670e+00,  4.6104e-02,        -inf,        -inf],
          [ 5.4652e-01,  2.5958e+00,  3.1793e+00,        -inf],
          [-1.2599e+00, -1.1494e+00,  3.1541e-01, -4.1746e+00]],

         [[-7.1716e-01,        -inf,        -inf,        -inf],
          [ 2.4933e-01, -1.9861e+00,        -inf,        -inf],
          [-1.7298e+00, -1.3050e+00,  1.8890e+00,        -inf],
          [-2.7132e+00,  2.0173e+00, -4.5285e+00, -1.5606e-01]],

         [[-3.0907e-01,        -inf,        -inf,        -inf],
          [ 1.3037e+00, -1.0724e+00,        -inf,        -inf],
          [-4.8468e+00, -1.9074e+00, -4.2581e+00,        -inf],
          [-3.6917e+00, -6.0895e-01,  1.0053e-01,  2.7907e+00]],

         [[-4.1832e+00,        -inf,        -inf,        -inf],
          [ 2.1252e+00, -8.1903e-01,        -inf,        -inf],
          [ 5.5486e-01, -4.3013e-01, -2.2642e+00,        -inf],
          [-4.0023e-01, -2.1393e+00,  8.7447e-02, -8.6869e-02]]],


        [[[ 2.0289e+00,        -inf,        -inf,        -inf],
          [ 2.5862e-02, -1.4705e+00,        -inf,        -inf],
          [ 2.6323e-01, -3.0567e+00,  7.2975e-01,        -inf],
          [ 2.2372e+00,  2.8641e+00,  3.8724e+00,  5.9056e-01]],

         [[ 2.7029e+00,        -inf,        -inf,        -inf],
          [ 5.2757e-01, -8.6916e-01,        -inf,        -inf],
          [-4.7059e-01, -7.5564e-01,  1.8699e+00,        -inf],
          [ 1.5284e+00,  1.2773e+00, -1.7869e+00,  5.6280e-01]],

         [[-8.8647e-01,        -inf,        -inf,        -inf],
          [-5.9143e+00,  5.8307e-01,        -inf,        -inf],
          [-7.8987e-01, -2.9720e-01,  9.9280e-01,        -inf],
          [ 3.7359e+00,  4.0523e+00,  3.1903e+00,  4.3412e+00]],

         [[ 4.4613e-01,        -inf,        -inf,        -inf],
          [-4.5573e-01, -4.1567e+00,        -inf,        -inf],
          [-4.3752e+00, -2.8749e-01, -8.6237e-03,        -inf],
          [ 1.1865e-01, -1.3969e-01, -4.7674e-01,  5.6473e-01]],

         [[ 1.7957e+00,        -inf,        -inf,        -inf],
          [ 8.7436e-01, -1.2971e+00,        -inf,        -inf],
          [ 1.3605e+00,  2.7552e+00, -1.6365e-01,        -inf],
          [ 1.2489e+00,  5.6085e+00,  2.4059e+00,  7.9027e-01]],

         [[ 2.3315e-01,        -inf,        -inf,        -inf],
          [-4.7452e+00, -6.7850e+00,        -inf,        -inf],
          [-2.5935e+00, -8.3333e+00,  2.8140e+00,        -inf],
          [ 3.7693e-01, -5.0111e+00,  2.8957e+00,  1.3571e+00]],

         [[ 1.8460e+00,        -inf,        -inf,        -inf],
          [ 6.2270e-01, -2.6190e+00,        -inf,        -inf],
          [ 1.5538e-01, -2.2708e+00, -1.5377e+00,        -inf],
          [-1.1557e+00, -8.1943e-01, -1.8090e+00,  1.0760e+00]],

         [[ 2.9867e+00,        -inf,        -inf,        -inf],
          [ 3.4641e+00,  2.3380e-01,        -inf,        -inf],
          [ 6.1774e+00,  2.4124e+00,  2.5686e+00,        -inf],
          [ 3.9914e+00,  8.1025e-01,  3.9385e+00,  1.0499e+00]],

         [[-5.8244e+00,        -inf,        -inf,        -inf],
          [-1.3106e+00, -4.4855e-01,        -inf,        -inf],
          [-4.6505e-01,  1.9270e+00,  7.9039e-01,        -inf],
          [-6.3957e-01, -2.0271e+00, -1.6596e+00, -3.8814e+00]],

         [[ 3.8628e+00,        -inf,        -inf,        -inf],
          [ 1.7518e+00,  2.1539e-01,        -inf,        -inf],
          [-3.1953e-01,  8.4129e-01,  1.4815e+00,        -inf],
          [-1.0064e+00, -4.7329e+00, -1.0344e+00,  5.0961e-01]],

         [[ 4.1915e+00,        -inf,        -inf,        -inf],
          [-2.1563e+00, -3.2241e+00,        -inf,        -inf],
          [-8.1561e-01, -1.1690e-01, -5.1528e-01,        -inf],
          [-3.7990e+00, -4.7783e+00,  5.8877e-01,  2.3853e+00]],

         [[ 7.1998e-01,        -inf,        -inf,        -inf],
          [ 4.3307e-01,  9.1945e-01,        -inf,        -inf],
          [-3.5693e-01, -1.6922e+00, -3.4213e-01,        -inf],
          [-4.2889e+00,  4.7169e-01,  1.6172e+00,  9.8015e-01]],

         [[-3.1642e+00,        -inf,        -inf,        -inf],
          [-7.0594e-02,  8.7922e+00,        -inf,        -inf],
          [ 2.8286e+00,  1.6144e+00,  4.1900e+00,        -inf],
          [ 1.2379e+00,  5.0966e+00, -2.9406e+00,  2.3924e-01]],

         [[ 1.7580e+00,        -inf,        -inf,        -inf],
          [ 3.2276e+00,  5.3947e+00,        -inf,        -inf],
          [-6.1469e-01, -1.9546e+00, -6.8956e-01,        -inf],
          [-2.0660e+00,  2.2733e+00,  5.5073e+00,  3.0380e+00]],

         [[-9.8119e-02,        -inf,        -inf,        -inf],
          [ 2.7173e-01, -5.5654e-01,        -inf,        -inf],
          [-3.2376e+00, -2.8544e+00, -2.6477e+00,        -inf],
          [ 5.5414e-01,  1.4899e+00,  1.6778e+00, -2.1215e+00]],

         [[ 4.1999e+00,        -inf,        -inf,        -inf],
          [ 1.0477e+00,  2.7623e+00,        -inf,        -inf],
          [ 1.3851e+00,  3.5534e+00,  2.3620e+00,        -inf],
          [ 5.4499e+00,  7.4064e-01,  2.4791e+00,  2.1933e+00]],

         [[-4.3957e+00,        -inf,        -inf,        -inf],
          [ 2.9465e+00, -1.2424e+00,        -inf,        -inf],
          [ 4.8164e+00,  1.4008e+00, -5.1216e-02,        -inf],
          [-3.2888e-01, -2.1118e+00, -2.7010e+00, -5.0994e+00]],

         [[ 1.2059e+00,        -inf,        -inf,        -inf],
          [-3.2337e-01,  5.0370e-01,        -inf,        -inf],
          [ 1.2996e+00, -1.7535e+00,  2.7582e+00,        -inf],
          [ 2.6529e+00, -1.1150e+00,  1.5078e+00, -9.3995e+00]],

         [[ 1.8296e+00,        -inf,        -inf,        -inf],
          [ 1.5158e+00, -4.5017e+00,        -inf,        -inf],
          [ 3.0225e+00, -3.7500e-01, -2.4342e+00,        -inf],
          [-3.2558e-01,  1.2760e+00, -7.3130e+00, -3.4094e+00]],

         [[-3.5855e+00,        -inf,        -inf,        -inf],
          [-1.4222e+00, -2.8238e+00,        -inf,        -inf],
          [-4.8622e+00,  9.9744e-01, -4.5355e+00,        -inf],
          [-2.6538e+00,  1.0396e+00, -4.2993e+00, -8.5512e-01]],

         [[-4.3648e-01,        -inf,        -inf,        -inf],
          [-1.5349e+00, -2.4166e+00,        -inf,        -inf],
          [-2.8360e+00,  1.5339e+00,  3.6458e+00,        -inf],
          [ 7.8292e-01, -2.7811e+00, -8.4244e-01,  1.4165e+00]],

         [[-2.1751e+00,        -inf,        -inf,        -inf],
          [-2.4882e+00, -1.0452e+00,        -inf,        -inf],
          [ 1.1357e+00,  5.6870e-01,  3.0495e+00,        -inf],
          [-5.2263e+00, -2.8916e+00, -4.5474e-01, -7.2746e+00]],

         [[-2.7880e+00,        -inf,        -inf,        -inf],
          [-2.1300e+00, -2.2220e+00,        -inf,        -inf],
          [ 2.3127e+00,  2.4294e+00, -2.2503e+00,        -inf],
          [-1.4589e-01,  3.9646e-02, -1.2256e+00, -7.9549e-01]],

         [[ 1.2111e+00,        -inf,        -inf,        -inf],
          [-4.1500e-01, -2.4526e-01,        -inf,        -inf],
          [ 1.7268e+00,  1.7459e+00,  5.9102e+00,        -inf],
          [ 1.9109e+00,  4.7089e+00,  3.9686e+00, -3.7162e-01]],

         [[-2.5812e+00,        -inf,        -inf,        -inf],
          [-2.7708e-01, -6.2002e-01,        -inf,        -inf],
          [-3.9275e+00, -4.5104e+00, -4.5861e+00,        -inf],
          [-1.6656e+00, -3.2012e+00, -4.9693e+00, -1.0190e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.7201, -0.2142,  0.5425,  ..., -0.1057, -0.3572, -0.3610],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.0851,  0.8322, -0.8649,  ...,  0.0877,  0.2338,  0.0685],
          ...,
          [-0.0124, -0.7700,  0.3598,  ...,  0.8758,  0.6714,  0.0333],
          [-0.5230,  0.5049,  0.9967,  ..., -0.9811,  0.0872, -0.1400],
          [ 0.4056, -0.4284, -0.2227,  ..., -0.1120,  0.5585, -0.3450]],

         [[ 1.0925, -0.2910,  0.0800,  ...,  0.0819, -0.5457, -0.3887],
          [ 0.1625,  0.6339, -0.7856,  ...,  0.9791,  0.8342, -0.1635],
          [ 0.3031,  1.1644, -0.1449,  ...,  0.2195,  0.7884, -0.0486],
          ...,
          [-0.3500, -0.8586,  0.0645,  ...,  0.6692,  0.8047, -0.3462],
          [-0.7410,  0.4424,  0.9651,  ..., -0.9910,  0.0393, -0.3504],
          [ 0.4189, -0.0229,  0.0721,  ...,  0.0600,  0.4273, -0.1386]],

         [[ 0.5574, -0.1493,  0.0573,  ...,  0.0364, -0.2784, -0.2018],
          [-0.0164,  0.3288, -0.3308,  ...,  0.1058,  0.1185,  0.0015],
          [ 0.0193,  0.6228,  0.0232,  ..., -0.0290,  0.6782, -0.1908],
          ...,
          [-0.0328, -0.4713,  0.0805,  ...,  0.6821,  0.6175, -0.4158],
          [-0.4742, -0.0464,  0.7812,  ..., -0.6791, -0.0941, -0.2658],
          [ 0.2745,  0.0664,  0.2935,  ...,  0.3357,  0.1423,  0.0067]],

         [[-0.0562, -0.0734, -0.2955,  ...,  0.5951, -0.1826, -0.2064],
          [ 0.1830,  0.6865, -0.7062,  ...,  0.1539,  0.2666, -0.0768],
          [-0.0276,  0.5753,  0.2807,  ...,  0.1283,  0.3532, -0.1895],
          ...,
          [-0.3693, -0.4355, -0.3597,  ...,  0.2151,  0.1665, -0.3950],
          [-0.3537, -0.0319,  0.5332,  ...,  0.1345,  0.0356,  0.1641],
          [ 0.1620,  0.0460,  0.2552,  ...,  0.3087,  0.0369,  0.0302]]],


        [[[ 0.6062, -0.1942,  0.4266,  ...,  0.1437,  0.0155, -0.8642],
          [ 0.2440,  0.2767, -1.1555,  ...,  0.8410,  0.8094,  0.4708],
          [-0.0120,  0.7210, -1.1333,  ..., -0.6798, -0.4483,  0.4728],
          ...,
          [ 0.3359, -0.8897,  0.3975,  ...,  0.6797,  0.8776,  0.0819],
          [-0.3851,  1.0641,  0.7806,  ..., -0.3796, -0.3621, -0.0029],
          [ 0.1350, -0.0995, -0.3852,  ..., -0.2723,  0.4095, -0.3941]],

         [[ 0.3858, -0.3216,  0.3465,  ...,  0.0898, -0.0481, -0.9007],
          [ 0.0248,  0.3026, -0.8948,  ...,  0.4777,  0.4652,  0.3003],
          [-0.6361,  0.8559, -0.2439,  ..., -0.3150,  0.2220, -0.0754],
          ...,
          [-0.4050, -0.7943,  0.3842,  ...,  0.6361,  0.6518, -0.6025],
          [-0.0055,  0.2671,  0.1341,  ...,  0.0079, -0.1008, -0.1602],
          [ 0.0397, -0.3755, -0.0573,  ..., -0.0508,  0.3367, -0.4045]],

         [[ 0.5896,  0.0052,  0.5008,  ..., -0.0022, -0.1336, -0.6171],
          [ 0.0205, -0.0433, -0.4199,  ...,  0.0363, -0.2212, -0.1233],
          [-0.4184,  0.2185, -0.2857,  ..., -0.1656,  0.2509,  0.0034],
          ...,
          [-0.3515, -0.2995,  0.2110,  ...,  0.0893, -0.1048, -0.6500],
          [-0.1622,  0.0991,  0.3282,  ...,  0.1693,  0.0717, -0.0091],
          [ 0.1662, -0.4388,  0.3329,  ..., -0.0777, -0.2775, -0.1608]],

         [[ 0.3764,  0.0437,  0.2655,  ...,  0.0016, -0.0432, -0.4717],
          [ 0.0727,  0.2245, -0.8666,  ...,  0.2048,  0.1941,  0.1757],
          [-0.3117,  0.2339, -0.2361,  ..., -0.1528,  0.1568,  0.0122],
          ...,
          [-0.4870, -0.3522,  0.2002,  ...,  0.5029,  0.3194, -0.3449],
          [-0.1675,  0.2178,  0.3549,  ...,  0.1357,  0.1798, -0.0248],
          [-0.0113, -0.1954,  0.2443,  ..., -0.0378, -0.2759, -0.2031]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.7201, -0.2142,  0.5425,  ..., -0.1120,  0.5585, -0.3450],
         [ 1.0925, -0.2910,  0.0800,  ...,  0.0600,  0.4273, -0.1386],
         [ 0.5574, -0.1493,  0.0573,  ...,  0.3357,  0.1423,  0.0067],
         [-0.0562, -0.0734, -0.2955,  ...,  0.3087,  0.0369,  0.0302]],

        [[ 0.6062, -0.1942,  0.4266,  ..., -0.2723,  0.4095, -0.3941],
         [ 0.3858, -0.3216,  0.3465,  ..., -0.0508,  0.3367, -0.4045],
         [ 0.5896,  0.0052,  0.5008,  ..., -0.0777, -0.2775, -0.1608],
         [ 0.3764,  0.0437,  0.2655,  ..., -0.0378, -0.2759, -0.2031]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.3603, -0.1398,  0.6174,  ..., -0.1567,  0.7279, -0.1059],
         [ 0.2217, -0.3332,  0.2683,  ..., -0.7305,  0.1188, -0.3675],
         [ 0.3107, -0.2739,  0.3007,  ..., -0.6838,  0.3523, -0.2525],
         [ 0.0661, -0.1907,  0.3962,  ..., -0.4094,  0.2075, -0.1505]],

        [[ 0.6989, -0.1061,  0.6255,  ..., -0.8255,  0.6797, -0.0222],
         [ 0.4633, -0.4465,  0.5347,  ..., -0.4331,  0.2910,  0.2859],
         [ 0.4396, -0.2945,  0.3409,  ..., -0.4274,  0.2837,  0.3304],
         [ 0.3345, -0.2953,  0.3204,  ..., -0.5220,  0.3256,  0.1578]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 4.3970e+00,        -inf,        -inf,        -inf],
          [ 7.0529e+00, -6.4608e-01,        -inf,        -inf],
          [-3.7043e+00, -3.4966e+00, -3.2366e+00,        -inf],
          [ 7.1441e-02,  1.9186e+00,  4.2428e+00,  2.7309e+00]],

         [[ 2.1931e+00,        -inf,        -inf,        -inf],
          [-4.9739e+00, -5.7732e+00,        -inf,        -inf],
          [-2.9919e+00,  2.5046e+00, -4.1924e+00,        -inf],
          [-2.2350e+00,  2.2323e+00, -2.5848e+00, -2.4661e+00]],

         [[-3.7392e-01,        -inf,        -inf,        -inf],
          [-2.3836e+00, -3.2942e+00,        -inf,        -inf],
          [-5.7025e-01,  2.8650e+00,  1.1726e-01,        -inf],
          [-2.4559e+00, -3.9839e+00, -1.5424e+00, -7.0968e-01]],

         [[ 2.2271e+00,        -inf,        -inf,        -inf],
          [ 2.3278e-01, -1.5854e+00,        -inf,        -inf],
          [-1.7046e+00,  1.0452e+00, -9.9169e-01,        -inf],
          [ 2.1258e+00,  4.3992e+00,  1.2692e+00,  2.3144e+00]],

         [[-1.1996e+00,        -inf,        -inf,        -inf],
          [-2.6777e+00, -2.4838e+00,        -inf,        -inf],
          [-1.5111e+00,  2.2404e+00,  3.4924e+00,        -inf],
          [-5.0727e+00, -3.8550e+00, -2.2668e+00, -3.3237e+00]],

         [[-1.2550e-01,        -inf,        -inf,        -inf],
          [ 3.1053e+00,  2.1709e+00,        -inf,        -inf],
          [-1.8720e+00,  1.2301e+00, -1.3890e+00,        -inf],
          [ 2.5340e+00,  2.7018e+00,  2.6484e+00,  3.2120e+00]],

         [[ 1.0537e+00,        -inf,        -inf,        -inf],
          [-2.3604e+00, -1.4441e+00,        -inf,        -inf],
          [ 3.3051e+00, -6.2928e+00, -2.5992e+00,        -inf],
          [-3.6196e+00, -2.3572e+00,  1.2296e+00, -4.1481e-01]],

         [[-1.6084e+00,        -inf,        -inf,        -inf],
          [-7.5526e-01, -5.4023e+00,        -inf,        -inf],
          [ 7.1305e-01, -3.6559e+00,  1.4486e-01,        -inf],
          [-1.8160e+00,  9.8446e-01, -3.2620e-01, -8.1914e-01]],

         [[-2.6431e+00,        -inf,        -inf,        -inf],
          [ 7.0878e+00,  5.7258e+00,        -inf,        -inf],
          [ 2.1380e+00,  8.5582e-01,  2.8336e+00,        -inf],
          [ 5.1011e+00,  4.0116e+00,  2.8210e+00,  3.1554e+00]],

         [[-6.3241e-01,        -inf,        -inf,        -inf],
          [-2.1126e-01, -1.6827e+00,        -inf,        -inf],
          [-1.8097e+00, -1.5866e-01, -3.4063e+00,        -inf],
          [ 3.2591e+00, -1.2960e+00, -3.8648e+00, -3.4513e+00]],

         [[ 5.2896e+00,        -inf,        -inf,        -inf],
          [-8.5043e-02, -5.2413e+00,        -inf,        -inf],
          [ 4.9665e+00,  2.1581e+00, -1.6715e+00,        -inf],
          [ 5.0140e+00, -1.0688e+00, -2.3078e+00,  4.9578e-01]],

         [[-4.9074e+00,        -inf,        -inf,        -inf],
          [ 1.7917e+00, -3.2858e+00,        -inf,        -inf],
          [-2.2931e+00, -3.2865e+00, -1.7514e+00,        -inf],
          [-1.0736e+00, -4.7661e+00, -4.3387e+00, -4.9997e+00]],

         [[ 1.4592e+00,        -inf,        -inf,        -inf],
          [ 1.1254e+00, -5.8962e+00,        -inf,        -inf],
          [ 9.4007e-01,  2.3253e-02, -1.6705e+00,        -inf],
          [ 4.9162e-01, -6.3224e-01,  3.5226e+00, -1.2010e+00]],

         [[-3.8563e-01,        -inf,        -inf,        -inf],
          [ 1.0984e-01,  1.3006e-01,        -inf,        -inf],
          [ 3.4813e-02, -1.2186e+00,  7.4980e-01,        -inf],
          [ 1.4933e+00,  2.2982e+00,  1.1975e+00,  3.5261e+00]],

         [[-8.9283e-01,        -inf,        -inf,        -inf],
          [-2.9663e+00, -3.2999e+00,        -inf,        -inf],
          [ 2.1587e-01,  1.5584e+00, -1.3980e+00,        -inf],
          [ 1.2080e+00,  2.6009e-01, -3.0958e+00, -1.6712e+00]],

         [[-6.8968e+00,        -inf,        -inf,        -inf],
          [-3.3507e+00, -4.0638e+00,        -inf,        -inf],
          [-7.8844e-01, -2.4759e+00,  2.4084e+00,        -inf],
          [-2.9425e+00,  3.9605e-01,  2.7400e+00,  2.0844e+00]],

         [[-2.7852e+00,        -inf,        -inf,        -inf],
          [ 3.2859e+00, -3.2128e+00,        -inf,        -inf],
          [-1.9864e-01,  1.2227e+00,  3.2010e+00,        -inf],
          [-1.7720e+00,  1.8464e+00,  8.2003e-01,  5.1671e+00]],

         [[ 4.3935e+00,        -inf,        -inf,        -inf],
          [ 6.7219e-01,  1.6735e+00,        -inf,        -inf],
          [ 1.7343e+00,  2.8804e+00,  4.3582e-01,        -inf],
          [ 1.0539e+00, -1.1166e+00, -3.3476e+00, -7.0942e-01]],

         [[-1.1374e+00,        -inf,        -inf,        -inf],
          [ 3.7436e+00, -1.6768e-01,        -inf,        -inf],
          [-3.7924e-01, -1.7807e+00,  1.6599e+00,        -inf],
          [-1.3912e+00,  2.1451e+00,  2.8458e+00, -2.9419e+00]],

         [[-2.1042e+00,        -inf,        -inf,        -inf],
          [-1.8301e+00,  3.1576e+00,        -inf,        -inf],
          [ 3.2954e+00,  6.4527e+00,  4.6696e+00,        -inf],
          [ 1.7397e+00,  1.9675e+00, -2.7217e+00, -1.1885e+00]],

         [[ 9.1153e-01,        -inf,        -inf,        -inf],
          [-4.3665e+00, -9.9147e-02,        -inf,        -inf],
          [-1.5377e+00, -3.8142e+00, -2.8521e-01,        -inf],
          [ 5.9951e+00,  1.7887e+00,  7.3312e-01, -2.2234e+00]],

         [[ 2.2844e+00,        -inf,        -inf,        -inf],
          [ 6.2364e+00,  1.6187e+00,        -inf,        -inf],
          [ 3.4818e-01,  6.3443e-01,  4.8554e+00,        -inf],
          [ 3.1481e+00,  6.6221e-01,  3.4632e+00, -2.6399e+00]],

         [[ 8.4812e-01,        -inf,        -inf,        -inf],
          [ 2.1167e+00,  1.0655e+00,        -inf,        -inf],
          [-3.2565e+00,  2.6403e+00, -1.8809e+00,        -inf],
          [ 3.9119e-01, -2.4953e+00,  1.5238e+00, -2.1260e+00]],

         [[-1.9761e+00,        -inf,        -inf,        -inf],
          [-7.6370e+00, -3.8597e+00,        -inf,        -inf],
          [-2.0927e+00, -2.7049e-01, -1.0927e+00,        -inf],
          [-2.6160e+00, -2.7895e+00, -2.5120e+00, -9.4205e-01]],

         [[-1.2834e+00,        -inf,        -inf,        -inf],
          [-3.4028e+00, -2.3464e+00,        -inf,        -inf],
          [-3.1980e+00, -3.8578e-01,  3.4584e+00,        -inf],
          [-2.5028e+00, -1.0740e+00, -2.3155e-01,  6.1553e-01]]],


        [[[ 3.6262e+00,        -inf,        -inf,        -inf],
          [ 2.3735e+00, -1.3763e+00,        -inf,        -inf],
          [-5.6129e-01, -6.3210e-01,  1.3600e+00,        -inf],
          [-3.7965e-01,  3.2864e+00,  6.3518e+00,  8.3963e-01]],

         [[-2.2920e+00,        -inf,        -inf,        -inf],
          [-1.8184e+00, -6.2544e-01,        -inf,        -inf],
          [-1.8904e-01,  2.4021e-01,  3.8241e+00,        -inf],
          [-2.5883e-01, -2.1437e+00,  1.1026e+00,  9.9639e-01]],

         [[-1.1161e-01,        -inf,        -inf,        -inf],
          [-1.3520e+00,  3.1644e+00,        -inf,        -inf],
          [ 1.6489e+00,  3.7157e+00,  1.2470e+00,        -inf],
          [-5.3718e+00,  8.9339e-01,  2.8703e+00,  9.6913e-01]],

         [[ 2.8843e+00,        -inf,        -inf,        -inf],
          [-8.9218e-01, -1.7397e+00,        -inf,        -inf],
          [ 1.1906e+00, -2.0800e+00,  8.6164e-02,        -inf],
          [-2.3316e+00, -4.7526e-02,  2.0804e+00,  2.0400e-01]],

         [[-1.1234e+00,        -inf,        -inf,        -inf],
          [ 4.3174e-01,  1.3970e-01,        -inf,        -inf],
          [ 3.3048e+00,  2.6469e+00,  5.7283e+00,        -inf],
          [-2.0255e+00,  1.1193e+00, -2.6484e-01, -1.3488e+00]],

         [[-9.4402e-01,        -inf,        -inf,        -inf],
          [ 2.3867e+00,  6.2903e+00,        -inf,        -inf],
          [ 3.4163e+00,  2.5310e+00, -4.3100e-01,        -inf],
          [ 3.7402e+00, -1.2555e-01,  6.0622e+00,  2.7497e+00]],

         [[ 3.6598e-01,        -inf,        -inf,        -inf],
          [ 2.0494e+00,  3.0992e+00,        -inf,        -inf],
          [ 1.3826e+00, -4.2281e+00, -2.6135e+00,        -inf],
          [-1.1150e+00,  3.7504e+00, -1.8374e+00,  5.5049e-01]],

         [[-7.6474e-01,        -inf,        -inf,        -inf],
          [-3.4640e+00,  1.5289e-02,        -inf,        -inf],
          [-1.2682e+00, -3.1563e-02, -4.2385e-01,        -inf],
          [-8.2673e-01,  6.3376e-01,  3.1894e+00, -1.5895e+00]],

         [[-1.4598e+00,        -inf,        -inf,        -inf],
          [ 6.0982e+00,  4.7715e+00,        -inf,        -inf],
          [ 1.1929e-01, -3.9512e+00, -2.1167e+00,        -inf],
          [ 7.5573e+00,  4.4558e+00,  5.2314e-01,  6.0412e+00]],

         [[-2.3648e+00,        -inf,        -inf,        -inf],
          [-2.5102e-01,  6.3889e+00,        -inf,        -inf],
          [ 2.7092e+00, -2.0585e+00,  1.3893e+00,        -inf],
          [ 1.5293e+00,  3.9415e+00,  1.4846e+00, -2.9148e+00]],

         [[ 3.1801e+00,        -inf,        -inf,        -inf],
          [-1.2049e+00,  2.3932e+00,        -inf,        -inf],
          [-1.6063e+00, -3.2848e+00, -3.6552e+00,        -inf],
          [ 2.8925e+00,  1.1861e+00,  2.8374e-02,  8.3346e-01]],

         [[-3.5937e+00,        -inf,        -inf,        -inf],
          [ 3.9103e+00,  4.2920e-02,        -inf,        -inf],
          [-2.8904e+00, -9.5790e-01,  3.3134e-01,        -inf],
          [ 2.7322e+00, -2.5920e+00,  3.1559e+00, -3.2879e+00]],

         [[ 8.1306e-01,        -inf,        -inf,        -inf],
          [-6.1719e-01, -2.6414e-01,        -inf,        -inf],
          [-3.6103e+00,  9.6007e-01,  5.0143e-01,        -inf],
          [-1.3533e+00, -4.8655e+00, -1.6431e+00,  9.1702e-01]],

         [[-3.2211e+00,        -inf,        -inf,        -inf],
          [-4.1652e+00, -6.5228e+00,        -inf,        -inf],
          [ 3.2709e+00, -5.1234e-01, -2.0940e+00,        -inf],
          [ 3.8932e+00, -1.2563e+00,  2.2890e-01,  1.5717e+00]],

         [[-2.2162e+00,        -inf,        -inf,        -inf],
          [-1.2552e+00, -2.2166e+00,        -inf,        -inf],
          [-2.6686e-01, -4.5264e-03, -1.3450e+00,        -inf],
          [ 2.4168e+00,  3.7224e+00, -1.2346e+00,  2.7725e+00]],

         [[-2.6475e+00,        -inf,        -inf,        -inf],
          [ 2.7033e+00, -1.4478e+00,        -inf,        -inf],
          [ 3.8840e+00, -2.0102e+00,  3.1309e+00,        -inf],
          [ 2.0884e-01, -3.9394e-01,  1.8538e+00,  4.8826e+00]],

         [[-2.6436e+00,        -inf,        -inf,        -inf],
          [ 2.8776e-01, -2.0746e+00,        -inf,        -inf],
          [-2.5148e+00, -8.3038e-01, -1.7048e+00,        -inf],
          [-7.9355e-01, -2.2890e+00,  1.7753e+00,  1.4231e+00]],

         [[ 1.4239e+00,        -inf,        -inf,        -inf],
          [-1.8443e+00,  3.9776e-01,        -inf,        -inf],
          [ 7.4872e-01, -1.0871e+00, -7.3537e-01,        -inf],
          [ 1.1333e+00,  6.8755e-01, -2.7233e+00,  1.5330e+00]],

         [[ 1.4793e+00,        -inf,        -inf,        -inf],
          [ 1.2971e+00, -5.7010e+00,        -inf,        -inf],
          [-1.0328e+00,  1.2273e+00,  1.5098e+00,        -inf],
          [-2.7758e+00,  4.6362e-02,  1.5572e+00, -3.7985e+00]],

         [[-6.9281e-01,        -inf,        -inf,        -inf],
          [-1.3136e+00,  2.0404e+00,        -inf,        -inf],
          [ 3.4764e+00, -7.5451e-01, -5.2219e-02,        -inf],
          [ 1.5590e+00,  4.7341e+00, -2.5310e+00, -1.3001e+00]],

         [[-2.4078e+00,        -inf,        -inf,        -inf],
          [-4.4173e+00, -5.4464e+00,        -inf,        -inf],
          [-5.2639e+00, -5.8641e+00, -1.0846e+00,        -inf],
          [ 1.6919e+00, -1.3400e-01,  1.3350e+00, -4.7586e+00]],

         [[ 2.3644e+00,        -inf,        -inf,        -inf],
          [ 6.4979e+00,  4.0220e+00,        -inf,        -inf],
          [-2.0987e+00,  2.5720e+00,  1.2305e+00,        -inf],
          [ 1.9701e+00,  6.5927e+00,  1.0577e+00, -8.8820e-01]],

         [[ 4.8145e-01,        -inf,        -inf,        -inf],
          [ 7.6868e-01, -3.7843e-02,        -inf,        -inf],
          [-3.6530e+00, -3.1438e+00, -1.5852e+00,        -inf],
          [-1.8508e+00, -7.3246e+00, -3.7341e-01, -2.6468e+00]],

         [[-4.1651e+00,        -inf,        -inf,        -inf],
          [-5.8870e+00,  6.5810e-02,        -inf,        -inf],
          [ 1.7569e+00,  1.8423e+00,  2.0421e+00,        -inf],
          [-2.5627e+00, -1.2936e+00, -8.1874e-01, -3.3434e-01]],

         [[-1.9653e+00,        -inf,        -inf,        -inf],
          [-1.0656e+00, -1.8275e-01,        -inf,        -inf],
          [ 8.3293e-01,  1.8416e-01, -1.7197e+00,        -inf],
          [-1.3349e+00,  2.7625e+00,  1.2954e+00,  3.2299e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 4.3970e+00,        -inf,        -inf,        -inf],
          [ 7.0529e+00, -6.4608e-01,        -inf,        -inf],
          [-3.7043e+00, -3.4966e+00, -3.2366e+00,        -inf],
          [ 7.1441e-02,  1.9186e+00,  4.2428e+00,  2.7309e+00]],

         [[ 2.1931e+00,        -inf,        -inf,        -inf],
          [-4.9739e+00, -5.7732e+00,        -inf,        -inf],
          [-2.9919e+00,  2.5046e+00, -4.1924e+00,        -inf],
          [-2.2350e+00,  2.2323e+00, -2.5848e+00, -2.4661e+00]],

         [[-3.7392e-01,        -inf,        -inf,        -inf],
          [-2.3836e+00, -3.2942e+00,        -inf,        -inf],
          [-5.7025e-01,  2.8650e+00,  1.1726e-01,        -inf],
          [-2.4559e+00, -3.9839e+00, -1.5424e+00, -7.0968e-01]],

         [[ 2.2271e+00,        -inf,        -inf,        -inf],
          [ 2.3278e-01, -1.5854e+00,        -inf,        -inf],
          [-1.7046e+00,  1.0452e+00, -9.9169e-01,        -inf],
          [ 2.1258e+00,  4.3992e+00,  1.2692e+00,  2.3144e+00]],

         [[-1.1996e+00,        -inf,        -inf,        -inf],
          [-2.6777e+00, -2.4838e+00,        -inf,        -inf],
          [-1.5111e+00,  2.2404e+00,  3.4924e+00,        -inf],
          [-5.0727e+00, -3.8550e+00, -2.2668e+00, -3.3237e+00]],

         [[-1.2550e-01,        -inf,        -inf,        -inf],
          [ 3.1053e+00,  2.1709e+00,        -inf,        -inf],
          [-1.8720e+00,  1.2301e+00, -1.3890e+00,        -inf],
          [ 2.5340e+00,  2.7018e+00,  2.6484e+00,  3.2120e+00]],

         [[ 1.0537e+00,        -inf,        -inf,        -inf],
          [-2.3604e+00, -1.4441e+00,        -inf,        -inf],
          [ 3.3051e+00, -6.2928e+00, -2.5992e+00,        -inf],
          [-3.6196e+00, -2.3572e+00,  1.2296e+00, -4.1481e-01]],

         [[-1.6084e+00,        -inf,        -inf,        -inf],
          [-7.5526e-01, -5.4023e+00,        -inf,        -inf],
          [ 7.1305e-01, -3.6559e+00,  1.4486e-01,        -inf],
          [-1.8160e+00,  9.8446e-01, -3.2620e-01, -8.1914e-01]],

         [[-2.6431e+00,        -inf,        -inf,        -inf],
          [ 7.0878e+00,  5.7258e+00,        -inf,        -inf],
          [ 2.1380e+00,  8.5582e-01,  2.8336e+00,        -inf],
          [ 5.1011e+00,  4.0116e+00,  2.8210e+00,  3.1554e+00]],

         [[-6.3241e-01,        -inf,        -inf,        -inf],
          [-2.1126e-01, -1.6827e+00,        -inf,        -inf],
          [-1.8097e+00, -1.5866e-01, -3.4063e+00,        -inf],
          [ 3.2591e+00, -1.2960e+00, -3.8648e+00, -3.4513e+00]],

         [[ 5.2896e+00,        -inf,        -inf,        -inf],
          [-8.5043e-02, -5.2413e+00,        -inf,        -inf],
          [ 4.9665e+00,  2.1581e+00, -1.6715e+00,        -inf],
          [ 5.0140e+00, -1.0688e+00, -2.3078e+00,  4.9578e-01]],

         [[-4.9074e+00,        -inf,        -inf,        -inf],
          [ 1.7917e+00, -3.2858e+00,        -inf,        -inf],
          [-2.2931e+00, -3.2865e+00, -1.7514e+00,        -inf],
          [-1.0736e+00, -4.7661e+00, -4.3387e+00, -4.9997e+00]],

         [[ 1.4592e+00,        -inf,        -inf,        -inf],
          [ 1.1254e+00, -5.8962e+00,        -inf,        -inf],
          [ 9.4007e-01,  2.3253e-02, -1.6705e+00,        -inf],
          [ 4.9162e-01, -6.3224e-01,  3.5226e+00, -1.2010e+00]],

         [[-3.8563e-01,        -inf,        -inf,        -inf],
          [ 1.0984e-01,  1.3006e-01,        -inf,        -inf],
          [ 3.4813e-02, -1.2186e+00,  7.4980e-01,        -inf],
          [ 1.4933e+00,  2.2982e+00,  1.1975e+00,  3.5261e+00]],

         [[-8.9283e-01,        -inf,        -inf,        -inf],
          [-2.9663e+00, -3.2999e+00,        -inf,        -inf],
          [ 2.1587e-01,  1.5584e+00, -1.3980e+00,        -inf],
          [ 1.2080e+00,  2.6009e-01, -3.0958e+00, -1.6712e+00]],

         [[-6.8968e+00,        -inf,        -inf,        -inf],
          [-3.3507e+00, -4.0638e+00,        -inf,        -inf],
          [-7.8844e-01, -2.4759e+00,  2.4084e+00,        -inf],
          [-2.9425e+00,  3.9605e-01,  2.7400e+00,  2.0844e+00]],

         [[-2.7852e+00,        -inf,        -inf,        -inf],
          [ 3.2859e+00, -3.2128e+00,        -inf,        -inf],
          [-1.9864e-01,  1.2227e+00,  3.2010e+00,        -inf],
          [-1.7720e+00,  1.8464e+00,  8.2003e-01,  5.1671e+00]],

         [[ 4.3935e+00,        -inf,        -inf,        -inf],
          [ 6.7219e-01,  1.6735e+00,        -inf,        -inf],
          [ 1.7343e+00,  2.8804e+00,  4.3582e-01,        -inf],
          [ 1.0539e+00, -1.1166e+00, -3.3476e+00, -7.0942e-01]],

         [[-1.1374e+00,        -inf,        -inf,        -inf],
          [ 3.7436e+00, -1.6768e-01,        -inf,        -inf],
          [-3.7924e-01, -1.7807e+00,  1.6599e+00,        -inf],
          [-1.3912e+00,  2.1451e+00,  2.8458e+00, -2.9419e+00]],

         [[-2.1042e+00,        -inf,        -inf,        -inf],
          [-1.8301e+00,  3.1576e+00,        -inf,        -inf],
          [ 3.2954e+00,  6.4527e+00,  4.6696e+00,        -inf],
          [ 1.7397e+00,  1.9675e+00, -2.7217e+00, -1.1885e+00]],

         [[ 9.1153e-01,        -inf,        -inf,        -inf],
          [-4.3665e+00, -9.9147e-02,        -inf,        -inf],
          [-1.5377e+00, -3.8142e+00, -2.8521e-01,        -inf],
          [ 5.9951e+00,  1.7887e+00,  7.3312e-01, -2.2234e+00]],

         [[ 2.2844e+00,        -inf,        -inf,        -inf],
          [ 6.2364e+00,  1.6187e+00,        -inf,        -inf],
          [ 3.4818e-01,  6.3443e-01,  4.8554e+00,        -inf],
          [ 3.1481e+00,  6.6221e-01,  3.4632e+00, -2.6399e+00]],

         [[ 8.4812e-01,        -inf,        -inf,        -inf],
          [ 2.1167e+00,  1.0655e+00,        -inf,        -inf],
          [-3.2565e+00,  2.6403e+00, -1.8809e+00,        -inf],
          [ 3.9119e-01, -2.4953e+00,  1.5238e+00, -2.1260e+00]],

         [[-1.9761e+00,        -inf,        -inf,        -inf],
          [-7.6370e+00, -3.8597e+00,        -inf,        -inf],
          [-2.0927e+00, -2.7049e-01, -1.0927e+00,        -inf],
          [-2.6160e+00, -2.7895e+00, -2.5120e+00, -9.4205e-01]],

         [[-1.2834e+00,        -inf,        -inf,        -inf],
          [-3.4028e+00, -2.3464e+00,        -inf,        -inf],
          [-3.1980e+00, -3.8578e-01,  3.4584e+00,        -inf],
          [-2.5028e+00, -1.0740e+00, -2.3155e-01,  6.1553e-01]]],


        [[[ 3.6262e+00,        -inf,        -inf,        -inf],
          [ 2.3735e+00, -1.3763e+00,        -inf,        -inf],
          [-5.6129e-01, -6.3210e-01,  1.3600e+00,        -inf],
          [-3.7965e-01,  3.2864e+00,  6.3518e+00,  8.3963e-01]],

         [[-2.2920e+00,        -inf,        -inf,        -inf],
          [-1.8184e+00, -6.2544e-01,        -inf,        -inf],
          [-1.8904e-01,  2.4021e-01,  3.8241e+00,        -inf],
          [-2.5883e-01, -2.1437e+00,  1.1026e+00,  9.9639e-01]],

         [[-1.1161e-01,        -inf,        -inf,        -inf],
          [-1.3520e+00,  3.1644e+00,        -inf,        -inf],
          [ 1.6489e+00,  3.7157e+00,  1.2470e+00,        -inf],
          [-5.3718e+00,  8.9339e-01,  2.8703e+00,  9.6913e-01]],

         [[ 2.8843e+00,        -inf,        -inf,        -inf],
          [-8.9218e-01, -1.7397e+00,        -inf,        -inf],
          [ 1.1906e+00, -2.0800e+00,  8.6164e-02,        -inf],
          [-2.3316e+00, -4.7526e-02,  2.0804e+00,  2.0400e-01]],

         [[-1.1234e+00,        -inf,        -inf,        -inf],
          [ 4.3174e-01,  1.3970e-01,        -inf,        -inf],
          [ 3.3048e+00,  2.6469e+00,  5.7283e+00,        -inf],
          [-2.0255e+00,  1.1193e+00, -2.6484e-01, -1.3488e+00]],

         [[-9.4402e-01,        -inf,        -inf,        -inf],
          [ 2.3867e+00,  6.2903e+00,        -inf,        -inf],
          [ 3.4163e+00,  2.5310e+00, -4.3100e-01,        -inf],
          [ 3.7402e+00, -1.2555e-01,  6.0622e+00,  2.7497e+00]],

         [[ 3.6598e-01,        -inf,        -inf,        -inf],
          [ 2.0494e+00,  3.0992e+00,        -inf,        -inf],
          [ 1.3826e+00, -4.2281e+00, -2.6135e+00,        -inf],
          [-1.1150e+00,  3.7504e+00, -1.8374e+00,  5.5049e-01]],

         [[-7.6474e-01,        -inf,        -inf,        -inf],
          [-3.4640e+00,  1.5289e-02,        -inf,        -inf],
          [-1.2682e+00, -3.1563e-02, -4.2385e-01,        -inf],
          [-8.2673e-01,  6.3376e-01,  3.1894e+00, -1.5895e+00]],

         [[-1.4598e+00,        -inf,        -inf,        -inf],
          [ 6.0982e+00,  4.7715e+00,        -inf,        -inf],
          [ 1.1929e-01, -3.9512e+00, -2.1167e+00,        -inf],
          [ 7.5573e+00,  4.4558e+00,  5.2314e-01,  6.0412e+00]],

         [[-2.3648e+00,        -inf,        -inf,        -inf],
          [-2.5102e-01,  6.3889e+00,        -inf,        -inf],
          [ 2.7092e+00, -2.0585e+00,  1.3893e+00,        -inf],
          [ 1.5293e+00,  3.9415e+00,  1.4846e+00, -2.9148e+00]],

         [[ 3.1801e+00,        -inf,        -inf,        -inf],
          [-1.2049e+00,  2.3932e+00,        -inf,        -inf],
          [-1.6063e+00, -3.2848e+00, -3.6552e+00,        -inf],
          [ 2.8925e+00,  1.1861e+00,  2.8374e-02,  8.3346e-01]],

         [[-3.5937e+00,        -inf,        -inf,        -inf],
          [ 3.9103e+00,  4.2920e-02,        -inf,        -inf],
          [-2.8904e+00, -9.5790e-01,  3.3134e-01,        -inf],
          [ 2.7322e+00, -2.5920e+00,  3.1559e+00, -3.2879e+00]],

         [[ 8.1306e-01,        -inf,        -inf,        -inf],
          [-6.1719e-01, -2.6414e-01,        -inf,        -inf],
          [-3.6103e+00,  9.6007e-01,  5.0143e-01,        -inf],
          [-1.3533e+00, -4.8655e+00, -1.6431e+00,  9.1702e-01]],

         [[-3.2211e+00,        -inf,        -inf,        -inf],
          [-4.1652e+00, -6.5228e+00,        -inf,        -inf],
          [ 3.2709e+00, -5.1234e-01, -2.0940e+00,        -inf],
          [ 3.8932e+00, -1.2563e+00,  2.2890e-01,  1.5717e+00]],

         [[-2.2162e+00,        -inf,        -inf,        -inf],
          [-1.2552e+00, -2.2166e+00,        -inf,        -inf],
          [-2.6686e-01, -4.5264e-03, -1.3450e+00,        -inf],
          [ 2.4168e+00,  3.7224e+00, -1.2346e+00,  2.7725e+00]],

         [[-2.6475e+00,        -inf,        -inf,        -inf],
          [ 2.7033e+00, -1.4478e+00,        -inf,        -inf],
          [ 3.8840e+00, -2.0102e+00,  3.1309e+00,        -inf],
          [ 2.0884e-01, -3.9394e-01,  1.8538e+00,  4.8826e+00]],

         [[-2.6436e+00,        -inf,        -inf,        -inf],
          [ 2.8776e-01, -2.0746e+00,        -inf,        -inf],
          [-2.5148e+00, -8.3038e-01, -1.7048e+00,        -inf],
          [-7.9355e-01, -2.2890e+00,  1.7753e+00,  1.4231e+00]],

         [[ 1.4239e+00,        -inf,        -inf,        -inf],
          [-1.8443e+00,  3.9776e-01,        -inf,        -inf],
          [ 7.4872e-01, -1.0871e+00, -7.3537e-01,        -inf],
          [ 1.1333e+00,  6.8755e-01, -2.7233e+00,  1.5330e+00]],

         [[ 1.4793e+00,        -inf,        -inf,        -inf],
          [ 1.2971e+00, -5.7010e+00,        -inf,        -inf],
          [-1.0328e+00,  1.2273e+00,  1.5098e+00,        -inf],
          [-2.7758e+00,  4.6362e-02,  1.5572e+00, -3.7985e+00]],

         [[-6.9281e-01,        -inf,        -inf,        -inf],
          [-1.3136e+00,  2.0404e+00,        -inf,        -inf],
          [ 3.4764e+00, -7.5451e-01, -5.2219e-02,        -inf],
          [ 1.5590e+00,  4.7341e+00, -2.5310e+00, -1.3001e+00]],

         [[-2.4078e+00,        -inf,        -inf,        -inf],
          [-4.4173e+00, -5.4464e+00,        -inf,        -inf],
          [-5.2639e+00, -5.8641e+00, -1.0846e+00,        -inf],
          [ 1.6919e+00, -1.3400e-01,  1.3350e+00, -4.7586e+00]],

         [[ 2.3644e+00,        -inf,        -inf,        -inf],
          [ 6.4979e+00,  4.0220e+00,        -inf,        -inf],
          [-2.0987e+00,  2.5720e+00,  1.2305e+00,        -inf],
          [ 1.9701e+00,  6.5927e+00,  1.0577e+00, -8.8820e-01]],

         [[ 4.8145e-01,        -inf,        -inf,        -inf],
          [ 7.6868e-01, -3.7843e-02,        -inf,        -inf],
          [-3.6530e+00, -3.1438e+00, -1.5852e+00,        -inf],
          [-1.8508e+00, -7.3246e+00, -3.7341e-01, -2.6468e+00]],

         [[-4.1651e+00,        -inf,        -inf,        -inf],
          [-5.8870e+00,  6.5810e-02,        -inf,        -inf],
          [ 1.7569e+00,  1.8423e+00,  2.0421e+00,        -inf],
          [-2.5627e+00, -1.2936e+00, -8.1874e-01, -3.3434e-01]],

         [[-1.9653e+00,        -inf,        -inf,        -inf],
          [-1.0656e+00, -1.8275e-01,        -inf,        -inf],
          [ 8.3293e-01,  1.8416e-01, -1.7197e+00,        -inf],
          [-1.3349e+00,  2.7625e+00,  1.2954e+00,  3.2299e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-3.1900e-01,  1.2370e-01,  8.1005e-01,  ...,  3.5140e-01,
           -2.9877e-01, -5.7084e-02],
          [-8.6806e-01, -9.3393e-01,  1.8109e-01,  ...,  7.9614e-01,
            7.5732e-02,  7.2493e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 2.4541e-01, -6.3539e-02, -1.5687e+00,  ..., -1.2998e-01,
           -2.7376e-01, -7.4702e-01],
          [-7.0405e-01, -1.1738e-01,  2.0494e-01,  ..., -5.8034e-01,
            1.2982e+00,  2.6419e-01],
          [-2.5389e-01, -1.1548e+00, -7.2204e-01,  ..., -3.0224e-01,
           -1.0905e-02,  4.3091e-01]],

         [[-2.6487e-01, -1.1357e-01,  6.4249e-01,  ...,  3.0674e-01,
           -2.6888e-01, -1.4684e-01],
          [-7.9651e-01, -8.0410e-01,  1.7903e-01,  ...,  9.6676e-01,
           -8.7413e-02,  2.8699e-01],
          [ 2.6522e-01, -1.9354e-01,  2.0032e-01,  ...,  1.7353e-01,
           -7.0257e-01, -1.0424e-01],
          ...,
          [ 7.9925e-01,  9.9232e-02, -1.2629e+00,  ...,  3.6058e-01,
           -1.3775e-01, -4.6195e-01],
          [-3.2260e-02, -4.5406e-01,  9.8371e-02,  ...,  6.6455e-02,
            3.7748e-01,  5.2503e-01],
          [-4.9216e-01, -7.1202e-01, -9.5424e-01,  ..., -6.5113e-01,
           -3.7011e-01,  1.2614e+00]],

         [[-1.5198e-02, -2.8265e-01,  1.3041e-01,  ...,  2.6834e-01,
           -1.2433e-02, -3.8654e-01],
          [-7.5303e-01, -7.1405e-01,  1.4162e-01,  ...,  9.5193e-01,
           -2.4263e-01, -3.6699e-02],
          [ 5.3905e-01, -1.9170e-01,  1.0799e-01,  ...,  4.5504e-01,
           -5.5981e-01, -4.4195e-01],
          ...,
          [ 8.3411e-01,  9.4640e-02, -8.1499e-01,  ...,  4.4900e-01,
           -2.7034e-01, -9.6361e-02],
          [-2.6997e-01, -7.8113e-02,  1.2546e-02,  ..., -1.4319e-01,
            3.5107e-01,  2.7849e-01],
          [ 3.2570e-01,  1.9036e-01, -1.7665e-01,  ..., -2.4997e-01,
           -3.5494e-01, -1.0471e-01]],

         [[ 2.4069e-01, -3.9476e-01,  1.2999e-01,  ...,  1.6542e-01,
            1.1677e-01, -3.3576e-01],
          [-6.3527e-01, -5.8230e-01,  2.2601e-01,  ...,  9.0792e-01,
           -3.0248e-01, -8.2950e-03],
          [ 5.9189e-01,  1.2255e-01, -2.0094e-02,  ...,  5.4882e-01,
           -5.1275e-01, -3.6234e-01],
          ...,
          [ 5.5702e-01, -2.7182e-02, -8.0334e-01,  ...,  3.2443e-01,
           -4.4121e-01, -6.1393e-02],
          [ 2.9550e-02, -1.1530e-01, -9.7547e-02,  ..., -4.1718e-01,
            9.2684e-02,  2.4030e-01],
          [ 1.7748e-01,  7.2632e-02, -4.3900e-01,  ..., -2.6424e-01,
           -4.3045e-01,  6.9587e-01]]],


        [[[-7.6438e-03,  6.3988e-01,  1.1644e+00,  ..., -3.3973e-02,
           -1.1431e+00, -3.6019e-01],
          [-7.2318e-01, -5.2655e-01,  2.3570e-01,  ...,  3.8282e-01,
            7.2464e-01,  6.9978e-01],
          [-1.7409e-01,  7.2129e-01,  1.5886e-01,  ...,  5.6227e-01,
            2.0126e-02, -4.3755e-01],
          ...,
          [-5.3512e-01,  5.8733e-01, -8.9493e-01,  ...,  4.9889e-01,
            8.8808e-02, -8.5637e-01],
          [-2.1399e-01, -3.6844e-01, -1.0755e-01,  ..., -3.1310e-01,
            1.5073e+00, -8.5995e-02],
          [-2.7252e-01, -4.5769e-01, -6.2665e-01,  ..., -4.2943e-01,
           -3.9256e-01,  4.5048e-02]],

         [[-1.1150e-03,  3.7391e-01,  1.1849e+00,  ..., -2.1300e-01,
           -9.4099e-01, -3.4995e-01],
          [ 5.7780e-02, -2.5789e-01, -1.3480e-01,  ...,  5.2831e-02,
           -2.7492e-01, -1.3815e-01],
          [ 4.9612e-01,  1.5106e-01, -2.7825e-01,  ...,  2.7395e-01,
           -2.5055e-01, -3.7973e-01],
          ...,
          [-2.8103e-01,  3.0846e-01, -4.7000e-01,  ...,  2.6201e-01,
            4.6640e-02, -4.4975e-01],
          [-5.5816e-01, -4.1162e-01, -4.4796e-01,  ...,  1.8359e-01,
            9.9803e-01,  1.3552e-01],
          [-1.2875e-01, -2.1623e-01, -2.9605e-01,  ..., -2.0288e-01,
           -1.8546e-01,  2.1282e-02]],

         [[-1.8324e-01,  1.0736e-02,  5.1032e-01,  ..., -9.9338e-02,
           -6.2126e-01,  1.8449e-01],
          [ 4.1250e-02, -4.7894e-01,  2.8365e-01,  ...,  2.8788e-01,
           -2.3053e-02,  1.8212e-01],
          [ 2.3444e-01,  2.0062e-01, -3.1345e-01,  ...,  3.4012e-01,
           -1.4400e-01, -4.3956e-01],
          ...,
          [-1.5923e-01,  1.7477e-01, -2.6629e-01,  ...,  1.4845e-01,
            2.6425e-02, -2.5482e-01],
          [-3.0963e-01, -2.6426e-01, -2.3754e-01,  ...,  3.6429e-02,
            7.4547e-01,  5.1644e-02],
          [-6.6444e-02, -4.0521e-01, -2.1613e-01,  ..., -3.2037e-01,
           -1.8198e-01,  7.2059e-01]],

         [[-9.7927e-02, -2.1190e-01,  3.8470e-01,  ..., -9.3394e-02,
           -3.9179e-01,  2.2508e-01],
          [-5.9703e-02, -3.8785e-01,  1.7424e-01,  ...,  2.8039e-01,
           -6.3659e-02,  2.0610e-01],
          [ 1.4075e-01,  9.7126e-02, -2.9879e-01,  ...,  2.4140e-01,
           -9.2497e-02, -3.3999e-01],
          ...,
          [ 7.2308e-02,  9.7505e-02, -3.8413e-01,  ...,  1.9879e-01,
           -2.6606e-01, -3.8402e-01],
          [-4.4199e-01, -1.1503e-01, -1.9193e-01,  ..., -1.6257e-01,
            6.9533e-01,  4.9479e-02],
          [ 7.2128e-02, -4.9843e-01, -3.7577e-02,  ..., -1.2449e-01,
            8.0444e-02,  1.1151e+00]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-3.1900e-01,  1.2370e-01,  8.1005e-01,  ..., -3.0224e-01,
          -1.0905e-02,  4.3091e-01],
         [-2.6487e-01, -1.1357e-01,  6.4249e-01,  ..., -6.5113e-01,
          -3.7011e-01,  1.2614e+00],
         [-1.5198e-02, -2.8265e-01,  1.3041e-01,  ..., -2.4997e-01,
          -3.5494e-01, -1.0471e-01],
         [ 2.4069e-01, -3.9476e-01,  1.2999e-01,  ..., -2.6424e-01,
          -4.3045e-01,  6.9587e-01]],

        [[-7.6438e-03,  6.3988e-01,  1.1644e+00,  ..., -4.2943e-01,
          -3.9256e-01,  4.5048e-02],
         [-1.1150e-03,  3.7391e-01,  1.1849e+00,  ..., -2.0288e-01,
          -1.8546e-01,  2.1282e-02],
         [-1.8324e-01,  1.0736e-02,  5.1032e-01,  ..., -3.2037e-01,
          -1.8198e-01,  7.2059e-01],
         [-9.7927e-02, -2.1190e-01,  3.8470e-01,  ..., -1.2449e-01,
           8.0444e-02,  1.1151e+00]]], grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2818, -0.8349, -0.1458,  ...,  0.0393, -0.0778, -0.2298],
         [ 0.1871, -0.4676, -0.1983,  ...,  0.0850,  0.1408, -0.1741],
         [ 0.5125, -0.3063, -0.0121,  ...,  0.1396, -0.3373,  0.0905],
         [ 0.4207, -0.1685,  0.0566,  ..., -0.0572, -0.3050, -0.0330]],

        [[ 0.7898, -0.9575,  0.2486,  ...,  0.2392, -0.0823, -0.6974],
         [ 0.2942, -0.3007, -0.1701,  ..., -0.0444,  0.1061, -0.1500],
         [ 0.3511, -0.1329, -0.1275,  ..., -0.0573,  0.0197, -0.1633],
         [-0.0066, -0.0025, -0.2066,  ...,  0.0074,  0.0384, -0.1549]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.7559,    -inf,    -inf,    -inf],
          [ 1.2695, -0.2668,    -inf,    -inf],
          [ 0.2350,  0.9844, -1.9910,    -inf],
          [ 0.2173,  3.2338, -0.3129,  0.6340]],

         [[ 0.0340,    -inf,    -inf,    -inf],
          [-1.9397, -0.7417,    -inf,    -inf],
          [ 0.6231,  4.4780, -1.1302,    -inf],
          [ 0.5252,  2.0842,  2.9956, -1.3111]],

         [[ 0.2461,    -inf,    -inf,    -inf],
          [ 2.1887,  0.6892,    -inf,    -inf],
          [ 0.3584,  7.1044, -0.1741,    -inf],
          [ 0.2730,  4.9081,  0.9204, -4.0674]],

         [[ 5.5471,    -inf,    -inf,    -inf],
          [ 3.0749,  0.8176,    -inf,    -inf],
          [ 4.2649,  3.4760,  1.5338,    -inf],
          [ 1.9083,  1.6315,  2.7666,  0.6934]],

         [[ 1.9504,    -inf,    -inf,    -inf],
          [ 2.4970,  2.6366,    -inf,    -inf],
          [-0.8641,  0.9802, -1.7741,    -inf],
          [ 0.7500, -1.1912,  2.8601, -0.9952]],

         [[-6.4548,    -inf,    -inf,    -inf],
          [-6.9112, -5.8922,    -inf,    -inf],
          [-4.8574,  1.0327,  1.2603,    -inf],
          [-3.0558, -0.0849,  0.1610, -1.4149]],

         [[-1.7558,    -inf,    -inf,    -inf],
          [ 1.9664,  0.9569,    -inf,    -inf],
          [-0.9601, -1.8184,  4.1609,    -inf],
          [-0.9261, -2.2390, -2.6571,  0.5090]],

         [[-3.2169,    -inf,    -inf,    -inf],
          [-9.0150, -3.8766,    -inf,    -inf],
          [-3.9267,  0.0418, -0.1825,    -inf],
          [-1.7095,  4.2582, -0.8072, -2.2153]],

         [[ 1.8121,    -inf,    -inf,    -inf],
          [-4.1407, -2.0985,    -inf,    -inf],
          [ 2.6636, -1.1852, -1.4187,    -inf],
          [-2.9877, -1.6414, -0.3061,  0.2324]],

         [[ 1.3224,    -inf,    -inf,    -inf],
          [ 2.1608,  0.0746,    -inf,    -inf],
          [ 6.8162,  4.7985,  2.6865,    -inf],
          [-0.8630, -0.5019,  1.8260, -0.9432]],

         [[ 0.9886,    -inf,    -inf,    -inf],
          [-2.3708, -0.2725,    -inf,    -inf],
          [ 6.5662, -0.3360,  1.7841,    -inf],
          [ 7.6270,  3.1717,  6.0830,  5.5956]],

         [[ 1.8162,    -inf,    -inf,    -inf],
          [ 0.9865, -1.5245,    -inf,    -inf],
          [ 4.4986,  0.4675, -2.3941,    -inf],
          [ 4.2395,  3.2314,  2.9216, -0.5936]],

         [[ 1.8097,    -inf,    -inf,    -inf],
          [ 2.9100,  1.3487,    -inf,    -inf],
          [ 1.5728,  0.4555,  3.2231,    -inf],
          [-0.1594, -1.2255,  1.1013, -1.5378]],

         [[ 2.5211,    -inf,    -inf,    -inf],
          [ 4.6754, -0.7783,    -inf,    -inf],
          [-2.3021, -3.5261,  1.4086,    -inf],
          [ 1.0441, -0.3702, -7.7023, -2.0355]],

         [[ 0.4175,    -inf,    -inf,    -inf],
          [-3.3898, -2.6933,    -inf,    -inf],
          [ 1.8997, -1.2895, -3.0226,    -inf],
          [-2.2360, -1.5818,  1.4297, -3.6736]],

         [[ 0.5003,    -inf,    -inf,    -inf],
          [ 1.6667, -1.6646,    -inf,    -inf],
          [ 2.8100,  1.5449,  1.5347,    -inf],
          [-0.6785, -1.0360,  1.5137, -0.7838]],

         [[-0.6988,    -inf,    -inf,    -inf],
          [ 1.1675, -1.9869,    -inf,    -inf],
          [ 0.0251, -1.6162, -0.8129,    -inf],
          [ 0.6427, -3.5904,  1.1677, -5.5783]],

         [[-0.4399,    -inf,    -inf,    -inf],
          [-2.1309,  1.0480,    -inf,    -inf],
          [ 0.7938,  1.7900, -1.5015,    -inf],
          [ 3.0191,  0.5607, -2.6990, -0.6012]],

         [[-3.7603,    -inf,    -inf,    -inf],
          [-1.4604, -1.3940,    -inf,    -inf],
          [-2.2571,  0.9455, -1.6110,    -inf],
          [ 0.3915, -0.2322,  4.7932,  2.8626]],

         [[ 5.1040,    -inf,    -inf,    -inf],
          [ 5.6121,  1.2823,    -inf,    -inf],
          [-1.2149,  0.8548, -3.0080,    -inf],
          [ 3.0027,  1.6429,  0.5883,  0.6395]],

         [[ 0.0108,    -inf,    -inf,    -inf],
          [ 3.2818, -3.8617,    -inf,    -inf],
          [-3.0886, -3.1350, -2.6408,    -inf],
          [-0.7849, -2.7421, -0.1716, -6.9443]],

         [[ 1.5166,    -inf,    -inf,    -inf],
          [ 5.5093, -1.4930,    -inf,    -inf],
          [-5.4817, -2.6854, -4.4599,    -inf],
          [-1.0264, -0.5948, -1.8553, -0.4161]],

         [[ 1.3732,    -inf,    -inf,    -inf],
          [ 0.8628,  0.6577,    -inf,    -inf],
          [-3.4998,  3.5940,  0.9138,    -inf],
          [-2.4641,  5.3648,  1.4900,  3.0325]],

         [[-1.7346,    -inf,    -inf,    -inf],
          [-3.1029, -3.3680,    -inf,    -inf],
          [-3.7497, -0.6004,  0.7457,    -inf],
          [-7.0598, -1.0325, -5.3917, -1.5882]],

         [[ 7.0410,    -inf,    -inf,    -inf],
          [ 2.7325,  3.0901,    -inf,    -inf],
          [ 4.0265,  2.8893, -0.9572,    -inf],
          [ 2.2147, -0.0235,  1.2531,  5.0104]]],


        [[[ 1.2872,    -inf,    -inf,    -inf],
          [-1.0135,  0.7303,    -inf,    -inf],
          [ 2.2452,  0.1836,  1.8849,    -inf],
          [-0.1449, -1.1448,  2.4980,  0.8175]],

         [[-0.5765,    -inf,    -inf,    -inf],
          [-0.6165, -0.6811,    -inf,    -inf],
          [ 0.7183, -1.8732, -0.4590,    -inf],
          [-0.6787, -0.5334,  2.0922, -3.6057]],

         [[-2.6609,    -inf,    -inf,    -inf],
          [ 2.0725, -0.4385,    -inf,    -inf],
          [-2.7931,  3.0779,  1.4702,    -inf],
          [-2.7444, -0.0688,  3.4484, -1.5260]],

         [[-0.1946,    -inf,    -inf,    -inf],
          [ 1.6700, -2.5408,    -inf,    -inf],
          [ 2.1246,  3.8735,  1.8182,    -inf],
          [ 4.5204,  5.4961,  1.8501,  3.3810]],

         [[ 0.2544,    -inf,    -inf,    -inf],
          [ 1.8104, -0.9840,    -inf,    -inf],
          [ 3.4663, -2.3752,  1.5594,    -inf],
          [ 5.6746,  0.7171,  1.7754,  3.1807]],

         [[-5.8360,    -inf,    -inf,    -inf],
          [-2.8111, -4.8158,    -inf,    -inf],
          [-0.5815,  0.7032, -0.7678,    -inf],
          [-6.1276, -3.2069, -3.2840, -1.4883]],

         [[-3.4928,    -inf,    -inf,    -inf],
          [ 5.1680,  2.5076,    -inf,    -inf],
          [-0.4723, -0.5387,  3.1717,    -inf],
          [-2.3770, -0.6209, -3.9657,  5.3710]],

         [[ 0.3229,    -inf,    -inf,    -inf],
          [-2.8425, -1.0148,    -inf,    -inf],
          [-1.8502, -2.9098, -2.7769,    -inf],
          [-4.0229, -8.0365, -0.6263, -6.4783]],

         [[-2.4662,    -inf,    -inf,    -inf],
          [-2.2661,  0.7376,    -inf,    -inf],
          [-3.0826, -0.6275, -0.9553,    -inf],
          [-2.8316,  1.1265, -5.2393, -0.4870]],

         [[ 3.2530,    -inf,    -inf,    -inf],
          [ 2.6673, -1.2604,    -inf,    -inf],
          [ 0.3371, -2.9599,  1.9070,    -inf],
          [ 0.6985, -0.6992, -0.6368,  1.1039]],

         [[ 0.3047,    -inf,    -inf,    -inf],
          [-0.8484,  1.1064,    -inf,    -inf],
          [ 1.9119,  1.6094,  1.7899,    -inf],
          [ 3.6393,  3.7290,  6.7465,  6.1264]],

         [[-1.5868,    -inf,    -inf,    -inf],
          [-0.0319,  2.6663,    -inf,    -inf],
          [ 0.3125,  1.7807, -0.3228,    -inf],
          [-0.4505,  3.1947,  2.8691, -4.6812]],

         [[ 3.9244,    -inf,    -inf,    -inf],
          [ 5.5868,  1.9451,    -inf,    -inf],
          [ 2.3762,  1.2188, -0.1319,    -inf],
          [-1.3258,  1.6677,  2.1843,  1.2751]],

         [[-0.7558,    -inf,    -inf,    -inf],
          [-0.1607, -2.7826,    -inf,    -inf],
          [-1.7425,  1.7780,  2.8554,    -inf],
          [-3.5781,  0.2160, -7.9144,  0.1598]],

         [[-1.3036,    -inf,    -inf,    -inf],
          [-3.2344, -2.8278,    -inf,    -inf],
          [ 0.7486, -3.8655, -3.9165,    -inf],
          [-4.8289, -3.0973, -3.4487,  1.5445]],

         [[ 0.0626,    -inf,    -inf,    -inf],
          [ 2.0334, -6.1939,    -inf,    -inf],
          [ 1.0351,  0.5142,  2.7537,    -inf],
          [ 0.9843, -1.7132,  3.2676,  0.9750]],

         [[-1.1832,    -inf,    -inf,    -inf],
          [ 0.5496,  0.3651,    -inf,    -inf],
          [ 1.9897,  0.9904, -1.1827,    -inf],
          [-2.3323,  1.5765, -2.7159, -0.6741]],

         [[-1.0353,    -inf,    -inf,    -inf],
          [-1.7656, -1.5455,    -inf,    -inf],
          [-3.7256, -1.1772,  2.1016,    -inf],
          [-0.5601, -5.5373,  1.7153,  0.5388]],

         [[-4.6804,    -inf,    -inf,    -inf],
          [-3.3626, -4.6410,    -inf,    -inf],
          [ 0.4762, -0.7879, -1.8887,    -inf],
          [ 0.6349, -4.8556, -5.6027,  2.1849]],

         [[ 3.5813,    -inf,    -inf,    -inf],
          [-1.6400,  2.7245,    -inf,    -inf],
          [-2.0747,  2.1920, -2.2836,    -inf],
          [-1.8122, -5.6079, -2.0852,  0.8918]],

         [[-0.0303,    -inf,    -inf,    -inf],
          [-0.2559,  0.1663,    -inf,    -inf],
          [-1.9235, -2.2073, -1.2768,    -inf],
          [-0.2994, -3.0693,  0.1602, -0.9173]],

         [[-0.4376,    -inf,    -inf,    -inf],
          [ 1.4993, -0.6116,    -inf,    -inf],
          [ 1.7359,  4.8265,  4.5921,    -inf],
          [ 0.6457,  0.0664, -0.9384, -0.5631]],

         [[-2.3567,    -inf,    -inf,    -inf],
          [-7.4376, -2.0845,    -inf,    -inf],
          [-5.4049, -0.3500, -0.0672,    -inf],
          [-2.5466, -0.1422, -1.0005,  1.2528]],

         [[-2.4157,    -inf,    -inf,    -inf],
          [-1.7345, -2.3550,    -inf,    -inf],
          [-2.1048,  1.2323, -0.7172,    -inf],
          [-2.1125, -2.6207,  1.5613, -1.2979]],

         [[ 8.3250,    -inf,    -inf,    -inf],
          [ 6.8647,  7.2490,    -inf,    -inf],
          [ 3.7017,  3.3591,  5.1575,    -inf],
          [ 3.9587,  3.7699,  3.7988,  2.1348]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 0.7559,    -inf,    -inf,    -inf],
          [ 1.2695, -0.2668,    -inf,    -inf],
          [ 0.2350,  0.9844, -1.9910,    -inf],
          [ 0.2173,  3.2338, -0.3129,  0.6340]],

         [[ 0.0340,    -inf,    -inf,    -inf],
          [-1.9397, -0.7417,    -inf,    -inf],
          [ 0.6231,  4.4780, -1.1302,    -inf],
          [ 0.5252,  2.0842,  2.9956, -1.3111]],

         [[ 0.2461,    -inf,    -inf,    -inf],
          [ 2.1887,  0.6892,    -inf,    -inf],
          [ 0.3584,  7.1044, -0.1741,    -inf],
          [ 0.2730,  4.9081,  0.9204, -4.0674]],

         [[ 5.5471,    -inf,    -inf,    -inf],
          [ 3.0749,  0.8176,    -inf,    -inf],
          [ 4.2649,  3.4760,  1.5338,    -inf],
          [ 1.9083,  1.6315,  2.7666,  0.6934]],

         [[ 1.9504,    -inf,    -inf,    -inf],
          [ 2.4970,  2.6366,    -inf,    -inf],
          [-0.8641,  0.9802, -1.7741,    -inf],
          [ 0.7500, -1.1912,  2.8601, -0.9952]],

         [[-6.4548,    -inf,    -inf,    -inf],
          [-6.9112, -5.8922,    -inf,    -inf],
          [-4.8574,  1.0327,  1.2603,    -inf],
          [-3.0558, -0.0849,  0.1610, -1.4149]],

         [[-1.7558,    -inf,    -inf,    -inf],
          [ 1.9664,  0.9569,    -inf,    -inf],
          [-0.9601, -1.8184,  4.1609,    -inf],
          [-0.9261, -2.2390, -2.6571,  0.5090]],

         [[-3.2169,    -inf,    -inf,    -inf],
          [-9.0150, -3.8766,    -inf,    -inf],
          [-3.9267,  0.0418, -0.1825,    -inf],
          [-1.7095,  4.2582, -0.8072, -2.2153]],

         [[ 1.8121,    -inf,    -inf,    -inf],
          [-4.1407, -2.0985,    -inf,    -inf],
          [ 2.6636, -1.1852, -1.4187,    -inf],
          [-2.9877, -1.6414, -0.3061,  0.2324]],

         [[ 1.3224,    -inf,    -inf,    -inf],
          [ 2.1608,  0.0746,    -inf,    -inf],
          [ 6.8162,  4.7985,  2.6865,    -inf],
          [-0.8630, -0.5019,  1.8260, -0.9432]],

         [[ 0.9886,    -inf,    -inf,    -inf],
          [-2.3708, -0.2725,    -inf,    -inf],
          [ 6.5662, -0.3360,  1.7841,    -inf],
          [ 7.6270,  3.1717,  6.0830,  5.5956]],

         [[ 1.8162,    -inf,    -inf,    -inf],
          [ 0.9865, -1.5245,    -inf,    -inf],
          [ 4.4986,  0.4675, -2.3941,    -inf],
          [ 4.2395,  3.2314,  2.9216, -0.5936]],

         [[ 1.8097,    -inf,    -inf,    -inf],
          [ 2.9100,  1.3487,    -inf,    -inf],
          [ 1.5728,  0.4555,  3.2231,    -inf],
          [-0.1594, -1.2255,  1.1013, -1.5378]],

         [[ 2.5211,    -inf,    -inf,    -inf],
          [ 4.6754, -0.7783,    -inf,    -inf],
          [-2.3021, -3.5261,  1.4086,    -inf],
          [ 1.0441, -0.3702, -7.7023, -2.0355]],

         [[ 0.4175,    -inf,    -inf,    -inf],
          [-3.3898, -2.6933,    -inf,    -inf],
          [ 1.8997, -1.2895, -3.0226,    -inf],
          [-2.2360, -1.5818,  1.4297, -3.6736]],

         [[ 0.5003,    -inf,    -inf,    -inf],
          [ 1.6667, -1.6646,    -inf,    -inf],
          [ 2.8100,  1.5449,  1.5347,    -inf],
          [-0.6785, -1.0360,  1.5137, -0.7838]],

         [[-0.6988,    -inf,    -inf,    -inf],
          [ 1.1675, -1.9869,    -inf,    -inf],
          [ 0.0251, -1.6162, -0.8129,    -inf],
          [ 0.6427, -3.5904,  1.1677, -5.5783]],

         [[-0.4399,    -inf,    -inf,    -inf],
          [-2.1309,  1.0480,    -inf,    -inf],
          [ 0.7938,  1.7900, -1.5015,    -inf],
          [ 3.0191,  0.5607, -2.6990, -0.6012]],

         [[-3.7603,    -inf,    -inf,    -inf],
          [-1.4604, -1.3940,    -inf,    -inf],
          [-2.2571,  0.9455, -1.6110,    -inf],
          [ 0.3915, -0.2322,  4.7932,  2.8626]],

         [[ 5.1040,    -inf,    -inf,    -inf],
          [ 5.6121,  1.2823,    -inf,    -inf],
          [-1.2149,  0.8548, -3.0080,    -inf],
          [ 3.0027,  1.6429,  0.5883,  0.6395]],

         [[ 0.0108,    -inf,    -inf,    -inf],
          [ 3.2818, -3.8617,    -inf,    -inf],
          [-3.0886, -3.1350, -2.6408,    -inf],
          [-0.7849, -2.7421, -0.1716, -6.9443]],

         [[ 1.5166,    -inf,    -inf,    -inf],
          [ 5.5093, -1.4930,    -inf,    -inf],
          [-5.4817, -2.6854, -4.4599,    -inf],
          [-1.0264, -0.5948, -1.8553, -0.4161]],

         [[ 1.3732,    -inf,    -inf,    -inf],
          [ 0.8628,  0.6577,    -inf,    -inf],
          [-3.4998,  3.5940,  0.9138,    -inf],
          [-2.4641,  5.3648,  1.4900,  3.0325]],

         [[-1.7346,    -inf,    -inf,    -inf],
          [-3.1029, -3.3680,    -inf,    -inf],
          [-3.7497, -0.6004,  0.7457,    -inf],
          [-7.0598, -1.0325, -5.3917, -1.5882]],

         [[ 7.0410,    -inf,    -inf,    -inf],
          [ 2.7325,  3.0901,    -inf,    -inf],
          [ 4.0265,  2.8893, -0.9572,    -inf],
          [ 2.2147, -0.0235,  1.2531,  5.0104]]],


        [[[ 1.2872,    -inf,    -inf,    -inf],
          [-1.0135,  0.7303,    -inf,    -inf],
          [ 2.2452,  0.1836,  1.8849,    -inf],
          [-0.1449, -1.1448,  2.4980,  0.8175]],

         [[-0.5765,    -inf,    -inf,    -inf],
          [-0.6165, -0.6811,    -inf,    -inf],
          [ 0.7183, -1.8732, -0.4590,    -inf],
          [-0.6787, -0.5334,  2.0922, -3.6057]],

         [[-2.6609,    -inf,    -inf,    -inf],
          [ 2.0725, -0.4385,    -inf,    -inf],
          [-2.7931,  3.0779,  1.4702,    -inf],
          [-2.7444, -0.0688,  3.4484, -1.5260]],

         [[-0.1946,    -inf,    -inf,    -inf],
          [ 1.6700, -2.5408,    -inf,    -inf],
          [ 2.1246,  3.8735,  1.8182,    -inf],
          [ 4.5204,  5.4961,  1.8501,  3.3810]],

         [[ 0.2544,    -inf,    -inf,    -inf],
          [ 1.8104, -0.9840,    -inf,    -inf],
          [ 3.4663, -2.3752,  1.5594,    -inf],
          [ 5.6746,  0.7171,  1.7754,  3.1807]],

         [[-5.8360,    -inf,    -inf,    -inf],
          [-2.8111, -4.8158,    -inf,    -inf],
          [-0.5815,  0.7032, -0.7678,    -inf],
          [-6.1276, -3.2069, -3.2840, -1.4883]],

         [[-3.4928,    -inf,    -inf,    -inf],
          [ 5.1680,  2.5076,    -inf,    -inf],
          [-0.4723, -0.5387,  3.1717,    -inf],
          [-2.3770, -0.6209, -3.9657,  5.3710]],

         [[ 0.3229,    -inf,    -inf,    -inf],
          [-2.8425, -1.0148,    -inf,    -inf],
          [-1.8502, -2.9098, -2.7769,    -inf],
          [-4.0229, -8.0365, -0.6263, -6.4783]],

         [[-2.4662,    -inf,    -inf,    -inf],
          [-2.2661,  0.7376,    -inf,    -inf],
          [-3.0826, -0.6275, -0.9553,    -inf],
          [-2.8316,  1.1265, -5.2393, -0.4870]],

         [[ 3.2530,    -inf,    -inf,    -inf],
          [ 2.6673, -1.2604,    -inf,    -inf],
          [ 0.3371, -2.9599,  1.9070,    -inf],
          [ 0.6985, -0.6992, -0.6368,  1.1039]],

         [[ 0.3047,    -inf,    -inf,    -inf],
          [-0.8484,  1.1064,    -inf,    -inf],
          [ 1.9119,  1.6094,  1.7899,    -inf],
          [ 3.6393,  3.7290,  6.7465,  6.1264]],

         [[-1.5868,    -inf,    -inf,    -inf],
          [-0.0319,  2.6663,    -inf,    -inf],
          [ 0.3125,  1.7807, -0.3228,    -inf],
          [-0.4505,  3.1947,  2.8691, -4.6812]],

         [[ 3.9244,    -inf,    -inf,    -inf],
          [ 5.5868,  1.9451,    -inf,    -inf],
          [ 2.3762,  1.2188, -0.1319,    -inf],
          [-1.3258,  1.6677,  2.1843,  1.2751]],

         [[-0.7558,    -inf,    -inf,    -inf],
          [-0.1607, -2.7826,    -inf,    -inf],
          [-1.7425,  1.7780,  2.8554,    -inf],
          [-3.5781,  0.2160, -7.9144,  0.1598]],

         [[-1.3036,    -inf,    -inf,    -inf],
          [-3.2344, -2.8278,    -inf,    -inf],
          [ 0.7486, -3.8655, -3.9165,    -inf],
          [-4.8289, -3.0973, -3.4487,  1.5445]],

         [[ 0.0626,    -inf,    -inf,    -inf],
          [ 2.0334, -6.1939,    -inf,    -inf],
          [ 1.0351,  0.5142,  2.7537,    -inf],
          [ 0.9843, -1.7132,  3.2676,  0.9750]],

         [[-1.1832,    -inf,    -inf,    -inf],
          [ 0.5496,  0.3651,    -inf,    -inf],
          [ 1.9897,  0.9904, -1.1827,    -inf],
          [-2.3323,  1.5765, -2.7159, -0.6741]],

         [[-1.0353,    -inf,    -inf,    -inf],
          [-1.7656, -1.5455,    -inf,    -inf],
          [-3.7256, -1.1772,  2.1016,    -inf],
          [-0.5601, -5.5373,  1.7153,  0.5388]],

         [[-4.6804,    -inf,    -inf,    -inf],
          [-3.3626, -4.6410,    -inf,    -inf],
          [ 0.4762, -0.7879, -1.8887,    -inf],
          [ 0.6349, -4.8556, -5.6027,  2.1849]],

         [[ 3.5813,    -inf,    -inf,    -inf],
          [-1.6400,  2.7245,    -inf,    -inf],
          [-2.0747,  2.1920, -2.2836,    -inf],
          [-1.8122, -5.6079, -2.0852,  0.8918]],

         [[-0.0303,    -inf,    -inf,    -inf],
          [-0.2559,  0.1663,    -inf,    -inf],
          [-1.9235, -2.2073, -1.2768,    -inf],
          [-0.2994, -3.0693,  0.1602, -0.9173]],

         [[-0.4376,    -inf,    -inf,    -inf],
          [ 1.4993, -0.6116,    -inf,    -inf],
          [ 1.7359,  4.8265,  4.5921,    -inf],
          [ 0.6457,  0.0664, -0.9384, -0.5631]],

         [[-2.3567,    -inf,    -inf,    -inf],
          [-7.4376, -2.0845,    -inf,    -inf],
          [-5.4049, -0.3500, -0.0672,    -inf],
          [-2.5466, -0.1422, -1.0005,  1.2528]],

         [[-2.4157,    -inf,    -inf,    -inf],
          [-1.7345, -2.3550,    -inf,    -inf],
          [-2.1048,  1.2323, -0.7172,    -inf],
          [-2.1125, -2.6207,  1.5613, -1.2979]],

         [[ 8.3250,    -inf,    -inf,    -inf],
          [ 6.8647,  7.2490,    -inf,    -inf],
          [ 3.7017,  3.3591,  5.1575,    -inf],
          [ 3.9587,  3.7699,  3.7988,  2.1348]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.5718,  0.1296, -0.5368,  ..., -0.4991,  1.6915,  0.9480],
          [ 1.6564,  0.1322,  0.0443,  ..., -0.1497, -0.2414, -0.0710],
          [-0.7269,  0.0538,  0.2155,  ...,  0.5412,  1.2528,  0.0920],
          ...,
          [ 0.3257, -0.6764,  0.4165,  ..., -0.1591, -0.9808,  0.4082],
          [-0.0369, -0.9761, -0.0373,  ..., -0.3276, -0.2564, -0.9981],
          [ 0.0226,  0.1867, -0.8086,  ...,  1.5254,  1.0307, -0.0595]],

         [[ 0.7558,  0.2359, -0.2101,  ..., -0.4203,  1.0183,  0.7040],
          [ 0.9421,  0.2208,  0.1220,  ..., -0.7104, -0.1518,  0.0235],
          [-0.3974,  0.0294,  0.1178,  ...,  0.2959,  0.6849,  0.0503],
          ...,
          [ 0.1649, -0.3425,  0.2109,  ..., -0.0806, -0.4967,  0.2067],
          [-0.0187, -0.4961, -0.0190,  ..., -0.1665, -0.1303, -0.5073],
          [ 0.1003, -0.0979, -0.8806,  ...,  0.9205,  0.7260, -0.3965]],

         [[ 0.5767,  0.1856, -0.1166,  ..., -0.2997,  0.6703,  0.4891],
          [ 0.9238,  0.3772,  0.2337,  ..., -0.5287, -0.1297, -0.0246],
          [-0.5393, -0.8009,  0.1436,  ..., -0.4439, -0.0348, -0.2711],
          ...,
          [ 0.2262,  0.0408,  0.1456,  ...,  0.1288, -0.5089,  0.2254],
          [ 0.3048, -0.8154, -0.1667,  ..., -0.4243,  0.0202, -1.1819],
          [ 0.0724, -0.0558, -0.6790,  ...,  0.7580,  0.5856, -0.2842]],

         [[ 0.5033, -0.1317, -0.0880,  ..., -0.2115,  0.6187,  0.5186],
          [ 0.8995,  0.5452,  0.4328,  ..., -0.3432, -0.1732,  0.0391],
          [-0.1904, -0.6675, -0.1039,  ..., -0.4608, -0.2852, -0.1281],
          ...,
          [-0.0649, -0.2029,  0.2529,  ..., -0.0991, -0.8663, -0.0086],
          [ 0.3375, -0.5515,  0.0401,  ..., -0.3597,  0.1410, -1.3386],
          [ 0.2114, -0.0188, -0.8163,  ...,  0.3965,  1.1971,  0.0979]]],


        [[[ 0.9653,  0.0852, -0.0527,  ..., -0.4837,  1.4546,  0.9436],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.3875,  0.0432,  0.0947,  ...,  0.2133,  1.3405,  0.0576],
          ...,
          [-0.4353, -0.4047,  0.5648,  ..., -0.3204, -1.0489,  0.9400],
          [-0.0148, -0.5136,  0.0192,  ...,  0.6153, -0.2932, -0.8816],
          [ 0.4371,  0.3849, -1.0197,  ...,  1.4246,  1.0100, -0.9712]],

         [[ 0.6655, -0.2245,  0.0948,  ..., -1.1015,  1.1143,  0.5883],
          [ 0.4827,  0.0866,  0.5402,  ..., -0.6228, -0.2330,  0.2362],
          [-0.4167, -0.1389,  0.1308,  ..., -0.2628,  0.8314, -0.2008],
          ...,
          [-0.6144, -0.0101,  0.4884,  ...,  0.0057, -1.4627, -0.0647],
          [ 0.3765, -0.4199,  0.0971,  ...,  0.2293,  0.1087, -0.8470],
          [-0.0313,  0.6108, -1.1220,  ...,  0.7072,  0.7959, -0.5777]],

         [[ 0.3586, -0.0993,  0.0999,  ..., -0.6177,  0.4692,  0.6118],
          [ 0.1967,  0.2371,  0.1960,  ..., -0.7079, -0.1796, -0.3176],
          [-0.4500, -0.2246, -0.0431,  ..., -0.6945,  0.0617, -0.3486],
          ...,
          [-0.4606,  0.0342,  0.1031,  ..., -0.0826, -1.8070, -0.0781],
          [ 0.2786, -0.1237, -0.0411,  ...,  0.2759,  0.0819, -0.7193],
          [-0.0065,  0.3726, -0.6929,  ...,  0.4583,  0.4994, -0.3690]],

         [[ 0.2003, -0.0724,  0.0839,  ..., -0.4193,  0.2265,  0.4378],
          [ 0.1953,  0.2093,  0.3339,  ..., -0.3757, -0.2339,  0.1957],
          [-0.4854, -0.0821, -0.1734,  ..., -0.3479,  0.2673, -0.2843],
          ...,
          [ 0.0214, -0.4005,  0.1002,  ..., -0.0649, -1.3539, -0.3772],
          [ 0.1001, -0.0397, -0.0324,  ...,  0.3003, -0.1865, -0.6955],
          [-0.2276,  0.4372, -0.8266,  ...,  0.4387,  0.7676, -0.2622]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.5718,  0.1296, -0.5368,  ...,  1.5254,  1.0307, -0.0595],
         [ 0.7558,  0.2359, -0.2101,  ...,  0.9205,  0.7260, -0.3965],
         [ 0.5767,  0.1856, -0.1166,  ...,  0.7580,  0.5856, -0.2842],
         [ 0.5033, -0.1317, -0.0880,  ...,  0.3965,  1.1971,  0.0979]],

        [[ 0.9653,  0.0852, -0.0527,  ...,  1.4246,  1.0100, -0.9712],
         [ 0.6655, -0.2245,  0.0948,  ...,  0.7072,  0.7959, -0.5777],
         [ 0.3586, -0.0993,  0.0999,  ...,  0.4583,  0.4994, -0.3690],
         [ 0.2003, -0.0724,  0.0839,  ...,  0.4387,  0.7676, -0.2622]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2350,  0.1385, -0.0140,  ..., -0.0752, -0.4574, -0.5440],
         [ 0.0219,  0.1178,  0.2387,  ...,  0.4511, -0.4026, -0.4000],
         [-0.0823, -0.0352,  0.2066,  ...,  0.4955, -0.3473, -0.5252],
         [ 0.0937, -0.0897,  0.1629,  ...,  0.4941, -0.3725, -0.2575]],

        [[-0.0400,  0.2965, -0.1296,  ...,  0.4596, -0.0190, -0.0968],
         [ 0.4041, -0.1004, -0.0243,  ...,  0.1952,  0.0807, -0.1501],
         [ 0.0350,  0.1949, -0.0522,  ...,  0.4397, -0.1391, -0.0423],
         [ 0.1021,  0.1820,  0.0628,  ...,  0.4034, -0.0907, -0.0384]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 2.8816e+00,        -inf,        -inf,        -inf],
          [-1.7507e+00, -3.4166e-01,        -inf,        -inf],
          [-4.2471e+00, -3.0124e+00, -3.2804e+00,        -inf],
          [ 1.2808e+00,  2.9160e+00,  2.0208e+00, -5.9028e-01]],

         [[-4.3248e+00,        -inf,        -inf,        -inf],
          [ 6.6480e-01,  1.4847e-01,        -inf,        -inf],
          [-2.5635e+00, -2.7225e-01,  2.8961e+00,        -inf],
          [-1.2802e+00,  2.1772e+00,  4.6214e+00, -3.2733e+00]],

         [[ 3.5235e+00,        -inf,        -inf,        -inf],
          [ 1.3814e+00,  1.7273e+00,        -inf,        -inf],
          [-5.2306e-01,  5.8841e+00,  2.0278e+00,        -inf],
          [ 1.4021e+00, -1.6402e+00,  1.6125e+00,  2.5214e+00]],

         [[-5.1585e-01,        -inf,        -inf,        -inf],
          [ 2.9432e+00,  3.4006e+00,        -inf,        -inf],
          [ 5.4614e+00,  3.8311e+00, -6.7224e-01,        -inf],
          [ 2.3861e+00,  3.0145e+00, -4.3319e-03, -1.2698e+00]],

         [[-3.0185e+00,        -inf,        -inf,        -inf],
          [ 2.8361e+00,  2.4400e+00,        -inf,        -inf],
          [ 4.0655e+00,  1.3909e+00, -3.5801e+00,        -inf],
          [-1.9670e+00, -3.5527e+00, -4.5736e+00, -2.8123e+00]],

         [[ 2.5179e+00,        -inf,        -inf,        -inf],
          [ 5.6973e-01,  1.1486e+00,        -inf,        -inf],
          [ 3.9519e+00,  1.0204e+00, -4.3315e-01,        -inf],
          [ 3.1071e+00,  2.2355e+00,  6.6518e-01, -4.0669e+00]],

         [[-3.9464e+00,        -inf,        -inf,        -inf],
          [-1.9348e+00,  3.7841e+00,        -inf,        -inf],
          [-3.1908e+00, -2.6296e+00, -7.3367e-01,        -inf],
          [-7.0273e+00, -1.5983e+00, -7.2182e+00, -2.9765e+00]],

         [[-5.8238e-01,        -inf,        -inf,        -inf],
          [-7.1334e-01,  1.3727e-01,        -inf,        -inf],
          [ 3.8818e+00, -7.4828e-01, -5.8052e-01,        -inf],
          [ 1.5083e+00,  2.8964e+00,  3.5155e+00,  7.5711e-01]],

         [[ 2.0598e+00,        -inf,        -inf,        -inf],
          [ 3.8500e+00, -1.8182e+00,        -inf,        -inf],
          [ 6.3849e+00,  1.4217e+00,  3.3641e+00,        -inf],
          [ 1.8618e+00, -1.1933e+00,  1.1722e+00, -1.8875e+00]],

         [[-6.4042e+00,        -inf,        -inf,        -inf],
          [-2.7262e+00, -1.6114e+00,        -inf,        -inf],
          [-2.3586e+00, -1.4943e+00,  1.0686e+00,        -inf],
          [-5.3584e+00, -3.2296e+00,  1.1033e+00, -3.3293e+00]],

         [[ 8.7167e-01,        -inf,        -inf,        -inf],
          [ 9.0632e-01,  1.6627e+00,        -inf,        -inf],
          [-1.2065e+00,  1.9174e+00,  4.3303e+00,        -inf],
          [ 4.5414e-01,  3.8159e+00, -2.1169e-01, -4.1524e+00]],

         [[-2.1861e+00,        -inf,        -inf,        -inf],
          [-1.8339e+00,  4.3637e-01,        -inf,        -inf],
          [-2.2231e+00, -2.1753e+00,  1.3302e-02,        -inf],
          [-3.5276e+00,  4.0024e+00,  2.7661e+00,  1.7314e+00]],

         [[ 1.3631e+00,        -inf,        -inf,        -inf],
          [-4.0331e+00, -2.2123e+00,        -inf,        -inf],
          [-2.6075e+00,  6.6577e-01, -4.1670e+00,        -inf],
          [-3.7943e+00, -1.2216e-01, -3.2996e+00, -6.6931e+00]],

         [[-5.5271e-01,        -inf,        -inf,        -inf],
          [ 1.3710e+00,  1.6374e+00,        -inf,        -inf],
          [ 8.3488e-01, -1.6059e+00, -8.3378e-01,        -inf],
          [ 3.9577e+00, -7.5464e-01,  2.3222e+00,  2.4890e+00]],

         [[ 2.6000e-01,        -inf,        -inf,        -inf],
          [ 2.8360e+00, -2.8955e-01,        -inf,        -inf],
          [ 2.1268e+00,  8.9731e-01, -2.8496e+00,        -inf],
          [ 8.6336e-01, -5.7966e+00, -3.2628e+00, -2.4203e+00]],

         [[-8.1654e-01,        -inf,        -inf,        -inf],
          [ 1.4925e+00, -9.4577e-01,        -inf,        -inf],
          [-3.3395e-01,  1.6983e-01,  2.1821e+00,        -inf],
          [-1.6807e+00,  1.1595e+00,  1.6536e+00, -2.8190e+00]],

         [[ 1.7301e+00,        -inf,        -inf,        -inf],
          [ 2.7816e+00,  9.9274e-01,        -inf,        -inf],
          [ 3.8114e+00,  2.5174e+00,  1.0400e+00,        -inf],
          [-1.3558e+00, -1.0468e-01, -8.4321e-01,  6.4441e-01]],

         [[-2.6544e+00,        -inf,        -inf,        -inf],
          [ 2.9099e+00, -4.6116e+00,        -inf,        -inf],
          [-2.7720e+00, -4.0759e+00, -1.9332e+00,        -inf],
          [-2.6840e+00, -2.3710e+00, -4.2254e+00, -1.1206e+00]],

         [[-1.9593e+00,        -inf,        -inf,        -inf],
          [-3.2787e-01,  1.4545e+00,        -inf,        -inf],
          [ 2.9897e-01, -1.0027e+00, -1.4211e+00,        -inf],
          [-6.6784e-01, -1.1315e+00,  8.1250e-01, -2.2843e+00]],

         [[-8.7509e-01,        -inf,        -inf,        -inf],
          [-2.5879e+00,  1.6913e+00,        -inf,        -inf],
          [-1.2317e+00,  4.3067e-01,  5.8787e+00,        -inf],
          [ 1.9337e+00,  2.9051e+00, -1.6724e+00, -1.1245e+00]],

         [[-1.3302e-01,        -inf,        -inf,        -inf],
          [-1.4297e+00,  1.1606e+00,        -inf,        -inf],
          [ 7.2889e-01,  3.3819e+00, -3.6524e+00,        -inf],
          [ 2.8807e+00,  1.6112e+00, -3.2348e+00, -8.5988e-02]],

         [[ 2.5319e+00,        -inf,        -inf,        -inf],
          [-2.1817e+00, -3.7659e+00,        -inf,        -inf],
          [ 1.2675e+00, -2.2158e+00, -2.1659e+00,        -inf],
          [-2.3346e+00, -2.4323e+00, -1.7843e+00, -3.0249e+00]],

         [[-8.8921e-01,        -inf,        -inf,        -inf],
          [-1.8482e+00, -6.2500e+00,        -inf,        -inf],
          [-3.9643e+00, -3.8439e-01,  4.4832e-01,        -inf],
          [-7.5926e+00, -3.7075e+00, -1.2932e+00, -9.0893e-01]],

         [[ 3.7055e+00,        -inf,        -inf,        -inf],
          [-1.9723e+00,  1.6757e+00,        -inf,        -inf],
          [-1.8384e+00, -1.7735e+00,  2.1501e+00,        -inf],
          [-2.2301e+00,  7.7021e-01, -8.4101e-01, -1.1519e+00]],

         [[-5.0585e-01,        -inf,        -inf,        -inf],
          [ 4.3674e-01, -5.8082e-01,        -inf,        -inf],
          [-3.7893e+00, -8.1184e-01,  3.0104e+00,        -inf],
          [ 3.9466e+00,  4.8997e-01,  1.7145e+00,  2.4276e+00]]],


        [[[ 4.2913e+00,        -inf,        -inf,        -inf],
          [-7.9317e-01, -7.7916e-02,        -inf,        -inf],
          [-6.3724e-01,  4.2492e-01,  3.4208e-01,        -inf],
          [ 1.2270e+00,  1.6916e+00,  6.3173e+00,  2.7836e+00]],

         [[-9.1415e-01,        -inf,        -inf,        -inf],
          [ 2.2663e+00, -2.2647e+00,        -inf,        -inf],
          [-1.4370e+00, -1.5974e+00, -2.4102e+00,        -inf],
          [-1.3262e+00, -1.8735e+00,  9.0949e-01, -5.5504e-01]],

         [[ 6.8524e+00,        -inf,        -inf,        -inf],
          [ 1.8823e+00,  7.8828e-01,        -inf,        -inf],
          [-6.5115e-01, -2.3138e+00, -3.3028e+00,        -inf],
          [ 1.3549e+00, -5.9744e+00, -4.0271e+00, -1.2369e+00]],

         [[-2.2225e+00,        -inf,        -inf,        -inf],
          [-9.8271e-01,  2.2994e+00,        -inf,        -inf],
          [ 1.2624e+00, -6.8232e-01, -4.6535e-01,        -inf],
          [-2.8153e+00, -3.1153e+00, -3.3010e+00, -8.4986e+00]],

         [[ 7.0912e-01,        -inf,        -inf,        -inf],
          [ 2.8490e+00, -6.5120e-01,        -inf,        -inf],
          [ 1.4342e+00,  1.5603e+00, -5.0650e+00,        -inf],
          [ 4.6993e-01, -3.2360e+00, -1.9014e+00,  6.2893e-01]],

         [[ 4.3547e-01,        -inf,        -inf,        -inf],
          [ 3.0459e+00,  3.3957e+00,        -inf,        -inf],
          [ 3.8761e+00,  4.7574e-01, -5.5843e-01,        -inf],
          [ 3.4739e-01, -2.7656e-01, -3.6529e-01,  1.5284e+00]],

         [[-2.5010e+00,        -inf,        -inf,        -inf],
          [-4.3332e+00, -2.5023e+00,        -inf,        -inf],
          [-1.8732e+00, -1.0091e+00, -3.0590e+00,        -inf],
          [-4.9724e+00, -1.8292e+00, -1.4493e+00, -2.9405e+00]],

         [[ 1.6410e+00,        -inf,        -inf,        -inf],
          [ 2.4659e+00, -1.0902e-01,        -inf,        -inf],
          [ 1.5990e+00,  1.6117e+00,  2.0904e-01,        -inf],
          [ 3.9349e+00, -2.1630e+00,  7.3928e+00,  4.0732e+00]],

         [[ 1.6651e+00,        -inf,        -inf,        -inf],
          [-8.3537e-02,  1.2509e+00,        -inf,        -inf],
          [ 4.2452e+00,  1.5149e+00,  4.4116e+00,        -inf],
          [ 3.2851e+00, -4.3206e-01,  1.4221e+00,  2.7868e+00]],

         [[-5.6731e+00,        -inf,        -inf,        -inf],
          [-2.7582e+00, -3.0607e+00,        -inf,        -inf],
          [ 6.3063e-02, -6.4569e-01, -1.0066e+00,        -inf],
          [-6.5609e+00, -3.8032e+00, -1.6611e+00, -2.6123e+00]],

         [[ 2.4211e+00,        -inf,        -inf,        -inf],
          [ 3.3238e+00,  3.1137e+00,        -inf,        -inf],
          [ 4.6233e+00,  7.3160e+00,  1.5705e+00,        -inf],
          [ 3.0930e+00,  6.5875e+00,  9.0144e+00,  2.9825e+00]],

         [[-1.2644e+00,        -inf,        -inf,        -inf],
          [-1.6606e+00,  1.9984e+00,        -inf,        -inf],
          [-2.6173e-01, -7.0329e-01,  1.6703e+00,        -inf],
          [ 9.3091e-01, -1.4488e+00,  2.5037e-01,  2.2870e+00]],

         [[ 6.3494e-01,        -inf,        -inf,        -inf],
          [-4.5814e+00,  6.8480e-01,        -inf,        -inf],
          [-1.7313e+00, -1.8421e+00, -2.3166e+00,        -inf],
          [-7.3325e-01, -6.9556e-01, -7.2242e-01,  1.7389e+00]],

         [[-3.6289e+00,        -inf,        -inf,        -inf],
          [-1.3550e+00,  2.8990e+00,        -inf,        -inf],
          [ 3.2248e+00,  2.6714e+00,  5.4038e+00,        -inf],
          [ 6.4131e-01, -3.8803e-01, -4.1841e-01, -3.0411e+00]],

         [[ 3.2748e+00,        -inf,        -inf,        -inf],
          [ 4.7085e+00, -1.7119e+00,        -inf,        -inf],
          [ 3.2301e+00, -6.3881e-01,  3.3294e+00,        -inf],
          [ 6.1485e-01, -3.1387e+00,  2.0006e+00,  2.4041e-01]],

         [[ 7.3605e-01,        -inf,        -inf,        -inf],
          [ 1.2800e+00,  7.6986e-01,        -inf,        -inf],
          [ 4.6013e+00, -1.0332e+00,  2.2832e+00,        -inf],
          [ 3.3766e+00,  8.3138e-01,  1.5546e+00,  2.4147e+00]],

         [[-8.7651e-01,        -inf,        -inf,        -inf],
          [ 3.3618e+00,  5.7718e+00,        -inf,        -inf],
          [ 3.3598e+00,  4.8585e+00,  3.1251e+00,        -inf],
          [-3.6352e+00,  2.6337e+00,  2.3726e+00, -9.7568e-01]],

         [[-3.6498e-01,        -inf,        -inf,        -inf],
          [ 1.8309e+00,  6.8891e+00,        -inf,        -inf],
          [ 2.1839e+00,  1.3785e+00,  2.7458e+00,        -inf],
          [ 9.4502e-01,  6.1161e+00,  5.6448e+00,  5.4321e+00]],

         [[-4.1818e-02,        -inf,        -inf,        -inf],
          [ 1.3110e+00, -5.4340e-01,        -inf,        -inf],
          [-6.8325e-02, -1.8576e-02,  7.1566e-01,        -inf],
          [ 6.8180e-01, -3.8826e+00, -4.1465e+00, -5.0901e+00]],

         [[ 7.4961e-01,        -inf,        -inf,        -inf],
          [-2.2451e-02,  3.0908e+00,        -inf,        -inf],
          [ 6.2936e-01, -1.6963e-01,  2.7399e+00,        -inf],
          [ 1.1849e+00, -2.4049e+00, -7.9957e-01,  1.0054e+00]],

         [[-1.2822e+00,        -inf,        -inf,        -inf],
          [-3.1201e+00, -4.2955e+00,        -inf,        -inf],
          [ 2.5810e-01,  4.7249e+00, -2.4948e+00,        -inf],
          [ 1.2484e+00,  3.8300e+00, -3.9900e-02,  1.5043e-01]],

         [[ 6.3431e-01,        -inf,        -inf,        -inf],
          [ 6.1426e-01, -3.4046e+00,        -inf,        -inf],
          [ 1.7064e+00, -7.5175e-01, -3.0156e-01,        -inf],
          [ 2.3225e+00, -2.4254e+00, -5.7707e+00, -2.6775e+00]],

         [[ 6.8374e-02,        -inf,        -inf,        -inf],
          [ 8.7495e-01,  9.8734e-01,        -inf,        -inf],
          [ 3.0954e+00,  2.2218e+00,  3.9170e-01,        -inf],
          [ 1.5803e+00,  1.5364e+00,  1.2808e+00, -1.2418e+00]],

         [[-2.8696e-01,        -inf,        -inf,        -inf],
          [-2.2755e+00,  3.5946e+00,        -inf,        -inf],
          [-6.9684e-01,  1.9251e+00,  5.4542e+00,        -inf],
          [-6.6131e-01,  8.0511e-01,  5.4113e-01, -1.5863e+00]],

         [[-9.2999e-01,        -inf,        -inf,        -inf],
          [ 7.7194e-01, -3.8917e+00,        -inf,        -inf],
          [ 2.9411e+00,  1.5840e+00,  5.0130e+00,        -inf],
          [ 4.6636e+00,  3.5431e+00,  3.1781e+00,  2.1164e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 2.8816e+00,        -inf,        -inf,        -inf],
          [-1.7507e+00, -3.4166e-01,        -inf,        -inf],
          [-4.2471e+00, -3.0124e+00, -3.2804e+00,        -inf],
          [ 1.2808e+00,  2.9160e+00,  2.0208e+00, -5.9028e-01]],

         [[-4.3248e+00,        -inf,        -inf,        -inf],
          [ 6.6480e-01,  1.4847e-01,        -inf,        -inf],
          [-2.5635e+00, -2.7225e-01,  2.8961e+00,        -inf],
          [-1.2802e+00,  2.1772e+00,  4.6214e+00, -3.2733e+00]],

         [[ 3.5235e+00,        -inf,        -inf,        -inf],
          [ 1.3814e+00,  1.7273e+00,        -inf,        -inf],
          [-5.2306e-01,  5.8841e+00,  2.0278e+00,        -inf],
          [ 1.4021e+00, -1.6402e+00,  1.6125e+00,  2.5214e+00]],

         [[-5.1585e-01,        -inf,        -inf,        -inf],
          [ 2.9432e+00,  3.4006e+00,        -inf,        -inf],
          [ 5.4614e+00,  3.8311e+00, -6.7224e-01,        -inf],
          [ 2.3861e+00,  3.0145e+00, -4.3319e-03, -1.2698e+00]],

         [[-3.0185e+00,        -inf,        -inf,        -inf],
          [ 2.8361e+00,  2.4400e+00,        -inf,        -inf],
          [ 4.0655e+00,  1.3909e+00, -3.5801e+00,        -inf],
          [-1.9670e+00, -3.5527e+00, -4.5736e+00, -2.8123e+00]],

         [[ 2.5179e+00,        -inf,        -inf,        -inf],
          [ 5.6973e-01,  1.1486e+00,        -inf,        -inf],
          [ 3.9519e+00,  1.0204e+00, -4.3315e-01,        -inf],
          [ 3.1071e+00,  2.2355e+00,  6.6518e-01, -4.0669e+00]],

         [[-3.9464e+00,        -inf,        -inf,        -inf],
          [-1.9348e+00,  3.7841e+00,        -inf,        -inf],
          [-3.1908e+00, -2.6296e+00, -7.3367e-01,        -inf],
          [-7.0273e+00, -1.5983e+00, -7.2182e+00, -2.9765e+00]],

         [[-5.8238e-01,        -inf,        -inf,        -inf],
          [-7.1334e-01,  1.3727e-01,        -inf,        -inf],
          [ 3.8818e+00, -7.4828e-01, -5.8052e-01,        -inf],
          [ 1.5083e+00,  2.8964e+00,  3.5155e+00,  7.5711e-01]],

         [[ 2.0598e+00,        -inf,        -inf,        -inf],
          [ 3.8500e+00, -1.8182e+00,        -inf,        -inf],
          [ 6.3849e+00,  1.4217e+00,  3.3641e+00,        -inf],
          [ 1.8618e+00, -1.1933e+00,  1.1722e+00, -1.8875e+00]],

         [[-6.4042e+00,        -inf,        -inf,        -inf],
          [-2.7262e+00, -1.6114e+00,        -inf,        -inf],
          [-2.3586e+00, -1.4943e+00,  1.0686e+00,        -inf],
          [-5.3584e+00, -3.2296e+00,  1.1033e+00, -3.3293e+00]],

         [[ 8.7167e-01,        -inf,        -inf,        -inf],
          [ 9.0632e-01,  1.6627e+00,        -inf,        -inf],
          [-1.2065e+00,  1.9174e+00,  4.3303e+00,        -inf],
          [ 4.5414e-01,  3.8159e+00, -2.1169e-01, -4.1524e+00]],

         [[-2.1861e+00,        -inf,        -inf,        -inf],
          [-1.8339e+00,  4.3637e-01,        -inf,        -inf],
          [-2.2231e+00, -2.1753e+00,  1.3302e-02,        -inf],
          [-3.5276e+00,  4.0024e+00,  2.7661e+00,  1.7314e+00]],

         [[ 1.3631e+00,        -inf,        -inf,        -inf],
          [-4.0331e+00, -2.2123e+00,        -inf,        -inf],
          [-2.6075e+00,  6.6577e-01, -4.1670e+00,        -inf],
          [-3.7943e+00, -1.2216e-01, -3.2996e+00, -6.6931e+00]],

         [[-5.5271e-01,        -inf,        -inf,        -inf],
          [ 1.3710e+00,  1.6374e+00,        -inf,        -inf],
          [ 8.3488e-01, -1.6059e+00, -8.3378e-01,        -inf],
          [ 3.9577e+00, -7.5464e-01,  2.3222e+00,  2.4890e+00]],

         [[ 2.6000e-01,        -inf,        -inf,        -inf],
          [ 2.8360e+00, -2.8955e-01,        -inf,        -inf],
          [ 2.1268e+00,  8.9731e-01, -2.8496e+00,        -inf],
          [ 8.6336e-01, -5.7966e+00, -3.2628e+00, -2.4203e+00]],

         [[-8.1654e-01,        -inf,        -inf,        -inf],
          [ 1.4925e+00, -9.4577e-01,        -inf,        -inf],
          [-3.3395e-01,  1.6983e-01,  2.1821e+00,        -inf],
          [-1.6807e+00,  1.1595e+00,  1.6536e+00, -2.8190e+00]],

         [[ 1.7301e+00,        -inf,        -inf,        -inf],
          [ 2.7816e+00,  9.9274e-01,        -inf,        -inf],
          [ 3.8114e+00,  2.5174e+00,  1.0400e+00,        -inf],
          [-1.3558e+00, -1.0468e-01, -8.4321e-01,  6.4441e-01]],

         [[-2.6544e+00,        -inf,        -inf,        -inf],
          [ 2.9099e+00, -4.6116e+00,        -inf,        -inf],
          [-2.7720e+00, -4.0759e+00, -1.9332e+00,        -inf],
          [-2.6840e+00, -2.3710e+00, -4.2254e+00, -1.1206e+00]],

         [[-1.9593e+00,        -inf,        -inf,        -inf],
          [-3.2787e-01,  1.4545e+00,        -inf,        -inf],
          [ 2.9897e-01, -1.0027e+00, -1.4211e+00,        -inf],
          [-6.6784e-01, -1.1315e+00,  8.1250e-01, -2.2843e+00]],

         [[-8.7509e-01,        -inf,        -inf,        -inf],
          [-2.5879e+00,  1.6913e+00,        -inf,        -inf],
          [-1.2317e+00,  4.3067e-01,  5.8787e+00,        -inf],
          [ 1.9337e+00,  2.9051e+00, -1.6724e+00, -1.1245e+00]],

         [[-1.3302e-01,        -inf,        -inf,        -inf],
          [-1.4297e+00,  1.1606e+00,        -inf,        -inf],
          [ 7.2889e-01,  3.3819e+00, -3.6524e+00,        -inf],
          [ 2.8807e+00,  1.6112e+00, -3.2348e+00, -8.5988e-02]],

         [[ 2.5319e+00,        -inf,        -inf,        -inf],
          [-2.1817e+00, -3.7659e+00,        -inf,        -inf],
          [ 1.2675e+00, -2.2158e+00, -2.1659e+00,        -inf],
          [-2.3346e+00, -2.4323e+00, -1.7843e+00, -3.0249e+00]],

         [[-8.8921e-01,        -inf,        -inf,        -inf],
          [-1.8482e+00, -6.2500e+00,        -inf,        -inf],
          [-3.9643e+00, -3.8439e-01,  4.4832e-01,        -inf],
          [-7.5926e+00, -3.7075e+00, -1.2932e+00, -9.0893e-01]],

         [[ 3.7055e+00,        -inf,        -inf,        -inf],
          [-1.9723e+00,  1.6757e+00,        -inf,        -inf],
          [-1.8384e+00, -1.7735e+00,  2.1501e+00,        -inf],
          [-2.2301e+00,  7.7021e-01, -8.4101e-01, -1.1519e+00]],

         [[-5.0585e-01,        -inf,        -inf,        -inf],
          [ 4.3674e-01, -5.8082e-01,        -inf,        -inf],
          [-3.7893e+00, -8.1184e-01,  3.0104e+00,        -inf],
          [ 3.9466e+00,  4.8997e-01,  1.7145e+00,  2.4276e+00]]],


        [[[ 4.2913e+00,        -inf,        -inf,        -inf],
          [-7.9317e-01, -7.7916e-02,        -inf,        -inf],
          [-6.3724e-01,  4.2492e-01,  3.4208e-01,        -inf],
          [ 1.2270e+00,  1.6916e+00,  6.3173e+00,  2.7836e+00]],

         [[-9.1415e-01,        -inf,        -inf,        -inf],
          [ 2.2663e+00, -2.2647e+00,        -inf,        -inf],
          [-1.4370e+00, -1.5974e+00, -2.4102e+00,        -inf],
          [-1.3262e+00, -1.8735e+00,  9.0949e-01, -5.5504e-01]],

         [[ 6.8524e+00,        -inf,        -inf,        -inf],
          [ 1.8823e+00,  7.8828e-01,        -inf,        -inf],
          [-6.5115e-01, -2.3138e+00, -3.3028e+00,        -inf],
          [ 1.3549e+00, -5.9744e+00, -4.0271e+00, -1.2369e+00]],

         [[-2.2225e+00,        -inf,        -inf,        -inf],
          [-9.8271e-01,  2.2994e+00,        -inf,        -inf],
          [ 1.2624e+00, -6.8232e-01, -4.6535e-01,        -inf],
          [-2.8153e+00, -3.1153e+00, -3.3010e+00, -8.4986e+00]],

         [[ 7.0912e-01,        -inf,        -inf,        -inf],
          [ 2.8490e+00, -6.5120e-01,        -inf,        -inf],
          [ 1.4342e+00,  1.5603e+00, -5.0650e+00,        -inf],
          [ 4.6993e-01, -3.2360e+00, -1.9014e+00,  6.2893e-01]],

         [[ 4.3547e-01,        -inf,        -inf,        -inf],
          [ 3.0459e+00,  3.3957e+00,        -inf,        -inf],
          [ 3.8761e+00,  4.7574e-01, -5.5843e-01,        -inf],
          [ 3.4739e-01, -2.7656e-01, -3.6529e-01,  1.5284e+00]],

         [[-2.5010e+00,        -inf,        -inf,        -inf],
          [-4.3332e+00, -2.5023e+00,        -inf,        -inf],
          [-1.8732e+00, -1.0091e+00, -3.0590e+00,        -inf],
          [-4.9724e+00, -1.8292e+00, -1.4493e+00, -2.9405e+00]],

         [[ 1.6410e+00,        -inf,        -inf,        -inf],
          [ 2.4659e+00, -1.0902e-01,        -inf,        -inf],
          [ 1.5990e+00,  1.6117e+00,  2.0904e-01,        -inf],
          [ 3.9349e+00, -2.1630e+00,  7.3928e+00,  4.0732e+00]],

         [[ 1.6651e+00,        -inf,        -inf,        -inf],
          [-8.3537e-02,  1.2509e+00,        -inf,        -inf],
          [ 4.2452e+00,  1.5149e+00,  4.4116e+00,        -inf],
          [ 3.2851e+00, -4.3206e-01,  1.4221e+00,  2.7868e+00]],

         [[-5.6731e+00,        -inf,        -inf,        -inf],
          [-2.7582e+00, -3.0607e+00,        -inf,        -inf],
          [ 6.3063e-02, -6.4569e-01, -1.0066e+00,        -inf],
          [-6.5609e+00, -3.8032e+00, -1.6611e+00, -2.6123e+00]],

         [[ 2.4211e+00,        -inf,        -inf,        -inf],
          [ 3.3238e+00,  3.1137e+00,        -inf,        -inf],
          [ 4.6233e+00,  7.3160e+00,  1.5705e+00,        -inf],
          [ 3.0930e+00,  6.5875e+00,  9.0144e+00,  2.9825e+00]],

         [[-1.2644e+00,        -inf,        -inf,        -inf],
          [-1.6606e+00,  1.9984e+00,        -inf,        -inf],
          [-2.6173e-01, -7.0329e-01,  1.6703e+00,        -inf],
          [ 9.3091e-01, -1.4488e+00,  2.5037e-01,  2.2870e+00]],

         [[ 6.3494e-01,        -inf,        -inf,        -inf],
          [-4.5814e+00,  6.8480e-01,        -inf,        -inf],
          [-1.7313e+00, -1.8421e+00, -2.3166e+00,        -inf],
          [-7.3325e-01, -6.9556e-01, -7.2242e-01,  1.7389e+00]],

         [[-3.6289e+00,        -inf,        -inf,        -inf],
          [-1.3550e+00,  2.8990e+00,        -inf,        -inf],
          [ 3.2248e+00,  2.6714e+00,  5.4038e+00,        -inf],
          [ 6.4131e-01, -3.8803e-01, -4.1841e-01, -3.0411e+00]],

         [[ 3.2748e+00,        -inf,        -inf,        -inf],
          [ 4.7085e+00, -1.7119e+00,        -inf,        -inf],
          [ 3.2301e+00, -6.3881e-01,  3.3294e+00,        -inf],
          [ 6.1485e-01, -3.1387e+00,  2.0006e+00,  2.4041e-01]],

         [[ 7.3605e-01,        -inf,        -inf,        -inf],
          [ 1.2800e+00,  7.6986e-01,        -inf,        -inf],
          [ 4.6013e+00, -1.0332e+00,  2.2832e+00,        -inf],
          [ 3.3766e+00,  8.3138e-01,  1.5546e+00,  2.4147e+00]],

         [[-8.7651e-01,        -inf,        -inf,        -inf],
          [ 3.3618e+00,  5.7718e+00,        -inf,        -inf],
          [ 3.3598e+00,  4.8585e+00,  3.1251e+00,        -inf],
          [-3.6352e+00,  2.6337e+00,  2.3726e+00, -9.7568e-01]],

         [[-3.6498e-01,        -inf,        -inf,        -inf],
          [ 1.8309e+00,  6.8891e+00,        -inf,        -inf],
          [ 2.1839e+00,  1.3785e+00,  2.7458e+00,        -inf],
          [ 9.4502e-01,  6.1161e+00,  5.6448e+00,  5.4321e+00]],

         [[-4.1818e-02,        -inf,        -inf,        -inf],
          [ 1.3110e+00, -5.4340e-01,        -inf,        -inf],
          [-6.8325e-02, -1.8576e-02,  7.1566e-01,        -inf],
          [ 6.8180e-01, -3.8826e+00, -4.1465e+00, -5.0901e+00]],

         [[ 7.4961e-01,        -inf,        -inf,        -inf],
          [-2.2451e-02,  3.0908e+00,        -inf,        -inf],
          [ 6.2936e-01, -1.6963e-01,  2.7399e+00,        -inf],
          [ 1.1849e+00, -2.4049e+00, -7.9957e-01,  1.0054e+00]],

         [[-1.2822e+00,        -inf,        -inf,        -inf],
          [-3.1201e+00, -4.2955e+00,        -inf,        -inf],
          [ 2.5810e-01,  4.7249e+00, -2.4948e+00,        -inf],
          [ 1.2484e+00,  3.8300e+00, -3.9900e-02,  1.5043e-01]],

         [[ 6.3431e-01,        -inf,        -inf,        -inf],
          [ 6.1426e-01, -3.4046e+00,        -inf,        -inf],
          [ 1.7064e+00, -7.5175e-01, -3.0156e-01,        -inf],
          [ 2.3225e+00, -2.4254e+00, -5.7707e+00, -2.6775e+00]],

         [[ 6.8374e-02,        -inf,        -inf,        -inf],
          [ 8.7495e-01,  9.8734e-01,        -inf,        -inf],
          [ 3.0954e+00,  2.2218e+00,  3.9170e-01,        -inf],
          [ 1.5803e+00,  1.5364e+00,  1.2808e+00, -1.2418e+00]],

         [[-2.8696e-01,        -inf,        -inf,        -inf],
          [-2.2755e+00,  3.5946e+00,        -inf,        -inf],
          [-6.9684e-01,  1.9251e+00,  5.4542e+00,        -inf],
          [-6.6131e-01,  8.0511e-01,  5.4113e-01, -1.5863e+00]],

         [[-9.2999e-01,        -inf,        -inf,        -inf],
          [ 7.7194e-01, -3.8917e+00,        -inf,        -inf],
          [ 2.9411e+00,  1.5840e+00,  5.0130e+00,        -inf],
          [ 4.6636e+00,  3.5431e+00,  3.1781e+00,  2.1164e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.2202, -0.0274,  0.3697,  ..., -0.3079, -0.1005, -0.1807],
          [ 1.7970, -0.3242,  0.0105,  ..., -0.7949,  0.1654,  1.1683],
          [-0.3992, -0.3040,  0.4142,  ...,  0.1853, -0.4260,  0.1044],
          ...,
          [-1.1800,  0.0815, -0.1683,  ...,  0.3910, -1.8840,  0.1115],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.2505,  0.3010,  0.3362,  ..., -0.7714, -0.7282, -0.2325]],

         [[ 0.2723, -0.5457,  0.6282,  ..., -0.2137, -0.1160, -0.2566],
          [ 1.5048,  0.4636,  0.3449,  ..., -0.3494,  0.3368,  0.7785],
          [-0.8347, -0.7523,  0.7645,  ..., -0.4756, -0.1834, -0.3241],
          ...,
          [-0.8614,  0.3500, -0.2636,  ..., -0.0645, -1.3849,  0.3066],
          [-0.2911,  0.6042,  0.2321,  ..., -0.4453, -0.2549,  0.1352],
          [ 0.3314,  0.4044,  0.1285,  ..., -0.1119, -0.4477, -0.1772]],

         [[ 0.3548, -0.6869,  0.5206,  ..., -0.3144, -0.2374, -0.3192],
          [ 1.0683,  0.2327, -0.0889,  ..., -0.0312,  0.7090,  0.8936],
          [-0.7240, -0.6858,  0.8628,  ..., -0.4029,  0.2193, -0.2370],
          ...,
          [-0.4632,  0.1440, -0.2222,  ..., -0.3042, -0.7437, -0.0150],
          [-0.1384,  1.0011,  0.0612,  ...,  0.0925,  0.1389, -0.5995],
          [ 0.3976,  0.4184,  0.0046,  ..., -0.2491, -0.0304,  0.1571]],

         [[ 0.5594, -0.2145,  0.2566,  ...,  0.0227,  0.0261, -0.4134],
          [ 0.9098,  0.2314, -0.0576,  ..., -0.0148,  0.6079,  0.7489],
          [-0.3531, -0.3307,  0.5161,  ..., -0.0652,  0.1548, -0.0178],
          ...,
          [-0.1288,  0.0548, -0.1185,  ..., -0.2592, -0.2075, -0.0634],
          [-0.1682,  0.7895,  0.1135,  ...,  0.0159,  0.2395, -0.3672],
          [ 0.2470,  0.0203,  0.0386,  ..., -0.3419, -0.1402, -0.0495]]],


        [[[ 0.0651, -0.0329,  0.4730,  ..., -0.1265, -0.8446, -0.6258],
          [ 1.3422, -0.3456, -0.0434,  ..., -0.7484,  0.3871,  0.7507],
          [-0.1789,  0.1216,  0.2160,  ..., -0.5140, -0.4680,  0.0884],
          ...,
          [-1.0083,  0.0954, -0.1361,  ...,  0.1958, -1.4169, -0.0224],
          [-0.4521, -0.1571,  0.1578,  ..., -0.4733,  0.8844, -0.3956],
          [ 0.5171, -0.2170,  0.5188,  ..., -1.0020, -0.0448, -0.3069]],

         [[ 0.2154, -0.4864,  0.1535,  ...,  0.1223, -0.8810, -0.1825],
          [ 1.4027,  0.0549, -0.0551,  ..., -0.3917,  0.4008,  0.6372],
          [-0.6715,  0.1278,  0.1543,  ..., -0.9195, -0.8299, -0.2650],
          ...,
          [-0.7278,  0.3954, -0.6859,  ..., -0.1446, -1.3885, -0.0550],
          [-0.5109,  0.0135,  0.5365,  ..., -0.0663,  0.5778,  0.1984],
          [ 0.5394, -0.3018,  0.3238,  ..., -0.3498, -0.1509, -0.5247]],

         [[ 0.1869, -0.3192,  0.1334,  ..., -0.1108, -0.8555,  0.0985],
          [ 0.5821, -0.1016, -0.2939,  ..., -0.5819,  0.5517,  0.5319],
          [-0.5909,  0.1342,  0.0232,  ..., -0.9472, -0.5906, -0.1680],
          ...,
          [-0.7393,  0.3362, -0.6840,  ..., -0.0600, -1.2206,  0.0928],
          [-0.2641, -0.0054,  0.2540,  ..., -0.0647,  0.3260,  0.0606],
          [ 0.2842, -0.2451,  0.0852,  ..., -0.1873, -0.0903, -0.5460]],

         [[ 0.5655, -0.1194,  0.1514,  ..., -0.3353, -0.4387, -0.1274],
          [ 0.8256,  0.2665, -0.4130,  ..., -0.4352,  0.4293,  0.5629],
          [-0.1412,  0.1083, -0.4000,  ..., -0.5047,  0.0095,  0.0175],
          ...,
          [-0.7027,  0.0216, -0.1455,  ...,  0.1150, -0.5644,  0.2880],
          [-0.4729,  0.1559,  0.0436,  ...,  0.3204,  0.4554, -0.3773],
          [ 0.1844, -0.1975,  0.2670,  ..., -0.2283, -0.1425, -0.5476]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.2202, -0.0274,  0.3697,  ..., -0.7714, -0.7282, -0.2325],
         [ 0.2723, -0.5457,  0.6282,  ..., -0.1119, -0.4477, -0.1772],
         [ 0.3548, -0.6869,  0.5206,  ..., -0.2491, -0.0304,  0.1571],
         [ 0.5594, -0.2145,  0.2566,  ..., -0.3419, -0.1402, -0.0495]],

        [[ 0.0651, -0.0329,  0.4730,  ..., -1.0020, -0.0448, -0.3069],
         [ 0.2154, -0.4864,  0.1535,  ..., -0.3498, -0.1509, -0.5247],
         [ 0.1869, -0.3192,  0.1334,  ..., -0.1873, -0.0903, -0.5460],
         [ 0.5655, -0.1194,  0.1514,  ..., -0.2283, -0.1425, -0.5476]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2550,  0.1023,  0.1390,  ..., -0.4748,  0.4085, -0.1884],
         [ 0.1282, -0.1749,  0.2437,  ..., -0.1107,  0.2695, -0.0068],
         [ 0.2133, -0.1075,  0.2922,  ..., -0.0030, -0.1586, -0.0668],
         [ 0.1303,  0.0354, -0.0464,  ..., -0.0006,  0.0898, -0.1079]],

        [[ 0.0813, -0.0901, -0.1361,  ..., -0.1181,  0.0443, -0.1631],
         [ 0.1722, -0.2735,  0.0997,  ..., -0.2491,  0.0050, -0.1035],
         [ 0.0266, -0.1129,  0.0289,  ..., -0.3077,  0.0611, -0.1137],
         [ 0.2561,  0.2248,  0.0935,  ..., -0.2262,  0.1627, -0.1182]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.4310e+00,        -inf,        -inf,        -inf],
          [ 1.1697e+00,  8.6213e-01,        -inf,        -inf],
          [ 3.0641e-01, -3.0185e+00,  1.6354e+00,        -inf],
          [-1.6219e+00,  4.5783e-01,  1.6606e+00, -1.1224e+00]],

         [[ 2.1643e+00,        -inf,        -inf,        -inf],
          [-9.5468e-01,  1.8489e+00,        -inf,        -inf],
          [ 3.1493e+00, -7.1296e-01,  3.6394e+00,        -inf],
          [ 1.9551e-01,  6.8095e-01,  7.5677e-01,  8.3213e-01]],

         [[ 4.8338e+00,        -inf,        -inf,        -inf],
          [ 6.8154e-01,  5.0130e+00,        -inf,        -inf],
          [ 2.9146e+00,  2.9093e+00, -1.1225e+00,        -inf],
          [ 2.5563e+00,  9.6903e-01,  2.7909e+00, -2.3337e+00]],

         [[-1.7335e+00,        -inf,        -inf,        -inf],
          [-4.2486e+00,  1.4120e+00,        -inf,        -inf],
          [ 1.2350e+00,  3.2815e+00, -5.4575e+00,        -inf],
          [-1.4655e+00,  1.2988e+00, -1.8281e+00, -8.8487e-01]],

         [[ 1.1639e+00,        -inf,        -inf,        -inf],
          [-2.0923e+00, -2.4046e+00,        -inf,        -inf],
          [ 1.4866e-01,  1.0289e+00, -1.8974e+00,        -inf],
          [-2.4175e+00,  3.9166e-03,  6.7044e+00, -3.3449e+00]],

         [[-8.1388e-01,        -inf,        -inf,        -inf],
          [ 1.0359e-01, -3.2548e+00,        -inf,        -inf],
          [-2.6778e+00, -3.3149e+00, -2.9519e+00,        -inf],
          [ 1.5113e+00,  1.3597e+00,  5.0098e+00, -2.9690e+00]],

         [[ 2.3463e+00,        -inf,        -inf,        -inf],
          [-4.9371e-02, -3.6445e-01,        -inf,        -inf],
          [ 1.9428e+00, -1.8942e+00,  3.0067e+00,        -inf],
          [ 2.1606e+00,  2.5731e-01,  4.8474e+00,  1.4591e+00]],

         [[-3.4732e+00,        -inf,        -inf,        -inf],
          [-1.9326e+00, -4.0434e-01,        -inf,        -inf],
          [ 3.0062e-01,  3.1818e-01, -3.1421e+00,        -inf],
          [-1.7740e+00,  3.2362e+00,  1.7075e+00,  1.4258e+00]],

         [[-2.5275e+00,        -inf,        -inf,        -inf],
          [ 1.2524e+00, -5.8019e-01,        -inf,        -inf],
          [ 1.8845e+00, -4.8462e-01, -4.1540e-01,        -inf],
          [-3.9109e+00,  2.7096e-02, -1.3055e+00,  9.8855e-01]],

         [[ 6.0679e+00,        -inf,        -inf,        -inf],
          [ 4.6171e-01,  1.6614e+00,        -inf,        -inf],
          [ 3.1235e+00,  3.2937e+00,  9.7325e-01,        -inf],
          [-6.2145e-01,  3.7312e+00,  1.2808e+00,  1.4382e+00]],

         [[ 1.0366e+00,        -inf,        -inf,        -inf],
          [-9.3700e-01, -3.0493e+00,        -inf,        -inf],
          [-5.7236e-01,  6.3058e-01,  1.4045e+00,        -inf],
          [ 1.8247e+00, -2.5528e+00,  7.3558e-01, -2.4441e+00]],

         [[-4.5548e+00,        -inf,        -inf,        -inf],
          [-2.0297e+00,  4.4363e+00,        -inf,        -inf],
          [ 3.7596e+00,  4.4786e+00,  2.1263e+00,        -inf],
          [-3.0704e+00, -2.9805e+00, -5.4132e+00, -4.0183e-01]],

         [[ 3.4241e-03,        -inf,        -inf,        -inf],
          [ 1.3389e+00,  2.3800e+00,        -inf,        -inf],
          [ 3.4736e+00,  1.6812e+00,  8.7007e-01,        -inf],
          [ 7.5143e-01,  1.8207e+00, -1.6063e+00, -6.0817e-01]],

         [[ 2.6777e+00,        -inf,        -inf,        -inf],
          [ 5.6409e+00,  2.1294e+00,        -inf,        -inf],
          [ 1.9308e+00, -3.7128e-01, -2.4803e+00,        -inf],
          [ 2.0236e+00, -2.8319e+00,  4.0248e-01,  4.0238e+00]],

         [[-2.8478e+00,        -inf,        -inf,        -inf],
          [-8.4452e+00,  4.1214e+00,        -inf,        -inf],
          [-4.7237e-01, -5.2233e+00, -3.2865e+00,        -inf],
          [-4.9404e+00,  4.3516e+00,  9.4327e-01, -2.4032e-01]],

         [[ 4.1808e+00,        -inf,        -inf,        -inf],
          [ 2.1727e+00,  1.6511e+00,        -inf,        -inf],
          [ 6.3996e+00,  4.4942e+00,  4.2739e+00,        -inf],
          [ 2.5172e+00,  2.6744e-01,  8.0274e-01,  6.6516e-01]],

         [[ 3.2037e+00,        -inf,        -inf,        -inf],
          [-1.5488e-01,  3.6460e+00,        -inf,        -inf],
          [ 2.8233e-01,  8.1211e-02, -1.0274e-02,        -inf],
          [ 1.8459e+00,  8.0484e-01,  2.9267e+00, -9.2843e-01]],

         [[ 1.7913e+00,        -inf,        -inf,        -inf],
          [ 1.2209e+00,  7.1379e+00,        -inf,        -inf],
          [-2.4208e+00,  1.4690e+00,  1.1973e+00,        -inf],
          [-1.8195e+00, -1.6418e-01,  7.6465e-01, -5.2072e+00]],

         [[ 2.7268e+00,        -inf,        -inf,        -inf],
          [ 2.8524e+00, -7.9367e-02,        -inf,        -inf],
          [-7.2740e-01, -9.2460e-01, -1.2220e+00,        -inf],
          [-1.0607e+00, -2.7262e+00,  8.7506e-02,  5.3807e-01]],

         [[-2.0905e+00,        -inf,        -inf,        -inf],
          [ 4.3534e+00,  3.0794e+00,        -inf,        -inf],
          [-1.3275e+00, -2.8954e+00, -1.3413e+00,        -inf],
          [-2.2092e+00,  1.0552e+00,  2.9381e+00,  2.7939e+00]],

         [[-1.9826e+00,        -inf,        -inf,        -inf],
          [ 2.1957e+00,  5.2523e-01,        -inf,        -inf],
          [-5.1105e+00, -6.5831e+00, -3.5211e+00,        -inf],
          [-4.0478e-01,  1.4732e+00,  2.9104e-01,  1.3567e+00]],

         [[ 8.8024e-01,        -inf,        -inf,        -inf],
          [ 1.2196e+00, -4.9783e-01,        -inf,        -inf],
          [-2.2447e+00,  8.4211e-01, -4.6457e+00,        -inf],
          [-2.3948e+00,  4.8064e-01, -3.3049e+00, -4.5087e-02]],

         [[ 5.9450e-01,        -inf,        -inf,        -inf],
          [ 1.8201e+00,  1.9426e+00,        -inf,        -inf],
          [ 3.3965e+00,  4.3311e-01,  2.2435e+00,        -inf],
          [ 9.1077e-01,  2.5990e+00,  1.9878e+00, -2.9667e-01]],

         [[-6.4116e-01,        -inf,        -inf,        -inf],
          [ 3.2587e+00,  1.4993e+00,        -inf,        -inf],
          [ 3.2226e+00,  3.4428e-01,  8.0003e-01,        -inf],
          [ 1.4102e+00,  5.2073e+00, -7.2477e-01,  1.4024e+00]],

         [[-3.0410e-01,        -inf,        -inf,        -inf],
          [-2.1022e+00,  2.1077e+00,        -inf,        -inf],
          [-1.6724e+00,  7.3368e-01, -1.4989e+00,        -inf],
          [-2.6266e+00,  1.7374e+00, -1.9853e+00,  1.9259e+00]]],


        [[[ 4.6979e+00,        -inf,        -inf,        -inf],
          [ 1.6332e+00,  3.6557e+00,        -inf,        -inf],
          [ 2.0783e+00,  1.4008e+00,  2.8100e+00,        -inf],
          [ 1.5533e+00,  1.8988e+00,  1.9883e+00, -2.8131e+00]],

         [[-1.0651e+00,        -inf,        -inf,        -inf],
          [-2.1851e+00, -4.2299e+00,        -inf,        -inf],
          [ 5.7161e-01,  6.1691e-02,  5.8810e+00,        -inf],
          [-2.7515e+00, -4.2697e+00, -1.7423e+00, -2.2600e+00]],

         [[ 5.3220e+00,        -inf,        -inf,        -inf],
          [ 2.6113e+00, -6.2406e-01,        -inf,        -inf],
          [ 4.7019e+00, -9.9651e-01, -1.9817e-01,        -inf],
          [ 3.8302e+00, -3.0233e-01, -4.0588e+00, -4.0599e+00]],

         [[-2.9998e+00,        -inf,        -inf,        -inf],
          [ 1.8547e+00,  2.7411e-01,        -inf,        -inf],
          [-2.0938e+00, -1.3885e+00,  3.4762e+00,        -inf],
          [-1.6939e+00, -2.4575e+00,  2.3442e+00, -1.1464e-01]],

         [[-7.7489e-02,        -inf,        -inf,        -inf],
          [ 1.7150e+00, -5.1022e+00,        -inf,        -inf],
          [-2.7810e-01,  2.4070e+00, -5.0664e+00,        -inf],
          [ 1.5112e+00, -2.4054e+00, -2.6815e+00, -3.8149e+00]],

         [[ 9.3177e-01,        -inf,        -inf,        -inf],
          [ 2.6143e+00, -3.3441e-01,        -inf,        -inf],
          [-7.6043e-01, -1.4278e+00, -6.6854e+00,        -inf],
          [-1.2466e+00, -2.1764e+00, -5.3845e+00, -2.3973e+00]],

         [[ 1.5029e+00,        -inf,        -inf,        -inf],
          [ 9.9724e-01, -2.9190e+00,        -inf,        -inf],
          [-1.6867e+00, -2.6968e+00, -2.7802e+00,        -inf],
          [ 2.0469e+00, -6.5496e-01,  1.1593e+00,  8.4595e-01]],

         [[-6.5687e-01,        -inf,        -inf,        -inf],
          [ 4.4029e+00,  4.4990e+00,        -inf,        -inf],
          [ 1.8698e+00,  3.6608e-01,  2.7370e+00,        -inf],
          [ 3.2352e-01, -6.1500e-01,  4.2660e+00,  9.9067e-01]],

         [[-2.1958e+00,        -inf,        -inf,        -inf],
          [ 5.5801e+00, -6.6882e-01,        -inf,        -inf],
          [ 6.2201e-01, -1.1696e+00, -4.2567e+00,        -inf],
          [-4.8917e+00, -3.1560e+00, -3.9246e+00,  9.6801e-01]],

         [[ 3.4057e+00,        -inf,        -inf,        -inf],
          [-2.3238e+00,  1.1884e+00,        -inf,        -inf],
          [ 3.5541e+00, -3.7281e+00,  4.3238e+00,        -inf],
          [ 1.0067e+00,  7.2526e-01,  6.1986e-01, -3.1131e-01]],

         [[ 1.2076e+00,        -inf,        -inf,        -inf],
          [ 4.0686e-01,  2.4595e+00,        -inf,        -inf],
          [ 1.3330e+00, -2.4037e+00, -1.7079e+00,        -inf],
          [ 1.8305e+00,  6.7298e-01,  1.2927e+00,  5.1343e-01]],

         [[-1.4572e+00,        -inf,        -inf,        -inf],
          [-1.0793e+00,  2.3925e+00,        -inf,        -inf],
          [ 3.3312e-01,  3.1441e-01, -1.4690e+00,        -inf],
          [ 1.1692e+00, -9.2240e-02, -2.9599e+00,  1.7403e+00]],

         [[ 2.6184e+00,        -inf,        -inf,        -inf],
          [-3.1761e+00, -1.6731e+00,        -inf,        -inf],
          [-1.4329e+00, -4.5107e+00, -3.7245e-01,        -inf],
          [ 5.1754e+00,  4.0684e+00,  3.8508e+00, -2.1683e-01]],

         [[ 1.5407e+00,        -inf,        -inf,        -inf],
          [ 3.3465e+00,  1.2137e+00,        -inf,        -inf],
          [ 1.7518e+00,  4.7743e+00, -8.2035e-01,        -inf],
          [ 1.9752e+00, -9.9362e-01, -3.2487e+00,  3.4274e+00]],

         [[-1.5610e+00,        -inf,        -inf,        -inf],
          [-5.2421e+00, -5.5467e+00,        -inf,        -inf],
          [-1.7680e-01, -4.4999e+00, -2.9567e+00,        -inf],
          [ 1.3201e+00,  2.5453e+00,  3.7785e+00,  9.6614e-01]],

         [[ 5.5233e+00,        -inf,        -inf,        -inf],
          [ 2.5732e+00,  3.3151e+00,        -inf,        -inf],
          [ 2.5689e+00, -4.1993e-02, -2.7522e-01,        -inf],
          [-2.4779e-01, -1.1936e+00, -5.2550e+00, -4.1683e+00]],

         [[ 2.4273e+00,        -inf,        -inf,        -inf],
          [ 4.5216e+00,  2.5384e+00,        -inf,        -inf],
          [-4.1904e-01,  6.4965e-01, -1.7701e+00,        -inf],
          [ 1.0610e-01, -3.7174e+00, -1.9948e+00, -2.1681e+00]],

         [[ 1.4800e+00,        -inf,        -inf,        -inf],
          [ 9.8125e-01, -1.4297e-03,        -inf,        -inf],
          [-6.0363e+00,  2.0543e-01, -2.1956e+00,        -inf],
          [-1.3977e+00,  3.7682e-02, -2.0725e+00, -3.5124e+00]],

         [[ 1.4932e+00,        -inf,        -inf,        -inf],
          [ 3.9274e+00,  1.1739e+00,        -inf,        -inf],
          [-2.4289e+00, -1.2102e+00, -2.1961e+00,        -inf],
          [-4.1034e+00, -5.5170e+00, -5.1188e+00, -5.6627e+00]],

         [[-1.6952e-01,        -inf,        -inf,        -inf],
          [-1.9919e+00,  4.4024e+00,        -inf,        -inf],
          [-1.6435e+00, -5.8906e-01,  2.9777e+00,        -inf],
          [-1.0141e+00,  8.3755e-01,  1.0712e+00,  4.6113e+00]],

         [[ 1.6091e-01,        -inf,        -inf,        -inf],
          [-7.9759e-01, -4.2599e+00,        -inf,        -inf],
          [ 1.0228e-01, -4.2151e+00, -2.3028e+00,        -inf],
          [ 4.4598e+00, -1.4831e+00, -1.4105e+00,  2.6841e+00]],

         [[ 1.3601e+00,        -inf,        -inf,        -inf],
          [ 1.6122e-02, -6.5844e+00,        -inf,        -inf],
          [ 3.0926e-01, -1.6640e+00,  2.4592e+00,        -inf],
          [-1.8454e+00, -1.0754e+00, -5.7805e-01,  1.7861e+00]],

         [[-1.0837e-01,        -inf,        -inf,        -inf],
          [ 2.1120e+00, -1.7792e+00,        -inf,        -inf],
          [ 2.2791e+00, -1.1115e+00,  1.6472e+00,        -inf],
          [-5.6507e-01, -8.4567e-02, -1.3868e+00,  2.5270e+00]],

         [[-4.0627e+00,        -inf,        -inf,        -inf],
          [-3.4804e+00,  1.8667e+00,        -inf,        -inf],
          [-5.0912e+00,  3.8270e-01,  3.1799e+00,        -inf],
          [-3.8978e+00,  1.8938e+00, -2.9951e+00,  1.8051e-01]],

         [[-2.6598e-01,        -inf,        -inf,        -inf],
          [ 2.6477e+00,  2.3258e+00,        -inf,        -inf],
          [ 1.3537e+00, -3.1133e+00, -3.6912e+00,        -inf],
          [-3.6266e+00,  2.1935e+00, -4.8898e+00, -1.3359e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.4310e+00,        -inf,        -inf,        -inf],
          [ 1.1697e+00,  8.6213e-01,        -inf,        -inf],
          [ 3.0641e-01, -3.0185e+00,  1.6354e+00,        -inf],
          [-1.6219e+00,  4.5783e-01,  1.6606e+00, -1.1224e+00]],

         [[ 2.1643e+00,        -inf,        -inf,        -inf],
          [-9.5468e-01,  1.8489e+00,        -inf,        -inf],
          [ 3.1493e+00, -7.1296e-01,  3.6394e+00,        -inf],
          [ 1.9551e-01,  6.8095e-01,  7.5677e-01,  8.3213e-01]],

         [[ 4.8338e+00,        -inf,        -inf,        -inf],
          [ 6.8154e-01,  5.0130e+00,        -inf,        -inf],
          [ 2.9146e+00,  2.9093e+00, -1.1225e+00,        -inf],
          [ 2.5563e+00,  9.6903e-01,  2.7909e+00, -2.3337e+00]],

         [[-1.7335e+00,        -inf,        -inf,        -inf],
          [-4.2486e+00,  1.4120e+00,        -inf,        -inf],
          [ 1.2350e+00,  3.2815e+00, -5.4575e+00,        -inf],
          [-1.4655e+00,  1.2988e+00, -1.8281e+00, -8.8487e-01]],

         [[ 1.1639e+00,        -inf,        -inf,        -inf],
          [-2.0923e+00, -2.4046e+00,        -inf,        -inf],
          [ 1.4866e-01,  1.0289e+00, -1.8974e+00,        -inf],
          [-2.4175e+00,  3.9166e-03,  6.7044e+00, -3.3449e+00]],

         [[-8.1388e-01,        -inf,        -inf,        -inf],
          [ 1.0359e-01, -3.2548e+00,        -inf,        -inf],
          [-2.6778e+00, -3.3149e+00, -2.9519e+00,        -inf],
          [ 1.5113e+00,  1.3597e+00,  5.0098e+00, -2.9690e+00]],

         [[ 2.3463e+00,        -inf,        -inf,        -inf],
          [-4.9371e-02, -3.6445e-01,        -inf,        -inf],
          [ 1.9428e+00, -1.8942e+00,  3.0067e+00,        -inf],
          [ 2.1606e+00,  2.5731e-01,  4.8474e+00,  1.4591e+00]],

         [[-3.4732e+00,        -inf,        -inf,        -inf],
          [-1.9326e+00, -4.0434e-01,        -inf,        -inf],
          [ 3.0062e-01,  3.1818e-01, -3.1421e+00,        -inf],
          [-1.7740e+00,  3.2362e+00,  1.7075e+00,  1.4258e+00]],

         [[-2.5275e+00,        -inf,        -inf,        -inf],
          [ 1.2524e+00, -5.8019e-01,        -inf,        -inf],
          [ 1.8845e+00, -4.8462e-01, -4.1540e-01,        -inf],
          [-3.9109e+00,  2.7096e-02, -1.3055e+00,  9.8855e-01]],

         [[ 6.0679e+00,        -inf,        -inf,        -inf],
          [ 4.6171e-01,  1.6614e+00,        -inf,        -inf],
          [ 3.1235e+00,  3.2937e+00,  9.7325e-01,        -inf],
          [-6.2145e-01,  3.7312e+00,  1.2808e+00,  1.4382e+00]],

         [[ 1.0366e+00,        -inf,        -inf,        -inf],
          [-9.3700e-01, -3.0493e+00,        -inf,        -inf],
          [-5.7236e-01,  6.3058e-01,  1.4045e+00,        -inf],
          [ 1.8247e+00, -2.5528e+00,  7.3558e-01, -2.4441e+00]],

         [[-4.5548e+00,        -inf,        -inf,        -inf],
          [-2.0297e+00,  4.4363e+00,        -inf,        -inf],
          [ 3.7596e+00,  4.4786e+00,  2.1263e+00,        -inf],
          [-3.0704e+00, -2.9805e+00, -5.4132e+00, -4.0183e-01]],

         [[ 3.4241e-03,        -inf,        -inf,        -inf],
          [ 1.3389e+00,  2.3800e+00,        -inf,        -inf],
          [ 3.4736e+00,  1.6812e+00,  8.7007e-01,        -inf],
          [ 7.5143e-01,  1.8207e+00, -1.6063e+00, -6.0817e-01]],

         [[ 2.6777e+00,        -inf,        -inf,        -inf],
          [ 5.6409e+00,  2.1294e+00,        -inf,        -inf],
          [ 1.9308e+00, -3.7128e-01, -2.4803e+00,        -inf],
          [ 2.0236e+00, -2.8319e+00,  4.0248e-01,  4.0238e+00]],

         [[-2.8478e+00,        -inf,        -inf,        -inf],
          [-8.4452e+00,  4.1214e+00,        -inf,        -inf],
          [-4.7237e-01, -5.2233e+00, -3.2865e+00,        -inf],
          [-4.9404e+00,  4.3516e+00,  9.4327e-01, -2.4032e-01]],

         [[ 4.1808e+00,        -inf,        -inf,        -inf],
          [ 2.1727e+00,  1.6511e+00,        -inf,        -inf],
          [ 6.3996e+00,  4.4942e+00,  4.2739e+00,        -inf],
          [ 2.5172e+00,  2.6744e-01,  8.0274e-01,  6.6516e-01]],

         [[ 3.2037e+00,        -inf,        -inf,        -inf],
          [-1.5488e-01,  3.6460e+00,        -inf,        -inf],
          [ 2.8233e-01,  8.1211e-02, -1.0274e-02,        -inf],
          [ 1.8459e+00,  8.0484e-01,  2.9267e+00, -9.2843e-01]],

         [[ 1.7913e+00,        -inf,        -inf,        -inf],
          [ 1.2209e+00,  7.1379e+00,        -inf,        -inf],
          [-2.4208e+00,  1.4690e+00,  1.1973e+00,        -inf],
          [-1.8195e+00, -1.6418e-01,  7.6465e-01, -5.2072e+00]],

         [[ 2.7268e+00,        -inf,        -inf,        -inf],
          [ 2.8524e+00, -7.9367e-02,        -inf,        -inf],
          [-7.2740e-01, -9.2460e-01, -1.2220e+00,        -inf],
          [-1.0607e+00, -2.7262e+00,  8.7506e-02,  5.3807e-01]],

         [[-2.0905e+00,        -inf,        -inf,        -inf],
          [ 4.3534e+00,  3.0794e+00,        -inf,        -inf],
          [-1.3275e+00, -2.8954e+00, -1.3413e+00,        -inf],
          [-2.2092e+00,  1.0552e+00,  2.9381e+00,  2.7939e+00]],

         [[-1.9826e+00,        -inf,        -inf,        -inf],
          [ 2.1957e+00,  5.2523e-01,        -inf,        -inf],
          [-5.1105e+00, -6.5831e+00, -3.5211e+00,        -inf],
          [-4.0478e-01,  1.4732e+00,  2.9104e-01,  1.3567e+00]],

         [[ 8.8024e-01,        -inf,        -inf,        -inf],
          [ 1.2196e+00, -4.9783e-01,        -inf,        -inf],
          [-2.2447e+00,  8.4211e-01, -4.6457e+00,        -inf],
          [-2.3948e+00,  4.8064e-01, -3.3049e+00, -4.5087e-02]],

         [[ 5.9450e-01,        -inf,        -inf,        -inf],
          [ 1.8201e+00,  1.9426e+00,        -inf,        -inf],
          [ 3.3965e+00,  4.3311e-01,  2.2435e+00,        -inf],
          [ 9.1077e-01,  2.5990e+00,  1.9878e+00, -2.9667e-01]],

         [[-6.4116e-01,        -inf,        -inf,        -inf],
          [ 3.2587e+00,  1.4993e+00,        -inf,        -inf],
          [ 3.2226e+00,  3.4428e-01,  8.0003e-01,        -inf],
          [ 1.4102e+00,  5.2073e+00, -7.2477e-01,  1.4024e+00]],

         [[-3.0410e-01,        -inf,        -inf,        -inf],
          [-2.1022e+00,  2.1077e+00,        -inf,        -inf],
          [-1.6724e+00,  7.3368e-01, -1.4989e+00,        -inf],
          [-2.6266e+00,  1.7374e+00, -1.9853e+00,  1.9259e+00]]],


        [[[ 4.6979e+00,        -inf,        -inf,        -inf],
          [ 1.6332e+00,  3.6557e+00,        -inf,        -inf],
          [ 2.0783e+00,  1.4008e+00,  2.8100e+00,        -inf],
          [ 1.5533e+00,  1.8988e+00,  1.9883e+00, -2.8131e+00]],

         [[-1.0651e+00,        -inf,        -inf,        -inf],
          [-2.1851e+00, -4.2299e+00,        -inf,        -inf],
          [ 5.7161e-01,  6.1691e-02,  5.8810e+00,        -inf],
          [-2.7515e+00, -4.2697e+00, -1.7423e+00, -2.2600e+00]],

         [[ 5.3220e+00,        -inf,        -inf,        -inf],
          [ 2.6113e+00, -6.2406e-01,        -inf,        -inf],
          [ 4.7019e+00, -9.9651e-01, -1.9817e-01,        -inf],
          [ 3.8302e+00, -3.0233e-01, -4.0588e+00, -4.0599e+00]],

         [[-2.9998e+00,        -inf,        -inf,        -inf],
          [ 1.8547e+00,  2.7411e-01,        -inf,        -inf],
          [-2.0938e+00, -1.3885e+00,  3.4762e+00,        -inf],
          [-1.6939e+00, -2.4575e+00,  2.3442e+00, -1.1464e-01]],

         [[-7.7489e-02,        -inf,        -inf,        -inf],
          [ 1.7150e+00, -5.1022e+00,        -inf,        -inf],
          [-2.7810e-01,  2.4070e+00, -5.0664e+00,        -inf],
          [ 1.5112e+00, -2.4054e+00, -2.6815e+00, -3.8149e+00]],

         [[ 9.3177e-01,        -inf,        -inf,        -inf],
          [ 2.6143e+00, -3.3441e-01,        -inf,        -inf],
          [-7.6043e-01, -1.4278e+00, -6.6854e+00,        -inf],
          [-1.2466e+00, -2.1764e+00, -5.3845e+00, -2.3973e+00]],

         [[ 1.5029e+00,        -inf,        -inf,        -inf],
          [ 9.9724e-01, -2.9190e+00,        -inf,        -inf],
          [-1.6867e+00, -2.6968e+00, -2.7802e+00,        -inf],
          [ 2.0469e+00, -6.5496e-01,  1.1593e+00,  8.4595e-01]],

         [[-6.5687e-01,        -inf,        -inf,        -inf],
          [ 4.4029e+00,  4.4990e+00,        -inf,        -inf],
          [ 1.8698e+00,  3.6608e-01,  2.7370e+00,        -inf],
          [ 3.2352e-01, -6.1500e-01,  4.2660e+00,  9.9067e-01]],

         [[-2.1958e+00,        -inf,        -inf,        -inf],
          [ 5.5801e+00, -6.6882e-01,        -inf,        -inf],
          [ 6.2201e-01, -1.1696e+00, -4.2567e+00,        -inf],
          [-4.8917e+00, -3.1560e+00, -3.9246e+00,  9.6801e-01]],

         [[ 3.4057e+00,        -inf,        -inf,        -inf],
          [-2.3238e+00,  1.1884e+00,        -inf,        -inf],
          [ 3.5541e+00, -3.7281e+00,  4.3238e+00,        -inf],
          [ 1.0067e+00,  7.2526e-01,  6.1986e-01, -3.1131e-01]],

         [[ 1.2076e+00,        -inf,        -inf,        -inf],
          [ 4.0686e-01,  2.4595e+00,        -inf,        -inf],
          [ 1.3330e+00, -2.4037e+00, -1.7079e+00,        -inf],
          [ 1.8305e+00,  6.7298e-01,  1.2927e+00,  5.1343e-01]],

         [[-1.4572e+00,        -inf,        -inf,        -inf],
          [-1.0793e+00,  2.3925e+00,        -inf,        -inf],
          [ 3.3312e-01,  3.1441e-01, -1.4690e+00,        -inf],
          [ 1.1692e+00, -9.2240e-02, -2.9599e+00,  1.7403e+00]],

         [[ 2.6184e+00,        -inf,        -inf,        -inf],
          [-3.1761e+00, -1.6731e+00,        -inf,        -inf],
          [-1.4329e+00, -4.5107e+00, -3.7245e-01,        -inf],
          [ 5.1754e+00,  4.0684e+00,  3.8508e+00, -2.1683e-01]],

         [[ 1.5407e+00,        -inf,        -inf,        -inf],
          [ 3.3465e+00,  1.2137e+00,        -inf,        -inf],
          [ 1.7518e+00,  4.7743e+00, -8.2035e-01,        -inf],
          [ 1.9752e+00, -9.9362e-01, -3.2487e+00,  3.4274e+00]],

         [[-1.5610e+00,        -inf,        -inf,        -inf],
          [-5.2421e+00, -5.5467e+00,        -inf,        -inf],
          [-1.7680e-01, -4.4999e+00, -2.9567e+00,        -inf],
          [ 1.3201e+00,  2.5453e+00,  3.7785e+00,  9.6614e-01]],

         [[ 5.5233e+00,        -inf,        -inf,        -inf],
          [ 2.5732e+00,  3.3151e+00,        -inf,        -inf],
          [ 2.5689e+00, -4.1993e-02, -2.7522e-01,        -inf],
          [-2.4779e-01, -1.1936e+00, -5.2550e+00, -4.1683e+00]],

         [[ 2.4273e+00,        -inf,        -inf,        -inf],
          [ 4.5216e+00,  2.5384e+00,        -inf,        -inf],
          [-4.1904e-01,  6.4965e-01, -1.7701e+00,        -inf],
          [ 1.0610e-01, -3.7174e+00, -1.9948e+00, -2.1681e+00]],

         [[ 1.4800e+00,        -inf,        -inf,        -inf],
          [ 9.8125e-01, -1.4297e-03,        -inf,        -inf],
          [-6.0363e+00,  2.0543e-01, -2.1956e+00,        -inf],
          [-1.3977e+00,  3.7682e-02, -2.0725e+00, -3.5124e+00]],

         [[ 1.4932e+00,        -inf,        -inf,        -inf],
          [ 3.9274e+00,  1.1739e+00,        -inf,        -inf],
          [-2.4289e+00, -1.2102e+00, -2.1961e+00,        -inf],
          [-4.1034e+00, -5.5170e+00, -5.1188e+00, -5.6627e+00]],

         [[-1.6952e-01,        -inf,        -inf,        -inf],
          [-1.9919e+00,  4.4024e+00,        -inf,        -inf],
          [-1.6435e+00, -5.8906e-01,  2.9777e+00,        -inf],
          [-1.0141e+00,  8.3755e-01,  1.0712e+00,  4.6113e+00]],

         [[ 1.6091e-01,        -inf,        -inf,        -inf],
          [-7.9759e-01, -4.2599e+00,        -inf,        -inf],
          [ 1.0228e-01, -4.2151e+00, -2.3028e+00,        -inf],
          [ 4.4598e+00, -1.4831e+00, -1.4105e+00,  2.6841e+00]],

         [[ 1.3601e+00,        -inf,        -inf,        -inf],
          [ 1.6122e-02, -6.5844e+00,        -inf,        -inf],
          [ 3.0926e-01, -1.6640e+00,  2.4592e+00,        -inf],
          [-1.8454e+00, -1.0754e+00, -5.7805e-01,  1.7861e+00]],

         [[-1.0837e-01,        -inf,        -inf,        -inf],
          [ 2.1120e+00, -1.7792e+00,        -inf,        -inf],
          [ 2.2791e+00, -1.1115e+00,  1.6472e+00,        -inf],
          [-5.6507e-01, -8.4567e-02, -1.3868e+00,  2.5270e+00]],

         [[-4.0627e+00,        -inf,        -inf,        -inf],
          [-3.4804e+00,  1.8667e+00,        -inf,        -inf],
          [-5.0912e+00,  3.8270e-01,  3.1799e+00,        -inf],
          [-3.8978e+00,  1.8938e+00, -2.9951e+00,  1.8051e-01]],

         [[-2.6598e-01,        -inf,        -inf,        -inf],
          [ 2.6477e+00,  2.3258e+00,        -inf,        -inf],
          [ 1.3537e+00, -3.1133e+00, -3.6912e+00,        -inf],
          [-3.6266e+00,  2.1935e+00, -4.8898e+00, -1.3359e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.1381,  0.1007,  0.4841,  ...,  0.4632, -0.5794, -0.7827],
          [-0.5260,  0.9008, -0.3163,  ..., -0.0263, -0.3259, -0.1773],
          [ 0.0880,  0.1581, -0.7254,  ..., -1.6585, -0.0429, -0.0761],
          ...,
          [ 0.8169, -0.8932,  1.0979,  ..., -0.3565,  0.8438, -0.3132],
          [ 0.9973,  1.3920, -0.3536,  ...,  0.0753,  0.5476, -0.4614],
          [ 0.2593,  0.6871, -0.5398,  ...,  1.5363, -1.1091, -0.2433]],

         [[-0.1649,  0.2622, -0.0902,  ...,  0.0841, -0.1514, -0.3626],
          [-0.0708,  0.0542,  0.0991,  ...,  0.3751, -0.4493, -0.3597],
          [ 0.2240, -0.7215, -0.1349,  ..., -1.3182,  0.0965, -0.4213],
          ...,
          [ 0.3891, -0.5446,  1.0306,  ..., -0.3856, -0.1627, -0.0475],
          [ 0.5778,  1.3841, -0.6486,  ..., -0.0574, -0.2613, -0.2328],
          [ 0.4504,  0.0295, -0.0504,  ...,  1.2933, -0.5405, -0.6413]],

         [[-0.3221, -0.3399,  0.5046,  ...,  0.4623, -0.2650, -0.6119],
          [-0.1519,  0.3337,  0.3695,  ..., -0.3537, -0.6082, -0.2386],
          [ 0.1713, -0.7867, -0.3929,  ..., -1.2488,  0.1554, -0.0593],
          ...,
          [ 0.9215, -0.0268,  0.7637,  ..., -0.4375,  0.0925, -0.2504],
          [ 0.4292,  1.0699, -0.5556,  ..., -0.0236, -0.6374, -0.3974],
          [ 0.4034,  0.1467, -0.1520,  ...,  1.1041, -0.5794, -0.5289]],

         [[-0.0983, -0.1605,  0.2894,  ...,  0.3765, -0.0581, -0.5930],
          [ 0.2183,  0.4264,  0.1673,  ..., -0.1268, -0.8117, -0.2832],
          [-0.1286, -0.4262, -0.6222,  ..., -0.6680,  0.2704,  0.1912],
          ...,
          [ 0.6840,  0.2368,  0.3886,  ..., -0.3990,  0.3020, -0.2785],
          [-0.2138,  0.8453, -0.7120,  ...,  0.0136, -0.8752, -0.1501],
          [ 0.2856,  0.0678, -0.0791,  ...,  0.7520, -0.3704, -0.3827]]],


        [[[ 0.7541,  0.2630,  1.1261,  ..., -0.3045, -0.6326, -1.0938],
          [ 0.1750,  0.3524, -0.4457,  ..., -0.4231, -0.4964, -0.0565],
          [ 0.0749,  0.1894, -0.8378,  ..., -1.8887, -0.3942, -0.3207],
          ...,
          [ 0.6458, -0.3226,  0.8136,  ..., -0.8598,  0.6492, -0.2314],
          [ 1.0359,  0.9771,  0.1224,  ..., -0.2605,  0.1985, -0.3600],
          [ 0.3398,  0.7589,  0.4327,  ...,  1.0581, -1.1018, -0.4089]],

         [[ 0.2993,  0.2144,  0.2232,  ...,  0.4079, -0.1584, -0.6481],
          [ 0.1247, -0.1658, -0.2029,  ...,  0.5033, -0.1105, -0.6659],
          [-0.0246, -0.4548, -0.3974,  ..., -1.2646, -0.3485, -0.5879],
          ...,
          [ 0.4123, -0.2281,  0.8038,  ..., -0.6228,  0.3525, -0.3136],
          [ 0.3510,  0.3311,  0.0415,  ..., -0.0883,  0.0673, -0.1220],
          [ 0.3276,  0.4558,  0.1870,  ...,  0.1554, -1.1700, -0.2473]],

         [[ 0.3194,  0.1651,  0.5571,  ...,  0.7740, -0.2635, -0.4052],
          [ 0.1704, -0.1635,  0.1482,  ..., -0.1934, -0.3145, -1.3765],
          [ 0.1092, -0.3795, -0.2366,  ..., -1.1233, -0.1184, -0.5114],
          ...,
          [ 0.4879,  0.1784,  1.0222,  ..., -0.4765,  0.5326, -0.6813],
          [ 0.2828, -0.0923, -0.0369,  ..., -0.0583, -0.1081, -0.1800],
          [ 0.5790,  0.5717,  0.1768,  ...,  0.2157, -1.0832, -0.4608]],

         [[ 0.4874,  0.2272,  0.5809,  ...,  0.8304, -0.2061, -0.3845],
          [ 0.2283,  0.1969, -0.1193,  ...,  0.0135, -0.5164, -1.1933],
          [ 0.0061, -0.2507, -0.2122,  ..., -0.9815, -0.1037, -0.5686],
          ...,
          [ 0.1123,  0.2000,  0.8851,  ..., -0.5340,  0.4999, -0.8841],
          [ 0.3215,  0.0695, -0.1168,  ..., -0.1047, -0.2664,  0.0630],
          [ 0.4221,  0.3993,  0.4322,  ...,  0.0205, -0.9599, -0.1461]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.1381,  0.1007,  0.4841,  ...,  1.5363, -1.1091, -0.2433],
         [-0.1649,  0.2622, -0.0902,  ...,  1.2933, -0.5405, -0.6413],
         [-0.3221, -0.3399,  0.5046,  ...,  1.1041, -0.5794, -0.5289],
         [-0.0983, -0.1605,  0.2894,  ...,  0.7520, -0.3704, -0.3827]],

        [[ 0.7541,  0.2630,  1.1261,  ...,  1.0581, -1.1018, -0.4089],
         [ 0.2993,  0.2144,  0.2232,  ...,  0.1554, -1.1700, -0.2473],
         [ 0.3194,  0.1651,  0.5571,  ...,  0.2157, -1.0832, -0.4608],
         [ 0.4874,  0.2272,  0.5809,  ...,  0.0205, -0.9599, -0.1461]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1223,  0.5593, -0.2641,  ...,  0.0264, -0.0434,  0.0844],
         [-0.0307,  0.3082, -0.1833,  ...,  0.0638,  0.2679,  0.1604],
         [ 0.1164,  0.3770, -0.0702,  ...,  0.1110, -0.0855,  0.0568],
         [ 0.3074,  0.1468, -0.0915,  ...,  0.2146, -0.3077,  0.0712]],

        [[-0.0953,  0.4594, -0.1704,  ...,  0.2061,  0.2510, -0.0104],
         [ 0.0173,  0.8426, -0.0308,  ...,  0.3265,  0.1275, -0.2801],
         [ 0.0203,  0.5505, -0.3986,  ...,  0.1724,  0.0489, -0.1893],
         [ 0.0176,  0.5262, -0.0632,  ...,  0.0559,  0.1391, -0.1449]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.7054e+00,        -inf,        -inf,        -inf],
          [-5.4119e-01, -7.6915e-01,        -inf,        -inf],
          [ 1.9210e+00,  1.2728e+00,  3.1759e+00,        -inf],
          [ 2.1779e+00,  1.7643e+00,  2.6741e+00,  3.3660e+00]],

         [[ 1.8170e+00,        -inf,        -inf,        -inf],
          [ 1.5104e+00, -1.0125e-01,        -inf,        -inf],
          [-1.0629e-01, -1.4160e+00, -2.1052e+00,        -inf],
          [-2.5966e+00, -9.0949e-01, -4.7465e+00, -5.6721e+00]],

         [[-2.4956e+00,        -inf,        -inf,        -inf],
          [-2.6632e+00,  8.1703e-01,        -inf,        -inf],
          [-2.4232e+00, -7.1612e-01,  1.0317e+00,        -inf],
          [-1.6524e+00,  3.2558e+00,  7.3046e-01,  1.7864e+00]],

         [[-2.3759e+00,        -inf,        -inf,        -inf],
          [ 5.9756e-01, -4.9242e-01,        -inf,        -inf],
          [-6.3534e-01,  2.8110e+00, -2.2565e+00,        -inf],
          [-2.5395e+00,  9.9432e-01, -4.2805e-01, -4.6640e-02]],

         [[ 1.2359e+00,        -inf,        -inf,        -inf],
          [ 3.8788e+00,  9.5554e-01,        -inf,        -inf],
          [ 5.5614e+00,  7.1559e-01,  5.4566e+00,        -inf],
          [ 6.1551e+00,  4.2287e+00,  2.8262e+00,  2.1969e+00]],

         [[ 4.7513e-01,        -inf,        -inf,        -inf],
          [ 1.7646e+00, -1.4698e+00,        -inf,        -inf],
          [ 6.9132e-01,  2.4255e-02, -5.2818e-01,        -inf],
          [ 4.5481e-01,  3.1537e-01,  2.0506e+00,  3.0474e+00]],

         [[-2.0407e+00,        -inf,        -inf,        -inf],
          [ 7.5713e-01, -1.2171e+00,        -inf,        -inf],
          [ 1.7190e+00, -2.8305e+00, -1.6349e+00,        -inf],
          [ 3.1313e+00,  2.0119e+00,  1.8580e+00,  4.0376e+00]],

         [[ 4.6805e-01,        -inf,        -inf,        -inf],
          [ 8.9360e-01,  2.2727e+00,        -inf,        -inf],
          [ 8.0053e-01,  1.7820e+00,  4.7790e-03,        -inf],
          [-1.0986e+00,  4.1659e+00,  8.1011e-02,  4.0753e+00]],

         [[ 2.3951e+00,        -inf,        -inf,        -inf],
          [ 8.1953e-01, -7.0086e-01,        -inf,        -inf],
          [ 7.2422e+00,  1.1399e+00,  1.6559e+00,        -inf],
          [ 2.1090e+00,  2.1882e+00,  5.3811e+00,  6.0751e-01]],

         [[-5.2056e-01,        -inf,        -inf,        -inf],
          [ 2.8015e-02, -1.0527e+00,        -inf,        -inf],
          [ 4.7949e+00, -3.2307e-01, -7.8927e-01,        -inf],
          [-3.5467e+00, -1.2001e+00, -3.8492e+00, -2.4308e+00]],

         [[ 1.0416e+00,        -inf,        -inf,        -inf],
          [-2.6740e+00, -3.2260e+00,        -inf,        -inf],
          [ 2.0051e+00,  4.1133e-01, -3.6894e+00,        -inf],
          [ 2.0433e-01, -2.4270e+00, -1.2770e+00,  1.2257e+00]],

         [[-2.9047e+00,        -inf,        -inf,        -inf],
          [ 2.1058e+00, -1.4595e+00,        -inf,        -inf],
          [-1.0097e+00, -1.7080e+00,  2.7552e-01,        -inf],
          [ 1.0839e+00,  5.2094e-01,  3.8421e+00,  8.3403e-02]],

         [[ 4.3804e+00,        -inf,        -inf,        -inf],
          [ 3.8836e-01,  3.0081e+00,        -inf,        -inf],
          [-1.9538e+00,  1.8307e+00,  1.7178e+00,        -inf],
          [-7.8722e-01,  2.5416e+00,  1.5040e-01, -1.9922e+00]],

         [[-1.4442e+00,        -inf,        -inf,        -inf],
          [-2.1713e+00,  6.2107e+00,        -inf,        -inf],
          [ 2.0430e+00,  3.6125e+00,  5.6783e+00,        -inf],
          [-1.9277e+00,  2.8701e+00,  3.0747e+00,  2.3923e+00]],

         [[ 2.7281e+00,        -inf,        -inf,        -inf],
          [-1.2345e+00, -2.7426e-01,        -inf,        -inf],
          [-2.3554e-01,  7.4041e-01, -1.1407e+00,        -inf],
          [ 6.3276e+00,  1.3649e-01, -6.2505e-01, -1.6146e+00]],

         [[-4.8261e+00,        -inf,        -inf,        -inf],
          [-1.1196e+00,  3.5785e-01,        -inf,        -inf],
          [-3.4134e+00,  6.4577e+00,  2.6720e+00,        -inf],
          [ 3.4523e-01,  4.2145e+00, -1.8601e-01,  4.0282e+00]],

         [[-3.6540e+00,        -inf,        -inf,        -inf],
          [-1.7949e+00,  1.1558e+00,        -inf,        -inf],
          [-1.3709e+00, -2.2591e+00, -2.2893e+00,        -inf],
          [-1.3648e+00,  1.0604e-01, -6.2020e-01,  3.0544e+00]],

         [[ 3.0572e+00,        -inf,        -inf,        -inf],
          [-1.4761e+00,  2.6517e+00,        -inf,        -inf],
          [ 3.0969e-01,  1.8937e-01, -3.5986e+00,        -inf],
          [-3.5361e+00, -1.7947e+00, -2.9039e+00,  1.3990e+00]],

         [[ 2.4764e+00,        -inf,        -inf,        -inf],
          [-6.9929e-01, -3.2997e-01,        -inf,        -inf],
          [ 8.2203e-01, -1.3891e+00, -3.5731e+00,        -inf],
          [-4.7628e+00, -4.3427e+00, -2.8668e+00, -2.5178e+00]],

         [[ 1.2276e-01,        -inf,        -inf,        -inf],
          [-9.3140e-01,  8.0671e-01,        -inf,        -inf],
          [ 2.3386e+00,  2.7341e+00, -2.5309e-01,        -inf],
          [ 1.9986e+00,  4.0172e+00,  3.9857e+00,  3.0962e+00]],

         [[-2.7414e-01,        -inf,        -inf,        -inf],
          [ 2.7522e+00,  4.1369e+00,        -inf,        -inf],
          [ 3.4118e+00,  1.5640e-01,  1.2112e+00,        -inf],
          [ 5.3082e+00,  3.0063e+00,  2.3241e+00,  7.1709e+00]],

         [[-2.6527e+00,        -inf,        -inf,        -inf],
          [ 4.0267e+00,  2.7746e+00,        -inf,        -inf],
          [-2.1097e+00, -2.3728e-01,  2.4860e+00,        -inf],
          [ 5.9136e+00,  2.8224e+00,  7.1223e-02,  3.0940e+00]],

         [[ 1.3799e+00,        -inf,        -inf,        -inf],
          [-2.5761e-01,  1.8597e+00,        -inf,        -inf],
          [ 1.1880e+00,  4.0456e+00, -5.2764e-01,        -inf],
          [ 2.9774e+00,  4.8572e+00, -1.1981e+00, -2.3770e+00]],

         [[ 4.0293e+00,        -inf,        -inf,        -inf],
          [-6.8595e-01, -1.8680e+00,        -inf,        -inf],
          [ 2.8918e+00, -6.1451e-01, -8.5610e-02,        -inf],
          [ 3.4070e-02,  1.1464e+00, -1.7936e+00,  3.6992e-01]],

         [[ 3.2952e-01,        -inf,        -inf,        -inf],
          [ 1.4039e+00,  1.2908e+00,        -inf,        -inf],
          [ 8.7009e-01, -2.5672e+00, -2.3403e+00,        -inf],
          [-1.3929e+00, -1.6081e+00, -1.8003e+00, -5.8531e-01]]],


        [[[ 8.2757e-01,        -inf,        -inf,        -inf],
          [ 1.1740e+00,  3.6003e+00,        -inf,        -inf],
          [ 2.1297e+00, -4.2498e-01,  3.9520e+00,        -inf],
          [-1.3255e+00, -4.8323e+00,  8.0665e-01, -9.7341e-01]],

         [[-4.5052e-01,        -inf,        -inf,        -inf],
          [ 1.4120e+00, -1.8225e+00,        -inf,        -inf],
          [ 1.6882e+00, -4.5810e-01,  1.1907e+00,        -inf],
          [-1.0005e+00, -8.6008e-02, -2.2975e+00, -1.1474e+00]],

         [[-4.0480e+00,        -inf,        -inf,        -inf],
          [-5.3324e-01, -4.3083e-01,        -inf,        -inf],
          [ 1.0605e-01, -9.6033e-01, -1.8443e-01,        -inf],
          [ 2.3968e+00,  3.0562e+00,  1.7084e+00,  1.3165e+00]],

         [[-3.7903e+00,        -inf,        -inf,        -inf],
          [-1.3375e-02, -6.5240e-01,        -inf,        -inf],
          [-5.3606e+00, -1.7534e+00,  1.8101e+00,        -inf],
          [-3.6011e+00,  4.2354e+00,  2.8676e-01, -4.2408e-01]],

         [[ 3.2808e+00,        -inf,        -inf,        -inf],
          [ 2.5466e+00, -1.0331e-01,        -inf,        -inf],
          [ 3.1275e+00, -3.9316e-01,  9.3545e-01,        -inf],
          [ 2.3272e+00,  1.1741e+00,  2.7574e+00,  9.2380e-01]],

         [[ 1.5910e+00,        -inf,        -inf,        -inf],
          [-2.5276e+00,  4.3843e-01,        -inf,        -inf],
          [-2.2139e+00, -1.5914e+00, -1.2890e+00,        -inf],
          [ 2.1574e+00,  1.0721e+00,  9.6144e-01,  6.8560e-01]],

         [[-5.2325e+00,        -inf,        -inf,        -inf],
          [ 1.3213e+00, -1.7231e+00,        -inf,        -inf],
          [-2.8750e+00, -3.5691e+00, -3.6618e+00,        -inf],
          [-2.2730e+00, -3.5674e+00, -5.9414e+00, -1.0214e+00]],

         [[-8.8398e-01,        -inf,        -inf,        -inf],
          [-2.2971e-01,  3.2154e+00,        -inf,        -inf],
          [ 2.4934e+00,  1.6446e+00,  3.9220e+00,        -inf],
          [-3.0457e+00,  1.6102e+00,  1.9593e+00,  2.1403e+00]],

         [[ 1.1857e-01,        -inf,        -inf,        -inf],
          [ 2.1734e+00,  3.1176e+00,        -inf,        -inf],
          [ 1.5789e+00,  1.7154e+00, -5.7469e-01,        -inf],
          [ 3.3221e+00,  6.7446e-02,  3.0099e-01, -3.3766e+00]],

         [[ 1.4149e+00,        -inf,        -inf,        -inf],
          [ 1.8766e+00,  4.0387e+00,        -inf,        -inf],
          [ 1.1291e+00,  6.4227e+00,  3.3981e+00,        -inf],
          [-8.2885e+00, -2.2741e+00,  2.4002e+00, -5.8661e+00]],

         [[ 1.2422e+00,        -inf,        -inf,        -inf],
          [-2.1019e+00, -1.8858e+00,        -inf,        -inf],
          [ 1.3791e+00, -8.2369e-01,  9.1130e-01,        -inf],
          [-2.4136e+00, -3.4439e+00, -4.7349e-01,  2.6677e+00]],

         [[-2.9770e+00,        -inf,        -inf,        -inf],
          [ 6.2260e-01, -2.1511e+00,        -inf,        -inf],
          [ 2.8128e-01, -1.5269e+00, -5.7213e+00,        -inf],
          [-1.5664e-01,  5.5960e-02, -1.6831e+00,  2.4891e+00]],

         [[ 4.6182e+00,        -inf,        -inf,        -inf],
          [ 2.9713e+00,  3.5721e+00,        -inf,        -inf],
          [ 2.9702e+00,  6.6991e+00,  2.3941e+00,        -inf],
          [-1.5214e+00,  5.7575e-01, -3.3851e-01,  1.7037e+00]],

         [[ 1.9419e+00,        -inf,        -inf,        -inf],
          [ 1.3119e+00,  5.9586e+00,        -inf,        -inf],
          [ 2.9906e+00,  7.0229e+00,  6.1743e+00,        -inf],
          [ 1.4209e+00,  3.4562e+00,  4.5894e+00,  4.4632e+00]],

         [[ 4.7173e+00,        -inf,        -inf,        -inf],
          [ 1.3551e+00,  8.9205e-01,        -inf,        -inf],
          [-5.2034e-01,  9.9856e-01, -1.3852e+00,        -inf],
          [ 1.2920e+00, -1.0990e+00, -2.0196e-02, -8.9854e-01]],

         [[-2.8127e+00,        -inf,        -inf,        -inf],
          [ 2.6661e+00, -6.0203e-01,        -inf,        -inf],
          [-3.4060e-01,  3.6970e+00,  8.5236e+00,        -inf],
          [-3.5273e+00,  5.1517e-01, -2.2403e+00, -2.0658e+00]],

         [[-4.4180e+00,        -inf,        -inf,        -inf],
          [ 7.5380e-01, -5.1265e-01,        -inf,        -inf],
          [-1.5534e+00,  3.4315e-01, -5.9814e-01,        -inf],
          [-2.3230e-01,  2.6736e+00, -9.1766e-02, -3.3279e+00]],

         [[ 1.5338e+00,        -inf,        -inf,        -inf],
          [ 1.5934e+00,  1.8705e+00,        -inf,        -inf],
          [-5.7166e-01, -2.4990e+00, -1.3162e+00,        -inf],
          [-2.0721e+00, -2.9236e-01, -1.1022e+00,  6.7528e-01]],

         [[ 3.0447e+00,        -inf,        -inf,        -inf],
          [ 6.0064e+00,  3.8170e+00,        -inf,        -inf],
          [ 5.0252e+00,  1.0844e+00,  1.2142e+00,        -inf],
          [-4.7869e+00, -1.7502e+00,  7.1573e-02,  1.3320e+00]],

         [[ 4.7194e-01,        -inf,        -inf,        -inf],
          [ 6.8060e-01, -1.8013e+00,        -inf,        -inf],
          [ 1.0795e+00,  4.2898e-01, -1.6309e+00,        -inf],
          [ 3.1752e+00,  2.0107e+00, -1.8911e+00,  7.8730e-01]],

         [[ 1.4629e+00,        -inf,        -inf,        -inf],
          [-1.4648e+00, -3.3564e+00,        -inf,        -inf],
          [ 2.1837e+00, -4.8154e-01,  2.3347e+00,        -inf],
          [ 7.2461e+00,  2.4505e+00,  4.9935e+00,  4.6520e+00]],

         [[-2.3442e+00,        -inf,        -inf,        -inf],
          [ 2.8773e+00,  2.8804e+00,        -inf,        -inf],
          [-2.2936e+00, -1.2200e+00,  3.5864e+00,        -inf],
          [ 4.0457e-01,  3.1688e+00,  2.4311e+00, -1.8155e+00]],

         [[ 2.4483e+00,        -inf,        -inf,        -inf],
          [ 1.9436e+00,  7.5069e-01,        -inf,        -inf],
          [ 9.1465e-01, -1.5554e+00,  1.5193e+00,        -inf],
          [ 2.3786e+00, -2.4961e+00,  6.3101e-01, -6.1082e-01]],

         [[-9.2746e-02,        -inf,        -inf,        -inf],
          [-2.7211e+00, -2.4670e+00,        -inf,        -inf],
          [ 9.9907e-01, -9.8211e-01, -2.0832e+00,        -inf],
          [-5.2750e-01,  6.6726e-01, -4.3419e-01, -5.5025e-01]],

         [[ 8.2904e-01,        -inf,        -inf,        -inf],
          [ 5.5650e-01,  3.0356e+00,        -inf,        -inf],
          [ 3.0783e-02, -1.6564e+00,  5.5144e-01,        -inf],
          [ 5.3879e-01,  6.2493e-01,  1.6120e-01,  7.7316e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.7054e+00,        -inf,        -inf,        -inf],
          [-5.4119e-01, -7.6915e-01,        -inf,        -inf],
          [ 1.9210e+00,  1.2728e+00,  3.1759e+00,        -inf],
          [ 2.1779e+00,  1.7643e+00,  2.6741e+00,  3.3660e+00]],

         [[ 1.8170e+00,        -inf,        -inf,        -inf],
          [ 1.5104e+00, -1.0125e-01,        -inf,        -inf],
          [-1.0629e-01, -1.4160e+00, -2.1052e+00,        -inf],
          [-2.5966e+00, -9.0949e-01, -4.7465e+00, -5.6721e+00]],

         [[-2.4956e+00,        -inf,        -inf,        -inf],
          [-2.6632e+00,  8.1703e-01,        -inf,        -inf],
          [-2.4232e+00, -7.1612e-01,  1.0317e+00,        -inf],
          [-1.6524e+00,  3.2558e+00,  7.3046e-01,  1.7864e+00]],

         [[-2.3759e+00,        -inf,        -inf,        -inf],
          [ 5.9756e-01, -4.9242e-01,        -inf,        -inf],
          [-6.3534e-01,  2.8110e+00, -2.2565e+00,        -inf],
          [-2.5395e+00,  9.9432e-01, -4.2805e-01, -4.6640e-02]],

         [[ 1.2359e+00,        -inf,        -inf,        -inf],
          [ 3.8788e+00,  9.5554e-01,        -inf,        -inf],
          [ 5.5614e+00,  7.1559e-01,  5.4566e+00,        -inf],
          [ 6.1551e+00,  4.2287e+00,  2.8262e+00,  2.1969e+00]],

         [[ 4.7513e-01,        -inf,        -inf,        -inf],
          [ 1.7646e+00, -1.4698e+00,        -inf,        -inf],
          [ 6.9132e-01,  2.4255e-02, -5.2818e-01,        -inf],
          [ 4.5481e-01,  3.1537e-01,  2.0506e+00,  3.0474e+00]],

         [[-2.0407e+00,        -inf,        -inf,        -inf],
          [ 7.5713e-01, -1.2171e+00,        -inf,        -inf],
          [ 1.7190e+00, -2.8305e+00, -1.6349e+00,        -inf],
          [ 3.1313e+00,  2.0119e+00,  1.8580e+00,  4.0376e+00]],

         [[ 4.6805e-01,        -inf,        -inf,        -inf],
          [ 8.9360e-01,  2.2727e+00,        -inf,        -inf],
          [ 8.0053e-01,  1.7820e+00,  4.7790e-03,        -inf],
          [-1.0986e+00,  4.1659e+00,  8.1011e-02,  4.0753e+00]],

         [[ 2.3951e+00,        -inf,        -inf,        -inf],
          [ 8.1953e-01, -7.0086e-01,        -inf,        -inf],
          [ 7.2422e+00,  1.1399e+00,  1.6559e+00,        -inf],
          [ 2.1090e+00,  2.1882e+00,  5.3811e+00,  6.0751e-01]],

         [[-5.2056e-01,        -inf,        -inf,        -inf],
          [ 2.8015e-02, -1.0527e+00,        -inf,        -inf],
          [ 4.7949e+00, -3.2307e-01, -7.8927e-01,        -inf],
          [-3.5467e+00, -1.2001e+00, -3.8492e+00, -2.4308e+00]],

         [[ 1.0416e+00,        -inf,        -inf,        -inf],
          [-2.6740e+00, -3.2260e+00,        -inf,        -inf],
          [ 2.0051e+00,  4.1133e-01, -3.6894e+00,        -inf],
          [ 2.0433e-01, -2.4270e+00, -1.2770e+00,  1.2257e+00]],

         [[-2.9047e+00,        -inf,        -inf,        -inf],
          [ 2.1058e+00, -1.4595e+00,        -inf,        -inf],
          [-1.0097e+00, -1.7080e+00,  2.7552e-01,        -inf],
          [ 1.0839e+00,  5.2094e-01,  3.8421e+00,  8.3403e-02]],

         [[ 4.3804e+00,        -inf,        -inf,        -inf],
          [ 3.8836e-01,  3.0081e+00,        -inf,        -inf],
          [-1.9538e+00,  1.8307e+00,  1.7178e+00,        -inf],
          [-7.8722e-01,  2.5416e+00,  1.5040e-01, -1.9922e+00]],

         [[-1.4442e+00,        -inf,        -inf,        -inf],
          [-2.1713e+00,  6.2107e+00,        -inf,        -inf],
          [ 2.0430e+00,  3.6125e+00,  5.6783e+00,        -inf],
          [-1.9277e+00,  2.8701e+00,  3.0747e+00,  2.3923e+00]],

         [[ 2.7281e+00,        -inf,        -inf,        -inf],
          [-1.2345e+00, -2.7426e-01,        -inf,        -inf],
          [-2.3554e-01,  7.4041e-01, -1.1407e+00,        -inf],
          [ 6.3276e+00,  1.3649e-01, -6.2505e-01, -1.6146e+00]],

         [[-4.8261e+00,        -inf,        -inf,        -inf],
          [-1.1196e+00,  3.5785e-01,        -inf,        -inf],
          [-3.4134e+00,  6.4577e+00,  2.6720e+00,        -inf],
          [ 3.4523e-01,  4.2145e+00, -1.8601e-01,  4.0282e+00]],

         [[-3.6540e+00,        -inf,        -inf,        -inf],
          [-1.7949e+00,  1.1558e+00,        -inf,        -inf],
          [-1.3709e+00, -2.2591e+00, -2.2893e+00,        -inf],
          [-1.3648e+00,  1.0604e-01, -6.2020e-01,  3.0544e+00]],

         [[ 3.0572e+00,        -inf,        -inf,        -inf],
          [-1.4761e+00,  2.6517e+00,        -inf,        -inf],
          [ 3.0969e-01,  1.8937e-01, -3.5986e+00,        -inf],
          [-3.5361e+00, -1.7947e+00, -2.9039e+00,  1.3990e+00]],

         [[ 2.4764e+00,        -inf,        -inf,        -inf],
          [-6.9929e-01, -3.2997e-01,        -inf,        -inf],
          [ 8.2203e-01, -1.3891e+00, -3.5731e+00,        -inf],
          [-4.7628e+00, -4.3427e+00, -2.8668e+00, -2.5178e+00]],

         [[ 1.2276e-01,        -inf,        -inf,        -inf],
          [-9.3140e-01,  8.0671e-01,        -inf,        -inf],
          [ 2.3386e+00,  2.7341e+00, -2.5309e-01,        -inf],
          [ 1.9986e+00,  4.0172e+00,  3.9857e+00,  3.0962e+00]],

         [[-2.7414e-01,        -inf,        -inf,        -inf],
          [ 2.7522e+00,  4.1369e+00,        -inf,        -inf],
          [ 3.4118e+00,  1.5640e-01,  1.2112e+00,        -inf],
          [ 5.3082e+00,  3.0063e+00,  2.3241e+00,  7.1709e+00]],

         [[-2.6527e+00,        -inf,        -inf,        -inf],
          [ 4.0267e+00,  2.7746e+00,        -inf,        -inf],
          [-2.1097e+00, -2.3728e-01,  2.4860e+00,        -inf],
          [ 5.9136e+00,  2.8224e+00,  7.1223e-02,  3.0940e+00]],

         [[ 1.3799e+00,        -inf,        -inf,        -inf],
          [-2.5761e-01,  1.8597e+00,        -inf,        -inf],
          [ 1.1880e+00,  4.0456e+00, -5.2764e-01,        -inf],
          [ 2.9774e+00,  4.8572e+00, -1.1981e+00, -2.3770e+00]],

         [[ 4.0293e+00,        -inf,        -inf,        -inf],
          [-6.8595e-01, -1.8680e+00,        -inf,        -inf],
          [ 2.8918e+00, -6.1451e-01, -8.5610e-02,        -inf],
          [ 3.4070e-02,  1.1464e+00, -1.7936e+00,  3.6992e-01]],

         [[ 3.2952e-01,        -inf,        -inf,        -inf],
          [ 1.4039e+00,  1.2908e+00,        -inf,        -inf],
          [ 8.7009e-01, -2.5672e+00, -2.3403e+00,        -inf],
          [-1.3929e+00, -1.6081e+00, -1.8003e+00, -5.8531e-01]]],


        [[[ 8.2757e-01,        -inf,        -inf,        -inf],
          [ 1.1740e+00,  3.6003e+00,        -inf,        -inf],
          [ 2.1297e+00, -4.2498e-01,  3.9520e+00,        -inf],
          [-1.3255e+00, -4.8323e+00,  8.0665e-01, -9.7341e-01]],

         [[-4.5052e-01,        -inf,        -inf,        -inf],
          [ 1.4120e+00, -1.8225e+00,        -inf,        -inf],
          [ 1.6882e+00, -4.5810e-01,  1.1907e+00,        -inf],
          [-1.0005e+00, -8.6008e-02, -2.2975e+00, -1.1474e+00]],

         [[-4.0480e+00,        -inf,        -inf,        -inf],
          [-5.3324e-01, -4.3083e-01,        -inf,        -inf],
          [ 1.0605e-01, -9.6033e-01, -1.8443e-01,        -inf],
          [ 2.3968e+00,  3.0562e+00,  1.7084e+00,  1.3165e+00]],

         [[-3.7903e+00,        -inf,        -inf,        -inf],
          [-1.3375e-02, -6.5240e-01,        -inf,        -inf],
          [-5.3606e+00, -1.7534e+00,  1.8101e+00,        -inf],
          [-3.6011e+00,  4.2354e+00,  2.8676e-01, -4.2408e-01]],

         [[ 3.2808e+00,        -inf,        -inf,        -inf],
          [ 2.5466e+00, -1.0331e-01,        -inf,        -inf],
          [ 3.1275e+00, -3.9316e-01,  9.3545e-01,        -inf],
          [ 2.3272e+00,  1.1741e+00,  2.7574e+00,  9.2380e-01]],

         [[ 1.5910e+00,        -inf,        -inf,        -inf],
          [-2.5276e+00,  4.3843e-01,        -inf,        -inf],
          [-2.2139e+00, -1.5914e+00, -1.2890e+00,        -inf],
          [ 2.1574e+00,  1.0721e+00,  9.6144e-01,  6.8560e-01]],

         [[-5.2325e+00,        -inf,        -inf,        -inf],
          [ 1.3213e+00, -1.7231e+00,        -inf,        -inf],
          [-2.8750e+00, -3.5691e+00, -3.6618e+00,        -inf],
          [-2.2730e+00, -3.5674e+00, -5.9414e+00, -1.0214e+00]],

         [[-8.8398e-01,        -inf,        -inf,        -inf],
          [-2.2971e-01,  3.2154e+00,        -inf,        -inf],
          [ 2.4934e+00,  1.6446e+00,  3.9220e+00,        -inf],
          [-3.0457e+00,  1.6102e+00,  1.9593e+00,  2.1403e+00]],

         [[ 1.1857e-01,        -inf,        -inf,        -inf],
          [ 2.1734e+00,  3.1176e+00,        -inf,        -inf],
          [ 1.5789e+00,  1.7154e+00, -5.7469e-01,        -inf],
          [ 3.3221e+00,  6.7446e-02,  3.0099e-01, -3.3766e+00]],

         [[ 1.4149e+00,        -inf,        -inf,        -inf],
          [ 1.8766e+00,  4.0387e+00,        -inf,        -inf],
          [ 1.1291e+00,  6.4227e+00,  3.3981e+00,        -inf],
          [-8.2885e+00, -2.2741e+00,  2.4002e+00, -5.8661e+00]],

         [[ 1.2422e+00,        -inf,        -inf,        -inf],
          [-2.1019e+00, -1.8858e+00,        -inf,        -inf],
          [ 1.3791e+00, -8.2369e-01,  9.1130e-01,        -inf],
          [-2.4136e+00, -3.4439e+00, -4.7349e-01,  2.6677e+00]],

         [[-2.9770e+00,        -inf,        -inf,        -inf],
          [ 6.2260e-01, -2.1511e+00,        -inf,        -inf],
          [ 2.8128e-01, -1.5269e+00, -5.7213e+00,        -inf],
          [-1.5664e-01,  5.5960e-02, -1.6831e+00,  2.4891e+00]],

         [[ 4.6182e+00,        -inf,        -inf,        -inf],
          [ 2.9713e+00,  3.5721e+00,        -inf,        -inf],
          [ 2.9702e+00,  6.6991e+00,  2.3941e+00,        -inf],
          [-1.5214e+00,  5.7575e-01, -3.3851e-01,  1.7037e+00]],

         [[ 1.9419e+00,        -inf,        -inf,        -inf],
          [ 1.3119e+00,  5.9586e+00,        -inf,        -inf],
          [ 2.9906e+00,  7.0229e+00,  6.1743e+00,        -inf],
          [ 1.4209e+00,  3.4562e+00,  4.5894e+00,  4.4632e+00]],

         [[ 4.7173e+00,        -inf,        -inf,        -inf],
          [ 1.3551e+00,  8.9205e-01,        -inf,        -inf],
          [-5.2034e-01,  9.9856e-01, -1.3852e+00,        -inf],
          [ 1.2920e+00, -1.0990e+00, -2.0196e-02, -8.9854e-01]],

         [[-2.8127e+00,        -inf,        -inf,        -inf],
          [ 2.6661e+00, -6.0203e-01,        -inf,        -inf],
          [-3.4060e-01,  3.6970e+00,  8.5236e+00,        -inf],
          [-3.5273e+00,  5.1517e-01, -2.2403e+00, -2.0658e+00]],

         [[-4.4180e+00,        -inf,        -inf,        -inf],
          [ 7.5380e-01, -5.1265e-01,        -inf,        -inf],
          [-1.5534e+00,  3.4315e-01, -5.9814e-01,        -inf],
          [-2.3230e-01,  2.6736e+00, -9.1766e-02, -3.3279e+00]],

         [[ 1.5338e+00,        -inf,        -inf,        -inf],
          [ 1.5934e+00,  1.8705e+00,        -inf,        -inf],
          [-5.7166e-01, -2.4990e+00, -1.3162e+00,        -inf],
          [-2.0721e+00, -2.9236e-01, -1.1022e+00,  6.7528e-01]],

         [[ 3.0447e+00,        -inf,        -inf,        -inf],
          [ 6.0064e+00,  3.8170e+00,        -inf,        -inf],
          [ 5.0252e+00,  1.0844e+00,  1.2142e+00,        -inf],
          [-4.7869e+00, -1.7502e+00,  7.1573e-02,  1.3320e+00]],

         [[ 4.7194e-01,        -inf,        -inf,        -inf],
          [ 6.8060e-01, -1.8013e+00,        -inf,        -inf],
          [ 1.0795e+00,  4.2898e-01, -1.6309e+00,        -inf],
          [ 3.1752e+00,  2.0107e+00, -1.8911e+00,  7.8730e-01]],

         [[ 1.4629e+00,        -inf,        -inf,        -inf],
          [-1.4648e+00, -3.3564e+00,        -inf,        -inf],
          [ 2.1837e+00, -4.8154e-01,  2.3347e+00,        -inf],
          [ 7.2461e+00,  2.4505e+00,  4.9935e+00,  4.6520e+00]],

         [[-2.3442e+00,        -inf,        -inf,        -inf],
          [ 2.8773e+00,  2.8804e+00,        -inf,        -inf],
          [-2.2936e+00, -1.2200e+00,  3.5864e+00,        -inf],
          [ 4.0457e-01,  3.1688e+00,  2.4311e+00, -1.8155e+00]],

         [[ 2.4483e+00,        -inf,        -inf,        -inf],
          [ 1.9436e+00,  7.5069e-01,        -inf,        -inf],
          [ 9.1465e-01, -1.5554e+00,  1.5193e+00,        -inf],
          [ 2.3786e+00, -2.4961e+00,  6.3101e-01, -6.1082e-01]],

         [[-9.2746e-02,        -inf,        -inf,        -inf],
          [-2.7211e+00, -2.4670e+00,        -inf,        -inf],
          [ 9.9907e-01, -9.8211e-01, -2.0832e+00,        -inf],
          [-5.2750e-01,  6.6726e-01, -4.3419e-01, -5.5025e-01]],

         [[ 8.2904e-01,        -inf,        -inf,        -inf],
          [ 5.5650e-01,  3.0356e+00,        -inf,        -inf],
          [ 3.0783e-02, -1.6564e+00,  5.5144e-01,        -inf],
          [ 5.3879e-01,  6.2493e-01,  1.6120e-01,  7.7316e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.4414e+00, -7.1752e-02, -7.4292e-01,  ..., -5.5785e-01,
           -2.9883e-01, -1.7597e-01],
          [ 2.2998e-01,  1.2436e+00, -7.1921e-01,  ...,  9.5398e-01,
            1.4345e-01, -9.8244e-02],
          [-1.8513e-02,  6.1074e-01,  8.2047e-01,  ..., -6.8881e-01,
           -9.7856e-01, -4.3824e-01],
          ...,
          [ 1.7335e-01, -1.2093e+00,  5.1583e-01,  ...,  4.6851e-01,
           -1.1397e+00, -3.9290e-01],
          [-2.0199e-03,  3.6869e-01, -6.9772e-01,  ..., -1.0547e+00,
            7.4270e-01,  5.9468e-02],
          [ 9.1317e-01, -8.7417e-02,  1.3955e+00,  ..., -1.1946e-01,
            7.6126e-01,  2.3398e-02]],

         [[-9.4974e-01,  2.7962e-02, -5.1792e-01,  ..., -3.5190e-01,
           -6.3015e-01, -1.8628e-01],
          [ 1.6340e-01,  9.6488e-01, -9.8998e-01,  ...,  3.1036e-01,
           -5.5042e-01, -5.5154e-02],
          [-6.5832e-01, -6.5909e-01,  8.5232e-01,  ..., -1.4519e-01,
           -8.0598e-01, -6.9775e-01],
          ...,
          [ 2.2137e-01, -5.9076e-01,  3.6505e-01,  ...,  5.4139e-01,
           -3.9440e-01, -3.2354e-01],
          [-2.1678e-01,  1.0203e-01, -1.0417e+00,  ..., -5.2733e-01,
           -1.7460e-01, -1.7285e-01],
          [ 4.2632e-01,  3.0973e-01,  1.1322e+00,  ..., -6.7934e-01,
            1.4475e+00, -5.7082e-01]],

         [[-7.0242e-01, -1.3961e-01, -3.9360e-01,  ...,  2.3264e-01,
           -6.9409e-01,  2.6957e-01],
          [ 1.5193e-01,  1.0051e+00, -9.7260e-01,  ...,  1.2191e-01,
           -5.0312e-01, -2.8856e-01],
          [-4.8540e-01, -6.2330e-01,  1.2387e+00,  ...,  4.9370e-02,
           -7.2181e-01, -4.1147e-01],
          ...,
          [ 1.7410e-01, -7.1574e-01,  8.4845e-02,  ...,  2.4018e-01,
           -2.5929e-01, -2.9311e-01],
          [-2.8409e-01,  4.9501e-02, -6.7285e-01,  ..., -5.7736e-01,
            2.1822e-01,  1.0720e-03],
          [ 5.4319e-01,  3.4242e-01,  1.0408e+00,  ..., -4.0322e-01,
            1.0185e+00, -4.7844e-01]],

         [[-4.8978e-01,  2.1140e-02, -2.5557e-01,  ..., -3.5311e-02,
           -5.9015e-01, -1.3418e-01],
          [-1.2319e-01,  7.1890e-01, -6.3834e-01,  ..., -4.5937e-02,
           -2.0462e-01, -2.6072e-01],
          [-6.7634e-01, -4.1942e-01,  7.7552e-01,  ...,  3.4372e-02,
           -3.9773e-01, -4.4947e-01],
          ...,
          [ 1.1167e-01, -7.7473e-01,  1.2111e-01,  ...,  2.8164e-01,
           -4.1440e-01, -3.3679e-01],
          [-5.4056e-01, -8.5095e-02, -1.1942e+00,  ..., -1.1266e-01,
           -2.3699e-01,  8.7639e-02],
          [ 4.6912e-01,  5.2455e-01,  8.4108e-01,  ..., -3.6102e-01,
            7.0994e-01, -3.3679e-01]]],


        [[[-1.0013e+00,  2.5153e-01, -8.9582e-01,  ..., -8.8389e-02,
           -1.6652e-01, -5.4191e-01],
          [ 3.2181e-01,  4.0801e-01, -3.7173e-01,  ...,  2.4664e-01,
           -4.7728e-02,  1.5650e-02],
          [ 8.5297e-02,  9.0390e-01,  8.0765e-01,  ..., -7.2440e-01,
           -5.5263e-01, -1.6993e-01],
          ...,
          [ 2.2769e-01, -1.7796e+00,  3.0408e-01,  ...,  4.5397e-01,
           -7.6724e-01, -7.3917e-01],
          [-1.4283e-02, -4.7065e-01, -5.7916e-01,  ..., -9.7550e-01,
            9.2103e-01,  5.1900e-01],
          [ 8.6459e-01, -1.4401e-01,  9.6015e-01,  ..., -3.0706e-01,
            4.8766e-01, -1.3357e-01]],

         [[-7.2695e-01,  2.0873e-01, -6.1180e-01,  ..., -3.9096e-02,
           -3.9939e-01, -1.0796e+00],
          [-6.9643e-02,  4.1311e-01, -2.7873e-01,  ...,  1.6119e-01,
           -5.6787e-01,  1.2744e-01],
          [-4.1190e-01, -6.0561e-02,  1.0229e+00,  ..., -7.9188e-01,
           -7.0295e-01, -4.7667e-01],
          ...,
          [ 4.1131e-01, -1.3312e+00,  9.3612e-02,  ..., -4.7275e-02,
           -3.3863e-01, -4.9786e-01],
          [-1.4744e-01, -5.6478e-01, -9.7068e-01,  ..., -5.3422e-01,
           -9.9384e-02, -1.4981e-02],
          [ 8.4003e-01, -1.1898e-01,  5.7159e-01,  ..., -2.6323e-01,
            6.0903e-01, -3.5140e-01]],

         [[-1.2776e-01,  4.3156e-02, -9.7961e-02,  ..., -6.5734e-04,
           -1.3920e-01, -3.5976e-01],
          [-3.1482e-01,  4.2350e-01, -4.2224e-01,  ...,  1.5800e-01,
           -7.5104e-01,  3.8071e-01],
          [-2.4821e-01,  6.1748e-03,  6.6520e-01,  ..., -5.1972e-01,
           -4.5703e-01, -3.0011e-01],
          ...,
          [ 2.5805e-01, -1.1758e+00, -2.9722e-01,  ...,  4.6863e-02,
           -1.8935e-01, -5.1072e-01],
          [-3.3645e-01, -5.9297e-01, -1.0434e+00,  ..., -4.1312e-01,
           -4.5391e-02,  1.2270e-01],
          [ 5.3189e-01, -7.8380e-02,  4.1438e-01,  ..., -1.7177e-01,
            3.6599e-01, -1.9032e-01]],

         [[-1.9558e-01,  1.6678e-01, -6.7765e-01,  ..., -1.1079e-01,
           -6.2202e-01, -1.3471e-01],
          [-2.7584e-01,  4.3285e-01, -9.5769e-02,  ...,  9.8237e-02,
           -4.1269e-01, -1.2966e-01],
          [ 3.7278e-02, -3.9928e-01,  7.4794e-01,  ..., -8.3612e-01,
           -6.0035e-01, -1.6445e-01],
          ...,
          [ 1.9657e-01, -9.6031e-01, -1.7955e-01,  ...,  7.1197e-02,
           -1.9533e-01, -4.1445e-01],
          [-3.6037e-01, -5.2980e-01, -1.1237e+00,  ..., -8.1786e-02,
            8.2024e-03,  2.5739e-01],
          [ 4.7007e-01, -6.8826e-02,  5.6407e-01,  ..., -1.2405e-01,
            1.6610e-01, -3.4612e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.4414, -0.0718, -0.7429,  ..., -0.1195,  0.7613,  0.0234],
         [-0.9497,  0.0280, -0.5179,  ..., -0.6793,  1.4475, -0.5708],
         [-0.7024, -0.1396, -0.3936,  ..., -0.4032,  1.0185, -0.4784],
         [-0.4898,  0.0211, -0.2556,  ..., -0.3610,  0.7099, -0.3368]],

        [[-1.0013,  0.2515, -0.8958,  ..., -0.3071,  0.4877, -0.1336],
         [-0.7269,  0.2087, -0.6118,  ..., -0.2632,  0.6090, -0.3514],
         [-0.1278,  0.0432, -0.0980,  ..., -0.1718,  0.3660, -0.1903],
         [-0.1956,  0.1668, -0.6776,  ..., -0.1240,  0.1661, -0.3461]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.3884,  0.1783, -0.6840,  ...,  0.3359,  0.0429, -0.0312],
         [ 0.4046,  0.0863, -0.5662,  ...,  0.2470, -0.0912,  0.0519],
         [ 0.5779,  0.0340, -0.4967,  ...,  0.0616,  0.2271, -0.0546],
         [ 0.3177,  0.2914, -0.3944,  ...,  0.0190,  0.3632, -0.1163]],

        [[ 0.5035,  0.3323, -0.3928,  ...,  0.1817, -0.0745, -0.1090],
         [ 0.4573,  0.2007, -0.2394,  ..., -0.1530,  0.0825, -0.1797],
         [ 0.3878,  0.2843, -0.5277,  ..., -0.1036,  0.0363, -0.3567],
         [ 0.4084,  0.4676, -0.3545,  ..., -0.1363,  0.0776, -0.3601]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-2.9474e+00,        -inf,        -inf,        -inf],
          [-4.3276e+00, -4.8785e+00,        -inf,        -inf],
          [ 4.3805e-01, -2.6252e+00, -1.8504e+00,        -inf],
          [-6.2903e+00,  1.5195e+00,  5.4633e-01, -1.1094e+00]],

         [[ 1.8091e-01,        -inf,        -inf,        -inf],
          [ 1.6211e+00,  4.3647e-01,        -inf,        -inf],
          [ 4.6706e+00, -5.5762e-01, -3.0006e+00,        -inf],
          [ 1.5621e+00,  1.6935e+00, -3.9573e-01,  1.6079e+00]],

         [[ 5.1105e+00,        -inf,        -inf,        -inf],
          [ 6.5397e+00,  4.1293e+00,        -inf,        -inf],
          [ 1.8922e+00,  3.5050e+00,  3.3263e-02,        -inf],
          [ 3.7694e-01,  4.1385e+00, -1.4435e-01,  2.6658e+00]],

         [[-1.6501e+00,        -inf,        -inf,        -inf],
          [-4.1869e+00, -2.8519e+00,        -inf,        -inf],
          [-6.8075e-02, -1.5847e+00,  2.1679e-01,        -inf],
          [ 2.7815e+00,  1.4829e+00,  1.2307e+00,  2.7638e-02]],

         [[ 1.8347e+00,        -inf,        -inf,        -inf],
          [-1.4602e+00, -9.4929e-01,        -inf,        -inf],
          [-5.5294e-01,  3.4680e+00,  1.4829e+00,        -inf],
          [-3.2414e+00, -2.2230e+00,  7.8288e-01, -3.2788e+00]],

         [[-1.4383e+00,        -inf,        -inf,        -inf],
          [-2.9609e+00, -6.4717e+00,        -inf,        -inf],
          [ 3.8867e+00, -1.6224e+00,  1.3040e+00,        -inf],
          [-4.1823e+00,  9.3272e-01, -1.4534e-01,  7.1149e-01]],

         [[ 4.4314e-02,        -inf,        -inf,        -inf],
          [-2.0684e+00, -1.2183e+00,        -inf,        -inf],
          [-8.5141e+00, -3.6265e+00, -4.9108e+00,        -inf],
          [-2.7369e+00,  1.7286e+00,  5.4271e-01,  9.8122e-01]],

         [[-1.2010e+00,        -inf,        -inf,        -inf],
          [ 1.3637e+00,  4.1889e+00,        -inf,        -inf],
          [-1.1606e-02, -1.2075e+00,  2.0507e+00,        -inf],
          [-1.3757e+00,  1.4272e+00,  2.2414e+00, -5.6851e-01]],

         [[-8.0022e-01,        -inf,        -inf,        -inf],
          [ 3.4294e+00,  3.5223e+00,        -inf,        -inf],
          [ 7.1019e+00,  5.5711e+00,  2.7238e+00,        -inf],
          [ 1.0436e+00,  4.7085e+00,  1.4651e+00, -2.9828e+00]],

         [[-1.2479e+00,        -inf,        -inf,        -inf],
          [ 1.1678e-01,  6.8459e+00,        -inf,        -inf],
          [-4.0505e+00,  2.9738e+00,  3.3302e+00,        -inf],
          [-3.8282e+00,  1.1159e+00, -2.5320e-02,  2.7965e+00]],

         [[-4.9446e-02,        -inf,        -inf,        -inf],
          [-9.1548e-01,  9.2573e-01,        -inf,        -inf],
          [-6.9881e-01, -4.1310e+00, -2.5636e+00,        -inf],
          [ 3.6714e+00, -1.4436e+00,  4.5082e+00, -1.8668e+00]],

         [[ 2.2595e+00,        -inf,        -inf,        -inf],
          [-5.1837e-02,  1.1707e+00,        -inf,        -inf],
          [ 8.4102e-01, -1.8125e-01, -6.9173e-01,        -inf],
          [ 1.8054e+00,  1.5969e+00,  2.1297e+00, -3.2517e+00]],

         [[-3.6317e+00,        -inf,        -inf,        -inf],
          [-1.6506e-01, -4.2518e+00,        -inf,        -inf],
          [ 2.8099e+00,  5.5284e-03,  1.6710e+00,        -inf],
          [-3.5246e-01, -2.9073e+00, -1.9656e+00, -3.5212e+00]],

         [[-1.7667e+00,        -inf,        -inf,        -inf],
          [ 7.0847e-02, -1.3304e+00,        -inf,        -inf],
          [-1.4890e+00, -9.5192e-01, -6.7703e-01,        -inf],
          [ 1.3905e+00,  1.2949e+00, -2.5897e+00,  2.5080e+00]],

         [[ 2.8933e+00,        -inf,        -inf,        -inf],
          [ 2.2227e-01,  8.4143e-01,        -inf,        -inf],
          [ 8.6583e-02,  3.3925e+00, -1.8450e+00,        -inf],
          [-4.1957e+00, -4.4509e+00, -1.5672e+00,  2.9824e-01]],

         [[-1.5511e+00,        -inf,        -inf,        -inf],
          [ 6.0095e-01,  1.0498e+00,        -inf,        -inf],
          [ 2.7313e+00,  3.1300e+00,  1.3723e+00,        -inf],
          [ 2.5215e+00,  2.7980e+00, -2.6127e+00, -3.3776e+00]],

         [[-4.3025e+00,        -inf,        -inf,        -inf],
          [ 5.0826e-01,  5.5616e+00,        -inf,        -inf],
          [-7.6662e-01,  3.3563e+00,  6.2078e+00,        -inf],
          [ 4.6259e-01,  9.8649e-01,  1.3270e+00, -2.9910e+00]],

         [[ 3.0502e+00,        -inf,        -inf,        -inf],
          [ 1.7599e+00, -1.0877e+00,        -inf,        -inf],
          [ 3.2199e-01,  8.3762e-01,  4.8827e+00,        -inf],
          [ 5.2128e+00,  2.9505e+00,  6.9080e+00,  4.8208e+00]],

         [[-3.0477e+00,        -inf,        -inf,        -inf],
          [-1.1260e+00, -5.3138e+00,        -inf,        -inf],
          [-2.6223e+00, -2.4085e+00, -1.1056e+01,        -inf],
          [-3.3381e+00, -4.0335e+00, -1.2222e+00, -2.5720e+00]],

         [[-1.6376e+00,        -inf,        -inf,        -inf],
          [-3.4186e+00, -6.4060e-01,        -inf,        -inf],
          [-9.3803e-01,  2.6351e-01,  2.1639e+00,        -inf],
          [ 1.4777e+00,  1.5883e-02, -2.2591e+00, -1.8595e+00]],

         [[ 6.5988e+00,        -inf,        -inf,        -inf],
          [ 5.2856e+00,  3.4253e+00,        -inf,        -inf],
          [ 1.7681e+00,  1.2822e+00,  1.3586e+00,        -inf],
          [-2.5436e+00,  1.1683e+00, -1.4015e+00, -3.4049e-02]],

         [[ 2.7568e+00,        -inf,        -inf,        -inf],
          [ 2.8147e+00,  8.3116e-01,        -inf,        -inf],
          [ 6.2814e-01,  4.9683e+00,  3.0333e+00,        -inf],
          [ 6.6583e+00,  5.6404e+00,  7.9206e+00,  3.0159e+00]],

         [[ 2.6645e+00,        -inf,        -inf,        -inf],
          [ 7.0287e-01, -1.8421e+00,        -inf,        -inf],
          [ 1.7416e+00, -2.1051e+00, -3.4970e+00,        -inf],
          [-4.1973e+00, -2.3437e+00, -7.3167e+00, -8.4881e-01]],

         [[ 1.1806e+00,        -inf,        -inf,        -inf],
          [-2.7677e+00,  9.5199e-01,        -inf,        -inf],
          [ 1.3736e+00, -2.0010e+00,  1.1574e+00,        -inf],
          [-3.2728e+00, -7.6985e+00, -1.4606e+00, -3.3280e+00]],

         [[ 1.7511e+00,        -inf,        -inf,        -inf],
          [ 1.2914e+00,  5.1404e+00,        -inf,        -inf],
          [-1.0296e+00,  1.5363e+00, -2.1463e+00,        -inf],
          [ 3.5210e+00, -1.8793e-01,  5.5592e-01,  2.2767e+00]]],


        [[[-2.5216e+00,        -inf,        -inf,        -inf],
          [-2.6473e+00, -3.1019e+00,        -inf,        -inf],
          [ 3.9570e+00, -1.5438e+00, -7.5045e-01,        -inf],
          [-5.7579e+00,  5.9064e-01,  4.2012e+00,  5.2957e-01]],

         [[-4.2571e-01,        -inf,        -inf,        -inf],
          [ 1.9128e+00, -2.2589e+00,        -inf,        -inf],
          [ 1.4169e+00, -1.2902e+00, -5.5806e-02,        -inf],
          [ 3.7320e+00,  2.6984e+00, -3.1541e+00,  1.9621e-01]],

         [[ 2.4589e+00,        -inf,        -inf,        -inf],
          [ 1.0977e+00,  1.7622e-03,        -inf,        -inf],
          [-1.7936e+00,  1.0055e+00, -1.0149e+00,        -inf],
          [-7.2064e-01,  6.7473e-01,  4.3948e+00,  2.0982e+00]],

         [[-4.6684e+00,        -inf,        -inf,        -inf],
          [-7.8223e+00, -2.8985e+00,        -inf,        -inf],
          [-5.1241e+00, -1.4277e-01, -4.5352e+00,        -inf],
          [ 4.9809e+00,  6.0983e+00, -7.9414e-01, -8.5509e-01]],

         [[ 1.5567e+00,        -inf,        -inf,        -inf],
          [ 1.0710e+00,  2.6756e-01,        -inf,        -inf],
          [ 1.8087e-01,  5.0066e-01,  7.2688e-01,        -inf],
          [ 2.6011e+00,  4.6563e+00,  5.1125e+00,  4.0427e+00]],

         [[-2.5423e+00,        -inf,        -inf,        -inf],
          [ 3.0799e+00, -2.3540e+00,        -inf,        -inf],
          [ 3.1988e+00,  4.2443e+00,  5.5899e+00,        -inf],
          [-7.0555e-01, -2.2250e-01, -3.0200e-01,  3.7866e+00]],

         [[ 1.0902e+00,        -inf,        -inf,        -inf],
          [-9.1521e-01, -1.8101e+00,        -inf,        -inf],
          [-5.1531e+00, -1.7148e+00, -6.2198e+00,        -inf],
          [-2.8015e+00,  1.0488e+00, -1.3495e+00, -5.5004e-01]],

         [[-5.1196e+00,        -inf,        -inf,        -inf],
          [-5.5159e+00, -6.3728e+00,        -inf,        -inf],
          [-5.8530e+00, -6.3074e+00, -4.1938e+00,        -inf],
          [-7.7304e-01, -1.7824e-01, -8.2450e-02,  2.4522e+00]],

         [[ 8.4741e-01,        -inf,        -inf,        -inf],
          [ 1.9258e+00, -1.7888e+00,        -inf,        -inf],
          [ 2.3941e+00,  1.1358e-02,  1.0769e+00,        -inf],
          [ 4.0481e+00, -3.1351e+00,  5.2466e-01, -3.4801e+00]],

         [[ 1.7375e+00,        -inf,        -inf,        -inf],
          [ 2.8531e+00,  6.6563e-01,        -inf,        -inf],
          [-7.2274e-01, -1.9445e+00,  9.1962e-01,        -inf],
          [ 1.9497e-01,  2.7166e+00, -5.7963e+00,  1.8587e+00]],

         [[ 4.4143e-01,        -inf,        -inf,        -inf],
          [-2.4097e+00, -8.5614e-02,        -inf,        -inf],
          [-8.5172e-01,  2.2264e+00, -1.8267e+00,        -inf],
          [ 3.1665e+00,  4.5554e+00,  6.9514e+00,  3.2802e+00]],

         [[ 2.0643e+00,        -inf,        -inf,        -inf],
          [-9.0156e-01, -1.3349e+00,        -inf,        -inf],
          [ 2.1694e+00,  2.2665e-01,  4.9222e+00,        -inf],
          [ 2.3486e+00,  2.8912e+00,  2.8895e+00, -2.5760e+00]],

         [[-3.9227e+00,        -inf,        -inf,        -inf],
          [-8.4709e-01, -1.9297e+00,        -inf,        -inf],
          [ 1.2181e+00,  3.9061e-01, -4.9657e+00,        -inf],
          [ 1.0461e+00, -8.4299e-01,  7.4148e-01, -1.1299e+00]],

         [[-7.8760e-01,        -inf,        -inf,        -inf],
          [-1.2755e+00, -1.1687e+00,        -inf,        -inf],
          [-2.0294e+00, -3.7240e-01, -1.0456e+00,        -inf],
          [-1.3843e+00, -2.5990e+00, -5.3899e+00, -6.9872e-01]],

         [[ 3.1469e+00,        -inf,        -inf,        -inf],
          [ 3.6287e+00,  6.0522e+00,        -inf,        -inf],
          [ 3.3538e+00,  6.9194e+00,  2.3490e+00,        -inf],
          [ 2.7618e+00,  9.2336e-01,  1.4706e+00,  2.3684e+00]],

         [[-1.3552e+00,        -inf,        -inf,        -inf],
          [ 7.4918e-01,  4.3548e+00,        -inf,        -inf],
          [-5.8603e-01,  3.4350e+00,  6.0660e+00,        -inf],
          [-3.2786e+00,  3.4341e+00,  6.5121e-01, -2.7417e+00]],

         [[-2.9774e+00,        -inf,        -inf,        -inf],
          [-2.5029e+00,  3.1690e-01,        -inf,        -inf],
          [ 2.5303e-01,  2.0185e+00,  1.2724e+00,        -inf],
          [ 5.0988e-01, -9.2868e-01, -5.0904e-01, -4.4273e+00]],

         [[ 1.8222e+00,        -inf,        -inf,        -inf],
          [ 9.9884e-01,  1.5221e+00,        -inf,        -inf],
          [-2.1472e+00, -6.3305e-01,  1.4639e+00,        -inf],
          [ 1.0464e+00, -8.0121e-01,  2.6365e+00, -3.2750e+00]],

         [[-3.7447e+00,        -inf,        -inf,        -inf],
          [-2.7617e+00, -3.2310e+00,        -inf,        -inf],
          [-3.8338e+00,  3.2315e+00, -1.7509e+00,        -inf],
          [-1.7398e+00,  3.5209e+00,  2.7681e+00, -2.6505e+00]],

         [[-2.5090e+00,        -inf,        -inf,        -inf],
          [-1.3801e+00,  5.8025e+00,        -inf,        -inf],
          [-1.6286e+00,  1.8033e+00,  5.1591e+00,        -inf],
          [-3.9033e+00, -1.5899e+00, -2.0555e+00, -2.2518e+00]],

         [[ 3.7072e+00,        -inf,        -inf,        -inf],
          [-9.7320e-02, -1.3156e+00,        -inf,        -inf],
          [-2.4125e-01, -2.8433e+00,  3.5823e-01,        -inf],
          [ 3.3628e-01, -2.2870e+00,  2.8662e+00,  3.6933e+00]],

         [[ 4.2882e+00,        -inf,        -inf,        -inf],
          [ 2.1976e+00,  4.0067e+00,        -inf,        -inf],
          [ 4.2402e+00,  2.7557e+00,  7.2341e-01,        -inf],
          [ 1.5316e+00,  2.2254e-01,  9.8542e-01,  6.4193e+00]],

         [[ 1.1077e+00,        -inf,        -inf,        -inf],
          [-4.6933e-01,  1.7696e+00,        -inf,        -inf],
          [-7.0924e-01, -1.2668e+00, -3.5749e-01,        -inf],
          [-1.4214e+00, -2.3987e+00, -1.9920e+00, -3.4538e+00]],

         [[-5.9685e-01,        -inf,        -inf,        -inf],
          [-5.7696e-02, -1.5146e+00,        -inf,        -inf],
          [ 2.0732e+00, -1.8387e+00,  3.1841e+00,        -inf],
          [ 1.4174e+00, -1.0355e+00,  3.4521e+00,  4.4059e+00]],

         [[-1.6945e-01,        -inf,        -inf,        -inf],
          [ 9.0473e-01, -2.1211e+00,        -inf,        -inf],
          [ 4.6914e-01,  9.5452e-01, -8.5939e-01,        -inf],
          [ 4.5325e+00,  2.3467e+00,  9.7255e-02, -1.4937e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-2.9474e+00,        -inf,        -inf,        -inf],
          [-4.3276e+00, -4.8785e+00,        -inf,        -inf],
          [ 4.3805e-01, -2.6252e+00, -1.8504e+00,        -inf],
          [-6.2903e+00,  1.5195e+00,  5.4633e-01, -1.1094e+00]],

         [[ 1.8091e-01,        -inf,        -inf,        -inf],
          [ 1.6211e+00,  4.3647e-01,        -inf,        -inf],
          [ 4.6706e+00, -5.5762e-01, -3.0006e+00,        -inf],
          [ 1.5621e+00,  1.6935e+00, -3.9573e-01,  1.6079e+00]],

         [[ 5.1105e+00,        -inf,        -inf,        -inf],
          [ 6.5397e+00,  4.1293e+00,        -inf,        -inf],
          [ 1.8922e+00,  3.5050e+00,  3.3263e-02,        -inf],
          [ 3.7694e-01,  4.1385e+00, -1.4435e-01,  2.6658e+00]],

         [[-1.6501e+00,        -inf,        -inf,        -inf],
          [-4.1869e+00, -2.8519e+00,        -inf,        -inf],
          [-6.8075e-02, -1.5847e+00,  2.1679e-01,        -inf],
          [ 2.7815e+00,  1.4829e+00,  1.2307e+00,  2.7638e-02]],

         [[ 1.8347e+00,        -inf,        -inf,        -inf],
          [-1.4602e+00, -9.4929e-01,        -inf,        -inf],
          [-5.5294e-01,  3.4680e+00,  1.4829e+00,        -inf],
          [-3.2414e+00, -2.2230e+00,  7.8288e-01, -3.2788e+00]],

         [[-1.4383e+00,        -inf,        -inf,        -inf],
          [-2.9609e+00, -6.4717e+00,        -inf,        -inf],
          [ 3.8867e+00, -1.6224e+00,  1.3040e+00,        -inf],
          [-4.1823e+00,  9.3272e-01, -1.4534e-01,  7.1149e-01]],

         [[ 4.4314e-02,        -inf,        -inf,        -inf],
          [-2.0684e+00, -1.2183e+00,        -inf,        -inf],
          [-8.5141e+00, -3.6265e+00, -4.9108e+00,        -inf],
          [-2.7369e+00,  1.7286e+00,  5.4271e-01,  9.8122e-01]],

         [[-1.2010e+00,        -inf,        -inf,        -inf],
          [ 1.3637e+00,  4.1889e+00,        -inf,        -inf],
          [-1.1606e-02, -1.2075e+00,  2.0507e+00,        -inf],
          [-1.3757e+00,  1.4272e+00,  2.2414e+00, -5.6851e-01]],

         [[-8.0022e-01,        -inf,        -inf,        -inf],
          [ 3.4294e+00,  3.5223e+00,        -inf,        -inf],
          [ 7.1019e+00,  5.5711e+00,  2.7238e+00,        -inf],
          [ 1.0436e+00,  4.7085e+00,  1.4651e+00, -2.9828e+00]],

         [[-1.2479e+00,        -inf,        -inf,        -inf],
          [ 1.1678e-01,  6.8459e+00,        -inf,        -inf],
          [-4.0505e+00,  2.9738e+00,  3.3302e+00,        -inf],
          [-3.8282e+00,  1.1159e+00, -2.5320e-02,  2.7965e+00]],

         [[-4.9446e-02,        -inf,        -inf,        -inf],
          [-9.1548e-01,  9.2573e-01,        -inf,        -inf],
          [-6.9881e-01, -4.1310e+00, -2.5636e+00,        -inf],
          [ 3.6714e+00, -1.4436e+00,  4.5082e+00, -1.8668e+00]],

         [[ 2.2595e+00,        -inf,        -inf,        -inf],
          [-5.1837e-02,  1.1707e+00,        -inf,        -inf],
          [ 8.4102e-01, -1.8125e-01, -6.9173e-01,        -inf],
          [ 1.8054e+00,  1.5969e+00,  2.1297e+00, -3.2517e+00]],

         [[-3.6317e+00,        -inf,        -inf,        -inf],
          [-1.6506e-01, -4.2518e+00,        -inf,        -inf],
          [ 2.8099e+00,  5.5284e-03,  1.6710e+00,        -inf],
          [-3.5246e-01, -2.9073e+00, -1.9656e+00, -3.5212e+00]],

         [[-1.7667e+00,        -inf,        -inf,        -inf],
          [ 7.0847e-02, -1.3304e+00,        -inf,        -inf],
          [-1.4890e+00, -9.5192e-01, -6.7703e-01,        -inf],
          [ 1.3905e+00,  1.2949e+00, -2.5897e+00,  2.5080e+00]],

         [[ 2.8933e+00,        -inf,        -inf,        -inf],
          [ 2.2227e-01,  8.4143e-01,        -inf,        -inf],
          [ 8.6583e-02,  3.3925e+00, -1.8450e+00,        -inf],
          [-4.1957e+00, -4.4509e+00, -1.5672e+00,  2.9824e-01]],

         [[-1.5511e+00,        -inf,        -inf,        -inf],
          [ 6.0095e-01,  1.0498e+00,        -inf,        -inf],
          [ 2.7313e+00,  3.1300e+00,  1.3723e+00,        -inf],
          [ 2.5215e+00,  2.7980e+00, -2.6127e+00, -3.3776e+00]],

         [[-4.3025e+00,        -inf,        -inf,        -inf],
          [ 5.0826e-01,  5.5616e+00,        -inf,        -inf],
          [-7.6662e-01,  3.3563e+00,  6.2078e+00,        -inf],
          [ 4.6259e-01,  9.8649e-01,  1.3270e+00, -2.9910e+00]],

         [[ 3.0502e+00,        -inf,        -inf,        -inf],
          [ 1.7599e+00, -1.0877e+00,        -inf,        -inf],
          [ 3.2199e-01,  8.3762e-01,  4.8827e+00,        -inf],
          [ 5.2128e+00,  2.9505e+00,  6.9080e+00,  4.8208e+00]],

         [[-3.0477e+00,        -inf,        -inf,        -inf],
          [-1.1260e+00, -5.3138e+00,        -inf,        -inf],
          [-2.6223e+00, -2.4085e+00, -1.1056e+01,        -inf],
          [-3.3381e+00, -4.0335e+00, -1.2222e+00, -2.5720e+00]],

         [[-1.6376e+00,        -inf,        -inf,        -inf],
          [-3.4186e+00, -6.4060e-01,        -inf,        -inf],
          [-9.3803e-01,  2.6351e-01,  2.1639e+00,        -inf],
          [ 1.4777e+00,  1.5883e-02, -2.2591e+00, -1.8595e+00]],

         [[ 6.5988e+00,        -inf,        -inf,        -inf],
          [ 5.2856e+00,  3.4253e+00,        -inf,        -inf],
          [ 1.7681e+00,  1.2822e+00,  1.3586e+00,        -inf],
          [-2.5436e+00,  1.1683e+00, -1.4015e+00, -3.4049e-02]],

         [[ 2.7568e+00,        -inf,        -inf,        -inf],
          [ 2.8147e+00,  8.3116e-01,        -inf,        -inf],
          [ 6.2814e-01,  4.9683e+00,  3.0333e+00,        -inf],
          [ 6.6583e+00,  5.6404e+00,  7.9206e+00,  3.0159e+00]],

         [[ 2.6645e+00,        -inf,        -inf,        -inf],
          [ 7.0287e-01, -1.8421e+00,        -inf,        -inf],
          [ 1.7416e+00, -2.1051e+00, -3.4970e+00,        -inf],
          [-4.1973e+00, -2.3437e+00, -7.3167e+00, -8.4881e-01]],

         [[ 1.1806e+00,        -inf,        -inf,        -inf],
          [-2.7677e+00,  9.5199e-01,        -inf,        -inf],
          [ 1.3736e+00, -2.0010e+00,  1.1574e+00,        -inf],
          [-3.2728e+00, -7.6985e+00, -1.4606e+00, -3.3280e+00]],

         [[ 1.7511e+00,        -inf,        -inf,        -inf],
          [ 1.2914e+00,  5.1404e+00,        -inf,        -inf],
          [-1.0296e+00,  1.5363e+00, -2.1463e+00,        -inf],
          [ 3.5210e+00, -1.8793e-01,  5.5592e-01,  2.2767e+00]]],


        [[[-2.5216e+00,        -inf,        -inf,        -inf],
          [-2.6473e+00, -3.1019e+00,        -inf,        -inf],
          [ 3.9570e+00, -1.5438e+00, -7.5045e-01,        -inf],
          [-5.7579e+00,  5.9064e-01,  4.2012e+00,  5.2957e-01]],

         [[-4.2571e-01,        -inf,        -inf,        -inf],
          [ 1.9128e+00, -2.2589e+00,        -inf,        -inf],
          [ 1.4169e+00, -1.2902e+00, -5.5806e-02,        -inf],
          [ 3.7320e+00,  2.6984e+00, -3.1541e+00,  1.9621e-01]],

         [[ 2.4589e+00,        -inf,        -inf,        -inf],
          [ 1.0977e+00,  1.7622e-03,        -inf,        -inf],
          [-1.7936e+00,  1.0055e+00, -1.0149e+00,        -inf],
          [-7.2064e-01,  6.7473e-01,  4.3948e+00,  2.0982e+00]],

         [[-4.6684e+00,        -inf,        -inf,        -inf],
          [-7.8223e+00, -2.8985e+00,        -inf,        -inf],
          [-5.1241e+00, -1.4277e-01, -4.5352e+00,        -inf],
          [ 4.9809e+00,  6.0983e+00, -7.9414e-01, -8.5509e-01]],

         [[ 1.5567e+00,        -inf,        -inf,        -inf],
          [ 1.0710e+00,  2.6756e-01,        -inf,        -inf],
          [ 1.8087e-01,  5.0066e-01,  7.2688e-01,        -inf],
          [ 2.6011e+00,  4.6563e+00,  5.1125e+00,  4.0427e+00]],

         [[-2.5423e+00,        -inf,        -inf,        -inf],
          [ 3.0799e+00, -2.3540e+00,        -inf,        -inf],
          [ 3.1988e+00,  4.2443e+00,  5.5899e+00,        -inf],
          [-7.0555e-01, -2.2250e-01, -3.0200e-01,  3.7866e+00]],

         [[ 1.0902e+00,        -inf,        -inf,        -inf],
          [-9.1521e-01, -1.8101e+00,        -inf,        -inf],
          [-5.1531e+00, -1.7148e+00, -6.2198e+00,        -inf],
          [-2.8015e+00,  1.0488e+00, -1.3495e+00, -5.5004e-01]],

         [[-5.1196e+00,        -inf,        -inf,        -inf],
          [-5.5159e+00, -6.3728e+00,        -inf,        -inf],
          [-5.8530e+00, -6.3074e+00, -4.1938e+00,        -inf],
          [-7.7304e-01, -1.7824e-01, -8.2450e-02,  2.4522e+00]],

         [[ 8.4741e-01,        -inf,        -inf,        -inf],
          [ 1.9258e+00, -1.7888e+00,        -inf,        -inf],
          [ 2.3941e+00,  1.1358e-02,  1.0769e+00,        -inf],
          [ 4.0481e+00, -3.1351e+00,  5.2466e-01, -3.4801e+00]],

         [[ 1.7375e+00,        -inf,        -inf,        -inf],
          [ 2.8531e+00,  6.6563e-01,        -inf,        -inf],
          [-7.2274e-01, -1.9445e+00,  9.1962e-01,        -inf],
          [ 1.9497e-01,  2.7166e+00, -5.7963e+00,  1.8587e+00]],

         [[ 4.4143e-01,        -inf,        -inf,        -inf],
          [-2.4097e+00, -8.5614e-02,        -inf,        -inf],
          [-8.5172e-01,  2.2264e+00, -1.8267e+00,        -inf],
          [ 3.1665e+00,  4.5554e+00,  6.9514e+00,  3.2802e+00]],

         [[ 2.0643e+00,        -inf,        -inf,        -inf],
          [-9.0156e-01, -1.3349e+00,        -inf,        -inf],
          [ 2.1694e+00,  2.2665e-01,  4.9222e+00,        -inf],
          [ 2.3486e+00,  2.8912e+00,  2.8895e+00, -2.5760e+00]],

         [[-3.9227e+00,        -inf,        -inf,        -inf],
          [-8.4709e-01, -1.9297e+00,        -inf,        -inf],
          [ 1.2181e+00,  3.9061e-01, -4.9657e+00,        -inf],
          [ 1.0461e+00, -8.4299e-01,  7.4148e-01, -1.1299e+00]],

         [[-7.8760e-01,        -inf,        -inf,        -inf],
          [-1.2755e+00, -1.1687e+00,        -inf,        -inf],
          [-2.0294e+00, -3.7240e-01, -1.0456e+00,        -inf],
          [-1.3843e+00, -2.5990e+00, -5.3899e+00, -6.9872e-01]],

         [[ 3.1469e+00,        -inf,        -inf,        -inf],
          [ 3.6287e+00,  6.0522e+00,        -inf,        -inf],
          [ 3.3538e+00,  6.9194e+00,  2.3490e+00,        -inf],
          [ 2.7618e+00,  9.2336e-01,  1.4706e+00,  2.3684e+00]],

         [[-1.3552e+00,        -inf,        -inf,        -inf],
          [ 7.4918e-01,  4.3548e+00,        -inf,        -inf],
          [-5.8603e-01,  3.4350e+00,  6.0660e+00,        -inf],
          [-3.2786e+00,  3.4341e+00,  6.5121e-01, -2.7417e+00]],

         [[-2.9774e+00,        -inf,        -inf,        -inf],
          [-2.5029e+00,  3.1690e-01,        -inf,        -inf],
          [ 2.5303e-01,  2.0185e+00,  1.2724e+00,        -inf],
          [ 5.0988e-01, -9.2868e-01, -5.0904e-01, -4.4273e+00]],

         [[ 1.8222e+00,        -inf,        -inf,        -inf],
          [ 9.9884e-01,  1.5221e+00,        -inf,        -inf],
          [-2.1472e+00, -6.3305e-01,  1.4639e+00,        -inf],
          [ 1.0464e+00, -8.0121e-01,  2.6365e+00, -3.2750e+00]],

         [[-3.7447e+00,        -inf,        -inf,        -inf],
          [-2.7617e+00, -3.2310e+00,        -inf,        -inf],
          [-3.8338e+00,  3.2315e+00, -1.7509e+00,        -inf],
          [-1.7398e+00,  3.5209e+00,  2.7681e+00, -2.6505e+00]],

         [[-2.5090e+00,        -inf,        -inf,        -inf],
          [-1.3801e+00,  5.8025e+00,        -inf,        -inf],
          [-1.6286e+00,  1.8033e+00,  5.1591e+00,        -inf],
          [-3.9033e+00, -1.5899e+00, -2.0555e+00, -2.2518e+00]],

         [[ 3.7072e+00,        -inf,        -inf,        -inf],
          [-9.7320e-02, -1.3156e+00,        -inf,        -inf],
          [-2.4125e-01, -2.8433e+00,  3.5823e-01,        -inf],
          [ 3.3628e-01, -2.2870e+00,  2.8662e+00,  3.6933e+00]],

         [[ 4.2882e+00,        -inf,        -inf,        -inf],
          [ 2.1976e+00,  4.0067e+00,        -inf,        -inf],
          [ 4.2402e+00,  2.7557e+00,  7.2341e-01,        -inf],
          [ 1.5316e+00,  2.2254e-01,  9.8542e-01,  6.4193e+00]],

         [[ 1.1077e+00,        -inf,        -inf,        -inf],
          [-4.6933e-01,  1.7696e+00,        -inf,        -inf],
          [-7.0924e-01, -1.2668e+00, -3.5749e-01,        -inf],
          [-1.4214e+00, -2.3987e+00, -1.9920e+00, -3.4538e+00]],

         [[-5.9685e-01,        -inf,        -inf,        -inf],
          [-5.7696e-02, -1.5146e+00,        -inf,        -inf],
          [ 2.0732e+00, -1.8387e+00,  3.1841e+00,        -inf],
          [ 1.4174e+00, -1.0355e+00,  3.4521e+00,  4.4059e+00]],

         [[-1.6945e-01,        -inf,        -inf,        -inf],
          [ 9.0473e-01, -2.1211e+00,        -inf,        -inf],
          [ 4.6914e-01,  9.5452e-01, -8.5939e-01,        -inf],
          [ 4.5325e+00,  2.3467e+00,  9.7255e-02, -1.4937e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.0297,  0.5932, -0.5247,  ..., -0.5699,  0.4921,  0.2014],
          [-0.2243, -0.9531, -0.1782,  ..., -0.3336,  1.1468, -0.8213],
          [ 0.6662, -0.7793, -0.7219,  ..., -0.8638, -1.0162, -0.1601],
          ...,
          [ 0.0640,  0.9340, -0.1251,  ..., -0.3960,  0.8051,  0.3447],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.2348,  0.5068, -0.9670,  ...,  0.2526, -0.1267,  1.0114]],

         [[ 0.1753,  0.9612, -0.5271,  ..., -0.7497,  0.8454, -0.3251],
          [-0.2281, -0.7743,  0.0430,  ..., -0.0261,  0.6021, -0.4273],
          [ 0.1449, -0.8465, -0.4299,  ..., -0.3296, -0.4381, -0.1554],
          ...,
          [ 0.0719,  0.5040, -0.2897,  ...,  0.1625,  0.9468,  0.1734],
          [ 0.1349,  0.2701,  0.6921,  ..., -1.0054,  0.1594,  0.3561],
          [ 0.4312,  0.3289, -0.6291,  ...,  0.5183, -0.2974,  1.0215]],

         [[ 0.3945,  0.5434, -0.3446,  ..., -0.1983,  0.4058, -0.1283],
          [-0.3205, -0.5771, -0.2459,  ..., -0.0506,  0.5399, -0.2496],
          [ 0.2132, -0.8444, -0.3487,  ..., -0.1204,  0.0280, -0.1866],
          ...,
          [ 0.0360,  0.3920, -0.2016,  ...,  0.1982,  0.8516,  0.1275],
          [ 0.1649, -0.1222,  0.2225,  ..., -0.4255,  0.0488,  0.2892],
          [ 0.3350,  0.2496, -0.6921,  ...,  0.5230, -0.2831,  0.9451]],

         [[ 0.4134,  0.4523, -0.2251,  ..., -0.0994,  0.3385, -0.2361],
          [-0.4996, -0.2768, -0.2072,  ..., -0.0152,  0.3815,  0.2090],
          [ 0.3366, -0.8849, -0.6151,  ..., -0.0222,  0.3315, -0.1449],
          ...,
          [ 0.1461,  0.5668,  0.0815,  ..., -0.0055,  0.3145,  0.0569],
          [ 0.0864,  0.0629,  0.0128,  ..., -0.6013,  0.2094,  0.3774],
          [ 0.3881,  0.1210, -0.3831,  ...,  0.4131, -0.2852,  0.5221]]],


        [[[-0.6520,  0.7889, -0.5624,  ..., -0.2166,  0.0649, -0.7422],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.2490, -0.6825, -0.6182,  ..., -0.2088, -0.1093, -0.3393],
          ...,
          [ 0.1305,  0.5836,  0.0987,  ..., -0.2492,  0.5922,  0.3303],
          [ 0.1269,  0.1239, -0.1166,  ..., -1.6257, -0.0574, -0.1629],
          [ 0.2022,  0.8398, -0.7721,  ...,  0.6025,  0.3606,  1.3007]],

         [[-0.6051,  0.8449, -0.3474,  ..., -0.2115,  0.4577, -0.4985],
          [ 0.0169, -0.8477, -0.2733,  ...,  0.0269,  1.1597, -0.2678],
          [-0.1606, -0.6672, -0.3163,  ...,  0.0142,  0.2796, -0.4627],
          ...,
          [ 0.1101,  0.1621, -0.3159,  ...,  0.4692,  0.1842, -0.2151],
          [ 0.0692,  0.0676, -0.0636,  ..., -0.8867, -0.0313, -0.0888],
          [ 0.6838, -0.0979, -0.0962,  ...,  0.2685,  0.0095,  0.4661]],

         [[-0.3987,  0.6606, -0.3523,  ..., -0.1075,  0.3070, -0.5184],
          [-0.1568, -1.0479, -0.4736,  ..., -0.4070,  0.6441, -0.1000],
          [ 0.0642, -0.7556, -0.3689,  ..., -0.0355,  0.2516, -0.3125],
          ...,
          [ 0.0735,  0.1470, -0.1640,  ...,  0.2334,  0.1600, -0.0856],
          [ 0.1813, -0.3725, -0.0884,  ..., -1.2618, -0.2125, -0.1844],
          [ 0.2504,  0.4681, -0.5129,  ...,  0.2540,  0.0990,  0.2899]],

         [[-0.0311,  0.0560,  0.0276,  ..., -0.1544,  0.3826, -0.2126],
          [ 0.0190, -0.5516, -0.2963,  ...,  0.5153,  0.1643, -0.0487],
          [ 0.2514, -0.6679, -0.7383,  ..., -0.3191,  0.2506, -0.2529],
          ...,
          [-0.1890,  0.3033,  0.0344,  ...,  0.4751,  0.1052, -0.2269],
          [ 0.0293, -0.3605, -0.1808,  ..., -0.6599, -0.4143, -0.3792],
          [ 0.6385,  0.4434, -0.6813,  ...,  0.4230,  0.0474,  0.7707]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.0297,  0.5932, -0.5247,  ...,  0.2526, -0.1267,  1.0114],
         [ 0.1753,  0.9612, -0.5271,  ...,  0.5183, -0.2974,  1.0215],
         [ 0.3945,  0.5434, -0.3446,  ...,  0.5230, -0.2831,  0.9451],
         [ 0.4134,  0.4523, -0.2251,  ...,  0.4131, -0.2852,  0.5221]],

        [[-0.6520,  0.7889, -0.5624,  ...,  0.6025,  0.3606,  1.3007],
         [-0.6051,  0.8449, -0.3474,  ...,  0.2685,  0.0095,  0.4661],
         [-0.3987,  0.6606, -0.3523,  ...,  0.2540,  0.0990,  0.2899],
         [-0.0311,  0.0560,  0.0276,  ...,  0.4230,  0.0474,  0.7707]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 4.9180e-03,  1.2333e-01,  4.2950e-01,  ..., -1.5400e-01,
           7.2364e-02,  3.6727e-01],
         [ 2.7235e-01,  2.8335e-01,  9.8823e-02,  ..., -1.3847e-01,
           2.7207e-02,  7.8922e-02],
         [-1.3027e-01,  3.3146e-01,  1.1178e-01,  ...,  3.5444e-04,
           1.6967e-01,  1.4950e-01],
         [-2.6786e-01,  2.7926e-01,  1.3681e-01,  ...,  3.8869e-02,
           3.0873e-01,  2.1716e-01]],

        [[ 3.5704e-01,  2.6479e-01,  1.0838e-01,  ...,  2.8155e-01,
           3.5236e-01,  2.9228e-01],
         [-1.0401e-01,  1.4819e-01,  7.1026e-02,  ...,  4.5986e-02,
           1.6458e-01,  4.7562e-01],
         [-2.1259e-01,  3.0238e-01,  1.0412e-01,  ...,  4.8187e-02,
           4.2012e-01,  2.3058e-01],
         [ 1.9365e-03,  2.6568e-01, -2.0941e-03,  ...,  2.9332e-01,
           2.6557e-01,  1.8858e-01]]], grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.3377e+00,        -inf,        -inf,        -inf],
          [ 3.0700e+00,  8.0087e-01,        -inf,        -inf],
          [ 3.2643e+00,  4.0405e-01, -1.6779e+00,        -inf],
          [ 1.4738e+00, -1.8103e-02, -1.3545e+00,  1.4594e+00]],

         [[ 7.4679e+00,        -inf,        -inf,        -inf],
          [ 2.9620e+00, -1.8141e-01,        -inf,        -inf],
          [ 2.4264e+00,  3.8160e+00, -3.1170e+00,        -inf],
          [ 6.8263e+00,  6.1306e+00,  5.7671e+00,  1.2640e+00]],

         [[ 6.5829e+00,        -inf,        -inf,        -inf],
          [ 5.3532e+00, -1.3650e+00,        -inf,        -inf],
          [ 3.1408e-01, -1.4467e+00, -3.2532e+00,        -inf],
          [ 2.2571e+00,  2.5149e+00,  3.9139e-01, -2.3170e+00]],

         [[ 2.6651e+00,        -inf,        -inf,        -inf],
          [ 2.9851e+00,  1.1815e+00,        -inf,        -inf],
          [ 2.6055e+00,  2.0046e+00,  1.0484e+00,        -inf],
          [ 3.7929e-01,  2.7369e+00,  9.7419e-01,  3.4423e+00]],

         [[-4.4756e-01,        -inf,        -inf,        -inf],
          [-2.7340e-02,  3.4449e+00,        -inf,        -inf],
          [-7.7321e-01,  7.2508e-01, -1.3156e+00,        -inf],
          [-1.1110e+00, -3.0184e-01, -1.5326e+00, -3.9607e+00]],

         [[ 2.3552e+00,        -inf,        -inf,        -inf],
          [ 5.6326e+00, -1.1337e+00,        -inf,        -inf],
          [ 2.3625e+00,  1.4638e+00,  8.1740e-03,        -inf],
          [ 3.0070e+00, -8.7428e-01, -1.0746e+00, -4.5718e+00]],

         [[-1.3524e-01,        -inf,        -inf,        -inf],
          [ 1.9542e-01,  1.5639e+00,        -inf,        -inf],
          [ 2.8739e+00, -2.9583e-01, -9.4854e-01,        -inf],
          [ 9.1704e-01, -2.4693e+00,  7.6546e-01,  5.5332e-01]],

         [[-8.5569e-01,        -inf,        -inf,        -inf],
          [-3.2477e+00,  3.7740e+00,        -inf,        -inf],
          [-2.2452e+00, -1.4758e+00,  2.7237e+00,        -inf],
          [-3.6016e+00,  7.0950e-01, -3.0562e+00, -7.5550e+00]],

         [[-3.9040e+00,        -inf,        -inf,        -inf],
          [-1.9519e+00,  6.3935e-01,        -inf,        -inf],
          [-2.2981e+00,  2.2941e+00, -1.6298e+00,        -inf],
          [-6.6163e+00, -4.0449e+00, -1.9466e+00, -2.7719e+00]],

         [[-2.7494e+00,        -inf,        -inf,        -inf],
          [-1.2136e+00, -1.8778e-01,        -inf,        -inf],
          [-2.9210e+00, -2.3329e+00, -2.5751e+00,        -inf],
          [ 1.2484e+00,  3.7316e-01, -2.1556e+00,  7.8164e-01]],

         [[ 3.7281e+00,        -inf,        -inf,        -inf],
          [ 2.5720e+00, -4.1822e+00,        -inf,        -inf],
          [ 4.0240e+00,  2.1112e+00, -1.3114e+00,        -inf],
          [-3.5236e-01,  9.6187e-02,  8.4460e-02,  2.3818e+00]],

         [[-4.8218e+00,        -inf,        -inf,        -inf],
          [-2.3419e-01, -4.0017e-01,        -inf,        -inf],
          [-1.8302e+00, -2.9243e+00,  4.8569e+00,        -inf],
          [-4.3304e+00, -1.6618e+00, -2.8006e+00, -5.7108e-01]],

         [[ 6.9798e-02,        -inf,        -inf,        -inf],
          [-2.2856e-02, -1.7570e-02,        -inf,        -inf],
          [ 5.3801e-02, -2.7495e+00,  3.9127e-01,        -inf],
          [ 1.6478e+00,  2.7439e+00,  9.1983e-01, -7.7121e-01]],

         [[ 9.3285e-01,        -inf,        -inf,        -inf],
          [ 7.0386e-01, -4.2141e+00,        -inf,        -inf],
          [-1.5590e+00, -1.4089e+00, -2.8696e+00,        -inf],
          [ 8.1169e-01, -2.3875e+00,  2.3824e+00, -3.4173e-01]],

         [[ 8.9957e+00,        -inf,        -inf,        -inf],
          [ 7.0149e+00,  3.2116e+00,        -inf,        -inf],
          [ 5.2767e+00,  4.2468e+00,  5.1492e+00,        -inf],
          [ 5.5437e+00,  2.6424e+00, -2.4618e-02,  7.0371e+00]],

         [[ 3.9233e-01,        -inf,        -inf,        -inf],
          [-6.6093e-01,  3.1577e+00,        -inf,        -inf],
          [ 1.2794e+00,  1.2862e+00, -2.0421e+00,        -inf],
          [ 4.7381e-01,  1.4564e+00,  3.6967e+00,  4.4246e+00]],

         [[ 2.6764e+00,        -inf,        -inf,        -inf],
          [ 7.9122e-01,  2.3697e+00,        -inf,        -inf],
          [ 1.2023e+00,  2.4776e+00, -9.5021e-01,        -inf],
          [ 2.3220e+00,  1.8722e+00,  1.6851e+00,  4.2807e+00]],

         [[ 1.6417e+00,        -inf,        -inf,        -inf],
          [ 2.8655e+00,  3.5861e+00,        -inf,        -inf],
          [-2.9728e-01,  1.8309e+00,  3.0415e+00,        -inf],
          [ 1.9407e-01,  1.3647e+00,  1.2309e+00, -4.6454e-02]],

         [[-9.1325e-01,        -inf,        -inf,        -inf],
          [-4.2468e+00,  2.5753e-01,        -inf,        -inf],
          [-1.8428e+00,  1.4205e+00,  7.8430e-01,        -inf],
          [-4.3707e+00,  2.3625e+00, -2.8046e+00,  8.6723e-01]],

         [[ 3.5004e+00,        -inf,        -inf,        -inf],
          [ 2.2385e+00, -1.5344e+00,        -inf,        -inf],
          [ 2.3318e+00, -2.5363e+00, -1.5649e+00,        -inf],
          [ 4.8909e+00,  3.3989e-01,  2.2348e+00,  1.1910e+00]],

         [[ 1.8310e+00,        -inf,        -inf,        -inf],
          [-3.1638e-01, -2.3862e+00,        -inf,        -inf],
          [-1.3167e+00,  1.2925e+00, -5.8818e-01,        -inf],
          [-2.0271e-01, -1.7269e+00, -3.0666e+00, -3.7570e+00]],

         [[-1.5598e-01,        -inf,        -inf,        -inf],
          [ 2.6948e-01,  2.9421e+00,        -inf,        -inf],
          [ 1.7588e+00,  2.4411e+00, -3.0493e+00,        -inf],
          [ 1.1044e+00,  2.5455e+00, -2.1798e+00, -3.5589e+00]],

         [[-1.1658e+00,        -inf,        -inf,        -inf],
          [ 1.4603e+00, -1.2322e+00,        -inf,        -inf],
          [-9.4892e-01, -1.4250e+00, -3.8798e+00,        -inf],
          [-8.6905e-01, -3.0334e+00, -4.5901e+00, -1.7829e+00]],

         [[-1.3318e+00,        -inf,        -inf,        -inf],
          [ 8.0300e-01, -2.1450e-01,        -inf,        -inf],
          [-3.4196e+00,  6.6815e-01,  5.0084e+00,        -inf],
          [-2.3599e+00, -5.5346e+00, -6.1560e-01, -2.7256e+00]],

         [[ 1.7587e+00,        -inf,        -inf,        -inf],
          [-2.3989e+00, -5.5897e-01,        -inf,        -inf],
          [ 1.7221e+00,  1.9401e-01,  3.6135e+00,        -inf],
          [ 2.2145e+00,  3.9237e+00,  7.8927e+00,  2.4514e+00]]],


        [[[ 2.1290e+00,        -inf,        -inf,        -inf],
          [ 2.5614e+00, -5.9121e-01,        -inf,        -inf],
          [ 1.8981e+00, -2.2787e+00,  4.0235e-01,        -inf],
          [ 1.1930e+00, -7.5271e-01, -7.2028e-01,  1.6098e-01]],

         [[ 1.5659e+00,        -inf,        -inf,        -inf],
          [-9.9539e-01,  2.7626e+00,        -inf,        -inf],
          [-2.1809e-01, -2.6245e+00, -4.1476e+00,        -inf],
          [ 7.8446e-01,  5.1675e+00, -2.6106e+00,  2.0321e+00]],

         [[ 2.5035e+00,        -inf,        -inf,        -inf],
          [ 1.2379e+00,  2.5750e-01,        -inf,        -inf],
          [-3.6107e+00, -2.8056e+00, -2.5629e+00,        -inf],
          [ 1.0889e+00,  1.3817e+00,  1.7252e+00, -4.3264e+00]],

         [[ 3.4494e+00,        -inf,        -inf,        -inf],
          [ 4.9983e+00,  6.2824e+00,        -inf,        -inf],
          [ 3.1403e+00, -9.3713e-01, -3.5543e+00,        -inf],
          [ 4.7828e+00,  4.5597e+00,  3.3064e+00,  2.1608e+00]],

         [[-2.9144e+00,        -inf,        -inf,        -inf],
          [-2.2465e+00,  2.3713e+00,        -inf,        -inf],
          [ 5.9547e-01,  1.0135e+00, -2.6493e+00,        -inf],
          [-9.6971e-01, -8.3057e-01,  1.8172e+00, -4.8060e+00]],

         [[ 1.1907e+00,        -inf,        -inf,        -inf],
          [ 8.7937e-02, -1.1975e+00,        -inf,        -inf],
          [ 4.0351e+00, -3.1983e-01,  1.6403e+00,        -inf],
          [ 7.6293e-01, -1.6355e+00, -2.5269e+00, -1.0871e+00]],

         [[-1.2438e+00,        -inf,        -inf,        -inf],
          [ 8.6325e-02, -5.6604e-01,        -inf,        -inf],
          [-2.4748e+00, -1.1819e+00, -3.7218e+00,        -inf],
          [-3.1495e+00, -2.6492e+00, -1.2718e+00, -1.0876e+00]],

         [[-2.2666e+00,        -inf,        -inf,        -inf],
          [-1.8414e+00, -1.2691e+00,        -inf,        -inf],
          [-1.1665e+00, -3.9509e-01, -3.8367e+00,        -inf],
          [ 2.3993e+00, -4.0294e+00, -1.4937e+00,  5.2278e-01]],

         [[-1.8326e+00,        -inf,        -inf,        -inf],
          [-1.6200e+00, -2.3629e+00,        -inf,        -inf],
          [-3.6980e+00, -9.0889e-01, -6.2081e+00,        -inf],
          [-3.9539e+00, -5.8079e-01, -2.1971e+00, -3.5966e+00]],

         [[-2.0950e+00,        -inf,        -inf,        -inf],
          [-5.8532e+00,  1.5431e+00,        -inf,        -inf],
          [-1.2501e+00,  2.6281e+00,  1.2815e-01,        -inf],
          [ 1.3057e+00,  2.3469e+00, -3.9858e-01, -1.8184e+00]],

         [[ 3.7293e+00,        -inf,        -inf,        -inf],
          [-3.4936e+00, -1.9301e+00,        -inf,        -inf],
          [ 3.7203e+00, -9.4850e-01, -3.5804e+00,        -inf],
          [-1.2773e+00, -6.9051e-01, -2.8725e+00, -2.2079e+00]],

         [[-8.5467e+00,        -inf,        -inf,        -inf],
          [ 8.2013e-01,  2.7914e+00,        -inf,        -inf],
          [ 2.8833e-01, -6.4517e-01,  1.0713e+00,        -inf],
          [-4.8962e+00,  1.9618e+00,  2.3018e-01,  4.7610e+00]],

         [[-1.2793e+00,        -inf,        -inf,        -inf],
          [-4.1489e-02,  1.9502e+00,        -inf,        -inf],
          [-1.5567e+00,  5.5934e-01,  9.3984e-01,        -inf],
          [-1.0205e+00,  2.0334e+00,  2.3605e-01, -4.1867e+00]],

         [[-1.4177e+00,        -inf,        -inf,        -inf],
          [-2.4549e+00, -1.9908e+00,        -inf,        -inf],
          [-4.0047e+00, -1.5858e+00,  5.8542e-01,        -inf],
          [-3.9406e+00,  4.1335e+00,  2.2900e+00, -1.5369e+00]],

         [[ 4.8896e+00,        -inf,        -inf,        -inf],
          [ 3.0223e+00,  1.5789e+00,        -inf,        -inf],
          [-1.0153e+00, -3.1339e+00,  3.1206e+00,        -inf],
          [ 6.4474e-01,  6.3849e-01, -1.9507e-01, -2.9042e-01]],

         [[-8.4486e-02,        -inf,        -inf,        -inf],
          [-9.6743e-01,  5.8672e+00,        -inf,        -inf],
          [-5.8605e-01,  3.6502e+00,  6.0256e-01,        -inf],
          [-1.5063e+00,  8.5338e-01,  3.6747e-01,  4.6989e+00]],

         [[ 3.3480e+00,        -inf,        -inf,        -inf],
          [ 4.6825e-01,  4.0963e+00,        -inf,        -inf],
          [-4.1420e+00, -1.8784e+00, -1.6058e+00,        -inf],
          [-1.0987e+00,  1.3853e+00, -1.3955e+00,  1.7636e+00]],

         [[-3.2404e+00,        -inf,        -inf,        -inf],
          [ 9.1987e-01,  3.5277e+00,        -inf,        -inf],
          [-7.0111e+00,  1.4342e+00,  5.0351e+00,        -inf],
          [ 1.8122e-01,  7.4318e-01,  5.5567e+00,  3.2709e+00]],

         [[-1.5368e+00,        -inf,        -inf,        -inf],
          [-3.7092e+00,  9.4334e-01,        -inf,        -inf],
          [-2.7798e+00, -1.6089e+00,  1.7710e+00,        -inf],
          [-2.4053e+00,  8.6307e-01,  1.2950e+00, -3.0109e+00]],

         [[ 3.0952e+00,        -inf,        -inf,        -inf],
          [ 6.6963e-01, -3.8175e+00,        -inf,        -inf],
          [ 2.3851e+00, -5.0988e+00, -8.6002e-01,        -inf],
          [ 6.8695e-01, -4.3932e+00, -4.5239e-01, -1.5795e-02]],

         [[-5.2198e-01,        -inf,        -inf,        -inf],
          [-4.8389e+00, -5.8710e+00,        -inf,        -inf],
          [-2.1029e+00,  1.1026e+00, -9.7009e-01,        -inf],
          [-1.8530e+00, -2.9196e+00, -1.8663e+00, -1.2409e+00]],

         [[ 8.0081e-01,        -inf,        -inf,        -inf],
          [ 1.3919e+00, -1.7946e+00,        -inf,        -inf],
          [ 2.2352e+00, -3.3143e+00, -2.5253e+00,        -inf],
          [-2.7500e-01, -5.3923e-01,  8.1311e-01,  2.8254e-01]],

         [[ 7.3430e-01,        -inf,        -inf,        -inf],
          [-2.2975e+00, -4.5825e+00,        -inf,        -inf],
          [-4.0237e+00, -2.5008e+00, -3.9459e+00,        -inf],
          [-4.2612e+00, -1.1942e+00, -2.0243e+00, -4.1618e+00]],

         [[-1.5255e+00,        -inf,        -inf,        -inf],
          [-3.9051e-01, -9.4282e-01,        -inf,        -inf],
          [-4.5080e-01,  3.0139e+00,  4.8812e+00,        -inf],
          [-1.9152e+00, -2.2730e+00, -2.3980e-01, -2.2903e+00]],

         [[-6.0210e-01,        -inf,        -inf,        -inf],
          [-3.1727e+00, -6.7441e-01,        -inf,        -inf],
          [ 1.4943e+00, -4.5297e+00, -1.3960e+00,        -inf],
          [-1.4227e+00, -2.2002e+00,  4.3258e-01, -4.7720e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.3377e+00,        -inf,        -inf,        -inf],
          [ 3.0700e+00,  8.0087e-01,        -inf,        -inf],
          [ 3.2643e+00,  4.0405e-01, -1.6779e+00,        -inf],
          [ 1.4738e+00, -1.8103e-02, -1.3545e+00,  1.4594e+00]],

         [[ 7.4679e+00,        -inf,        -inf,        -inf],
          [ 2.9620e+00, -1.8141e-01,        -inf,        -inf],
          [ 2.4264e+00,  3.8160e+00, -3.1170e+00,        -inf],
          [ 6.8263e+00,  6.1306e+00,  5.7671e+00,  1.2640e+00]],

         [[ 6.5829e+00,        -inf,        -inf,        -inf],
          [ 5.3532e+00, -1.3650e+00,        -inf,        -inf],
          [ 3.1408e-01, -1.4467e+00, -3.2532e+00,        -inf],
          [ 2.2571e+00,  2.5149e+00,  3.9139e-01, -2.3170e+00]],

         [[ 2.6651e+00,        -inf,        -inf,        -inf],
          [ 2.9851e+00,  1.1815e+00,        -inf,        -inf],
          [ 2.6055e+00,  2.0046e+00,  1.0484e+00,        -inf],
          [ 3.7929e-01,  2.7369e+00,  9.7419e-01,  3.4423e+00]],

         [[-4.4756e-01,        -inf,        -inf,        -inf],
          [-2.7340e-02,  3.4449e+00,        -inf,        -inf],
          [-7.7321e-01,  7.2508e-01, -1.3156e+00,        -inf],
          [-1.1110e+00, -3.0184e-01, -1.5326e+00, -3.9607e+00]],

         [[ 2.3552e+00,        -inf,        -inf,        -inf],
          [ 5.6326e+00, -1.1337e+00,        -inf,        -inf],
          [ 2.3625e+00,  1.4638e+00,  8.1740e-03,        -inf],
          [ 3.0070e+00, -8.7428e-01, -1.0746e+00, -4.5718e+00]],

         [[-1.3524e-01,        -inf,        -inf,        -inf],
          [ 1.9542e-01,  1.5639e+00,        -inf,        -inf],
          [ 2.8739e+00, -2.9583e-01, -9.4854e-01,        -inf],
          [ 9.1704e-01, -2.4693e+00,  7.6546e-01,  5.5332e-01]],

         [[-8.5569e-01,        -inf,        -inf,        -inf],
          [-3.2477e+00,  3.7740e+00,        -inf,        -inf],
          [-2.2452e+00, -1.4758e+00,  2.7237e+00,        -inf],
          [-3.6016e+00,  7.0950e-01, -3.0562e+00, -7.5550e+00]],

         [[-3.9040e+00,        -inf,        -inf,        -inf],
          [-1.9519e+00,  6.3935e-01,        -inf,        -inf],
          [-2.2981e+00,  2.2941e+00, -1.6298e+00,        -inf],
          [-6.6163e+00, -4.0449e+00, -1.9466e+00, -2.7719e+00]],

         [[-2.7494e+00,        -inf,        -inf,        -inf],
          [-1.2136e+00, -1.8778e-01,        -inf,        -inf],
          [-2.9210e+00, -2.3329e+00, -2.5751e+00,        -inf],
          [ 1.2484e+00,  3.7316e-01, -2.1556e+00,  7.8164e-01]],

         [[ 3.7281e+00,        -inf,        -inf,        -inf],
          [ 2.5720e+00, -4.1822e+00,        -inf,        -inf],
          [ 4.0240e+00,  2.1112e+00, -1.3114e+00,        -inf],
          [-3.5236e-01,  9.6187e-02,  8.4460e-02,  2.3818e+00]],

         [[-4.8218e+00,        -inf,        -inf,        -inf],
          [-2.3419e-01, -4.0017e-01,        -inf,        -inf],
          [-1.8302e+00, -2.9243e+00,  4.8569e+00,        -inf],
          [-4.3304e+00, -1.6618e+00, -2.8006e+00, -5.7108e-01]],

         [[ 6.9798e-02,        -inf,        -inf,        -inf],
          [-2.2856e-02, -1.7570e-02,        -inf,        -inf],
          [ 5.3801e-02, -2.7495e+00,  3.9127e-01,        -inf],
          [ 1.6478e+00,  2.7439e+00,  9.1983e-01, -7.7121e-01]],

         [[ 9.3285e-01,        -inf,        -inf,        -inf],
          [ 7.0386e-01, -4.2141e+00,        -inf,        -inf],
          [-1.5590e+00, -1.4089e+00, -2.8696e+00,        -inf],
          [ 8.1169e-01, -2.3875e+00,  2.3824e+00, -3.4173e-01]],

         [[ 8.9957e+00,        -inf,        -inf,        -inf],
          [ 7.0149e+00,  3.2116e+00,        -inf,        -inf],
          [ 5.2767e+00,  4.2468e+00,  5.1492e+00,        -inf],
          [ 5.5437e+00,  2.6424e+00, -2.4618e-02,  7.0371e+00]],

         [[ 3.9233e-01,        -inf,        -inf,        -inf],
          [-6.6093e-01,  3.1577e+00,        -inf,        -inf],
          [ 1.2794e+00,  1.2862e+00, -2.0421e+00,        -inf],
          [ 4.7381e-01,  1.4564e+00,  3.6967e+00,  4.4246e+00]],

         [[ 2.6764e+00,        -inf,        -inf,        -inf],
          [ 7.9122e-01,  2.3697e+00,        -inf,        -inf],
          [ 1.2023e+00,  2.4776e+00, -9.5021e-01,        -inf],
          [ 2.3220e+00,  1.8722e+00,  1.6851e+00,  4.2807e+00]],

         [[ 1.6417e+00,        -inf,        -inf,        -inf],
          [ 2.8655e+00,  3.5861e+00,        -inf,        -inf],
          [-2.9728e-01,  1.8309e+00,  3.0415e+00,        -inf],
          [ 1.9407e-01,  1.3647e+00,  1.2309e+00, -4.6454e-02]],

         [[-9.1325e-01,        -inf,        -inf,        -inf],
          [-4.2468e+00,  2.5753e-01,        -inf,        -inf],
          [-1.8428e+00,  1.4205e+00,  7.8430e-01,        -inf],
          [-4.3707e+00,  2.3625e+00, -2.8046e+00,  8.6723e-01]],

         [[ 3.5004e+00,        -inf,        -inf,        -inf],
          [ 2.2385e+00, -1.5344e+00,        -inf,        -inf],
          [ 2.3318e+00, -2.5363e+00, -1.5649e+00,        -inf],
          [ 4.8909e+00,  3.3989e-01,  2.2348e+00,  1.1910e+00]],

         [[ 1.8310e+00,        -inf,        -inf,        -inf],
          [-3.1638e-01, -2.3862e+00,        -inf,        -inf],
          [-1.3167e+00,  1.2925e+00, -5.8818e-01,        -inf],
          [-2.0271e-01, -1.7269e+00, -3.0666e+00, -3.7570e+00]],

         [[-1.5598e-01,        -inf,        -inf,        -inf],
          [ 2.6948e-01,  2.9421e+00,        -inf,        -inf],
          [ 1.7588e+00,  2.4411e+00, -3.0493e+00,        -inf],
          [ 1.1044e+00,  2.5455e+00, -2.1798e+00, -3.5589e+00]],

         [[-1.1658e+00,        -inf,        -inf,        -inf],
          [ 1.4603e+00, -1.2322e+00,        -inf,        -inf],
          [-9.4892e-01, -1.4250e+00, -3.8798e+00,        -inf],
          [-8.6905e-01, -3.0334e+00, -4.5901e+00, -1.7829e+00]],

         [[-1.3318e+00,        -inf,        -inf,        -inf],
          [ 8.0300e-01, -2.1450e-01,        -inf,        -inf],
          [-3.4196e+00,  6.6815e-01,  5.0084e+00,        -inf],
          [-2.3599e+00, -5.5346e+00, -6.1560e-01, -2.7256e+00]],

         [[ 1.7587e+00,        -inf,        -inf,        -inf],
          [-2.3989e+00, -5.5897e-01,        -inf,        -inf],
          [ 1.7221e+00,  1.9401e-01,  3.6135e+00,        -inf],
          [ 2.2145e+00,  3.9237e+00,  7.8927e+00,  2.4514e+00]]],


        [[[ 2.1290e+00,        -inf,        -inf,        -inf],
          [ 2.5614e+00, -5.9121e-01,        -inf,        -inf],
          [ 1.8981e+00, -2.2787e+00,  4.0235e-01,        -inf],
          [ 1.1930e+00, -7.5271e-01, -7.2028e-01,  1.6098e-01]],

         [[ 1.5659e+00,        -inf,        -inf,        -inf],
          [-9.9539e-01,  2.7626e+00,        -inf,        -inf],
          [-2.1809e-01, -2.6245e+00, -4.1476e+00,        -inf],
          [ 7.8446e-01,  5.1675e+00, -2.6106e+00,  2.0321e+00]],

         [[ 2.5035e+00,        -inf,        -inf,        -inf],
          [ 1.2379e+00,  2.5750e-01,        -inf,        -inf],
          [-3.6107e+00, -2.8056e+00, -2.5629e+00,        -inf],
          [ 1.0889e+00,  1.3817e+00,  1.7252e+00, -4.3264e+00]],

         [[ 3.4494e+00,        -inf,        -inf,        -inf],
          [ 4.9983e+00,  6.2824e+00,        -inf,        -inf],
          [ 3.1403e+00, -9.3713e-01, -3.5543e+00,        -inf],
          [ 4.7828e+00,  4.5597e+00,  3.3064e+00,  2.1608e+00]],

         [[-2.9144e+00,        -inf,        -inf,        -inf],
          [-2.2465e+00,  2.3713e+00,        -inf,        -inf],
          [ 5.9547e-01,  1.0135e+00, -2.6493e+00,        -inf],
          [-9.6971e-01, -8.3057e-01,  1.8172e+00, -4.8060e+00]],

         [[ 1.1907e+00,        -inf,        -inf,        -inf],
          [ 8.7937e-02, -1.1975e+00,        -inf,        -inf],
          [ 4.0351e+00, -3.1983e-01,  1.6403e+00,        -inf],
          [ 7.6293e-01, -1.6355e+00, -2.5269e+00, -1.0871e+00]],

         [[-1.2438e+00,        -inf,        -inf,        -inf],
          [ 8.6325e-02, -5.6604e-01,        -inf,        -inf],
          [-2.4748e+00, -1.1819e+00, -3.7218e+00,        -inf],
          [-3.1495e+00, -2.6492e+00, -1.2718e+00, -1.0876e+00]],

         [[-2.2666e+00,        -inf,        -inf,        -inf],
          [-1.8414e+00, -1.2691e+00,        -inf,        -inf],
          [-1.1665e+00, -3.9509e-01, -3.8367e+00,        -inf],
          [ 2.3993e+00, -4.0294e+00, -1.4937e+00,  5.2278e-01]],

         [[-1.8326e+00,        -inf,        -inf,        -inf],
          [-1.6200e+00, -2.3629e+00,        -inf,        -inf],
          [-3.6980e+00, -9.0889e-01, -6.2081e+00,        -inf],
          [-3.9539e+00, -5.8079e-01, -2.1971e+00, -3.5966e+00]],

         [[-2.0950e+00,        -inf,        -inf,        -inf],
          [-5.8532e+00,  1.5431e+00,        -inf,        -inf],
          [-1.2501e+00,  2.6281e+00,  1.2815e-01,        -inf],
          [ 1.3057e+00,  2.3469e+00, -3.9858e-01, -1.8184e+00]],

         [[ 3.7293e+00,        -inf,        -inf,        -inf],
          [-3.4936e+00, -1.9301e+00,        -inf,        -inf],
          [ 3.7203e+00, -9.4850e-01, -3.5804e+00,        -inf],
          [-1.2773e+00, -6.9051e-01, -2.8725e+00, -2.2079e+00]],

         [[-8.5467e+00,        -inf,        -inf,        -inf],
          [ 8.2013e-01,  2.7914e+00,        -inf,        -inf],
          [ 2.8833e-01, -6.4517e-01,  1.0713e+00,        -inf],
          [-4.8962e+00,  1.9618e+00,  2.3018e-01,  4.7610e+00]],

         [[-1.2793e+00,        -inf,        -inf,        -inf],
          [-4.1489e-02,  1.9502e+00,        -inf,        -inf],
          [-1.5567e+00,  5.5934e-01,  9.3984e-01,        -inf],
          [-1.0205e+00,  2.0334e+00,  2.3605e-01, -4.1867e+00]],

         [[-1.4177e+00,        -inf,        -inf,        -inf],
          [-2.4549e+00, -1.9908e+00,        -inf,        -inf],
          [-4.0047e+00, -1.5858e+00,  5.8542e-01,        -inf],
          [-3.9406e+00,  4.1335e+00,  2.2900e+00, -1.5369e+00]],

         [[ 4.8896e+00,        -inf,        -inf,        -inf],
          [ 3.0223e+00,  1.5789e+00,        -inf,        -inf],
          [-1.0153e+00, -3.1339e+00,  3.1206e+00,        -inf],
          [ 6.4474e-01,  6.3849e-01, -1.9507e-01, -2.9042e-01]],

         [[-8.4486e-02,        -inf,        -inf,        -inf],
          [-9.6743e-01,  5.8672e+00,        -inf,        -inf],
          [-5.8605e-01,  3.6502e+00,  6.0256e-01,        -inf],
          [-1.5063e+00,  8.5338e-01,  3.6747e-01,  4.6989e+00]],

         [[ 3.3480e+00,        -inf,        -inf,        -inf],
          [ 4.6825e-01,  4.0963e+00,        -inf,        -inf],
          [-4.1420e+00, -1.8784e+00, -1.6058e+00,        -inf],
          [-1.0987e+00,  1.3853e+00, -1.3955e+00,  1.7636e+00]],

         [[-3.2404e+00,        -inf,        -inf,        -inf],
          [ 9.1987e-01,  3.5277e+00,        -inf,        -inf],
          [-7.0111e+00,  1.4342e+00,  5.0351e+00,        -inf],
          [ 1.8122e-01,  7.4318e-01,  5.5567e+00,  3.2709e+00]],

         [[-1.5368e+00,        -inf,        -inf,        -inf],
          [-3.7092e+00,  9.4334e-01,        -inf,        -inf],
          [-2.7798e+00, -1.6089e+00,  1.7710e+00,        -inf],
          [-2.4053e+00,  8.6307e-01,  1.2950e+00, -3.0109e+00]],

         [[ 3.0952e+00,        -inf,        -inf,        -inf],
          [ 6.6963e-01, -3.8175e+00,        -inf,        -inf],
          [ 2.3851e+00, -5.0988e+00, -8.6002e-01,        -inf],
          [ 6.8695e-01, -4.3932e+00, -4.5239e-01, -1.5795e-02]],

         [[-5.2198e-01,        -inf,        -inf,        -inf],
          [-4.8389e+00, -5.8710e+00,        -inf,        -inf],
          [-2.1029e+00,  1.1026e+00, -9.7009e-01,        -inf],
          [-1.8530e+00, -2.9196e+00, -1.8663e+00, -1.2409e+00]],

         [[ 8.0081e-01,        -inf,        -inf,        -inf],
          [ 1.3919e+00, -1.7946e+00,        -inf,        -inf],
          [ 2.2352e+00, -3.3143e+00, -2.5253e+00,        -inf],
          [-2.7500e-01, -5.3923e-01,  8.1311e-01,  2.8254e-01]],

         [[ 7.3430e-01,        -inf,        -inf,        -inf],
          [-2.2975e+00, -4.5825e+00,        -inf,        -inf],
          [-4.0237e+00, -2.5008e+00, -3.9459e+00,        -inf],
          [-4.2612e+00, -1.1942e+00, -2.0243e+00, -4.1618e+00]],

         [[-1.5255e+00,        -inf,        -inf,        -inf],
          [-3.9051e-01, -9.4282e-01,        -inf,        -inf],
          [-4.5080e-01,  3.0139e+00,  4.8812e+00,        -inf],
          [-1.9152e+00, -2.2730e+00, -2.3980e-01, -2.2903e+00]],

         [[-6.0210e-01,        -inf,        -inf,        -inf],
          [-3.1727e+00, -6.7441e-01,        -inf,        -inf],
          [ 1.4943e+00, -4.5297e+00, -1.3960e+00,        -inf],
          [-1.4227e+00, -2.2002e+00,  4.3258e-01, -4.7720e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.4347e-01, -3.6021e-01, -6.6341e-01,  ..., -4.6064e-01,
            8.4201e-01,  5.1791e-01],
          [ 5.3808e-01,  1.1581e-01,  1.7666e+00,  ...,  2.5828e-01,
           -4.7818e-01, -9.7250e-01],
          [-7.6504e-01,  6.1484e-02,  8.2028e-01,  ...,  1.7729e-01,
           -5.2638e-01, -1.5960e+00],
          ...,
          [ 5.1806e-01, -2.4178e-01, -1.8791e-01,  ...,  2.2804e-01,
           -6.6609e-01,  4.2963e-01],
          [-5.3983e-02,  7.6458e-01, -2.8225e-01,  ...,  7.6384e-01,
           -8.8794e-01,  8.1689e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],

         [[-8.1841e-02, -2.0548e-01, -3.7843e-01,  ..., -2.6277e-01,
            4.8031e-01,  2.9544e-01],
          [ 4.0520e-02,  2.4014e-01,  1.3008e+00,  ...,  7.5902e-02,
           -3.7893e-01, -3.9169e-01],
          [-8.9847e-01, -2.1176e-01,  8.0564e-01,  ...,  3.2179e-01,
           -1.2403e-01, -1.0925e+00],
          ...,
          [ 1.0239e-01, -4.0800e-01, -3.1385e-01,  ...,  1.2934e-01,
           -4.7125e-01,  3.5493e-03],
          [ 5.5841e-02,  4.6745e-01,  1.3483e-01,  ...,  8.1334e-01,
           -1.0031e+00,  1.1942e+00],
          [ 1.1365e+00, -5.1525e-01,  9.8376e-01,  ..., -6.4802e-01,
            3.7221e-01, -5.0058e-01]],

         [[ 1.4841e-02,  1.2504e-01, -5.5256e-01,  ..., -5.0794e-01,
            3.3665e-01,  5.1832e-01],
          [-3.3078e-01,  3.6399e-01,  1.2208e+00,  ...,  2.9948e-01,
           -4.7622e-01, -1.3811e-01],
          [-9.2731e-01, -5.1301e-01,  5.3433e-01,  ...,  4.7722e-01,
            3.3400e-01, -7.7570e-01],
          ...,
          [ 2.9439e-02, -1.6982e-01, -2.1381e-01,  ..., -6.0893e-02,
           -5.5081e-01, -2.1442e-01],
          [-2.9014e-01, -7.1410e-02,  7.2998e-01,  ...,  8.3740e-01,
           -2.0037e-01,  3.6331e-01],
          [ 6.7797e-01, -2.8577e-01,  6.5673e-01,  ..., -3.4090e-01,
            2.7746e-01, -2.1877e-01]],

         [[ 2.0994e-01,  4.4201e-01, -4.2083e-01,  ..., -3.5423e-01,
            2.7040e-01,  5.2738e-01],
          [-3.6366e-01,  3.3851e-01,  1.1690e+00,  ...,  4.9206e-01,
           -7.2326e-01, -7.4641e-02],
          [-8.2244e-01, -4.0394e-01,  5.6497e-01,  ...,  3.6809e-01,
            3.2401e-01, -5.2397e-01],
          ...,
          [-6.0176e-03,  1.1658e-03, -1.1711e-01,  ..., -2.3276e-01,
           -7.8131e-01, -1.3285e-01],
          [-4.6009e-02,  2.0493e-01,  6.3331e-01,  ...,  4.4507e-01,
           -5.4469e-01,  4.1165e-01],
          [ 1.0078e+00,  1.4022e-01,  5.1194e-01,  ..., -7.3038e-01,
            3.2272e-01, -6.4436e-02]]],


        [[[ 3.6505e-01, -4.5795e-01, -5.5743e-01,  ..., -3.6017e-01,
            6.0178e-01,  8.0218e-01],
          [ 1.3614e-01, -9.7035e-02,  1.7368e+00,  ..., -1.8439e-02,
           -5.5720e-01, -1.1345e+00],
          [-1.1349e+00, -3.5438e-01,  1.9433e-01,  ..., -4.7396e-01,
           -4.4764e-01, -9.0961e-01],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-3.5435e-01,  1.1285e+00, -3.8719e-01,  ...,  8.7194e-01,
           -8.8322e-01,  1.3919e+00],
          [ 1.0531e+00, -6.4186e-03,  9.3387e-01,  ..., -6.2040e-01,
           -1.1284e-01,  2.6687e-01]],

         [[ 4.3608e-01, -5.5681e-01, -5.5289e-01,  ..., -4.3638e-01,
            4.6918e-01,  7.9971e-01],
          [-6.0845e-01,  6.1320e-01,  6.4465e-01,  ..., -3.7802e-01,
           -6.7689e-01,  9.2671e-02],
          [-8.8670e-01, -4.1384e-01,  1.7398e-01,  ..., -1.7238e-01,
           -6.8382e-02, -5.0691e-01],
          ...,
          [-1.1590e-01, -5.6762e-01, -1.0575e-01,  ..., -6.3901e-01,
           -6.5589e-01, -2.1366e-01],
          [-4.7849e-01,  7.0948e-01, -2.8040e-01,  ...,  2.0863e-01,
           -7.9705e-01,  1.2554e+00],
          [ 8.8990e-01, -1.9363e-01,  2.0015e-01,  ..., -8.3056e-01,
           -1.5125e-01, -7.1265e-01]],

         [[ 4.1541e-01, -7.4975e-01, -5.7001e-01,  ..., -3.5787e-01,
            2.0722e-01,  4.9643e-01],
          [ 8.2256e-02,  2.3907e-01,  8.5282e-01,  ..., -4.7060e-02,
           -4.6969e-01, -5.5197e-01],
          [-7.8346e-01, -5.0199e-01,  3.9939e-01,  ...,  9.1876e-02,
           -1.3397e-01, -4.8404e-01],
          ...,
          [-5.2178e-01, -5.1754e-01,  8.2788e-02,  ..., -8.2195e-01,
           -5.8975e-01, -3.2131e-01],
          [-4.8167e-01,  4.3445e-01,  9.5452e-02,  ...,  3.0595e-01,
           -8.1128e-01,  6.9557e-01],
          [ 1.1115e+00, -1.7473e-01,  4.5717e-01,  ..., -8.5230e-01,
           -5.5023e-02, -5.4370e-01]],

         [[ 3.0202e-01, -7.3447e-01, -4.7279e-01,  ..., -6.8624e-01,
            3.0888e-01,  4.5583e-01],
          [-3.7169e-01,  9.1729e-01,  1.1533e+00,  ..., -3.8540e-01,
           -9.6179e-01, -1.3603e-01],
          [-6.6980e-01, -3.6073e-01,  2.8075e-01,  ...,  6.1363e-02,
           -2.4261e-01, -4.9080e-01],
          ...,
          [-4.9438e-01, -4.5406e-01, -9.6066e-02,  ..., -8.0363e-01,
           -4.5192e-01, -2.7692e-01],
          [-1.2162e-01,  5.8046e-01,  3.4980e-01,  ...,  1.8448e-01,
           -8.9425e-01,  2.9567e-01],
          [ 1.1537e+00, -8.6685e-02,  4.8193e-01,  ..., -9.4163e-01,
            2.8111e-03, -6.1012e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.1435, -0.3602, -0.6634,  ...,  0.0000,  0.0000,  0.0000],
         [-0.0818, -0.2055, -0.3784,  ..., -0.6480,  0.3722, -0.5006],
         [ 0.0148,  0.1250, -0.5526,  ..., -0.3409,  0.2775, -0.2188],
         [ 0.2099,  0.4420, -0.4208,  ..., -0.7304,  0.3227, -0.0644]],

        [[ 0.3650, -0.4580, -0.5574,  ..., -0.6204, -0.1128,  0.2669],
         [ 0.4361, -0.5568, -0.5529,  ..., -0.8306, -0.1513, -0.7127],
         [ 0.4154, -0.7498, -0.5700,  ..., -0.8523, -0.0550, -0.5437],
         [ 0.3020, -0.7345, -0.4728,  ..., -0.9416,  0.0028, -0.6101]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 1.6301e-01, -3.2763e-01, -1.6610e-01,  ...,  6.9739e-02,
          -2.0940e-01,  2.1114e-01],
         [ 4.9739e-01, -2.8862e-01, -3.1045e-01,  ...,  2.6915e-01,
          -3.2433e-01,  9.8680e-02],
         [ 4.4745e-01, -1.8751e-01, -2.1258e-01,  ...,  1.5132e-01,
          -3.3155e-01,  6.7996e-04],
         [ 3.4916e-01, -5.5916e-02, -1.6444e-01,  ...,  1.4977e-02,
          -3.3926e-01, -1.3992e-02]],

        [[ 6.9009e-01, -5.4219e-01, -1.2854e-01,  ..., -1.7478e-01,
          -4.1553e-01,  1.7825e-03],
         [ 7.2306e-01, -4.4394e-01, -1.3473e-01,  ..., -3.6949e-01,
          -2.9953e-01, -4.1607e-01],
         [ 7.3097e-01, -4.9476e-01,  5.8944e-02,  ..., -1.1421e-01,
          -3.4067e-01, -1.4429e-01],
         [ 7.4302e-01, -2.1737e-01, -1.4986e-02,  ..., -1.7797e-01,
          -4.5243e-01, -1.5851e-01]]], grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.3591e-01,        -inf,        -inf,        -inf],
          [ 1.6720e+00, -7.5150e-01,        -inf,        -inf],
          [ 3.3468e-01,  1.5506e+00,  4.1013e-01,        -inf],
          [ 2.0985e+00, -1.2363e+00,  2.7516e+00, -8.2991e-01]],

         [[-3.1787e+00,        -inf,        -inf,        -inf],
          [-1.9955e+00,  1.7644e+00,        -inf,        -inf],
          [ 6.5933e+00,  4.9612e+00,  5.0835e-01,        -inf],
          [ 3.0417e+00,  1.9130e+00,  1.2786e+00, -4.8089e-01]],

         [[-6.1476e+00,        -inf,        -inf,        -inf],
          [-1.0172e+00, -1.2240e+00,        -inf,        -inf],
          [ 5.4060e-01, -3.0977e+00, -4.1013e+00,        -inf],
          [-3.0275e+00, -1.3876e+00, -2.7242e-01, -8.4162e-01]],

         [[-3.2996e+00,        -inf,        -inf,        -inf],
          [-3.6525e+00,  2.4069e-01,        -inf,        -inf],
          [ 1.7484e+00,  3.2698e+00,  5.3768e-01,        -inf],
          [ 2.1849e+00,  1.8959e+00,  2.3780e+00,  3.7179e+00]],

         [[ 2.1636e+00,        -inf,        -inf,        -inf],
          [ 3.7573e-01, -1.8512e+00,        -inf,        -inf],
          [ 1.1289e+00, -2.3265e+00, -5.4473e+00,        -inf],
          [ 1.4421e+00, -1.1897e+00, -2.9820e+00,  7.9904e-01]],

         [[-1.2411e+00,        -inf,        -inf,        -inf],
          [-1.4314e+00,  1.4284e+00,        -inf,        -inf],
          [-1.1080e+00,  1.9908e+00,  1.6190e+00,        -inf],
          [ 2.3366e-01,  2.7300e-01,  3.4972e+00,  9.7960e-01]],

         [[ 1.9481e-01,        -inf,        -inf,        -inf],
          [ 1.7967e+00,  2.5846e+00,        -inf,        -inf],
          [ 1.0488e-01, -2.2240e+00,  1.6394e+00,        -inf],
          [-1.1169e+00, -1.5504e+00, -2.0339e+00, -4.6368e+00]],

         [[ 5.6486e+00,        -inf,        -inf,        -inf],
          [ 2.8968e+00, -4.3173e-01,        -inf,        -inf],
          [-1.0471e+00,  1.0616e+00,  4.6503e-02,        -inf],
          [ 1.9935e+00, -8.5616e-01,  4.7055e+00,  2.2102e+00]],

         [[-2.4815e+00,        -inf,        -inf,        -inf],
          [-1.7851e+00,  4.7481e+00,        -inf,        -inf],
          [-4.7367e+00,  3.6025e+00,  4.3053e+00,        -inf],
          [-3.7822e+00,  1.7990e+00,  4.2152e-02, -3.5420e+00]],

         [[ 2.7092e-01,        -inf,        -inf,        -inf],
          [-5.2680e-01,  1.0942e+00,        -inf,        -inf],
          [-9.8299e-01,  1.1701e+00, -2.5030e+00,        -inf],
          [-2.2957e+00,  6.5731e+00,  1.5158e+00, -2.6633e+00]],

         [[-2.2909e+00,        -inf,        -inf,        -inf],
          [ 5.6606e+00, -8.7772e-01,        -inf,        -inf],
          [-1.4603e+00,  1.0524e+00,  7.2252e-01,        -inf],
          [-6.6079e-03, -2.1393e-01,  2.0606e+00, -2.0033e+00]],

         [[-1.0762e+00,        -inf,        -inf,        -inf],
          [ 6.1271e-02, -1.6717e-01,        -inf,        -inf],
          [-1.1543e+00, -1.1332e+00, -4.8845e+00,        -inf],
          [-4.6150e-01, -4.6155e-01,  4.8177e+00, -4.9999e-01]],

         [[-2.7887e+00,        -inf,        -inf,        -inf],
          [-2.0216e-01,  2.5136e+00,        -inf,        -inf],
          [ 5.4748e+00, -1.5212e-01,  1.1369e+00,        -inf],
          [ 7.1242e-01, -2.7212e+00, -2.0780e-02, -2.2890e+00]],

         [[-3.6501e+00,        -inf,        -inf,        -inf],
          [-2.2003e-01,  1.0092e-02,        -inf,        -inf],
          [-1.5224e+00,  1.7091e+00, -1.2462e+00,        -inf],
          [-8.1280e-01,  5.9373e-01, -2.9251e+00, -5.8816e-01]],

         [[-2.8413e+00,        -inf,        -inf,        -inf],
          [-3.4470e+00, -1.2516e-01,        -inf,        -inf],
          [-2.0805e+00, -1.6427e+00, -3.0504e+00,        -inf],
          [-1.8326e+00,  9.9269e-01, -4.6846e+00, -2.5522e+00]],

         [[ 4.4991e-01,        -inf,        -inf,        -inf],
          [-1.6303e+00, -6.2995e+00,        -inf,        -inf],
          [ 7.9829e-01,  1.7933e+00, -7.0289e-01,        -inf],
          [ 1.9423e+00,  1.2538e+00, -9.8443e-01, -8.3529e-01]],

         [[-1.6469e+00,        -inf,        -inf,        -inf],
          [ 9.9690e-01,  2.1999e+00,        -inf,        -inf],
          [-1.2994e+00,  3.3846e+00,  2.6529e+00,        -inf],
          [-7.6944e-01, -2.0528e+00, -2.6909e+00, -1.4576e+00]],

         [[ 2.6849e+00,        -inf,        -inf,        -inf],
          [ 2.7602e+00, -8.8817e-01,        -inf,        -inf],
          [ 4.8228e+00,  5.0209e+00, -7.6151e-01,        -inf],
          [ 1.4471e+00,  2.4469e+00, -2.0654e+00,  1.9428e+00]],

         [[-1.1755e+00,        -inf,        -inf,        -inf],
          [ 1.8233e+00,  9.7104e-01,        -inf,        -inf],
          [-1.6199e+00, -2.2162e+00,  9.2218e-01,        -inf],
          [-2.1763e-01, -3.6493e+00,  9.1786e-01,  1.9621e+00]],

         [[ 1.4427e+00,        -inf,        -inf,        -inf],
          [ 4.8079e+00,  1.9428e+00,        -inf,        -inf],
          [ 3.9889e+00,  1.0488e+00, -4.0890e-01,        -inf],
          [ 2.4374e+00,  8.7040e-01,  2.5176e+00,  2.6576e+00]],

         [[-2.4072e+00,        -inf,        -inf,        -inf],
          [-1.1501e+00,  5.2300e-01,        -inf,        -inf],
          [-8.0431e-01, -4.6031e-01, -1.1302e+00,        -inf],
          [ 8.2619e-01,  2.6575e+00,  1.1594e+00,  6.3309e+00]],

         [[-1.9389e+00,        -inf,        -inf,        -inf],
          [ 1.0363e+00,  4.5901e+00,        -inf,        -inf],
          [ 2.8664e+00, -2.2074e+00,  8.0340e-01,        -inf],
          [ 2.7927e+00, -1.9373e+00,  2.8215e+00,  2.7857e+00]],

         [[ 4.8844e+00,        -inf,        -inf,        -inf],
          [ 1.1297e+00, -1.9023e+00,        -inf,        -inf],
          [ 2.2665e+00,  2.0675e+00, -5.6898e+00,        -inf],
          [ 1.5730e+00,  1.0073e+00, -3.8101e+00,  2.7645e+00]],

         [[ 3.6421e+00,        -inf,        -inf,        -inf],
          [ 2.3100e+00,  1.0220e+00,        -inf,        -inf],
          [ 2.9143e+00, -8.9173e-01,  3.7309e+00,        -inf],
          [ 5.7960e+00, -2.3517e+00, -6.7587e-01, -5.7971e+00]],

         [[ 1.5409e+00,        -inf,        -inf,        -inf],
          [ 5.0234e-01,  3.6107e+00,        -inf,        -inf],
          [-3.9423e+00, -6.1140e+00, -5.1449e+00,        -inf],
          [-3.3146e+00, -4.0386e-01, -1.4412e+00, -2.2412e+00]]],


        [[[ 9.2775e-01,        -inf,        -inf,        -inf],
          [-3.0644e+00,  6.0522e-01,        -inf,        -inf],
          [-1.2400e+00,  2.2642e+00,  2.3724e-01,        -inf],
          [-3.7530e+00, -3.7873e+00, -2.7088e+00, -1.0591e+00]],

         [[-2.9047e+00,        -inf,        -inf,        -inf],
          [-2.7163e+00,  1.2076e+00,        -inf,        -inf],
          [-4.5875e-01,  2.3554e+00, -2.9898e+00,        -inf],
          [-1.7607e+00,  1.6395e+00,  2.9400e-01,  6.7783e-01]],

         [[-5.7788e+00,        -inf,        -inf,        -inf],
          [ 2.5083e+00,  1.6484e+00,        -inf,        -inf],
          [-4.4869e+00, -5.3981e-01, -5.4281e+00,        -inf],
          [-4.2442e-01,  1.5099e-01,  9.9707e-01,  2.5201e+00]],

         [[-3.7185e+00,        -inf,        -inf,        -inf],
          [-2.1820e+00, -2.2206e+00,        -inf,        -inf],
          [ 8.6839e-01,  1.7059e+00, -9.1256e-01,        -inf],
          [ 2.4827e+00,  1.5110e+00,  1.0130e+00, -4.5013e-01]],

         [[ 1.3920e+00,        -inf,        -inf,        -inf],
          [ 4.8189e-01, -3.3367e+00,        -inf,        -inf],
          [ 1.7202e+00, -1.3377e+00, -1.7462e+00,        -inf],
          [-1.8600e-01,  1.5893e+00,  1.0711e+00, -1.4382e+00]],

         [[-4.7266e-01,        -inf,        -inf,        -inf],
          [-7.7283e-01,  1.6979e+00,        -inf,        -inf],
          [-4.9115e-01,  3.8061e+00,  4.5393e+00,        -inf],
          [ 6.9669e-04,  1.5327e+00,  1.7662e+00,  4.2615e+00]],

         [[-3.9202e+00,        -inf,        -inf,        -inf],
          [-2.8204e+00,  1.8032e+00,        -inf,        -inf],
          [-1.7448e+00, -3.7246e+00,  2.5183e+00,        -inf],
          [ 5.7303e-02,  2.3735e+00, -4.5426e+00, -2.7472e+00]],

         [[ 1.4973e+00,        -inf,        -inf,        -inf],
          [-9.8133e-01, -1.9285e+00,        -inf,        -inf],
          [ 1.5005e+00, -1.4799e+00, -2.4598e+00,        -inf],
          [-2.1936e+00,  7.2403e-01, -2.8826e+00, -4.3231e+00]],

         [[-1.4169e+00,        -inf,        -inf,        -inf],
          [ 2.0836e+00,  2.3553e+00,        -inf,        -inf],
          [-8.2941e-01,  4.0701e+00,  1.9250e+00,        -inf],
          [-4.8792e+00,  5.5680e-01,  2.1157e+00,  2.2646e+00]],

         [[ 4.1435e+00,        -inf,        -inf,        -inf],
          [ 3.8028e+00,  1.7210e+00,        -inf,        -inf],
          [ 2.3697e+00,  1.3170e+00,  4.4068e+00,        -inf],
          [ 1.9440e+00,  3.1930e+00,  4.3120e+00,  1.6838e+00]],

         [[-2.2219e+00,        -inf,        -inf,        -inf],
          [ 5.4418e-01,  1.4863e+00,        -inf,        -inf],
          [-1.4151e+00, -1.4279e+00,  2.1524e+00,        -inf],
          [-2.0431e+00, -5.2881e-01, -1.7405e-01, -3.1750e-01]],

         [[-3.9066e+00,        -inf,        -inf,        -inf],
          [ 5.5130e-01, -1.4972e+00,        -inf,        -inf],
          [-3.4667e+00, -1.2256e+00, -6.3099e+00,        -inf],
          [-1.9201e-01, -1.2709e+00,  3.9895e-01, -2.6716e+00]],

         [[ 3.1771e+00,        -inf,        -inf,        -inf],
          [ 1.0956e+00,  1.8517e+00,        -inf,        -inf],
          [ 9.8280e-01, -4.8498e-01,  3.3387e+00,        -inf],
          [ 7.6721e-01, -2.6448e+00, -4.3991e+00,  1.1602e+00]],

         [[-2.3169e+00,        -inf,        -inf,        -inf],
          [ 2.0314e+00, -4.7352e+00,        -inf,        -inf],
          [ 3.3565e+00,  1.1806e-01,  7.1561e-01,        -inf],
          [ 2.3644e+00, -6.9405e-01,  2.7671e+00,  7.7448e-01]],

         [[-1.3286e+00,        -inf,        -inf,        -inf],
          [-2.0096e+00,  9.7522e-02,        -inf,        -inf],
          [-8.7637e-01, -2.2055e+00, -4.7027e+00,        -inf],
          [ 1.4371e+00,  3.9186e-01, -1.6646e+00,  1.0037e+00]],

         [[ 1.2756e+00,        -inf,        -inf,        -inf],
          [ 1.3565e+00,  1.3090e+00,        -inf,        -inf],
          [ 5.6151e-01,  2.0305e+00, -2.4289e+00,        -inf],
          [ 7.0903e-01,  3.1700e+00,  2.9813e+00, -1.1875e+00]],

         [[-2.9860e-01,        -inf,        -inf,        -inf],
          [ 6.2819e-01,  8.2908e-01,        -inf,        -inf],
          [-4.9403e-01,  3.5564e+00,  3.7698e-01,        -inf],
          [-2.6616e+00, -2.8248e+00, -5.4513e-02,  3.1412e-01]],

         [[-2.5429e+00,        -inf,        -inf,        -inf],
          [-3.1576e-01, -4.7350e-01,        -inf,        -inf],
          [ 2.2955e+00, -1.4201e+00, -2.4505e+00,        -inf],
          [-1.1362e+00, -5.5024e+00, -5.0924e+00, -6.4138e+00]],

         [[-4.8015e+00,        -inf,        -inf,        -inf],
          [ 2.9327e+00,  4.1617e-01,        -inf,        -inf],
          [ 2.6630e+00, -1.4007e+00, -1.5906e+00,        -inf],
          [-1.7390e+00,  1.1938e+00,  1.6349e+00,  1.4235e+00]],

         [[ 9.7944e-01,        -inf,        -inf,        -inf],
          [ 1.4064e+00,  4.1475e-02,        -inf,        -inf],
          [ 4.5331e+00,  2.1154e+00,  4.3311e+00,        -inf],
          [ 2.6482e+00, -1.1513e+00,  2.7947e+00,  6.1053e+00]],

         [[-4.0300e+00,        -inf,        -inf,        -inf],
          [-2.1074e+00,  2.7218e-01,        -inf,        -inf],
          [ 4.1406e-01,  2.9126e-01, -5.4791e-01,        -inf],
          [-2.6159e-02,  1.3406e+00, -1.5541e+00, -2.3898e-01]],

         [[-1.8358e-01,        -inf,        -inf,        -inf],
          [-2.3986e+00, -4.5628e-01,        -inf,        -inf],
          [ 6.0845e-01, -5.7748e+00, -3.6511e+00,        -inf],
          [ 7.2156e-01, -1.9730e+00, -1.2212e+00,  1.1779e+00]],

         [[ 1.7202e+00,        -inf,        -inf,        -inf],
          [-2.3815e+00,  1.3356e+00,        -inf,        -inf],
          [-3.8329e+00, -4.5948e+00,  2.7767e-03,        -inf],
          [ 3.9674e+00,  1.3810e+00,  3.1267e+00,  4.6506e-01]],

         [[ 2.1890e+00,        -inf,        -inf,        -inf],
          [ 5.3573e-01,  2.5507e+00,        -inf,        -inf],
          [-1.3050e+00,  1.9717e+00, -9.8217e-01,        -inf],
          [ 1.0812e-01,  3.1744e+00,  2.3345e+00, -3.7862e-01]],

         [[-1.1151e+00,        -inf,        -inf,        -inf],
          [ 1.2138e+00, -2.2818e+00,        -inf,        -inf],
          [-1.2858e+00, -4.6760e-01, -9.5356e-01,        -inf],
          [ 3.1356e-01,  1.2979e+00, -1.4199e+00,  4.9936e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 1.3591e-01,        -inf,        -inf,        -inf],
          [ 1.6720e+00, -7.5150e-01,        -inf,        -inf],
          [ 3.3468e-01,  1.5506e+00,  4.1013e-01,        -inf],
          [ 2.0985e+00, -1.2363e+00,  2.7516e+00, -8.2991e-01]],

         [[-3.1787e+00,        -inf,        -inf,        -inf],
          [-1.9955e+00,  1.7644e+00,        -inf,        -inf],
          [ 6.5933e+00,  4.9612e+00,  5.0835e-01,        -inf],
          [ 3.0417e+00,  1.9130e+00,  1.2786e+00, -4.8089e-01]],

         [[-6.1476e+00,        -inf,        -inf,        -inf],
          [-1.0172e+00, -1.2240e+00,        -inf,        -inf],
          [ 5.4060e-01, -3.0977e+00, -4.1013e+00,        -inf],
          [-3.0275e+00, -1.3876e+00, -2.7242e-01, -8.4162e-01]],

         [[-3.2996e+00,        -inf,        -inf,        -inf],
          [-3.6525e+00,  2.4069e-01,        -inf,        -inf],
          [ 1.7484e+00,  3.2698e+00,  5.3768e-01,        -inf],
          [ 2.1849e+00,  1.8959e+00,  2.3780e+00,  3.7179e+00]],

         [[ 2.1636e+00,        -inf,        -inf,        -inf],
          [ 3.7573e-01, -1.8512e+00,        -inf,        -inf],
          [ 1.1289e+00, -2.3265e+00, -5.4473e+00,        -inf],
          [ 1.4421e+00, -1.1897e+00, -2.9820e+00,  7.9904e-01]],

         [[-1.2411e+00,        -inf,        -inf,        -inf],
          [-1.4314e+00,  1.4284e+00,        -inf,        -inf],
          [-1.1080e+00,  1.9908e+00,  1.6190e+00,        -inf],
          [ 2.3366e-01,  2.7300e-01,  3.4972e+00,  9.7960e-01]],

         [[ 1.9481e-01,        -inf,        -inf,        -inf],
          [ 1.7967e+00,  2.5846e+00,        -inf,        -inf],
          [ 1.0488e-01, -2.2240e+00,  1.6394e+00,        -inf],
          [-1.1169e+00, -1.5504e+00, -2.0339e+00, -4.6368e+00]],

         [[ 5.6486e+00,        -inf,        -inf,        -inf],
          [ 2.8968e+00, -4.3173e-01,        -inf,        -inf],
          [-1.0471e+00,  1.0616e+00,  4.6503e-02,        -inf],
          [ 1.9935e+00, -8.5616e-01,  4.7055e+00,  2.2102e+00]],

         [[-2.4815e+00,        -inf,        -inf,        -inf],
          [-1.7851e+00,  4.7481e+00,        -inf,        -inf],
          [-4.7367e+00,  3.6025e+00,  4.3053e+00,        -inf],
          [-3.7822e+00,  1.7990e+00,  4.2152e-02, -3.5420e+00]],

         [[ 2.7092e-01,        -inf,        -inf,        -inf],
          [-5.2680e-01,  1.0942e+00,        -inf,        -inf],
          [-9.8299e-01,  1.1701e+00, -2.5030e+00,        -inf],
          [-2.2957e+00,  6.5731e+00,  1.5158e+00, -2.6633e+00]],

         [[-2.2909e+00,        -inf,        -inf,        -inf],
          [ 5.6606e+00, -8.7772e-01,        -inf,        -inf],
          [-1.4603e+00,  1.0524e+00,  7.2252e-01,        -inf],
          [-6.6079e-03, -2.1393e-01,  2.0606e+00, -2.0033e+00]],

         [[-1.0762e+00,        -inf,        -inf,        -inf],
          [ 6.1271e-02, -1.6717e-01,        -inf,        -inf],
          [-1.1543e+00, -1.1332e+00, -4.8845e+00,        -inf],
          [-4.6150e-01, -4.6155e-01,  4.8177e+00, -4.9999e-01]],

         [[-2.7887e+00,        -inf,        -inf,        -inf],
          [-2.0216e-01,  2.5136e+00,        -inf,        -inf],
          [ 5.4748e+00, -1.5212e-01,  1.1369e+00,        -inf],
          [ 7.1242e-01, -2.7212e+00, -2.0780e-02, -2.2890e+00]],

         [[-3.6501e+00,        -inf,        -inf,        -inf],
          [-2.2003e-01,  1.0092e-02,        -inf,        -inf],
          [-1.5224e+00,  1.7091e+00, -1.2462e+00,        -inf],
          [-8.1280e-01,  5.9373e-01, -2.9251e+00, -5.8816e-01]],

         [[-2.8413e+00,        -inf,        -inf,        -inf],
          [-3.4470e+00, -1.2516e-01,        -inf,        -inf],
          [-2.0805e+00, -1.6427e+00, -3.0504e+00,        -inf],
          [-1.8326e+00,  9.9269e-01, -4.6846e+00, -2.5522e+00]],

         [[ 4.4991e-01,        -inf,        -inf,        -inf],
          [-1.6303e+00, -6.2995e+00,        -inf,        -inf],
          [ 7.9829e-01,  1.7933e+00, -7.0289e-01,        -inf],
          [ 1.9423e+00,  1.2538e+00, -9.8443e-01, -8.3529e-01]],

         [[-1.6469e+00,        -inf,        -inf,        -inf],
          [ 9.9690e-01,  2.1999e+00,        -inf,        -inf],
          [-1.2994e+00,  3.3846e+00,  2.6529e+00,        -inf],
          [-7.6944e-01, -2.0528e+00, -2.6909e+00, -1.4576e+00]],

         [[ 2.6849e+00,        -inf,        -inf,        -inf],
          [ 2.7602e+00, -8.8817e-01,        -inf,        -inf],
          [ 4.8228e+00,  5.0209e+00, -7.6151e-01,        -inf],
          [ 1.4471e+00,  2.4469e+00, -2.0654e+00,  1.9428e+00]],

         [[-1.1755e+00,        -inf,        -inf,        -inf],
          [ 1.8233e+00,  9.7104e-01,        -inf,        -inf],
          [-1.6199e+00, -2.2162e+00,  9.2218e-01,        -inf],
          [-2.1763e-01, -3.6493e+00,  9.1786e-01,  1.9621e+00]],

         [[ 1.4427e+00,        -inf,        -inf,        -inf],
          [ 4.8079e+00,  1.9428e+00,        -inf,        -inf],
          [ 3.9889e+00,  1.0488e+00, -4.0890e-01,        -inf],
          [ 2.4374e+00,  8.7040e-01,  2.5176e+00,  2.6576e+00]],

         [[-2.4072e+00,        -inf,        -inf,        -inf],
          [-1.1501e+00,  5.2300e-01,        -inf,        -inf],
          [-8.0431e-01, -4.6031e-01, -1.1302e+00,        -inf],
          [ 8.2619e-01,  2.6575e+00,  1.1594e+00,  6.3309e+00]],

         [[-1.9389e+00,        -inf,        -inf,        -inf],
          [ 1.0363e+00,  4.5901e+00,        -inf,        -inf],
          [ 2.8664e+00, -2.2074e+00,  8.0340e-01,        -inf],
          [ 2.7927e+00, -1.9373e+00,  2.8215e+00,  2.7857e+00]],

         [[ 4.8844e+00,        -inf,        -inf,        -inf],
          [ 1.1297e+00, -1.9023e+00,        -inf,        -inf],
          [ 2.2665e+00,  2.0675e+00, -5.6898e+00,        -inf],
          [ 1.5730e+00,  1.0073e+00, -3.8101e+00,  2.7645e+00]],

         [[ 3.6421e+00,        -inf,        -inf,        -inf],
          [ 2.3100e+00,  1.0220e+00,        -inf,        -inf],
          [ 2.9143e+00, -8.9173e-01,  3.7309e+00,        -inf],
          [ 5.7960e+00, -2.3517e+00, -6.7587e-01, -5.7971e+00]],

         [[ 1.5409e+00,        -inf,        -inf,        -inf],
          [ 5.0234e-01,  3.6107e+00,        -inf,        -inf],
          [-3.9423e+00, -6.1140e+00, -5.1449e+00,        -inf],
          [-3.3146e+00, -4.0386e-01, -1.4412e+00, -2.2412e+00]]],


        [[[ 9.2775e-01,        -inf,        -inf,        -inf],
          [-3.0644e+00,  6.0522e-01,        -inf,        -inf],
          [-1.2400e+00,  2.2642e+00,  2.3724e-01,        -inf],
          [-3.7530e+00, -3.7873e+00, -2.7088e+00, -1.0591e+00]],

         [[-2.9047e+00,        -inf,        -inf,        -inf],
          [-2.7163e+00,  1.2076e+00,        -inf,        -inf],
          [-4.5875e-01,  2.3554e+00, -2.9898e+00,        -inf],
          [-1.7607e+00,  1.6395e+00,  2.9400e-01,  6.7783e-01]],

         [[-5.7788e+00,        -inf,        -inf,        -inf],
          [ 2.5083e+00,  1.6484e+00,        -inf,        -inf],
          [-4.4869e+00, -5.3981e-01, -5.4281e+00,        -inf],
          [-4.2442e-01,  1.5099e-01,  9.9707e-01,  2.5201e+00]],

         [[-3.7185e+00,        -inf,        -inf,        -inf],
          [-2.1820e+00, -2.2206e+00,        -inf,        -inf],
          [ 8.6839e-01,  1.7059e+00, -9.1256e-01,        -inf],
          [ 2.4827e+00,  1.5110e+00,  1.0130e+00, -4.5013e-01]],

         [[ 1.3920e+00,        -inf,        -inf,        -inf],
          [ 4.8189e-01, -3.3367e+00,        -inf,        -inf],
          [ 1.7202e+00, -1.3377e+00, -1.7462e+00,        -inf],
          [-1.8600e-01,  1.5893e+00,  1.0711e+00, -1.4382e+00]],

         [[-4.7266e-01,        -inf,        -inf,        -inf],
          [-7.7283e-01,  1.6979e+00,        -inf,        -inf],
          [-4.9115e-01,  3.8061e+00,  4.5393e+00,        -inf],
          [ 6.9669e-04,  1.5327e+00,  1.7662e+00,  4.2615e+00]],

         [[-3.9202e+00,        -inf,        -inf,        -inf],
          [-2.8204e+00,  1.8032e+00,        -inf,        -inf],
          [-1.7448e+00, -3.7246e+00,  2.5183e+00,        -inf],
          [ 5.7303e-02,  2.3735e+00, -4.5426e+00, -2.7472e+00]],

         [[ 1.4973e+00,        -inf,        -inf,        -inf],
          [-9.8133e-01, -1.9285e+00,        -inf,        -inf],
          [ 1.5005e+00, -1.4799e+00, -2.4598e+00,        -inf],
          [-2.1936e+00,  7.2403e-01, -2.8826e+00, -4.3231e+00]],

         [[-1.4169e+00,        -inf,        -inf,        -inf],
          [ 2.0836e+00,  2.3553e+00,        -inf,        -inf],
          [-8.2941e-01,  4.0701e+00,  1.9250e+00,        -inf],
          [-4.8792e+00,  5.5680e-01,  2.1157e+00,  2.2646e+00]],

         [[ 4.1435e+00,        -inf,        -inf,        -inf],
          [ 3.8028e+00,  1.7210e+00,        -inf,        -inf],
          [ 2.3697e+00,  1.3170e+00,  4.4068e+00,        -inf],
          [ 1.9440e+00,  3.1930e+00,  4.3120e+00,  1.6838e+00]],

         [[-2.2219e+00,        -inf,        -inf,        -inf],
          [ 5.4418e-01,  1.4863e+00,        -inf,        -inf],
          [-1.4151e+00, -1.4279e+00,  2.1524e+00,        -inf],
          [-2.0431e+00, -5.2881e-01, -1.7405e-01, -3.1750e-01]],

         [[-3.9066e+00,        -inf,        -inf,        -inf],
          [ 5.5130e-01, -1.4972e+00,        -inf,        -inf],
          [-3.4667e+00, -1.2256e+00, -6.3099e+00,        -inf],
          [-1.9201e-01, -1.2709e+00,  3.9895e-01, -2.6716e+00]],

         [[ 3.1771e+00,        -inf,        -inf,        -inf],
          [ 1.0956e+00,  1.8517e+00,        -inf,        -inf],
          [ 9.8280e-01, -4.8498e-01,  3.3387e+00,        -inf],
          [ 7.6721e-01, -2.6448e+00, -4.3991e+00,  1.1602e+00]],

         [[-2.3169e+00,        -inf,        -inf,        -inf],
          [ 2.0314e+00, -4.7352e+00,        -inf,        -inf],
          [ 3.3565e+00,  1.1806e-01,  7.1561e-01,        -inf],
          [ 2.3644e+00, -6.9405e-01,  2.7671e+00,  7.7448e-01]],

         [[-1.3286e+00,        -inf,        -inf,        -inf],
          [-2.0096e+00,  9.7522e-02,        -inf,        -inf],
          [-8.7637e-01, -2.2055e+00, -4.7027e+00,        -inf],
          [ 1.4371e+00,  3.9186e-01, -1.6646e+00,  1.0037e+00]],

         [[ 1.2756e+00,        -inf,        -inf,        -inf],
          [ 1.3565e+00,  1.3090e+00,        -inf,        -inf],
          [ 5.6151e-01,  2.0305e+00, -2.4289e+00,        -inf],
          [ 7.0903e-01,  3.1700e+00,  2.9813e+00, -1.1875e+00]],

         [[-2.9860e-01,        -inf,        -inf,        -inf],
          [ 6.2819e-01,  8.2908e-01,        -inf,        -inf],
          [-4.9403e-01,  3.5564e+00,  3.7698e-01,        -inf],
          [-2.6616e+00, -2.8248e+00, -5.4513e-02,  3.1412e-01]],

         [[-2.5429e+00,        -inf,        -inf,        -inf],
          [-3.1576e-01, -4.7350e-01,        -inf,        -inf],
          [ 2.2955e+00, -1.4201e+00, -2.4505e+00,        -inf],
          [-1.1362e+00, -5.5024e+00, -5.0924e+00, -6.4138e+00]],

         [[-4.8015e+00,        -inf,        -inf,        -inf],
          [ 2.9327e+00,  4.1617e-01,        -inf,        -inf],
          [ 2.6630e+00, -1.4007e+00, -1.5906e+00,        -inf],
          [-1.7390e+00,  1.1938e+00,  1.6349e+00,  1.4235e+00]],

         [[ 9.7944e-01,        -inf,        -inf,        -inf],
          [ 1.4064e+00,  4.1475e-02,        -inf,        -inf],
          [ 4.5331e+00,  2.1154e+00,  4.3311e+00,        -inf],
          [ 2.6482e+00, -1.1513e+00,  2.7947e+00,  6.1053e+00]],

         [[-4.0300e+00,        -inf,        -inf,        -inf],
          [-2.1074e+00,  2.7218e-01,        -inf,        -inf],
          [ 4.1406e-01,  2.9126e-01, -5.4791e-01,        -inf],
          [-2.6159e-02,  1.3406e+00, -1.5541e+00, -2.3898e-01]],

         [[-1.8358e-01,        -inf,        -inf,        -inf],
          [-2.3986e+00, -4.5628e-01,        -inf,        -inf],
          [ 6.0845e-01, -5.7748e+00, -3.6511e+00,        -inf],
          [ 7.2156e-01, -1.9730e+00, -1.2212e+00,  1.1779e+00]],

         [[ 1.7202e+00,        -inf,        -inf,        -inf],
          [-2.3815e+00,  1.3356e+00,        -inf,        -inf],
          [-3.8329e+00, -4.5948e+00,  2.7767e-03,        -inf],
          [ 3.9674e+00,  1.3810e+00,  3.1267e+00,  4.6506e-01]],

         [[ 2.1890e+00,        -inf,        -inf,        -inf],
          [ 5.3573e-01,  2.5507e+00,        -inf,        -inf],
          [-1.3050e+00,  1.9717e+00, -9.8217e-01,        -inf],
          [ 1.0812e-01,  3.1744e+00,  2.3345e+00, -3.7862e-01]],

         [[-1.1151e+00,        -inf,        -inf,        -inf],
          [ 1.2138e+00, -2.2818e+00,        -inf,        -inf],
          [-1.2858e+00, -4.6760e-01, -9.5356e-01,        -inf],
          [ 3.1356e-01,  1.2979e+00, -1.4199e+00,  4.9936e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.0841,  0.4129,  0.9885,  ...,  0.0640, -0.0461,  0.4241],
          [-0.4918, -0.1192,  0.6920,  ..., -0.2878,  0.1876,  0.6385],
          [-0.7989,  0.9314,  1.5540,  ..., -0.1232,  0.4188,  0.3652],
          ...,
          [ 0.7753,  0.0983,  0.4946,  ...,  0.4543, -0.3579,  0.9529],
          [ 0.4769,  1.5781,  0.3480,  ..., -0.4530, -0.0926, -0.0619],
          [-0.6053,  0.7067, -0.4893,  ..., -0.1128, -1.0032,  0.9992]],

         [[ 0.0071,  0.0468,  0.7119,  ...,  0.0405,  0.2257,  0.3469],
          [ 0.1864, -0.6735,  0.5609,  ..., -0.4457, -0.4977,  0.7018],
          [-0.5102,  0.2954,  0.8397,  ...,  0.3179,  0.3751,  0.2004],
          ...,
          [ 0.5872, -0.0940,  0.7878,  ...,  0.2970, -0.4895,  0.6540],
          [ 0.7853,  1.2102,  0.3341,  ..., -0.2723, -0.3395, -0.2279],
          [-0.3710,  0.0623, -0.2015,  ..., -0.2910, -0.3272,  0.5055]],

         [[-0.0091, -0.0346,  0.4352,  ...,  0.0233,  0.2032,  0.2225],
          [-0.0771, -0.6018,  0.7256,  ..., -0.4654, -0.3637,  0.7875],
          [-0.6941,  0.4076,  0.8889,  ...,  0.2528,  0.1522,  0.1202],
          ...,
          [ 0.5384, -0.1397,  0.7403,  ...,  0.2842, -0.5826,  0.5336],
          [ 0.8357,  1.2786,  0.5724,  ..., -0.2217, -0.1138, -0.3702],
          [-0.0771,  0.0629, -0.0381,  ...,  0.0832, -0.5552,  0.4652]],

         [[ 0.5819,  0.1291,  0.8164,  ...,  0.1804,  0.1754,  0.2999],
          [-0.3083, -0.5286,  0.7610,  ..., -0.4335, -0.6377,  0.9070],
          [-0.7449,  0.3470,  0.6190,  ...,  0.3690,  0.1837,  0.0461],
          ...,
          [ 0.4519, -0.0537,  0.4881,  ...,  0.3014, -0.2472,  0.1274],
          [ 0.5811,  0.5797,  0.2930,  ..., -0.0420, -0.1086, -0.2277],
          [-0.1355, -0.0180,  0.1171,  ..., -0.2885, -0.5004,  0.3674]]],


        [[[-0.2609,  0.6344,  0.3080,  ...,  0.1937, -0.0575,  0.2063],
          [ 0.0938, -0.5161,  0.6608,  ..., -0.4767, -0.2261,  0.2066],
          [-1.1949,  0.6274,  0.2547,  ..., -0.3068, -0.3538,  0.3681],
          ...,
          [ 0.8645,  0.8073,  0.4780,  ...,  0.5267, -0.3547,  1.1058],
          [ 1.7076,  0.9504,  0.3970,  ..., -0.4242, -1.0478, -0.1047],
          [-0.3486,  0.3533, -0.4704,  ..., -0.1270, -0.8601,  0.6040]],

         [[-0.4310, -0.3393,  0.3960,  ...,  0.2565,  0.4101,  0.7095],
          [ 0.6299, -0.6377,  0.5655,  ..., -0.6355, -0.5295,  0.8839],
          [-0.5310,  0.5071,  0.2556,  ..., -0.1324, -0.6422,  0.1930],
          ...,
          [ 0.5945,  0.7581, -0.2742,  ..., -0.1774, -0.1853,  0.6584],
          [ 1.2042,  0.2156, -0.0275,  ...,  0.1764, -0.7444,  0.6802],
          [-0.3692,  0.6390, -0.6727,  ..., -0.0354, -0.4335,  0.8122]],

         [[ 0.2942, -0.6155,  0.5925,  ...,  0.1965,  0.2324,  0.1948],
          [ 0.6628, -0.6615,  0.7074,  ..., -0.7371, -0.1312,  0.8715],
          [-0.0917,  0.3149,  0.2109,  ...,  0.0708, -0.4264, -0.1169],
          ...,
          [ 0.8998,  0.6209, -0.1378,  ..., -0.2057, -0.3448,  0.8863],
          [ 1.2359,  0.3395,  0.0751,  ...,  0.2594, -0.4268,  0.4912],
          [-0.2645,  0.5420, -0.3866,  ...,  0.3480, -0.3953,  0.5704]],

         [[ 0.4559,  0.1699,  0.3562,  ...,  0.1124,  0.1398,  0.1490],
          [ 0.5176, -0.5003,  0.5674,  ..., -0.5838,  0.0293,  0.6608],
          [-0.5387,  0.1383,  0.4971,  ...,  0.2634, -0.4267, -0.0646],
          ...,
          [ 0.4820,  0.4084, -0.0419,  ...,  0.0401,  0.0033,  0.3744],
          [ 1.1688,  0.5144, -0.0328,  ...,  0.3215, -0.2550,  0.2976],
          [-0.0962,  0.2996, -0.1867,  ...,  0.4148, -0.4687,  0.2208]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.0841,  0.4129,  0.9885,  ..., -0.1128, -1.0032,  0.9992],
         [ 0.0071,  0.0468,  0.7119,  ..., -0.2910, -0.3272,  0.5055],
         [-0.0091, -0.0346,  0.4352,  ...,  0.0832, -0.5552,  0.4652],
         [ 0.5819,  0.1291,  0.8164,  ..., -0.2885, -0.5004,  0.3674]],

        [[-0.2609,  0.6344,  0.3080,  ..., -0.1270, -0.8601,  0.6040],
         [-0.4310, -0.3393,  0.3960,  ..., -0.0354, -0.4335,  0.8122],
         [ 0.2942, -0.6155,  0.5925,  ...,  0.3480, -0.3953,  0.5704],
         [ 0.4559,  0.1699,  0.3562,  ...,  0.4148, -0.4687,  0.2208]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0324, -0.3342,  0.1916,  ..., -0.3672, -0.7859,  0.2399],
         [ 0.1447,  0.0168, -0.2233,  ..., -0.4221, -0.2648,  0.1479],
         [ 0.1765, -0.0076,  0.0377,  ..., -0.2602, -0.3345,  0.0434],
         [ 0.0532,  0.0558, -0.1890,  ..., -0.3752, -0.4831, -0.0920]],

        [[ 0.1312, -0.5817,  0.2733,  ..., -0.3378, -0.4661, -0.0090],
         [ 0.0696, -0.1742,  0.2562,  ..., -0.1961, -0.3581,  0.2673],
         [ 0.1304, -0.0376,  0.1005,  ..., -0.1032, -0.2627,  0.4261],
         [ 0.0391,  0.0193, -0.1019,  ..., -0.1828, -0.2942,  0.1517]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.1606,    -inf,    -inf,    -inf],
          [ 0.5123, -1.0884,    -inf,    -inf],
          [ 4.1095,  1.1392,  0.8981,    -inf],
          [-1.7227, -5.6975, -1.5656, -0.4069]],

         [[ 0.6630,    -inf,    -inf,    -inf],
          [-0.5375, -3.8987,    -inf,    -inf],
          [-1.7247, -1.3720, -4.0645,    -inf],
          [-3.9663, -0.1053, -4.3748, -5.6648]],

         [[-2.5124,    -inf,    -inf,    -inf],
          [ 1.7508, -2.7912,    -inf,    -inf],
          [-0.0346, -1.7999, -3.7734,    -inf],
          [-1.3211,  3.4768, -0.9847,  3.1989]],

         [[ 6.5340,    -inf,    -inf,    -inf],
          [ 0.9380, -2.4108,    -inf,    -inf],
          [ 3.0539,  3.6092, -1.8673,    -inf],
          [-1.2174,  0.3122, -2.6849,  0.6501]],

         [[ 1.3004,    -inf,    -inf,    -inf],
          [ 4.5722, -2.6249,    -inf,    -inf],
          [-1.8076, -0.7660,  0.8195,    -inf],
          [ 3.4478, -1.6589, -0.6042, -5.0425]],

         [[-0.3995,    -inf,    -inf,    -inf],
          [ 2.3972, -0.1615,    -inf,    -inf],
          [-2.6628, -2.6342, -1.8641,    -inf],
          [-3.1164, -4.6436, -1.3747, -0.9799]],

         [[ 1.2546,    -inf,    -inf,    -inf],
          [ 3.1339, -4.9615,    -inf,    -inf],
          [ 0.0399, -6.0189,  2.0129,    -inf],
          [ 3.6237, -4.6373, -0.7540,  0.7449]],

         [[ 0.7830,    -inf,    -inf,    -inf],
          [-1.4316,  1.5963,    -inf,    -inf],
          [-0.8094, -0.7944,  0.5079,    -inf],
          [ 0.2445, -1.4448, -0.6931, -3.2269]],

         [[-3.1700,    -inf,    -inf,    -inf],
          [ 0.1297,  2.1452,    -inf,    -inf],
          [-2.3703, -3.1241,  1.9209,    -inf],
          [-3.7498, -2.8438, -0.0507, -3.9971]],

         [[ 0.5486,    -inf,    -inf,    -inf],
          [ 2.2159, -0.1247,    -inf,    -inf],
          [-1.0077, -0.3780, -1.9319,    -inf],
          [ 1.7256,  0.1411, -0.5160, -2.6618]],

         [[-0.8014,    -inf,    -inf,    -inf],
          [ 2.0774,  0.4795,    -inf,    -inf],
          [ 3.1714,  2.7249,  0.2113,    -inf],
          [ 0.9065,  0.9650, -0.5687, -5.0878]],

         [[ 6.2743,    -inf,    -inf,    -inf],
          [ 2.7869, -2.5213,    -inf,    -inf],
          [-1.0047,  0.3236, -0.7270,    -inf],
          [-3.4262,  1.5172,  3.5787,  0.9675]],

         [[ 2.4141,    -inf,    -inf,    -inf],
          [-1.6229, -0.6536,    -inf,    -inf],
          [-1.1721, -0.8581, -4.6247,    -inf],
          [-0.6931,  0.1470, -5.2289,  0.9260]],

         [[ 1.6259,    -inf,    -inf,    -inf],
          [ 1.7198,  2.6479,    -inf,    -inf],
          [-0.1089,  0.3277,  2.3976,    -inf],
          [ 0.5917,  2.3120,  0.9341, -0.5314]],

         [[ 2.8319,    -inf,    -inf,    -inf],
          [ 3.1185,  2.5027,    -inf,    -inf],
          [ 1.7228,  1.4203, -0.0170,    -inf],
          [ 1.4425,  0.2790,  0.5698,  3.0032]],

         [[-1.5230,    -inf,    -inf,    -inf],
          [-2.0941,  2.0821,    -inf,    -inf],
          [-2.2107, -1.3339, -4.0047,    -inf],
          [-0.5197,  3.2455,  0.1396,  2.7743]],

         [[ 2.0248,    -inf,    -inf,    -inf],
          [ 1.9641, -5.8594,    -inf,    -inf],
          [-1.1357, -3.6486, -4.3026,    -inf],
          [ 0.8552,  0.0341, -1.6562,  2.2016]],

         [[ 0.6574,    -inf,    -inf,    -inf],
          [ 3.5768, -0.7689,    -inf,    -inf],
          [ 4.7890, -1.3717,  2.3568,    -inf],
          [-0.1179,  1.3021, -0.9324, -0.9641]],

         [[ 3.5404,    -inf,    -inf,    -inf],
          [ 3.8950,  3.4448,    -inf,    -inf],
          [ 4.6295,  7.5965,  5.0848,    -inf],
          [-1.0505,  1.9985,  0.4520, -1.0536]],

         [[ 4.0810,    -inf,    -inf,    -inf],
          [ 1.7732, -1.4524,    -inf,    -inf],
          [-3.7859, -1.4948,  0.5491,    -inf],
          [ 1.2826, -0.4271, -0.3663,  0.7629]],

         [[-0.0144,    -inf,    -inf,    -inf],
          [ 3.0380, -0.5551,    -inf,    -inf],
          [ 1.0738,  2.7245,  2.2030,    -inf],
          [ 0.2713, -1.1693, -1.6600, -1.1337]],

         [[-5.2712,    -inf,    -inf,    -inf],
          [-2.4814,  2.2018,    -inf,    -inf],
          [-1.8529,  0.5589, -0.4628,    -inf],
          [-1.9626,  1.3400,  3.3447,  4.1629]],

         [[-0.8914,    -inf,    -inf,    -inf],
          [ 1.0832, -2.7440,    -inf,    -inf],
          [-3.7846, -2.3816, -4.3073,    -inf],
          [-3.0240,  3.0053,  3.5953, -0.1978]],

         [[-0.6555,    -inf,    -inf,    -inf],
          [-4.5643,  0.3175,    -inf,    -inf],
          [-0.7421, -2.5834, -3.6371,    -inf],
          [ 0.5091,  2.9095, -3.0339, -4.1466]],

         [[ 4.7676,    -inf,    -inf,    -inf],
          [-4.1870,  0.6076,    -inf,    -inf],
          [-5.1454, -0.8647, -2.8135,    -inf],
          [-2.0018,  1.9373,  0.8195, -5.7965]]],


        [[[ 2.7187,    -inf,    -inf,    -inf],
          [ 0.7547, -3.7883,    -inf,    -inf],
          [ 3.8774,  2.4647, -0.1983,    -inf],
          [-2.0039,  1.3049, -4.6391, -0.5546]],

         [[-0.4038,    -inf,    -inf,    -inf],
          [-1.0674, -4.0799,    -inf,    -inf],
          [-1.4072, -7.2702,  0.2563,    -inf],
          [ 1.4226, -4.5026,  0.6857,  0.1899]],

         [[-1.6339,    -inf,    -inf,    -inf],
          [ 2.1966, -5.2073,    -inf,    -inf],
          [ 4.0174, -1.4085,  2.2245,    -inf],
          [-0.7467, -1.9289,  1.1480,  3.2713]],

         [[ 5.1333,    -inf,    -inf,    -inf],
          [-1.1394,  1.5095,    -inf,    -inf],
          [ 1.8115, -0.1320, -3.1097,    -inf],
          [-1.3975, -4.8786, -2.2410, -4.8109]],

         [[ 2.8947,    -inf,    -inf,    -inf],
          [ 1.6846,  0.7456,    -inf,    -inf],
          [ 1.2114,  0.8812,  4.6623,    -inf],
          [ 3.6604,  1.2892,  5.0331,  0.2256]],

         [[ 0.0539,    -inf,    -inf,    -inf],
          [ 0.5273,  0.7789,    -inf,    -inf],
          [-2.2530,  0.8425, -3.5097,    -inf],
          [-2.1378, -1.6926, -0.1918,  5.1850]],

         [[-2.0196,    -inf,    -inf,    -inf],
          [ 0.8187, -1.0795,    -inf,    -inf],
          [ 0.1302, -1.1003,  3.5149,    -inf],
          [ 0.3563, -1.2612,  1.1623,  1.0421]],

         [[ 0.5937,    -inf,    -inf,    -inf],
          [-4.8036, -2.3087,    -inf,    -inf],
          [-3.3950,  2.6400,  0.1118,    -inf],
          [-2.3422,  1.0845, -1.7049, -3.3582]],

         [[-1.2907,    -inf,    -inf,    -inf],
          [-2.7589, -1.5846,    -inf,    -inf],
          [ 0.8394, -0.9437,  4.2957,    -inf],
          [-0.0536, -3.0066,  0.5175, -3.2786]],

         [[-0.7721,    -inf,    -inf,    -inf],
          [ 2.1695,  1.1861,    -inf,    -inf],
          [ 2.9192,  3.3963,  1.2579,    -inf],
          [ 1.5952,  1.3058,  1.1673,  0.5694]],

         [[ 1.2660,    -inf,    -inf,    -inf],
          [-1.4598, -1.0013,    -inf,    -inf],
          [ 0.8142,  1.9244,  3.8420,    -inf],
          [-0.7689,  3.1512,  1.1409, -2.2566]],

         [[ 2.4054,    -inf,    -inf,    -inf],
          [-4.8274, -0.1348,    -inf,    -inf],
          [-4.1049, -1.9939, -4.9928,    -inf],
          [-5.5795,  0.6236, -2.0931, -1.6522]],

         [[-0.6115,    -inf,    -inf,    -inf],
          [-4.7602,  0.1387,    -inf,    -inf],
          [-4.0532,  2.8923, -3.7342,    -inf],
          [-3.4698, -3.1994, -1.0477,  1.3514]],

         [[ 0.4969,    -inf,    -inf,    -inf],
          [-1.2086, -4.5525,    -inf,    -inf],
          [ 1.2498, -3.1855,  3.5678,    -inf],
          [ 1.6894, -3.7209,  1.2401,  2.9198]],

         [[ 2.2445,    -inf,    -inf,    -inf],
          [-1.9291, -1.2734,    -inf,    -inf],
          [ 1.2574,  0.0909,  2.7435,    -inf],
          [-3.7626,  1.9488, -2.2788, -3.3717]],

         [[ 2.7211,    -inf,    -inf,    -inf],
          [ 0.8717,  1.4086,    -inf,    -inf],
          [-2.1076,  3.0519, -0.5260,    -inf],
          [-4.3827,  1.1926, -0.2471,  2.2525]],

         [[ 0.3543,    -inf,    -inf,    -inf],
          [-0.4707, -0.8536,    -inf,    -inf],
          [ 3.1275, -1.6742, -3.5958,    -inf],
          [-1.5351,  1.4103, -2.6714, -2.4721]],

         [[ 2.4336,    -inf,    -inf,    -inf],
          [-0.0875, -1.4254,    -inf,    -inf],
          [ 2.4996, -1.0265, -0.3392,    -inf],
          [-2.4070, -2.3330, -1.1906, -7.9934]],

         [[ 2.2783,    -inf,    -inf,    -inf],
          [-0.9341, -3.0390,    -inf,    -inf],
          [ 2.6133,  0.7404,  3.4258,    -inf],
          [ 4.7108, -0.9238, -1.9742, -0.1997]],

         [[ 4.1761,    -inf,    -inf,    -inf],
          [-1.9305, -1.7368,    -inf,    -inf],
          [-5.8561, -5.5198, -5.8519,    -inf],
          [-0.9981,  0.6105, -2.4641, -3.9818]],

         [[ 1.4817,    -inf,    -inf,    -inf],
          [ 5.2397, -4.2541,    -inf,    -inf],
          [ 3.3113,  0.0896,  2.3277,    -inf],
          [ 2.3958, -2.7747,  2.7545, -2.4594]],

         [[-2.0518,    -inf,    -inf,    -inf],
          [ 1.0576, -0.3662,    -inf,    -inf],
          [-0.9133,  1.6270,  2.2389,    -inf],
          [-0.1676,  1.8966, -2.8846, -0.6222]],

         [[ 1.4063,    -inf,    -inf,    -inf],
          [-0.8326, -0.3283,    -inf,    -inf],
          [-1.4014, -0.6301,  0.4671,    -inf],
          [-1.2116, -2.8254,  1.5571, -0.5815]],

         [[-2.7007,    -inf,    -inf,    -inf],
          [-5.4065,  0.3742,    -inf,    -inf],
          [-3.1646, -1.2215, -3.8756,    -inf],
          [ 2.0923,  0.8764,  0.3265,  2.3243]],

         [[ 1.2977,    -inf,    -inf,    -inf],
          [-1.3333,  2.7603,    -inf,    -inf],
          [-1.0312,  5.5116,  0.5655,    -inf],
          [ 0.2106,  2.1725, -0.8926, -2.7172]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.1606,    -inf,    -inf,    -inf],
          [ 0.5123, -1.0884,    -inf,    -inf],
          [ 4.1095,  1.1392,  0.8981,    -inf],
          [-1.7227, -5.6975, -1.5656, -0.4069]],

         [[ 0.6630,    -inf,    -inf,    -inf],
          [-0.5375, -3.8987,    -inf,    -inf],
          [-1.7247, -1.3720, -4.0645,    -inf],
          [-3.9663, -0.1053, -4.3748, -5.6648]],

         [[-2.5124,    -inf,    -inf,    -inf],
          [ 1.7508, -2.7912,    -inf,    -inf],
          [-0.0346, -1.7999, -3.7734,    -inf],
          [-1.3211,  3.4768, -0.9847,  3.1989]],

         [[ 6.5340,    -inf,    -inf,    -inf],
          [ 0.9380, -2.4108,    -inf,    -inf],
          [ 3.0539,  3.6092, -1.8673,    -inf],
          [-1.2174,  0.3122, -2.6849,  0.6501]],

         [[ 1.3004,    -inf,    -inf,    -inf],
          [ 4.5722, -2.6249,    -inf,    -inf],
          [-1.8076, -0.7660,  0.8195,    -inf],
          [ 3.4478, -1.6589, -0.6042, -5.0425]],

         [[-0.3995,    -inf,    -inf,    -inf],
          [ 2.3972, -0.1615,    -inf,    -inf],
          [-2.6628, -2.6342, -1.8641,    -inf],
          [-3.1164, -4.6436, -1.3747, -0.9799]],

         [[ 1.2546,    -inf,    -inf,    -inf],
          [ 3.1339, -4.9615,    -inf,    -inf],
          [ 0.0399, -6.0189,  2.0129,    -inf],
          [ 3.6237, -4.6373, -0.7540,  0.7449]],

         [[ 0.7830,    -inf,    -inf,    -inf],
          [-1.4316,  1.5963,    -inf,    -inf],
          [-0.8094, -0.7944,  0.5079,    -inf],
          [ 0.2445, -1.4448, -0.6931, -3.2269]],

         [[-3.1700,    -inf,    -inf,    -inf],
          [ 0.1297,  2.1452,    -inf,    -inf],
          [-2.3703, -3.1241,  1.9209,    -inf],
          [-3.7498, -2.8438, -0.0507, -3.9971]],

         [[ 0.5486,    -inf,    -inf,    -inf],
          [ 2.2159, -0.1247,    -inf,    -inf],
          [-1.0077, -0.3780, -1.9319,    -inf],
          [ 1.7256,  0.1411, -0.5160, -2.6618]],

         [[-0.8014,    -inf,    -inf,    -inf],
          [ 2.0774,  0.4795,    -inf,    -inf],
          [ 3.1714,  2.7249,  0.2113,    -inf],
          [ 0.9065,  0.9650, -0.5687, -5.0878]],

         [[ 6.2743,    -inf,    -inf,    -inf],
          [ 2.7869, -2.5213,    -inf,    -inf],
          [-1.0047,  0.3236, -0.7270,    -inf],
          [-3.4262,  1.5172,  3.5787,  0.9675]],

         [[ 2.4141,    -inf,    -inf,    -inf],
          [-1.6229, -0.6536,    -inf,    -inf],
          [-1.1721, -0.8581, -4.6247,    -inf],
          [-0.6931,  0.1470, -5.2289,  0.9260]],

         [[ 1.6259,    -inf,    -inf,    -inf],
          [ 1.7198,  2.6479,    -inf,    -inf],
          [-0.1089,  0.3277,  2.3976,    -inf],
          [ 0.5917,  2.3120,  0.9341, -0.5314]],

         [[ 2.8319,    -inf,    -inf,    -inf],
          [ 3.1185,  2.5027,    -inf,    -inf],
          [ 1.7228,  1.4203, -0.0170,    -inf],
          [ 1.4425,  0.2790,  0.5698,  3.0032]],

         [[-1.5230,    -inf,    -inf,    -inf],
          [-2.0941,  2.0821,    -inf,    -inf],
          [-2.2107, -1.3339, -4.0047,    -inf],
          [-0.5197,  3.2455,  0.1396,  2.7743]],

         [[ 2.0248,    -inf,    -inf,    -inf],
          [ 1.9641, -5.8594,    -inf,    -inf],
          [-1.1357, -3.6486, -4.3026,    -inf],
          [ 0.8552,  0.0341, -1.6562,  2.2016]],

         [[ 0.6574,    -inf,    -inf,    -inf],
          [ 3.5768, -0.7689,    -inf,    -inf],
          [ 4.7890, -1.3717,  2.3568,    -inf],
          [-0.1179,  1.3021, -0.9324, -0.9641]],

         [[ 3.5404,    -inf,    -inf,    -inf],
          [ 3.8950,  3.4448,    -inf,    -inf],
          [ 4.6295,  7.5965,  5.0848,    -inf],
          [-1.0505,  1.9985,  0.4520, -1.0536]],

         [[ 4.0810,    -inf,    -inf,    -inf],
          [ 1.7732, -1.4524,    -inf,    -inf],
          [-3.7859, -1.4948,  0.5491,    -inf],
          [ 1.2826, -0.4271, -0.3663,  0.7629]],

         [[-0.0144,    -inf,    -inf,    -inf],
          [ 3.0380, -0.5551,    -inf,    -inf],
          [ 1.0738,  2.7245,  2.2030,    -inf],
          [ 0.2713, -1.1693, -1.6600, -1.1337]],

         [[-5.2712,    -inf,    -inf,    -inf],
          [-2.4814,  2.2018,    -inf,    -inf],
          [-1.8529,  0.5589, -0.4628,    -inf],
          [-1.9626,  1.3400,  3.3447,  4.1629]],

         [[-0.8914,    -inf,    -inf,    -inf],
          [ 1.0832, -2.7440,    -inf,    -inf],
          [-3.7846, -2.3816, -4.3073,    -inf],
          [-3.0240,  3.0053,  3.5953, -0.1978]],

         [[-0.6555,    -inf,    -inf,    -inf],
          [-4.5643,  0.3175,    -inf,    -inf],
          [-0.7421, -2.5834, -3.6371,    -inf],
          [ 0.5091,  2.9095, -3.0339, -4.1466]],

         [[ 4.7676,    -inf,    -inf,    -inf],
          [-4.1870,  0.6076,    -inf,    -inf],
          [-5.1454, -0.8647, -2.8135,    -inf],
          [-2.0018,  1.9373,  0.8195, -5.7965]]],


        [[[ 2.7187,    -inf,    -inf,    -inf],
          [ 0.7547, -3.7883,    -inf,    -inf],
          [ 3.8774,  2.4647, -0.1983,    -inf],
          [-2.0039,  1.3049, -4.6391, -0.5546]],

         [[-0.4038,    -inf,    -inf,    -inf],
          [-1.0674, -4.0799,    -inf,    -inf],
          [-1.4072, -7.2702,  0.2563,    -inf],
          [ 1.4226, -4.5026,  0.6857,  0.1899]],

         [[-1.6339,    -inf,    -inf,    -inf],
          [ 2.1966, -5.2073,    -inf,    -inf],
          [ 4.0174, -1.4085,  2.2245,    -inf],
          [-0.7467, -1.9289,  1.1480,  3.2713]],

         [[ 5.1333,    -inf,    -inf,    -inf],
          [-1.1394,  1.5095,    -inf,    -inf],
          [ 1.8115, -0.1320, -3.1097,    -inf],
          [-1.3975, -4.8786, -2.2410, -4.8109]],

         [[ 2.8947,    -inf,    -inf,    -inf],
          [ 1.6846,  0.7456,    -inf,    -inf],
          [ 1.2114,  0.8812,  4.6623,    -inf],
          [ 3.6604,  1.2892,  5.0331,  0.2256]],

         [[ 0.0539,    -inf,    -inf,    -inf],
          [ 0.5273,  0.7789,    -inf,    -inf],
          [-2.2530,  0.8425, -3.5097,    -inf],
          [-2.1378, -1.6926, -0.1918,  5.1850]],

         [[-2.0196,    -inf,    -inf,    -inf],
          [ 0.8187, -1.0795,    -inf,    -inf],
          [ 0.1302, -1.1003,  3.5149,    -inf],
          [ 0.3563, -1.2612,  1.1623,  1.0421]],

         [[ 0.5937,    -inf,    -inf,    -inf],
          [-4.8036, -2.3087,    -inf,    -inf],
          [-3.3950,  2.6400,  0.1118,    -inf],
          [-2.3422,  1.0845, -1.7049, -3.3582]],

         [[-1.2907,    -inf,    -inf,    -inf],
          [-2.7589, -1.5846,    -inf,    -inf],
          [ 0.8394, -0.9437,  4.2957,    -inf],
          [-0.0536, -3.0066,  0.5175, -3.2786]],

         [[-0.7721,    -inf,    -inf,    -inf],
          [ 2.1695,  1.1861,    -inf,    -inf],
          [ 2.9192,  3.3963,  1.2579,    -inf],
          [ 1.5952,  1.3058,  1.1673,  0.5694]],

         [[ 1.2660,    -inf,    -inf,    -inf],
          [-1.4598, -1.0013,    -inf,    -inf],
          [ 0.8142,  1.9244,  3.8420,    -inf],
          [-0.7689,  3.1512,  1.1409, -2.2566]],

         [[ 2.4054,    -inf,    -inf,    -inf],
          [-4.8274, -0.1348,    -inf,    -inf],
          [-4.1049, -1.9939, -4.9928,    -inf],
          [-5.5795,  0.6236, -2.0931, -1.6522]],

         [[-0.6115,    -inf,    -inf,    -inf],
          [-4.7602,  0.1387,    -inf,    -inf],
          [-4.0532,  2.8923, -3.7342,    -inf],
          [-3.4698, -3.1994, -1.0477,  1.3514]],

         [[ 0.4969,    -inf,    -inf,    -inf],
          [-1.2086, -4.5525,    -inf,    -inf],
          [ 1.2498, -3.1855,  3.5678,    -inf],
          [ 1.6894, -3.7209,  1.2401,  2.9198]],

         [[ 2.2445,    -inf,    -inf,    -inf],
          [-1.9291, -1.2734,    -inf,    -inf],
          [ 1.2574,  0.0909,  2.7435,    -inf],
          [-3.7626,  1.9488, -2.2788, -3.3717]],

         [[ 2.7211,    -inf,    -inf,    -inf],
          [ 0.8717,  1.4086,    -inf,    -inf],
          [-2.1076,  3.0519, -0.5260,    -inf],
          [-4.3827,  1.1926, -0.2471,  2.2525]],

         [[ 0.3543,    -inf,    -inf,    -inf],
          [-0.4707, -0.8536,    -inf,    -inf],
          [ 3.1275, -1.6742, -3.5958,    -inf],
          [-1.5351,  1.4103, -2.6714, -2.4721]],

         [[ 2.4336,    -inf,    -inf,    -inf],
          [-0.0875, -1.4254,    -inf,    -inf],
          [ 2.4996, -1.0265, -0.3392,    -inf],
          [-2.4070, -2.3330, -1.1906, -7.9934]],

         [[ 2.2783,    -inf,    -inf,    -inf],
          [-0.9341, -3.0390,    -inf,    -inf],
          [ 2.6133,  0.7404,  3.4258,    -inf],
          [ 4.7108, -0.9238, -1.9742, -0.1997]],

         [[ 4.1761,    -inf,    -inf,    -inf],
          [-1.9305, -1.7368,    -inf,    -inf],
          [-5.8561, -5.5198, -5.8519,    -inf],
          [-0.9981,  0.6105, -2.4641, -3.9818]],

         [[ 1.4817,    -inf,    -inf,    -inf],
          [ 5.2397, -4.2541,    -inf,    -inf],
          [ 3.3113,  0.0896,  2.3277,    -inf],
          [ 2.3958, -2.7747,  2.7545, -2.4594]],

         [[-2.0518,    -inf,    -inf,    -inf],
          [ 1.0576, -0.3662,    -inf,    -inf],
          [-0.9133,  1.6270,  2.2389,    -inf],
          [-0.1676,  1.8966, -2.8846, -0.6222]],

         [[ 1.4063,    -inf,    -inf,    -inf],
          [-0.8326, -0.3283,    -inf,    -inf],
          [-1.4014, -0.6301,  0.4671,    -inf],
          [-1.2116, -2.8254,  1.5571, -0.5815]],

         [[-2.7007,    -inf,    -inf,    -inf],
          [-5.4065,  0.3742,    -inf,    -inf],
          [-3.1646, -1.2215, -3.8756,    -inf],
          [ 2.0923,  0.8764,  0.3265,  2.3243]],

         [[ 1.2977,    -inf,    -inf,    -inf],
          [-1.3333,  2.7603,    -inf,    -inf],
          [-1.0312,  5.5116,  0.5655,    -inf],
          [ 0.2106,  2.1725, -0.8926, -2.7172]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.3076,  0.3184,  0.1405,  ...,  0.7419, -0.4260,  0.4069],
          [-0.5136, -0.9189, -0.4656,  ...,  1.0177,  0.0065,  0.2778],
          [ 0.2809,  0.3027,  0.0335,  ...,  0.3027, -0.4992, -0.5488],
          ...,
          [-0.2114,  0.5596,  0.7488,  ...,  0.2519, -0.6815,  0.2259],
          [-1.0543,  1.1331,  0.4513,  ...,  0.5388, -0.1222,  0.5863],
          [ 0.1655, -0.7049,  0.2069,  ...,  0.0109, -1.1214, -0.1037]],

         [[ 0.1692,  0.1751,  0.0772,  ...,  0.4079, -0.2343,  0.2237],
          [-0.3100, -0.5546, -0.2810,  ...,  0.6142,  0.0039,  0.1676],
          [ 0.1793,  0.1932,  0.0214,  ...,  0.1932, -0.3186, -0.3503],
          ...,
          [ 0.0721,  0.2536,  0.3541,  ..., -0.0834, -0.4692,  0.3316],
          [-0.3203,  0.4369,  0.7608,  ...,  0.7279,  0.1975,  0.3086],
          [-0.0275,  0.0831,  0.9114,  ...,  0.5873, -0.2638,  0.2948]],

         [[-0.2248, -0.1991, -0.3269,  ...,  0.4202,  0.0407,  0.3101],
          [-0.1556, -0.4136, -0.0069,  ...,  0.4522,  0.1697,  0.3883],
          [ 0.1430,  0.0289,  0.1367,  ..., -0.2542, -0.3781, -0.5291],
          ...,
          [ 0.1725,  0.4160,  0.3494,  ..., -0.0902, -0.1835,  0.4661],
          [-0.1933,  0.1929,  0.0530,  ..., -0.0807,  0.1952, -0.1445],
          [-0.2352, -0.0496,  0.6793,  ...,  0.3319, -0.3667,  0.3580]],

         [[-0.4490, -0.2514, -0.3905,  ...,  0.1170,  0.1668,  0.2153],
          [-0.1044, -0.3351,  0.1494,  ...,  0.4009,  0.4357,  0.9413],
          [ 0.4347, -0.0452, -0.0602,  ..., -0.3543, -0.6004, -0.4808],
          ...,
          [ 0.2283,  0.2934,  0.3191,  ..., -0.1060,  0.1506,  0.3446],
          [-0.3727,  0.3358,  0.4829,  ...,  0.3837,  0.1008,  0.2618],
          [-0.3753, -0.1462,  0.7012,  ...,  0.3814, -0.3860,  0.3822]]],


        [[[ 1.0431,  0.2257, -0.3872,  ...,  0.4309, -0.7244,  0.1528],
          [ 0.1105, -0.4022, -0.0438,  ...,  1.1385, -0.4131,  0.8955],
          [-0.2322,  0.2452,  0.5191,  ...,  0.0374, -0.5638, -0.6809],
          ...,
          [ 0.0708,  0.2404,  0.8780,  ...,  0.0487, -0.0518,  0.7819],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.2184, -0.3382,  0.5133,  ..., -0.0417, -1.0983,  0.6502]],

         [[ 0.6366,  0.0732, -0.7020,  ...,  0.6111, -0.2322,  0.1026],
          [-0.0938, -0.1250, -0.1298,  ...,  1.2933, -0.1831,  0.7653],
          [ 0.0039,  0.2085,  0.4153,  ..., -0.0177, -0.4956, -0.5947],
          ...,
          [ 0.2484,  0.2713,  0.0102,  ..., -0.1242, -0.4534,  0.6765],
          [-0.2710, -0.8697,  0.2836,  ...,  0.2143, -0.2154, -0.4496],
          [ 0.2383, -0.1225,  0.6222,  ...,  0.6094, -0.5573,  0.1423]],

         [[ 0.5631, -0.0215, -0.5461,  ...,  0.5340, -0.1487,  0.1977],
          [-0.0286, -0.0989, -0.0614,  ...,  0.6890, -0.1254,  0.4322],
          [-0.0048,  0.1425,  0.5110,  ..., -0.0750, -0.0479, -0.3349],
          ...,
          [-0.0337,  0.2797, -0.0955,  ..., -0.4444,  0.0689,  0.6364],
          [-0.2722, -0.4020,  0.4361,  ...,  0.0896, -0.0366, -0.5011],
          [-0.1059, -0.1845,  0.3595,  ...,  0.4645, -0.3466,  0.1921]],

         [[ 0.4056,  0.0312, -0.6967,  ...,  0.2593,  0.1143,  0.3610],
          [ 0.1815, -0.2835,  0.3158,  ...,  1.0307,  0.0498,  0.9677],
          [ 0.1106,  0.3630,  0.1943,  ..., -0.1588,  0.2805, -0.0465],
          ...,
          [-0.2569,  0.4722,  0.1711,  ..., -0.5191,  0.2815,  0.2580],
          [-0.3835, -0.4098,  0.4426,  ...,  0.1666, -0.0653, -0.4711],
          [-0.1230, -0.3888,  0.4589,  ...,  0.6446, -0.4854,  0.2157]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.3076,  0.3184,  0.1405,  ...,  0.0109, -1.1214, -0.1037],
         [ 0.1692,  0.1751,  0.0772,  ...,  0.5873, -0.2638,  0.2948],
         [-0.2248, -0.1991, -0.3269,  ...,  0.3319, -0.3667,  0.3580],
         [-0.4490, -0.2514, -0.3905,  ...,  0.3814, -0.3860,  0.3822]],

        [[ 1.0431,  0.2257, -0.3872,  ..., -0.0417, -1.0983,  0.6502],
         [ 0.6366,  0.0732, -0.7020,  ...,  0.6094, -0.5573,  0.1423],
         [ 0.5631, -0.0215, -0.5461,  ...,  0.4645, -0.3466,  0.1921],
         [ 0.4056,  0.0312, -0.6967,  ...,  0.6446, -0.4854,  0.2157]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1419, -0.4765, -0.4365,  ...,  0.0048, -0.2524,  0.1735],
         [ 0.0585, -0.3567, -0.1675,  ...,  0.1110, -0.2224, -0.0391],
         [-0.2104, -0.1800,  0.0401,  ..., -0.1814, -0.0233,  0.0197],
         [-0.2336, -0.2415, -0.0807,  ..., -0.0154,  0.1403, -0.0463]],

        [[ 0.4934, -0.2359, -0.3821,  ...,  0.1440, -0.2153, -0.2511],
         [ 0.2188, -0.1730, -0.0702,  ..., -0.0834, -0.3141,  0.0887],
         [ 0.2014, -0.0112, -0.1496,  ..., -0.0122, -0.2154,  0.1733],
         [ 0.1017, -0.0352, -0.1485,  ..., -0.0996, -0.1155, -0.0199]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.0886,    -inf,    -inf,    -inf],
          [-2.4973, -5.4527,    -inf,    -inf],
          [-0.1069, -0.0239, -3.8633,    -inf],
          [-1.1469,  3.3377,  1.5959,  1.1314]],

         [[-4.9688,    -inf,    -inf,    -inf],
          [-2.0843,  0.5713,    -inf,    -inf],
          [-0.2453, -2.5169, -2.9685,    -inf],
          [-2.5750, -1.8680, -2.4352,  1.1311]],

         [[ 1.3428,    -inf,    -inf,    -inf],
          [ 2.1799,  0.0568,    -inf,    -inf],
          [ 1.2211, -0.6195, -1.4863,    -inf],
          [ 2.2616,  1.8163, -0.5815, -0.5060]],

         [[ 1.4316,    -inf,    -inf,    -inf],
          [ 2.3847,  1.4880,    -inf,    -inf],
          [-1.0750,  0.6843, -0.0348,    -inf],
          [-4.5504,  1.6376, -2.0891, -0.6313]],

         [[ 2.0175,    -inf,    -inf,    -inf],
          [-0.2614,  1.6974,    -inf,    -inf],
          [ 1.5619,  1.3026,  1.7015,    -inf],
          [-2.7880, -1.4810, -0.9821, -1.0667]],

         [[-0.2038,    -inf,    -inf,    -inf],
          [-2.5113, -2.4672,    -inf,    -inf],
          [ 0.1642, -0.4517, -1.7399,    -inf],
          [-0.2759, -0.7674, -1.0680,  0.8578]],

         [[-0.5795,    -inf,    -inf,    -inf],
          [-0.6634, -0.7282,    -inf,    -inf],
          [ 2.8402, -0.6811,  0.8505,    -inf],
          [-0.3536,  3.8715,  1.8541, -0.9086]],

         [[-1.5555,    -inf,    -inf,    -inf],
          [-0.4073,  0.3189,    -inf,    -inf],
          [ 1.4199,  1.0708,  0.5957,    -inf],
          [ 4.4432,  4.1241,  1.3592, -0.2835]],

         [[ 0.5380,    -inf,    -inf,    -inf],
          [ 1.8936,  2.3252,    -inf,    -inf],
          [ 1.5897,  3.3815, -2.7588,    -inf],
          [ 4.1659,  2.9932, -0.9349, -0.2325]],

         [[ 1.0478,    -inf,    -inf,    -inf],
          [ 3.4985,  3.9544,    -inf,    -inf],
          [-0.9303,  0.5613,  3.2634,    -inf],
          [-3.2489, -1.1717,  3.1153, -4.1253]],

         [[ 3.3702,    -inf,    -inf,    -inf],
          [ 0.6160,  1.1487,    -inf,    -inf],
          [ 3.1341,  2.2397,  0.6963,    -inf],
          [-2.6079, -0.4442, -0.5112, -2.9439]],

         [[-0.9857,    -inf,    -inf,    -inf],
          [-0.6807,  0.8625,    -inf,    -inf],
          [-0.9924, -0.9064, -2.9904,    -inf],
          [ 2.0805,  3.4727,  4.0264,  5.7558]],

         [[ 0.0291,    -inf,    -inf,    -inf],
          [-2.5837, -2.3051,    -inf,    -inf],
          [ 4.3158,  1.7926,  2.7631,    -inf],
          [-1.7546,  3.7183,  2.5021,  1.3289]],

         [[ 1.2554,    -inf,    -inf,    -inf],
          [ 0.6407,  2.9724,    -inf,    -inf],
          [-1.3999, -1.1101,  0.6746,    -inf],
          [ 1.2085,  1.5771,  0.3763,  0.5090]],

         [[-3.3130,    -inf,    -inf,    -inf],
          [-3.7929,  0.5110,    -inf,    -inf],
          [ 1.0314, -2.4175,  3.6515,    -inf],
          [ 1.1891,  0.1367, -0.0240,  0.7920]],

         [[ 3.6342,    -inf,    -inf,    -inf],
          [ 3.7229,  2.6864,    -inf,    -inf],
          [ 0.0504,  2.8514,  0.8661,    -inf],
          [ 0.2857, -4.0559, -3.3876, -0.8836]],

         [[-1.8236,    -inf,    -inf,    -inf],
          [-3.2366, -3.0797,    -inf,    -inf],
          [ 0.4368,  1.5459, -0.9942,    -inf],
          [-4.7054, -2.4628,  0.2926, -1.2837]],

         [[ 2.8313,    -inf,    -inf,    -inf],
          [ 1.5188, -4.8122,    -inf,    -inf],
          [ 1.1607, -2.3120, -0.5633,    -inf],
          [ 3.8504, -0.3026, -0.7866, -2.7157]],

         [[ 0.2768,    -inf,    -inf,    -inf],
          [ 0.8891,  2.2649,    -inf,    -inf],
          [-2.3957, -0.1282, -1.9459,    -inf],
          [ 3.0118, -0.5656, -1.8306,  5.3858]],

         [[ 3.1747,    -inf,    -inf,    -inf],
          [ 1.5581,  0.8676,    -inf,    -inf],
          [ 1.8900,  3.1967,  1.3763,    -inf],
          [ 2.6198,  2.6767, -1.7623, -2.5857]],

         [[ 1.5713,    -inf,    -inf,    -inf],
          [ 4.5931,  3.2920,    -inf,    -inf],
          [ 5.6681, -0.8645,  4.6705,    -inf],
          [ 4.0030, -1.2402,  3.9701,  0.5848]],

         [[ 5.6540,    -inf,    -inf,    -inf],
          [-1.1194, -0.9181,    -inf,    -inf],
          [-1.9025, -1.4238,  2.5053,    -inf],
          [ 3.5671, -2.1969,  3.6559, -3.0460]],

         [[-3.5484,    -inf,    -inf,    -inf],
          [-0.7871, -3.0862,    -inf,    -inf],
          [ 0.1973,  1.2042, -3.1460,    -inf],
          [ 3.4444,  2.8031, -0.1158,  0.5256]],

         [[-1.6860,    -inf,    -inf,    -inf],
          [ 2.4649,  1.8115,    -inf,    -inf],
          [-0.5793,  2.3330,  0.4647,    -inf],
          [-0.2902, -1.8092, -3.2658, -0.7881]],

         [[-5.2213,    -inf,    -inf,    -inf],
          [ 0.5497, -2.1576,    -inf,    -inf],
          [-1.0765, -3.4957, -5.1663,    -inf],
          [-2.3815, -4.5807, -2.1550, -1.1866]]],


        [[[ 0.3421,    -inf,    -inf,    -inf],
          [-2.2168, -1.0451,    -inf,    -inf],
          [-2.2484, -0.8973, -1.7817,    -inf],
          [ 0.3999,  1.4671,  2.7469,  0.9603]],

         [[-5.1140,    -inf,    -inf,    -inf],
          [-0.7641,  1.3724,    -inf,    -inf],
          [-0.9073, -1.1871, -3.9112,    -inf],
          [ 2.0984,  1.7226, -2.7893, -0.7265]],

         [[-1.9355,    -inf,    -inf,    -inf],
          [ 1.3718, -0.8977,    -inf,    -inf],
          [-0.9408, -3.7072,  3.6175,    -inf],
          [ 0.2502, -2.5196, -1.0724, -2.6449]],

         [[ 4.1167,    -inf,    -inf,    -inf],
          [ 1.3396, -5.2248,    -inf,    -inf],
          [-0.1799, -1.5937, -0.1656,    -inf],
          [-4.4165, -1.8931,  3.1933,  2.7294]],

         [[ 3.7236,    -inf,    -inf,    -inf],
          [ 1.9049, -0.3179,    -inf,    -inf],
          [ 1.3841,  3.2111,  3.1980,    -inf],
          [-0.3514,  1.2005,  0.4022,  3.3944]],

         [[-2.9205,    -inf,    -inf,    -inf],
          [-2.0597,  2.2265,    -inf,    -inf],
          [ 5.8511,  6.3420,  4.9521,    -inf],
          [ 0.3624,  4.2386,  3.4946,  4.1794]],

         [[-1.3837,    -inf,    -inf,    -inf],
          [ 1.6558,  4.1271,    -inf,    -inf],
          [-3.3381,  2.0778, -0.1175,    -inf],
          [-6.4092, -0.0460,  1.1171, -1.2327]],

         [[-0.9535,    -inf,    -inf,    -inf],
          [ 1.9429, -1.6291,    -inf,    -inf],
          [-2.0418, -5.3975, -1.5363,    -inf],
          [ 2.3076, -0.1516,  3.3985,  2.0155]],

         [[ 3.9573,    -inf,    -inf,    -inf],
          [-0.3683,  1.1347,    -inf,    -inf],
          [-2.7373,  1.4460, -2.4842,    -inf],
          [-1.6893,  2.0659, -1.6066,  1.3056]],

         [[ 1.7033,    -inf,    -inf,    -inf],
          [-2.5515, -1.0925,    -inf,    -inf],
          [-0.4000, -2.2211, -0.5401,    -inf],
          [-5.2235, -4.4039,  2.5525, -2.4439]],

         [[ 5.7095,    -inf,    -inf,    -inf],
          [-2.2287, -2.6235,    -inf,    -inf],
          [-0.6600, -1.1342, -3.0043,    -inf],
          [-3.4373,  0.2390, -3.3889, -8.2102]],

         [[-4.3170,    -inf,    -inf,    -inf],
          [-3.2938, -1.7529,    -inf,    -inf],
          [ 1.2786,  2.5729,  0.9500,    -inf],
          [ 0.7248,  2.2194,  4.7051,  2.5626]],

         [[ 2.2342,    -inf,    -inf,    -inf],
          [ 1.0269, -0.4806,    -inf,    -inf],
          [ 4.7746,  1.7335,  1.1735,    -inf],
          [ 1.5066,  1.6852,  0.8604, -1.4216]],

         [[ 2.1582,    -inf,    -inf,    -inf],
          [ 0.7541, -0.8137,    -inf,    -inf],
          [ 2.4537,  1.4567,  2.8845,    -inf],
          [-1.7198, -2.1445, -0.4523, -0.2153]],

         [[-3.9990,    -inf,    -inf,    -inf],
          [-4.9987, -2.2401,    -inf,    -inf],
          [-7.8807, -6.1813, -5.6162,    -inf],
          [-7.4073, -2.8921, -1.9100, -4.9543]],

         [[ 3.8980,    -inf,    -inf,    -inf],
          [ 3.0047,  4.9329,    -inf,    -inf],
          [ 1.9245,  0.9542, -0.3784,    -inf],
          [ 2.1678,  2.3923, -0.0844,  3.3197]],

         [[ 0.4557,    -inf,    -inf,    -inf],
          [ 1.1854,  2.8938,    -inf,    -inf],
          [ 0.2015,  0.9679, -0.5301,    -inf],
          [-4.4376, -0.0778, -1.8053, -5.7701]],

         [[ 1.7181,    -inf,    -inf,    -inf],
          [-2.6645, -0.6305,    -inf,    -inf],
          [-1.1037,  1.6497, -3.9412,    -inf],
          [ 2.1442,  6.8910,  2.9265,  3.0820]],

         [[ 2.3012,    -inf,    -inf,    -inf],
          [-3.0970, -0.2529,    -inf,    -inf],
          [-1.0034, -0.7897, -3.5318,    -inf],
          [ 1.1368,  4.4321, -1.8582,  2.4688]],

         [[ 1.2850,    -inf,    -inf,    -inf],
          [ 1.9992, -3.5316,    -inf,    -inf],
          [-0.2240, -1.3056, -1.6344,    -inf],
          [ 0.7312, -1.4862,  3.3587,  1.5764]],

         [[ 0.7737,    -inf,    -inf,    -inf],
          [-1.4602,  2.3447,    -inf,    -inf],
          [ 2.5035,  4.4638,  4.4905,    -inf],
          [ 2.9555,  5.4377,  1.9341,  2.0409]],

         [[ 3.5562,    -inf,    -inf,    -inf],
          [ 0.4950,  1.1837,    -inf,    -inf],
          [-0.0722,  0.1191,  7.3613,    -inf],
          [-2.5124, -0.6675,  1.5652, -0.2759]],

         [[-4.8562,    -inf,    -inf,    -inf],
          [-6.4468,  0.0258,    -inf,    -inf],
          [ 1.1734, -0.5181,  0.8900,    -inf],
          [-0.7027,  2.2378,  2.1744, -0.1017]],

         [[ 1.0413,    -inf,    -inf,    -inf],
          [-2.7717,  1.2237,    -inf,    -inf],
          [-1.7902,  0.5491,  4.8365,    -inf],
          [ 2.4780,  4.3963, -0.5383,  1.6988]],

         [[-3.7035,    -inf,    -inf,    -inf],
          [-2.8243, -1.3613,    -inf,    -inf],
          [-0.6594, -0.8353,  1.4283,    -inf],
          [ 3.4254, -0.7354,  1.6026, -0.8924]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.0886,    -inf,    -inf,    -inf],
          [-2.4973, -5.4527,    -inf,    -inf],
          [-0.1069, -0.0239, -3.8633,    -inf],
          [-1.1469,  3.3377,  1.5959,  1.1314]],

         [[-4.9688,    -inf,    -inf,    -inf],
          [-2.0843,  0.5713,    -inf,    -inf],
          [-0.2453, -2.5169, -2.9685,    -inf],
          [-2.5750, -1.8680, -2.4352,  1.1311]],

         [[ 1.3428,    -inf,    -inf,    -inf],
          [ 2.1799,  0.0568,    -inf,    -inf],
          [ 1.2211, -0.6195, -1.4863,    -inf],
          [ 2.2616,  1.8163, -0.5815, -0.5060]],

         [[ 1.4316,    -inf,    -inf,    -inf],
          [ 2.3847,  1.4880,    -inf,    -inf],
          [-1.0750,  0.6843, -0.0348,    -inf],
          [-4.5504,  1.6376, -2.0891, -0.6313]],

         [[ 2.0175,    -inf,    -inf,    -inf],
          [-0.2614,  1.6974,    -inf,    -inf],
          [ 1.5619,  1.3026,  1.7015,    -inf],
          [-2.7880, -1.4810, -0.9821, -1.0667]],

         [[-0.2038,    -inf,    -inf,    -inf],
          [-2.5113, -2.4672,    -inf,    -inf],
          [ 0.1642, -0.4517, -1.7399,    -inf],
          [-0.2759, -0.7674, -1.0680,  0.8578]],

         [[-0.5795,    -inf,    -inf,    -inf],
          [-0.6634, -0.7282,    -inf,    -inf],
          [ 2.8402, -0.6811,  0.8505,    -inf],
          [-0.3536,  3.8715,  1.8541, -0.9086]],

         [[-1.5555,    -inf,    -inf,    -inf],
          [-0.4073,  0.3189,    -inf,    -inf],
          [ 1.4199,  1.0708,  0.5957,    -inf],
          [ 4.4432,  4.1241,  1.3592, -0.2835]],

         [[ 0.5380,    -inf,    -inf,    -inf],
          [ 1.8936,  2.3252,    -inf,    -inf],
          [ 1.5897,  3.3815, -2.7588,    -inf],
          [ 4.1659,  2.9932, -0.9349, -0.2325]],

         [[ 1.0478,    -inf,    -inf,    -inf],
          [ 3.4985,  3.9544,    -inf,    -inf],
          [-0.9303,  0.5613,  3.2634,    -inf],
          [-3.2489, -1.1717,  3.1153, -4.1253]],

         [[ 3.3702,    -inf,    -inf,    -inf],
          [ 0.6160,  1.1487,    -inf,    -inf],
          [ 3.1341,  2.2397,  0.6963,    -inf],
          [-2.6079, -0.4442, -0.5112, -2.9439]],

         [[-0.9857,    -inf,    -inf,    -inf],
          [-0.6807,  0.8625,    -inf,    -inf],
          [-0.9924, -0.9064, -2.9904,    -inf],
          [ 2.0805,  3.4727,  4.0264,  5.7558]],

         [[ 0.0291,    -inf,    -inf,    -inf],
          [-2.5837, -2.3051,    -inf,    -inf],
          [ 4.3158,  1.7926,  2.7631,    -inf],
          [-1.7546,  3.7183,  2.5021,  1.3289]],

         [[ 1.2554,    -inf,    -inf,    -inf],
          [ 0.6407,  2.9724,    -inf,    -inf],
          [-1.3999, -1.1101,  0.6746,    -inf],
          [ 1.2085,  1.5771,  0.3763,  0.5090]],

         [[-3.3130,    -inf,    -inf,    -inf],
          [-3.7929,  0.5110,    -inf,    -inf],
          [ 1.0314, -2.4175,  3.6515,    -inf],
          [ 1.1891,  0.1367, -0.0240,  0.7920]],

         [[ 3.6342,    -inf,    -inf,    -inf],
          [ 3.7229,  2.6864,    -inf,    -inf],
          [ 0.0504,  2.8514,  0.8661,    -inf],
          [ 0.2857, -4.0559, -3.3876, -0.8836]],

         [[-1.8236,    -inf,    -inf,    -inf],
          [-3.2366, -3.0797,    -inf,    -inf],
          [ 0.4368,  1.5459, -0.9942,    -inf],
          [-4.7054, -2.4628,  0.2926, -1.2837]],

         [[ 2.8313,    -inf,    -inf,    -inf],
          [ 1.5188, -4.8122,    -inf,    -inf],
          [ 1.1607, -2.3120, -0.5633,    -inf],
          [ 3.8504, -0.3026, -0.7866, -2.7157]],

         [[ 0.2768,    -inf,    -inf,    -inf],
          [ 0.8891,  2.2649,    -inf,    -inf],
          [-2.3957, -0.1282, -1.9459,    -inf],
          [ 3.0118, -0.5656, -1.8306,  5.3858]],

         [[ 3.1747,    -inf,    -inf,    -inf],
          [ 1.5581,  0.8676,    -inf,    -inf],
          [ 1.8900,  3.1967,  1.3763,    -inf],
          [ 2.6198,  2.6767, -1.7623, -2.5857]],

         [[ 1.5713,    -inf,    -inf,    -inf],
          [ 4.5931,  3.2920,    -inf,    -inf],
          [ 5.6681, -0.8645,  4.6705,    -inf],
          [ 4.0030, -1.2402,  3.9701,  0.5848]],

         [[ 5.6540,    -inf,    -inf,    -inf],
          [-1.1194, -0.9181,    -inf,    -inf],
          [-1.9025, -1.4238,  2.5053,    -inf],
          [ 3.5671, -2.1969,  3.6559, -3.0460]],

         [[-3.5484,    -inf,    -inf,    -inf],
          [-0.7871, -3.0862,    -inf,    -inf],
          [ 0.1973,  1.2042, -3.1460,    -inf],
          [ 3.4444,  2.8031, -0.1158,  0.5256]],

         [[-1.6860,    -inf,    -inf,    -inf],
          [ 2.4649,  1.8115,    -inf,    -inf],
          [-0.5793,  2.3330,  0.4647,    -inf],
          [-0.2902, -1.8092, -3.2658, -0.7881]],

         [[-5.2213,    -inf,    -inf,    -inf],
          [ 0.5497, -2.1576,    -inf,    -inf],
          [-1.0765, -3.4957, -5.1663,    -inf],
          [-2.3815, -4.5807, -2.1550, -1.1866]]],


        [[[ 0.3421,    -inf,    -inf,    -inf],
          [-2.2168, -1.0451,    -inf,    -inf],
          [-2.2484, -0.8973, -1.7817,    -inf],
          [ 0.3999,  1.4671,  2.7469,  0.9603]],

         [[-5.1140,    -inf,    -inf,    -inf],
          [-0.7641,  1.3724,    -inf,    -inf],
          [-0.9073, -1.1871, -3.9112,    -inf],
          [ 2.0984,  1.7226, -2.7893, -0.7265]],

         [[-1.9355,    -inf,    -inf,    -inf],
          [ 1.3718, -0.8977,    -inf,    -inf],
          [-0.9408, -3.7072,  3.6175,    -inf],
          [ 0.2502, -2.5196, -1.0724, -2.6449]],

         [[ 4.1167,    -inf,    -inf,    -inf],
          [ 1.3396, -5.2248,    -inf,    -inf],
          [-0.1799, -1.5937, -0.1656,    -inf],
          [-4.4165, -1.8931,  3.1933,  2.7294]],

         [[ 3.7236,    -inf,    -inf,    -inf],
          [ 1.9049, -0.3179,    -inf,    -inf],
          [ 1.3841,  3.2111,  3.1980,    -inf],
          [-0.3514,  1.2005,  0.4022,  3.3944]],

         [[-2.9205,    -inf,    -inf,    -inf],
          [-2.0597,  2.2265,    -inf,    -inf],
          [ 5.8511,  6.3420,  4.9521,    -inf],
          [ 0.3624,  4.2386,  3.4946,  4.1794]],

         [[-1.3837,    -inf,    -inf,    -inf],
          [ 1.6558,  4.1271,    -inf,    -inf],
          [-3.3381,  2.0778, -0.1175,    -inf],
          [-6.4092, -0.0460,  1.1171, -1.2327]],

         [[-0.9535,    -inf,    -inf,    -inf],
          [ 1.9429, -1.6291,    -inf,    -inf],
          [-2.0418, -5.3975, -1.5363,    -inf],
          [ 2.3076, -0.1516,  3.3985,  2.0155]],

         [[ 3.9573,    -inf,    -inf,    -inf],
          [-0.3683,  1.1347,    -inf,    -inf],
          [-2.7373,  1.4460, -2.4842,    -inf],
          [-1.6893,  2.0659, -1.6066,  1.3056]],

         [[ 1.7033,    -inf,    -inf,    -inf],
          [-2.5515, -1.0925,    -inf,    -inf],
          [-0.4000, -2.2211, -0.5401,    -inf],
          [-5.2235, -4.4039,  2.5525, -2.4439]],

         [[ 5.7095,    -inf,    -inf,    -inf],
          [-2.2287, -2.6235,    -inf,    -inf],
          [-0.6600, -1.1342, -3.0043,    -inf],
          [-3.4373,  0.2390, -3.3889, -8.2102]],

         [[-4.3170,    -inf,    -inf,    -inf],
          [-3.2938, -1.7529,    -inf,    -inf],
          [ 1.2786,  2.5729,  0.9500,    -inf],
          [ 0.7248,  2.2194,  4.7051,  2.5626]],

         [[ 2.2342,    -inf,    -inf,    -inf],
          [ 1.0269, -0.4806,    -inf,    -inf],
          [ 4.7746,  1.7335,  1.1735,    -inf],
          [ 1.5066,  1.6852,  0.8604, -1.4216]],

         [[ 2.1582,    -inf,    -inf,    -inf],
          [ 0.7541, -0.8137,    -inf,    -inf],
          [ 2.4537,  1.4567,  2.8845,    -inf],
          [-1.7198, -2.1445, -0.4523, -0.2153]],

         [[-3.9990,    -inf,    -inf,    -inf],
          [-4.9987, -2.2401,    -inf,    -inf],
          [-7.8807, -6.1813, -5.6162,    -inf],
          [-7.4073, -2.8921, -1.9100, -4.9543]],

         [[ 3.8980,    -inf,    -inf,    -inf],
          [ 3.0047,  4.9329,    -inf,    -inf],
          [ 1.9245,  0.9542, -0.3784,    -inf],
          [ 2.1678,  2.3923, -0.0844,  3.3197]],

         [[ 0.4557,    -inf,    -inf,    -inf],
          [ 1.1854,  2.8938,    -inf,    -inf],
          [ 0.2015,  0.9679, -0.5301,    -inf],
          [-4.4376, -0.0778, -1.8053, -5.7701]],

         [[ 1.7181,    -inf,    -inf,    -inf],
          [-2.6645, -0.6305,    -inf,    -inf],
          [-1.1037,  1.6497, -3.9412,    -inf],
          [ 2.1442,  6.8910,  2.9265,  3.0820]],

         [[ 2.3012,    -inf,    -inf,    -inf],
          [-3.0970, -0.2529,    -inf,    -inf],
          [-1.0034, -0.7897, -3.5318,    -inf],
          [ 1.1368,  4.4321, -1.8582,  2.4688]],

         [[ 1.2850,    -inf,    -inf,    -inf],
          [ 1.9992, -3.5316,    -inf,    -inf],
          [-0.2240, -1.3056, -1.6344,    -inf],
          [ 0.7312, -1.4862,  3.3587,  1.5764]],

         [[ 0.7737,    -inf,    -inf,    -inf],
          [-1.4602,  2.3447,    -inf,    -inf],
          [ 2.5035,  4.4638,  4.4905,    -inf],
          [ 2.9555,  5.4377,  1.9341,  2.0409]],

         [[ 3.5562,    -inf,    -inf,    -inf],
          [ 0.4950,  1.1837,    -inf,    -inf],
          [-0.0722,  0.1191,  7.3613,    -inf],
          [-2.5124, -0.6675,  1.5652, -0.2759]],

         [[-4.8562,    -inf,    -inf,    -inf],
          [-6.4468,  0.0258,    -inf,    -inf],
          [ 1.1734, -0.5181,  0.8900,    -inf],
          [-0.7027,  2.2378,  2.1744, -0.1017]],

         [[ 1.0413,    -inf,    -inf,    -inf],
          [-2.7717,  1.2237,    -inf,    -inf],
          [-1.7902,  0.5491,  4.8365,    -inf],
          [ 2.4780,  4.3963, -0.5383,  1.6988]],

         [[-3.7035,    -inf,    -inf,    -inf],
          [-2.8243, -1.3613,    -inf,    -inf],
          [-0.6594, -0.8353,  1.4283,    -inf],
          [ 3.4254, -0.7354,  1.6026, -0.8924]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.7887,  0.3315,  0.3442,  ..., -0.0842,  0.3122,  0.4815],
          [-0.1184, -0.0827,  0.0433,  ..., -0.0953,  0.0727, -0.0467],
          [ 0.2796,  0.1966,  1.4580,  ..., -0.2958,  0.4873,  0.5457],
          ...,
          [ 0.6331, -0.1259,  0.3196,  ...,  0.3517, -0.0475, -0.5468],
          [-1.2347,  0.3938, -1.3989,  ..., -1.0648,  0.0818,  0.1231],
          [ 0.5700,  0.6630,  0.2058,  ..., -0.3614, -0.7661,  1.0648]],

         [[ 0.8276,  0.0311,  0.2555,  ...,  0.1784,  0.0961,  0.7110],
          [-0.1418, -0.2642, -0.5289,  ...,  0.4526,  0.4644,  0.1381],
          [ 0.1692,  0.0189,  1.5068,  ...,  0.0118,  0.4629,  0.6740],
          ...,
          [ 0.6907,  0.0994, -0.1256,  ..., -0.0527, -0.0384, -0.7496],
          [-0.6264,  0.3880, -1.3402,  ..., -0.4591, -0.0038,  0.1904],
          [ 0.3328,  0.3870,  0.1202,  ..., -0.2110, -0.4472,  0.6216]],

         [[ 0.6770, -0.2859, -0.0532,  ..., -0.0751,  0.1620,  0.7958],
          [-0.0822,  0.1383, -0.3431,  ...,  0.2968,  0.1450,  0.0562],
          [ 0.1195,  0.0110,  1.0791,  ...,  0.0128,  0.3309,  0.4842],
          ...,
          [ 0.5375,  0.1336, -0.0929,  ..., -0.2427, -0.0397, -0.7340],
          [-0.0374,  0.0954, -0.4955,  ..., -0.3595,  0.1662,  0.1832],
          [-0.0276,  0.4278,  0.1203,  ..., -0.2972, -0.5655,  1.0143]],

         [[ 0.5076, -0.4129, -0.0716,  ..., -0.0689,  0.1321,  0.7286],
          [ 0.0304,  0.0526, -0.3575,  ...,  0.3720, -0.0637,  0.1222],
          [ 0.1066,  0.1958,  0.9271,  ..., -0.0106,  0.2405,  0.4469],
          ...,
          [ 0.4040,  0.2963,  0.0878,  ..., -0.3399,  0.0200, -0.6354],
          [-0.7307, -0.0587, -0.9005,  ..., -0.6276,  0.3400,  0.3019],
          [ 0.0375,  0.2323,  0.0963,  ..., -0.0211, -0.2777,  0.5515]]],


        [[[ 1.3727,  0.0678,  0.4318,  ..., -0.1682, -0.4966,  0.2210],
          [ 0.6000,  1.3411, -0.3542,  ..., -0.3784,  0.0482,  0.4301],
          [ 0.2386,  0.2734,  0.6377,  ..., -0.0252,  0.4859,  0.8152],
          ...,
          [ 0.2901,  0.5140,  0.5479,  ..., -0.5886,  0.3694, -0.8555],
          [-1.3020, -0.0127, -1.1857,  ..., -0.8549, -0.7731,  0.7702],
          [ 0.2788,  1.0340, -0.0695,  ..., -1.0328, -0.6556,  0.7075]],

         [[ 0.9273,  0.4015,  0.4133,  ...,  0.2521, -0.3965,  0.1234],
          [ 0.4363,  1.0640, -0.7153,  ..., -0.6463,  0.1597,  0.3970],
          [ 0.1761, -0.0733,  0.7008,  ...,  0.2518,  0.3318,  0.9196],
          ...,
          [ 0.2915, -0.2038,  0.4288,  ..., -0.3731,  0.4996, -1.3700],
          [-0.7307,  0.4588, -0.9461,  ..., -0.2616, -0.5673,  0.7557],
          [ 0.0622,  1.1023, -0.3171,  ..., -0.5370, -0.6132,  0.7611]],

         [[ 0.6416, -0.0049, -0.0388,  ..., -0.1513, -0.0488,  0.3187],
          [ 0.4691,  1.0319, -0.8859,  ..., -0.7327,  0.0594,  0.1639],
          [ 0.0157, -0.2521,  0.0767,  ..., -0.1043,  0.0437,  0.9812],
          ...,
          [ 0.2337,  0.2802,  0.1149,  ..., -0.0829,  0.1206, -0.8692],
          [-0.4830,  0.0271, -0.5301,  ..., -0.5777, -0.2562,  0.6800],
          [ 0.2596,  0.2213,  0.1462,  ..., -0.2853, -0.0074,  0.6456]],

         [[ 0.3797, -0.1416, -0.0655,  ...,  0.1770, -0.1178,  0.2333],
          [ 0.4601,  0.5808, -0.5671,  ..., -0.6188,  0.0166,  0.1562],
          [-0.0023, -0.2640,  0.4994,  ..., -0.1179,  0.1316,  0.8937],
          ...,
          [ 0.3734,  0.0285,  0.1809,  ...,  0.0484,  0.0207, -0.8040],
          [-0.6771,  0.1983, -0.5575,  ..., -0.3191, -0.1841,  0.8688],
          [ 0.1930,  0.3898,  0.2293,  ..., -0.3253, -0.1909,  0.6846]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.7887,  0.3315,  0.3442,  ..., -0.3614, -0.7661,  1.0648],
         [ 0.8276,  0.0311,  0.2555,  ..., -0.2110, -0.4472,  0.6216],
         [ 0.6770, -0.2859, -0.0532,  ..., -0.2972, -0.5655,  1.0143],
         [ 0.5076, -0.4129, -0.0716,  ..., -0.0211, -0.2777,  0.5515]],

        [[ 1.3727,  0.0678,  0.4318,  ..., -1.0328, -0.6556,  0.7075],
         [ 0.9273,  0.4015,  0.4133,  ..., -0.5370, -0.6132,  0.7611],
         [ 0.6416, -0.0049, -0.0388,  ..., -0.2853, -0.0074,  0.6456],
         [ 0.3797, -0.1416, -0.0655,  ..., -0.3253, -0.1909,  0.6846]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1998, -0.0008, -0.1650,  ...,  0.1549,  0.1468,  0.0352],
         [ 0.1115,  0.1998,  0.0644,  ...,  0.1611,  0.0216, -0.1755],
         [ 0.2760,  0.1481,  0.1151,  ...,  0.2073, -0.4078, -0.3012],
         [ 0.1905,  0.2715, -0.0654,  ...,  0.2004, -0.3159, -0.0577]],

        [[-0.0636, -0.1137, -0.2283,  ...,  0.3893,  0.0857, -0.4930],
         [-0.1330,  0.0034, -0.0513,  ...,  0.2330, -0.2786, -0.3849],
         [-0.1782,  0.2385, -0.1164,  ...,  0.1476, -0.2075, -0.2741],
         [ 0.0171,  0.2523, -0.1876,  ...,  0.1034, -0.3572, -0.2383]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.3126,    -inf,    -inf,    -inf],
          [ 1.6416,  4.3506,    -inf,    -inf],
          [ 0.1158,  5.5829,  1.4855,    -inf],
          [-0.7503, -3.1077,  0.9791, -0.2973]],

         [[-0.5113,    -inf,    -inf,    -inf],
          [-1.9073,  0.2447,    -inf,    -inf],
          [ 0.2343,  1.7900, -0.3663,    -inf],
          [-0.1806,  1.7749,  1.1958, -4.1617]],

         [[ 0.8552,    -inf,    -inf,    -inf],
          [-2.4193, -2.4074,    -inf,    -inf],
          [ 0.5104, -3.3506, -4.2601,    -inf],
          [-0.5039, -2.1123, -0.0924, -0.3850]],

         [[ 3.8431,    -inf,    -inf,    -inf],
          [ 3.0436, -1.4531,    -inf,    -inf],
          [ 1.2697, -1.9463,  0.1328,    -inf],
          [-1.7802,  2.2974,  2.8574,  0.9324]],

         [[-0.4224,    -inf,    -inf,    -inf],
          [-1.7253,  1.7196,    -inf,    -inf],
          [ 1.3801, -0.7407,  3.0999,    -inf],
          [ 3.0720, -2.2805,  2.2623,  4.4406]],

         [[-1.9663,    -inf,    -inf,    -inf],
          [-0.2156, -4.0301,    -inf,    -inf],
          [ 1.8256, -1.3972,  0.1010,    -inf],
          [ 0.1589, -0.6642,  0.0481, -0.7676]],

         [[ 0.7222,    -inf,    -inf,    -inf],
          [-0.9229,  4.9024,    -inf,    -inf],
          [-1.9930, -2.2570, -3.9714,    -inf],
          [ 4.2510,  1.5281,  2.7061,  0.1783]],

         [[-1.5148,    -inf,    -inf,    -inf],
          [-0.0409, -2.9840,    -inf,    -inf],
          [ 0.7166, -1.1459,  4.8459,    -inf],
          [-0.7544, -1.0142,  2.9379,  0.0245]],

         [[-3.3613,    -inf,    -inf,    -inf],
          [-4.2895, -1.9985,    -inf,    -inf],
          [-3.7285, -2.3312, -2.2068,    -inf],
          [-1.2877, -0.0791,  1.4933,  1.7279]],

         [[ 7.1872,    -inf,    -inf,    -inf],
          [ 2.6228,  5.2299,    -inf,    -inf],
          [ 0.5259, -0.1640, -4.2924,    -inf],
          [-0.2553,  0.1437, -0.5051, -1.3933]],

         [[-2.5906,    -inf,    -inf,    -inf],
          [-3.1891,  3.5728,    -inf,    -inf],
          [ 0.1948,  2.2223,  5.2363,    -inf],
          [-5.0447,  2.0141,  1.4230,  2.1861]],

         [[ 1.5896,    -inf,    -inf,    -inf],
          [ 0.5878,  0.2056,    -inf,    -inf],
          [ 0.8925, -3.2589, -2.1544,    -inf],
          [ 0.4848, -1.9517,  5.4881,  7.4277]],

         [[-0.9531,    -inf,    -inf,    -inf],
          [ 1.0429, -3.4286,    -inf,    -inf],
          [ 2.7773, -5.8310, -2.7132,    -inf],
          [-3.1484, -5.0628, -5.3218, -8.2663]],

         [[ 2.1392,    -inf,    -inf,    -inf],
          [ 1.0905,  2.7584,    -inf,    -inf],
          [ 5.3254,  0.1990,  1.7211,    -inf],
          [-1.4062,  3.5842,  0.8576,  3.7563]],

         [[-3.6596,    -inf,    -inf,    -inf],
          [-5.7230, -4.2150,    -inf,    -inf],
          [-1.7808, -3.3927,  1.8907,    -inf],
          [ 0.1624, -1.3194,  1.0506, -2.9916]],

         [[-0.5280,    -inf,    -inf,    -inf],
          [-0.7129,  1.5843,    -inf,    -inf],
          [-3.4596, -2.1582, -3.2262,    -inf],
          [-3.5186, -1.4271,  0.2214,  2.4873]],

         [[-2.4669,    -inf,    -inf,    -inf],
          [ 3.0608, -3.9309,    -inf,    -inf],
          [-0.2333, -0.6760, -2.4949,    -inf],
          [ 0.4620, -1.1299, -2.2069,  0.8309]],

         [[ 1.8110,    -inf,    -inf,    -inf],
          [-5.4547, -3.8013,    -inf,    -inf],
          [-0.5862,  0.0349, -1.8069,    -inf],
          [-1.9511, -2.5096, -2.8039, -3.6681]],

         [[-2.9513,    -inf,    -inf,    -inf],
          [-4.0897,  2.0958,    -inf,    -inf],
          [-4.3989, -1.8156, -1.9072,    -inf],
          [-2.5588, -4.1142, -0.8765, -5.0736]],

         [[ 2.6326,    -inf,    -inf,    -inf],
          [ 1.6231,  6.4393,    -inf,    -inf],
          [ 2.2924,  3.7996,  1.9172,    -inf],
          [-1.2415,  2.6772, -1.0280,  1.2460]],

         [[ 2.9294,    -inf,    -inf,    -inf],
          [ 9.0885,  3.0664,    -inf,    -inf],
          [ 0.7688, -4.1886, -2.3910,    -inf],
          [-0.6644,  1.0419, -0.6105,  3.0189]],

         [[-1.2124,    -inf,    -inf,    -inf],
          [ 2.2119,  2.8363,    -inf,    -inf],
          [-0.5373,  2.8833,  1.1030,    -inf],
          [-0.6258,  1.5890,  0.7863, -0.5621]],

         [[-1.5424,    -inf,    -inf,    -inf],
          [ 4.2270,  2.9015,    -inf,    -inf],
          [-1.3796,  0.3211, -2.5080,    -inf],
          [ 0.7435, -2.4002, -3.4393, -0.5607]],

         [[ 0.0228,    -inf,    -inf,    -inf],
          [-4.5044, -1.3561,    -inf,    -inf],
          [-1.5350,  0.0292,  3.8209,    -inf],
          [-2.0040,  1.8306,  3.6498, -1.6720]],

         [[-0.6873,    -inf,    -inf,    -inf],
          [-2.3627, -5.1630,    -inf,    -inf],
          [ 0.2116,  0.6726,  0.9600,    -inf],
          [ 0.0920, -2.9226, -1.2323,  2.8212]]],


        [[[ 1.1974,    -inf,    -inf,    -inf],
          [-0.9329, -5.3131,    -inf,    -inf],
          [ 2.6770,  0.0573, -0.7984,    -inf],
          [-1.6736, -2.1258, -4.3756, -4.1101]],

         [[-0.5704,    -inf,    -inf,    -inf],
          [ 0.7673,  1.3975,    -inf,    -inf],
          [ 3.5403,  0.1415,  3.7018,    -inf],
          [-2.9555, -0.9981, -2.0949, -1.5679]],

         [[ 1.0657,    -inf,    -inf,    -inf],
          [ 3.8801,  1.4351,    -inf,    -inf],
          [ 5.3963, -1.1903,  0.8470,    -inf],
          [ 2.9911, -0.7578,  8.2304, -2.3930]],

         [[ 2.5565,    -inf,    -inf,    -inf],
          [ 2.8525, -1.7259,    -inf,    -inf],
          [-2.1441,  1.0903,  0.1592,    -inf],
          [ 1.5190, -0.8154, -1.1280, -1.9209]],

         [[ 1.6166,    -inf,    -inf,    -inf],
          [-4.0612,  2.6967,    -inf,    -inf],
          [-1.0817, -0.0904,  4.9295,    -inf],
          [-4.1715, -1.9168, -2.9663, -2.0914]],

         [[-0.1534,    -inf,    -inf,    -inf],
          [ 2.9879, -0.2894,    -inf,    -inf],
          [ 0.4811, -2.5104, -2.2412,    -inf],
          [ 0.5770,  1.7902,  1.8807,  3.8551]],

         [[-1.0166,    -inf,    -inf,    -inf],
          [-2.8308,  1.0981,    -inf,    -inf],
          [-6.2289, -1.3422, -1.9899,    -inf],
          [ 1.2246,  0.1563,  0.1962,  7.3960]],

         [[-1.7886,    -inf,    -inf,    -inf],
          [ 1.5105,  1.9915,    -inf,    -inf],
          [ 1.2081,  0.9405,  4.2522,    -inf],
          [-0.1352, -1.7681,  0.7569, -3.0568]],

         [[-0.8106,    -inf,    -inf,    -inf],
          [-3.6914, -0.0102,    -inf,    -inf],
          [-2.3302, -3.8581, -2.3401,    -inf],
          [-3.3793, -3.5022, -4.1104, -3.7141]],

         [[ 3.5461,    -inf,    -inf,    -inf],
          [-0.6000,  3.2287,    -inf,    -inf],
          [-0.1564, -0.6381, -1.5934,    -inf],
          [ 2.2185, -0.0647,  1.1968,  2.2389]],

         [[ 0.8240,    -inf,    -inf,    -inf],
          [-1.7127,  3.0215,    -inf,    -inf],
          [ 0.1338,  2.8929,  8.1074,    -inf],
          [-1.4951,  5.4356, -1.3633,  0.9788]],

         [[ 1.4376,    -inf,    -inf,    -inf],
          [ 0.4314,  1.1105,    -inf,    -inf],
          [ 2.6741, -0.9650, -1.7009,    -inf],
          [ 0.4196, -1.4122, -0.1224,  0.3517]],

         [[-2.7696,    -inf,    -inf,    -inf],
          [-0.3127,  2.3807,    -inf,    -inf],
          [ 1.4632, -1.5671, -2.0881,    -inf],
          [-0.1595, -0.1460, -1.2211, -2.2766]],

         [[-0.2429,    -inf,    -inf,    -inf],
          [ 0.2577,  6.1903,    -inf,    -inf],
          [ 2.4227,  2.4498,  1.5310,    -inf],
          [-1.5484,  1.3879,  1.2002, -0.8366]],

         [[-5.3419,    -inf,    -inf,    -inf],
          [-3.0921, -3.2795,    -inf,    -inf],
          [ 0.2554,  1.4991,  3.9947,    -inf],
          [ 0.6185,  3.2521, -0.9974, -0.0608]],

         [[-3.3871,    -inf,    -inf,    -inf],
          [-0.4274, -0.7925,    -inf,    -inf],
          [-2.8087, -2.8300,  1.1581,    -inf],
          [-0.5220, -3.1171, -1.7350,  3.7991]],

         [[ 3.3017,    -inf,    -inf,    -inf],
          [ 5.1797, -2.1484,    -inf,    -inf],
          [ 3.4563,  2.4346, -1.1799,    -inf],
          [ 2.3227, -3.6659, -2.1362,  1.8195]],

         [[ 1.6980,    -inf,    -inf,    -inf],
          [-0.3497, -0.8338,    -inf,    -inf],
          [ 0.6341,  3.1416,  2.1019,    -inf],
          [-3.7522,  3.8742, -1.5862, -4.3537]],

         [[-0.1829,    -inf,    -inf,    -inf],
          [-0.7657, -3.1638,    -inf,    -inf],
          [-1.5543,  0.9796,  3.1304,    -inf],
          [-7.2055, -6.1620, -3.4648, -3.5293]],

         [[-0.0847,    -inf,    -inf,    -inf],
          [ 1.5557, -1.0843,    -inf,    -inf],
          [-0.6854, -2.0872, -0.5729,    -inf],
          [ 0.0385, -3.3092, -1.1968, -7.2157]],

         [[-3.2378,    -inf,    -inf,    -inf],
          [ 2.1816, -1.9260,    -inf,    -inf],
          [-0.1477, -6.4524, -4.8304,    -inf],
          [-3.3063, -1.2692,  2.7871,  1.3513]],

         [[-0.7030,    -inf,    -inf,    -inf],
          [-0.3133, -0.8459,    -inf,    -inf],
          [-0.7388, -1.4241, -1.8268,    -inf],
          [-1.8875, -2.0377, -2.9605, -4.0101]],

         [[-3.4517,    -inf,    -inf,    -inf],
          [ 2.4290,  6.0822,    -inf,    -inf],
          [ 0.6394,  5.2701,  2.6243,    -inf],
          [ 2.2888,  5.2019,  1.2949,  2.6299]],

         [[ 1.0565,    -inf,    -inf,    -inf],
          [ 0.5913,  2.1801,    -inf,    -inf],
          [ 2.7063, -1.2230, -0.9722,    -inf],
          [-3.4273, -2.2800, -0.8455, -3.8176]],

         [[-1.9806,    -inf,    -inf,    -inf],
          [-9.8092, -5.8488,    -inf,    -inf],
          [-4.5483, -2.4568, -0.2685,    -inf],
          [ 0.7340,  0.3747,  0.8530,  2.5205]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.3126,    -inf,    -inf,    -inf],
          [ 1.6416,  4.3506,    -inf,    -inf],
          [ 0.1158,  5.5829,  1.4855,    -inf],
          [-0.7503, -3.1077,  0.9791, -0.2973]],

         [[-0.5113,    -inf,    -inf,    -inf],
          [-1.9073,  0.2447,    -inf,    -inf],
          [ 0.2343,  1.7900, -0.3663,    -inf],
          [-0.1806,  1.7749,  1.1958, -4.1617]],

         [[ 0.8552,    -inf,    -inf,    -inf],
          [-2.4193, -2.4074,    -inf,    -inf],
          [ 0.5104, -3.3506, -4.2601,    -inf],
          [-0.5039, -2.1123, -0.0924, -0.3850]],

         [[ 3.8431,    -inf,    -inf,    -inf],
          [ 3.0436, -1.4531,    -inf,    -inf],
          [ 1.2697, -1.9463,  0.1328,    -inf],
          [-1.7802,  2.2974,  2.8574,  0.9324]],

         [[-0.4224,    -inf,    -inf,    -inf],
          [-1.7253,  1.7196,    -inf,    -inf],
          [ 1.3801, -0.7407,  3.0999,    -inf],
          [ 3.0720, -2.2805,  2.2623,  4.4406]],

         [[-1.9663,    -inf,    -inf,    -inf],
          [-0.2156, -4.0301,    -inf,    -inf],
          [ 1.8256, -1.3972,  0.1010,    -inf],
          [ 0.1589, -0.6642,  0.0481, -0.7676]],

         [[ 0.7222,    -inf,    -inf,    -inf],
          [-0.9229,  4.9024,    -inf,    -inf],
          [-1.9930, -2.2570, -3.9714,    -inf],
          [ 4.2510,  1.5281,  2.7061,  0.1783]],

         [[-1.5148,    -inf,    -inf,    -inf],
          [-0.0409, -2.9840,    -inf,    -inf],
          [ 0.7166, -1.1459,  4.8459,    -inf],
          [-0.7544, -1.0142,  2.9379,  0.0245]],

         [[-3.3613,    -inf,    -inf,    -inf],
          [-4.2895, -1.9985,    -inf,    -inf],
          [-3.7285, -2.3312, -2.2068,    -inf],
          [-1.2877, -0.0791,  1.4933,  1.7279]],

         [[ 7.1872,    -inf,    -inf,    -inf],
          [ 2.6228,  5.2299,    -inf,    -inf],
          [ 0.5259, -0.1640, -4.2924,    -inf],
          [-0.2553,  0.1437, -0.5051, -1.3933]],

         [[-2.5906,    -inf,    -inf,    -inf],
          [-3.1891,  3.5728,    -inf,    -inf],
          [ 0.1948,  2.2223,  5.2363,    -inf],
          [-5.0447,  2.0141,  1.4230,  2.1861]],

         [[ 1.5896,    -inf,    -inf,    -inf],
          [ 0.5878,  0.2056,    -inf,    -inf],
          [ 0.8925, -3.2589, -2.1544,    -inf],
          [ 0.4848, -1.9517,  5.4881,  7.4277]],

         [[-0.9531,    -inf,    -inf,    -inf],
          [ 1.0429, -3.4286,    -inf,    -inf],
          [ 2.7773, -5.8310, -2.7132,    -inf],
          [-3.1484, -5.0628, -5.3218, -8.2663]],

         [[ 2.1392,    -inf,    -inf,    -inf],
          [ 1.0905,  2.7584,    -inf,    -inf],
          [ 5.3254,  0.1990,  1.7211,    -inf],
          [-1.4062,  3.5842,  0.8576,  3.7563]],

         [[-3.6596,    -inf,    -inf,    -inf],
          [-5.7230, -4.2150,    -inf,    -inf],
          [-1.7808, -3.3927,  1.8907,    -inf],
          [ 0.1624, -1.3194,  1.0506, -2.9916]],

         [[-0.5280,    -inf,    -inf,    -inf],
          [-0.7129,  1.5843,    -inf,    -inf],
          [-3.4596, -2.1582, -3.2262,    -inf],
          [-3.5186, -1.4271,  0.2214,  2.4873]],

         [[-2.4669,    -inf,    -inf,    -inf],
          [ 3.0608, -3.9309,    -inf,    -inf],
          [-0.2333, -0.6760, -2.4949,    -inf],
          [ 0.4620, -1.1299, -2.2069,  0.8309]],

         [[ 1.8110,    -inf,    -inf,    -inf],
          [-5.4547, -3.8013,    -inf,    -inf],
          [-0.5862,  0.0349, -1.8069,    -inf],
          [-1.9511, -2.5096, -2.8039, -3.6681]],

         [[-2.9513,    -inf,    -inf,    -inf],
          [-4.0897,  2.0958,    -inf,    -inf],
          [-4.3989, -1.8156, -1.9072,    -inf],
          [-2.5588, -4.1142, -0.8765, -5.0736]],

         [[ 2.6326,    -inf,    -inf,    -inf],
          [ 1.6231,  6.4393,    -inf,    -inf],
          [ 2.2924,  3.7996,  1.9172,    -inf],
          [-1.2415,  2.6772, -1.0280,  1.2460]],

         [[ 2.9294,    -inf,    -inf,    -inf],
          [ 9.0885,  3.0664,    -inf,    -inf],
          [ 0.7688, -4.1886, -2.3910,    -inf],
          [-0.6644,  1.0419, -0.6105,  3.0189]],

         [[-1.2124,    -inf,    -inf,    -inf],
          [ 2.2119,  2.8363,    -inf,    -inf],
          [-0.5373,  2.8833,  1.1030,    -inf],
          [-0.6258,  1.5890,  0.7863, -0.5621]],

         [[-1.5424,    -inf,    -inf,    -inf],
          [ 4.2270,  2.9015,    -inf,    -inf],
          [-1.3796,  0.3211, -2.5080,    -inf],
          [ 0.7435, -2.4002, -3.4393, -0.5607]],

         [[ 0.0228,    -inf,    -inf,    -inf],
          [-4.5044, -1.3561,    -inf,    -inf],
          [-1.5350,  0.0292,  3.8209,    -inf],
          [-2.0040,  1.8306,  3.6498, -1.6720]],

         [[-0.6873,    -inf,    -inf,    -inf],
          [-2.3627, -5.1630,    -inf,    -inf],
          [ 0.2116,  0.6726,  0.9600,    -inf],
          [ 0.0920, -2.9226, -1.2323,  2.8212]]],


        [[[ 1.1974,    -inf,    -inf,    -inf],
          [-0.9329, -5.3131,    -inf,    -inf],
          [ 2.6770,  0.0573, -0.7984,    -inf],
          [-1.6736, -2.1258, -4.3756, -4.1101]],

         [[-0.5704,    -inf,    -inf,    -inf],
          [ 0.7673,  1.3975,    -inf,    -inf],
          [ 3.5403,  0.1415,  3.7018,    -inf],
          [-2.9555, -0.9981, -2.0949, -1.5679]],

         [[ 1.0657,    -inf,    -inf,    -inf],
          [ 3.8801,  1.4351,    -inf,    -inf],
          [ 5.3963, -1.1903,  0.8470,    -inf],
          [ 2.9911, -0.7578,  8.2304, -2.3930]],

         [[ 2.5565,    -inf,    -inf,    -inf],
          [ 2.8525, -1.7259,    -inf,    -inf],
          [-2.1441,  1.0903,  0.1592,    -inf],
          [ 1.5190, -0.8154, -1.1280, -1.9209]],

         [[ 1.6166,    -inf,    -inf,    -inf],
          [-4.0612,  2.6967,    -inf,    -inf],
          [-1.0817, -0.0904,  4.9295,    -inf],
          [-4.1715, -1.9168, -2.9663, -2.0914]],

         [[-0.1534,    -inf,    -inf,    -inf],
          [ 2.9879, -0.2894,    -inf,    -inf],
          [ 0.4811, -2.5104, -2.2412,    -inf],
          [ 0.5770,  1.7902,  1.8807,  3.8551]],

         [[-1.0166,    -inf,    -inf,    -inf],
          [-2.8308,  1.0981,    -inf,    -inf],
          [-6.2289, -1.3422, -1.9899,    -inf],
          [ 1.2246,  0.1563,  0.1962,  7.3960]],

         [[-1.7886,    -inf,    -inf,    -inf],
          [ 1.5105,  1.9915,    -inf,    -inf],
          [ 1.2081,  0.9405,  4.2522,    -inf],
          [-0.1352, -1.7681,  0.7569, -3.0568]],

         [[-0.8106,    -inf,    -inf,    -inf],
          [-3.6914, -0.0102,    -inf,    -inf],
          [-2.3302, -3.8581, -2.3401,    -inf],
          [-3.3793, -3.5022, -4.1104, -3.7141]],

         [[ 3.5461,    -inf,    -inf,    -inf],
          [-0.6000,  3.2287,    -inf,    -inf],
          [-0.1564, -0.6381, -1.5934,    -inf],
          [ 2.2185, -0.0647,  1.1968,  2.2389]],

         [[ 0.8240,    -inf,    -inf,    -inf],
          [-1.7127,  3.0215,    -inf,    -inf],
          [ 0.1338,  2.8929,  8.1074,    -inf],
          [-1.4951,  5.4356, -1.3633,  0.9788]],

         [[ 1.4376,    -inf,    -inf,    -inf],
          [ 0.4314,  1.1105,    -inf,    -inf],
          [ 2.6741, -0.9650, -1.7009,    -inf],
          [ 0.4196, -1.4122, -0.1224,  0.3517]],

         [[-2.7696,    -inf,    -inf,    -inf],
          [-0.3127,  2.3807,    -inf,    -inf],
          [ 1.4632, -1.5671, -2.0881,    -inf],
          [-0.1595, -0.1460, -1.2211, -2.2766]],

         [[-0.2429,    -inf,    -inf,    -inf],
          [ 0.2577,  6.1903,    -inf,    -inf],
          [ 2.4227,  2.4498,  1.5310,    -inf],
          [-1.5484,  1.3879,  1.2002, -0.8366]],

         [[-5.3419,    -inf,    -inf,    -inf],
          [-3.0921, -3.2795,    -inf,    -inf],
          [ 0.2554,  1.4991,  3.9947,    -inf],
          [ 0.6185,  3.2521, -0.9974, -0.0608]],

         [[-3.3871,    -inf,    -inf,    -inf],
          [-0.4274, -0.7925,    -inf,    -inf],
          [-2.8087, -2.8300,  1.1581,    -inf],
          [-0.5220, -3.1171, -1.7350,  3.7991]],

         [[ 3.3017,    -inf,    -inf,    -inf],
          [ 5.1797, -2.1484,    -inf,    -inf],
          [ 3.4563,  2.4346, -1.1799,    -inf],
          [ 2.3227, -3.6659, -2.1362,  1.8195]],

         [[ 1.6980,    -inf,    -inf,    -inf],
          [-0.3497, -0.8338,    -inf,    -inf],
          [ 0.6341,  3.1416,  2.1019,    -inf],
          [-3.7522,  3.8742, -1.5862, -4.3537]],

         [[-0.1829,    -inf,    -inf,    -inf],
          [-0.7657, -3.1638,    -inf,    -inf],
          [-1.5543,  0.9796,  3.1304,    -inf],
          [-7.2055, -6.1620, -3.4648, -3.5293]],

         [[-0.0847,    -inf,    -inf,    -inf],
          [ 1.5557, -1.0843,    -inf,    -inf],
          [-0.6854, -2.0872, -0.5729,    -inf],
          [ 0.0385, -3.3092, -1.1968, -7.2157]],

         [[-3.2378,    -inf,    -inf,    -inf],
          [ 2.1816, -1.9260,    -inf,    -inf],
          [-0.1477, -6.4524, -4.8304,    -inf],
          [-3.3063, -1.2692,  2.7871,  1.3513]],

         [[-0.7030,    -inf,    -inf,    -inf],
          [-0.3133, -0.8459,    -inf,    -inf],
          [-0.7388, -1.4241, -1.8268,    -inf],
          [-1.8875, -2.0377, -2.9605, -4.0101]],

         [[-3.4517,    -inf,    -inf,    -inf],
          [ 2.4290,  6.0822,    -inf,    -inf],
          [ 0.6394,  5.2701,  2.6243,    -inf],
          [ 2.2888,  5.2019,  1.2949,  2.6299]],

         [[ 1.0565,    -inf,    -inf,    -inf],
          [ 0.5913,  2.1801,    -inf,    -inf],
          [ 2.7063, -1.2230, -0.9722,    -inf],
          [-3.4273, -2.2800, -0.8455, -3.8176]],

         [[-1.9806,    -inf,    -inf,    -inf],
          [-9.8092, -5.8488,    -inf,    -inf],
          [-4.5483, -2.4568, -0.2685,    -inf],
          [ 0.7340,  0.3747,  0.8530,  2.5205]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.4250, -0.2951,  0.8484,  ..., -0.0830,  0.0065,  0.7227],
          [-0.0100,  0.8913, -0.1766,  ...,  0.5679, -0.4979, -0.1987],
          [-0.1987, -0.6275, -0.2904,  ..., -0.0644,  0.6954,  0.7509],
          ...,
          [ 0.2576,  0.6383,  0.2843,  ...,  0.4573,  0.3107, -0.2201],
          [ 0.5716,  0.3683, -0.6738,  ...,  0.6525, -0.8589,  0.0417],
          [ 0.4976,  0.6014,  0.4573,  ...,  0.7297,  0.3723, -0.0652]],

         [[ 0.3023,  0.1322,  0.5548,  ..., -0.4457, -0.4398,  0.2588],
          [-0.0043,  0.3860, -0.0765,  ...,  0.2460, -0.2157, -0.0861],
          [-0.3517, -0.0449, -0.3447,  ...,  0.3868,  0.7226,  0.5822],
          ...,
          [ 0.5575,  0.6516,  0.3194,  ...,  0.1108,  0.5316, -0.0360],
          [ 0.4367,  0.4886, -0.2520,  ..., -0.0978, -0.7610, -0.4425],
          [ 0.4021,  0.4704,  0.5334,  ...,  0.2841,  0.3971, -0.0966]],

         [[ 0.3192,  0.3416,  0.3745,  ..., -0.2478, -0.5132,  0.0983],
          [ 0.0277,  0.0462, -0.2397,  ...,  0.1478, -0.0812, -0.1849],
          [-0.3153, -0.1297, -0.3146,  ...,  0.1466,  0.7002,  0.5011],
          ...,
          [ 0.5580,  0.7101,  0.1439,  ..., -0.1650,  0.3719,  0.0353],
          [ 0.8052, -0.1303, -0.6315,  ...,  0.1573, -0.2790, -0.2718],
          [ 0.3540,  0.4413,  0.3556,  ...,  0.0476,  0.5062, -0.2191]],

         [[ 0.1498,  0.3195,  0.1446,  ...,  0.0755, -0.1807,  0.3162],
          [ 0.0133,  0.3861, -0.2708,  ...,  0.3168, -0.3866, -0.2765],
          [-0.2637,  0.0685, -0.0798,  ...,  0.1425,  0.5392,  0.3381],
          ...,
          [ 0.5565,  0.7462,  0.1903,  ...,  0.0779,  0.2238, -0.0408],
          [ 0.7318, -0.0848, -0.4866,  ...,  0.1590, -0.2485, -0.3206],
          [ 0.2808, -0.1164, -0.1410,  ...,  0.0316,  0.8370,  0.0605]]],


        [[[ 0.6238,  0.3336, -0.3274,  ..., -0.4970, -0.7871,  1.0733],
          [-0.0279,  1.1179,  0.0451,  ..., -0.0119,  0.0146, -0.1534],
          [-0.1576, -0.6934, -0.0112,  ..., -0.6656,  0.7515,  0.5584],
          ...,
          [ 0.2860,  0.3113, -0.0938,  ...,  0.4073,  0.3002, -0.3162],
          [ 0.1646,  0.3957, -0.9512,  ...,  1.0619, -0.4106,  0.1457],
          [ 0.3922,  0.1183,  0.4685,  ...,  1.3744,  0.9888, -0.4644]],

         [[ 0.6336,  0.3565, -0.4102,  ..., -0.2976, -0.9281,  0.8608],
          [-0.1820,  1.2418, -0.1120,  ..., -0.0731, -0.2250, -0.5629],
          [-0.6891,  0.0774, -0.2858,  ..., -0.4114,  0.7049,  0.3714],
          ...,
          [ 0.1109,  0.1207, -0.0364,  ...,  0.1580,  0.1164, -0.1226],
          [ 0.4634,  0.5018, -0.8334,  ...,  0.3706, -0.3212,  0.1627],
          [-0.0666,  0.2423,  0.3297,  ..., -0.5702,  0.2624, -0.3527]],

         [[ 0.4613,  0.2614, -0.3066,  ..., -0.1955, -0.6889,  0.6033],
          [-0.0817,  0.5349,  0.1388,  ..., -0.0829,  0.2182, -0.4422],
          [-0.3874, -0.0998, -0.1498,  ..., -0.3465,  0.5153,  0.3042],
          ...,
          [-0.0373,  0.2456,  0.4234,  ..., -0.2699,  0.3833, -0.0041],
          [ 0.3298,  0.1335, -0.8997,  ...,  0.7583, -0.4638,  0.3791],
          [ 0.0103,  0.4298,  0.4888,  ..., -0.1881,  0.4328, -0.1912]],

         [[ 0.4309,  0.3814, -0.1072,  ..., -0.0991, -0.6370,  0.7066],
          [-0.0456,  0.8689,  0.0351,  ..., -0.1071, -0.1563, -0.5981],
          [-0.1331,  0.1959, -0.1054,  ..., -0.1123, -0.0535,  0.0409],
          ...,
          [ 0.0739,  0.4224,  0.3772,  ..., -0.1328,  0.3403, -0.2858],
          [ 0.3280,  0.0229, -0.7680,  ...,  0.5487, -0.5255,  0.3695],
          [ 0.1757, -0.2760,  0.0894,  ...,  0.2549,  0.4797,  0.1557]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.4250, -0.2951,  0.8484,  ...,  0.7297,  0.3723, -0.0652],
         [ 0.3023,  0.1322,  0.5548,  ...,  0.2841,  0.3971, -0.0966],
         [ 0.3192,  0.3416,  0.3745,  ...,  0.0476,  0.5062, -0.2191],
         [ 0.1498,  0.3195,  0.1446,  ...,  0.0316,  0.8370,  0.0605]],

        [[ 0.6238,  0.3336, -0.3274,  ...,  1.3744,  0.9888, -0.4644],
         [ 0.6336,  0.3565, -0.4102,  ..., -0.5702,  0.2624, -0.3527],
         [ 0.4613,  0.2614, -0.3066,  ..., -0.1881,  0.4328, -0.1912],
         [ 0.4309,  0.3814, -0.1072,  ...,  0.2549,  0.4797,  0.1557]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.3393, -0.0886, -0.2858,  ...,  0.1729,  0.1087, -0.0168],
         [-0.5435,  0.1925, -0.2600,  ...,  0.4382, -0.1062, -0.0885],
         [-0.4205, -0.0074,  0.0099,  ...,  0.3565, -0.0640, -0.0820],
         [-0.4028,  0.0337, -0.1650,  ...,  0.3820, -0.0018, -0.0364]],

        [[-0.2910, -0.2007, -0.1596,  ...,  0.2088, -0.0573,  0.2554],
         [-0.1365,  0.0845,  0.0332,  ...,  0.4134, -0.3419,  0.0679],
         [-0.0018, -0.1231, -0.1950,  ...,  0.4636, -0.1346,  0.0519],
         [-0.0154, -0.0653, -0.1707,  ...,  0.5159, -0.0606,  0.2184]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-6.7363e+00,        -inf,        -inf,        -inf],
          [-3.4023e+00, -7.8380e-01,        -inf,        -inf],
          [ 1.0031e+00, -1.3376e+00,  2.2111e-01,        -inf],
          [-1.0141e+00, -2.3877e+00,  6.0473e+00, -6.8719e-01]],

         [[ 1.6047e+00,        -inf,        -inf,        -inf],
          [ 1.2869e-01,  2.5946e-01,        -inf,        -inf],
          [ 4.3492e+00,  2.3622e+00, -2.3495e+00,        -inf],
          [ 3.1490e+00,  7.0451e-01,  2.0579e+00,  1.5638e+00]],

         [[-1.1209e+00,        -inf,        -inf,        -inf],
          [ 1.5056e+00,  4.4986e+00,        -inf,        -inf],
          [ 2.0006e+00,  1.8404e+00,  1.9348e+00,        -inf],
          [ 2.4402e-01,  6.9255e-01, -2.0166e+00, -4.4413e+00]],

         [[-5.4740e-01,        -inf,        -inf,        -inf],
          [ 2.3083e-01,  4.5040e+00,        -inf,        -inf],
          [ 4.7701e-02,  2.2548e+00,  1.1117e+00,        -inf],
          [ 2.6115e+00,  5.6191e+00,  6.2126e+00,  2.0729e+00]],

         [[-1.7718e+00,        -inf,        -inf,        -inf],
          [-5.9230e+00, -1.3173e-01,        -inf,        -inf],
          [-1.0406e+00, -2.5296e+00,  1.5266e+00,        -inf],
          [-2.6252e+00,  1.6577e+00,  1.2971e+00, -1.4663e+00]],

         [[ 4.4908e-01,        -inf,        -inf,        -inf],
          [-2.5119e+00,  2.2491e+00,        -inf,        -inf],
          [-6.7060e-01,  6.4033e+00,  2.9437e+00,        -inf],
          [ 4.0764e+00,  2.0607e+00,  1.4067e+00,  2.2237e+00]],

         [[-2.9780e+00,        -inf,        -inf,        -inf],
          [-3.0457e+00,  3.9979e+00,        -inf,        -inf],
          [-3.0146e+00,  3.2504e+00,  3.3746e+00,        -inf],
          [-1.7325e+00, -2.2561e+00, -2.1596e+00, -2.7902e+00]],

         [[-4.0728e+00,        -inf,        -inf,        -inf],
          [-3.9842e+00, -2.6559e+00,        -inf,        -inf],
          [ 1.4363e+00, -3.9754e+00, -2.9239e+00,        -inf],
          [-4.8217e+00, -2.8490e+00,  9.6277e-01,  1.7861e+00]],

         [[ 1.8802e+00,        -inf,        -inf,        -inf],
          [-3.1166e+00,  9.1096e-01,        -inf,        -inf],
          [-1.4197e+00,  2.8808e+00,  6.1453e+00,        -inf],
          [ 2.7084e-01, -1.0180e-01,  4.3775e+00,  8.3330e-01]],

         [[-3.9424e+00,        -inf,        -inf,        -inf],
          [-1.6513e+00,  4.7682e-01,        -inf,        -inf],
          [ 1.7297e+00,  3.7622e+00,  4.3187e+00,        -inf],
          [ 3.4035e+00,  1.5094e+00,  2.5129e+00, -1.9459e-01]],

         [[-2.6913e+00,        -inf,        -inf,        -inf],
          [-1.3456e+00, -9.1614e-01,        -inf,        -inf],
          [ 5.1398e-01, -4.9440e-01,  2.5597e+00,        -inf],
          [ 3.5206e+00,  2.5508e+00,  1.5670e+00,  1.8864e+00]],

         [[ 1.5590e-01,        -inf,        -inf,        -inf],
          [-4.8628e-01,  2.2088e+00,        -inf,        -inf],
          [ 2.4594e-01,  4.9868e+00,  4.9597e+00,        -inf],
          [-3.4813e-01,  1.7695e+00,  2.1698e+00,  2.8744e+00]],

         [[ 9.8354e-01,        -inf,        -inf,        -inf],
          [-2.2062e+00,  2.7236e+00,        -inf,        -inf],
          [ 1.1454e+00, -3.2825e+00, -1.4136e+00,        -inf],
          [-2.5625e-01, -1.5788e+00, -3.5974e-01,  3.3030e+00]],

         [[-2.2119e+00,        -inf,        -inf,        -inf],
          [-4.2018e+00, -1.6279e+00,        -inf,        -inf],
          [-2.5435e+00,  4.9702e-01, -1.1845e+00,        -inf],
          [-1.6567e+00,  2.1433e+00, -4.0083e+00, -3.6197e-01]],

         [[ 4.7867e-01,        -inf,        -inf,        -inf],
          [-5.3412e+00, -3.4718e+00,        -inf,        -inf],
          [-2.7816e+00, -2.2571e+00, -4.4676e+00,        -inf],
          [ 4.6305e+00,  2.4262e+00,  3.1878e+00, -6.9930e-01]],

         [[ 5.0863e+00,        -inf,        -inf,        -inf],
          [-1.0156e+00, -2.8340e+00,        -inf,        -inf],
          [ 4.5749e+00, -1.7730e-02,  3.9537e+00,        -inf],
          [-5.9616e+00, -2.2793e+00, -2.7121e+00, -4.5523e+00]],

         [[ 3.4130e-01,        -inf,        -inf,        -inf],
          [-1.5192e+00, -4.8293e+00,        -inf,        -inf],
          [-2.9972e+00, -1.1752e+00, -1.0951e+00,        -inf],
          [ 1.4912e-02, -7.0366e-01,  1.6019e+00, -2.2446e+00]],

         [[-8.5446e-02,        -inf,        -inf,        -inf],
          [-2.2081e+00, -2.8982e+00,        -inf,        -inf],
          [ 6.8744e-01,  9.9900e-01,  2.6732e+00,        -inf],
          [ 3.7478e+00,  2.5954e+00,  4.1143e-01,  1.3704e+00]],

         [[-6.2579e-01,        -inf,        -inf,        -inf],
          [-3.8179e+00, -2.4772e+00,        -inf,        -inf],
          [-4.6939e+00, -3.1466e+00, -3.3164e+00,        -inf],
          [-2.3703e+00, -1.2948e+00, -2.5406e+00, -4.6243e+00]],

         [[-5.6337e-01,        -inf,        -inf,        -inf],
          [ 1.0010e+00, -1.3548e+00,        -inf,        -inf],
          [-8.4496e-01, -1.9962e-01, -2.3900e-01,        -inf],
          [ 3.2419e+00, -3.6347e+00, -7.1963e+00,  1.7372e+00]],

         [[-1.3299e+00,        -inf,        -inf,        -inf],
          [ 4.8988e-01, -1.8099e+00,        -inf,        -inf],
          [-9.4748e-01, -1.5329e-01,  3.6051e+00,        -inf],
          [ 2.5461e+00,  1.1218e+00, -1.5822e-01,  4.7427e+00]],

         [[-2.0496e+00,        -inf,        -inf,        -inf],
          [-5.1164e+00, -1.3808e+00,        -inf,        -inf],
          [ 2.7594e+00,  1.6777e+00,  2.3039e+00,        -inf],
          [-2.2727e-01,  2.0602e+00,  9.2390e-01,  7.5668e-01]],

         [[-1.7123e+00,        -inf,        -inf,        -inf],
          [ 3.3860e+00,  2.9421e+00,        -inf,        -inf],
          [ 3.5648e+00, -2.2780e+00, -1.6224e+00,        -inf],
          [ 3.5225e+00,  2.8921e+00, -7.5821e-01,  3.4854e+00]],

         [[-2.6035e+00,        -inf,        -inf,        -inf],
          [ 1.2828e+00, -5.6121e-03,        -inf,        -inf],
          [ 5.4822e-01,  3.3846e+00,  1.1414e+00,        -inf],
          [-1.3703e+00,  1.5807e+00, -1.8404e-01, -1.2552e+00]],

         [[ 2.5217e+00,        -inf,        -inf,        -inf],
          [ 5.7025e-01,  2.0099e+00,        -inf,        -inf],
          [-4.9807e+00,  1.4730e+00, -1.7394e+00,        -inf],
          [-4.7947e-01, -1.0291e+00,  2.1921e+00,  2.2107e+00]]],


        [[[-5.0136e+00,        -inf,        -inf,        -inf],
          [-3.8231e+00, -7.3932e-02,        -inf,        -inf],
          [ 2.1981e+00,  1.2970e-01,  1.0953e+00,        -inf],
          [ 7.9433e-01, -1.7485e+00,  1.5056e+00, -1.8311e+00]],

         [[ 1.8630e-01,        -inf,        -inf,        -inf],
          [ 3.2731e+00,  2.6838e+00,        -inf,        -inf],
          [-4.3658e-01,  1.5946e+00, -1.9600e+00,        -inf],
          [-1.5476e+00,  2.9809e+00,  1.3210e+00,  2.3058e+00]],

         [[-1.7891e+00,        -inf,        -inf,        -inf],
          [-4.4926e-01,  1.5731e+00,        -inf,        -inf],
          [ 4.3651e+00,  2.1065e+00,  3.4165e+00,        -inf],
          [-1.1673e+00, -4.8190e-01, -6.6001e-01, -2.3087e+00]],

         [[ 2.9330e+00,        -inf,        -inf,        -inf],
          [-4.7312e-01,  3.8786e+00,        -inf,        -inf],
          [-3.7530e+00,  2.3890e+00,  4.1119e+00,        -inf],
          [-1.1698e+00,  2.3955e+00,  3.2987e+00,  4.0168e-01]],

         [[-1.2617e+00,        -inf,        -inf,        -inf],
          [ 8.7071e-01,  2.7410e+00,        -inf,        -inf],
          [ 2.7532e-02, -8.1022e-01,  1.5086e+00,        -inf],
          [-1.6072e-01, -1.0292e+00,  6.9831e-01, -4.9449e-01]],

         [[ 3.0128e+00,        -inf,        -inf,        -inf],
          [ 3.1664e+00,  4.9997e+00,        -inf,        -inf],
          [ 5.9115e+00,  9.7826e+00,  1.8214e+00,        -inf],
          [ 3.1743e+00,  6.2254e+00,  4.4800e+00, -3.1528e-01]],

         [[-2.9313e+00,        -inf,        -inf,        -inf],
          [-3.5601e+00,  2.0552e+00,        -inf,        -inf],
          [-1.5943e+00,  2.1941e+00,  3.0996e+00,        -inf],
          [ 2.8852e+00,  2.3449e+00,  3.5628e+00,  3.5035e-02]],

         [[-4.7382e+00,        -inf,        -inf,        -inf],
          [-3.6676e-01,  5.3436e-01,        -inf,        -inf],
          [-2.1248e-01,  1.9243e+00, -6.7267e-01,        -inf],
          [-4.8710e+00,  5.8892e-01, -4.1999e-01,  2.1282e+00]],

         [[-2.0600e+00,        -inf,        -inf,        -inf],
          [ 1.7513e+00,  7.8215e-01,        -inf,        -inf],
          [ 1.1233e+00, -7.5221e-01, -3.9838e+00,        -inf],
          [-4.1106e+00, -2.7908e+00, -7.9684e-01, -2.5878e+00]],

         [[-5.1794e+00,        -inf,        -inf,        -inf],
          [ 3.3000e-01,  3.0791e+00,        -inf,        -inf],
          [ 2.8786e+00,  5.8807e+00,  4.4089e+00,        -inf],
          [ 3.7630e+00,  4.0138e+00,  2.9338e-01,  3.4321e+00]],

         [[-3.9448e+00,        -inf,        -inf,        -inf],
          [-3.7338e+00, -2.5166e+00,        -inf,        -inf],
          [-2.3941e+00,  5.3184e-02,  8.9461e-01,        -inf],
          [-1.0573e+00,  9.5466e-01,  1.9670e+00,  2.9386e+00]],

         [[-6.8416e-01,        -inf,        -inf,        -inf],
          [-4.9805e+00, -5.7378e+00,        -inf,        -inf],
          [-4.5358e+00, -2.1896e+00,  3.2791e+00,        -inf],
          [-1.5341e+00, -5.4052e+00,  1.6849e+00, -1.3178e+00]],

         [[ 1.8775e-01,        -inf,        -inf,        -inf],
          [-7.1201e-01,  6.2403e-01,        -inf,        -inf],
          [ 6.2391e-01,  1.5692e+00, -2.8310e+00,        -inf],
          [-4.7315e+00, -1.1090e+00, -3.9967e+00, -4.6694e-01]],

         [[-4.5922e+00,        -inf,        -inf,        -inf],
          [-4.9115e+00, -2.5318e+00,        -inf,        -inf],
          [-2.5044e+00, -4.2479e+00, -5.6999e-01,        -inf],
          [-3.2632e+00,  1.1701e+00, -4.5226e-01, -9.9324e-01]],

         [[-2.3100e+00,        -inf,        -inf,        -inf],
          [-3.4698e+00, -2.8928e+00,        -inf,        -inf],
          [-3.3139e+00, -4.0103e+00, -3.5407e+00,        -inf],
          [-1.7524e+00,  1.8628e+00,  3.1027e+00,  4.7112e-02]],

         [[ 3.0943e+00,        -inf,        -inf,        -inf],
          [ 6.9030e-01,  2.1608e+00,        -inf,        -inf],
          [ 2.7314e+00,  2.7205e+00,  3.4663e+00,        -inf],
          [-2.4622e-01, -7.1799e-01,  2.9449e-01,  1.3931e+00]],

         [[-3.8625e-01,        -inf,        -inf,        -inf],
          [-6.3296e+00, -3.5638e+00,        -inf,        -inf],
          [-2.9492e+00, -4.6545e+00, -4.4859e+00,        -inf],
          [-5.3215e-01, -3.0442e+00,  1.8487e-01, -1.9113e+00]],

         [[ 1.7647e+00,        -inf,        -inf,        -inf],
          [-6.1458e+00, -4.0957e+00,        -inf,        -inf],
          [-1.4573e+00, -2.9076e+00,  3.0246e+00,        -inf],
          [ 2.7338e+00,  1.0413e+00,  5.4321e-01, -1.1349e-01]],

         [[-5.5763e-01,        -inf,        -inf,        -inf],
          [-4.5730e+00, -1.5076e+00,        -inf,        -inf],
          [-3.5254e+00,  6.3702e-01,  2.0177e+00,        -inf],
          [-2.6117e+00, -2.8903e+00, -2.4801e+00,  3.3482e+00]],

         [[ 1.8672e+00,        -inf,        -inf,        -inf],
          [ 3.8278e+00, -2.6443e+00,        -inf,        -inf],
          [-5.7468e-01, -1.8250e+00, -5.7625e+00,        -inf],
          [ 3.1185e+00, -1.0589e+00, -4.3958e+00, -6.9481e-01]],

         [[-5.6960e-01,        -inf,        -inf,        -inf],
          [ 4.5844e-01, -2.2494e+00,        -inf,        -inf],
          [-2.2894e+00, -1.9816e+00, -2.0706e+00,        -inf],
          [ 2.4433e+00,  3.0145e+00, -2.1529e+00, -6.6178e-01]],

         [[-2.7479e+00,        -inf,        -inf,        -inf],
          [-5.1683e+00, -1.3911e+00,        -inf,        -inf],
          [ 3.0203e+00,  7.3375e-01,  7.4717e-01,        -inf],
          [-7.4694e-01,  2.1578e-01,  4.2821e+00,  2.2165e+00]],

         [[-1.3647e+00,        -inf,        -inf,        -inf],
          [-1.8586e+00, -4.3992e+00,        -inf,        -inf],
          [ 3.1309e+00,  2.0532e+00, -4.1619e+00,        -inf],
          [-8.6123e-01,  7.7011e-01, -1.6858e+00, -6.3461e+00]],

         [[ 1.2033e+00,        -inf,        -inf,        -inf],
          [ 1.9094e+00, -7.1021e-01,        -inf,        -inf],
          [-9.5546e-01,  1.5941e+00, -1.0975e+00,        -inf],
          [ 2.5827e-01,  1.0704e+00,  4.2957e+00, -2.4701e+00]],

         [[-2.2249e+00,        -inf,        -inf,        -inf],
          [-1.7526e-01, -5.2043e-01,        -inf,        -inf],
          [ 1.0697e+00,  1.1136e-01,  2.2358e+00,        -inf],
          [ 3.0946e+00,  1.1877e-01,  2.0721e+00,  5.3397e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-6.7363e+00,        -inf,        -inf,        -inf],
          [-3.4023e+00, -7.8380e-01,        -inf,        -inf],
          [ 1.0031e+00, -1.3376e+00,  2.2111e-01,        -inf],
          [-1.0141e+00, -2.3877e+00,  6.0473e+00, -6.8719e-01]],

         [[ 1.6047e+00,        -inf,        -inf,        -inf],
          [ 1.2869e-01,  2.5946e-01,        -inf,        -inf],
          [ 4.3492e+00,  2.3622e+00, -2.3495e+00,        -inf],
          [ 3.1490e+00,  7.0451e-01,  2.0579e+00,  1.5638e+00]],

         [[-1.1209e+00,        -inf,        -inf,        -inf],
          [ 1.5056e+00,  4.4986e+00,        -inf,        -inf],
          [ 2.0006e+00,  1.8404e+00,  1.9348e+00,        -inf],
          [ 2.4402e-01,  6.9255e-01, -2.0166e+00, -4.4413e+00]],

         [[-5.4740e-01,        -inf,        -inf,        -inf],
          [ 2.3083e-01,  4.5040e+00,        -inf,        -inf],
          [ 4.7701e-02,  2.2548e+00,  1.1117e+00,        -inf],
          [ 2.6115e+00,  5.6191e+00,  6.2126e+00,  2.0729e+00]],

         [[-1.7718e+00,        -inf,        -inf,        -inf],
          [-5.9230e+00, -1.3173e-01,        -inf,        -inf],
          [-1.0406e+00, -2.5296e+00,  1.5266e+00,        -inf],
          [-2.6252e+00,  1.6577e+00,  1.2971e+00, -1.4663e+00]],

         [[ 4.4908e-01,        -inf,        -inf,        -inf],
          [-2.5119e+00,  2.2491e+00,        -inf,        -inf],
          [-6.7060e-01,  6.4033e+00,  2.9437e+00,        -inf],
          [ 4.0764e+00,  2.0607e+00,  1.4067e+00,  2.2237e+00]],

         [[-2.9780e+00,        -inf,        -inf,        -inf],
          [-3.0457e+00,  3.9979e+00,        -inf,        -inf],
          [-3.0146e+00,  3.2504e+00,  3.3746e+00,        -inf],
          [-1.7325e+00, -2.2561e+00, -2.1596e+00, -2.7902e+00]],

         [[-4.0728e+00,        -inf,        -inf,        -inf],
          [-3.9842e+00, -2.6559e+00,        -inf,        -inf],
          [ 1.4363e+00, -3.9754e+00, -2.9239e+00,        -inf],
          [-4.8217e+00, -2.8490e+00,  9.6277e-01,  1.7861e+00]],

         [[ 1.8802e+00,        -inf,        -inf,        -inf],
          [-3.1166e+00,  9.1096e-01,        -inf,        -inf],
          [-1.4197e+00,  2.8808e+00,  6.1453e+00,        -inf],
          [ 2.7084e-01, -1.0180e-01,  4.3775e+00,  8.3330e-01]],

         [[-3.9424e+00,        -inf,        -inf,        -inf],
          [-1.6513e+00,  4.7682e-01,        -inf,        -inf],
          [ 1.7297e+00,  3.7622e+00,  4.3187e+00,        -inf],
          [ 3.4035e+00,  1.5094e+00,  2.5129e+00, -1.9459e-01]],

         [[-2.6913e+00,        -inf,        -inf,        -inf],
          [-1.3456e+00, -9.1614e-01,        -inf,        -inf],
          [ 5.1398e-01, -4.9440e-01,  2.5597e+00,        -inf],
          [ 3.5206e+00,  2.5508e+00,  1.5670e+00,  1.8864e+00]],

         [[ 1.5590e-01,        -inf,        -inf,        -inf],
          [-4.8628e-01,  2.2088e+00,        -inf,        -inf],
          [ 2.4594e-01,  4.9868e+00,  4.9597e+00,        -inf],
          [-3.4813e-01,  1.7695e+00,  2.1698e+00,  2.8744e+00]],

         [[ 9.8354e-01,        -inf,        -inf,        -inf],
          [-2.2062e+00,  2.7236e+00,        -inf,        -inf],
          [ 1.1454e+00, -3.2825e+00, -1.4136e+00,        -inf],
          [-2.5625e-01, -1.5788e+00, -3.5974e-01,  3.3030e+00]],

         [[-2.2119e+00,        -inf,        -inf,        -inf],
          [-4.2018e+00, -1.6279e+00,        -inf,        -inf],
          [-2.5435e+00,  4.9702e-01, -1.1845e+00,        -inf],
          [-1.6567e+00,  2.1433e+00, -4.0083e+00, -3.6197e-01]],

         [[ 4.7867e-01,        -inf,        -inf,        -inf],
          [-5.3412e+00, -3.4718e+00,        -inf,        -inf],
          [-2.7816e+00, -2.2571e+00, -4.4676e+00,        -inf],
          [ 4.6305e+00,  2.4262e+00,  3.1878e+00, -6.9930e-01]],

         [[ 5.0863e+00,        -inf,        -inf,        -inf],
          [-1.0156e+00, -2.8340e+00,        -inf,        -inf],
          [ 4.5749e+00, -1.7730e-02,  3.9537e+00,        -inf],
          [-5.9616e+00, -2.2793e+00, -2.7121e+00, -4.5523e+00]],

         [[ 3.4130e-01,        -inf,        -inf,        -inf],
          [-1.5192e+00, -4.8293e+00,        -inf,        -inf],
          [-2.9972e+00, -1.1752e+00, -1.0951e+00,        -inf],
          [ 1.4912e-02, -7.0366e-01,  1.6019e+00, -2.2446e+00]],

         [[-8.5446e-02,        -inf,        -inf,        -inf],
          [-2.2081e+00, -2.8982e+00,        -inf,        -inf],
          [ 6.8744e-01,  9.9900e-01,  2.6732e+00,        -inf],
          [ 3.7478e+00,  2.5954e+00,  4.1143e-01,  1.3704e+00]],

         [[-6.2579e-01,        -inf,        -inf,        -inf],
          [-3.8179e+00, -2.4772e+00,        -inf,        -inf],
          [-4.6939e+00, -3.1466e+00, -3.3164e+00,        -inf],
          [-2.3703e+00, -1.2948e+00, -2.5406e+00, -4.6243e+00]],

         [[-5.6337e-01,        -inf,        -inf,        -inf],
          [ 1.0010e+00, -1.3548e+00,        -inf,        -inf],
          [-8.4496e-01, -1.9962e-01, -2.3900e-01,        -inf],
          [ 3.2419e+00, -3.6347e+00, -7.1963e+00,  1.7372e+00]],

         [[-1.3299e+00,        -inf,        -inf,        -inf],
          [ 4.8988e-01, -1.8099e+00,        -inf,        -inf],
          [-9.4748e-01, -1.5329e-01,  3.6051e+00,        -inf],
          [ 2.5461e+00,  1.1218e+00, -1.5822e-01,  4.7427e+00]],

         [[-2.0496e+00,        -inf,        -inf,        -inf],
          [-5.1164e+00, -1.3808e+00,        -inf,        -inf],
          [ 2.7594e+00,  1.6777e+00,  2.3039e+00,        -inf],
          [-2.2727e-01,  2.0602e+00,  9.2390e-01,  7.5668e-01]],

         [[-1.7123e+00,        -inf,        -inf,        -inf],
          [ 3.3860e+00,  2.9421e+00,        -inf,        -inf],
          [ 3.5648e+00, -2.2780e+00, -1.6224e+00,        -inf],
          [ 3.5225e+00,  2.8921e+00, -7.5821e-01,  3.4854e+00]],

         [[-2.6035e+00,        -inf,        -inf,        -inf],
          [ 1.2828e+00, -5.6121e-03,        -inf,        -inf],
          [ 5.4822e-01,  3.3846e+00,  1.1414e+00,        -inf],
          [-1.3703e+00,  1.5807e+00, -1.8404e-01, -1.2552e+00]],

         [[ 2.5217e+00,        -inf,        -inf,        -inf],
          [ 5.7025e-01,  2.0099e+00,        -inf,        -inf],
          [-4.9807e+00,  1.4730e+00, -1.7394e+00,        -inf],
          [-4.7947e-01, -1.0291e+00,  2.1921e+00,  2.2107e+00]]],


        [[[-5.0136e+00,        -inf,        -inf,        -inf],
          [-3.8231e+00, -7.3932e-02,        -inf,        -inf],
          [ 2.1981e+00,  1.2970e-01,  1.0953e+00,        -inf],
          [ 7.9433e-01, -1.7485e+00,  1.5056e+00, -1.8311e+00]],

         [[ 1.8630e-01,        -inf,        -inf,        -inf],
          [ 3.2731e+00,  2.6838e+00,        -inf,        -inf],
          [-4.3658e-01,  1.5946e+00, -1.9600e+00,        -inf],
          [-1.5476e+00,  2.9809e+00,  1.3210e+00,  2.3058e+00]],

         [[-1.7891e+00,        -inf,        -inf,        -inf],
          [-4.4926e-01,  1.5731e+00,        -inf,        -inf],
          [ 4.3651e+00,  2.1065e+00,  3.4165e+00,        -inf],
          [-1.1673e+00, -4.8190e-01, -6.6001e-01, -2.3087e+00]],

         [[ 2.9330e+00,        -inf,        -inf,        -inf],
          [-4.7312e-01,  3.8786e+00,        -inf,        -inf],
          [-3.7530e+00,  2.3890e+00,  4.1119e+00,        -inf],
          [-1.1698e+00,  2.3955e+00,  3.2987e+00,  4.0168e-01]],

         [[-1.2617e+00,        -inf,        -inf,        -inf],
          [ 8.7071e-01,  2.7410e+00,        -inf,        -inf],
          [ 2.7532e-02, -8.1022e-01,  1.5086e+00,        -inf],
          [-1.6072e-01, -1.0292e+00,  6.9831e-01, -4.9449e-01]],

         [[ 3.0128e+00,        -inf,        -inf,        -inf],
          [ 3.1664e+00,  4.9997e+00,        -inf,        -inf],
          [ 5.9115e+00,  9.7826e+00,  1.8214e+00,        -inf],
          [ 3.1743e+00,  6.2254e+00,  4.4800e+00, -3.1528e-01]],

         [[-2.9313e+00,        -inf,        -inf,        -inf],
          [-3.5601e+00,  2.0552e+00,        -inf,        -inf],
          [-1.5943e+00,  2.1941e+00,  3.0996e+00,        -inf],
          [ 2.8852e+00,  2.3449e+00,  3.5628e+00,  3.5035e-02]],

         [[-4.7382e+00,        -inf,        -inf,        -inf],
          [-3.6676e-01,  5.3436e-01,        -inf,        -inf],
          [-2.1248e-01,  1.9243e+00, -6.7267e-01,        -inf],
          [-4.8710e+00,  5.8892e-01, -4.1999e-01,  2.1282e+00]],

         [[-2.0600e+00,        -inf,        -inf,        -inf],
          [ 1.7513e+00,  7.8215e-01,        -inf,        -inf],
          [ 1.1233e+00, -7.5221e-01, -3.9838e+00,        -inf],
          [-4.1106e+00, -2.7908e+00, -7.9684e-01, -2.5878e+00]],

         [[-5.1794e+00,        -inf,        -inf,        -inf],
          [ 3.3000e-01,  3.0791e+00,        -inf,        -inf],
          [ 2.8786e+00,  5.8807e+00,  4.4089e+00,        -inf],
          [ 3.7630e+00,  4.0138e+00,  2.9338e-01,  3.4321e+00]],

         [[-3.9448e+00,        -inf,        -inf,        -inf],
          [-3.7338e+00, -2.5166e+00,        -inf,        -inf],
          [-2.3941e+00,  5.3184e-02,  8.9461e-01,        -inf],
          [-1.0573e+00,  9.5466e-01,  1.9670e+00,  2.9386e+00]],

         [[-6.8416e-01,        -inf,        -inf,        -inf],
          [-4.9805e+00, -5.7378e+00,        -inf,        -inf],
          [-4.5358e+00, -2.1896e+00,  3.2791e+00,        -inf],
          [-1.5341e+00, -5.4052e+00,  1.6849e+00, -1.3178e+00]],

         [[ 1.8775e-01,        -inf,        -inf,        -inf],
          [-7.1201e-01,  6.2403e-01,        -inf,        -inf],
          [ 6.2391e-01,  1.5692e+00, -2.8310e+00,        -inf],
          [-4.7315e+00, -1.1090e+00, -3.9967e+00, -4.6694e-01]],

         [[-4.5922e+00,        -inf,        -inf,        -inf],
          [-4.9115e+00, -2.5318e+00,        -inf,        -inf],
          [-2.5044e+00, -4.2479e+00, -5.6999e-01,        -inf],
          [-3.2632e+00,  1.1701e+00, -4.5226e-01, -9.9324e-01]],

         [[-2.3100e+00,        -inf,        -inf,        -inf],
          [-3.4698e+00, -2.8928e+00,        -inf,        -inf],
          [-3.3139e+00, -4.0103e+00, -3.5407e+00,        -inf],
          [-1.7524e+00,  1.8628e+00,  3.1027e+00,  4.7112e-02]],

         [[ 3.0943e+00,        -inf,        -inf,        -inf],
          [ 6.9030e-01,  2.1608e+00,        -inf,        -inf],
          [ 2.7314e+00,  2.7205e+00,  3.4663e+00,        -inf],
          [-2.4622e-01, -7.1799e-01,  2.9449e-01,  1.3931e+00]],

         [[-3.8625e-01,        -inf,        -inf,        -inf],
          [-6.3296e+00, -3.5638e+00,        -inf,        -inf],
          [-2.9492e+00, -4.6545e+00, -4.4859e+00,        -inf],
          [-5.3215e-01, -3.0442e+00,  1.8487e-01, -1.9113e+00]],

         [[ 1.7647e+00,        -inf,        -inf,        -inf],
          [-6.1458e+00, -4.0957e+00,        -inf,        -inf],
          [-1.4573e+00, -2.9076e+00,  3.0246e+00,        -inf],
          [ 2.7338e+00,  1.0413e+00,  5.4321e-01, -1.1349e-01]],

         [[-5.5763e-01,        -inf,        -inf,        -inf],
          [-4.5730e+00, -1.5076e+00,        -inf,        -inf],
          [-3.5254e+00,  6.3702e-01,  2.0177e+00,        -inf],
          [-2.6117e+00, -2.8903e+00, -2.4801e+00,  3.3482e+00]],

         [[ 1.8672e+00,        -inf,        -inf,        -inf],
          [ 3.8278e+00, -2.6443e+00,        -inf,        -inf],
          [-5.7468e-01, -1.8250e+00, -5.7625e+00,        -inf],
          [ 3.1185e+00, -1.0589e+00, -4.3958e+00, -6.9481e-01]],

         [[-5.6960e-01,        -inf,        -inf,        -inf],
          [ 4.5844e-01, -2.2494e+00,        -inf,        -inf],
          [-2.2894e+00, -1.9816e+00, -2.0706e+00,        -inf],
          [ 2.4433e+00,  3.0145e+00, -2.1529e+00, -6.6178e-01]],

         [[-2.7479e+00,        -inf,        -inf,        -inf],
          [-5.1683e+00, -1.3911e+00,        -inf,        -inf],
          [ 3.0203e+00,  7.3375e-01,  7.4717e-01,        -inf],
          [-7.4694e-01,  2.1578e-01,  4.2821e+00,  2.2165e+00]],

         [[-1.3647e+00,        -inf,        -inf,        -inf],
          [-1.8586e+00, -4.3992e+00,        -inf,        -inf],
          [ 3.1309e+00,  2.0532e+00, -4.1619e+00,        -inf],
          [-8.6123e-01,  7.7011e-01, -1.6858e+00, -6.3461e+00]],

         [[ 1.2033e+00,        -inf,        -inf,        -inf],
          [ 1.9094e+00, -7.1021e-01,        -inf,        -inf],
          [-9.5546e-01,  1.5941e+00, -1.0975e+00,        -inf],
          [ 2.5827e-01,  1.0704e+00,  4.2957e+00, -2.4701e+00]],

         [[-2.2249e+00,        -inf,        -inf,        -inf],
          [-1.7526e-01, -5.2043e-01,        -inf,        -inf],
          [ 1.0697e+00,  1.1136e-01,  2.2358e+00,        -inf],
          [ 3.0946e+00,  1.1877e-01,  2.0721e+00,  5.3397e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.4988, -0.7659, -1.4109,  ..., -0.3599,  0.4716,  0.5017],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.3690,  0.4479,  0.1667,  ..., -0.0863, -0.1972,  0.3693],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.4649, -0.1772,  0.6492,  ...,  0.7775,  0.5512,  0.5280],
          [ 1.3246,  0.6352,  1.3982,  ..., -0.2206,  0.8174, -0.0276]],

         [[ 0.1506, -0.2443, -0.5415,  ...,  0.2719,  0.7961, -0.1568],
          [ 0.0271, -0.2423, -0.2601,  ...,  0.0899, -0.4607, -0.7659],
          [-0.4142,  0.0725,  0.7069,  ..., -0.0120,  0.0445,  0.2233],
          ...,
          [-0.9563, -0.4612, -0.9976,  ..., -0.1173,  0.0801, -0.6396],
          [-0.9294, -0.0689,  0.6312,  ...,  0.2306,  0.6205,  0.3423],
          [ 1.0138, -0.1451,  1.3943,  ..., -0.2055,  0.9056, -0.0278]],

         [[ 0.2155, -0.6683, -0.5154,  ...,  0.1366,  0.6115, -0.0249],
          [ 0.0838, -0.1454, -0.3484,  ...,  0.1874, -0.4008, -0.7140],
          [-0.2467, -0.0589,  0.1650,  ..., -0.2693,  0.2390, -0.0618],
          ...,
          [-0.8902, -0.2639, -0.2367,  ...,  0.2856,  0.1387, -0.1410],
          [-0.7331, -0.0269,  0.4336,  ...,  0.0543,  0.4431,  0.2013],
          [ 0.6834, -0.4064,  0.9940,  ...,  0.0456,  1.0658, -0.1075]],

         [[ 0.0443, -0.5108,  0.0418,  ...,  0.1052,  0.3961,  0.0398],
          [-0.0213, -0.0468, -0.2705,  ...,  0.0665, -0.5083, -0.7753],
          [-0.0943, -0.2061,  0.1957,  ..., -0.3670,  0.2977, -0.0112],
          ...,
          [-0.5683, -0.1073, -0.7173,  ..., -0.3595,  0.2777, -0.8716],
          [-0.9340,  0.2282,  0.4024,  ..., -0.0747,  0.3950, -0.0707],
          [ 0.4756, -0.0332,  0.8792,  ...,  0.0844,  1.0930, -0.3270]]],


        [[[-0.3088, -1.4502, -1.5191,  ...,  0.2764,  0.4520,  0.3059],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.2485,  0.1377,  0.4083,  ...,  0.0950, -0.0350,  0.1002],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [-0.3651, -0.2252,  0.4645,  ...,  0.4014,  0.1794, -0.1941],
          [ 0.5769,  0.0671,  1.2718,  ..., -0.4127,  0.0809,  0.5512]],

         [[-0.4386, -0.4672, -0.7122,  ...,  0.7585,  0.4775, -0.2200],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.2108, -0.5180,  0.3390,  ..., -0.1072, -0.6051,  0.1271],
          ...,
          [-0.9768,  0.2203, -1.1187,  ...,  0.3564, -0.1871, -0.6918],
          [-0.4718, -0.4004, -0.0291,  ...,  0.1802,  0.2634, -0.2225],
          [ 0.5488, -0.3213,  0.8404,  ...,  0.0686, -0.1082,  0.1809]],

         [[-0.2672, -0.4133, -0.5885,  ...,  0.5811,  0.4303, -0.1481],
          [-0.1935, -0.1361, -0.1215,  ...,  0.2520,  0.5294, -0.0074],
          [ 0.2102,  0.1827,  0.1225,  ...,  0.2254,  0.0925, -0.0680],
          ...,
          [-0.8135,  0.1450, -1.1251,  ...,  0.4198, -0.3629, -0.8136],
          [-0.3754, -0.4238,  0.0495,  ...,  0.1726,  0.2724, -0.0990],
          [ 0.4892, -0.4210,  0.5667,  ...,  0.0895, -0.4470,  0.2521]],

         [[-0.1926, -0.2929, -0.4278,  ...,  0.4522,  0.3370, -0.1233],
          [-0.1455, -0.1307,  0.0754,  ...,  0.1893,  0.2867, -0.1607],
          [ 0.5154, -0.1405,  0.1272,  ...,  0.0215, -0.1583,  0.0194],
          ...,
          [-0.5006,  0.1385, -1.1017,  ...,  0.3576, -0.4298, -0.9061],
          [-0.2733, -0.3805,  0.2035,  ...,  0.2661,  0.3906,  0.0278],
          [ 0.2554, -0.0239,  0.4876,  ..., -0.1219, -0.2182,  0.3057]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.4988, -0.7659, -1.4109,  ..., -0.2206,  0.8174, -0.0276],
         [ 0.1506, -0.2443, -0.5415,  ..., -0.2055,  0.9056, -0.0278],
         [ 0.2155, -0.6683, -0.5154,  ...,  0.0456,  1.0658, -0.1075],
         [ 0.0443, -0.5108,  0.0418,  ...,  0.0844,  1.0930, -0.3270]],

        [[-0.3088, -1.4502, -1.5191,  ..., -0.4127,  0.0809,  0.5512],
         [-0.4386, -0.4672, -0.7122,  ...,  0.0686, -0.1082,  0.1809],
         [-0.2672, -0.4133, -0.5885,  ...,  0.0895, -0.4470,  0.2521],
         [-0.1926, -0.2929, -0.4278,  ..., -0.1219, -0.2182,  0.3057]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.2087, -0.1832,  0.0720,  ..., -0.8472,  0.0130,  0.1824],
         [-0.1692, -0.3219,  0.1632,  ..., -0.5257, -0.0969,  0.0941],
         [-0.1707, -0.2585,  0.2839,  ..., -0.3270, -0.0489,  0.1345],
         [-0.1035, -0.2357,  0.1556,  ..., -0.2279,  0.1681,  0.1405]],

        [[-0.4132, -0.1202, -0.0255,  ..., -0.6686, -0.4628, -0.0868],
         [-0.0713, -0.1388,  0.3052,  ..., -0.2823, -0.2379, -0.2551],
         [-0.2172, -0.0419,  0.1689,  ..., -0.4099, -0.0822, -0.1272],
         [-0.1216,  0.0466,  0.0144,  ..., -0.3415, -0.1200,  0.0521]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.1021e+00,        -inf,        -inf,        -inf],
          [-1.3499e+00, -4.3339e+00,        -inf,        -inf],
          [ 2.2160e+00,  3.2392e-01,  1.0295e+00,        -inf],
          [ 3.1286e-01,  3.1174e+00,  2.7798e+00,  1.7046e+00]],

         [[ 2.6198e+00,        -inf,        -inf,        -inf],
          [ 1.4099e+00,  2.0718e+00,        -inf,        -inf],
          [-2.3955e+00, -1.1918e+00, -4.8274e+00,        -inf],
          [-2.0891e-01,  2.3485e-01, -2.5938e+00, -1.5024e+00]],

         [[-1.2458e+00,        -inf,        -inf,        -inf],
          [-4.5615e+00, -4.9856e-01,        -inf,        -inf],
          [ 5.6632e-01, -1.6239e-01, -1.9761e+00,        -inf],
          [ 2.3021e+00,  9.0289e-01,  2.6011e-01, -6.8534e-01]],

         [[ 5.6927e-01,        -inf,        -inf,        -inf],
          [-1.0729e+00, -1.7221e-01,        -inf,        -inf],
          [-7.1511e-01,  2.3067e+00,  4.7658e-01,        -inf],
          [ 3.5691e-01, -3.6451e+00,  8.2933e-02, -6.2000e+00]],

         [[-3.1308e+00,        -inf,        -inf,        -inf],
          [-9.0369e-01, -1.5466e+00,        -inf,        -inf],
          [-1.8247e+00, -1.7270e+00,  6.2176e+00,        -inf],
          [-1.4787e+00, -1.0299e+00,  1.8122e+00,  4.0015e+00]],

         [[-3.3811e-01,        -inf,        -inf,        -inf],
          [-2.6557e+00, -3.3366e+00,        -inf,        -inf],
          [ 9.2731e-01, -3.2564e+00,  2.9601e+00,        -inf],
          [-1.3933e+00, -4.6115e+00, -3.8658e+00, -1.2750e+00]],

         [[-3.4757e+00,        -inf,        -inf,        -inf],
          [-3.1879e+00, -7.4101e-01,        -inf,        -inf],
          [-2.8932e+00,  1.9958e+00,  2.4467e+00,        -inf],
          [-1.5317e+00, -1.6305e+00, -1.0573e+00,  8.4499e-01]],

         [[-2.7705e+00,        -inf,        -inf,        -inf],
          [-2.1367e+00, -1.0537e+00,        -inf,        -inf],
          [-1.1793e+00, -8.1102e-01,  2.7279e+00,        -inf],
          [ 8.5469e-02,  4.3532e+00,  3.5086e+00,  1.6223e-01]],

         [[ 2.0588e+00,        -inf,        -inf,        -inf],
          [-1.4931e+00, -5.0392e-01,        -inf,        -inf],
          [-1.9480e+00, -3.9026e+00, -1.4192e+00,        -inf],
          [ 3.2740e+00,  2.0359e+00, -1.0811e-01,  3.5442e-01]],

         [[-2.7128e+00,        -inf,        -inf,        -inf],
          [-2.2778e-01,  3.0920e+00,        -inf,        -inf],
          [ 5.4610e-01,  1.9805e+00, -1.9987e-01,        -inf],
          [ 7.8346e-01,  4.7705e+00,  1.3239e+00, -8.3066e-01]],

         [[ 4.7218e-01,        -inf,        -inf,        -inf],
          [ 1.0588e+00,  2.7069e+00,        -inf,        -inf],
          [ 1.4248e+00,  2.8640e+00,  2.0067e+00,        -inf],
          [ 1.8398e+00,  4.4976e+00,  2.8488e-01, -4.2844e-02]],

         [[-5.0535e-01,        -inf,        -inf,        -inf],
          [-1.1285e+00,  3.5467e-01,        -inf,        -inf],
          [-6.7744e+00,  1.0645e+00, -3.3561e+00,        -inf],
          [-1.7801e+00,  7.1417e-01, -3.7038e+00, -1.2768e+00]],

         [[ 1.0698e+00,        -inf,        -inf,        -inf],
          [-2.0195e+00,  3.1476e+00,        -inf,        -inf],
          [-2.2886e+00,  3.6595e+00,  9.4243e-01,        -inf],
          [-6.6931e-01,  2.1700e+00,  1.0536e+00,  3.2408e+00]],

         [[-9.6308e-01,        -inf,        -inf,        -inf],
          [-2.1913e+00,  5.2313e+00,        -inf,        -inf],
          [-2.8033e+00,  1.7098e+00, -3.5534e+00,        -inf],
          [-1.1755e-01,  6.2123e+00, -1.4967e+00,  3.7253e+00]],

         [[ 1.6063e-01,        -inf,        -inf,        -inf],
          [ 2.5159e+00,  2.2985e+00,        -inf,        -inf],
          [-1.8466e-01,  1.8311e+00, -7.6998e-01,        -inf],
          [ 4.3533e-01,  1.5553e+00, -4.3539e+00, -8.9849e-01]],

         [[-8.3177e-01,        -inf,        -inf,        -inf],
          [-2.6520e-01,  2.7507e+00,        -inf,        -inf],
          [-2.6067e-01,  4.0995e+00,  2.2544e+00,        -inf],
          [ 2.4693e+00,  5.0043e+00,  3.2899e+00, -2.4142e+00]],

         [[ 3.5026e+00,        -inf,        -inf,        -inf],
          [-1.0643e+00,  2.1856e+00,        -inf,        -inf],
          [ 4.1077e+00,  7.0179e+00,  8.0394e+00,        -inf],
          [-2.2254e+00,  1.6256e-01, -3.5214e+00, -9.0777e-01]],

         [[ 1.8049e+00,        -inf,        -inf,        -inf],
          [-3.6032e+00, -6.8319e+00,        -inf,        -inf],
          [-1.7349e+00, -7.1024e-01,  9.3626e-01,        -inf],
          [-2.5679e+00, -1.9092e+00, -2.5603e+00, -4.2228e+00]],

         [[-2.3236e+00,        -inf,        -inf,        -inf],
          [-2.0146e-01,  6.0074e-01,        -inf,        -inf],
          [-2.6088e+00, -3.8383e+00, -4.9894e-01,        -inf],
          [ 2.9349e+00, -3.8991e+00, -1.1452e+00, -3.4007e+00]],

         [[-3.0858e+00,        -inf,        -inf,        -inf],
          [-4.9795e+00, -4.0738e+00,        -inf,        -inf],
          [ 1.6393e+00, -1.7769e+00, -6.9346e-01,        -inf],
          [-2.7580e-01, -1.2361e+00, -6.2906e-02,  9.6737e-01]],

         [[-1.1949e+00,        -inf,        -inf,        -inf],
          [-1.8465e+00, -4.6361e+00,        -inf,        -inf],
          [-1.0377e+00, -7.1555e-01,  1.3795e+00,        -inf],
          [-1.4730e+00, -2.1976e-01, -1.8291e+00, -1.8321e+00]],

         [[ 4.3557e-01,        -inf,        -inf,        -inf],
          [ 7.0723e-01, -1.7213e+00,        -inf,        -inf],
          [ 1.5663e+00, -1.8767e+00, -1.1013e+00,        -inf],
          [ 2.8884e+00,  1.0805e-01, -1.7283e+00,  5.0632e-01]],

         [[-2.4638e+00,        -inf,        -inf,        -inf],
          [ 1.3095e+00,  2.0078e+00,        -inf,        -inf],
          [-5.4043e+00, -5.3547e+00, -2.3230e+00,        -inf],
          [-1.3824e+00, -3.2235e+00, -3.9569e+00, -5.2905e+00]],

         [[ 2.3508e-01,        -inf,        -inf,        -inf],
          [ 4.7018e+00,  2.8952e+00,        -inf,        -inf],
          [ 2.6432e+00,  2.4466e+00,  2.8145e-01,        -inf],
          [-1.6865e+00,  1.0942e+00, -2.7447e+00, -2.8997e-01]],

         [[-1.8611e+00,        -inf,        -inf,        -inf],
          [-5.3349e-01,  2.1121e-01,        -inf,        -inf],
          [ 1.8251e+00,  1.9533e+00,  3.4373e+00,        -inf],
          [-3.1351e-01,  2.5248e+00,  3.3439e-01, -3.6169e+00]]],


        [[[ 1.3952e+00,        -inf,        -inf,        -inf],
          [-1.7094e+00, -6.0601e-01,        -inf,        -inf],
          [-1.1785e-01, -1.6975e+00,  7.3782e-01,        -inf],
          [ 1.7214e+00, -4.2165e-01, -5.9014e-01,  3.7349e+00]],

         [[-5.4724e-01,        -inf,        -inf,        -inf],
          [ 4.8103e+00,  1.0153e+00,        -inf,        -inf],
          [ 5.1697e+00, -2.3757e-01,  4.9520e-01,        -inf],
          [-3.8689e-01, -2.6351e+00, -2.5311e-01, -7.1495e-01]],

         [[-6.5453e-01,        -inf,        -inf,        -inf],
          [-2.1945e+00, -6.8731e+00,        -inf,        -inf],
          [ 2.2386e+00, -4.1681e+00, -4.6643e+00,        -inf],
          [-2.3658e+00, -3.2497e+00, -1.3190e+00, -1.8349e+00]],

         [[-5.5765e+00,        -inf,        -inf,        -inf],
          [-1.0298e+00,  5.8881e-01,        -inf,        -inf],
          [-1.7792e+00, -3.7140e+00,  4.6240e-01,        -inf],
          [ 1.9442e+00, -2.3897e+00,  1.4366e-01, -1.5983e+00]],

         [[-1.5093e+00,        -inf,        -inf,        -inf],
          [-2.1006e+00,  7.8320e-01,        -inf,        -inf],
          [-1.0568e+00, -8.5628e-01, -5.4901e-01,        -inf],
          [ 1.7466e+00, -1.9725e-01,  4.6235e-01,  5.3161e-01]],

         [[-4.2419e+00,        -inf,        -inf,        -inf],
          [-2.9948e-01, -3.4217e-01,        -inf,        -inf],
          [-4.8312e-01, -1.2730e+00, -3.9563e+00,        -inf],
          [ 2.5257e+00, -2.6123e+00, -6.6891e-02, -2.0501e+00]],

         [[-7.5659e-01,        -inf,        -inf,        -inf],
          [-2.4895e+00,  1.4007e+00,        -inf,        -inf],
          [-1.8184e+00,  1.4268e+00, -1.1157e+00,        -inf],
          [ 3.1951e+00,  4.3467e+00, -3.3441e-01, -1.5628e+00]],

         [[-7.3090e-01,        -inf,        -inf,        -inf],
          [-2.8536e+00,  3.1431e+00,        -inf,        -inf],
          [-1.2316e+00,  2.9846e+00,  3.6631e+00,        -inf],
          [-2.5187e+00,  3.4345e-01, -2.5024e+00, -2.5939e+00]],

         [[ 6.2584e+00,        -inf,        -inf,        -inf],
          [ 3.5888e+00, -2.4599e-01,        -inf,        -inf],
          [ 1.7334e+00, -1.2630e+00, -1.0238e-01,        -inf],
          [ 4.2634e+00, -8.2685e-01,  1.3811e+00,  1.3644e-01]],

         [[ 1.6871e+00,        -inf,        -inf,        -inf],
          [ 1.6357e+00, -3.7584e+00,        -inf,        -inf],
          [ 1.3461e+00,  1.8301e-01, -7.0279e+00,        -inf],
          [ 4.3580e+00,  2.6300e+00, -3.8241e+00,  1.6379e+00]],

         [[-8.8484e-04,        -inf,        -inf,        -inf],
          [-7.1056e-01, -2.9860e+00,        -inf,        -inf],
          [ 5.5516e-01, -1.2521e+00,  2.9731e+00,        -inf],
          [-1.7362e+00, -2.7872e-01, -2.1352e+00, -3.3550e+00]],

         [[ 7.4209e-01,        -inf,        -inf,        -inf],
          [ 4.2267e+00,  4.9058e+00,        -inf,        -inf],
          [ 1.8895e+00, -4.6365e+00, -3.8457e+00,        -inf],
          [-1.3107e+00,  2.5452e+00,  2.0016e+00,  6.9464e-01]],

         [[ 3.7267e+00,        -inf,        -inf,        -inf],
          [ 2.3240e-02,  2.8250e+00,        -inf,        -inf],
          [-1.6815e+00,  2.7300e+00,  1.2826e+00,        -inf],
          [-5.0180e-01,  1.5917e-01,  1.1982e+00,  2.3278e+00]],

         [[-1.8583e+00,        -inf,        -inf,        -inf],
          [ 4.0428e-01,  9.3390e-01,        -inf,        -inf],
          [ 8.2654e-01,  6.9144e-01, -2.7691e+00,        -inf],
          [ 2.0211e+00,  2.3723e+00, -3.2115e+00,  1.3372e+00]],

         [[-3.7508e+00,        -inf,        -inf,        -inf],
          [-1.1863e+00, -2.1415e+00,        -inf,        -inf],
          [-4.7825e+00, -2.9455e+00, -3.5645e+00,        -inf],
          [-4.6491e+00, -1.2226e+00, -5.4668e+00, -3.8864e+00]],

         [[ 1.0255e+00,        -inf,        -inf,        -inf],
          [-8.7317e-01,  1.2317e+00,        -inf,        -inf],
          [-9.0250e-01,  1.3901e+00,  3.6801e-02,        -inf],
          [ 3.3060e-02, -4.2201e-01, -2.2058e+00, -1.9878e+00]],

         [[ 6.2672e+00,        -inf,        -inf,        -inf],
          [ 5.8972e-01,  4.6787e-01,        -inf,        -inf],
          [ 1.2241e+00,  4.2967e+00, -1.7121e+00,        -inf],
          [-2.6749e+00,  6.8107e-01, -3.0072e+00, -4.3297e+00]],

         [[ 3.9982e+00,        -inf,        -inf,        -inf],
          [ 2.2459e+00, -6.5555e-02,        -inf,        -inf],
          [-4.0562e+00, -1.6874e+00, -2.3892e+00,        -inf],
          [-4.4049e-01, -6.0481e+00,  1.5008e+00, -1.7961e+00]],

         [[-2.3347e+00,        -inf,        -inf,        -inf],
          [-1.3014e+00, -5.2975e+00,        -inf,        -inf],
          [-2.5606e+00, -1.4389e+00, -2.9408e+00,        -inf],
          [ 2.7602e+00, -5.8487e-02,  1.2797e+00,  6.2732e-01]],

         [[-2.0632e+00,        -inf,        -inf,        -inf],
          [-3.7740e-01, -9.1933e-01,        -inf,        -inf],
          [-1.5763e+00, -1.1810e+00, -1.5231e+00,        -inf],
          [ 8.7163e-01,  2.2624e+00, -4.2935e+00, -9.1816e-01]],

         [[ 3.3845e-01,        -inf,        -inf,        -inf],
          [-3.5716e+00, -4.1750e+00,        -inf,        -inf],
          [-2.4009e+00, -2.2882e+00, -3.2780e+00,        -inf],
          [-7.3097e-01, -3.8857e-01, -2.0351e+00, -5.9247e+00]],

         [[ 5.5819e-01,        -inf,        -inf,        -inf],
          [ 5.5975e-02,  2.4929e-01,        -inf,        -inf],
          [-2.1515e+00, -3.6599e+00,  1.6050e+00,        -inf],
          [ 6.3346e-01,  2.9061e-01,  2.4004e-01, -4.4880e+00]],

         [[-5.0264e+00,        -inf,        -inf,        -inf],
          [-6.1719e+00,  1.0831e+00,        -inf,        -inf],
          [-1.8208e+00, -1.8181e+00, -4.2219e+00,        -inf],
          [-7.5489e+00, -1.2438e+00, -5.8423e+00, -2.7057e+00]],

         [[ 3.3394e-01,        -inf,        -inf,        -inf],
          [ 5.8244e+00,  3.1742e+00,        -inf,        -inf],
          [-1.0881e+00, -1.9778e+00, -1.7531e+00,        -inf],
          [-3.8352e+00,  2.4181e+00,  3.4179e+00,  2.4570e+00]],

         [[ 6.7005e-01,        -inf,        -inf,        -inf],
          [ 1.1583e+00,  1.9415e+00,        -inf,        -inf],
          [ 3.3498e+00,  3.2902e+00,  1.0455e+00,        -inf],
          [-4.6459e-01,  2.3483e+00,  2.1768e-01, -6.8833e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.1021e+00,        -inf,        -inf,        -inf],
          [-1.3499e+00, -4.3339e+00,        -inf,        -inf],
          [ 2.2160e+00,  3.2392e-01,  1.0295e+00,        -inf],
          [ 3.1286e-01,  3.1174e+00,  2.7798e+00,  1.7046e+00]],

         [[ 2.6198e+00,        -inf,        -inf,        -inf],
          [ 1.4099e+00,  2.0718e+00,        -inf,        -inf],
          [-2.3955e+00, -1.1918e+00, -4.8274e+00,        -inf],
          [-2.0891e-01,  2.3485e-01, -2.5938e+00, -1.5024e+00]],

         [[-1.2458e+00,        -inf,        -inf,        -inf],
          [-4.5615e+00, -4.9856e-01,        -inf,        -inf],
          [ 5.6632e-01, -1.6239e-01, -1.9761e+00,        -inf],
          [ 2.3021e+00,  9.0289e-01,  2.6011e-01, -6.8534e-01]],

         [[ 5.6927e-01,        -inf,        -inf,        -inf],
          [-1.0729e+00, -1.7221e-01,        -inf,        -inf],
          [-7.1511e-01,  2.3067e+00,  4.7658e-01,        -inf],
          [ 3.5691e-01, -3.6451e+00,  8.2933e-02, -6.2000e+00]],

         [[-3.1308e+00,        -inf,        -inf,        -inf],
          [-9.0369e-01, -1.5466e+00,        -inf,        -inf],
          [-1.8247e+00, -1.7270e+00,  6.2176e+00,        -inf],
          [-1.4787e+00, -1.0299e+00,  1.8122e+00,  4.0015e+00]],

         [[-3.3811e-01,        -inf,        -inf,        -inf],
          [-2.6557e+00, -3.3366e+00,        -inf,        -inf],
          [ 9.2731e-01, -3.2564e+00,  2.9601e+00,        -inf],
          [-1.3933e+00, -4.6115e+00, -3.8658e+00, -1.2750e+00]],

         [[-3.4757e+00,        -inf,        -inf,        -inf],
          [-3.1879e+00, -7.4101e-01,        -inf,        -inf],
          [-2.8932e+00,  1.9958e+00,  2.4467e+00,        -inf],
          [-1.5317e+00, -1.6305e+00, -1.0573e+00,  8.4499e-01]],

         [[-2.7705e+00,        -inf,        -inf,        -inf],
          [-2.1367e+00, -1.0537e+00,        -inf,        -inf],
          [-1.1793e+00, -8.1102e-01,  2.7279e+00,        -inf],
          [ 8.5469e-02,  4.3532e+00,  3.5086e+00,  1.6223e-01]],

         [[ 2.0588e+00,        -inf,        -inf,        -inf],
          [-1.4931e+00, -5.0392e-01,        -inf,        -inf],
          [-1.9480e+00, -3.9026e+00, -1.4192e+00,        -inf],
          [ 3.2740e+00,  2.0359e+00, -1.0811e-01,  3.5442e-01]],

         [[-2.7128e+00,        -inf,        -inf,        -inf],
          [-2.2778e-01,  3.0920e+00,        -inf,        -inf],
          [ 5.4610e-01,  1.9805e+00, -1.9987e-01,        -inf],
          [ 7.8346e-01,  4.7705e+00,  1.3239e+00, -8.3066e-01]],

         [[ 4.7218e-01,        -inf,        -inf,        -inf],
          [ 1.0588e+00,  2.7069e+00,        -inf,        -inf],
          [ 1.4248e+00,  2.8640e+00,  2.0067e+00,        -inf],
          [ 1.8398e+00,  4.4976e+00,  2.8488e-01, -4.2844e-02]],

         [[-5.0535e-01,        -inf,        -inf,        -inf],
          [-1.1285e+00,  3.5467e-01,        -inf,        -inf],
          [-6.7744e+00,  1.0645e+00, -3.3561e+00,        -inf],
          [-1.7801e+00,  7.1417e-01, -3.7038e+00, -1.2768e+00]],

         [[ 1.0698e+00,        -inf,        -inf,        -inf],
          [-2.0195e+00,  3.1476e+00,        -inf,        -inf],
          [-2.2886e+00,  3.6595e+00,  9.4243e-01,        -inf],
          [-6.6931e-01,  2.1700e+00,  1.0536e+00,  3.2408e+00]],

         [[-9.6308e-01,        -inf,        -inf,        -inf],
          [-2.1913e+00,  5.2313e+00,        -inf,        -inf],
          [-2.8033e+00,  1.7098e+00, -3.5534e+00,        -inf],
          [-1.1755e-01,  6.2123e+00, -1.4967e+00,  3.7253e+00]],

         [[ 1.6063e-01,        -inf,        -inf,        -inf],
          [ 2.5159e+00,  2.2985e+00,        -inf,        -inf],
          [-1.8466e-01,  1.8311e+00, -7.6998e-01,        -inf],
          [ 4.3533e-01,  1.5553e+00, -4.3539e+00, -8.9849e-01]],

         [[-8.3177e-01,        -inf,        -inf,        -inf],
          [-2.6520e-01,  2.7507e+00,        -inf,        -inf],
          [-2.6067e-01,  4.0995e+00,  2.2544e+00,        -inf],
          [ 2.4693e+00,  5.0043e+00,  3.2899e+00, -2.4142e+00]],

         [[ 3.5026e+00,        -inf,        -inf,        -inf],
          [-1.0643e+00,  2.1856e+00,        -inf,        -inf],
          [ 4.1077e+00,  7.0179e+00,  8.0394e+00,        -inf],
          [-2.2254e+00,  1.6256e-01, -3.5214e+00, -9.0777e-01]],

         [[ 1.8049e+00,        -inf,        -inf,        -inf],
          [-3.6032e+00, -6.8319e+00,        -inf,        -inf],
          [-1.7349e+00, -7.1024e-01,  9.3626e-01,        -inf],
          [-2.5679e+00, -1.9092e+00, -2.5603e+00, -4.2228e+00]],

         [[-2.3236e+00,        -inf,        -inf,        -inf],
          [-2.0146e-01,  6.0074e-01,        -inf,        -inf],
          [-2.6088e+00, -3.8383e+00, -4.9894e-01,        -inf],
          [ 2.9349e+00, -3.8991e+00, -1.1452e+00, -3.4007e+00]],

         [[-3.0858e+00,        -inf,        -inf,        -inf],
          [-4.9795e+00, -4.0738e+00,        -inf,        -inf],
          [ 1.6393e+00, -1.7769e+00, -6.9346e-01,        -inf],
          [-2.7580e-01, -1.2361e+00, -6.2906e-02,  9.6737e-01]],

         [[-1.1949e+00,        -inf,        -inf,        -inf],
          [-1.8465e+00, -4.6361e+00,        -inf,        -inf],
          [-1.0377e+00, -7.1555e-01,  1.3795e+00,        -inf],
          [-1.4730e+00, -2.1976e-01, -1.8291e+00, -1.8321e+00]],

         [[ 4.3557e-01,        -inf,        -inf,        -inf],
          [ 7.0723e-01, -1.7213e+00,        -inf,        -inf],
          [ 1.5663e+00, -1.8767e+00, -1.1013e+00,        -inf],
          [ 2.8884e+00,  1.0805e-01, -1.7283e+00,  5.0632e-01]],

         [[-2.4638e+00,        -inf,        -inf,        -inf],
          [ 1.3095e+00,  2.0078e+00,        -inf,        -inf],
          [-5.4043e+00, -5.3547e+00, -2.3230e+00,        -inf],
          [-1.3824e+00, -3.2235e+00, -3.9569e+00, -5.2905e+00]],

         [[ 2.3508e-01,        -inf,        -inf,        -inf],
          [ 4.7018e+00,  2.8952e+00,        -inf,        -inf],
          [ 2.6432e+00,  2.4466e+00,  2.8145e-01,        -inf],
          [-1.6865e+00,  1.0942e+00, -2.7447e+00, -2.8997e-01]],

         [[-1.8611e+00,        -inf,        -inf,        -inf],
          [-5.3349e-01,  2.1121e-01,        -inf,        -inf],
          [ 1.8251e+00,  1.9533e+00,  3.4373e+00,        -inf],
          [-3.1351e-01,  2.5248e+00,  3.3439e-01, -3.6169e+00]]],


        [[[ 1.3952e+00,        -inf,        -inf,        -inf],
          [-1.7094e+00, -6.0601e-01,        -inf,        -inf],
          [-1.1785e-01, -1.6975e+00,  7.3782e-01,        -inf],
          [ 1.7214e+00, -4.2165e-01, -5.9014e-01,  3.7349e+00]],

         [[-5.4724e-01,        -inf,        -inf,        -inf],
          [ 4.8103e+00,  1.0153e+00,        -inf,        -inf],
          [ 5.1697e+00, -2.3757e-01,  4.9520e-01,        -inf],
          [-3.8689e-01, -2.6351e+00, -2.5311e-01, -7.1495e-01]],

         [[-6.5453e-01,        -inf,        -inf,        -inf],
          [-2.1945e+00, -6.8731e+00,        -inf,        -inf],
          [ 2.2386e+00, -4.1681e+00, -4.6643e+00,        -inf],
          [-2.3658e+00, -3.2497e+00, -1.3190e+00, -1.8349e+00]],

         [[-5.5765e+00,        -inf,        -inf,        -inf],
          [-1.0298e+00,  5.8881e-01,        -inf,        -inf],
          [-1.7792e+00, -3.7140e+00,  4.6240e-01,        -inf],
          [ 1.9442e+00, -2.3897e+00,  1.4366e-01, -1.5983e+00]],

         [[-1.5093e+00,        -inf,        -inf,        -inf],
          [-2.1006e+00,  7.8320e-01,        -inf,        -inf],
          [-1.0568e+00, -8.5628e-01, -5.4901e-01,        -inf],
          [ 1.7466e+00, -1.9725e-01,  4.6235e-01,  5.3161e-01]],

         [[-4.2419e+00,        -inf,        -inf,        -inf],
          [-2.9948e-01, -3.4217e-01,        -inf,        -inf],
          [-4.8312e-01, -1.2730e+00, -3.9563e+00,        -inf],
          [ 2.5257e+00, -2.6123e+00, -6.6891e-02, -2.0501e+00]],

         [[-7.5659e-01,        -inf,        -inf,        -inf],
          [-2.4895e+00,  1.4007e+00,        -inf,        -inf],
          [-1.8184e+00,  1.4268e+00, -1.1157e+00,        -inf],
          [ 3.1951e+00,  4.3467e+00, -3.3441e-01, -1.5628e+00]],

         [[-7.3090e-01,        -inf,        -inf,        -inf],
          [-2.8536e+00,  3.1431e+00,        -inf,        -inf],
          [-1.2316e+00,  2.9846e+00,  3.6631e+00,        -inf],
          [-2.5187e+00,  3.4345e-01, -2.5024e+00, -2.5939e+00]],

         [[ 6.2584e+00,        -inf,        -inf,        -inf],
          [ 3.5888e+00, -2.4599e-01,        -inf,        -inf],
          [ 1.7334e+00, -1.2630e+00, -1.0238e-01,        -inf],
          [ 4.2634e+00, -8.2685e-01,  1.3811e+00,  1.3644e-01]],

         [[ 1.6871e+00,        -inf,        -inf,        -inf],
          [ 1.6357e+00, -3.7584e+00,        -inf,        -inf],
          [ 1.3461e+00,  1.8301e-01, -7.0279e+00,        -inf],
          [ 4.3580e+00,  2.6300e+00, -3.8241e+00,  1.6379e+00]],

         [[-8.8484e-04,        -inf,        -inf,        -inf],
          [-7.1056e-01, -2.9860e+00,        -inf,        -inf],
          [ 5.5516e-01, -1.2521e+00,  2.9731e+00,        -inf],
          [-1.7362e+00, -2.7872e-01, -2.1352e+00, -3.3550e+00]],

         [[ 7.4209e-01,        -inf,        -inf,        -inf],
          [ 4.2267e+00,  4.9058e+00,        -inf,        -inf],
          [ 1.8895e+00, -4.6365e+00, -3.8457e+00,        -inf],
          [-1.3107e+00,  2.5452e+00,  2.0016e+00,  6.9464e-01]],

         [[ 3.7267e+00,        -inf,        -inf,        -inf],
          [ 2.3240e-02,  2.8250e+00,        -inf,        -inf],
          [-1.6815e+00,  2.7300e+00,  1.2826e+00,        -inf],
          [-5.0180e-01,  1.5917e-01,  1.1982e+00,  2.3278e+00]],

         [[-1.8583e+00,        -inf,        -inf,        -inf],
          [ 4.0428e-01,  9.3390e-01,        -inf,        -inf],
          [ 8.2654e-01,  6.9144e-01, -2.7691e+00,        -inf],
          [ 2.0211e+00,  2.3723e+00, -3.2115e+00,  1.3372e+00]],

         [[-3.7508e+00,        -inf,        -inf,        -inf],
          [-1.1863e+00, -2.1415e+00,        -inf,        -inf],
          [-4.7825e+00, -2.9455e+00, -3.5645e+00,        -inf],
          [-4.6491e+00, -1.2226e+00, -5.4668e+00, -3.8864e+00]],

         [[ 1.0255e+00,        -inf,        -inf,        -inf],
          [-8.7317e-01,  1.2317e+00,        -inf,        -inf],
          [-9.0250e-01,  1.3901e+00,  3.6801e-02,        -inf],
          [ 3.3060e-02, -4.2201e-01, -2.2058e+00, -1.9878e+00]],

         [[ 6.2672e+00,        -inf,        -inf,        -inf],
          [ 5.8972e-01,  4.6787e-01,        -inf,        -inf],
          [ 1.2241e+00,  4.2967e+00, -1.7121e+00,        -inf],
          [-2.6749e+00,  6.8107e-01, -3.0072e+00, -4.3297e+00]],

         [[ 3.9982e+00,        -inf,        -inf,        -inf],
          [ 2.2459e+00, -6.5555e-02,        -inf,        -inf],
          [-4.0562e+00, -1.6874e+00, -2.3892e+00,        -inf],
          [-4.4049e-01, -6.0481e+00,  1.5008e+00, -1.7961e+00]],

         [[-2.3347e+00,        -inf,        -inf,        -inf],
          [-1.3014e+00, -5.2975e+00,        -inf,        -inf],
          [-2.5606e+00, -1.4389e+00, -2.9408e+00,        -inf],
          [ 2.7602e+00, -5.8487e-02,  1.2797e+00,  6.2732e-01]],

         [[-2.0632e+00,        -inf,        -inf,        -inf],
          [-3.7740e-01, -9.1933e-01,        -inf,        -inf],
          [-1.5763e+00, -1.1810e+00, -1.5231e+00,        -inf],
          [ 8.7163e-01,  2.2624e+00, -4.2935e+00, -9.1816e-01]],

         [[ 3.3845e-01,        -inf,        -inf,        -inf],
          [-3.5716e+00, -4.1750e+00,        -inf,        -inf],
          [-2.4009e+00, -2.2882e+00, -3.2780e+00,        -inf],
          [-7.3097e-01, -3.8857e-01, -2.0351e+00, -5.9247e+00]],

         [[ 5.5819e-01,        -inf,        -inf,        -inf],
          [ 5.5975e-02,  2.4929e-01,        -inf,        -inf],
          [-2.1515e+00, -3.6599e+00,  1.6050e+00,        -inf],
          [ 6.3346e-01,  2.9061e-01,  2.4004e-01, -4.4880e+00]],

         [[-5.0264e+00,        -inf,        -inf,        -inf],
          [-6.1719e+00,  1.0831e+00,        -inf,        -inf],
          [-1.8208e+00, -1.8181e+00, -4.2219e+00,        -inf],
          [-7.5489e+00, -1.2438e+00, -5.8423e+00, -2.7057e+00]],

         [[ 3.3394e-01,        -inf,        -inf,        -inf],
          [ 5.8244e+00,  3.1742e+00,        -inf,        -inf],
          [-1.0881e+00, -1.9778e+00, -1.7531e+00,        -inf],
          [-3.8352e+00,  2.4181e+00,  3.4179e+00,  2.4570e+00]],

         [[ 6.7005e-01,        -inf,        -inf,        -inf],
          [ 1.1583e+00,  1.9415e+00,        -inf,        -inf],
          [ 3.3498e+00,  3.2902e+00,  1.0455e+00,        -inf],
          [-4.6459e-01,  2.3483e+00,  2.1768e-01, -6.8833e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-9.1531e-01, -3.9511e-01, -5.0251e-01,  ..., -6.8377e-01,
           -5.7701e-01, -5.6071e-01],
          [-3.6803e-01, -5.0694e-01, -1.3640e-01,  ...,  1.0002e+00,
            9.3362e-01,  3.3473e-01],
          [ 7.9272e-01, -2.9843e-01,  6.2285e-01,  ...,  8.1015e-01,
           -4.2886e-01, -5.4571e-02],
          ...,
          [-9.3286e-03,  9.4487e-01,  4.1295e-01,  ..., -7.1652e-01,
           -1.5714e+00, -7.6924e-02],
          [ 3.8055e-01, -4.4838e-01, -8.3150e-01,  ..., -1.1055e+00,
            7.8204e-01,  4.8660e-02],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00]],

         [[-7.7140e-01,  4.5285e-02, -5.6631e-02,  ..., -8.1305e-01,
           -5.0433e-01, -2.6905e-01],
          [-1.7641e-01, -2.4299e-01, -6.5379e-02,  ...,  4.7945e-01,
            4.4751e-01,  1.6045e-01],
          [ 2.9782e-01, -1.1212e-01,  2.3400e-01,  ...,  3.0437e-01,
           -1.6112e-01, -2.0502e-02],
          ...,
          [-4.4609e-03,  4.5183e-01,  1.9747e-01,  ..., -3.4264e-01,
           -7.5144e-01, -3.6785e-02],
          [ 3.8166e-01, -7.7866e-01, -2.2273e-01,  ..., -2.8892e-01,
            7.2890e-01,  5.6469e-02],
          [-1.6007e+00,  6.9044e-01,  3.6448e-01,  ...,  7.0293e-03,
           -9.1433e-01, -3.7614e-01]],

         [[-5.1264e-01,  5.4851e-02, -1.3623e-02,  ..., -5.5582e-01,
           -3.3633e-01, -1.6548e-01],
          [ 5.9985e-02, -2.0112e-01,  1.2525e-01,  ...,  1.8413e-01,
            2.5391e-01, -1.7909e-01],
          [ 5.9483e-01, -5.8774e-01,  5.3562e-01,  ...,  6.9899e-02,
           -3.9457e-01, -2.0928e-01],
          ...,
          [-1.2158e-01,  5.7109e-01,  9.9379e-01,  ...,  1.3606e-01,
           -5.4197e-01,  5.2917e-02],
          [-2.1208e-02, -6.0467e-01,  2.3467e-01,  ...,  3.1497e-01,
            4.2812e-01, -3.5196e-01],
          [-1.3371e+00,  2.0399e-01,  2.2572e-01,  ..., -1.4905e-01,
           -7.7897e-01, -1.9469e-01]],

         [[-5.0799e-01,  3.0943e-01,  2.2605e-01,  ..., -3.5961e-01,
           -1.5515e-01, -2.3060e-01],
          [ 3.4360e-02, -1.6823e-01,  8.2883e-02,  ...,  1.5888e-01,
            2.1533e-01, -1.1511e-01],
          [ 7.2220e-01, -5.4512e-01,  3.1642e-01,  ..., -2.9936e-02,
           -2.6669e-01, -3.5070e-02],
          ...,
          [-3.2241e-01,  4.1364e-01,  6.2027e-01,  ..., -8.0361e-02,
           -6.5935e-01, -6.7891e-02],
          [ 1.2190e-01, -6.2366e-01, -1.0996e-01,  ..., -3.6609e-02,
            7.5992e-01, -6.8198e-02],
          [-1.2836e+00,  2.7114e-01,  2.8013e-01,  ...,  6.1402e-02,
           -6.8986e-01, -2.9171e-01]]],


        [[[-9.2584e-01,  2.7328e-02,  2.6705e-01,  ..., -5.6961e-01,
           -5.6552e-01,  1.9975e-01],
          [-3.9141e-01, -9.3985e-01, -5.8727e-01,  ...,  5.2792e-01,
            6.5800e-01,  1.0116e+00],
          [ 4.2742e-01,  1.4620e-01,  5.7104e-01,  ...,  7.2389e-01,
           -1.4992e-01, -3.0305e-01],
          ...,
          [-4.6791e-04,  1.1978e+00,  7.6146e-01,  ..., -4.3116e-01,
           -1.6891e+00,  4.5254e-01],
          [-7.0158e-01, -2.0299e-02, -3.5419e-01,  ..., -7.9749e-01,
            1.3396e+00, -1.6963e-01],
          [-1.0689e+00,  1.2273e+00,  1.5714e-01,  ..., -3.0092e-01,
           -5.8608e-01, -1.1974e+00]],

         [[ 2.4968e-01,  3.5906e-02,  3.4084e-01,  ..., -1.5681e-01,
            3.5998e-01, -5.0872e-02],
          [-2.4127e-01, -5.7934e-01, -3.6201e-01,  ...,  3.2542e-01,
            4.0560e-01,  6.2356e-01],
          [ 2.7448e-01,  9.3884e-02,  3.6671e-01,  ...,  4.6487e-01,
           -9.6272e-02, -1.9461e-01],
          ...,
          [ 3.5706e-03,  7.3512e-01,  8.0236e-01,  ..., -2.8566e-01,
           -1.4337e-01, -2.3175e-02],
          [-3.5275e-01, -2.1506e-01,  1.5073e-01,  ..., -6.8934e-01,
            1.0322e+00,  1.9514e-01],
          [-5.0830e-01,  5.8365e-01,  7.4725e-02,  ..., -1.4310e-01,
           -2.7871e-01, -5.6942e-01]],

         [[-4.5652e-01, -3.1549e-01,  4.0182e-01,  ..., -3.6078e-01,
           -4.6794e-01,  2.4287e-01],
          [ 7.9200e-02, -6.8021e-01, -5.5165e-02,  ...,  3.1916e-01,
            7.5642e-01,  8.3877e-01],
          [ 9.1896e-02,  1.1336e-01,  2.6298e-01,  ...,  3.0948e-01,
           -4.9533e-01,  1.0521e-01],
          ...,
          [-2.0007e-01,  8.9188e-01,  8.7187e-01,  ..., -4.4082e-02,
           -6.7964e-01, -2.6077e-02],
          [-1.3805e-01, -4.7289e-01,  3.6325e-01,  ..., -3.0430e-01,
            4.8875e-01,  1.2835e-01],
          [-5.3882e-01,  1.1268e-01, -1.3390e-01,  ..., -1.3379e-01,
           -5.4541e-01, -3.8039e-01]],

         [[-2.2281e-01, -1.4805e-01,  3.6014e-01,  ..., -2.9553e-01,
           -1.5620e-01,  1.2422e-01],
          [ 8.5906e-02, -2.7056e-01, -1.9284e-01,  ...,  1.1175e-01,
            5.1828e-01,  9.4664e-01],
          [-2.6614e-02,  2.6543e-01, -2.4036e-01,  ..., -2.5463e-02,
           -4.6785e-01,  5.5639e-01],
          ...,
          [-1.4519e-01,  5.4209e-01,  1.0095e+00,  ..., -1.2757e-01,
           -5.8793e-01, -1.6187e-01],
          [-2.6227e-01, -4.1956e-01,  2.7839e-01,  ..., -5.1431e-01,
            8.3048e-01,  4.5691e-02],
          [-1.1105e+00,  2.7244e-01, -8.7175e-02,  ...,  3.3878e-02,
           -9.7694e-01, -2.1587e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.9153, -0.3951, -0.5025,  ...,  0.0000,  0.0000,  0.0000],
         [-0.7714,  0.0453, -0.0566,  ...,  0.0070, -0.9143, -0.3761],
         [-0.5126,  0.0549, -0.0136,  ..., -0.1490, -0.7790, -0.1947],
         [-0.5080,  0.3094,  0.2261,  ...,  0.0614, -0.6899, -0.2917]],

        [[-0.9258,  0.0273,  0.2671,  ..., -0.3009, -0.5861, -1.1974],
         [ 0.2497,  0.0359,  0.3408,  ..., -0.1431, -0.2787, -0.5694],
         [-0.4565, -0.3155,  0.4018,  ..., -0.1338, -0.5454, -0.3804],
         [-0.2228, -0.1481,  0.3601,  ...,  0.0339, -0.9769, -0.2159]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.3696, -0.6147,  0.7112,  ...,  0.0836,  0.0616, -0.4267],
         [-0.3364, -0.0316,  0.2957,  ..., -0.1320, -0.0757, -0.2529],
         [-0.4025, -0.1812,  0.0244,  ..., -0.2053, -0.1000, -0.0241],
         [-0.4014, -0.1197,  0.0365,  ...,  0.0144, -0.1101, -0.0910]],

        [[-0.1703, -0.4140,  0.3187,  ...,  0.2453,  0.0158, -0.4011],
         [-0.1303, -0.3354, -0.1879,  ...,  0.0363, -0.2712, -0.0808],
         [-0.0544, -0.2327, -0.3095,  ...,  0.1486, -0.2171, -0.0663],
         [-0.3505, -0.3965, -0.1690,  ...,  0.0390, -0.1906, -0.1875]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.3631e+00,        -inf,        -inf,        -inf],
          [-4.0302e+00,  2.5465e-01,        -inf,        -inf],
          [-2.2858e+00, -7.9326e-01, -4.8440e+00,        -inf],
          [-2.3930e+00, -3.2835e+00, -4.4693e+00,  1.4581e+00]],

         [[-1.4570e-02,        -inf,        -inf,        -inf],
          [-1.0712e+00, -8.9379e-01,        -inf,        -inf],
          [-2.9609e+00,  3.1242e-02, -1.3216e+00,        -inf],
          [-2.1768e+00,  6.0252e-02, -1.0961e+00,  1.3030e+00]],

         [[ 3.2520e-01,        -inf,        -inf,        -inf],
          [-1.2441e+00, -5.6895e+00,        -inf,        -inf],
          [-2.2176e+00,  1.4034e+00,  4.3855e-01,        -inf],
          [ 4.5973e-01,  4.0767e+00,  1.0156e+00,  1.0740e+00]],

         [[ 2.3853e+00,        -inf,        -inf,        -inf],
          [ 7.0251e+00,  6.0918e-02,        -inf,        -inf],
          [ 7.4711e+00, -4.0861e+00,  2.7970e-01,        -inf],
          [ 6.5727e+00,  1.8767e+00,  2.6181e+00, -9.2208e-01]],

         [[ 2.2790e+00,        -inf,        -inf,        -inf],
          [ 2.9652e+00,  4.8684e+00,        -inf,        -inf],
          [-1.3557e+00, -1.2784e+00,  3.6040e-01,        -inf],
          [ 1.3423e+00,  7.2488e-01,  3.4993e+00, -2.9731e+00]],

         [[-4.7038e-01,        -inf,        -inf,        -inf],
          [-2.9040e+00, -4.7142e+00,        -inf,        -inf],
          [-9.7380e-01, -5.4233e+00, -3.9441e+00,        -inf],
          [ 6.0853e-01, -2.0086e-01,  6.1630e+00,  5.2884e+00]],

         [[ 9.6947e-01,        -inf,        -inf,        -inf],
          [ 6.0740e+00,  1.2932e+00,        -inf,        -inf],
          [ 4.0129e+00,  3.1563e+00,  9.7374e-01,        -inf],
          [ 9.1329e-01,  4.5046e+00, -8.0744e-01, -6.0284e-01]],

         [[ 1.5676e+00,        -inf,        -inf,        -inf],
          [ 5.3981e+00,  2.8559e+00,        -inf,        -inf],
          [-6.0579e-01, -1.3140e+00,  1.2180e+00,        -inf],
          [-4.2660e-01, -6.2607e-01, -1.0269e+00,  4.5959e+00]],

         [[-4.3892e-01,        -inf,        -inf,        -inf],
          [-2.7663e+00,  5.1948e-01,        -inf,        -inf],
          [ 2.6497e+00,  1.1654e+00,  1.0542e+00,        -inf],
          [-1.1655e+00, -1.3358e+00,  9.2033e-01, -8.5745e-01]],

         [[-3.0099e+00,        -inf,        -inf,        -inf],
          [-8.6737e-01, -4.8768e+00,        -inf,        -inf],
          [ 1.8707e+00, -1.4487e+00,  5.1485e+00,        -inf],
          [-1.1262e+00, -4.4973e-01, -9.8761e-01, -5.9558e-01]],

         [[ 4.3769e+00,        -inf,        -inf,        -inf],
          [ 4.9831e+00,  5.1011e+00,        -inf,        -inf],
          [-1.6717e+00, -1.5526e+00, -1.6826e+00,        -inf],
          [ 3.0311e-01,  1.1992e+00,  5.4634e-01, -4.7535e-02]],

         [[-6.3535e+00,        -inf,        -inf,        -inf],
          [-3.8072e+00, -1.6035e+00,        -inf,        -inf],
          [-3.3193e+00,  4.9141e-01, -4.1381e+00,        -inf],
          [-4.3028e+00, -1.2707e+00, -2.1822e+00, -3.7067e+00]],

         [[ 4.8703e+00,        -inf,        -inf,        -inf],
          [ 1.9677e+00, -1.4054e+00,        -inf,        -inf],
          [ 1.2991e+00, -1.5478e+00,  3.1248e+00,        -inf],
          [-2.0077e+00, -1.8940e+00, -7.5292e-01, -3.8221e+00]],

         [[ 6.2151e-01,        -inf,        -inf,        -inf],
          [-3.1095e+00, -2.7005e+00,        -inf,        -inf],
          [ 4.3401e-01,  1.0277e+00, -1.9249e+00,        -inf],
          [ 2.1304e-03,  4.0069e+00,  8.3444e-01,  1.7033e-01]],

         [[-3.5206e+00,        -inf,        -inf,        -inf],
          [-2.0892e+00,  1.7005e+00,        -inf,        -inf],
          [ 5.4520e+00,  3.0043e+00,  8.4493e+00,        -inf],
          [-7.9691e-02,  2.2687e+00,  5.0027e+00,  2.4462e+00]],

         [[-2.4368e+00,        -inf,        -inf,        -inf],
          [-1.8063e+00, -2.2482e+00,        -inf,        -inf],
          [-1.5563e+00, -5.2770e-01, -4.3003e+00,        -inf],
          [ 2.0010e+00, -1.4066e+00,  2.2799e+00,  2.7088e+00]],

         [[-1.3076e+00,        -inf,        -inf,        -inf],
          [ 5.6329e+00,  2.8472e+00,        -inf,        -inf],
          [ 3.0262e+00,  1.3321e+00,  1.6314e+00,        -inf],
          [ 3.6076e-01, -8.9251e-01,  3.6041e+00,  1.1532e+00]],

         [[-1.1553e+00,        -inf,        -inf,        -inf],
          [ 1.0681e+00, -6.8697e-02,        -inf,        -inf],
          [ 3.4838e+00,  3.8950e+00,  9.5660e-01,        -inf],
          [ 2.1313e+00,  1.1450e+00, -2.3033e-01, -4.3469e-01]],

         [[-3.9281e-01,        -inf,        -inf,        -inf],
          [-2.6921e+00, -6.7230e-02,        -inf,        -inf],
          [ 1.5693e+00,  1.1656e+00,  5.5806e-01,        -inf],
          [-2.8305e+00, -1.8734e+00,  2.5412e+00, -5.4487e+00]],

         [[ 1.7694e-01,        -inf,        -inf,        -inf],
          [ 3.1812e+00,  2.9713e-01,        -inf,        -inf],
          [ 2.1753e+00,  2.0635e+00,  2.4650e+00,        -inf],
          [ 3.1037e+00,  4.8658e-01,  1.5029e+00,  1.6490e+00]],

         [[ 4.0034e+00,        -inf,        -inf,        -inf],
          [-2.3546e-01, -1.0836e+00,        -inf,        -inf],
          [-1.7507e+00, -7.1921e+00, -3.6694e+00,        -inf],
          [ 4.2440e-01,  4.4267e+00,  1.6933e+00,  2.8565e-02]],

         [[-2.8347e+00,        -inf,        -inf,        -inf],
          [-2.7239e+00,  4.1729e+00,        -inf,        -inf],
          [ 7.5527e-01, -1.8573e+00, -4.6273e-01,        -inf],
          [-9.5024e-01,  9.0506e-01,  2.8845e+00,  9.0956e-01]],

         [[-4.4916e+00,        -inf,        -inf,        -inf],
          [ 1.4652e+00, -3.1403e-01,        -inf,        -inf],
          [ 5.8983e-01, -1.0162e-01, -7.6105e-01,        -inf],
          [ 1.3521e+00,  2.5198e+00,  1.1916e+00,  3.8398e-01]],

         [[-6.5158e-01,        -inf,        -inf,        -inf],
          [ 1.1487e+00,  2.3568e+00,        -inf,        -inf],
          [ 5.5044e+00,  6.3596e+00, -2.2729e+00,        -inf],
          [ 4.9442e+00,  4.0820e+00, -4.3401e+00, -2.5599e+00]],

         [[ 8.1150e-01,        -inf,        -inf,        -inf],
          [-9.5751e-01, -1.6752e+00,        -inf,        -inf],
          [ 1.3809e-01, -8.6496e-01, -2.9154e+00,        -inf],
          [ 5.1322e+00, -3.4822e+00, -3.3775e+00, -5.1818e-01]]],


        [[[-3.1942e+00,        -inf,        -inf,        -inf],
          [-6.6736e+00, -5.9563e+00,        -inf,        -inf],
          [-2.6332e+00, -3.9503e+00, -4.5219e+00,        -inf],
          [-3.9669e+00, -5.1399e+00, -3.3517e+00, -1.7590e+00]],

         [[-5.5723e-01,        -inf,        -inf,        -inf],
          [ 5.7756e-01,  9.4948e-01,        -inf,        -inf],
          [-2.7332e+00, -7.4547e-01,  1.3382e+00,        -inf],
          [-1.1587e+00,  3.2792e-01, -2.0226e+00,  6.2059e-01]],

         [[ 2.1713e+00,        -inf,        -inf,        -inf],
          [ 1.5394e-01, -2.1355e-01,        -inf,        -inf],
          [ 2.2652e+00,  3.5827e+00,  4.2138e+00,        -inf],
          [ 1.5321e+00,  2.8808e+00, -1.8930e+00,  3.6399e+00]],

         [[ 2.4949e+00,        -inf,        -inf,        -inf],
          [ 2.5076e+00,  2.5045e+00,        -inf,        -inf],
          [ 7.6052e+00,  6.4956e+00,  8.8332e-01,        -inf],
          [ 4.5937e+00,  2.6182e+00,  2.5622e+00,  6.6265e+00]],

         [[ 2.7865e+00,        -inf,        -inf,        -inf],
          [ 2.2543e+00,  2.4134e+00,        -inf,        -inf],
          [ 2.7724e-01, -2.7810e+00,  9.5937e-01,        -inf],
          [-8.7904e-01, -9.6883e-01, -4.4175e+00,  1.6027e+00]],

         [[ 2.9551e-01,        -inf,        -inf,        -inf],
          [ 7.3097e-01, -1.3945e+00,        -inf,        -inf],
          [ 2.6240e+00, -1.8014e+00, -1.4928e+00,        -inf],
          [ 7.1216e-01,  3.3614e+00,  2.9572e+00,  4.8463e+00]],

         [[ 1.1660e+00,        -inf,        -inf,        -inf],
          [ 4.3162e+00,  8.6996e-03,        -inf,        -inf],
          [ 1.9286e+00,  5.3355e-02,  1.0367e+00,        -inf],
          [-9.2181e-01, -1.8267e+00,  7.4401e-01,  1.6669e-01]],

         [[ 1.6785e+00,        -inf,        -inf,        -inf],
          [-1.6150e-01,  1.2385e+00,        -inf,        -inf],
          [-2.4661e+00, -1.9137e+00, -2.9447e-01,        -inf],
          [-1.0174e+00, -5.0482e-01, -2.1899e+00,  7.7924e-01]],

         [[-5.9705e-01,        -inf,        -inf,        -inf],
          [ 9.1890e-01, -1.2349e+00,        -inf,        -inf],
          [ 1.8201e+00,  9.2240e-01,  2.2796e+00,        -inf],
          [-1.2060e+00,  2.9431e+00, -4.8046e-01, -3.6217e+00]],

         [[ 6.2651e-01,        -inf,        -inf,        -inf],
          [-3.7810e+00, -4.6330e+00,        -inf,        -inf],
          [ 1.2059e-01,  1.3576e-01, -9.9854e-01,        -inf],
          [ 2.4384e+00,  1.0927e+00,  6.1780e-01, -4.9698e-01]],

         [[ 6.5266e+00,        -inf,        -inf,        -inf],
          [ 7.7434e+00,  4.9027e+00,        -inf,        -inf],
          [ 5.0769e+00,  1.9135e+00,  7.4909e-01,        -inf],
          [ 1.7771e+00,  2.3961e+00, -1.2982e+00,  3.9426e+00]],

         [[-6.1806e+00,        -inf,        -inf,        -inf],
          [-8.7806e-01,  8.9874e-01,        -inf,        -inf],
          [-5.2609e+00, -6.8267e+00, -4.4768e+00,        -inf],
          [ 2.4297e+00, -5.9690e-01,  4.4841e-01,  1.8118e+00]],

         [[-1.3658e+00,        -inf,        -inf,        -inf],
          [-3.5839e+00,  1.1525e+00,        -inf,        -inf],
          [ 5.9476e-01,  1.8468e+00,  2.2979e+00,        -inf],
          [-1.7013e-01, -2.5588e+00,  1.1808e+00, -6.2423e+00]],

         [[-4.7558e-01,        -inf,        -inf,        -inf],
          [ 1.1497e+00, -9.5057e-01,        -inf,        -inf],
          [ 2.2112e+00,  1.7000e+00,  7.8679e-01,        -inf],
          [ 7.7947e-01,  1.1231e+00,  2.8589e+00,  8.2396e+00]],

         [[-1.0182e+00,        -inf,        -inf,        -inf],
          [-4.2219e-01,  2.7523e+00,        -inf,        -inf],
          [ 9.1216e-01,  1.9646e+00,  3.7273e+00,        -inf],
          [-1.3935e+00, -3.4293e-01,  3.0917e-01,  2.6268e+00]],

         [[-2.8262e-01,        -inf,        -inf,        -inf],
          [ 6.1487e-02,  5.8031e-01,        -inf,        -inf],
          [ 3.8965e+00,  1.5335e+00,  5.7187e-01,        -inf],
          [ 1.1977e+00,  3.5913e+00,  1.1013e+00,  4.3839e+00]],

         [[-1.5277e+00,        -inf,        -inf,        -inf],
          [ 1.9881e+00,  7.1906e-01,        -inf,        -inf],
          [-8.9143e-01,  2.0541e+00, -1.4505e+00,        -inf],
          [ 3.2999e-02, -1.0065e+00, -2.7797e+00, -1.5016e+00]],

         [[-2.2730e+00,        -inf,        -inf,        -inf],
          [ 3.8476e-01, -3.1903e+00,        -inf,        -inf],
          [ 2.8196e+00,  1.9963e+00,  1.8370e+00,        -inf],
          [ 6.0737e+00,  1.7152e-01,  2.5508e+00,  4.9030e+00]],

         [[-5.9279e-01,        -inf,        -inf,        -inf],
          [-5.5150e+00, -5.1431e+00,        -inf,        -inf],
          [-2.5351e+00,  3.2020e+00,  1.4630e+00,        -inf],
          [-1.3034e+00,  2.9990e+00, -3.3224e+00, -4.5531e+00]],

         [[ 2.4308e+00,        -inf,        -inf,        -inf],
          [-6.7111e-01, -1.8774e-03,        -inf,        -inf],
          [ 4.2797e-01,  4.4096e-01,  4.9633e-01,        -inf],
          [ 3.2524e+00,  1.3587e+00,  1.5579e+00,  2.1250e+00]],

         [[ 3.0274e+00,        -inf,        -inf,        -inf],
          [-6.6837e-01,  3.3390e+00,        -inf,        -inf],
          [-3.2707e+00, -6.9536e-01, -8.1910e-01,        -inf],
          [ 2.5051e-03,  1.5890e+00,  9.2215e-02,  2.7508e+00]],

         [[ 5.4942e-01,        -inf,        -inf,        -inf],
          [-1.2316e+00,  3.8029e+00,        -inf,        -inf],
          [ 1.9134e+00,  1.4506e+00,  1.2745e+00,        -inf],
          [ 6.6855e-01,  2.2761e+00,  9.8855e-01,  1.6413e+00]],

         [[-3.7991e+00,        -inf,        -inf,        -inf],
          [ 6.2158e-01,  3.6068e+00,        -inf,        -inf],
          [ 4.5869e-01,  3.8608e+00,  2.0368e+00,        -inf],
          [ 2.3961e+00,  1.6570e-01,  3.8537e+00,  1.4800e+00]],

         [[-2.5946e+00,        -inf,        -inf,        -inf],
          [ 2.1446e+00,  1.0630e+00,        -inf,        -inf],
          [-1.5729e+00, -2.3746e+00,  1.5508e+00,        -inf],
          [-9.9727e-01,  5.2579e-01, -1.3602e-01, -1.0191e+00]],

         [[-2.8416e-01,        -inf,        -inf,        -inf],
          [ 1.9851e+00,  1.2415e+00,        -inf,        -inf],
          [ 4.2184e-02, -2.9303e+00, -2.8686e+00,        -inf],
          [-1.9932e+00, -4.7587e+00,  8.1086e-01, -4.1276e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.3631e+00,        -inf,        -inf,        -inf],
          [-4.0302e+00,  2.5465e-01,        -inf,        -inf],
          [-2.2858e+00, -7.9326e-01, -4.8440e+00,        -inf],
          [-2.3930e+00, -3.2835e+00, -4.4693e+00,  1.4581e+00]],

         [[-1.4570e-02,        -inf,        -inf,        -inf],
          [-1.0712e+00, -8.9379e-01,        -inf,        -inf],
          [-2.9609e+00,  3.1242e-02, -1.3216e+00,        -inf],
          [-2.1768e+00,  6.0252e-02, -1.0961e+00,  1.3030e+00]],

         [[ 3.2520e-01,        -inf,        -inf,        -inf],
          [-1.2441e+00, -5.6895e+00,        -inf,        -inf],
          [-2.2176e+00,  1.4034e+00,  4.3855e-01,        -inf],
          [ 4.5973e-01,  4.0767e+00,  1.0156e+00,  1.0740e+00]],

         [[ 2.3853e+00,        -inf,        -inf,        -inf],
          [ 7.0251e+00,  6.0918e-02,        -inf,        -inf],
          [ 7.4711e+00, -4.0861e+00,  2.7970e-01,        -inf],
          [ 6.5727e+00,  1.8767e+00,  2.6181e+00, -9.2208e-01]],

         [[ 2.2790e+00,        -inf,        -inf,        -inf],
          [ 2.9652e+00,  4.8684e+00,        -inf,        -inf],
          [-1.3557e+00, -1.2784e+00,  3.6040e-01,        -inf],
          [ 1.3423e+00,  7.2488e-01,  3.4993e+00, -2.9731e+00]],

         [[-4.7038e-01,        -inf,        -inf,        -inf],
          [-2.9040e+00, -4.7142e+00,        -inf,        -inf],
          [-9.7380e-01, -5.4233e+00, -3.9441e+00,        -inf],
          [ 6.0853e-01, -2.0086e-01,  6.1630e+00,  5.2884e+00]],

         [[ 9.6947e-01,        -inf,        -inf,        -inf],
          [ 6.0740e+00,  1.2932e+00,        -inf,        -inf],
          [ 4.0129e+00,  3.1563e+00,  9.7374e-01,        -inf],
          [ 9.1329e-01,  4.5046e+00, -8.0744e-01, -6.0284e-01]],

         [[ 1.5676e+00,        -inf,        -inf,        -inf],
          [ 5.3981e+00,  2.8559e+00,        -inf,        -inf],
          [-6.0579e-01, -1.3140e+00,  1.2180e+00,        -inf],
          [-4.2660e-01, -6.2607e-01, -1.0269e+00,  4.5959e+00]],

         [[-4.3892e-01,        -inf,        -inf,        -inf],
          [-2.7663e+00,  5.1948e-01,        -inf,        -inf],
          [ 2.6497e+00,  1.1654e+00,  1.0542e+00,        -inf],
          [-1.1655e+00, -1.3358e+00,  9.2033e-01, -8.5745e-01]],

         [[-3.0099e+00,        -inf,        -inf,        -inf],
          [-8.6737e-01, -4.8768e+00,        -inf,        -inf],
          [ 1.8707e+00, -1.4487e+00,  5.1485e+00,        -inf],
          [-1.1262e+00, -4.4973e-01, -9.8761e-01, -5.9558e-01]],

         [[ 4.3769e+00,        -inf,        -inf,        -inf],
          [ 4.9831e+00,  5.1011e+00,        -inf,        -inf],
          [-1.6717e+00, -1.5526e+00, -1.6826e+00,        -inf],
          [ 3.0311e-01,  1.1992e+00,  5.4634e-01, -4.7535e-02]],

         [[-6.3535e+00,        -inf,        -inf,        -inf],
          [-3.8072e+00, -1.6035e+00,        -inf,        -inf],
          [-3.3193e+00,  4.9141e-01, -4.1381e+00,        -inf],
          [-4.3028e+00, -1.2707e+00, -2.1822e+00, -3.7067e+00]],

         [[ 4.8703e+00,        -inf,        -inf,        -inf],
          [ 1.9677e+00, -1.4054e+00,        -inf,        -inf],
          [ 1.2991e+00, -1.5478e+00,  3.1248e+00,        -inf],
          [-2.0077e+00, -1.8940e+00, -7.5292e-01, -3.8221e+00]],

         [[ 6.2151e-01,        -inf,        -inf,        -inf],
          [-3.1095e+00, -2.7005e+00,        -inf,        -inf],
          [ 4.3401e-01,  1.0277e+00, -1.9249e+00,        -inf],
          [ 2.1304e-03,  4.0069e+00,  8.3444e-01,  1.7033e-01]],

         [[-3.5206e+00,        -inf,        -inf,        -inf],
          [-2.0892e+00,  1.7005e+00,        -inf,        -inf],
          [ 5.4520e+00,  3.0043e+00,  8.4493e+00,        -inf],
          [-7.9691e-02,  2.2687e+00,  5.0027e+00,  2.4462e+00]],

         [[-2.4368e+00,        -inf,        -inf,        -inf],
          [-1.8063e+00, -2.2482e+00,        -inf,        -inf],
          [-1.5563e+00, -5.2770e-01, -4.3003e+00,        -inf],
          [ 2.0010e+00, -1.4066e+00,  2.2799e+00,  2.7088e+00]],

         [[-1.3076e+00,        -inf,        -inf,        -inf],
          [ 5.6329e+00,  2.8472e+00,        -inf,        -inf],
          [ 3.0262e+00,  1.3321e+00,  1.6314e+00,        -inf],
          [ 3.6076e-01, -8.9251e-01,  3.6041e+00,  1.1532e+00]],

         [[-1.1553e+00,        -inf,        -inf,        -inf],
          [ 1.0681e+00, -6.8697e-02,        -inf,        -inf],
          [ 3.4838e+00,  3.8950e+00,  9.5660e-01,        -inf],
          [ 2.1313e+00,  1.1450e+00, -2.3033e-01, -4.3469e-01]],

         [[-3.9281e-01,        -inf,        -inf,        -inf],
          [-2.6921e+00, -6.7230e-02,        -inf,        -inf],
          [ 1.5693e+00,  1.1656e+00,  5.5806e-01,        -inf],
          [-2.8305e+00, -1.8734e+00,  2.5412e+00, -5.4487e+00]],

         [[ 1.7694e-01,        -inf,        -inf,        -inf],
          [ 3.1812e+00,  2.9713e-01,        -inf,        -inf],
          [ 2.1753e+00,  2.0635e+00,  2.4650e+00,        -inf],
          [ 3.1037e+00,  4.8658e-01,  1.5029e+00,  1.6490e+00]],

         [[ 4.0034e+00,        -inf,        -inf,        -inf],
          [-2.3546e-01, -1.0836e+00,        -inf,        -inf],
          [-1.7507e+00, -7.1921e+00, -3.6694e+00,        -inf],
          [ 4.2440e-01,  4.4267e+00,  1.6933e+00,  2.8565e-02]],

         [[-2.8347e+00,        -inf,        -inf,        -inf],
          [-2.7239e+00,  4.1729e+00,        -inf,        -inf],
          [ 7.5527e-01, -1.8573e+00, -4.6273e-01,        -inf],
          [-9.5024e-01,  9.0506e-01,  2.8845e+00,  9.0956e-01]],

         [[-4.4916e+00,        -inf,        -inf,        -inf],
          [ 1.4652e+00, -3.1403e-01,        -inf,        -inf],
          [ 5.8983e-01, -1.0162e-01, -7.6105e-01,        -inf],
          [ 1.3521e+00,  2.5198e+00,  1.1916e+00,  3.8398e-01]],

         [[-6.5158e-01,        -inf,        -inf,        -inf],
          [ 1.1487e+00,  2.3568e+00,        -inf,        -inf],
          [ 5.5044e+00,  6.3596e+00, -2.2729e+00,        -inf],
          [ 4.9442e+00,  4.0820e+00, -4.3401e+00, -2.5599e+00]],

         [[ 8.1150e-01,        -inf,        -inf,        -inf],
          [-9.5751e-01, -1.6752e+00,        -inf,        -inf],
          [ 1.3809e-01, -8.6496e-01, -2.9154e+00,        -inf],
          [ 5.1322e+00, -3.4822e+00, -3.3775e+00, -5.1818e-01]]],


        [[[-3.1942e+00,        -inf,        -inf,        -inf],
          [-6.6736e+00, -5.9563e+00,        -inf,        -inf],
          [-2.6332e+00, -3.9503e+00, -4.5219e+00,        -inf],
          [-3.9669e+00, -5.1399e+00, -3.3517e+00, -1.7590e+00]],

         [[-5.5723e-01,        -inf,        -inf,        -inf],
          [ 5.7756e-01,  9.4948e-01,        -inf,        -inf],
          [-2.7332e+00, -7.4547e-01,  1.3382e+00,        -inf],
          [-1.1587e+00,  3.2792e-01, -2.0226e+00,  6.2059e-01]],

         [[ 2.1713e+00,        -inf,        -inf,        -inf],
          [ 1.5394e-01, -2.1355e-01,        -inf,        -inf],
          [ 2.2652e+00,  3.5827e+00,  4.2138e+00,        -inf],
          [ 1.5321e+00,  2.8808e+00, -1.8930e+00,  3.6399e+00]],

         [[ 2.4949e+00,        -inf,        -inf,        -inf],
          [ 2.5076e+00,  2.5045e+00,        -inf,        -inf],
          [ 7.6052e+00,  6.4956e+00,  8.8332e-01,        -inf],
          [ 4.5937e+00,  2.6182e+00,  2.5622e+00,  6.6265e+00]],

         [[ 2.7865e+00,        -inf,        -inf,        -inf],
          [ 2.2543e+00,  2.4134e+00,        -inf,        -inf],
          [ 2.7724e-01, -2.7810e+00,  9.5937e-01,        -inf],
          [-8.7904e-01, -9.6883e-01, -4.4175e+00,  1.6027e+00]],

         [[ 2.9551e-01,        -inf,        -inf,        -inf],
          [ 7.3097e-01, -1.3945e+00,        -inf,        -inf],
          [ 2.6240e+00, -1.8014e+00, -1.4928e+00,        -inf],
          [ 7.1216e-01,  3.3614e+00,  2.9572e+00,  4.8463e+00]],

         [[ 1.1660e+00,        -inf,        -inf,        -inf],
          [ 4.3162e+00,  8.6996e-03,        -inf,        -inf],
          [ 1.9286e+00,  5.3355e-02,  1.0367e+00,        -inf],
          [-9.2181e-01, -1.8267e+00,  7.4401e-01,  1.6669e-01]],

         [[ 1.6785e+00,        -inf,        -inf,        -inf],
          [-1.6150e-01,  1.2385e+00,        -inf,        -inf],
          [-2.4661e+00, -1.9137e+00, -2.9447e-01,        -inf],
          [-1.0174e+00, -5.0482e-01, -2.1899e+00,  7.7924e-01]],

         [[-5.9705e-01,        -inf,        -inf,        -inf],
          [ 9.1890e-01, -1.2349e+00,        -inf,        -inf],
          [ 1.8201e+00,  9.2240e-01,  2.2796e+00,        -inf],
          [-1.2060e+00,  2.9431e+00, -4.8046e-01, -3.6217e+00]],

         [[ 6.2651e-01,        -inf,        -inf,        -inf],
          [-3.7810e+00, -4.6330e+00,        -inf,        -inf],
          [ 1.2059e-01,  1.3576e-01, -9.9854e-01,        -inf],
          [ 2.4384e+00,  1.0927e+00,  6.1780e-01, -4.9698e-01]],

         [[ 6.5266e+00,        -inf,        -inf,        -inf],
          [ 7.7434e+00,  4.9027e+00,        -inf,        -inf],
          [ 5.0769e+00,  1.9135e+00,  7.4909e-01,        -inf],
          [ 1.7771e+00,  2.3961e+00, -1.2982e+00,  3.9426e+00]],

         [[-6.1806e+00,        -inf,        -inf,        -inf],
          [-8.7806e-01,  8.9874e-01,        -inf,        -inf],
          [-5.2609e+00, -6.8267e+00, -4.4768e+00,        -inf],
          [ 2.4297e+00, -5.9690e-01,  4.4841e-01,  1.8118e+00]],

         [[-1.3658e+00,        -inf,        -inf,        -inf],
          [-3.5839e+00,  1.1525e+00,        -inf,        -inf],
          [ 5.9476e-01,  1.8468e+00,  2.2979e+00,        -inf],
          [-1.7013e-01, -2.5588e+00,  1.1808e+00, -6.2423e+00]],

         [[-4.7558e-01,        -inf,        -inf,        -inf],
          [ 1.1497e+00, -9.5057e-01,        -inf,        -inf],
          [ 2.2112e+00,  1.7000e+00,  7.8679e-01,        -inf],
          [ 7.7947e-01,  1.1231e+00,  2.8589e+00,  8.2396e+00]],

         [[-1.0182e+00,        -inf,        -inf,        -inf],
          [-4.2219e-01,  2.7523e+00,        -inf,        -inf],
          [ 9.1216e-01,  1.9646e+00,  3.7273e+00,        -inf],
          [-1.3935e+00, -3.4293e-01,  3.0917e-01,  2.6268e+00]],

         [[-2.8262e-01,        -inf,        -inf,        -inf],
          [ 6.1487e-02,  5.8031e-01,        -inf,        -inf],
          [ 3.8965e+00,  1.5335e+00,  5.7187e-01,        -inf],
          [ 1.1977e+00,  3.5913e+00,  1.1013e+00,  4.3839e+00]],

         [[-1.5277e+00,        -inf,        -inf,        -inf],
          [ 1.9881e+00,  7.1906e-01,        -inf,        -inf],
          [-8.9143e-01,  2.0541e+00, -1.4505e+00,        -inf],
          [ 3.2999e-02, -1.0065e+00, -2.7797e+00, -1.5016e+00]],

         [[-2.2730e+00,        -inf,        -inf,        -inf],
          [ 3.8476e-01, -3.1903e+00,        -inf,        -inf],
          [ 2.8196e+00,  1.9963e+00,  1.8370e+00,        -inf],
          [ 6.0737e+00,  1.7152e-01,  2.5508e+00,  4.9030e+00]],

         [[-5.9279e-01,        -inf,        -inf,        -inf],
          [-5.5150e+00, -5.1431e+00,        -inf,        -inf],
          [-2.5351e+00,  3.2020e+00,  1.4630e+00,        -inf],
          [-1.3034e+00,  2.9990e+00, -3.3224e+00, -4.5531e+00]],

         [[ 2.4308e+00,        -inf,        -inf,        -inf],
          [-6.7111e-01, -1.8774e-03,        -inf,        -inf],
          [ 4.2797e-01,  4.4096e-01,  4.9633e-01,        -inf],
          [ 3.2524e+00,  1.3587e+00,  1.5579e+00,  2.1250e+00]],

         [[ 3.0274e+00,        -inf,        -inf,        -inf],
          [-6.6837e-01,  3.3390e+00,        -inf,        -inf],
          [-3.2707e+00, -6.9536e-01, -8.1910e-01,        -inf],
          [ 2.5051e-03,  1.5890e+00,  9.2215e-02,  2.7508e+00]],

         [[ 5.4942e-01,        -inf,        -inf,        -inf],
          [-1.2316e+00,  3.8029e+00,        -inf,        -inf],
          [ 1.9134e+00,  1.4506e+00,  1.2745e+00,        -inf],
          [ 6.6855e-01,  2.2761e+00,  9.8855e-01,  1.6413e+00]],

         [[-3.7991e+00,        -inf,        -inf,        -inf],
          [ 6.2158e-01,  3.6068e+00,        -inf,        -inf],
          [ 4.5869e-01,  3.8608e+00,  2.0368e+00,        -inf],
          [ 2.3961e+00,  1.6570e-01,  3.8537e+00,  1.4800e+00]],

         [[-2.5946e+00,        -inf,        -inf,        -inf],
          [ 2.1446e+00,  1.0630e+00,        -inf,        -inf],
          [-1.5729e+00, -2.3746e+00,  1.5508e+00,        -inf],
          [-9.9727e-01,  5.2579e-01, -1.3602e-01, -1.0191e+00]],

         [[-2.8416e-01,        -inf,        -inf,        -inf],
          [ 1.9851e+00,  1.2415e+00,        -inf,        -inf],
          [ 4.2184e-02, -2.9303e+00, -2.8686e+00,        -inf],
          [-1.9932e+00, -4.7587e+00,  8.1086e-01, -4.1276e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.4289, -0.2104,  0.1563,  ...,  0.4691,  0.5220, -0.0414],
          [-0.8860,  0.4034,  0.1031,  ...,  0.5478,  0.1771,  0.6114],
          [-0.4501,  0.5405, -0.0374,  ...,  0.6331,  0.1807, -0.0468],
          ...,
          [ 0.3308, -0.6257,  0.2504,  ..., -0.5187, -0.4877,  0.3365],
          [ 0.7263,  0.4693,  0.4026,  ...,  0.8147, -0.2628, -0.5762],
          [-0.2442, -0.4105,  0.3843,  ..., -1.1071,  0.2255, -1.3125]],

         [[ 0.1204,  0.1049,  0.1477,  ...,  0.4762,  0.3844,  0.3407],
          [-0.8789,  0.4829,  0.2780,  ...,  0.0666, -0.1846,  0.3817],
          [-0.3174,  0.6480,  0.0913,  ...,  0.5186, -0.0885, -0.3262],
          ...,
          [ 0.1837, -0.3475,  0.1391,  ..., -0.2881, -0.2708,  0.1869],
          [ 0.2142, -0.2885,  0.0989,  ...,  1.2960, -0.4180, -0.3320],
          [-0.0569, -0.7740,  0.6046,  ..., -0.5194,  0.2116, -0.7396]],

         [[-0.0544,  0.1768, -0.3913,  ...,  0.1590,  0.2722, -0.0109],
          [-0.7951,  0.0901,  0.3313,  ...,  0.0092, -0.3500,  0.6201],
          [-0.3028,  0.8375,  0.3930,  ...,  0.4687, -0.2300, -0.6572],
          ...,
          [ 0.5795, -0.5187, -0.0074,  ..., -0.2730, -0.1554, -0.0821],
          [ 0.0205, -0.3214,  0.1986,  ...,  1.0733, -0.2739, -0.1606],
          [-0.1970, -0.8875,  0.3787,  ..., -0.5757,  0.2211, -0.9173]],

         [[ 0.3230,  0.3468, -0.2751,  ...,  0.2378,  0.5688,  0.0798],
          [-1.0970,  0.1119,  0.5134,  ...,  0.1697,  0.0722,  0.4923],
          [-0.1375,  0.7182,  0.2632,  ...,  0.2167, -0.2992, -0.6814],
          ...,
          [ 0.4539, -0.2339, -0.4366,  ..., -0.3740, -0.1174, -0.1052],
          [ 0.0663, -0.2152,  0.1855,  ...,  0.8889, -0.2295, -0.1642],
          [-0.3531, -0.7212,  0.2982,  ..., -0.5046,  0.4422, -0.9460]]],


        [[[-1.1341,  0.2382,  0.4853,  ...,  0.6497,  0.1819, -0.1775],
          [-1.2018,  0.2608,  0.8372,  ...,  0.6556, -0.8384,  0.3060],
          [-0.1592,  0.4040,  0.0144,  ...,  1.2236, -0.4176,  0.2298],
          ...,
          [ 0.0970, -0.5724, -0.0337,  ...,  0.1069,  0.3547,  0.3817],
          [ 0.3684, -0.1392,  0.1249,  ..., -0.2107, -0.8368, -0.1522],
          [-0.2795, -0.3676,  0.3966,  ..., -0.6215, -0.0628, -1.2444]],

         [[-0.0864,  0.5798, -0.1879,  ...,  0.7377, -0.2160,  0.1002],
          [-0.2166,  0.4026,  0.3027,  ..., -0.1850, -0.3511,  0.3131],
          [ 0.0145,  0.4981,  0.2678,  ...,  0.8707, -0.3209, -0.2941],
          ...,
          [ 0.3832, -0.3837, -0.2241,  ...,  0.3410,  0.4323,  0.1840],
          [ 0.1966, -0.0743,  0.0667,  ..., -0.1124, -0.4466, -0.0812],
          [-0.2173, -0.4842,  0.4367,  ..., -0.7987, -0.7152, -1.3496]],

         [[-0.1400,  0.5017, -0.3120,  ...,  0.6229, -0.0506,  0.0694],
          [-0.7632,  0.0754,  0.3764,  ...,  0.1161, -0.5579,  0.5844],
          [ 0.0781,  0.6938,  0.1836,  ...,  0.7617, -0.2099, -0.3222],
          ...,
          [ 0.4606, -0.3290, -0.4640,  ...,  0.1286,  0.5362, -0.1217],
          [-0.8425,  0.2867, -0.3067,  ...,  0.4278, -0.4350,  0.6932],
          [-0.0564, -0.3389,  0.2943,  ..., -0.7256, -0.3807, -1.2164]],

         [[ 0.0659,  0.4668, -0.3035,  ...,  0.4886,  0.1002,  0.1526],
          [-0.8060,  0.3650,  0.5255,  ...,  0.1256, -0.4021,  0.6925],
          [ 0.0177,  0.2684,  0.1560,  ...,  0.4392, -0.1638, -0.1855],
          ...,
          [ 0.0147,  0.0174, -0.2839,  ...,  0.1024,  0.1664,  0.2044],
          [-0.6532,  0.2111, -0.1764,  ...,  0.2763, -0.4207,  0.3784],
          [ 0.0311, -0.2153,  0.1755,  ..., -0.5626, -0.2018, -0.9249]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.4289, -0.2104,  0.1563,  ..., -1.1071,  0.2255, -1.3125],
         [ 0.1204,  0.1049,  0.1477,  ..., -0.5194,  0.2116, -0.7396],
         [-0.0544,  0.1768, -0.3913,  ..., -0.5757,  0.2211, -0.9173],
         [ 0.3230,  0.3468, -0.2751,  ..., -0.5046,  0.4422, -0.9460]],

        [[-1.1341,  0.2382,  0.4853,  ..., -0.6215, -0.0628, -1.2444],
         [-0.0864,  0.5798, -0.1879,  ..., -0.7987, -0.7152, -1.3496],
         [-0.1400,  0.5017, -0.3120,  ..., -0.7256, -0.3807, -1.2164],
         [ 0.0659,  0.4668, -0.3035,  ..., -0.5626, -0.2018, -0.9249]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0145,  0.1653,  0.2992,  ..., -0.4246, -0.4210,  0.2913],
         [-0.2229,  0.0976,  0.0362,  ...,  0.0769, -0.3654,  0.1896],
         [-0.2613, -0.0454,  0.2139,  ..., -0.0054, -0.3229,  0.2118],
         [-0.2438, -0.1955, -0.0357,  ..., -0.0697, -0.3079,  0.1376]],

        [[ 0.4216,  0.2603,  0.4385,  ..., -0.5189, -0.6018, -0.1711],
         [ 0.2535, -0.0349,  0.1417,  ..., -0.2713, -0.4423,  0.1342],
         [ 0.0640, -0.0384,  0.1578,  ..., -0.2870, -0.4468,  0.0956],
         [ 0.1438, -0.1968, -0.0996,  ..., -0.4131, -0.3112,  0.0344]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 4.8099e+00,        -inf,        -inf,        -inf],
          [-2.3720e-01, -4.0498e-01,        -inf,        -inf],
          [ 3.8279e+00,  2.8176e+00, -2.1844e+00,        -inf],
          [-6.4604e-01,  6.7741e-01, -3.8943e+00, -2.7886e+00]],

         [[-1.4374e+00,        -inf,        -inf,        -inf],
          [ 3.1997e-01, -6.6547e+00,        -inf,        -inf],
          [ 2.6469e+00, -1.8736e+00,  1.3808e+00,        -inf],
          [ 1.5274e+00, -6.2638e-01,  2.8987e-01, -2.2641e+00]],

         [[-1.1768e+00,        -inf,        -inf,        -inf],
          [-3.2972e+00,  6.1293e-01,        -inf,        -inf],
          [ 7.3802e-01,  6.4534e-01,  1.7839e+00,        -inf],
          [-2.2852e-01, -8.9976e-01,  1.4608e+00,  1.2671e+00]],

         [[ 2.2158e+00,        -inf,        -inf,        -inf],
          [ 4.7514e+00,  1.2923e+00,        -inf,        -inf],
          [ 3.0802e+00,  1.4757e+00,  1.2565e+00,        -inf],
          [ 1.0703e+00, -5.0286e-01, -4.2214e+00, -1.4977e+00]],

         [[-1.0434e+00,        -inf,        -inf,        -inf],
          [ 4.0956e-01, -1.0910e+00,        -inf,        -inf],
          [-2.0323e+00, -5.0316e-01,  1.5478e+00,        -inf],
          [-1.5247e+00,  1.6104e+00, -2.9034e+00,  6.1735e-01]],

         [[ 2.2401e+00,        -inf,        -inf,        -inf],
          [ 2.2692e+00,  3.9004e+00,        -inf,        -inf],
          [ 2.4583e+00,  5.7867e+00,  6.3374e-01,        -inf],
          [ 4.1311e+00,  3.4537e+00, -1.3758e+00,  6.5118e+00]],

         [[-7.4099e-01,        -inf,        -inf,        -inf],
          [-2.6189e+00, -1.6644e+00,        -inf,        -inf],
          [-5.6499e+00, -1.1113e+00, -3.8567e+00,        -inf],
          [-1.8563e-01, -7.9950e-01, -2.2255e+00,  5.7361e-03]],

         [[-6.0126e-01,        -inf,        -inf,        -inf],
          [-8.1709e-01, -9.7394e-01,        -inf,        -inf],
          [ 1.4624e+00, -2.4748e+00, -2.0301e+00,        -inf],
          [-1.3979e+00,  1.1253e+00, -4.1593e-01,  8.8201e-01]],

         [[ 2.6786e+00,        -inf,        -inf,        -inf],
          [ 4.5891e-01, -3.1419e+00,        -inf,        -inf],
          [ 2.6694e+00, -2.7001e+00, -1.2803e+00,        -inf],
          [ 4.3763e+00, -3.5092e-01, -3.0732e+00,  1.9184e-01]],

         [[-1.7900e-02,        -inf,        -inf,        -inf],
          [-3.6753e+00, -3.3894e+00,        -inf,        -inf],
          [ 2.1612e-02,  3.2049e+00,  1.2868e+00,        -inf],
          [-8.0477e-01, -1.6830e+00,  3.1003e-01, -1.5434e+00]],

         [[-1.4844e+00,        -inf,        -inf,        -inf],
          [ 1.0682e+00,  2.0533e+00,        -inf,        -inf],
          [-2.3127e+00, -1.5248e+00, -1.0895e+00,        -inf],
          [ 2.9444e+00, -8.8858e-01,  6.7101e-01,  2.0981e+00]],

         [[ 2.1878e+00,        -inf,        -inf,        -inf],
          [ 9.4227e-01,  4.5234e+00,        -inf,        -inf],
          [ 3.2606e+00,  1.9118e+00,  1.8637e+00,        -inf],
          [ 2.7530e+00,  7.3330e-01, -6.6232e-01,  5.5280e+00]],

         [[ 1.4760e+00,        -inf,        -inf,        -inf],
          [-4.6242e+00, -9.2721e-01,        -inf,        -inf],
          [-3.0820e+00, -1.0957e+00,  3.7662e+00,        -inf],
          [-1.8208e+00,  6.2840e-01,  3.2535e+00, -3.6504e-01]],

         [[-6.0479e+00,        -inf,        -inf,        -inf],
          [-4.4585e+00,  2.4247e+00,        -inf,        -inf],
          [ 1.0808e+00,  3.5309e+00, -1.7190e+00,        -inf],
          [-4.5725e+00, -1.0043e+00, -1.6207e+00, -5.7292e+00]],

         [[ 2.2675e-01,        -inf,        -inf,        -inf],
          [ 3.5778e-01, -2.5367e+00,        -inf,        -inf],
          [ 2.8491e+00,  1.0305e+00,  1.4903e+00,        -inf],
          [-2.9350e+00,  1.0532e+00, -2.2313e+00, -1.0491e-01]],

         [[-4.3808e-01,        -inf,        -inf,        -inf],
          [-2.8749e+00,  9.9093e-01,        -inf,        -inf],
          [-2.8921e+00, -1.2133e+00, -2.1879e+00,        -inf],
          [-1.2083e+00,  1.2422e+00,  1.7934e+00, -4.3197e-01]],

         [[ 6.9831e+00,        -inf,        -inf,        -inf],
          [ 1.7616e+00,  4.5655e+00,        -inf,        -inf],
          [ 1.3905e+00,  5.9401e-01,  9.9479e-01,        -inf],
          [ 3.0987e+00,  1.8446e-01, -8.9237e-01, -7.0319e-02]],

         [[ 1.3864e-01,        -inf,        -inf,        -inf],
          [ 4.1092e+00, -1.3690e+00,        -inf,        -inf],
          [ 1.7527e+00, -4.1409e+00, -3.1869e+00,        -inf],
          [ 2.7380e+00, -3.1611e+00,  3.8801e+00, -2.3299e-01]],

         [[-1.3112e+00,        -inf,        -inf,        -inf],
          [ 2.4470e+00, -1.1318e+00,        -inf,        -inf],
          [ 1.2741e-01,  5.9214e-01, -3.6153e+00,        -inf],
          [ 1.3472e+00, -1.0873e+00,  9.6765e-01,  5.4608e+00]],

         [[ 3.4551e+00,        -inf,        -inf,        -inf],
          [-2.9354e+00, -4.6998e+00,        -inf,        -inf],
          [ 1.2830e+00, -1.1247e+00,  2.8010e+00,        -inf],
          [ 3.8047e-01, -1.8535e+00, -1.4917e+00, -2.0778e+00]],

         [[ 3.7562e+00,        -inf,        -inf,        -inf],
          [-1.3101e+00, -1.3039e+00,        -inf,        -inf],
          [-3.1958e+00,  1.4705e+00,  8.1093e-01,        -inf],
          [ 9.6893e-01,  6.7747e+00,  3.8079e+00, -2.7721e+00]],

         [[ 9.2372e-01,        -inf,        -inf,        -inf],
          [ 2.7523e-01, -2.4260e+00,        -inf,        -inf],
          [ 5.9033e+00, -1.8525e+00, -1.2392e-01,        -inf],
          [-8.2399e-01,  1.7529e-01,  3.4076e+00,  2.2188e+00]],

         [[ 6.9725e-01,        -inf,        -inf,        -inf],
          [-1.7321e+00,  1.9904e+00,        -inf,        -inf],
          [ 4.3801e+00,  3.5506e+00,  3.4480e+00,        -inf],
          [-2.3366e+00, -2.6079e+00, -7.2797e-01, -2.5136e+00]],

         [[-1.7176e+00,        -inf,        -inf,        -inf],
          [-2.1157e+00,  5.6348e-01,        -inf,        -inf],
          [-3.6776e+00,  8.9846e-01,  2.1464e+00,        -inf],
          [-2.9008e+00, -3.1146e-01, -6.4110e-01,  3.7059e+00]],

         [[-2.9323e+00,        -inf,        -inf,        -inf],
          [ 1.5236e-01,  7.7988e-01,        -inf,        -inf],
          [-2.3087e-01, -1.5102e+00, -2.1019e-01,        -inf],
          [-4.4751e+00,  4.1952e-01, -2.6163e+00, -1.2316e+00]]],


        [[[ 2.9346e+00,        -inf,        -inf,        -inf],
          [ 4.9047e+00,  6.1714e+00,        -inf,        -inf],
          [ 1.2419e+00,  2.0749e+00, -5.8999e+00,        -inf],
          [ 6.4461e-01,  2.4007e+00, -4.2946e-01, -3.9274e+00]],

         [[-4.1359e-01,        -inf,        -inf,        -inf],
          [ 1.5456e+00, -1.7387e+00,        -inf,        -inf],
          [ 3.4862e+00, -2.0891e+00,  3.4677e-01,        -inf],
          [ 2.4096e+00, -1.0537e+00, -1.6727e+00,  1.7009e+00]],

         [[-4.8524e-01,        -inf,        -inf,        -inf],
          [-4.7658e+00, -3.9890e+00,        -inf,        -inf],
          [-1.1908e+00, -2.6973e+00, -4.3458e+00,        -inf],
          [-7.0173e-01, -1.5564e+00, -9.2469e-01, -3.8476e-01]],

         [[-9.9745e-01,        -inf,        -inf,        -inf],
          [ 8.5199e-01,  2.6595e+00,        -inf,        -inf],
          [-3.6118e+00, -3.5175e+00,  3.1346e+00,        -inf],
          [-2.0422e+00, -1.9125e+00,  1.5707e+00, -2.4846e+00]],

         [[ 3.6763e-02,        -inf,        -inf,        -inf],
          [-1.4741e+00, -4.1236e+00,        -inf,        -inf],
          [-4.3574e-01, -4.8139e+00, -5.3371e+00,        -inf],
          [ 4.7109e+00,  1.1553e+00,  1.8230e+00,  3.5849e+00]],

         [[-1.3724e+00,        -inf,        -inf,        -inf],
          [ 3.3677e+00,  1.9778e+00,        -inf,        -inf],
          [-8.0020e-01,  6.3410e-01,  1.9403e+00,        -inf],
          [-1.7012e+00, -3.2730e-01,  6.9446e-01, -1.1038e+00]],

         [[-1.6698e+00,        -inf,        -inf,        -inf],
          [-5.0162e+00, -2.0113e+00,        -inf,        -inf],
          [-7.3661e+00, -2.3542e+00, -3.9894e-01,        -inf],
          [-1.3240e+00,  1.5565e+00,  1.4796e+00, -1.2002e+00]],

         [[ 6.5399e-01,        -inf,        -inf,        -inf],
          [-1.0652e+00,  1.6110e+00,        -inf,        -inf],
          [-7.6271e-01, -1.1923e+00, -7.9893e-01,        -inf],
          [ 4.1146e+00,  1.7081e+00,  5.8407e-01,  2.6664e+00]],

         [[ 1.6756e+00,        -inf,        -inf,        -inf],
          [ 2.4951e-01, -4.3223e-01,        -inf,        -inf],
          [-1.5647e+00, -7.3918e-01, -3.5827e+00,        -inf],
          [ 4.7227e-01,  1.2653e+00,  2.6920e-01,  2.8307e+00]],

         [[ 2.0289e+00,        -inf,        -inf,        -inf],
          [ 1.0749e+00,  2.5680e+00,        -inf,        -inf],
          [ 4.1872e+00,  1.4226e+00,  2.4934e+00,        -inf],
          [ 2.2297e+00,  3.0049e+00,  3.6760e+00,  3.6035e+00]],

         [[-7.3498e-01,        -inf,        -inf,        -inf],
          [ 1.3955e+00,  7.9698e-02,        -inf,        -inf],
          [-5.2243e+00, -2.0771e-01,  3.1032e+00,        -inf],
          [ 4.9184e+00,  2.0187e+00,  7.0558e-02,  1.1235e+00]],

         [[ 4.9673e+00,        -inf,        -inf,        -inf],
          [-1.6608e+00, -2.3663e+00,        -inf,        -inf],
          [ 1.7543e+00,  5.5355e+00,  3.1642e+00,        -inf],
          [ 3.7934e-01,  4.6866e-01,  5.4298e+00,  1.2764e+00]],

         [[ 1.5836e+00,        -inf,        -inf,        -inf],
          [ 3.4399e+00, -2.7819e+00,        -inf,        -inf],
          [ 1.4414e+00,  7.2738e-01,  7.1844e-01,        -inf],
          [-1.8075e-01, -4.7404e+00, -1.7807e+00,  1.8488e-01]],

         [[-3.2910e+00,        -inf,        -inf,        -inf],
          [-2.8621e+00, -2.5342e+00,        -inf,        -inf],
          [ 2.6049e-01,  7.3975e-01, -1.5608e+00,        -inf],
          [-3.0225e-01, -1.2068e+00, -3.0855e+00, -3.6932e+00]],

         [[ 2.0930e+00,        -inf,        -inf,        -inf],
          [-1.6308e+00, -2.5190e+00,        -inf,        -inf],
          [ 1.1946e+00, -1.0427e+00, -1.6979e+00,        -inf],
          [-1.5090e+00, -1.9372e-01,  7.1602e-01, -1.2673e-01]],

         [[-3.6024e+00,        -inf,        -inf,        -inf],
          [-3.2114e+00, -1.3530e+00,        -inf,        -inf],
          [ 5.3238e-01,  4.3605e+00,  5.3869e+00,        -inf],
          [ 4.8499e-01,  5.9104e-01,  2.9564e+00,  2.1495e+00]],

         [[ 4.4941e+00,        -inf,        -inf,        -inf],
          [ 3.5502e+00, -5.8011e-01,        -inf,        -inf],
          [-2.6667e-01, -2.1543e+00,  5.1885e-01,        -inf],
          [ 3.8175e+00, -5.4988e+00, -1.2149e+00,  9.3837e-01]],

         [[ 1.0743e+00,        -inf,        -inf,        -inf],
          [ 1.3760e+00,  1.1304e+00,        -inf,        -inf],
          [ 3.8828e+00,  9.5487e-01,  3.3423e+00,        -inf],
          [ 5.9638e-01,  4.5403e-01,  2.4085e+00, -1.7780e-02]],

         [[-3.8704e+00,        -inf,        -inf,        -inf],
          [-9.1268e-01,  3.5783e+00,        -inf,        -inf],
          [ 1.6800e-01,  1.7452e+00, -4.2602e+00,        -inf],
          [ 1.0279e+00,  3.3501e+00, -2.7362e+00,  3.2846e+00]],

         [[-2.0225e+00,        -inf,        -inf,        -inf],
          [ 9.2616e-01, -1.7227e+00,        -inf,        -inf],
          [ 2.4631e+00, -3.8452e+00, -4.1206e+00,        -inf],
          [-1.3647e+00, -3.7648e+00, -5.2393e+00, -3.7989e+00]],

         [[ 1.5756e+00,        -inf,        -inf,        -inf],
          [-5.0029e+00,  3.2596e+00,        -inf,        -inf],
          [ 1.1605e+00,  1.8108e+00,  2.3349e-01,        -inf],
          [ 6.7153e-01,  2.7493e+00,  4.7208e-01, -1.3127e+00]],

         [[-2.5913e+00,        -inf,        -inf,        -inf],
          [-4.7747e+00, -8.6583e-01,        -inf,        -inf],
          [-4.6448e+00, -1.9404e+00, -7.0754e-01,        -inf],
          [-8.4709e+00, -2.2423e+00, -1.4166e+00, -2.5588e+00]],

         [[ 2.6931e+00,        -inf,        -inf,        -inf],
          [ 4.1596e-01, -2.4980e+00,        -inf,        -inf],
          [ 3.8637e+00, -1.0986e+00,  7.8185e-01,        -inf],
          [-1.1053e+00, -3.6255e+00, -3.2348e+00, -3.4899e+00]],

         [[-4.7006e+00,        -inf,        -inf,        -inf],
          [-6.4810e+00, -1.9206e+00,        -inf,        -inf],
          [-4.8406e-01, -1.9472e+00, -6.3205e-01,        -inf],
          [-1.4694e+00,  1.8586e-01, -1.1214e+00,  2.2328e+00]],

         [[-4.9586e-01,        -inf,        -inf,        -inf],
          [ 5.7297e-01,  1.4720e+00,        -inf,        -inf],
          [-4.2138e-01, -2.5889e+00, -2.4643e+00,        -inf],
          [ 6.1958e-01,  4.9437e+00,  2.5226e+00,  4.9047e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 4.8099e+00,        -inf,        -inf,        -inf],
          [-2.3720e-01, -4.0498e-01,        -inf,        -inf],
          [ 3.8279e+00,  2.8176e+00, -2.1844e+00,        -inf],
          [-6.4604e-01,  6.7741e-01, -3.8943e+00, -2.7886e+00]],

         [[-1.4374e+00,        -inf,        -inf,        -inf],
          [ 3.1997e-01, -6.6547e+00,        -inf,        -inf],
          [ 2.6469e+00, -1.8736e+00,  1.3808e+00,        -inf],
          [ 1.5274e+00, -6.2638e-01,  2.8987e-01, -2.2641e+00]],

         [[-1.1768e+00,        -inf,        -inf,        -inf],
          [-3.2972e+00,  6.1293e-01,        -inf,        -inf],
          [ 7.3802e-01,  6.4534e-01,  1.7839e+00,        -inf],
          [-2.2852e-01, -8.9976e-01,  1.4608e+00,  1.2671e+00]],

         [[ 2.2158e+00,        -inf,        -inf,        -inf],
          [ 4.7514e+00,  1.2923e+00,        -inf,        -inf],
          [ 3.0802e+00,  1.4757e+00,  1.2565e+00,        -inf],
          [ 1.0703e+00, -5.0286e-01, -4.2214e+00, -1.4977e+00]],

         [[-1.0434e+00,        -inf,        -inf,        -inf],
          [ 4.0956e-01, -1.0910e+00,        -inf,        -inf],
          [-2.0323e+00, -5.0316e-01,  1.5478e+00,        -inf],
          [-1.5247e+00,  1.6104e+00, -2.9034e+00,  6.1735e-01]],

         [[ 2.2401e+00,        -inf,        -inf,        -inf],
          [ 2.2692e+00,  3.9004e+00,        -inf,        -inf],
          [ 2.4583e+00,  5.7867e+00,  6.3374e-01,        -inf],
          [ 4.1311e+00,  3.4537e+00, -1.3758e+00,  6.5118e+00]],

         [[-7.4099e-01,        -inf,        -inf,        -inf],
          [-2.6189e+00, -1.6644e+00,        -inf,        -inf],
          [-5.6499e+00, -1.1113e+00, -3.8567e+00,        -inf],
          [-1.8563e-01, -7.9950e-01, -2.2255e+00,  5.7361e-03]],

         [[-6.0126e-01,        -inf,        -inf,        -inf],
          [-8.1709e-01, -9.7394e-01,        -inf,        -inf],
          [ 1.4624e+00, -2.4748e+00, -2.0301e+00,        -inf],
          [-1.3979e+00,  1.1253e+00, -4.1593e-01,  8.8201e-01]],

         [[ 2.6786e+00,        -inf,        -inf,        -inf],
          [ 4.5891e-01, -3.1419e+00,        -inf,        -inf],
          [ 2.6694e+00, -2.7001e+00, -1.2803e+00,        -inf],
          [ 4.3763e+00, -3.5092e-01, -3.0732e+00,  1.9184e-01]],

         [[-1.7900e-02,        -inf,        -inf,        -inf],
          [-3.6753e+00, -3.3894e+00,        -inf,        -inf],
          [ 2.1612e-02,  3.2049e+00,  1.2868e+00,        -inf],
          [-8.0477e-01, -1.6830e+00,  3.1003e-01, -1.5434e+00]],

         [[-1.4844e+00,        -inf,        -inf,        -inf],
          [ 1.0682e+00,  2.0533e+00,        -inf,        -inf],
          [-2.3127e+00, -1.5248e+00, -1.0895e+00,        -inf],
          [ 2.9444e+00, -8.8858e-01,  6.7101e-01,  2.0981e+00]],

         [[ 2.1878e+00,        -inf,        -inf,        -inf],
          [ 9.4227e-01,  4.5234e+00,        -inf,        -inf],
          [ 3.2606e+00,  1.9118e+00,  1.8637e+00,        -inf],
          [ 2.7530e+00,  7.3330e-01, -6.6232e-01,  5.5280e+00]],

         [[ 1.4760e+00,        -inf,        -inf,        -inf],
          [-4.6242e+00, -9.2721e-01,        -inf,        -inf],
          [-3.0820e+00, -1.0957e+00,  3.7662e+00,        -inf],
          [-1.8208e+00,  6.2840e-01,  3.2535e+00, -3.6504e-01]],

         [[-6.0479e+00,        -inf,        -inf,        -inf],
          [-4.4585e+00,  2.4247e+00,        -inf,        -inf],
          [ 1.0808e+00,  3.5309e+00, -1.7190e+00,        -inf],
          [-4.5725e+00, -1.0043e+00, -1.6207e+00, -5.7292e+00]],

         [[ 2.2675e-01,        -inf,        -inf,        -inf],
          [ 3.5778e-01, -2.5367e+00,        -inf,        -inf],
          [ 2.8491e+00,  1.0305e+00,  1.4903e+00,        -inf],
          [-2.9350e+00,  1.0532e+00, -2.2313e+00, -1.0491e-01]],

         [[-4.3808e-01,        -inf,        -inf,        -inf],
          [-2.8749e+00,  9.9093e-01,        -inf,        -inf],
          [-2.8921e+00, -1.2133e+00, -2.1879e+00,        -inf],
          [-1.2083e+00,  1.2422e+00,  1.7934e+00, -4.3197e-01]],

         [[ 6.9831e+00,        -inf,        -inf,        -inf],
          [ 1.7616e+00,  4.5655e+00,        -inf,        -inf],
          [ 1.3905e+00,  5.9401e-01,  9.9479e-01,        -inf],
          [ 3.0987e+00,  1.8446e-01, -8.9237e-01, -7.0319e-02]],

         [[ 1.3864e-01,        -inf,        -inf,        -inf],
          [ 4.1092e+00, -1.3690e+00,        -inf,        -inf],
          [ 1.7527e+00, -4.1409e+00, -3.1869e+00,        -inf],
          [ 2.7380e+00, -3.1611e+00,  3.8801e+00, -2.3299e-01]],

         [[-1.3112e+00,        -inf,        -inf,        -inf],
          [ 2.4470e+00, -1.1318e+00,        -inf,        -inf],
          [ 1.2741e-01,  5.9214e-01, -3.6153e+00,        -inf],
          [ 1.3472e+00, -1.0873e+00,  9.6765e-01,  5.4608e+00]],

         [[ 3.4551e+00,        -inf,        -inf,        -inf],
          [-2.9354e+00, -4.6998e+00,        -inf,        -inf],
          [ 1.2830e+00, -1.1247e+00,  2.8010e+00,        -inf],
          [ 3.8047e-01, -1.8535e+00, -1.4917e+00, -2.0778e+00]],

         [[ 3.7562e+00,        -inf,        -inf,        -inf],
          [-1.3101e+00, -1.3039e+00,        -inf,        -inf],
          [-3.1958e+00,  1.4705e+00,  8.1093e-01,        -inf],
          [ 9.6893e-01,  6.7747e+00,  3.8079e+00, -2.7721e+00]],

         [[ 9.2372e-01,        -inf,        -inf,        -inf],
          [ 2.7523e-01, -2.4260e+00,        -inf,        -inf],
          [ 5.9033e+00, -1.8525e+00, -1.2392e-01,        -inf],
          [-8.2399e-01,  1.7529e-01,  3.4076e+00,  2.2188e+00]],

         [[ 6.9725e-01,        -inf,        -inf,        -inf],
          [-1.7321e+00,  1.9904e+00,        -inf,        -inf],
          [ 4.3801e+00,  3.5506e+00,  3.4480e+00,        -inf],
          [-2.3366e+00, -2.6079e+00, -7.2797e-01, -2.5136e+00]],

         [[-1.7176e+00,        -inf,        -inf,        -inf],
          [-2.1157e+00,  5.6348e-01,        -inf,        -inf],
          [-3.6776e+00,  8.9846e-01,  2.1464e+00,        -inf],
          [-2.9008e+00, -3.1146e-01, -6.4110e-01,  3.7059e+00]],

         [[-2.9323e+00,        -inf,        -inf,        -inf],
          [ 1.5236e-01,  7.7988e-01,        -inf,        -inf],
          [-2.3087e-01, -1.5102e+00, -2.1019e-01,        -inf],
          [-4.4751e+00,  4.1952e-01, -2.6163e+00, -1.2316e+00]]],


        [[[ 2.9346e+00,        -inf,        -inf,        -inf],
          [ 4.9047e+00,  6.1714e+00,        -inf,        -inf],
          [ 1.2419e+00,  2.0749e+00, -5.8999e+00,        -inf],
          [ 6.4461e-01,  2.4007e+00, -4.2946e-01, -3.9274e+00]],

         [[-4.1359e-01,        -inf,        -inf,        -inf],
          [ 1.5456e+00, -1.7387e+00,        -inf,        -inf],
          [ 3.4862e+00, -2.0891e+00,  3.4677e-01,        -inf],
          [ 2.4096e+00, -1.0537e+00, -1.6727e+00,  1.7009e+00]],

         [[-4.8524e-01,        -inf,        -inf,        -inf],
          [-4.7658e+00, -3.9890e+00,        -inf,        -inf],
          [-1.1908e+00, -2.6973e+00, -4.3458e+00,        -inf],
          [-7.0173e-01, -1.5564e+00, -9.2469e-01, -3.8476e-01]],

         [[-9.9745e-01,        -inf,        -inf,        -inf],
          [ 8.5199e-01,  2.6595e+00,        -inf,        -inf],
          [-3.6118e+00, -3.5175e+00,  3.1346e+00,        -inf],
          [-2.0422e+00, -1.9125e+00,  1.5707e+00, -2.4846e+00]],

         [[ 3.6763e-02,        -inf,        -inf,        -inf],
          [-1.4741e+00, -4.1236e+00,        -inf,        -inf],
          [-4.3574e-01, -4.8139e+00, -5.3371e+00,        -inf],
          [ 4.7109e+00,  1.1553e+00,  1.8230e+00,  3.5849e+00]],

         [[-1.3724e+00,        -inf,        -inf,        -inf],
          [ 3.3677e+00,  1.9778e+00,        -inf,        -inf],
          [-8.0020e-01,  6.3410e-01,  1.9403e+00,        -inf],
          [-1.7012e+00, -3.2730e-01,  6.9446e-01, -1.1038e+00]],

         [[-1.6698e+00,        -inf,        -inf,        -inf],
          [-5.0162e+00, -2.0113e+00,        -inf,        -inf],
          [-7.3661e+00, -2.3542e+00, -3.9894e-01,        -inf],
          [-1.3240e+00,  1.5565e+00,  1.4796e+00, -1.2002e+00]],

         [[ 6.5399e-01,        -inf,        -inf,        -inf],
          [-1.0652e+00,  1.6110e+00,        -inf,        -inf],
          [-7.6271e-01, -1.1923e+00, -7.9893e-01,        -inf],
          [ 4.1146e+00,  1.7081e+00,  5.8407e-01,  2.6664e+00]],

         [[ 1.6756e+00,        -inf,        -inf,        -inf],
          [ 2.4951e-01, -4.3223e-01,        -inf,        -inf],
          [-1.5647e+00, -7.3918e-01, -3.5827e+00,        -inf],
          [ 4.7227e-01,  1.2653e+00,  2.6920e-01,  2.8307e+00]],

         [[ 2.0289e+00,        -inf,        -inf,        -inf],
          [ 1.0749e+00,  2.5680e+00,        -inf,        -inf],
          [ 4.1872e+00,  1.4226e+00,  2.4934e+00,        -inf],
          [ 2.2297e+00,  3.0049e+00,  3.6760e+00,  3.6035e+00]],

         [[-7.3498e-01,        -inf,        -inf,        -inf],
          [ 1.3955e+00,  7.9698e-02,        -inf,        -inf],
          [-5.2243e+00, -2.0771e-01,  3.1032e+00,        -inf],
          [ 4.9184e+00,  2.0187e+00,  7.0558e-02,  1.1235e+00]],

         [[ 4.9673e+00,        -inf,        -inf,        -inf],
          [-1.6608e+00, -2.3663e+00,        -inf,        -inf],
          [ 1.7543e+00,  5.5355e+00,  3.1642e+00,        -inf],
          [ 3.7934e-01,  4.6866e-01,  5.4298e+00,  1.2764e+00]],

         [[ 1.5836e+00,        -inf,        -inf,        -inf],
          [ 3.4399e+00, -2.7819e+00,        -inf,        -inf],
          [ 1.4414e+00,  7.2738e-01,  7.1844e-01,        -inf],
          [-1.8075e-01, -4.7404e+00, -1.7807e+00,  1.8488e-01]],

         [[-3.2910e+00,        -inf,        -inf,        -inf],
          [-2.8621e+00, -2.5342e+00,        -inf,        -inf],
          [ 2.6049e-01,  7.3975e-01, -1.5608e+00,        -inf],
          [-3.0225e-01, -1.2068e+00, -3.0855e+00, -3.6932e+00]],

         [[ 2.0930e+00,        -inf,        -inf,        -inf],
          [-1.6308e+00, -2.5190e+00,        -inf,        -inf],
          [ 1.1946e+00, -1.0427e+00, -1.6979e+00,        -inf],
          [-1.5090e+00, -1.9372e-01,  7.1602e-01, -1.2673e-01]],

         [[-3.6024e+00,        -inf,        -inf,        -inf],
          [-3.2114e+00, -1.3530e+00,        -inf,        -inf],
          [ 5.3238e-01,  4.3605e+00,  5.3869e+00,        -inf],
          [ 4.8499e-01,  5.9104e-01,  2.9564e+00,  2.1495e+00]],

         [[ 4.4941e+00,        -inf,        -inf,        -inf],
          [ 3.5502e+00, -5.8011e-01,        -inf,        -inf],
          [-2.6667e-01, -2.1543e+00,  5.1885e-01,        -inf],
          [ 3.8175e+00, -5.4988e+00, -1.2149e+00,  9.3837e-01]],

         [[ 1.0743e+00,        -inf,        -inf,        -inf],
          [ 1.3760e+00,  1.1304e+00,        -inf,        -inf],
          [ 3.8828e+00,  9.5487e-01,  3.3423e+00,        -inf],
          [ 5.9638e-01,  4.5403e-01,  2.4085e+00, -1.7780e-02]],

         [[-3.8704e+00,        -inf,        -inf,        -inf],
          [-9.1268e-01,  3.5783e+00,        -inf,        -inf],
          [ 1.6800e-01,  1.7452e+00, -4.2602e+00,        -inf],
          [ 1.0279e+00,  3.3501e+00, -2.7362e+00,  3.2846e+00]],

         [[-2.0225e+00,        -inf,        -inf,        -inf],
          [ 9.2616e-01, -1.7227e+00,        -inf,        -inf],
          [ 2.4631e+00, -3.8452e+00, -4.1206e+00,        -inf],
          [-1.3647e+00, -3.7648e+00, -5.2393e+00, -3.7989e+00]],

         [[ 1.5756e+00,        -inf,        -inf,        -inf],
          [-5.0029e+00,  3.2596e+00,        -inf,        -inf],
          [ 1.1605e+00,  1.8108e+00,  2.3349e-01,        -inf],
          [ 6.7153e-01,  2.7493e+00,  4.7208e-01, -1.3127e+00]],

         [[-2.5913e+00,        -inf,        -inf,        -inf],
          [-4.7747e+00, -8.6583e-01,        -inf,        -inf],
          [-4.6448e+00, -1.9404e+00, -7.0754e-01,        -inf],
          [-8.4709e+00, -2.2423e+00, -1.4166e+00, -2.5588e+00]],

         [[ 2.6931e+00,        -inf,        -inf,        -inf],
          [ 4.1596e-01, -2.4980e+00,        -inf,        -inf],
          [ 3.8637e+00, -1.0986e+00,  7.8185e-01,        -inf],
          [-1.1053e+00, -3.6255e+00, -3.2348e+00, -3.4899e+00]],

         [[-4.7006e+00,        -inf,        -inf,        -inf],
          [-6.4810e+00, -1.9206e+00,        -inf,        -inf],
          [-4.8406e-01, -1.9472e+00, -6.3205e-01,        -inf],
          [-1.4694e+00,  1.8586e-01, -1.1214e+00,  2.2328e+00]],

         [[-4.9586e-01,        -inf,        -inf,        -inf],
          [ 5.7297e-01,  1.4720e+00,        -inf,        -inf],
          [-4.2138e-01, -2.5889e+00, -2.4643e+00,        -inf],
          [ 6.1958e-01,  4.9437e+00,  2.5226e+00,  4.9047e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 8.7457e-01, -1.5593e-01,  3.2343e-01,  ...,  5.5306e-01,
           -4.3187e-01,  1.0569e-01],
          [-6.1804e-01, -5.2930e-01,  4.9331e-01,  ...,  6.4699e-01,
           -2.9511e-02,  6.1834e-03],
          [ 5.7919e-01,  7.7190e-01,  4.0834e-01,  ..., -1.4822e-01,
            8.6326e-01, -1.0920e+00],
          ...,
          [ 6.5443e-02,  2.0961e-01,  9.8505e-01,  ...,  1.3798e-01,
            6.7494e-02, -1.3956e-02],
          [ 4.6492e-01, -3.5292e-01,  1.0009e-01,  ..., -5.7233e-01,
            2.3698e-01, -7.7088e-02],
          [-6.0635e-01, -9.3608e-01, -5.8581e-01,  ...,  6.3214e-01,
            3.0282e-01, -1.9302e+00]],

         [[ 5.8178e-01, -3.9658e-01,  9.7250e-02,  ...,  4.2582e-01,
            8.1491e-02,  9.6362e-02],
          [-4.5199e-01, -1.2904e-01,  5.6725e-01,  ...,  4.9951e-01,
            7.5124e-03,  1.2739e-01],
          [ 2.7820e-01,  1.2101e+00,  1.7841e-01,  ..., -2.9997e-01,
            1.0342e+00, -1.0315e+00],
          ...,
          [-1.1466e-01, -5.7533e-01,  6.7527e-01,  ...,  3.9152e-01,
           -5.1213e-01, -2.0719e-02],
          [ 1.9389e-01, -1.4718e-01,  4.1741e-02,  ..., -2.3869e-01,
            9.8833e-02, -3.2150e-02],
          [-2.9129e-01, -4.4969e-01, -2.8142e-01,  ...,  3.0368e-01,
            1.4548e-01, -9.2728e-01]],

         [[ 5.5483e-01, -2.7844e-01,  2.7868e-01,  ...,  3.7682e-01,
            1.1158e-01,  1.0263e-01],
          [-2.2590e-01,  1.6780e-02,  4.6827e-01,  ...,  2.7753e-01,
            4.0082e-03, -1.1773e-01],
          [ 5.5412e-02,  1.0395e+00,  3.3143e-01,  ..., -2.1641e-01,
            1.0108e+00, -7.8372e-01],
          ...,
          [ 4.8765e-01, -8.4224e-01,  8.5503e-01,  ...,  3.9567e-01,
           -2.6573e-01,  2.7305e-02],
          [-4.9800e-01, -2.5537e-01,  6.9950e-02,  ..., -9.4788e-01,
           -5.0488e-02,  5.9618e-01],
          [-4.0095e-02, -3.3156e-01, -2.9262e-01,  ...,  3.9385e-01,
           -6.1176e-01, -1.5227e+00]],

         [[ 4.6281e-01, -7.4710e-02,  2.8837e-01,  ...,  3.7177e-01,
            1.2853e-01,  1.2956e-01],
          [-3.9775e-01,  1.6086e-01,  3.7723e-01,  ...,  2.6179e-01,
            1.0628e-01, -1.0754e-01],
          [ 1.2321e-01,  7.7145e-01,  1.3740e-01,  ..., -2.9022e-01,
            1.0629e+00, -6.5932e-01],
          ...,
          [ 4.4828e-01, -1.1519e+00,  5.8462e-01,  ...,  3.9091e-01,
           -2.1237e-01,  2.6146e-01],
          [-2.9749e-01, -3.4869e-01,  2.0244e-01,  ..., -7.1320e-01,
            5.5072e-02,  8.4270e-01],
          [-1.5612e-01, -3.2209e-02, -1.2656e-01,  ...,  8.5299e-02,
           -1.4340e-01, -5.8780e-01]]],


        [[[ 8.3071e-01, -3.4760e-02,  6.3128e-01,  ...,  4.2500e-01,
           -6.6692e-01,  1.4594e-01],
          [-1.1709e+00, -4.2326e-01,  9.1343e-01,  ...,  2.2872e-01,
            4.7607e-01, -4.7046e-01],
          [ 2.6157e-01,  1.3125e+00,  5.5986e-01,  ..., -7.4199e-01,
            8.4346e-01, -6.3276e-01],
          ...,
          [ 1.9477e-01,  2.0961e-01,  6.3892e-01,  ...,  1.5236e-01,
           -8.1686e-01,  3.5075e-02],
          [ 1.5303e-01, -3.1326e-01,  4.0721e-01,  ..., -7.6656e-01,
           -3.9851e-01, -9.5226e-02],
          [ 1.9153e-01, -7.3531e-01,  9.5204e-02,  ...,  1.0832e+00,
           -1.0730e-01, -2.1331e+00]],

         [[ 4.4938e-01, -2.1164e-01,  2.2799e-01,  ...,  1.0267e+00,
           -9.5471e-01,  2.0134e-01],
          [-8.4464e-01,  1.8301e-01,  9.0480e-01,  ..., -8.4422e-02,
            2.5046e-01, -2.6303e-03],
          [-2.3582e-02,  6.4336e-01,  7.9173e-02,  ...,  4.2810e-01,
            6.5594e-01, -1.3045e-01],
          ...,
          [ 2.5329e-01, -1.1282e-01,  9.7852e-01,  ...,  5.4233e-02,
           -5.4453e-01,  4.2739e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 2.8494e-01, -4.2179e-01,  3.2386e-01,  ...,  1.1437e+00,
           -5.9230e-01, -1.5061e+00]],

         [[ 2.8188e-01, -2.5646e-01,  2.5048e-01,  ...,  1.0370e+00,
           -9.7182e-01,  1.1221e-01],
          [-5.6026e-01,  6.6009e-02,  9.3143e-01,  ..., -2.8892e-01,
           -1.7153e-01, -7.7857e-02],
          [ 1.2050e-01,  1.0148e+00,  4.4802e-01,  ..., -2.8844e-01,
            9.9383e-01, -3.7633e-01],
          ...,
          [ 3.3311e-01, -1.4700e-01,  5.5484e-01,  ...,  6.1092e-02,
           -1.7551e-01,  6.6867e-01],
          [-4.3417e-01, -4.0330e-01,  2.4051e-01,  ..., -4.0926e-01,
           -1.8268e-03, -3.0845e-02],
          [-6.7574e-02,  1.2648e-01, -8.2415e-02,  ...,  7.0738e-01,
           -4.7734e-01, -1.2931e+00]],

         [[ 1.7289e-01, -8.6788e-02,  3.6206e-01,  ...,  4.2995e-01,
           -5.4531e-01, -1.5521e-01],
          [-7.8001e-01,  1.3387e-01,  6.8096e-01,  ..., -4.3049e-01,
           -1.2641e-01, -1.5179e-03],
          [ 1.6430e-01,  7.2620e-01,  3.7902e-01,  ..., -3.6561e-01,
            1.0881e+00, -8.5656e-02],
          ...,
          [ 2.0885e-01, -6.3022e-02,  8.5812e-01,  ..., -2.0846e-02,
           -5.1453e-01,  6.3799e-01],
          [-7.6683e-01, -5.6541e-01,  6.1623e-01,  ..., -3.6240e-01,
            1.3703e-01,  1.5829e-01],
          [-4.6385e-02,  1.8677e-01, -3.1387e-02,  ...,  5.6527e-01,
           -4.8194e-01, -8.9656e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.8746, -0.1559,  0.3234,  ...,  0.6321,  0.3028, -1.9302],
         [ 0.5818, -0.3966,  0.0973,  ...,  0.3037,  0.1455, -0.9273],
         [ 0.5548, -0.2784,  0.2787,  ...,  0.3939, -0.6118, -1.5227],
         [ 0.4628, -0.0747,  0.2884,  ...,  0.0853, -0.1434, -0.5878]],

        [[ 0.8307, -0.0348,  0.6313,  ...,  1.0832, -0.1073, -2.1331],
         [ 0.4494, -0.2116,  0.2280,  ...,  1.1437, -0.5923, -1.5061],
         [ 0.2819, -0.2565,  0.2505,  ...,  0.7074, -0.4773, -1.2931],
         [ 0.1729, -0.0868,  0.3621,  ...,  0.5653, -0.4819, -0.8966]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0550,  0.1621,  0.4235,  ..., -0.0420,  0.2881, -0.1080],
         [ 0.1981,  0.1797,  0.3628,  ..., -0.2988,  0.2905, -0.1760],
         [-0.0061,  0.1801,  0.5415,  ..., -0.2625,  0.3456, -0.1444],
         [-0.0219,  0.2320,  0.3609,  ..., -0.2061,  0.2116, -0.2800]],

        [[-0.2676,  0.2367, -0.0355,  ..., -0.1225,  0.3121,  0.1465],
         [-0.2103,  0.2564, -0.3866,  ..., -0.3045,  0.1748,  0.0661],
         [-0.0966,  0.0371, -0.2491,  ..., -0.3710,  0.3138,  0.2183],
         [-0.2487,  0.1330, -0.0659,  ..., -0.1689,  0.2093,  0.3002]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.8799,    -inf,    -inf,    -inf],
          [-4.3027, -2.0913,    -inf,    -inf],
          [ 4.3665,  3.3284,  0.3011,    -inf],
          [ 1.3068, -0.5197,  1.4434,  1.1422]],

         [[-2.8100,    -inf,    -inf,    -inf],
          [-1.7071, -1.3340,    -inf,    -inf],
          [ 2.0937,  0.8829,  1.5130,    -inf],
          [ 1.9252, -1.1590,  2.7212,  0.3866]],

         [[-1.2171,    -inf,    -inf,    -inf],
          [ 1.4520,  1.7392,    -inf,    -inf],
          [ 3.1437, -0.4801, -0.4039,    -inf],
          [-1.6541, -3.3113, -4.6748, -3.1451]],

         [[-3.1521,    -inf,    -inf,    -inf],
          [-4.0805, -1.9435,    -inf,    -inf],
          [-0.6958,  2.1303,  5.3045,    -inf],
          [-2.5476, -0.8882,  2.9516,  0.6063]],

         [[ 3.8306,    -inf,    -inf,    -inf],
          [-0.3480,  1.7547,    -inf,    -inf],
          [-0.8018,  0.5677, -1.5287,    -inf],
          [-2.9622, -2.9494, -3.1023, -0.4054]],

         [[-2.0948,    -inf,    -inf,    -inf],
          [-0.4802,  1.7214,    -inf,    -inf],
          [ 0.5647,  0.8322,  3.6092,    -inf],
          [-4.1507, -0.7535, -1.2805, -1.3404]],

         [[-5.0040,    -inf,    -inf,    -inf],
          [-2.1247, -0.4365,    -inf,    -inf],
          [-1.0642,  1.9642, -4.6631,    -inf],
          [ 0.6981,  3.7704, -5.3149,  0.2047]],

         [[ 1.1991,    -inf,    -inf,    -inf],
          [ 5.0366,  1.7932,    -inf,    -inf],
          [ 2.7454,  2.7952,  0.8346,    -inf],
          [ 0.9037,  1.1429,  0.0096, -0.8398]],

         [[ 0.8677,    -inf,    -inf,    -inf],
          [ 3.2139,  5.6986,    -inf,    -inf],
          [ 1.5425, -1.6831, -0.9415,    -inf],
          [ 1.6422,  3.7702, -0.5418,  2.3204]],

         [[ 0.5740,    -inf,    -inf,    -inf],
          [-3.5597, -1.8535,    -inf,    -inf],
          [-3.9112, -7.8755, -3.2794,    -inf],
          [ 1.7154, -1.0607,  1.8714,  2.5722]],

         [[-0.1711,    -inf,    -inf,    -inf],
          [-2.9463, -3.7696,    -inf,    -inf],
          [-5.1722, -1.0855,  0.2545,    -inf],
          [-1.8794, -1.9697, -1.1427,  1.7840]],

         [[ 2.3398,    -inf,    -inf,    -inf],
          [-2.2366, -0.6444,    -inf,    -inf],
          [-1.0745,  2.6010, -1.6071,    -inf],
          [ 0.2761,  1.7573, -4.0391, -3.3199]],

         [[ 0.3923,    -inf,    -inf,    -inf],
          [ 3.2577,  0.9509,    -inf,    -inf],
          [-2.0027, -3.5414, -0.4392,    -inf],
          [-0.6596, -0.5550,  0.2504, -3.3747]],

         [[-0.3179,    -inf,    -inf,    -inf],
          [-2.1951, -3.6584,    -inf,    -inf],
          [-2.2564, -1.9578,  2.1584,    -inf],
          [ 1.5173,  3.1167,  1.6891,  0.6515]],

         [[ 1.5900,    -inf,    -inf,    -inf],
          [ 3.9156,  0.2700,    -inf,    -inf],
          [ 1.7838,  2.2588,  1.4745,    -inf],
          [ 6.5484,  5.1142,  2.3876,  2.0275]],

         [[-0.9983,    -inf,    -inf,    -inf],
          [-1.0760,  1.9000,    -inf,    -inf],
          [ 1.1868, -0.6557,  3.4668,    -inf],
          [ 2.6239, -0.3185, -0.6740, -2.3205]],

         [[ 0.6595,    -inf,    -inf,    -inf],
          [-0.3992,  0.1323,    -inf,    -inf],
          [-1.0032, -5.5950,  2.8623,    -inf],
          [-1.4846, -3.5421, -0.9554,  0.7388]],

         [[-0.5766,    -inf,    -inf,    -inf],
          [-0.2914, -1.5991,    -inf,    -inf],
          [-2.0805, -1.4636,  0.2964,    -inf],
          [-3.0330,  1.3165, -2.0748, -2.3557]],

         [[-1.3675,    -inf,    -inf,    -inf],
          [ 1.5043, -0.9507,    -inf,    -inf],
          [ 4.6727, -1.7212,  4.0074,    -inf],
          [ 0.7273,  4.4746, -0.8724,  2.5117]],

         [[ 1.6639,    -inf,    -inf,    -inf],
          [ 5.9891,  1.6588,    -inf,    -inf],
          [ 4.6891, -2.2275,  0.7923,    -inf],
          [ 0.8086, -0.4285,  1.4686, -0.3014]],

         [[ 1.9718,    -inf,    -inf,    -inf],
          [ 0.3228,  1.0183,    -inf,    -inf],
          [ 1.2850, -2.8013, -1.5886,    -inf],
          [-0.0489, -1.5002,  0.0362,  0.7916]],

         [[ 3.1714,    -inf,    -inf,    -inf],
          [ 1.5334,  3.1908,    -inf,    -inf],
          [-1.0994, -2.6364, -3.4522,    -inf],
          [-0.1849,  0.8712, -1.0681, -3.9416]],

         [[ 0.4049,    -inf,    -inf,    -inf],
          [-0.3802, -0.6333,    -inf,    -inf],
          [-1.5205, -1.7667, -1.1167,    -inf],
          [-1.8917, -0.8201, -1.0631,  0.9827]],

         [[-5.1988,    -inf,    -inf,    -inf],
          [-6.4530, -3.1058,    -inf,    -inf],
          [-1.1108,  0.9157,  0.8141,    -inf],
          [-3.4599, -4.6549, -1.4065,  0.2613]],

         [[ 0.2229,    -inf,    -inf,    -inf],
          [ 2.4254,  8.0179,    -inf,    -inf],
          [-1.0903, -1.2452, -2.4813,    -inf],
          [ 2.1442,  2.4163,  4.4102,  0.3440]]],


        [[[-1.2289,    -inf,    -inf,    -inf],
          [-3.2994, -3.3912,    -inf,    -inf],
          [ 0.3429,  2.2392,  0.8817,    -inf],
          [-3.0251, -1.5762,  0.8503, -1.4704]],

         [[-2.3722,    -inf,    -inf,    -inf],
          [ 1.0576,  2.8761,    -inf,    -inf],
          [ 1.1247,  3.7629,  2.1683,    -inf],
          [-1.1445, -2.7328, -2.0472, -4.3431]],

         [[-2.2648,    -inf,    -inf,    -inf],
          [-2.8302,  1.5526,    -inf,    -inf],
          [-6.8358, -0.0244, -4.9043,    -inf],
          [-0.7683, -3.1837, -4.4351,  2.1896]],

         [[-4.2803,    -inf,    -inf,    -inf],
          [-1.2918,  1.5295,    -inf,    -inf],
          [ 2.1467,  0.5967,  5.8519,    -inf],
          [ 1.0963,  0.2438, -0.3525, -0.2773]],

         [[ 0.0519,    -inf,    -inf,    -inf],
          [ 0.4097,  1.8113,    -inf,    -inf],
          [ 0.4519, -2.7076,  0.8147,    -inf],
          [-1.7833,  1.0476, -1.3300,  6.9505]],

         [[-0.8240,    -inf,    -inf,    -inf],
          [-4.4070,  3.0349,    -inf,    -inf],
          [ 0.6022,  3.0785,  7.6391,    -inf],
          [-2.8861, -0.7890, -0.3255,  0.5320]],

         [[-4.1473,    -inf,    -inf,    -inf],
          [-0.3345,  4.2907,    -inf,    -inf],
          [ 0.5327,  0.7262,  3.5141,    -inf],
          [-1.6952, -1.6519,  1.9885,  3.5060]],

         [[-3.6232,    -inf,    -inf,    -inf],
          [-1.7133,  1.5426,    -inf,    -inf],
          [-2.6762,  2.0894, -0.8719,    -inf],
          [-0.0516,  0.4692, -3.1575,  1.5378]],

         [[-0.1457,    -inf,    -inf,    -inf],
          [ 0.7663,  0.1999,    -inf,    -inf],
          [-4.4717, -2.4646, -2.7024,    -inf],
          [-0.4591, -3.2964,  2.5346,  0.0839]],

         [[-0.7414,    -inf,    -inf,    -inf],
          [ 0.8324,  0.8562,    -inf,    -inf],
          [ 3.0869,  0.3563, -3.4673,    -inf],
          [ 0.9845, -0.4324,  0.3273, -1.5627]],

         [[ 1.9750,    -inf,    -inf,    -inf],
          [-0.2561,  0.4627,    -inf,    -inf],
          [-3.7181, -2.5807, -0.5313,    -inf],
          [-3.1845, -0.9617, -2.0856, -0.8535]],

         [[ 2.2911,    -inf,    -inf,    -inf],
          [ 0.7260, -2.1904,    -inf,    -inf],
          [ 3.8377,  1.0823,  2.4785,    -inf],
          [ 1.7169, -2.3880, -1.7652, -1.4389]],

         [[ 5.0955,    -inf,    -inf,    -inf],
          [ 1.4547,  0.1672,    -inf,    -inf],
          [ 3.9828, -1.4674,  2.8192,    -inf],
          [ 2.4257, -0.3362, -0.4562, -0.8149]],

         [[ 3.1702,    -inf,    -inf,    -inf],
          [ 0.0943, -3.7205,    -inf,    -inf],
          [-0.8766, -4.4388, -0.6427,    -inf],
          [ 4.8427,  4.3195,  2.6055,  2.5728]],

         [[ 3.9186,    -inf,    -inf,    -inf],
          [ 4.2635,  1.9516,    -inf,    -inf],
          [ 1.9257,  0.0154,  3.6451,    -inf],
          [ 1.8555,  1.7705,  3.2806,  4.1733]],

         [[-0.8438,    -inf,    -inf,    -inf],
          [-1.6114, -0.7724,    -inf,    -inf],
          [ 1.4519,  1.3291,  3.6722,    -inf],
          [ 0.7644, -4.3061, -1.7354,  2.6923]],

         [[-3.4306,    -inf,    -inf,    -inf],
          [-1.7977, -3.3429,    -inf,    -inf],
          [ 0.8359,  0.0963, -0.9842,    -inf],
          [ 0.3136, -1.6921, -3.6900, -4.1487]],

         [[-1.2092,    -inf,    -inf,    -inf],
          [-4.4545,  0.1261,    -inf,    -inf],
          [-1.6680,  1.0316, -0.0521,    -inf],
          [ 0.0992,  1.9563, -0.0795, -0.3147]],

         [[ 0.2971,    -inf,    -inf,    -inf],
          [ 3.6681,  2.6959,    -inf,    -inf],
          [ 5.0592,  3.7413, -1.0055,    -inf],
          [ 2.2203,  1.6742, -3.1823,  2.1602]],

         [[-0.0123,    -inf,    -inf,    -inf],
          [ 4.6332,  3.0961,    -inf,    -inf],
          [-2.5976, -5.6617, -3.3010,    -inf],
          [-1.2231, -4.6548, -1.0740, -2.3462]],

         [[-0.6520,    -inf,    -inf,    -inf],
          [ 1.5653, -2.6633,    -inf,    -inf],
          [ 3.5656, -1.9988, -3.4228,    -inf],
          [ 2.5161, -0.8524, -0.0240, -1.3154]],

         [[-0.1346,    -inf,    -inf,    -inf],
          [-2.0169, -6.1331,    -inf,    -inf],
          [-3.4281, -3.2941, -4.1239,    -inf],
          [ 1.4801, -1.2659, -1.6185,  1.0280]],

         [[-0.3257,    -inf,    -inf,    -inf],
          [ 0.2895, -4.3628,    -inf,    -inf],
          [ 2.7218, -0.6018,  1.0680,    -inf],
          [-1.2539, -0.2055,  0.6123, -1.8047]],

         [[-2.5880,    -inf,    -inf,    -inf],
          [-0.3541, -2.3253,    -inf,    -inf],
          [-2.9080, -4.4969, -2.3608,    -inf],
          [-2.0309, -0.1873, -3.2918, -2.8190]],

         [[-1.7914,    -inf,    -inf,    -inf],
          [ 0.3060,  4.5295,    -inf,    -inf],
          [-0.2747, -0.1699,  0.4650,    -inf],
          [ 1.1652, -3.2389,  1.2134, -2.3398]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.8799,    -inf,    -inf,    -inf],
          [-4.3027, -2.0913,    -inf,    -inf],
          [ 4.3665,  3.3284,  0.3011,    -inf],
          [ 1.3068, -0.5197,  1.4434,  1.1422]],

         [[-2.8100,    -inf,    -inf,    -inf],
          [-1.7071, -1.3340,    -inf,    -inf],
          [ 2.0937,  0.8829,  1.5130,    -inf],
          [ 1.9252, -1.1590,  2.7212,  0.3866]],

         [[-1.2171,    -inf,    -inf,    -inf],
          [ 1.4520,  1.7392,    -inf,    -inf],
          [ 3.1437, -0.4801, -0.4039,    -inf],
          [-1.6541, -3.3113, -4.6748, -3.1451]],

         [[-3.1521,    -inf,    -inf,    -inf],
          [-4.0805, -1.9435,    -inf,    -inf],
          [-0.6958,  2.1303,  5.3045,    -inf],
          [-2.5476, -0.8882,  2.9516,  0.6063]],

         [[ 3.8306,    -inf,    -inf,    -inf],
          [-0.3480,  1.7547,    -inf,    -inf],
          [-0.8018,  0.5677, -1.5287,    -inf],
          [-2.9622, -2.9494, -3.1023, -0.4054]],

         [[-2.0948,    -inf,    -inf,    -inf],
          [-0.4802,  1.7214,    -inf,    -inf],
          [ 0.5647,  0.8322,  3.6092,    -inf],
          [-4.1507, -0.7535, -1.2805, -1.3404]],

         [[-5.0040,    -inf,    -inf,    -inf],
          [-2.1247, -0.4365,    -inf,    -inf],
          [-1.0642,  1.9642, -4.6631,    -inf],
          [ 0.6981,  3.7704, -5.3149,  0.2047]],

         [[ 1.1991,    -inf,    -inf,    -inf],
          [ 5.0366,  1.7932,    -inf,    -inf],
          [ 2.7454,  2.7952,  0.8346,    -inf],
          [ 0.9037,  1.1429,  0.0096, -0.8398]],

         [[ 0.8677,    -inf,    -inf,    -inf],
          [ 3.2139,  5.6986,    -inf,    -inf],
          [ 1.5425, -1.6831, -0.9415,    -inf],
          [ 1.6422,  3.7702, -0.5418,  2.3204]],

         [[ 0.5740,    -inf,    -inf,    -inf],
          [-3.5597, -1.8535,    -inf,    -inf],
          [-3.9112, -7.8755, -3.2794,    -inf],
          [ 1.7154, -1.0607,  1.8714,  2.5722]],

         [[-0.1711,    -inf,    -inf,    -inf],
          [-2.9463, -3.7696,    -inf,    -inf],
          [-5.1722, -1.0855,  0.2545,    -inf],
          [-1.8794, -1.9697, -1.1427,  1.7840]],

         [[ 2.3398,    -inf,    -inf,    -inf],
          [-2.2366, -0.6444,    -inf,    -inf],
          [-1.0745,  2.6010, -1.6071,    -inf],
          [ 0.2761,  1.7573, -4.0391, -3.3199]],

         [[ 0.3923,    -inf,    -inf,    -inf],
          [ 3.2577,  0.9509,    -inf,    -inf],
          [-2.0027, -3.5414, -0.4392,    -inf],
          [-0.6596, -0.5550,  0.2504, -3.3747]],

         [[-0.3179,    -inf,    -inf,    -inf],
          [-2.1951, -3.6584,    -inf,    -inf],
          [-2.2564, -1.9578,  2.1584,    -inf],
          [ 1.5173,  3.1167,  1.6891,  0.6515]],

         [[ 1.5900,    -inf,    -inf,    -inf],
          [ 3.9156,  0.2700,    -inf,    -inf],
          [ 1.7838,  2.2588,  1.4745,    -inf],
          [ 6.5484,  5.1142,  2.3876,  2.0275]],

         [[-0.9983,    -inf,    -inf,    -inf],
          [-1.0760,  1.9000,    -inf,    -inf],
          [ 1.1868, -0.6557,  3.4668,    -inf],
          [ 2.6239, -0.3185, -0.6740, -2.3205]],

         [[ 0.6595,    -inf,    -inf,    -inf],
          [-0.3992,  0.1323,    -inf,    -inf],
          [-1.0032, -5.5950,  2.8623,    -inf],
          [-1.4846, -3.5421, -0.9554,  0.7388]],

         [[-0.5766,    -inf,    -inf,    -inf],
          [-0.2914, -1.5991,    -inf,    -inf],
          [-2.0805, -1.4636,  0.2964,    -inf],
          [-3.0330,  1.3165, -2.0748, -2.3557]],

         [[-1.3675,    -inf,    -inf,    -inf],
          [ 1.5043, -0.9507,    -inf,    -inf],
          [ 4.6727, -1.7212,  4.0074,    -inf],
          [ 0.7273,  4.4746, -0.8724,  2.5117]],

         [[ 1.6639,    -inf,    -inf,    -inf],
          [ 5.9891,  1.6588,    -inf,    -inf],
          [ 4.6891, -2.2275,  0.7923,    -inf],
          [ 0.8086, -0.4285,  1.4686, -0.3014]],

         [[ 1.9718,    -inf,    -inf,    -inf],
          [ 0.3228,  1.0183,    -inf,    -inf],
          [ 1.2850, -2.8013, -1.5886,    -inf],
          [-0.0489, -1.5002,  0.0362,  0.7916]],

         [[ 3.1714,    -inf,    -inf,    -inf],
          [ 1.5334,  3.1908,    -inf,    -inf],
          [-1.0994, -2.6364, -3.4522,    -inf],
          [-0.1849,  0.8712, -1.0681, -3.9416]],

         [[ 0.4049,    -inf,    -inf,    -inf],
          [-0.3802, -0.6333,    -inf,    -inf],
          [-1.5205, -1.7667, -1.1167,    -inf],
          [-1.8917, -0.8201, -1.0631,  0.9827]],

         [[-5.1988,    -inf,    -inf,    -inf],
          [-6.4530, -3.1058,    -inf,    -inf],
          [-1.1108,  0.9157,  0.8141,    -inf],
          [-3.4599, -4.6549, -1.4065,  0.2613]],

         [[ 0.2229,    -inf,    -inf,    -inf],
          [ 2.4254,  8.0179,    -inf,    -inf],
          [-1.0903, -1.2452, -2.4813,    -inf],
          [ 2.1442,  2.4163,  4.4102,  0.3440]]],


        [[[-1.2289,    -inf,    -inf,    -inf],
          [-3.2994, -3.3912,    -inf,    -inf],
          [ 0.3429,  2.2392,  0.8817,    -inf],
          [-3.0251, -1.5762,  0.8503, -1.4704]],

         [[-2.3722,    -inf,    -inf,    -inf],
          [ 1.0576,  2.8761,    -inf,    -inf],
          [ 1.1247,  3.7629,  2.1683,    -inf],
          [-1.1445, -2.7328, -2.0472, -4.3431]],

         [[-2.2648,    -inf,    -inf,    -inf],
          [-2.8302,  1.5526,    -inf,    -inf],
          [-6.8358, -0.0244, -4.9043,    -inf],
          [-0.7683, -3.1837, -4.4351,  2.1896]],

         [[-4.2803,    -inf,    -inf,    -inf],
          [-1.2918,  1.5295,    -inf,    -inf],
          [ 2.1467,  0.5967,  5.8519,    -inf],
          [ 1.0963,  0.2438, -0.3525, -0.2773]],

         [[ 0.0519,    -inf,    -inf,    -inf],
          [ 0.4097,  1.8113,    -inf,    -inf],
          [ 0.4519, -2.7076,  0.8147,    -inf],
          [-1.7833,  1.0476, -1.3300,  6.9505]],

         [[-0.8240,    -inf,    -inf,    -inf],
          [-4.4070,  3.0349,    -inf,    -inf],
          [ 0.6022,  3.0785,  7.6391,    -inf],
          [-2.8861, -0.7890, -0.3255,  0.5320]],

         [[-4.1473,    -inf,    -inf,    -inf],
          [-0.3345,  4.2907,    -inf,    -inf],
          [ 0.5327,  0.7262,  3.5141,    -inf],
          [-1.6952, -1.6519,  1.9885,  3.5060]],

         [[-3.6232,    -inf,    -inf,    -inf],
          [-1.7133,  1.5426,    -inf,    -inf],
          [-2.6762,  2.0894, -0.8719,    -inf],
          [-0.0516,  0.4692, -3.1575,  1.5378]],

         [[-0.1457,    -inf,    -inf,    -inf],
          [ 0.7663,  0.1999,    -inf,    -inf],
          [-4.4717, -2.4646, -2.7024,    -inf],
          [-0.4591, -3.2964,  2.5346,  0.0839]],

         [[-0.7414,    -inf,    -inf,    -inf],
          [ 0.8324,  0.8562,    -inf,    -inf],
          [ 3.0869,  0.3563, -3.4673,    -inf],
          [ 0.9845, -0.4324,  0.3273, -1.5627]],

         [[ 1.9750,    -inf,    -inf,    -inf],
          [-0.2561,  0.4627,    -inf,    -inf],
          [-3.7181, -2.5807, -0.5313,    -inf],
          [-3.1845, -0.9617, -2.0856, -0.8535]],

         [[ 2.2911,    -inf,    -inf,    -inf],
          [ 0.7260, -2.1904,    -inf,    -inf],
          [ 3.8377,  1.0823,  2.4785,    -inf],
          [ 1.7169, -2.3880, -1.7652, -1.4389]],

         [[ 5.0955,    -inf,    -inf,    -inf],
          [ 1.4547,  0.1672,    -inf,    -inf],
          [ 3.9828, -1.4674,  2.8192,    -inf],
          [ 2.4257, -0.3362, -0.4562, -0.8149]],

         [[ 3.1702,    -inf,    -inf,    -inf],
          [ 0.0943, -3.7205,    -inf,    -inf],
          [-0.8766, -4.4388, -0.6427,    -inf],
          [ 4.8427,  4.3195,  2.6055,  2.5728]],

         [[ 3.9186,    -inf,    -inf,    -inf],
          [ 4.2635,  1.9516,    -inf,    -inf],
          [ 1.9257,  0.0154,  3.6451,    -inf],
          [ 1.8555,  1.7705,  3.2806,  4.1733]],

         [[-0.8438,    -inf,    -inf,    -inf],
          [-1.6114, -0.7724,    -inf,    -inf],
          [ 1.4519,  1.3291,  3.6722,    -inf],
          [ 0.7644, -4.3061, -1.7354,  2.6923]],

         [[-3.4306,    -inf,    -inf,    -inf],
          [-1.7977, -3.3429,    -inf,    -inf],
          [ 0.8359,  0.0963, -0.9842,    -inf],
          [ 0.3136, -1.6921, -3.6900, -4.1487]],

         [[-1.2092,    -inf,    -inf,    -inf],
          [-4.4545,  0.1261,    -inf,    -inf],
          [-1.6680,  1.0316, -0.0521,    -inf],
          [ 0.0992,  1.9563, -0.0795, -0.3147]],

         [[ 0.2971,    -inf,    -inf,    -inf],
          [ 3.6681,  2.6959,    -inf,    -inf],
          [ 5.0592,  3.7413, -1.0055,    -inf],
          [ 2.2203,  1.6742, -3.1823,  2.1602]],

         [[-0.0123,    -inf,    -inf,    -inf],
          [ 4.6332,  3.0961,    -inf,    -inf],
          [-2.5976, -5.6617, -3.3010,    -inf],
          [-1.2231, -4.6548, -1.0740, -2.3462]],

         [[-0.6520,    -inf,    -inf,    -inf],
          [ 1.5653, -2.6633,    -inf,    -inf],
          [ 3.5656, -1.9988, -3.4228,    -inf],
          [ 2.5161, -0.8524, -0.0240, -1.3154]],

         [[-0.1346,    -inf,    -inf,    -inf],
          [-2.0169, -6.1331,    -inf,    -inf],
          [-3.4281, -3.2941, -4.1239,    -inf],
          [ 1.4801, -1.2659, -1.6185,  1.0280]],

         [[-0.3257,    -inf,    -inf,    -inf],
          [ 0.2895, -4.3628,    -inf,    -inf],
          [ 2.7218, -0.6018,  1.0680,    -inf],
          [-1.2539, -0.2055,  0.6123, -1.8047]],

         [[-2.5880,    -inf,    -inf,    -inf],
          [-0.3541, -2.3253,    -inf,    -inf],
          [-2.9080, -4.4969, -2.3608,    -inf],
          [-2.0309, -0.1873, -3.2918, -2.8190]],

         [[-1.7914,    -inf,    -inf,    -inf],
          [ 0.3060,  4.5295,    -inf,    -inf],
          [-0.2747, -0.1699,  0.4650,    -inf],
          [ 1.1652, -3.2389,  1.2134, -2.3398]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-1.3050e+00, -1.1994e-01, -8.0393e-01,  ...,  4.1475e-05,
            1.0769e+00, -9.2623e-01],
          [ 6.4095e-01, -6.2061e-01, -9.2078e-01,  ..., -8.2796e-01,
           -9.2981e-02,  2.2437e-01],
          [ 4.5979e-02,  6.4954e-02,  3.2620e-01,  ...,  1.8567e-01,
            4.9442e-01, -2.3301e-01],
          ...,
          [-1.1472e-01, -3.1316e-01,  1.0351e+00,  ..., -5.3094e-01,
           -4.2733e-01, -2.9907e-01],
          [-2.5714e-01,  3.6798e-01,  5.5483e-02,  ..., -8.7647e-01,
           -5.6949e-01, -9.8281e-01],
          [ 1.1451e-02, -6.2103e-01, -2.5145e-01,  ..., -2.6071e-02,
           -3.9301e-01, -4.3506e-01]],

         [[-8.3793e-01, -3.8236e-01, -3.0130e-01,  ...,  6.1692e-02,
            7.3030e-01, -5.6511e-01],
          [ 9.5256e-01, -5.8678e-01, -7.3289e-01,  ..., -9.6081e-01,
            2.0610e-01, -1.4968e-01],
          [-2.5782e-01,  2.7236e-01, -6.6229e-02,  ...,  3.5761e-01,
            1.6765e-01,  1.2055e-02],
          ...,
          [-3.0494e-01, -2.5640e-01,  8.9700e-01,  ..., -4.0464e-01,
            3.0694e-01, -1.5927e-01],
          [ 5.6990e-01,  7.2167e-02,  2.0116e-01,  ..., -5.9887e-01,
           -1.0839e-01, -8.7304e-02],
          [ 6.5610e-01, -8.6100e-02,  2.0461e-01,  ..., -1.3362e-01,
           -5.5334e-01, -1.7879e-01]],

         [[-8.3498e-01, -4.3217e-01, -1.9583e-01,  ...,  2.8679e-01,
            6.9210e-01, -9.2355e-01],
          [ 7.8412e-01, -6.5735e-01, -4.2586e-01,  ..., -7.3824e-01,
            9.9349e-02,  1.7928e-01],
          [-1.1478e-01,  2.3297e-01, -3.2776e-01,  ...,  2.3345e-01,
            6.2705e-01, -1.0928e-01],
          ...,
          [-1.9885e-01, -1.6713e-01,  5.8471e-01,  ..., -2.6375e-01,
            2.0030e-01, -1.0379e-01],
          [ 2.7368e-01,  8.8557e-02,  1.6934e-01,  ..., -5.5219e-01,
           -1.0541e-01, -9.6938e-03],
          [ 3.4356e-01, -1.5762e-01,  6.0817e-02,  ..., -7.4279e-02,
           -3.5939e-01, -1.7208e-01]],

         [[-5.9754e-01, -3.5030e-01, -8.4595e-02,  ...,  2.9736e-01,
            4.8407e-01, -7.9943e-01],
          [ 5.2554e-01, -6.0153e-01, -2.5579e-01,  ..., -8.5554e-01,
           -2.0903e-02,  2.2309e-01],
          [ 2.5189e-02,  2.1411e-01, -5.2070e-01,  ...,  2.3481e-01,
            5.1621e-01,  8.3465e-02],
          ...,
          [-3.8478e-01,  8.3840e-02,  3.5792e-01,  ...,  1.3172e-01,
           -2.6244e-02, -2.7752e-01],
          [-1.4364e-01, -1.1193e-01, -1.3888e-01,  ..., -3.3340e-01,
            3.6993e-02, -1.4221e-01],
          [ 2.5108e-01, -3.4736e-01, -3.7990e-01,  ..., -1.9875e-01,
           -3.9484e-01,  2.0490e-02]]],


        [[[-7.9791e-01, -5.3105e-01, -6.8528e-01,  ..., -3.2504e-01,
            1.9631e-01, -4.3448e-01],
          [-6.9633e-03,  2.0797e-01, -1.4667e+00,  ..., -1.1912e+00,
           -1.5203e-01, -6.5970e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [ 1.1908e-01,  3.5477e-01,  1.4980e-01,  ..., -1.0618e-01,
           -2.7979e-01, -1.3317e-01],
          [-2.1970e-01, -2.9940e-01, -3.1160e-01,  ..., -2.7778e-01,
           -1.9444e-01, -7.5849e-01],
          [-2.6972e-01, -7.6547e-02,  5.0853e-01,  ..., -9.0597e-01,
            3.7940e-01, -3.6282e-01]],

         [[-9.1164e-01, -1.1293e+00, -6.5050e-01,  ..., -4.0502e-01,
            1.5071e-01, -1.9304e-01],
          [ 3.9981e-01,  1.5152e-01, -1.0367e+00,  ..., -8.7724e-01,
           -4.3388e-03, -5.4471e-01],
          [-4.8891e-01, -4.4502e-01, -5.1846e-01,  ..., -5.7849e-02,
            5.0818e-01,  6.2405e-01],
          ...,
          [ 8.8357e-02,  2.9603e-02,  1.4325e-01,  ..., -7.2542e-02,
           -1.2114e-01, -7.7082e-02],
          [ 4.0040e-01, -3.4987e-01,  1.2503e-01,  ..., -5.3961e-01,
           -3.4116e-02, -3.3806e-01],
          [ 2.9817e-01, -2.9857e-01,  3.3563e-01,  ..., -6.6444e-01,
            3.3533e-01, -4.4549e-01]],

         [[-2.6090e-01, -5.8662e-01, -4.9211e-02,  ..., -1.0846e-01,
            1.2027e-01, -6.3652e-01],
          [ 4.6019e-01,  6.9730e-02, -4.3912e-01,  ..., -6.0003e-01,
           -5.7082e-02, -4.5115e-01],
          [-4.5911e-01, -7.5400e-01, -4.8773e-01,  ..., -6.3598e-02,
            8.1247e-01,  4.9722e-01],
          ...,
          [-1.5466e-01,  7.6844e-02, -1.2821e-01,  ...,  8.2107e-02,
           -3.6636e-01, -3.6663e-01],
          [ 5.0742e-01, -2.3407e-01,  3.0075e-01,  ..., -6.0959e-01,
            9.6601e-02, -4.1778e-01],
          [ 8.2515e-02, -1.1313e-01, -8.0567e-02,  ..., -5.1982e-01,
            4.2985e-01, -3.8851e-01]],

         [[-5.9940e-01, -9.8586e-01, -3.1007e-01,  ..., -8.9282e-02,
           -1.0589e-01, -8.1001e-01],
          [ 2.8218e-01,  1.9538e-01, -3.6822e-01,  ..., -8.1706e-01,
            9.0933e-03, -3.6539e-01],
          [ 4.3262e-02, -6.4391e-01, -3.8377e-01,  ..., -6.1647e-02,
            7.7226e-01,  3.7374e-01],
          ...,
          [-2.1924e-01, -1.3446e-01, -3.2112e-02,  ...,  2.0348e-01,
           -4.2786e-01, -5.4734e-01],
          [ 5.6323e-01, -2.2507e-01,  3.2920e-01,  ..., -6.1095e-01,
            4.4335e-02, -2.1020e-01],
          [-2.0726e-01,  3.6879e-02,  7.1445e-02,  ..., -5.0207e-01,
            5.3659e-01, -2.1989e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-1.3050, -0.1199, -0.8039,  ..., -0.0261, -0.3930, -0.4351],
         [-0.8379, -0.3824, -0.3013,  ..., -0.1336, -0.5533, -0.1788],
         [-0.8350, -0.4322, -0.1958,  ..., -0.0743, -0.3594, -0.1721],
         [-0.5975, -0.3503, -0.0846,  ..., -0.1988, -0.3948,  0.0205]],

        [[-0.7979, -0.5311, -0.6853,  ..., -0.9060,  0.3794, -0.3628],
         [-0.9116, -1.1293, -0.6505,  ..., -0.6644,  0.3353, -0.4455],
         [-0.2609, -0.5866, -0.0492,  ..., -0.5198,  0.4299, -0.3885],
         [-0.5994, -0.9859, -0.3101,  ..., -0.5021,  0.5366, -0.2199]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.5415, -0.1134,  0.3491,  ...,  0.5314,  0.3852,  0.7310],
         [ 0.2170, -0.1054,  0.3777,  ...,  0.3931,  0.0303,  0.1952],
         [ 0.4138,  0.1711,  0.3779,  ...,  0.4006, -0.0732,  0.1211],
         [ 0.2140,  0.1915,  0.1644,  ...,  0.1969,  0.0436,  0.1166]],

        [[ 0.4551, -0.3130,  0.4651,  ...,  0.3282,  0.3725,  0.7501],
         [ 0.2581, -0.1514,  0.5466,  ...,  0.0980, -0.0658,  0.3589],
         [ 0.3863, -0.1275,  0.3196,  ..., -0.1684,  0.1966,  0.2134],
         [ 0.3517, -0.0014,  0.3292,  ..., -0.2315, -0.0479,  0.2417]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-4.7408e-02,        -inf,        -inf,        -inf],
          [-6.2335e-01, -3.8186e-02,        -inf,        -inf],
          [ 1.0326e+00, -1.1602e+00,  1.4980e+00,        -inf],
          [-2.1084e+00,  1.8729e+00,  3.3509e+00,  4.5175e-01]],

         [[ 4.7720e+00,        -inf,        -inf,        -inf],
          [ 5.9210e+00,  4.8749e+00,        -inf,        -inf],
          [ 3.1355e+00,  2.5124e+00,  7.4809e-01,        -inf],
          [-2.6857e-01,  3.6161e-01,  3.5238e+00,  3.2777e+00]],

         [[ 2.7424e+00,        -inf,        -inf,        -inf],
          [ 9.6218e-02, -2.1331e+00,        -inf,        -inf],
          [ 9.2602e-01,  7.3201e-01, -1.8977e+00,        -inf],
          [ 2.9870e+00, -2.4734e+00, -4.1371e+00,  4.6542e+00]],

         [[-4.8023e-01,        -inf,        -inf,        -inf],
          [-3.8809e-01, -1.5741e+00,        -inf,        -inf],
          [ 4.3813e+00, -3.6140e-01,  6.3285e-01,        -inf],
          [-2.8254e+00, -2.9638e-01, -4.0748e+00, -5.1185e+00]],

         [[ 4.8049e+00,        -inf,        -inf,        -inf],
          [ 3.7525e+00,  2.1178e+00,        -inf,        -inf],
          [ 4.5374e+00,  2.8778e+00,  3.7844e+00,        -inf],
          [-7.0081e-02, -3.9042e+00,  2.9094e+00, -2.7429e-01]],

         [[ 1.0699e+00,        -inf,        -inf,        -inf],
          [-6.2474e-01, -4.3947e+00,        -inf,        -inf],
          [ 4.7660e-01, -3.6275e+00, -2.8296e+00,        -inf],
          [ 2.5895e-01, -1.6072e+00, -2.6502e+00, -6.7448e-01]],

         [[-3.1056e+00,        -inf,        -inf,        -inf],
          [-3.5657e+00, -3.4931e+00,        -inf,        -inf],
          [-3.7452e+00, -1.6385e+00, -1.8616e+00,        -inf],
          [ 1.8551e+00, -7.7873e-01, -1.4294e+00,  7.4233e-01]],

         [[ 1.9739e+00,        -inf,        -inf,        -inf],
          [ 1.0624e+00, -2.4132e+00,        -inf,        -inf],
          [ 1.0473e+00, -3.4384e+00, -1.5973e+00,        -inf],
          [ 5.3210e-01, -6.2002e+00, -2.6846e-01, -3.5561e+00]],

         [[ 1.5332e+00,        -inf,        -inf,        -inf],
          [ 4.6464e+00,  3.7528e+00,        -inf,        -inf],
          [-2.5925e+00, -9.0590e-01, -9.2287e-01,        -inf],
          [-3.9473e+00, -2.9275e+00,  7.3736e-01,  1.5272e+00]],

         [[ 1.7646e+00,        -inf,        -inf,        -inf],
          [ 3.6016e-01,  8.5578e-01,        -inf,        -inf],
          [ 1.7597e+00,  6.0516e-01,  2.7355e+00,        -inf],
          [ 3.7090e-01,  1.3270e+00,  6.1367e-01,  4.2517e+00]],

         [[ 5.7940e-01,        -inf,        -inf,        -inf],
          [ 1.3150e+00,  4.9224e+00,        -inf,        -inf],
          [ 5.5180e-01,  3.6562e+00,  2.0579e+00,        -inf],
          [-2.1126e-01,  2.4654e+00,  7.3647e+00,  2.0625e+00]],

         [[ 1.0654e+00,        -inf,        -inf,        -inf],
          [-6.8229e-01, -5.7244e+00,        -inf,        -inf],
          [ 1.8000e+00, -8.6721e+00, -2.4315e+00,        -inf],
          [-6.6843e-02, -3.6454e+00, -1.4395e-01,  6.3629e-01]],

         [[-2.5391e+00,        -inf,        -inf,        -inf],
          [ 8.7550e-01, -5.1766e-01,        -inf,        -inf],
          [-7.9698e-01, -1.4397e-01,  1.4477e+00,        -inf],
          [-1.5705e+00, -5.1382e-01,  3.0167e+00, -2.1637e+00]],

         [[-1.6945e+00,        -inf,        -inf,        -inf],
          [-8.6582e-01,  2.6532e-01,        -inf,        -inf],
          [-2.9934e+00,  2.0701e-01, -3.0096e+00,        -inf],
          [ 4.9505e-01,  1.3720e+00, -2.4178e+00, -3.9982e+00]],

         [[-2.0464e+00,        -inf,        -inf,        -inf],
          [ 3.2830e-01,  1.3010e+00,        -inf,        -inf],
          [-3.2213e+00, -1.1869e+00, -4.1683e-01,        -inf],
          [ 2.3662e+00,  2.7425e+00,  4.4442e+00,  1.3557e+00]],

         [[ 2.5580e+00,        -inf,        -inf,        -inf],
          [ 3.8822e+00, -1.6516e+00,        -inf,        -inf],
          [ 5.9317e+00,  4.8721e+00, -2.8421e+00,        -inf],
          [ 2.1222e+00,  7.4698e-01, -3.1975e+00,  1.9346e+00]],

         [[ 2.3708e-01,        -inf,        -inf,        -inf],
          [-5.1523e-01,  4.2644e+00,        -inf,        -inf],
          [ 5.1668e-02,  3.3150e+00,  1.8554e+00,        -inf],
          [ 4.4288e+00,  1.4471e+00,  2.0678e+00,  4.1243e+00]],

         [[ 4.3441e+00,        -inf,        -inf,        -inf],
          [ 2.2244e+00,  2.7914e+00,        -inf,        -inf],
          [ 5.2671e-01, -1.7194e+00,  1.3870e-01,        -inf],
          [ 2.6608e+00, -9.6121e-01,  4.8467e-01,  4.9744e-01]],

         [[-1.6418e+00,        -inf,        -inf,        -inf],
          [-3.3238e+00,  1.5498e+00,        -inf,        -inf],
          [ 1.4759e+00,  5.5723e-01, -1.8826e-01,        -inf],
          [-2.6144e+00, -1.6554e+00,  1.6009e+00, -3.9833e+00]],

         [[ 1.4038e+00,        -inf,        -inf,        -inf],
          [ 1.9567e+00, -4.3231e-01,        -inf,        -inf],
          [-3.3259e+00,  3.8945e-01, -6.2395e+00,        -inf],
          [-9.7198e-01,  1.7293e+00,  3.4899e-01,  7.6911e+00]],

         [[ 1.0763e+00,        -inf,        -inf,        -inf],
          [-1.3572e+00, -8.5411e-01,        -inf,        -inf],
          [ 2.6067e-01, -2.0200e+00,  1.9281e+00,        -inf],
          [-9.9233e-01, -7.0288e-01,  6.5733e-01, -6.2304e-01]],

         [[ 2.5020e+00,        -inf,        -inf,        -inf],
          [ 1.4422e+00,  1.6502e+00,        -inf,        -inf],
          [ 2.4073e+00,  1.9231e+00,  9.5667e-01,        -inf],
          [ 4.0151e+00,  4.9361e+00,  2.2443e+00,  1.8801e+00]],

         [[ 1.0125e+00,        -inf,        -inf,        -inf],
          [-1.0133e+00, -3.5021e+00,        -inf,        -inf],
          [ 3.5449e+00,  6.0899e-01,  3.2387e+00,        -inf],
          [ 4.5092e-01,  5.2215e-01,  7.4263e-01, -1.7442e+00]],

         [[-9.9772e-01,        -inf,        -inf,        -inf],
          [-1.7801e+00,  2.2638e-01,        -inf,        -inf],
          [-2.8326e+00, -4.7716e+00, -5.7576e+00,        -inf],
          [-2.6756e+00, -4.2373e+00, -7.4359e-01,  1.2800e+00]],

         [[-2.8082e+00,        -inf,        -inf,        -inf],
          [-6.7560e-01,  3.3145e+00,        -inf,        -inf],
          [ 4.2628e+00,  5.1419e+00,  1.7431e+00,        -inf],
          [ 1.6949e+00,  8.4455e+00,  4.1899e+00,  2.8323e+00]]],


        [[[ 2.9226e-01,        -inf,        -inf,        -inf],
          [ 1.6655e+00,  2.6842e-01,        -inf,        -inf],
          [ 1.9253e+00,  5.6440e+00, -1.8537e+00,        -inf],
          [ 6.7897e+00,  5.3387e+00, -1.2301e+00,  1.5134e+00]],

         [[ 2.2822e+00,        -inf,        -inf,        -inf],
          [ 2.4245e+00, -8.6093e-01,        -inf,        -inf],
          [-5.6447e-01, -5.1549e+00,  2.3699e+00,        -inf],
          [-1.6212e-01, -4.2526e+00, -1.0280e+00,  2.7941e+00]],

         [[ 9.7524e-01,        -inf,        -inf,        -inf],
          [-1.6956e+00,  1.0599e+00,        -inf,        -inf],
          [ 1.4984e-01,  3.2758e-01, -1.6899e+00,        -inf],
          [ 1.7973e+00, -3.4332e-01,  1.8075e+00,  4.8536e+00]],

         [[ 7.7227e-01,        -inf,        -inf,        -inf],
          [ 3.8660e-01, -2.1907e+00,        -inf,        -inf],
          [ 1.1156e+00, -2.4532e+00, -7.2348e-01,        -inf],
          [-5.6498e-01, -6.4159e+00, -3.6580e+00, -5.4699e+00]],

         [[ 4.2448e+00,        -inf,        -inf,        -inf],
          [ 2.5940e+00,  2.8128e+00,        -inf,        -inf],
          [-5.8366e-01, -1.2100e-01,  1.2101e+00,        -inf],
          [-1.4679e-02,  2.4053e+00,  7.1874e+00,  6.0427e+00]],

         [[ 9.0666e-01,        -inf,        -inf,        -inf],
          [ 1.5144e+00,  7.3380e-01,        -inf,        -inf],
          [ 1.8055e+00, -1.1344e-01, -1.6023e+00,        -inf],
          [ 1.2791e+00, -2.7664e+00,  7.6947e-01,  1.9912e+00]],

         [[-2.4755e+00,        -inf,        -inf,        -inf],
          [ 1.4109e+00,  9.2320e-01,        -inf,        -inf],
          [-1.0538e+00,  2.2986e-01, -3.2235e+00,        -inf],
          [ 4.6978e-01,  7.5754e-01,  7.3581e-01,  3.1192e+00]],

         [[ 2.6923e+00,        -inf,        -inf,        -inf],
          [ 5.7153e-01, -4.0227e+00,        -inf,        -inf],
          [ 9.0822e-01, -5.5186e-01, -1.5463e+00,        -inf],
          [-4.1455e+00, -4.2923e+00, -4.2838e+00, -9.0616e-02]],

         [[ 2.7077e+00,        -inf,        -inf,        -inf],
          [ 2.8230e+00,  5.6250e-01,        -inf,        -inf],
          [ 1.4103e+00,  1.4465e-01,  1.9037e+00,        -inf],
          [-3.7283e+00, -8.6518e-01,  8.2110e-01, -1.8470e+00]],

         [[ 2.1776e+00,        -inf,        -inf,        -inf],
          [-8.3356e-02,  2.2232e+00,        -inf,        -inf],
          [ 1.3081e+00,  1.0665e+00,  4.3240e+00,        -inf],
          [-9.8853e-01,  4.1849e-01, -4.4543e+00, -2.0213e+00]],

         [[ 2.0886e+00,        -inf,        -inf,        -inf],
          [-1.1492e+00,  8.8146e-01,        -inf,        -inf],
          [-2.8036e+00, -1.0598e+00, -3.5341e+00,        -inf],
          [-1.5867e+00, -9.9333e-01, -4.3525e+00,  4.6565e-01]],

         [[-2.0993e+00,        -inf,        -inf,        -inf],
          [ 8.1791e-01,  2.0918e+00,        -inf,        -inf],
          [-1.1899e+00,  8.4258e-01,  1.0859e+00,        -inf],
          [ 1.2551e-01,  4.4612e+00, -1.1009e+00, -5.0395e-01]],

         [[-1.9528e+00,        -inf,        -inf,        -inf],
          [ 2.8700e+00,  4.0935e+00,        -inf,        -inf],
          [-4.5544e+00, -7.2672e-01,  5.2485e-01,        -inf],
          [-2.9235e+00,  8.2394e-01,  3.0840e-01, -4.8147e+00]],

         [[-1.8137e+00,        -inf,        -inf,        -inf],
          [ 5.2259e-01,  6.3683e-01,        -inf,        -inf],
          [ 3.5183e-01,  3.3021e+00, -2.5079e+00,        -inf],
          [-5.3062e+00,  3.6732e+00, -3.9768e+00, -8.4337e+00]],

         [[ 2.7243e+00,        -inf,        -inf,        -inf],
          [ 4.2048e+00,  3.4422e+00,        -inf,        -inf],
          [ 1.4007e+00, -9.7204e-01,  1.6834e+00,        -inf],
          [ 6.9902e-01, -4.7272e-01,  2.8668e+00,  4.7006e-01]],

         [[ 4.3296e-01,        -inf,        -inf,        -inf],
          [ 1.9187e+00, -5.3335e-01,        -inf,        -inf],
          [ 1.6515e+00, -1.6139e+00, -2.3688e+00,        -inf],
          [-4.8649e-02,  3.2932e-01,  2.8295e+00, -1.6085e+00]],

         [[-1.0072e+00,        -inf,        -inf,        -inf],
          [-3.1456e+00, -3.9832e+00,        -inf,        -inf],
          [-4.6432e+00, -1.8109e+00,  6.2970e-01,        -inf],
          [ 7.2394e-01, -8.2673e-01,  1.4826e+00, -1.2004e+00]],

         [[ 3.4680e+00,        -inf,        -inf,        -inf],
          [ 7.7315e-01,  3.7096e+00,        -inf,        -inf],
          [ 2.4618e+00,  1.8432e+00,  2.7831e+00,        -inf],
          [-7.6055e-02,  1.3606e-01,  4.3612e-01, -6.3459e-02]],

         [[ 6.0713e-01,        -inf,        -inf,        -inf],
          [ 4.8550e+00,  1.2983e+00,        -inf,        -inf],
          [-9.2427e-01,  1.1592e+00,  1.9613e-01,        -inf],
          [ 1.5764e-01, -4.3553e-01, -1.5819e-01,  1.6198e-01]],

         [[-2.0876e+00,        -inf,        -inf,        -inf],
          [-4.4076e+00, -9.8279e-01,        -inf,        -inf],
          [-4.4952e+00, -2.1484e+00, -4.9607e+00,        -inf],
          [ 1.6566e+00, -2.1613e+00,  2.9824e-02, -8.5615e-01]],

         [[-3.1154e+00,        -inf,        -inf,        -inf],
          [ 8.8341e-03,  1.2070e+00,        -inf,        -inf],
          [ 1.4755e+00,  3.2263e-04,  1.1157e+00,        -inf],
          [ 1.4741e+00, -8.9920e-01,  3.5307e+00,  2.9492e+00]],

         [[-9.4712e-01,        -inf,        -inf,        -inf],
          [ 3.6120e-01, -2.8416e+00,        -inf,        -inf],
          [-2.7044e-01, -1.0980e+00,  8.5092e-01,        -inf],
          [-6.7037e-01,  1.0196e+00,  1.8926e+00,  4.8616e+00]],

         [[-1.1555e+00,        -inf,        -inf,        -inf],
          [-3.2599e+00, -5.6314e+00,        -inf,        -inf],
          [ 2.1181e+00, -2.0888e+00,  1.6657e+00,        -inf],
          [ 2.1373e+00, -1.1326e+00,  1.0828e+00,  1.5076e+00]],

         [[ 2.1122e+00,        -inf,        -inf,        -inf],
          [ 7.5248e-02,  3.9087e-01,        -inf,        -inf],
          [ 2.3716e+00, -8.2451e-01,  1.0924e+00,        -inf],
          [ 1.3553e+00,  2.4810e+00,  1.8469e+00,  1.6197e+00]],

         [[-2.3567e+00,        -inf,        -inf,        -inf],
          [-4.2670e+00,  1.0322e-01,        -inf,        -inf],
          [-5.5338e-01,  4.7589e+00,  1.4919e+00,        -inf],
          [-1.2135e+00,  3.9020e+00, -8.3496e-01,  1.0250e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-4.7408e-02,        -inf,        -inf,        -inf],
          [-6.2335e-01, -3.8186e-02,        -inf,        -inf],
          [ 1.0326e+00, -1.1602e+00,  1.4980e+00,        -inf],
          [-2.1084e+00,  1.8729e+00,  3.3509e+00,  4.5175e-01]],

         [[ 4.7720e+00,        -inf,        -inf,        -inf],
          [ 5.9210e+00,  4.8749e+00,        -inf,        -inf],
          [ 3.1355e+00,  2.5124e+00,  7.4809e-01,        -inf],
          [-2.6857e-01,  3.6161e-01,  3.5238e+00,  3.2777e+00]],

         [[ 2.7424e+00,        -inf,        -inf,        -inf],
          [ 9.6218e-02, -2.1331e+00,        -inf,        -inf],
          [ 9.2602e-01,  7.3201e-01, -1.8977e+00,        -inf],
          [ 2.9870e+00, -2.4734e+00, -4.1371e+00,  4.6542e+00]],

         [[-4.8023e-01,        -inf,        -inf,        -inf],
          [-3.8809e-01, -1.5741e+00,        -inf,        -inf],
          [ 4.3813e+00, -3.6140e-01,  6.3285e-01,        -inf],
          [-2.8254e+00, -2.9638e-01, -4.0748e+00, -5.1185e+00]],

         [[ 4.8049e+00,        -inf,        -inf,        -inf],
          [ 3.7525e+00,  2.1178e+00,        -inf,        -inf],
          [ 4.5374e+00,  2.8778e+00,  3.7844e+00,        -inf],
          [-7.0081e-02, -3.9042e+00,  2.9094e+00, -2.7429e-01]],

         [[ 1.0699e+00,        -inf,        -inf,        -inf],
          [-6.2474e-01, -4.3947e+00,        -inf,        -inf],
          [ 4.7660e-01, -3.6275e+00, -2.8296e+00,        -inf],
          [ 2.5895e-01, -1.6072e+00, -2.6502e+00, -6.7448e-01]],

         [[-3.1056e+00,        -inf,        -inf,        -inf],
          [-3.5657e+00, -3.4931e+00,        -inf,        -inf],
          [-3.7452e+00, -1.6385e+00, -1.8616e+00,        -inf],
          [ 1.8551e+00, -7.7873e-01, -1.4294e+00,  7.4233e-01]],

         [[ 1.9739e+00,        -inf,        -inf,        -inf],
          [ 1.0624e+00, -2.4132e+00,        -inf,        -inf],
          [ 1.0473e+00, -3.4384e+00, -1.5973e+00,        -inf],
          [ 5.3210e-01, -6.2002e+00, -2.6846e-01, -3.5561e+00]],

         [[ 1.5332e+00,        -inf,        -inf,        -inf],
          [ 4.6464e+00,  3.7528e+00,        -inf,        -inf],
          [-2.5925e+00, -9.0590e-01, -9.2287e-01,        -inf],
          [-3.9473e+00, -2.9275e+00,  7.3736e-01,  1.5272e+00]],

         [[ 1.7646e+00,        -inf,        -inf,        -inf],
          [ 3.6016e-01,  8.5578e-01,        -inf,        -inf],
          [ 1.7597e+00,  6.0516e-01,  2.7355e+00,        -inf],
          [ 3.7090e-01,  1.3270e+00,  6.1367e-01,  4.2517e+00]],

         [[ 5.7940e-01,        -inf,        -inf,        -inf],
          [ 1.3150e+00,  4.9224e+00,        -inf,        -inf],
          [ 5.5180e-01,  3.6562e+00,  2.0579e+00,        -inf],
          [-2.1126e-01,  2.4654e+00,  7.3647e+00,  2.0625e+00]],

         [[ 1.0654e+00,        -inf,        -inf,        -inf],
          [-6.8229e-01, -5.7244e+00,        -inf,        -inf],
          [ 1.8000e+00, -8.6721e+00, -2.4315e+00,        -inf],
          [-6.6843e-02, -3.6454e+00, -1.4395e-01,  6.3629e-01]],

         [[-2.5391e+00,        -inf,        -inf,        -inf],
          [ 8.7550e-01, -5.1766e-01,        -inf,        -inf],
          [-7.9698e-01, -1.4397e-01,  1.4477e+00,        -inf],
          [-1.5705e+00, -5.1382e-01,  3.0167e+00, -2.1637e+00]],

         [[-1.6945e+00,        -inf,        -inf,        -inf],
          [-8.6582e-01,  2.6532e-01,        -inf,        -inf],
          [-2.9934e+00,  2.0701e-01, -3.0096e+00,        -inf],
          [ 4.9505e-01,  1.3720e+00, -2.4178e+00, -3.9982e+00]],

         [[-2.0464e+00,        -inf,        -inf,        -inf],
          [ 3.2830e-01,  1.3010e+00,        -inf,        -inf],
          [-3.2213e+00, -1.1869e+00, -4.1683e-01,        -inf],
          [ 2.3662e+00,  2.7425e+00,  4.4442e+00,  1.3557e+00]],

         [[ 2.5580e+00,        -inf,        -inf,        -inf],
          [ 3.8822e+00, -1.6516e+00,        -inf,        -inf],
          [ 5.9317e+00,  4.8721e+00, -2.8421e+00,        -inf],
          [ 2.1222e+00,  7.4698e-01, -3.1975e+00,  1.9346e+00]],

         [[ 2.3708e-01,        -inf,        -inf,        -inf],
          [-5.1523e-01,  4.2644e+00,        -inf,        -inf],
          [ 5.1668e-02,  3.3150e+00,  1.8554e+00,        -inf],
          [ 4.4288e+00,  1.4471e+00,  2.0678e+00,  4.1243e+00]],

         [[ 4.3441e+00,        -inf,        -inf,        -inf],
          [ 2.2244e+00,  2.7914e+00,        -inf,        -inf],
          [ 5.2671e-01, -1.7194e+00,  1.3870e-01,        -inf],
          [ 2.6608e+00, -9.6121e-01,  4.8467e-01,  4.9744e-01]],

         [[-1.6418e+00,        -inf,        -inf,        -inf],
          [-3.3238e+00,  1.5498e+00,        -inf,        -inf],
          [ 1.4759e+00,  5.5723e-01, -1.8826e-01,        -inf],
          [-2.6144e+00, -1.6554e+00,  1.6009e+00, -3.9833e+00]],

         [[ 1.4038e+00,        -inf,        -inf,        -inf],
          [ 1.9567e+00, -4.3231e-01,        -inf,        -inf],
          [-3.3259e+00,  3.8945e-01, -6.2395e+00,        -inf],
          [-9.7198e-01,  1.7293e+00,  3.4899e-01,  7.6911e+00]],

         [[ 1.0763e+00,        -inf,        -inf,        -inf],
          [-1.3572e+00, -8.5411e-01,        -inf,        -inf],
          [ 2.6067e-01, -2.0200e+00,  1.9281e+00,        -inf],
          [-9.9233e-01, -7.0288e-01,  6.5733e-01, -6.2304e-01]],

         [[ 2.5020e+00,        -inf,        -inf,        -inf],
          [ 1.4422e+00,  1.6502e+00,        -inf,        -inf],
          [ 2.4073e+00,  1.9231e+00,  9.5667e-01,        -inf],
          [ 4.0151e+00,  4.9361e+00,  2.2443e+00,  1.8801e+00]],

         [[ 1.0125e+00,        -inf,        -inf,        -inf],
          [-1.0133e+00, -3.5021e+00,        -inf,        -inf],
          [ 3.5449e+00,  6.0899e-01,  3.2387e+00,        -inf],
          [ 4.5092e-01,  5.2215e-01,  7.4263e-01, -1.7442e+00]],

         [[-9.9772e-01,        -inf,        -inf,        -inf],
          [-1.7801e+00,  2.2638e-01,        -inf,        -inf],
          [-2.8326e+00, -4.7716e+00, -5.7576e+00,        -inf],
          [-2.6756e+00, -4.2373e+00, -7.4359e-01,  1.2800e+00]],

         [[-2.8082e+00,        -inf,        -inf,        -inf],
          [-6.7560e-01,  3.3145e+00,        -inf,        -inf],
          [ 4.2628e+00,  5.1419e+00,  1.7431e+00,        -inf],
          [ 1.6949e+00,  8.4455e+00,  4.1899e+00,  2.8323e+00]]],


        [[[ 2.9226e-01,        -inf,        -inf,        -inf],
          [ 1.6655e+00,  2.6842e-01,        -inf,        -inf],
          [ 1.9253e+00,  5.6440e+00, -1.8537e+00,        -inf],
          [ 6.7897e+00,  5.3387e+00, -1.2301e+00,  1.5134e+00]],

         [[ 2.2822e+00,        -inf,        -inf,        -inf],
          [ 2.4245e+00, -8.6093e-01,        -inf,        -inf],
          [-5.6447e-01, -5.1549e+00,  2.3699e+00,        -inf],
          [-1.6212e-01, -4.2526e+00, -1.0280e+00,  2.7941e+00]],

         [[ 9.7524e-01,        -inf,        -inf,        -inf],
          [-1.6956e+00,  1.0599e+00,        -inf,        -inf],
          [ 1.4984e-01,  3.2758e-01, -1.6899e+00,        -inf],
          [ 1.7973e+00, -3.4332e-01,  1.8075e+00,  4.8536e+00]],

         [[ 7.7227e-01,        -inf,        -inf,        -inf],
          [ 3.8660e-01, -2.1907e+00,        -inf,        -inf],
          [ 1.1156e+00, -2.4532e+00, -7.2348e-01,        -inf],
          [-5.6498e-01, -6.4159e+00, -3.6580e+00, -5.4699e+00]],

         [[ 4.2448e+00,        -inf,        -inf,        -inf],
          [ 2.5940e+00,  2.8128e+00,        -inf,        -inf],
          [-5.8366e-01, -1.2100e-01,  1.2101e+00,        -inf],
          [-1.4679e-02,  2.4053e+00,  7.1874e+00,  6.0427e+00]],

         [[ 9.0666e-01,        -inf,        -inf,        -inf],
          [ 1.5144e+00,  7.3380e-01,        -inf,        -inf],
          [ 1.8055e+00, -1.1344e-01, -1.6023e+00,        -inf],
          [ 1.2791e+00, -2.7664e+00,  7.6947e-01,  1.9912e+00]],

         [[-2.4755e+00,        -inf,        -inf,        -inf],
          [ 1.4109e+00,  9.2320e-01,        -inf,        -inf],
          [-1.0538e+00,  2.2986e-01, -3.2235e+00,        -inf],
          [ 4.6978e-01,  7.5754e-01,  7.3581e-01,  3.1192e+00]],

         [[ 2.6923e+00,        -inf,        -inf,        -inf],
          [ 5.7153e-01, -4.0227e+00,        -inf,        -inf],
          [ 9.0822e-01, -5.5186e-01, -1.5463e+00,        -inf],
          [-4.1455e+00, -4.2923e+00, -4.2838e+00, -9.0616e-02]],

         [[ 2.7077e+00,        -inf,        -inf,        -inf],
          [ 2.8230e+00,  5.6250e-01,        -inf,        -inf],
          [ 1.4103e+00,  1.4465e-01,  1.9037e+00,        -inf],
          [-3.7283e+00, -8.6518e-01,  8.2110e-01, -1.8470e+00]],

         [[ 2.1776e+00,        -inf,        -inf,        -inf],
          [-8.3356e-02,  2.2232e+00,        -inf,        -inf],
          [ 1.3081e+00,  1.0665e+00,  4.3240e+00,        -inf],
          [-9.8853e-01,  4.1849e-01, -4.4543e+00, -2.0213e+00]],

         [[ 2.0886e+00,        -inf,        -inf,        -inf],
          [-1.1492e+00,  8.8146e-01,        -inf,        -inf],
          [-2.8036e+00, -1.0598e+00, -3.5341e+00,        -inf],
          [-1.5867e+00, -9.9333e-01, -4.3525e+00,  4.6565e-01]],

         [[-2.0993e+00,        -inf,        -inf,        -inf],
          [ 8.1791e-01,  2.0918e+00,        -inf,        -inf],
          [-1.1899e+00,  8.4258e-01,  1.0859e+00,        -inf],
          [ 1.2551e-01,  4.4612e+00, -1.1009e+00, -5.0395e-01]],

         [[-1.9528e+00,        -inf,        -inf,        -inf],
          [ 2.8700e+00,  4.0935e+00,        -inf,        -inf],
          [-4.5544e+00, -7.2672e-01,  5.2485e-01,        -inf],
          [-2.9235e+00,  8.2394e-01,  3.0840e-01, -4.8147e+00]],

         [[-1.8137e+00,        -inf,        -inf,        -inf],
          [ 5.2259e-01,  6.3683e-01,        -inf,        -inf],
          [ 3.5183e-01,  3.3021e+00, -2.5079e+00,        -inf],
          [-5.3062e+00,  3.6732e+00, -3.9768e+00, -8.4337e+00]],

         [[ 2.7243e+00,        -inf,        -inf,        -inf],
          [ 4.2048e+00,  3.4422e+00,        -inf,        -inf],
          [ 1.4007e+00, -9.7204e-01,  1.6834e+00,        -inf],
          [ 6.9902e-01, -4.7272e-01,  2.8668e+00,  4.7006e-01]],

         [[ 4.3296e-01,        -inf,        -inf,        -inf],
          [ 1.9187e+00, -5.3335e-01,        -inf,        -inf],
          [ 1.6515e+00, -1.6139e+00, -2.3688e+00,        -inf],
          [-4.8649e-02,  3.2932e-01,  2.8295e+00, -1.6085e+00]],

         [[-1.0072e+00,        -inf,        -inf,        -inf],
          [-3.1456e+00, -3.9832e+00,        -inf,        -inf],
          [-4.6432e+00, -1.8109e+00,  6.2970e-01,        -inf],
          [ 7.2394e-01, -8.2673e-01,  1.4826e+00, -1.2004e+00]],

         [[ 3.4680e+00,        -inf,        -inf,        -inf],
          [ 7.7315e-01,  3.7096e+00,        -inf,        -inf],
          [ 2.4618e+00,  1.8432e+00,  2.7831e+00,        -inf],
          [-7.6055e-02,  1.3606e-01,  4.3612e-01, -6.3459e-02]],

         [[ 6.0713e-01,        -inf,        -inf,        -inf],
          [ 4.8550e+00,  1.2983e+00,        -inf,        -inf],
          [-9.2427e-01,  1.1592e+00,  1.9613e-01,        -inf],
          [ 1.5764e-01, -4.3553e-01, -1.5819e-01,  1.6198e-01]],

         [[-2.0876e+00,        -inf,        -inf,        -inf],
          [-4.4076e+00, -9.8279e-01,        -inf,        -inf],
          [-4.4952e+00, -2.1484e+00, -4.9607e+00,        -inf],
          [ 1.6566e+00, -2.1613e+00,  2.9824e-02, -8.5615e-01]],

         [[-3.1154e+00,        -inf,        -inf,        -inf],
          [ 8.8341e-03,  1.2070e+00,        -inf,        -inf],
          [ 1.4755e+00,  3.2263e-04,  1.1157e+00,        -inf],
          [ 1.4741e+00, -8.9920e-01,  3.5307e+00,  2.9492e+00]],

         [[-9.4712e-01,        -inf,        -inf,        -inf],
          [ 3.6120e-01, -2.8416e+00,        -inf,        -inf],
          [-2.7044e-01, -1.0980e+00,  8.5092e-01,        -inf],
          [-6.7037e-01,  1.0196e+00,  1.8926e+00,  4.8616e+00]],

         [[-1.1555e+00,        -inf,        -inf,        -inf],
          [-3.2599e+00, -5.6314e+00,        -inf,        -inf],
          [ 2.1181e+00, -2.0888e+00,  1.6657e+00,        -inf],
          [ 2.1373e+00, -1.1326e+00,  1.0828e+00,  1.5076e+00]],

         [[ 2.1122e+00,        -inf,        -inf,        -inf],
          [ 7.5248e-02,  3.9087e-01,        -inf,        -inf],
          [ 2.3716e+00, -8.2451e-01,  1.0924e+00,        -inf],
          [ 1.3553e+00,  2.4810e+00,  1.8469e+00,  1.6197e+00]],

         [[-2.3567e+00,        -inf,        -inf,        -inf],
          [-4.2670e+00,  1.0322e-01,        -inf,        -inf],
          [-5.5338e-01,  4.7589e+00,  1.4919e+00,        -inf],
          [-1.2135e+00,  3.9020e+00, -8.3496e-01,  1.0250e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-7.8411e-02,  2.5417e-01,  1.1717e+00,  ...,  4.6251e-01,
           -5.1314e-01, -4.2900e-01],
          [ 9.2367e-01, -5.6040e-01, -2.9411e-01,  ..., -2.0522e-01,
           -4.4418e-01,  7.8929e-01],
          [ 1.0058e+00,  1.1827e+00, -7.7650e-01,  ..., -1.1358e+00,
            2.0909e-01, -4.3599e-02],
          ...,
          [-3.5151e-01,  2.5174e-01,  4.4114e-01,  ...,  1.3895e-04,
            6.0297e-01, -1.5938e+00],
          [-2.5845e-01,  4.4256e-01, -3.1153e-01,  ...,  1.3322e+00,
            4.0212e-01, -2.2557e-01],
          [-1.9198e+00, -4.3027e-01,  7.6326e-01,  ...,  1.6249e+00,
            2.6076e-01, -3.6334e-01]],

         [[ 4.7679e-01,  9.8059e-02,  7.5926e-02,  ...,  2.3599e-01,
           -2.0965e-01, -3.5031e-01],
          [ 5.9779e-01, -1.8815e-01, -2.2171e-01,  ..., -1.5414e-01,
           -3.2788e-01,  8.0078e-01],
          [ 4.3792e-03,  6.3206e-02,  2.1942e-02,  ..., -6.4167e-02,
            3.5758e-01,  6.7683e-02],
          ...,
          [-6.6936e-01,  2.6951e-01,  4.3339e-01,  ...,  1.5466e-01,
            4.4172e-01, -1.1911e+00],
          [-5.7284e-01,  5.0285e-01, -7.1742e-01,  ...,  6.3084e-01,
            3.3814e-01, -8.1004e-02],
          [-1.1729e+00,  1.1851e-01,  1.5794e-02,  ...,  9.8112e-01,
            4.0734e-01, -9.5858e-01]],

         [[ 5.9727e-01, -1.5762e-01,  1.2610e-01,  ...,  4.2397e-01,
           -7.3337e-01,  4.0218e-02],
          [ 4.4090e-01, -1.6694e-03,  1.1792e-01,  ..., -1.1296e-01,
           -3.6002e-01,  6.4778e-01],
          [ 2.7638e-01,  2.6957e-01, -4.7125e-01,  ..., -6.5990e-01,
            5.4229e-01,  1.1456e-01],
          ...,
          [-7.5372e-01, -6.1251e-02,  5.1272e-01,  ..., -9.8285e-02,
            3.9757e-01, -1.0383e+00],
          [-5.3057e-01,  3.6143e-01, -6.9757e-01,  ...,  8.1211e-01,
            1.8538e-01,  1.8786e-01],
          [-1.3582e+00,  1.7780e-01,  1.8892e-01,  ...,  9.1786e-01,
            1.9368e-01, -6.3249e-01]],

         [[ 7.0505e-01, -1.0263e-01, -3.4479e-01,  ...,  4.4678e-01,
           -6.0434e-01,  1.4310e-02],
          [ 2.2275e-01, -5.8126e-02, -8.4769e-02,  ..., -5.8902e-02,
           -1.2495e-01,  3.1830e-01],
          [ 3.5752e-01,  2.6033e-01, -3.3860e-01,  ..., -2.2150e-01,
            1.4319e-01,  3.3343e-02],
          ...,
          [-8.0877e-01, -1.4075e-01,  2.6290e-01,  ..., -3.0983e-01,
            6.3809e-01, -1.0681e+00],
          [-5.4327e-01,  7.3275e-01, -7.6234e-01,  ...,  9.9986e-01,
            3.9587e-01,  2.9342e-01],
          [-1.0964e+00,  1.9043e-01,  7.1031e-02,  ...,  5.5330e-01,
            6.0452e-02, -7.2738e-01]]],


        [[[ 2.8683e-01, -1.1127e-01,  1.2155e+00,  ...,  5.6400e-01,
           -9.2892e-01, -4.2561e-02],
          [ 8.2846e-01, -6.2759e-01,  3.7784e-01,  ..., -8.1035e-01,
            6.3740e-02,  1.0326e+00],
          [ 4.8527e-01,  1.3050e+00, -1.0549e+00,  ..., -8.9620e-01,
            3.8169e-01,  1.9067e-01],
          ...,
          [-5.4215e-01, -8.4936e-02,  4.4103e-01,  ...,  5.2950e-02,
           -3.0069e-02, -1.1025e+00],
          [-5.9397e-01, -2.9091e-02, -2.1960e-01,  ...,  1.0271e+00,
            3.8191e-01, -3.2303e-01],
          [-2.2115e+00, -8.7102e-01,  1.5011e-01,  ...,  1.8910e+00,
            4.1891e-01, -2.2066e-01]],

         [[ 2.9436e-01, -2.5557e-01,  8.9248e-01,  ...,  3.9550e-01,
           -7.2710e-01, -1.7458e-01],
          [ 4.8743e-01, -6.3659e-01,  4.5859e-01,  ..., -3.1493e-01,
           -2.7285e-01,  7.5877e-01],
          [ 3.4085e-01,  4.6164e-01, -5.1857e-01,  ..., -3.3760e-01,
            4.9512e-01,  6.5062e-01],
          ...,
          [-4.7170e-01,  2.2539e-03,  1.0133e-01,  ..., -1.1121e-01,
            3.4588e-01, -9.5263e-01],
          [-8.2704e-01, -1.7887e-01,  1.5653e-01,  ...,  1.0140e+00,
            4.9271e-01, -4.9490e-01],
          [-1.7968e+00, -7.7927e-01,  3.5748e-01,  ...,  1.3943e+00,
            2.7683e-01, -4.8985e-01]],

         [[ 2.0572e-01, -4.0341e-01,  7.1000e-01,  ...,  2.6419e-01,
           -6.4264e-01, -7.1238e-02],
          [-2.8671e-01,  2.5552e-01,  3.1385e-01,  ...,  3.2099e-01,
           -2.9636e-01,  2.7287e-02],
          [ 3.4418e-01,  6.2985e-01, -5.8914e-01,  ..., -3.7185e-01,
            3.2431e-01,  5.2083e-01],
          ...,
          [-3.9450e-02, -2.7661e-02,  3.6874e-01,  ..., -1.0099e-01,
            1.8333e-01, -8.2312e-01],
          [-8.4265e-01, -9.6787e-02,  1.4410e-01,  ...,  9.7478e-01,
            8.4509e-01, -4.4735e-01],
          [-1.4403e+00, -7.7574e-01,  3.7809e-01,  ...,  9.5531e-01,
            6.0567e-02, -3.5162e-01]],

         [[ 6.9651e-02, -2.4061e-01,  2.1191e-01,  ...,  5.4447e-02,
           -2.2787e-01, -2.7843e-02],
          [ 7.2445e-02, -7.9099e-02,  2.8126e-01,  ..., -2.5983e-02,
           -1.7366e-01,  2.9660e-01],
          [ 3.9827e-01,  4.0452e-01, -5.7208e-01,  ..., -2.0855e-01,
            4.2970e-01,  6.3964e-01],
          ...,
          [-2.8269e-01, -1.5768e-02,  2.0448e-01,  ..., -4.7726e-01,
            3.4502e-01, -8.2725e-01],
          [-7.8775e-01,  1.0774e-01,  6.0184e-02,  ...,  8.9932e-01,
            7.5063e-01, -4.3137e-01],
          [-1.2358e+00, -7.0366e-01,  2.6186e-01,  ...,  8.8969e-01,
           -9.5433e-02, -2.9267e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.0784,  0.2542,  1.1717,  ...,  1.6249,  0.2608, -0.3633],
         [ 0.4768,  0.0981,  0.0759,  ...,  0.9811,  0.4073, -0.9586],
         [ 0.5973, -0.1576,  0.1261,  ...,  0.9179,  0.1937, -0.6325],
         [ 0.7051, -0.1026, -0.3448,  ...,  0.5533,  0.0605, -0.7274]],

        [[ 0.2868, -0.1113,  1.2155,  ...,  1.8910,  0.4189, -0.2207],
         [ 0.2944, -0.2556,  0.8925,  ...,  1.3943,  0.2768, -0.4898],
         [ 0.2057, -0.4034,  0.7100,  ...,  0.9553,  0.0606, -0.3516],
         [ 0.0697, -0.2406,  0.2119,  ...,  0.8897, -0.0954, -0.2927]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0644, -0.3165, -0.3631,  ..., -0.4096,  0.6401, -0.2732],
         [-0.2209, -0.2767, -0.1684,  ..., -0.6381,  0.3314,  0.0074],
         [-0.0917, -0.3701, -0.1495,  ..., -0.3822,  0.1408,  0.0341],
         [-0.1820, -0.3455, -0.1674,  ..., -0.3459,  0.1283,  0.1342]],

        [[-0.2119, -0.3028, -0.0973,  ..., -0.3546,  0.7717, -0.1563],
         [-0.3354, -0.4571, -0.2737,  ..., -0.5317,  0.4566, -0.0963],
         [-0.3155, -0.3504, -0.2475,  ..., -0.2956,  0.2119, -0.1700],
         [-0.2491, -0.3370, -0.2620,  ..., -0.4786,  0.1021, -0.1237]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.7777e+00,        -inf,        -inf,        -inf],
          [ 1.6521e-02, -1.3078e-01,        -inf,        -inf],
          [ 2.2249e+00,  4.2388e+00,  4.3555e+00,        -inf],
          [ 1.3270e+00,  1.4729e+00,  2.9739e+00,  1.1137e+00]],

         [[-4.5090e+00,        -inf,        -inf,        -inf],
          [-4.0194e+00, -2.1984e+00,        -inf,        -inf],
          [-3.4353e+00, -1.3858e+00, -5.9428e-01,        -inf],
          [-4.8722e+00, -4.7810e+00, -1.7127e+00, -2.8359e+00]],

         [[ 1.1425e+00,        -inf,        -inf,        -inf],
          [ 2.8828e+00,  1.9209e-01,        -inf,        -inf],
          [ 5.0722e+00,  3.5767e-01,  1.8960e+00,        -inf],
          [ 1.0817e+00,  1.0300e+00,  1.0873e+00,  4.7368e-01]],

         [[-6.1317e+00,        -inf,        -inf,        -inf],
          [-5.1851e-01, -1.5975e+00,        -inf,        -inf],
          [-4.8772e-02, -1.1340e+00, -2.6258e+00,        -inf],
          [-8.7401e-01, -1.4473e+00,  1.0523e+00,  1.3592e+00]],

         [[-1.5957e+00,        -inf,        -inf,        -inf],
          [-5.1313e-01,  2.5307e+00,        -inf,        -inf],
          [ 1.3202e+00,  3.3503e+00, -5.1276e+00,        -inf],
          [-1.6657e+00, -1.9960e+00, -8.7432e-01, -5.7834e-01]],

         [[ 1.6921e+00,        -inf,        -inf,        -inf],
          [-2.5316e+00, -1.2673e+00,        -inf,        -inf],
          [-2.1265e+00, -2.5066e+00, -1.6363e+00,        -inf],
          [ 8.6645e-01, -2.9035e-01, -9.6839e-01, -1.4712e+00]],

         [[-6.5297e-01,        -inf,        -inf,        -inf],
          [-2.9390e+00, -2.2922e+00,        -inf,        -inf],
          [-6.6533e-01,  4.9191e+00, -1.5430e+00,        -inf],
          [-2.9952e+00,  1.1065e+00, -5.0902e+00, -1.0595e+00]],

         [[ 1.4021e+00,        -inf,        -inf,        -inf],
          [ 1.0184e+00, -2.1699e+00,        -inf,        -inf],
          [-3.0018e+00,  1.2882e-01,  1.2691e+00,        -inf],
          [-3.5488e+00, -1.9681e+00, -1.1187e+00, -1.7719e+00]],

         [[-3.8656e+00,        -inf,        -inf,        -inf],
          [-6.3304e+00, -4.4917e+00,        -inf,        -inf],
          [-2.2563e+00,  4.4298e-01,  3.8144e+00,        -inf],
          [-1.7913e+00, -3.2139e+00,  1.5845e+00,  6.2582e-01]],

         [[ 7.7237e-01,        -inf,        -inf,        -inf],
          [-1.2198e+00, -2.5799e+00,        -inf,        -inf],
          [-5.4583e-01,  4.0831e-01, -2.5303e+00,        -inf],
          [ 7.1600e-01,  3.7371e-01, -1.1609e+00,  2.3382e+00]],

         [[-2.1425e+00,        -inf,        -inf,        -inf],
          [-2.9307e+00, -1.3931e-01,        -inf,        -inf],
          [-2.3193e+00, -6.1428e-01,  1.0124e+00,        -inf],
          [ 3.5559e+00, -1.5871e+00,  6.4256e+00,  3.3029e+00]],

         [[ 5.5720e-02,        -inf,        -inf,        -inf],
          [ 6.4262e+00, -1.9298e+00,        -inf,        -inf],
          [ 4.1537e+00,  2.4739e+00,  1.0559e+00,        -inf],
          [ 3.8845e+00,  3.3442e-01,  6.1332e-01,  1.6205e+00]],

         [[ 1.4096e+00,        -inf,        -inf,        -inf],
          [ 3.4435e+00, -6.2265e-02,        -inf,        -inf],
          [ 4.7926e-01, -1.1659e+00, -1.6734e-01,        -inf],
          [ 2.3003e-01, -2.2616e+00, -3.3012e-02,  6.3635e-01]],

         [[-2.2029e-01,        -inf,        -inf,        -inf],
          [-2.7899e+00,  4.4909e+00,        -inf,        -inf],
          [ 4.8769e-01, -9.3316e-01,  4.8214e-01,        -inf],
          [ 4.4058e+00,  3.1095e+00,  2.2633e+00,  2.1706e+00]],

         [[ 4.6918e-01,        -inf,        -inf,        -inf],
          [-2.1106e+00,  3.6447e-01,        -inf,        -inf],
          [-2.9138e+00, -3.8792e+00, -2.9226e+00,        -inf],
          [-7.5455e-01, -2.4701e+00,  1.0166e+00, -2.7385e-01]],

         [[ 2.8115e+00,        -inf,        -inf,        -inf],
          [ 2.2132e+00, -4.5786e-01,        -inf,        -inf],
          [ 6.3442e+00,  3.6733e+00, -1.2450e-01,        -inf],
          [-7.7441e-01, -2.3730e+00, -9.7376e-01,  1.9774e+00]],

         [[ 9.0616e-02,        -inf,        -inf,        -inf],
          [ 8.7828e-02, -8.8648e-01,        -inf,        -inf],
          [-1.6099e+00,  7.4399e-01,  3.8757e+00,        -inf],
          [-3.7020e+00, -3.3360e+00,  3.8934e-01, -5.2019e+00]],

         [[-4.5704e+00,        -inf,        -inf,        -inf],
          [ 5.9970e-01, -1.9984e+00,        -inf,        -inf],
          [ 1.5246e+00, -1.1266e+00, -2.1665e+00,        -inf],
          [ 5.1961e-01, -1.1577e+00, -3.8589e+00, -3.2531e+00]],

         [[-3.1402e-01,        -inf,        -inf,        -inf],
          [ 3.9161e+00,  3.0508e+00,        -inf,        -inf],
          [-4.3665e+00, -2.8448e+00, -6.4925e-02,        -inf],
          [ 5.4917e-01, -4.4797e-01,  4.6233e+00,  1.3714e+00]],

         [[-2.6538e-01,        -inf,        -inf,        -inf],
          [-1.7532e+00,  3.9319e-02,        -inf,        -inf],
          [-1.9838e+00, -3.7349e+00,  2.4581e+00,        -inf],
          [-3.6768e+00, -1.8972e+00,  1.5613e+00, -1.7228e+00]],

         [[ 2.1618e+00,        -inf,        -inf,        -inf],
          [-5.9472e-01,  1.6309e+00,        -inf,        -inf],
          [-6.3711e-01, -4.0991e+00, -3.5534e+00,        -inf],
          [-3.7411e+00, -9.8030e-01, -1.2896e+00, -2.0296e+00]],

         [[-4.1500e-01,        -inf,        -inf,        -inf],
          [ 1.9525e-01, -3.9629e-01,        -inf,        -inf],
          [ 2.5452e+00, -3.3275e+00,  1.5939e+00,        -inf],
          [-3.1176e+00, -2.7382e+00,  2.8426e+00,  2.6991e+00]],

         [[ 1.0731e+00,        -inf,        -inf,        -inf],
          [ 1.9757e-01, -3.8222e-01,        -inf,        -inf],
          [-2.9588e+00,  4.0135e-01,  4.6761e-01,        -inf],
          [-4.3955e+00, -1.5276e+00, -3.6257e-01, -8.6902e-01]],

         [[-3.5555e+00,        -inf,        -inf,        -inf],
          [-1.1645e+00, -4.6076e+00,        -inf,        -inf],
          [-4.7000e+00, -5.1678e+00, -2.8722e+00,        -inf],
          [ 3.3804e-01, -2.6881e+00, -5.1057e+00,  1.9267e+00]],

         [[ 5.8833e+00,        -inf,        -inf,        -inf],
          [-1.5204e+00,  1.6004e+00,        -inf,        -inf],
          [ 2.5029e+00,  5.5922e+00,  7.9187e+00,        -inf],
          [ 1.7836e+00, -1.2616e+00,  2.7327e+00,  1.1170e+00]]],


        [[[-3.2120e-02,        -inf,        -inf,        -inf],
          [-1.1277e+00, -1.1109e+00,        -inf,        -inf],
          [ 4.7150e-01, -3.4172e-01, -1.2318e-01,        -inf],
          [-4.4887e+00,  2.9028e-01, -1.5938e+00, -7.1844e+00]],

         [[-7.7464e+00,        -inf,        -inf,        -inf],
          [-2.8939e+00, -2.0810e+00,        -inf,        -inf],
          [-1.0926e+00,  1.4067e+00, -1.7300e+00,        -inf],
          [-1.8520e+00, -1.7447e+00, -3.4390e+00,  1.1514e+00]],

         [[-1.6286e+00,        -inf,        -inf,        -inf],
          [ 3.0401e+00,  2.9634e+00,        -inf,        -inf],
          [-4.0331e-01, -1.6194e+00, -2.1313e+00,        -inf],
          [-1.1184e+00,  3.9227e+00, -3.1395e+00,  2.7893e-01]],

         [[ 2.0781e-01,        -inf,        -inf,        -inf],
          [-1.6459e+00,  1.0977e+00,        -inf,        -inf],
          [ 2.0948e+00, -5.8003e-01,  1.2999e+00,        -inf],
          [ 1.7378e-02,  1.4108e+00, -4.7309e-01,  2.2258e+00]],

         [[-3.6233e-01,        -inf,        -inf,        -inf],
          [ 1.0172e+00,  4.2114e+00,        -inf,        -inf],
          [ 2.6134e+00, -1.0065e+00,  1.5214e+00,        -inf],
          [-2.4946e+00, -4.3302e+00, -1.5967e+00, -2.3025e+00]],

         [[ 6.0170e+00,        -inf,        -inf,        -inf],
          [ 7.4154e+00,  1.7850e+00,        -inf,        -inf],
          [ 8.9061e-01, -5.7672e-02, -2.8349e+00,        -inf],
          [ 2.3206e+00, -1.2252e-01, -3.1362e+00, -3.9432e+00]],

         [[ 2.5481e+00,        -inf,        -inf,        -inf],
          [ 4.6856e-01, -1.2469e+00,        -inf,        -inf],
          [ 4.2638e-01, -2.2795e+00,  1.0053e+00,        -inf],
          [-1.3494e+00, -5.3616e+00, -2.7061e-01,  8.2239e-01]],

         [[ 1.7378e+00,        -inf,        -inf,        -inf],
          [ 3.1479e+00,  7.7354e-01,        -inf,        -inf],
          [ 4.6441e+00,  4.1372e+00,  7.8771e-01,        -inf],
          [ 5.2597e+00, -1.6669e+00, -7.0871e-01,  7.3048e-01]],

         [[-1.7917e+00,        -inf,        -inf,        -inf],
          [-4.2111e-01, -2.5094e+00,        -inf,        -inf],
          [-1.5569e+00, -1.5737e+00, -6.0943e-01,        -inf],
          [-1.0530e+00, -3.4352e+00, -3.9829e+00, -2.0041e+00]],

         [[ 9.0083e-02,        -inf,        -inf,        -inf],
          [ 4.2805e+00, -3.2898e+00,        -inf,        -inf],
          [ 2.3306e+00, -6.7420e-01, -8.7515e-01,        -inf],
          [-2.4048e+00, -6.5998e+00,  3.0767e-01,  1.1404e+00]],

         [[ 1.4385e+00,        -inf,        -inf,        -inf],
          [-1.4740e+00, -6.8670e-01,        -inf,        -inf],
          [ 4.1636e-01, -9.1691e-01, -2.6747e+00,        -inf],
          [-1.8378e+00,  2.6667e+00,  2.2624e+00, -1.3623e+00]],

         [[ 1.4830e+00,        -inf,        -inf,        -inf],
          [ 4.4163e+00, -1.0894e+00,        -inf,        -inf],
          [ 3.0756e+00,  8.1288e-01,  2.7131e+00,        -inf],
          [-1.1162e+00, -6.3138e-02, -1.7473e+00, -1.2897e+00]],

         [[-2.3314e+00,        -inf,        -inf,        -inf],
          [-3.0087e+00, -5.3407e+00,        -inf,        -inf],
          [-3.3836e+00, -2.9610e+00, -6.3116e-01,        -inf],
          [-5.7569e-02, -3.1476e+00, -4.4162e+00, -6.0168e+00]],

         [[-8.5650e-01,        -inf,        -inf,        -inf],
          [ 2.5926e-01,  3.5255e+00,        -inf,        -inf],
          [-2.9752e-01,  1.2026e+00,  4.2872e-01,        -inf],
          [ 1.4500e+00,  1.9811e+00,  5.9392e-02,  3.1145e+00]],

         [[ 3.1653e+00,        -inf,        -inf,        -inf],
          [ 6.6550e-02, -1.2807e+00,        -inf,        -inf],
          [ 3.1465e-01, -4.0948e+00, -3.1287e+00,        -inf],
          [ 8.9257e-01, -8.6372e+00, -1.4820e+00, -9.2939e-02]],

         [[ 2.9080e+00,        -inf,        -inf,        -inf],
          [ 1.3626e+00, -8.3856e-01,        -inf,        -inf],
          [ 2.1813e+00,  6.0628e-01, -2.9845e+00,        -inf],
          [-5.1266e+00, -7.0400e+00, -2.2434e+00, -1.0515e+00]],

         [[-2.2221e+00,        -inf,        -inf,        -inf],
          [-3.3012e+00, -2.1996e+00,        -inf,        -inf],
          [ 9.5798e-01,  2.5092e+00,  2.0642e+00,        -inf],
          [-1.4396e+00, -4.0535e+00, -9.2192e-01, -4.8762e-01]],

         [[-1.1146e+00,        -inf,        -inf,        -inf],
          [-1.3788e-01, -1.6310e+00,        -inf,        -inf],
          [-2.9546e+00, -4.0126e+00, -1.5884e+00,        -inf],
          [ 1.2924e+00,  6.8856e-01,  6.5815e-01,  2.2099e+00]],

         [[-2.1362e+00,        -inf,        -inf,        -inf],
          [ 5.5370e-01, -5.8989e-01,        -inf,        -inf],
          [-4.0006e-01, -7.0974e+00, -3.0621e+00,        -inf],
          [ 6.4923e-01, -2.6818e-01,  6.3955e+00, -4.8732e-02]],

         [[ 2.2435e+00,        -inf,        -inf,        -inf],
          [-6.7458e-03,  1.7549e+00,        -inf,        -inf],
          [-4.6828e-01, -3.0653e+00, -6.4087e-01,        -inf],
          [-3.5961e+00, -7.1263e-01, -4.2029e+00, -3.0258e+00]],

         [[-3.1112e+00,        -inf,        -inf,        -inf],
          [ 1.0253e+00,  4.4467e-01,        -inf,        -inf],
          [ 8.4623e-01, -4.2726e+00, -2.5749e+00,        -inf],
          [-3.9070e+00, -2.0406e+00, -1.3672e+00, -3.3677e+00]],

         [[ 1.7199e+00,        -inf,        -inf,        -inf],
          [ 1.0361e+00,  3.7902e-01,        -inf,        -inf],
          [ 2.4585e+00,  1.8920e+00,  1.9387e-01,        -inf],
          [ 2.2085e+00, -1.2907e+00,  5.1849e-01, -8.4900e-01]],

         [[-1.3424e+00,        -inf,        -inf,        -inf],
          [-3.7036e+00, -2.5916e+00,        -inf,        -inf],
          [-1.2557e-01,  2.5956e-02, -2.2447e-01,        -inf],
          [-6.6631e+00, -7.1806e+00,  5.3896e+00, -9.1292e-01]],

         [[ 2.4121e-02,        -inf,        -inf,        -inf],
          [ 5.9270e-01, -9.6736e-01,        -inf,        -inf],
          [-3.4627e+00, -1.1773e+00,  8.1685e-01,        -inf],
          [-7.8718e-01, -2.0944e+00, -8.3017e-01, -2.8524e+00]],

         [[ 1.7309e+00,        -inf,        -inf,        -inf],
          [-1.5702e+00,  5.7038e+00,        -inf,        -inf],
          [ 3.4018e-01,  4.4993e+00,  4.5614e-01,        -inf],
          [ 3.3200e+00,  2.5764e-02,  1.9647e+00, -8.3992e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.7777e+00,        -inf,        -inf,        -inf],
          [ 1.6521e-02, -1.3078e-01,        -inf,        -inf],
          [ 2.2249e+00,  4.2388e+00,  4.3555e+00,        -inf],
          [ 1.3270e+00,  1.4729e+00,  2.9739e+00,  1.1137e+00]],

         [[-4.5090e+00,        -inf,        -inf,        -inf],
          [-4.0194e+00, -2.1984e+00,        -inf,        -inf],
          [-3.4353e+00, -1.3858e+00, -5.9428e-01,        -inf],
          [-4.8722e+00, -4.7810e+00, -1.7127e+00, -2.8359e+00]],

         [[ 1.1425e+00,        -inf,        -inf,        -inf],
          [ 2.8828e+00,  1.9209e-01,        -inf,        -inf],
          [ 5.0722e+00,  3.5767e-01,  1.8960e+00,        -inf],
          [ 1.0817e+00,  1.0300e+00,  1.0873e+00,  4.7368e-01]],

         [[-6.1317e+00,        -inf,        -inf,        -inf],
          [-5.1851e-01, -1.5975e+00,        -inf,        -inf],
          [-4.8772e-02, -1.1340e+00, -2.6258e+00,        -inf],
          [-8.7401e-01, -1.4473e+00,  1.0523e+00,  1.3592e+00]],

         [[-1.5957e+00,        -inf,        -inf,        -inf],
          [-5.1313e-01,  2.5307e+00,        -inf,        -inf],
          [ 1.3202e+00,  3.3503e+00, -5.1276e+00,        -inf],
          [-1.6657e+00, -1.9960e+00, -8.7432e-01, -5.7834e-01]],

         [[ 1.6921e+00,        -inf,        -inf,        -inf],
          [-2.5316e+00, -1.2673e+00,        -inf,        -inf],
          [-2.1265e+00, -2.5066e+00, -1.6363e+00,        -inf],
          [ 8.6645e-01, -2.9035e-01, -9.6839e-01, -1.4712e+00]],

         [[-6.5297e-01,        -inf,        -inf,        -inf],
          [-2.9390e+00, -2.2922e+00,        -inf,        -inf],
          [-6.6533e-01,  4.9191e+00, -1.5430e+00,        -inf],
          [-2.9952e+00,  1.1065e+00, -5.0902e+00, -1.0595e+00]],

         [[ 1.4021e+00,        -inf,        -inf,        -inf],
          [ 1.0184e+00, -2.1699e+00,        -inf,        -inf],
          [-3.0018e+00,  1.2882e-01,  1.2691e+00,        -inf],
          [-3.5488e+00, -1.9681e+00, -1.1187e+00, -1.7719e+00]],

         [[-3.8656e+00,        -inf,        -inf,        -inf],
          [-6.3304e+00, -4.4917e+00,        -inf,        -inf],
          [-2.2563e+00,  4.4298e-01,  3.8144e+00,        -inf],
          [-1.7913e+00, -3.2139e+00,  1.5845e+00,  6.2582e-01]],

         [[ 7.7237e-01,        -inf,        -inf,        -inf],
          [-1.2198e+00, -2.5799e+00,        -inf,        -inf],
          [-5.4583e-01,  4.0831e-01, -2.5303e+00,        -inf],
          [ 7.1600e-01,  3.7371e-01, -1.1609e+00,  2.3382e+00]],

         [[-2.1425e+00,        -inf,        -inf,        -inf],
          [-2.9307e+00, -1.3931e-01,        -inf,        -inf],
          [-2.3193e+00, -6.1428e-01,  1.0124e+00,        -inf],
          [ 3.5559e+00, -1.5871e+00,  6.4256e+00,  3.3029e+00]],

         [[ 5.5720e-02,        -inf,        -inf,        -inf],
          [ 6.4262e+00, -1.9298e+00,        -inf,        -inf],
          [ 4.1537e+00,  2.4739e+00,  1.0559e+00,        -inf],
          [ 3.8845e+00,  3.3442e-01,  6.1332e-01,  1.6205e+00]],

         [[ 1.4096e+00,        -inf,        -inf,        -inf],
          [ 3.4435e+00, -6.2265e-02,        -inf,        -inf],
          [ 4.7926e-01, -1.1659e+00, -1.6734e-01,        -inf],
          [ 2.3003e-01, -2.2616e+00, -3.3012e-02,  6.3635e-01]],

         [[-2.2029e-01,        -inf,        -inf,        -inf],
          [-2.7899e+00,  4.4909e+00,        -inf,        -inf],
          [ 4.8769e-01, -9.3316e-01,  4.8214e-01,        -inf],
          [ 4.4058e+00,  3.1095e+00,  2.2633e+00,  2.1706e+00]],

         [[ 4.6918e-01,        -inf,        -inf,        -inf],
          [-2.1106e+00,  3.6447e-01,        -inf,        -inf],
          [-2.9138e+00, -3.8792e+00, -2.9226e+00,        -inf],
          [-7.5455e-01, -2.4701e+00,  1.0166e+00, -2.7385e-01]],

         [[ 2.8115e+00,        -inf,        -inf,        -inf],
          [ 2.2132e+00, -4.5786e-01,        -inf,        -inf],
          [ 6.3442e+00,  3.6733e+00, -1.2450e-01,        -inf],
          [-7.7441e-01, -2.3730e+00, -9.7376e-01,  1.9774e+00]],

         [[ 9.0616e-02,        -inf,        -inf,        -inf],
          [ 8.7828e-02, -8.8648e-01,        -inf,        -inf],
          [-1.6099e+00,  7.4399e-01,  3.8757e+00,        -inf],
          [-3.7020e+00, -3.3360e+00,  3.8934e-01, -5.2019e+00]],

         [[-4.5704e+00,        -inf,        -inf,        -inf],
          [ 5.9970e-01, -1.9984e+00,        -inf,        -inf],
          [ 1.5246e+00, -1.1266e+00, -2.1665e+00,        -inf],
          [ 5.1961e-01, -1.1577e+00, -3.8589e+00, -3.2531e+00]],

         [[-3.1402e-01,        -inf,        -inf,        -inf],
          [ 3.9161e+00,  3.0508e+00,        -inf,        -inf],
          [-4.3665e+00, -2.8448e+00, -6.4925e-02,        -inf],
          [ 5.4917e-01, -4.4797e-01,  4.6233e+00,  1.3714e+00]],

         [[-2.6538e-01,        -inf,        -inf,        -inf],
          [-1.7532e+00,  3.9319e-02,        -inf,        -inf],
          [-1.9838e+00, -3.7349e+00,  2.4581e+00,        -inf],
          [-3.6768e+00, -1.8972e+00,  1.5613e+00, -1.7228e+00]],

         [[ 2.1618e+00,        -inf,        -inf,        -inf],
          [-5.9472e-01,  1.6309e+00,        -inf,        -inf],
          [-6.3711e-01, -4.0991e+00, -3.5534e+00,        -inf],
          [-3.7411e+00, -9.8030e-01, -1.2896e+00, -2.0296e+00]],

         [[-4.1500e-01,        -inf,        -inf,        -inf],
          [ 1.9525e-01, -3.9629e-01,        -inf,        -inf],
          [ 2.5452e+00, -3.3275e+00,  1.5939e+00,        -inf],
          [-3.1176e+00, -2.7382e+00,  2.8426e+00,  2.6991e+00]],

         [[ 1.0731e+00,        -inf,        -inf,        -inf],
          [ 1.9757e-01, -3.8222e-01,        -inf,        -inf],
          [-2.9588e+00,  4.0135e-01,  4.6761e-01,        -inf],
          [-4.3955e+00, -1.5276e+00, -3.6257e-01, -8.6902e-01]],

         [[-3.5555e+00,        -inf,        -inf,        -inf],
          [-1.1645e+00, -4.6076e+00,        -inf,        -inf],
          [-4.7000e+00, -5.1678e+00, -2.8722e+00,        -inf],
          [ 3.3804e-01, -2.6881e+00, -5.1057e+00,  1.9267e+00]],

         [[ 5.8833e+00,        -inf,        -inf,        -inf],
          [-1.5204e+00,  1.6004e+00,        -inf,        -inf],
          [ 2.5029e+00,  5.5922e+00,  7.9187e+00,        -inf],
          [ 1.7836e+00, -1.2616e+00,  2.7327e+00,  1.1170e+00]]],


        [[[-3.2120e-02,        -inf,        -inf,        -inf],
          [-1.1277e+00, -1.1109e+00,        -inf,        -inf],
          [ 4.7150e-01, -3.4172e-01, -1.2318e-01,        -inf],
          [-4.4887e+00,  2.9028e-01, -1.5938e+00, -7.1844e+00]],

         [[-7.7464e+00,        -inf,        -inf,        -inf],
          [-2.8939e+00, -2.0810e+00,        -inf,        -inf],
          [-1.0926e+00,  1.4067e+00, -1.7300e+00,        -inf],
          [-1.8520e+00, -1.7447e+00, -3.4390e+00,  1.1514e+00]],

         [[-1.6286e+00,        -inf,        -inf,        -inf],
          [ 3.0401e+00,  2.9634e+00,        -inf,        -inf],
          [-4.0331e-01, -1.6194e+00, -2.1313e+00,        -inf],
          [-1.1184e+00,  3.9227e+00, -3.1395e+00,  2.7893e-01]],

         [[ 2.0781e-01,        -inf,        -inf,        -inf],
          [-1.6459e+00,  1.0977e+00,        -inf,        -inf],
          [ 2.0948e+00, -5.8003e-01,  1.2999e+00,        -inf],
          [ 1.7378e-02,  1.4108e+00, -4.7309e-01,  2.2258e+00]],

         [[-3.6233e-01,        -inf,        -inf,        -inf],
          [ 1.0172e+00,  4.2114e+00,        -inf,        -inf],
          [ 2.6134e+00, -1.0065e+00,  1.5214e+00,        -inf],
          [-2.4946e+00, -4.3302e+00, -1.5967e+00, -2.3025e+00]],

         [[ 6.0170e+00,        -inf,        -inf,        -inf],
          [ 7.4154e+00,  1.7850e+00,        -inf,        -inf],
          [ 8.9061e-01, -5.7672e-02, -2.8349e+00,        -inf],
          [ 2.3206e+00, -1.2252e-01, -3.1362e+00, -3.9432e+00]],

         [[ 2.5481e+00,        -inf,        -inf,        -inf],
          [ 4.6856e-01, -1.2469e+00,        -inf,        -inf],
          [ 4.2638e-01, -2.2795e+00,  1.0053e+00,        -inf],
          [-1.3494e+00, -5.3616e+00, -2.7061e-01,  8.2239e-01]],

         [[ 1.7378e+00,        -inf,        -inf,        -inf],
          [ 3.1479e+00,  7.7354e-01,        -inf,        -inf],
          [ 4.6441e+00,  4.1372e+00,  7.8771e-01,        -inf],
          [ 5.2597e+00, -1.6669e+00, -7.0871e-01,  7.3048e-01]],

         [[-1.7917e+00,        -inf,        -inf,        -inf],
          [-4.2111e-01, -2.5094e+00,        -inf,        -inf],
          [-1.5569e+00, -1.5737e+00, -6.0943e-01,        -inf],
          [-1.0530e+00, -3.4352e+00, -3.9829e+00, -2.0041e+00]],

         [[ 9.0083e-02,        -inf,        -inf,        -inf],
          [ 4.2805e+00, -3.2898e+00,        -inf,        -inf],
          [ 2.3306e+00, -6.7420e-01, -8.7515e-01,        -inf],
          [-2.4048e+00, -6.5998e+00,  3.0767e-01,  1.1404e+00]],

         [[ 1.4385e+00,        -inf,        -inf,        -inf],
          [-1.4740e+00, -6.8670e-01,        -inf,        -inf],
          [ 4.1636e-01, -9.1691e-01, -2.6747e+00,        -inf],
          [-1.8378e+00,  2.6667e+00,  2.2624e+00, -1.3623e+00]],

         [[ 1.4830e+00,        -inf,        -inf,        -inf],
          [ 4.4163e+00, -1.0894e+00,        -inf,        -inf],
          [ 3.0756e+00,  8.1288e-01,  2.7131e+00,        -inf],
          [-1.1162e+00, -6.3138e-02, -1.7473e+00, -1.2897e+00]],

         [[-2.3314e+00,        -inf,        -inf,        -inf],
          [-3.0087e+00, -5.3407e+00,        -inf,        -inf],
          [-3.3836e+00, -2.9610e+00, -6.3116e-01,        -inf],
          [-5.7569e-02, -3.1476e+00, -4.4162e+00, -6.0168e+00]],

         [[-8.5650e-01,        -inf,        -inf,        -inf],
          [ 2.5926e-01,  3.5255e+00,        -inf,        -inf],
          [-2.9752e-01,  1.2026e+00,  4.2872e-01,        -inf],
          [ 1.4500e+00,  1.9811e+00,  5.9392e-02,  3.1145e+00]],

         [[ 3.1653e+00,        -inf,        -inf,        -inf],
          [ 6.6550e-02, -1.2807e+00,        -inf,        -inf],
          [ 3.1465e-01, -4.0948e+00, -3.1287e+00,        -inf],
          [ 8.9257e-01, -8.6372e+00, -1.4820e+00, -9.2939e-02]],

         [[ 2.9080e+00,        -inf,        -inf,        -inf],
          [ 1.3626e+00, -8.3856e-01,        -inf,        -inf],
          [ 2.1813e+00,  6.0628e-01, -2.9845e+00,        -inf],
          [-5.1266e+00, -7.0400e+00, -2.2434e+00, -1.0515e+00]],

         [[-2.2221e+00,        -inf,        -inf,        -inf],
          [-3.3012e+00, -2.1996e+00,        -inf,        -inf],
          [ 9.5798e-01,  2.5092e+00,  2.0642e+00,        -inf],
          [-1.4396e+00, -4.0535e+00, -9.2192e-01, -4.8762e-01]],

         [[-1.1146e+00,        -inf,        -inf,        -inf],
          [-1.3788e-01, -1.6310e+00,        -inf,        -inf],
          [-2.9546e+00, -4.0126e+00, -1.5884e+00,        -inf],
          [ 1.2924e+00,  6.8856e-01,  6.5815e-01,  2.2099e+00]],

         [[-2.1362e+00,        -inf,        -inf,        -inf],
          [ 5.5370e-01, -5.8989e-01,        -inf,        -inf],
          [-4.0006e-01, -7.0974e+00, -3.0621e+00,        -inf],
          [ 6.4923e-01, -2.6818e-01,  6.3955e+00, -4.8732e-02]],

         [[ 2.2435e+00,        -inf,        -inf,        -inf],
          [-6.7458e-03,  1.7549e+00,        -inf,        -inf],
          [-4.6828e-01, -3.0653e+00, -6.4087e-01,        -inf],
          [-3.5961e+00, -7.1263e-01, -4.2029e+00, -3.0258e+00]],

         [[-3.1112e+00,        -inf,        -inf,        -inf],
          [ 1.0253e+00,  4.4467e-01,        -inf,        -inf],
          [ 8.4623e-01, -4.2726e+00, -2.5749e+00,        -inf],
          [-3.9070e+00, -2.0406e+00, -1.3672e+00, -3.3677e+00]],

         [[ 1.7199e+00,        -inf,        -inf,        -inf],
          [ 1.0361e+00,  3.7902e-01,        -inf,        -inf],
          [ 2.4585e+00,  1.8920e+00,  1.9387e-01,        -inf],
          [ 2.2085e+00, -1.2907e+00,  5.1849e-01, -8.4900e-01]],

         [[-1.3424e+00,        -inf,        -inf,        -inf],
          [-3.7036e+00, -2.5916e+00,        -inf,        -inf],
          [-1.2557e-01,  2.5956e-02, -2.2447e-01,        -inf],
          [-6.6631e+00, -7.1806e+00,  5.3896e+00, -9.1292e-01]],

         [[ 2.4121e-02,        -inf,        -inf,        -inf],
          [ 5.9270e-01, -9.6736e-01,        -inf,        -inf],
          [-3.4627e+00, -1.1773e+00,  8.1685e-01,        -inf],
          [-7.8718e-01, -2.0944e+00, -8.3017e-01, -2.8524e+00]],

         [[ 1.7309e+00,        -inf,        -inf,        -inf],
          [-1.5702e+00,  5.7038e+00,        -inf,        -inf],
          [ 3.4018e-01,  4.4993e+00,  4.5614e-01,        -inf],
          [ 3.3200e+00,  2.5764e-02,  1.9647e+00, -8.3992e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 4.2310e-01,  9.4660e-01,  6.8733e-01,  ...,  3.3786e-01,
           -9.9888e-01, -6.0119e-02],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          ...,
          [-4.8908e-01,  3.6948e-01, -1.8780e-01,  ...,  4.4021e-01,
            3.9687e-01, -4.4207e-01],
          [-2.3165e-01, -1.0704e+00,  3.1076e-01,  ..., -4.9157e-02,
           -9.2821e-01, -1.3283e+00],
          [-4.6486e-01, -1.0758e+00, -1.4280e-01,  ..., -7.9092e-01,
            3.9335e-01,  1.1375e-01]],

         [[ 6.3154e-01,  6.3031e-01,  2.4229e-01,  ...,  3.9796e-01,
           -3.4032e-01, -1.1506e-02],
          [-1.0341e-01,  1.0564e-01, -5.3870e-01,  ..., -4.8494e-01,
           -1.4270e-02, -6.2706e-01],
          [-5.1266e-01, -4.8981e-01, -3.6631e-01,  ...,  4.5609e-01,
           -6.2229e-02,  5.7080e-01],
          ...,
          [-8.0029e-01,  3.0294e-02, -2.4306e-01,  ...,  5.0087e-01,
            2.2330e-01, -4.4811e-01],
          [ 7.9744e-02, -7.4738e-01,  2.2839e-01,  ...,  2.1616e-01,
           -8.9888e-01, -8.9739e-01],
          [-6.0143e-01, -6.3987e-01, -3.2690e-01,  ..., -3.5742e-01,
           -3.1673e-01,  6.3202e-01]],

         [[ 5.8689e-01,  3.7382e-01,  1.3527e-01,  ...,  4.2079e-02,
           -9.6982e-03,  3.9176e-01],
          [-1.7789e-01,  3.4962e-01, -4.3027e-01,  ..., -5.7908e-01,
            2.5139e-01, -6.0074e-01],
          [-6.8679e-01, -6.6479e-01, -1.2251e-01,  ...,  4.3811e-01,
            1.9009e-01,  4.7295e-01],
          ...,
          [-9.5639e-01, -4.5933e-01, -8.0034e-02,  ...,  1.7355e-01,
            5.0059e-01, -1.8955e-01],
          [-1.2420e-01, -5.6393e-01,  4.8083e-01,  ...,  1.5004e-01,
           -5.5069e-01, -8.7253e-01],
          [-1.4101e-01, -1.5081e-01, -2.7539e-01,  ..., -5.4910e-01,
           -1.8798e-01,  8.0600e-02]],

         [[ 4.3750e-01,  2.9853e-01,  1.2752e-01,  ...,  1.7471e-02,
           -3.6718e-02,  3.1123e-01],
          [ 1.6705e-01, -7.4554e-02, -2.4774e-01,  ..., -1.5211e-01,
           -3.4327e-01,  2.9432e-04],
          [-2.8131e-01, -5.0659e-01, -2.1787e-01,  ...,  2.9360e-01,
            7.6520e-02,  2.5369e-01],
          ...,
          [-7.3178e-01, -5.1139e-01, -4.1373e-03,  ...,  1.9885e-01,
            4.8171e-01, -8.0962e-02],
          [-5.2856e-01, -5.1816e-01,  3.8101e-01,  ...,  2.7352e-01,
           -4.2241e-01, -9.1417e-01],
          [-3.5172e-01, -2.0406e-01, -3.1343e-01,  ..., -5.3640e-01,
           -8.6513e-02,  3.1775e-01]]],


        [[[ 2.8551e-01,  9.2022e-01, -9.7630e-02,  ...,  2.6513e-01,
           -6.7604e-02,  8.5212e-02],
          [-3.3447e-01,  1.1496e-02, -5.6497e-01,  ...,  1.2522e-01,
           -8.3729e-01, -4.8604e-01],
          [-1.7857e+00, -1.1800e+00, -6.0667e-01,  ...,  7.0620e-01,
            4.7768e-01,  6.5686e-01],
          ...,
          [ 3.4038e-01,  1.9162e-01,  3.1172e-01,  ...,  5.5307e-01,
            7.1537e-01, -4.6924e-01],
          [ 1.2694e-01, -6.4139e-01, -2.9338e-01,  ..., -4.6786e-01,
           -7.0331e-01, -1.2670e+00],
          [-1.1084e+00, -9.2506e-01, -3.4063e-01,  ..., -2.7775e-01,
            3.9719e-01, -2.3342e-01]],

         [[ 3.2415e-01,  4.2032e-01, -2.1823e-01,  ..., -1.0082e-01,
            5.6571e-01,  1.3809e-01],
          [-3.2621e-01, -9.9172e-03, -4.0451e-01,  ..., -1.0377e-01,
           -1.2865e-01, -6.6603e-01],
          [-5.4098e-01, -1.4129e+00, -6.6359e-01,  ...,  8.3593e-01,
            2.3044e-01,  2.2888e-01],
          ...,
          [-2.6776e-01, -2.5205e-01, -6.1579e-02,  ...,  4.8399e-01,
            2.7219e-01, -6.0369e-01],
          [-2.3268e-02, -3.5171e-01, -2.0443e-01,  ..., -7.3587e-01,
           -2.0482e-01, -1.0262e+00],
          [-7.0932e-01, -6.4835e-01, -4.1116e-01,  ..., -7.2679e-01,
            3.7720e-01,  9.4388e-01]],

         [[ 2.1653e-01,  2.9992e-01, -1.4249e-01,  ..., -5.5028e-02,
            3.5820e-01,  9.0979e-02],
          [-3.5110e-01,  5.0144e-02, -3.2517e-01,  ..., -4.8571e-02,
           -2.4325e-01, -5.2183e-01],
          [-4.8044e-01, -1.1817e+00, -4.6304e-01,  ...,  8.0603e-01,
            4.2026e-01,  2.4635e-01],
          ...,
          [-2.4004e-01, -4.7377e-01, -2.7487e-01,  ...,  1.7536e-01,
            3.4936e-01, -7.5182e-01],
          [-1.5756e-01, -5.0135e-01, -1.4141e-01,  ..., -6.1913e-01,
           -2.0253e-01, -7.8677e-01],
          [-4.8847e-01, -1.8211e-01, -3.6967e-01,  ..., -5.8915e-01,
            2.7567e-01,  5.4328e-01]],

         [[ 2.3201e-01,  9.3568e-02,  3.6046e-02,  ..., -1.3446e-01,
            5.2106e-01,  1.7922e-02],
          [-2.3698e-01,  7.0809e-02, -2.5028e-01,  ..., -1.3006e-02,
           -3.1176e-01, -2.2164e-01],
          [ 1.5860e-02, -1.0243e+00, -2.2573e-01,  ...,  5.9913e-01,
            2.7084e-01,  1.4793e-01],
          ...,
          [-1.0906e-01, -7.9804e-01, -4.1520e-01,  ...,  1.8591e-02,
            4.7590e-01, -1.0389e+00],
          [-2.3620e-01, -3.5243e-01, -1.8140e-01,  ..., -6.3212e-01,
           -2.0310e-01, -8.3850e-01],
          [-8.0436e-01, -3.7976e-01, -6.1217e-01,  ..., -4.5355e-01,
            5.4905e-01,  1.6718e-01]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.4231,  0.9466,  0.6873,  ..., -0.7909,  0.3933,  0.1137],
         [ 0.6315,  0.6303,  0.2423,  ..., -0.3574, -0.3167,  0.6320],
         [ 0.5869,  0.3738,  0.1353,  ..., -0.5491, -0.1880,  0.0806],
         [ 0.4375,  0.2985,  0.1275,  ..., -0.5364, -0.0865,  0.3178]],

        [[ 0.2855,  0.9202, -0.0976,  ..., -0.2777,  0.3972, -0.2334],
         [ 0.3241,  0.4203, -0.2182,  ..., -0.7268,  0.3772,  0.9439],
         [ 0.2165,  0.2999, -0.1425,  ..., -0.5892,  0.2757,  0.5433],
         [ 0.2320,  0.0936,  0.0360,  ..., -0.4535,  0.5490,  0.1672]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.2629,  0.1534, -0.3299,  ..., -0.2195,  0.0061,  0.1891],
         [ 0.1724,  0.0468, -0.1093,  ...,  0.1164,  0.0591,  0.0220],
         [ 0.3304, -0.0582, -0.3887,  ...,  0.0469,  0.0725,  0.0670],
         [ 0.2786,  0.0267, -0.3701,  ...,  0.1046,  0.0813, -0.1337]],

        [[-0.0391,  0.1233,  0.0375,  ..., -0.3694,  0.2347,  0.4588],
         [ 0.0228, -0.0347, -0.2237,  ...,  0.0791,  0.1295,  0.0452],
         [ 0.1598,  0.0339, -0.1725,  ...,  0.2211,  0.2292,  0.1595],
         [ 0.1800,  0.0667, -0.2278,  ...,  0.1971,  0.3501,  0.1263]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.9624,    -inf,    -inf,    -inf],
          [-2.0214, -1.5596,    -inf,    -inf],
          [-1.6795, -0.8816, -1.7715,    -inf],
          [-3.3088, -0.2486, -2.5677, -0.7898]],

         [[-2.0250,    -inf,    -inf,    -inf],
          [ 0.0445,  5.4597,    -inf,    -inf],
          [-4.1243, -0.9565,  1.2157,    -inf],
          [-3.0619,  2.4591,  0.0137,  2.7650]],

         [[-2.6468,    -inf,    -inf,    -inf],
          [ 1.4592, -2.0466,    -inf,    -inf],
          [-0.1891, -0.2488, -2.2126,    -inf],
          [-1.9441,  0.6534, -4.8424, -1.8071]],

         [[-1.4133,    -inf,    -inf,    -inf],
          [ 2.8940,  1.5666,    -inf,    -inf],
          [ 1.2850,  0.4134,  3.6054,    -inf],
          [ 0.4272, -2.3570,  0.6324,  1.8622]],

         [[-4.7197,    -inf,    -inf,    -inf],
          [-3.6217,  2.8834,    -inf,    -inf],
          [ 0.1034,  7.3892, -1.8042,    -inf],
          [-0.1651,  3.5892, -0.7232,  1.3904]],

         [[ 1.6912,    -inf,    -inf,    -inf],
          [ 1.3487,  2.0047,    -inf,    -inf],
          [-2.7361,  2.0064,  4.3797,    -inf],
          [ 0.7046,  1.6195,  0.2911,  4.0578]],

         [[ 1.2573,    -inf,    -inf,    -inf],
          [-0.5201,  3.4827,    -inf,    -inf],
          [-3.6556,  1.3747, -0.2999,    -inf],
          [ 0.5077,  3.0020,  4.3262,  2.9521]],

         [[ 2.3299,    -inf,    -inf,    -inf],
          [-0.3898, -0.2782,    -inf,    -inf],
          [-0.5595, -2.3616, -2.0706,    -inf],
          [-2.4940, -0.7111, -0.8695, -0.7594]],

         [[ 1.7281,    -inf,    -inf,    -inf],
          [-3.3209, -3.0383,    -inf,    -inf],
          [-1.9827,  1.3171, -2.0079,    -inf],
          [ 0.8379,  1.1758,  1.4621,  0.5892]],

         [[ 1.8136,    -inf,    -inf,    -inf],
          [-1.3907, -2.2735,    -inf,    -inf],
          [-0.4775, -0.9991,  0.9827,    -inf],
          [ 0.2834,  0.3486,  0.3196, -0.0161]],

         [[ 3.2694,    -inf,    -inf,    -inf],
          [ 0.8972, -3.1501,    -inf,    -inf],
          [ 3.9399, -1.1458, -1.8818,    -inf],
          [ 0.5140,  1.4125, -3.1598, -2.4300]],

         [[ 0.9509,    -inf,    -inf,    -inf],
          [ 2.6497,  3.1992,    -inf,    -inf],
          [-0.1390, -2.6632, -4.1032,    -inf],
          [ 2.8259, -2.6544, -1.7857, -1.4931]],

         [[ 1.4428,    -inf,    -inf,    -inf],
          [-1.5782,  1.7930,    -inf,    -inf],
          [-3.7870, -1.8743,  0.1894,    -inf],
          [-0.3006, -0.5509, -1.8370,  1.4485]],

         [[ 1.8403,    -inf,    -inf,    -inf],
          [ 4.0081,  6.7269,    -inf,    -inf],
          [ 2.8392,  6.5283,  3.6823,    -inf],
          [ 2.7739,  3.6459,  3.7413,  3.2868]],

         [[-2.1203,    -inf,    -inf,    -inf],
          [ 1.1272, -0.0346,    -inf,    -inf],
          [-3.0560, -3.5945, -0.1404,    -inf],
          [-1.5950, -5.7687,  1.6437,  3.8407]],

         [[ 0.8784,    -inf,    -inf,    -inf],
          [-2.1796, -0.1686,    -inf,    -inf],
          [-0.2924,  0.8414,  2.6725,    -inf],
          [-3.8397, -3.6793,  2.9541, -1.4657]],

         [[-3.0795,    -inf,    -inf,    -inf],
          [-2.2273, -0.1144,    -inf,    -inf],
          [-1.3906, -1.5988,  2.2398,    -inf],
          [-0.3650,  3.2700,  5.2072, -0.1144]],

         [[ 0.4490,    -inf,    -inf,    -inf],
          [-2.2354,  1.2201,    -inf,    -inf],
          [-1.9682, -2.0039, -0.1333,    -inf],
          [ 0.5589,  1.0372, -1.6288,  3.6945]],

         [[-1.7381,    -inf,    -inf,    -inf],
          [-9.5201, -2.2299,    -inf,    -inf],
          [ 1.0897,  3.0158,  1.9292,    -inf],
          [ 0.2845,  2.8249,  2.0885,  2.0364]],

         [[ 2.3677,    -inf,    -inf,    -inf],
          [ 5.4112,  5.4471,    -inf,    -inf],
          [-0.4941,  1.6262, -0.1116,    -inf],
          [ 3.8800,  2.3229,  6.9438,  3.0534]],

         [[ 1.1287,    -inf,    -inf,    -inf],
          [-1.5253,  0.0893,    -inf,    -inf],
          [-2.8408,  3.4565, -0.3592,    -inf],
          [ 2.4552,  8.0026, -0.3459,  2.4988]],

         [[-2.4419,    -inf,    -inf,    -inf],
          [-0.2113, -3.8753,    -inf,    -inf],
          [ 1.5808, -1.9222, -5.3286,    -inf],
          [-1.9102, -3.2891, -0.9042,  0.2297]],

         [[-1.5784,    -inf,    -inf,    -inf],
          [-0.0474,  0.0964,    -inf,    -inf],
          [ 4.9502,  1.0648, -0.2900,    -inf],
          [ 1.2918, -2.5417, -0.0295,  3.0259]],

         [[-1.9446,    -inf,    -inf,    -inf],
          [ 2.6221,  5.1126,    -inf,    -inf],
          [ 3.0483,  1.7653,  1.7473,    -inf],
          [ 3.1906,  4.8201,  3.5400,  3.5266]],

         [[-1.3189,    -inf,    -inf,    -inf],
          [-0.9283, -2.9011,    -inf,    -inf],
          [ 1.9881, -0.7426, -0.8554,    -inf],
          [ 2.7267,  2.3735,  4.8381,  4.0283]]],


        [[[ 3.6076,    -inf,    -inf,    -inf],
          [ 0.1017, -2.8538,    -inf,    -inf],
          [-1.0857, -0.5949,  0.2891,    -inf],
          [ 0.1539, -2.2773,  3.4921,  0.8891]],

         [[ 0.5678,    -inf,    -inf,    -inf],
          [-0.4381, -0.5805,    -inf,    -inf],
          [-4.1341, -2.1250,  1.1568,    -inf],
          [ 2.6433,  6.0269, -1.7605,  0.7790]],

         [[-0.1020,    -inf,    -inf,    -inf],
          [ 1.3207,  1.9777,    -inf,    -inf],
          [ 0.3103,  0.3758, -1.3017,    -inf],
          [-0.7865,  2.2372, -1.7832,  0.1887]],

         [[-2.4784,    -inf,    -inf,    -inf],
          [-0.2417,  2.8409,    -inf,    -inf],
          [ 0.8081,  2.3852,  0.3581,    -inf],
          [ 0.2390,  0.7353,  0.9911,  0.5063]],

         [[-3.3406,    -inf,    -inf,    -inf],
          [ 0.9172,  3.3890,    -inf,    -inf],
          [ 0.0351,  2.8808,  1.9944,    -inf],
          [ 1.5680,  2.2921,  1.3529,  2.2276]],

         [[ 2.6403,    -inf,    -inf,    -inf],
          [-2.9641,  1.0972,    -inf,    -inf],
          [-2.9328,  1.5042, -1.6944,    -inf],
          [-0.5549,  2.1973,  1.4004,  2.1405]],

         [[ 3.4148,    -inf,    -inf,    -inf],
          [ 3.3883,  5.3937,    -inf,    -inf],
          [-1.2106,  4.3959, -1.4533,    -inf],
          [-1.4587,  3.7815,  3.1406,  5.2979]],

         [[ 1.2300,    -inf,    -inf,    -inf],
          [-1.1214,  1.9635,    -inf,    -inf],
          [ 0.3929,  2.1277,  0.6999,    -inf],
          [ 0.9790,  1.6403, -0.4115,  3.1785]],

         [[ 0.2989,    -inf,    -inf,    -inf],
          [-2.0419, -1.5388,    -inf,    -inf],
          [-1.6000, -0.9637, -1.9371,    -inf],
          [-0.2683,  0.6834,  1.1201,  0.3626]],

         [[-1.7982,    -inf,    -inf,    -inf],
          [-1.2539, -1.2814,    -inf,    -inf],
          [ 1.5018, -1.4600,  3.3301,    -inf],
          [ 2.4605,  0.2077,  1.1421, -0.0540]],

         [[ 0.5714,    -inf,    -inf,    -inf],
          [-4.1394, -1.0034,    -inf,    -inf],
          [ 0.2726,  0.5468,  0.3033,    -inf],
          [-2.3028,  2.1577,  4.5411,  3.1286]],

         [[ 1.3850,    -inf,    -inf,    -inf],
          [ 0.0451, -1.1939,    -inf,    -inf],
          [ 1.6783,  0.1903,  0.6365,    -inf],
          [ 2.4328,  2.4312,  1.8905,  4.6152]],

         [[-0.3379,    -inf,    -inf,    -inf],
          [ 5.7590, -0.6169,    -inf,    -inf],
          [-0.8733, -3.0330,  1.1240,    -inf],
          [-1.1139, -1.0700, -0.2514, -1.1155]],

         [[-1.9229,    -inf,    -inf,    -inf],
          [ 5.9983,  5.7446,    -inf,    -inf],
          [ 0.6631,  4.1399, -0.5106,    -inf],
          [ 0.1058,  2.1644,  0.7781, -0.3361]],

         [[-0.9897,    -inf,    -inf,    -inf],
          [ 0.4198, -2.4643,    -inf,    -inf],
          [-1.8298, -1.9857, -0.8966,    -inf],
          [-0.1865, -2.1149, -0.7507,  0.0912]],

         [[ 0.0626,    -inf,    -inf,    -inf],
          [-3.4456, -2.2290,    -inf,    -inf],
          [-1.9294, -1.0947, -1.0939,    -inf],
          [-3.3233, -6.8813, -3.3095,  0.3967]],

         [[-1.5313,    -inf,    -inf,    -inf],
          [ 0.5753, -2.5796,    -inf,    -inf],
          [ 1.1909, -0.1497,  2.7427,    -inf],
          [-0.2710, -2.0060,  4.3082,  1.4037]],

         [[ 1.8837,    -inf,    -inf,    -inf],
          [ 0.2764,  2.6224,    -inf,    -inf],
          [ 0.3849, -0.0318,  0.3561,    -inf],
          [ 2.6783,  3.1831, -0.6431, -1.0556]],

         [[ 1.4022,    -inf,    -inf,    -inf],
          [-2.9280, -3.3481,    -inf,    -inf],
          [-0.1703,  0.9782,  1.4028,    -inf],
          [ 1.8586,  0.3188,  2.2833, -0.0202]],

         [[ 1.6067,    -inf,    -inf,    -inf],
          [-2.7412, -4.6527,    -inf,    -inf],
          [ 2.8311,  2.0394,  0.4330,    -inf],
          [ 0.3893, -2.4794, -2.9490, -3.3437]],

         [[-3.0006,    -inf,    -inf,    -inf],
          [-5.9504, -3.6600,    -inf,    -inf],
          [-2.9279,  2.3148, -1.5925,    -inf],
          [-0.9513,  2.8522,  1.2310,  1.9189]],

         [[-4.0289,    -inf,    -inf,    -inf],
          [ 1.3478, -0.9688,    -inf,    -inf],
          [ 3.9363,  3.1798, -0.8960,    -inf],
          [ 0.5741, -0.6117,  0.5315, -1.4043]],

         [[ 1.7063,    -inf,    -inf,    -inf],
          [ 4.2148,  0.1311,    -inf,    -inf],
          [ 5.0442,  0.6546,  1.8994,    -inf],
          [ 6.0186,  1.5142,  4.1030,  2.6821]],

         [[ 2.3286,    -inf,    -inf,    -inf],
          [ 6.2136,  2.4333,    -inf,    -inf],
          [-0.1175, -3.8669,  0.7806,    -inf],
          [ 3.4674, -0.8336,  1.3721, -0.5475]],

         [[-4.8419,    -inf,    -inf,    -inf],
          [-3.2779, -1.2215,    -inf,    -inf],
          [-3.7277,  0.7691,  2.0465,    -inf],
          [-2.3422,  2.4177,  5.7597,  2.5225]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 0.9624,    -inf,    -inf,    -inf],
          [-2.0214, -1.5596,    -inf,    -inf],
          [-1.6795, -0.8816, -1.7715,    -inf],
          [-3.3088, -0.2486, -2.5677, -0.7898]],

         [[-2.0250,    -inf,    -inf,    -inf],
          [ 0.0445,  5.4597,    -inf,    -inf],
          [-4.1243, -0.9565,  1.2157,    -inf],
          [-3.0619,  2.4591,  0.0137,  2.7650]],

         [[-2.6468,    -inf,    -inf,    -inf],
          [ 1.4592, -2.0466,    -inf,    -inf],
          [-0.1891, -0.2488, -2.2126,    -inf],
          [-1.9441,  0.6534, -4.8424, -1.8071]],

         [[-1.4133,    -inf,    -inf,    -inf],
          [ 2.8940,  1.5666,    -inf,    -inf],
          [ 1.2850,  0.4134,  3.6054,    -inf],
          [ 0.4272, -2.3570,  0.6324,  1.8622]],

         [[-4.7197,    -inf,    -inf,    -inf],
          [-3.6217,  2.8834,    -inf,    -inf],
          [ 0.1034,  7.3892, -1.8042,    -inf],
          [-0.1651,  3.5892, -0.7232,  1.3904]],

         [[ 1.6912,    -inf,    -inf,    -inf],
          [ 1.3487,  2.0047,    -inf,    -inf],
          [-2.7361,  2.0064,  4.3797,    -inf],
          [ 0.7046,  1.6195,  0.2911,  4.0578]],

         [[ 1.2573,    -inf,    -inf,    -inf],
          [-0.5201,  3.4827,    -inf,    -inf],
          [-3.6556,  1.3747, -0.2999,    -inf],
          [ 0.5077,  3.0020,  4.3262,  2.9521]],

         [[ 2.3299,    -inf,    -inf,    -inf],
          [-0.3898, -0.2782,    -inf,    -inf],
          [-0.5595, -2.3616, -2.0706,    -inf],
          [-2.4940, -0.7111, -0.8695, -0.7594]],

         [[ 1.7281,    -inf,    -inf,    -inf],
          [-3.3209, -3.0383,    -inf,    -inf],
          [-1.9827,  1.3171, -2.0079,    -inf],
          [ 0.8379,  1.1758,  1.4621,  0.5892]],

         [[ 1.8136,    -inf,    -inf,    -inf],
          [-1.3907, -2.2735,    -inf,    -inf],
          [-0.4775, -0.9991,  0.9827,    -inf],
          [ 0.2834,  0.3486,  0.3196, -0.0161]],

         [[ 3.2694,    -inf,    -inf,    -inf],
          [ 0.8972, -3.1501,    -inf,    -inf],
          [ 3.9399, -1.1458, -1.8818,    -inf],
          [ 0.5140,  1.4125, -3.1598, -2.4300]],

         [[ 0.9509,    -inf,    -inf,    -inf],
          [ 2.6497,  3.1992,    -inf,    -inf],
          [-0.1390, -2.6632, -4.1032,    -inf],
          [ 2.8259, -2.6544, -1.7857, -1.4931]],

         [[ 1.4428,    -inf,    -inf,    -inf],
          [-1.5782,  1.7930,    -inf,    -inf],
          [-3.7870, -1.8743,  0.1894,    -inf],
          [-0.3006, -0.5509, -1.8370,  1.4485]],

         [[ 1.8403,    -inf,    -inf,    -inf],
          [ 4.0081,  6.7269,    -inf,    -inf],
          [ 2.8392,  6.5283,  3.6823,    -inf],
          [ 2.7739,  3.6459,  3.7413,  3.2868]],

         [[-2.1203,    -inf,    -inf,    -inf],
          [ 1.1272, -0.0346,    -inf,    -inf],
          [-3.0560, -3.5945, -0.1404,    -inf],
          [-1.5950, -5.7687,  1.6437,  3.8407]],

         [[ 0.8784,    -inf,    -inf,    -inf],
          [-2.1796, -0.1686,    -inf,    -inf],
          [-0.2924,  0.8414,  2.6725,    -inf],
          [-3.8397, -3.6793,  2.9541, -1.4657]],

         [[-3.0795,    -inf,    -inf,    -inf],
          [-2.2273, -0.1144,    -inf,    -inf],
          [-1.3906, -1.5988,  2.2398,    -inf],
          [-0.3650,  3.2700,  5.2072, -0.1144]],

         [[ 0.4490,    -inf,    -inf,    -inf],
          [-2.2354,  1.2201,    -inf,    -inf],
          [-1.9682, -2.0039, -0.1333,    -inf],
          [ 0.5589,  1.0372, -1.6288,  3.6945]],

         [[-1.7381,    -inf,    -inf,    -inf],
          [-9.5201, -2.2299,    -inf,    -inf],
          [ 1.0897,  3.0158,  1.9292,    -inf],
          [ 0.2845,  2.8249,  2.0885,  2.0364]],

         [[ 2.3677,    -inf,    -inf,    -inf],
          [ 5.4112,  5.4471,    -inf,    -inf],
          [-0.4941,  1.6262, -0.1116,    -inf],
          [ 3.8800,  2.3229,  6.9438,  3.0534]],

         [[ 1.1287,    -inf,    -inf,    -inf],
          [-1.5253,  0.0893,    -inf,    -inf],
          [-2.8408,  3.4565, -0.3592,    -inf],
          [ 2.4552,  8.0026, -0.3459,  2.4988]],

         [[-2.4419,    -inf,    -inf,    -inf],
          [-0.2113, -3.8753,    -inf,    -inf],
          [ 1.5808, -1.9222, -5.3286,    -inf],
          [-1.9102, -3.2891, -0.9042,  0.2297]],

         [[-1.5784,    -inf,    -inf,    -inf],
          [-0.0474,  0.0964,    -inf,    -inf],
          [ 4.9502,  1.0648, -0.2900,    -inf],
          [ 1.2918, -2.5417, -0.0295,  3.0259]],

         [[-1.9446,    -inf,    -inf,    -inf],
          [ 2.6221,  5.1126,    -inf,    -inf],
          [ 3.0483,  1.7653,  1.7473,    -inf],
          [ 3.1906,  4.8201,  3.5400,  3.5266]],

         [[-1.3189,    -inf,    -inf,    -inf],
          [-0.9283, -2.9011,    -inf,    -inf],
          [ 1.9881, -0.7426, -0.8554,    -inf],
          [ 2.7267,  2.3735,  4.8381,  4.0283]]],


        [[[ 3.6076,    -inf,    -inf,    -inf],
          [ 0.1017, -2.8538,    -inf,    -inf],
          [-1.0857, -0.5949,  0.2891,    -inf],
          [ 0.1539, -2.2773,  3.4921,  0.8891]],

         [[ 0.5678,    -inf,    -inf,    -inf],
          [-0.4381, -0.5805,    -inf,    -inf],
          [-4.1341, -2.1250,  1.1568,    -inf],
          [ 2.6433,  6.0269, -1.7605,  0.7790]],

         [[-0.1020,    -inf,    -inf,    -inf],
          [ 1.3207,  1.9777,    -inf,    -inf],
          [ 0.3103,  0.3758, -1.3017,    -inf],
          [-0.7865,  2.2372, -1.7832,  0.1887]],

         [[-2.4784,    -inf,    -inf,    -inf],
          [-0.2417,  2.8409,    -inf,    -inf],
          [ 0.8081,  2.3852,  0.3581,    -inf],
          [ 0.2390,  0.7353,  0.9911,  0.5063]],

         [[-3.3406,    -inf,    -inf,    -inf],
          [ 0.9172,  3.3890,    -inf,    -inf],
          [ 0.0351,  2.8808,  1.9944,    -inf],
          [ 1.5680,  2.2921,  1.3529,  2.2276]],

         [[ 2.6403,    -inf,    -inf,    -inf],
          [-2.9641,  1.0972,    -inf,    -inf],
          [-2.9328,  1.5042, -1.6944,    -inf],
          [-0.5549,  2.1973,  1.4004,  2.1405]],

         [[ 3.4148,    -inf,    -inf,    -inf],
          [ 3.3883,  5.3937,    -inf,    -inf],
          [-1.2106,  4.3959, -1.4533,    -inf],
          [-1.4587,  3.7815,  3.1406,  5.2979]],

         [[ 1.2300,    -inf,    -inf,    -inf],
          [-1.1214,  1.9635,    -inf,    -inf],
          [ 0.3929,  2.1277,  0.6999,    -inf],
          [ 0.9790,  1.6403, -0.4115,  3.1785]],

         [[ 0.2989,    -inf,    -inf,    -inf],
          [-2.0419, -1.5388,    -inf,    -inf],
          [-1.6000, -0.9637, -1.9371,    -inf],
          [-0.2683,  0.6834,  1.1201,  0.3626]],

         [[-1.7982,    -inf,    -inf,    -inf],
          [-1.2539, -1.2814,    -inf,    -inf],
          [ 1.5018, -1.4600,  3.3301,    -inf],
          [ 2.4605,  0.2077,  1.1421, -0.0540]],

         [[ 0.5714,    -inf,    -inf,    -inf],
          [-4.1394, -1.0034,    -inf,    -inf],
          [ 0.2726,  0.5468,  0.3033,    -inf],
          [-2.3028,  2.1577,  4.5411,  3.1286]],

         [[ 1.3850,    -inf,    -inf,    -inf],
          [ 0.0451, -1.1939,    -inf,    -inf],
          [ 1.6783,  0.1903,  0.6365,    -inf],
          [ 2.4328,  2.4312,  1.8905,  4.6152]],

         [[-0.3379,    -inf,    -inf,    -inf],
          [ 5.7590, -0.6169,    -inf,    -inf],
          [-0.8733, -3.0330,  1.1240,    -inf],
          [-1.1139, -1.0700, -0.2514, -1.1155]],

         [[-1.9229,    -inf,    -inf,    -inf],
          [ 5.9983,  5.7446,    -inf,    -inf],
          [ 0.6631,  4.1399, -0.5106,    -inf],
          [ 0.1058,  2.1644,  0.7781, -0.3361]],

         [[-0.9897,    -inf,    -inf,    -inf],
          [ 0.4198, -2.4643,    -inf,    -inf],
          [-1.8298, -1.9857, -0.8966,    -inf],
          [-0.1865, -2.1149, -0.7507,  0.0912]],

         [[ 0.0626,    -inf,    -inf,    -inf],
          [-3.4456, -2.2290,    -inf,    -inf],
          [-1.9294, -1.0947, -1.0939,    -inf],
          [-3.3233, -6.8813, -3.3095,  0.3967]],

         [[-1.5313,    -inf,    -inf,    -inf],
          [ 0.5753, -2.5796,    -inf,    -inf],
          [ 1.1909, -0.1497,  2.7427,    -inf],
          [-0.2710, -2.0060,  4.3082,  1.4037]],

         [[ 1.8837,    -inf,    -inf,    -inf],
          [ 0.2764,  2.6224,    -inf,    -inf],
          [ 0.3849, -0.0318,  0.3561,    -inf],
          [ 2.6783,  3.1831, -0.6431, -1.0556]],

         [[ 1.4022,    -inf,    -inf,    -inf],
          [-2.9280, -3.3481,    -inf,    -inf],
          [-0.1703,  0.9782,  1.4028,    -inf],
          [ 1.8586,  0.3188,  2.2833, -0.0202]],

         [[ 1.6067,    -inf,    -inf,    -inf],
          [-2.7412, -4.6527,    -inf,    -inf],
          [ 2.8311,  2.0394,  0.4330,    -inf],
          [ 0.3893, -2.4794, -2.9490, -3.3437]],

         [[-3.0006,    -inf,    -inf,    -inf],
          [-5.9504, -3.6600,    -inf,    -inf],
          [-2.9279,  2.3148, -1.5925,    -inf],
          [-0.9513,  2.8522,  1.2310,  1.9189]],

         [[-4.0289,    -inf,    -inf,    -inf],
          [ 1.3478, -0.9688,    -inf,    -inf],
          [ 3.9363,  3.1798, -0.8960,    -inf],
          [ 0.5741, -0.6117,  0.5315, -1.4043]],

         [[ 1.7063,    -inf,    -inf,    -inf],
          [ 4.2148,  0.1311,    -inf,    -inf],
          [ 5.0442,  0.6546,  1.8994,    -inf],
          [ 6.0186,  1.5142,  4.1030,  2.6821]],

         [[ 2.3286,    -inf,    -inf,    -inf],
          [ 6.2136,  2.4333,    -inf,    -inf],
          [-0.1175, -3.8669,  0.7806,    -inf],
          [ 3.4674, -0.8336,  1.3721, -0.5475]],

         [[-4.8419,    -inf,    -inf,    -inf],
          [-3.2779, -1.2215,    -inf,    -inf],
          [-3.7277,  0.7691,  2.0465,    -inf],
          [-2.3422,  2.4177,  5.7597,  2.5225]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.9327, -0.3979,  0.0543,  ...,  0.7011, -0.4382, -0.4947],
          [ 0.6410,  0.3611, -0.9406,  ...,  0.9431, -0.1579, -0.8802],
          [ 0.8045,  0.0555,  0.3930,  ..., -0.3209, -1.0182,  0.7375],
          ...,
          [-0.1646,  1.4504, -0.1971,  ..., -0.6206,  0.8448,  0.4789],
          [-0.0978, -0.7308,  0.5847,  ...,  1.0807,  0.1563, -0.4417],
          [-0.6422, -0.4856,  0.9792,  ...,  0.6441,  0.4241, -0.5452]],

         [[-0.5387,  0.0182,  0.2105,  ...,  0.4012, -0.3685, -0.5434],
          [-0.3058,  0.3178, -0.5981,  ...,  0.8601, -0.1940, -0.5862],
          [ 0.4541,  0.3309,  0.4765,  ..., -0.2275, -1.3582,  0.6430],
          ...,
          [ 0.4052,  1.4182,  0.3513,  ..., -0.3702,  1.2011,  0.7221],
          [-0.0414, -0.3090,  0.2472,  ...,  0.4569,  0.0661, -0.1867],
          [-0.6980, -0.1895,  0.4035,  ...,  0.7410,  0.3406, -0.8019]],

         [[-0.2110,  0.3875, -0.0760,  ...,  0.1916, -0.3554, -0.0963],
          [-0.0331,  0.1932, -0.2326,  ...,  0.2664,  0.1672, -0.4872],
          [ 0.5035,  0.4479,  0.0496,  ..., -0.0478, -1.2648,  0.3790],
          ...,
          [ 0.3162,  1.1902,  0.3373,  ..., -0.4205,  1.1675,  0.7814],
          [ 0.0495, -0.4245,  0.7223,  ...,  1.3896,  0.1592,  0.0247],
          [-0.5164, -0.2490,  0.3501,  ...,  0.6649,  0.2276, -0.5480]],

         [[-0.4716,  0.2582, -0.1186,  ...,  0.1222, -0.1989, -0.1723],
          [-0.0240,  0.1997, -0.6130,  ...,  0.0913,  0.1153, -0.6693],
          [ 0.3769,  0.5223, -0.0596,  ...,  0.0427, -1.1574,  0.2036],
          ...,
          [ 0.3852,  1.0078,  0.4007,  ..., -0.5353,  1.2319,  0.3794],
          [ 0.4249, -0.4478,  0.6392,  ...,  1.2678, -0.1428,  0.2005],
          [-0.3532,  0.0474,  0.2517,  ...,  0.6280, -0.2191, -0.3915]]],


        [[[-1.0860, -0.1059,  0.4056,  ...,  0.2110,  0.0945,  0.5741],
          [ 0.6919,  0.1266, -0.5665,  ...,  0.7875, -0.1843, -1.0161],
          [ 1.0072, -0.2992,  0.2346,  ..., -0.6596, -0.9778,  0.1679],
          ...,
          [ 0.0108,  1.2062, -0.2198,  ..., -0.5009,  0.6523,  0.5894],
          [ 0.4283, -0.3250,  0.0194,  ...,  1.0607,  0.0644, -0.7249],
          [-0.2470, -0.3496,  0.2750,  ...,  0.4437,  0.2903, -0.8927]],

         [[-0.5056,  0.3127, -0.1675,  ...,  0.1182,  0.2979,  0.7431],
          [ 0.2290,  0.4069, -0.3181,  ...,  0.3347, -0.1559, -0.5586],
          [ 0.6139, -0.2131,  0.3923,  ..., -0.6031, -0.9513,  0.1194],
          ...,
          [ 0.4488,  0.4588,  0.0056,  ...,  0.0867,  0.1283,  0.3735],
          [ 0.2638, -0.2002,  0.0119,  ...,  0.6534,  0.0397, -0.4465],
          [-0.1252,  0.2471,  0.0285,  ...,  0.5661, -0.0454, -0.7167]],

         [[-0.5880,  0.2624,  0.1274,  ...,  0.3429, -0.2195,  1.0164],
          [ 0.2325,  0.3277, -0.2756,  ..., -0.0933,  0.2285, -0.4308],
          [ 0.6184, -0.1037,  0.1277,  ..., -0.4277, -1.0643,  0.2703],
          ...,
          [ 0.2846,  1.0592,  0.0751,  ...,  0.0423,  0.4795,  0.8566],
          [ 0.4425, -0.4372,  0.0768,  ...,  1.3556,  0.1214, -0.1567],
          [-0.0331, -0.0522, -0.0364,  ...,  0.3187, -0.1662, -0.4221]],

         [[-0.1360,  0.1147, -0.2044,  ...,  0.0747,  0.1716,  0.5337],
          [ 0.0506,  0.6435, -0.2398,  ...,  0.0634,  0.1143, -0.5128],
          [ 0.4278,  0.1214,  0.3190,  ..., -0.1457, -0.5575,  0.0022],
          ...,
          [ 0.4572,  1.1300,  0.1394,  ...,  0.1154,  0.7044,  0.7520],
          [ 0.3932, -0.3678, -0.0295,  ...,  0.9216,  0.0296,  0.1817],
          [ 0.0454, -0.0042,  0.1361,  ..., -0.0418, -0.3322, -0.2594]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.9327, -0.3979,  0.0543,  ...,  0.6441,  0.4241, -0.5452],
         [-0.5387,  0.0182,  0.2105,  ...,  0.7410,  0.3406, -0.8019],
         [-0.2110,  0.3875, -0.0760,  ...,  0.6649,  0.2276, -0.5480],
         [-0.4716,  0.2582, -0.1186,  ...,  0.6280, -0.2191, -0.3915]],

        [[-1.0860, -0.1059,  0.4056,  ...,  0.4437,  0.2903, -0.8927],
         [-0.5056,  0.3127, -0.1675,  ...,  0.5661, -0.0454, -0.7167],
         [-0.5880,  0.2624,  0.1274,  ...,  0.3187, -0.1662, -0.4221],
         [-0.1360,  0.1147, -0.2044,  ..., -0.0418, -0.3322, -0.2594]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.1951,  0.2592,  0.0534,  ..., -0.1389, -0.2806,  0.0301],
         [-0.1249, -0.0497,  0.1838,  ...,  0.0008,  0.1248,  0.1590],
         [-0.2271, -0.1748, -0.2062,  ..., -0.1473, -0.1458,  0.0049],
         [-0.1272, -0.2676, -0.0760,  ..., -0.1030, -0.1885,  0.0294]],

        [[ 0.2073, -0.0085, -0.2102,  ...,  0.3587, -0.2123,  0.1698],
         [ 0.1090, -0.0740,  0.1519,  ...,  0.1758, -0.0565,  0.0656],
         [-0.0196, -0.1939, -0.0074,  ...,  0.1801, -0.1736, -0.0512],
         [-0.1576, -0.1783, -0.0209,  ...,  0.2616, -0.0581, -0.0386]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-4.0858e-01,        -inf,        -inf,        -inf],
          [-1.5333e+00, -1.8807e+00,        -inf,        -inf],
          [ 2.9764e+00,  4.4907e+00,  2.2977e+00,        -inf],
          [ 1.6341e+00,  2.1285e+00,  3.1782e+00,  5.4687e+00]],

         [[-3.4466e+00,        -inf,        -inf,        -inf],
          [ 2.1750e+00, -7.1080e-01,        -inf,        -inf],
          [-9.5706e-01,  3.7835e+00, -9.0362e-01,        -inf],
          [-6.3064e-01, -1.3264e+00,  2.9385e-01, -3.5561e+00]],

         [[ 1.3291e-01,        -inf,        -inf,        -inf],
          [-2.3139e+00, -1.4861e+00,        -inf,        -inf],
          [-4.7872e+00, -4.6108e+00, -5.3405e+00,        -inf],
          [-4.8067e+00, -3.6914e+00, -1.3135e+00,  4.5140e-01]],

         [[-3.0424e+00,        -inf,        -inf,        -inf],
          [-6.4215e-01,  3.0301e-01,        -inf,        -inf],
          [-1.0021e+00,  2.1986e+00, -2.6943e+00,        -inf],
          [-1.9226e+00, -1.0714e+00, -3.4431e+00, -1.2517e+00]],

         [[ 4.5915e+00,        -inf,        -inf,        -inf],
          [ 7.3059e-01,  1.4800e+00,        -inf,        -inf],
          [ 7.0260e-01,  2.4135e-01,  9.8671e-01,        -inf],
          [ 2.4079e+00,  9.6256e-02,  3.0338e+00,  1.2748e+00]],

         [[-1.7662e-01,        -inf,        -inf,        -inf],
          [ 1.7691e+00,  3.1780e-01,        -inf,        -inf],
          [-6.2578e-01, -1.4264e+00,  9.8249e-01,        -inf],
          [-1.6544e+00, -1.8886e+00, -2.4956e+00,  9.4551e-01]],

         [[-4.3922e+00,        -inf,        -inf,        -inf],
          [-1.5081e+00,  1.0283e+00,        -inf,        -inf],
          [-4.6265e+00, -3.7914e+00,  1.0481e+00,        -inf],
          [-4.1472e+00, -2.3064e+00, -1.7415e+00, -2.4321e+00]],

         [[ 1.0820e+00,        -inf,        -inf,        -inf],
          [-3.6873e+00,  9.1319e-01,        -inf,        -inf],
          [ 7.0586e-01, -2.3235e-01, -2.7160e+00,        -inf],
          [-5.1784e-01,  3.2849e+00,  6.2070e+00,  2.6607e+00]],

         [[ 2.4651e+00,        -inf,        -inf,        -inf],
          [-9.0979e-01, -5.3579e-01,        -inf,        -inf],
          [ 1.0374e+00,  5.4979e+00, -9.1587e-01,        -inf],
          [ 3.6663e+00,  4.3307e+00, -5.9188e-01, -2.9545e-01]],

         [[-2.9243e+00,        -inf,        -inf,        -inf],
          [-1.2450e+00, -2.9825e-01,        -inf,        -inf],
          [ 4.3882e+00, -1.7603e+00, -2.4257e+00,        -inf],
          [ 7.5110e-01, -1.5505e+00, -2.1093e+00, -6.6540e-01]],

         [[ 4.6981e+00,        -inf,        -inf,        -inf],
          [ 1.7214e+00, -4.4816e+00,        -inf,        -inf],
          [ 2.7763e+00, -1.5948e+00,  1.1251e-01,        -inf],
          [ 3.2885e+00,  4.3306e-01,  1.0725e+00, -3.0678e+00]],

         [[ 2.0995e+00,        -inf,        -inf,        -inf],
          [ 3.4908e+00,  8.9678e-01,        -inf,        -inf],
          [ 2.0778e+00, -9.8803e-02,  1.3976e+00,        -inf],
          [-1.1157e+00, -4.7575e+00, -1.6929e+00, -7.2671e-01]],

         [[ 1.5752e+00,        -inf,        -inf,        -inf],
          [ 2.4662e+00, -7.3878e-01,        -inf,        -inf],
          [ 2.6561e+00,  1.2117e-01,  2.4344e+00,        -inf],
          [ 4.0460e+00,  1.6885e+00,  2.7894e+00,  2.3443e+00]],

         [[ 2.5360e+00,        -inf,        -inf,        -inf],
          [ 1.7504e+00, -4.3698e-01,        -inf,        -inf],
          [ 3.9929e-01, -3.5704e+00, -3.7268e+00,        -inf],
          [-2.6904e+00, -1.3073e+00, -5.4324e+00, -1.3136e+00]],

         [[-2.7616e-01,        -inf,        -inf,        -inf],
          [ 4.9286e-01, -1.6260e+00,        -inf,        -inf],
          [ 1.6230e-01,  2.8968e+00, -1.9878e+00,        -inf],
          [-1.3156e+00, -2.3731e+00, -2.8997e+00, -2.0118e+00]],

         [[-3.2750e+00,        -inf,        -inf,        -inf],
          [-3.0283e+00, -4.5469e-02,        -inf,        -inf],
          [-9.0609e-01, -2.1719e-01,  4.0026e+00,        -inf],
          [ 4.3154e-01, -1.6310e+00,  1.9945e+00, -2.0597e+00]],

         [[-1.8239e+00,        -inf,        -inf,        -inf],
          [-6.7118e+00, -5.0690e+00,        -inf,        -inf],
          [-6.4161e+00, -6.1981e+00,  1.2537e+00,        -inf],
          [-4.0605e+00, -3.5353e+00,  2.0177e+00,  1.0486e+00]],

         [[ 2.6818e+00,        -inf,        -inf,        -inf],
          [ 4.4994e-01,  1.7255e+00,        -inf,        -inf],
          [-2.8188e+00, -1.0266e+00,  6.7753e-01,        -inf],
          [-6.5946e-01, -1.3498e+00, -3.3439e+00, -1.2654e+00]],

         [[ 1.0877e+00,        -inf,        -inf,        -inf],
          [ 7.8790e+00, -2.7146e+00,        -inf,        -inf],
          [ 3.3087e+00, -2.5476e+00, -8.3511e+00,        -inf],
          [ 9.1056e+00,  5.9412e+00,  2.2035e+00,  5.5840e+00]],

         [[-3.0177e+00,        -inf,        -inf,        -inf],
          [-2.0519e+00, -4.7224e+00,        -inf,        -inf],
          [-3.4092e+00, -3.7135e+00, -2.4412e+00,        -inf],
          [ 2.7370e+00,  1.6083e+00, -8.5726e-01, -2.8982e+00]],

         [[-3.8192e+00,        -inf,        -inf,        -inf],
          [-2.2940e+00, -2.9455e+00,        -inf,        -inf],
          [-2.0602e-01,  8.8490e-01,  5.4839e+00,        -inf],
          [-1.1446e+00,  8.6441e-01,  4.1358e+00,  2.8064e+00]],

         [[ 4.0940e+00,        -inf,        -inf,        -inf],
          [ 2.1690e+00, -8.3608e-01,        -inf,        -inf],
          [-2.7718e+00, -1.5690e+00, -4.4710e+00,        -inf],
          [ 1.8182e+00,  9.5737e-01, -3.8783e+00,  2.7334e+00]],

         [[ 2.0856e+00,        -inf,        -inf,        -inf],
          [ 4.1778e+00, -1.4523e+00,        -inf,        -inf],
          [ 3.5433e+00, -2.1839e+00, -9.1965e-01,        -inf],
          [ 2.7435e+00,  2.2796e+00,  1.7096e+00, -4.4688e+00]],

         [[ 3.4314e+00,        -inf,        -inf,        -inf],
          [-1.4455e+00,  1.9818e-01,        -inf,        -inf],
          [-9.3950e-01, -2.6763e+00, -2.0213e+00,        -inf],
          [ 2.3178e+00, -2.8479e+00, -3.7166e+00, -9.9507e-02]],

         [[ 3.1797e+00,        -inf,        -inf,        -inf],
          [-1.1842e+00, -1.5630e+00,        -inf,        -inf],
          [-2.5105e+00,  9.0125e-01, -2.6383e+00,        -inf],
          [-9.0536e-01,  1.5736e+00, -2.6257e+00,  1.2279e+00]]],


        [[[-1.1027e+00,        -inf,        -inf,        -inf],
          [ 5.1116e-01,  3.7214e+00,        -inf,        -inf],
          [-3.1860e+00,  9.7840e-01, -2.6770e+00,        -inf],
          [-4.1947e+00, -1.7464e+00, -7.4274e-01, -8.2825e-01]],

         [[ 2.4099e+00,        -inf,        -inf,        -inf],
          [ 2.7391e+00,  1.5641e+00,        -inf,        -inf],
          [ 1.7427e+00,  2.2211e+00,  6.2751e-01,        -inf],
          [ 9.9549e-01,  2.7637e+00,  7.1949e-01, -1.9365e+00]],

         [[ 1.0280e+00,        -inf,        -inf,        -inf],
          [ 1.5827e+00, -5.6306e+00,        -inf,        -inf],
          [-2.0985e-03, -4.5607e+00,  3.9982e-01,        -inf],
          [ 6.5282e-01, -5.6736e+00, -3.7214e+00, -5.0694e-01]],

         [[-3.1315e-01,        -inf,        -inf,        -inf],
          [-8.5379e-01,  1.3302e+00,        -inf,        -inf],
          [-9.8255e-02, -3.0248e-01, -7.4838e-01,        -inf],
          [ 2.6139e+00, -2.0997e+00,  2.7887e+00, -1.9938e+00]],

         [[ 5.4159e+00,        -inf,        -inf,        -inf],
          [ 6.6861e+00,  8.3766e+00,        -inf,        -inf],
          [ 3.2675e+00,  2.9990e+00,  4.4778e-01,        -inf],
          [ 5.5734e+00,  3.7666e+00, -3.4053e+00, -2.5293e+00]],

         [[ 7.8229e-01,        -inf,        -inf,        -inf],
          [ 1.7383e+00,  2.6809e+00,        -inf,        -inf],
          [-8.9098e-01, -3.6279e+00, -4.7359e+00,        -inf],
          [ 1.6092e-01,  7.5946e+00,  3.0961e+00,  9.5468e-01]],

         [[-1.7654e+00,        -inf,        -inf,        -inf],
          [-6.4484e+00, -3.6446e+00,        -inf,        -inf],
          [-7.9396e+00, -1.2988e+00, -3.8107e-01,        -inf],
          [-3.7718e+00, -2.9334e+00, -2.1734e+00,  9.5410e-01]],

         [[ 2.8979e-01,        -inf,        -inf,        -inf],
          [-6.8779e-01,  8.7754e-01,        -inf,        -inf],
          [ 5.1667e-01,  3.2483e+00,  7.0998e+00,        -inf],
          [-1.0483e+00,  1.0722e+00,  2.7782e-01, -2.3627e+00]],

         [[ 1.9828e+00,        -inf,        -inf,        -inf],
          [-1.7567e-01, -2.3544e+00,        -inf,        -inf],
          [ 1.2987e+00,  2.2667e+00,  5.1395e+00,        -inf],
          [ 7.0520e-04,  8.1180e-01,  2.3258e+00,  2.0447e+00]],

         [[-1.1753e+00,        -inf,        -inf,        -inf],
          [-2.0324e+00, -3.9826e+00,        -inf,        -inf],
          [ 5.5154e+00,  2.4248e+00, -6.9838e-03,        -inf],
          [ 1.4657e-02, -7.5367e+00, -1.0654e+00, -7.0670e-01]],

         [[ 2.7524e+00,        -inf,        -inf,        -inf],
          [ 2.8154e+00,  9.3280e-01,        -inf,        -inf],
          [ 1.5638e+00,  6.4180e-01, -2.9198e+00,        -inf],
          [ 1.4447e+00, -1.1034e+00, -3.0252e+00, -2.5456e+00]],

         [[ 2.9415e+00,        -inf,        -inf,        -inf],
          [ 1.0472e+00,  2.0469e+00,        -inf,        -inf],
          [ 8.5752e-01,  2.1487e+00,  3.8616e+00,        -inf],
          [ 2.8380e+00, -2.6176e+00, -2.6792e+00, -2.5543e-02]],

         [[ 4.6197e+00,        -inf,        -inf,        -inf],
          [ 3.6280e+00,  1.0409e+00,        -inf,        -inf],
          [ 3.5709e+00,  2.2635e+00,  2.8344e+00,        -inf],
          [ 1.5725e+00,  1.3418e+00,  1.6652e+00,  5.2272e-01]],

         [[ 1.9217e+00,        -inf,        -inf,        -inf],
          [-2.3165e+00, -3.2659e+00,        -inf,        -inf],
          [ 2.7748e+00, -2.2904e-01,  1.3720e+00,        -inf],
          [-4.4391e+00, -4.5237e+00,  1.6919e+00, -2.5140e+00]],

         [[ 5.3239e-01,        -inf,        -inf,        -inf],
          [-9.9577e-01, -3.7349e+00,        -inf,        -inf],
          [-1.4453e+00, -2.8332e+00,  4.9568e+00,        -inf],
          [-2.4428e+00, -6.7856e-01, -5.0243e-01, -2.6828e+00]],

         [[-5.5293e-01,        -inf,        -inf,        -inf],
          [ 2.0263e+00,  8.1711e-02,        -inf,        -inf],
          [-9.8457e-01, -3.4561e+00,  1.6718e-01,        -inf],
          [ 2.5783e+00, -2.1737e+00, -2.8780e+00,  1.1180e+00]],

         [[-1.5413e+00,        -inf,        -inf,        -inf],
          [ 2.6697e+00, -1.8380e+00,        -inf,        -inf],
          [-1.6130e-01, -2.5296e+00,  1.2860e+00,        -inf],
          [-1.9922e+00, -4.8566e+00,  9.2136e-01, -5.4695e-01]],

         [[-8.8316e-01,        -inf,        -inf,        -inf],
          [-9.1508e-01,  1.0906e+00,        -inf,        -inf],
          [-3.6841e+00, -2.9831e+00, -2.0458e+00,        -inf],
          [-1.3135e+00, -1.4377e+00, -6.5171e-01, -1.3958e+00]],

         [[ 2.1059e+00,        -inf,        -inf,        -inf],
          [ 3.6402e+00,  7.7802e-02,        -inf,        -inf],
          [-4.2782e-01, -3.3694e+00, -4.7158e+00,        -inf],
          [ 2.1698e+00,  2.4789e+00, -8.3494e-01, -1.8302e+00]],

         [[ 4.4005e-01,        -inf,        -inf,        -inf],
          [-1.7182e+00, -2.1112e+00,        -inf,        -inf],
          [-1.4818e+00, -2.4860e+00, -1.3939e+00,        -inf],
          [ 5.5218e-01,  1.2464e+00,  5.2223e-01, -2.0834e-01]],

         [[-6.5930e-01,        -inf,        -inf,        -inf],
          [-8.1934e-01,  3.1173e+00,        -inf,        -inf],
          [ 4.0642e-01,  2.8109e-01,  3.4380e+00,        -inf],
          [ 2.2103e+00, -1.1157e-01, -5.2361e-01,  2.3614e+00]],

         [[ 1.9972e+00,        -inf,        -inf,        -inf],
          [ 2.7867e-01,  5.9366e-02,        -inf,        -inf],
          [-3.6266e+00, -3.0055e+00, -4.0117e+00,        -inf],
          [ 1.2263e+00,  1.9126e+00, -3.4311e+00, -7.3255e-01]],

         [[ 6.4192e+00,        -inf,        -inf,        -inf],
          [ 7.1774e+00,  3.8229e+00,        -inf,        -inf],
          [ 8.4081e+00,  3.0496e+00,  2.4277e+00,        -inf],
          [ 8.6935e+00,  4.8272e+00,  4.1920e+00,  2.5335e+00]],

         [[ 1.8549e+00,        -inf,        -inf,        -inf],
          [-4.1764e+00, -2.0480e+00,        -inf,        -inf],
          [-3.4098e+00, -3.9224e+00, -7.7552e-01,        -inf],
          [-2.4234e+00, -2.5720e+00, -4.2877e-01, -6.5829e-01]],

         [[-4.3249e+00,        -inf,        -inf,        -inf],
          [-6.1155e+00,  1.0363e-01,        -inf,        -inf],
          [-7.2953e+00, -3.6211e+00, -3.6017e+00,        -inf],
          [ 3.8782e+00, -1.2876e+00, -4.5824e-01, -5.2490e-01]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-4.0858e-01,        -inf,        -inf,        -inf],
          [-1.5333e+00, -1.8807e+00,        -inf,        -inf],
          [ 2.9764e+00,  4.4907e+00,  2.2977e+00,        -inf],
          [ 1.6341e+00,  2.1285e+00,  3.1782e+00,  5.4687e+00]],

         [[-3.4466e+00,        -inf,        -inf,        -inf],
          [ 2.1750e+00, -7.1080e-01,        -inf,        -inf],
          [-9.5706e-01,  3.7835e+00, -9.0362e-01,        -inf],
          [-6.3064e-01, -1.3264e+00,  2.9385e-01, -3.5561e+00]],

         [[ 1.3291e-01,        -inf,        -inf,        -inf],
          [-2.3139e+00, -1.4861e+00,        -inf,        -inf],
          [-4.7872e+00, -4.6108e+00, -5.3405e+00,        -inf],
          [-4.8067e+00, -3.6914e+00, -1.3135e+00,  4.5140e-01]],

         [[-3.0424e+00,        -inf,        -inf,        -inf],
          [-6.4215e-01,  3.0301e-01,        -inf,        -inf],
          [-1.0021e+00,  2.1986e+00, -2.6943e+00,        -inf],
          [-1.9226e+00, -1.0714e+00, -3.4431e+00, -1.2517e+00]],

         [[ 4.5915e+00,        -inf,        -inf,        -inf],
          [ 7.3059e-01,  1.4800e+00,        -inf,        -inf],
          [ 7.0260e-01,  2.4135e-01,  9.8671e-01,        -inf],
          [ 2.4079e+00,  9.6256e-02,  3.0338e+00,  1.2748e+00]],

         [[-1.7662e-01,        -inf,        -inf,        -inf],
          [ 1.7691e+00,  3.1780e-01,        -inf,        -inf],
          [-6.2578e-01, -1.4264e+00,  9.8249e-01,        -inf],
          [-1.6544e+00, -1.8886e+00, -2.4956e+00,  9.4551e-01]],

         [[-4.3922e+00,        -inf,        -inf,        -inf],
          [-1.5081e+00,  1.0283e+00,        -inf,        -inf],
          [-4.6265e+00, -3.7914e+00,  1.0481e+00,        -inf],
          [-4.1472e+00, -2.3064e+00, -1.7415e+00, -2.4321e+00]],

         [[ 1.0820e+00,        -inf,        -inf,        -inf],
          [-3.6873e+00,  9.1319e-01,        -inf,        -inf],
          [ 7.0586e-01, -2.3235e-01, -2.7160e+00,        -inf],
          [-5.1784e-01,  3.2849e+00,  6.2070e+00,  2.6607e+00]],

         [[ 2.4651e+00,        -inf,        -inf,        -inf],
          [-9.0979e-01, -5.3579e-01,        -inf,        -inf],
          [ 1.0374e+00,  5.4979e+00, -9.1587e-01,        -inf],
          [ 3.6663e+00,  4.3307e+00, -5.9188e-01, -2.9545e-01]],

         [[-2.9243e+00,        -inf,        -inf,        -inf],
          [-1.2450e+00, -2.9825e-01,        -inf,        -inf],
          [ 4.3882e+00, -1.7603e+00, -2.4257e+00,        -inf],
          [ 7.5110e-01, -1.5505e+00, -2.1093e+00, -6.6540e-01]],

         [[ 4.6981e+00,        -inf,        -inf,        -inf],
          [ 1.7214e+00, -4.4816e+00,        -inf,        -inf],
          [ 2.7763e+00, -1.5948e+00,  1.1251e-01,        -inf],
          [ 3.2885e+00,  4.3306e-01,  1.0725e+00, -3.0678e+00]],

         [[ 2.0995e+00,        -inf,        -inf,        -inf],
          [ 3.4908e+00,  8.9678e-01,        -inf,        -inf],
          [ 2.0778e+00, -9.8803e-02,  1.3976e+00,        -inf],
          [-1.1157e+00, -4.7575e+00, -1.6929e+00, -7.2671e-01]],

         [[ 1.5752e+00,        -inf,        -inf,        -inf],
          [ 2.4662e+00, -7.3878e-01,        -inf,        -inf],
          [ 2.6561e+00,  1.2117e-01,  2.4344e+00,        -inf],
          [ 4.0460e+00,  1.6885e+00,  2.7894e+00,  2.3443e+00]],

         [[ 2.5360e+00,        -inf,        -inf,        -inf],
          [ 1.7504e+00, -4.3698e-01,        -inf,        -inf],
          [ 3.9929e-01, -3.5704e+00, -3.7268e+00,        -inf],
          [-2.6904e+00, -1.3073e+00, -5.4324e+00, -1.3136e+00]],

         [[-2.7616e-01,        -inf,        -inf,        -inf],
          [ 4.9286e-01, -1.6260e+00,        -inf,        -inf],
          [ 1.6230e-01,  2.8968e+00, -1.9878e+00,        -inf],
          [-1.3156e+00, -2.3731e+00, -2.8997e+00, -2.0118e+00]],

         [[-3.2750e+00,        -inf,        -inf,        -inf],
          [-3.0283e+00, -4.5469e-02,        -inf,        -inf],
          [-9.0609e-01, -2.1719e-01,  4.0026e+00,        -inf],
          [ 4.3154e-01, -1.6310e+00,  1.9945e+00, -2.0597e+00]],

         [[-1.8239e+00,        -inf,        -inf,        -inf],
          [-6.7118e+00, -5.0690e+00,        -inf,        -inf],
          [-6.4161e+00, -6.1981e+00,  1.2537e+00,        -inf],
          [-4.0605e+00, -3.5353e+00,  2.0177e+00,  1.0486e+00]],

         [[ 2.6818e+00,        -inf,        -inf,        -inf],
          [ 4.4994e-01,  1.7255e+00,        -inf,        -inf],
          [-2.8188e+00, -1.0266e+00,  6.7753e-01,        -inf],
          [-6.5946e-01, -1.3498e+00, -3.3439e+00, -1.2654e+00]],

         [[ 1.0877e+00,        -inf,        -inf,        -inf],
          [ 7.8790e+00, -2.7146e+00,        -inf,        -inf],
          [ 3.3087e+00, -2.5476e+00, -8.3511e+00,        -inf],
          [ 9.1056e+00,  5.9412e+00,  2.2035e+00,  5.5840e+00]],

         [[-3.0177e+00,        -inf,        -inf,        -inf],
          [-2.0519e+00, -4.7224e+00,        -inf,        -inf],
          [-3.4092e+00, -3.7135e+00, -2.4412e+00,        -inf],
          [ 2.7370e+00,  1.6083e+00, -8.5726e-01, -2.8982e+00]],

         [[-3.8192e+00,        -inf,        -inf,        -inf],
          [-2.2940e+00, -2.9455e+00,        -inf,        -inf],
          [-2.0602e-01,  8.8490e-01,  5.4839e+00,        -inf],
          [-1.1446e+00,  8.6441e-01,  4.1358e+00,  2.8064e+00]],

         [[ 4.0940e+00,        -inf,        -inf,        -inf],
          [ 2.1690e+00, -8.3608e-01,        -inf,        -inf],
          [-2.7718e+00, -1.5690e+00, -4.4710e+00,        -inf],
          [ 1.8182e+00,  9.5737e-01, -3.8783e+00,  2.7334e+00]],

         [[ 2.0856e+00,        -inf,        -inf,        -inf],
          [ 4.1778e+00, -1.4523e+00,        -inf,        -inf],
          [ 3.5433e+00, -2.1839e+00, -9.1965e-01,        -inf],
          [ 2.7435e+00,  2.2796e+00,  1.7096e+00, -4.4688e+00]],

         [[ 3.4314e+00,        -inf,        -inf,        -inf],
          [-1.4455e+00,  1.9818e-01,        -inf,        -inf],
          [-9.3950e-01, -2.6763e+00, -2.0213e+00,        -inf],
          [ 2.3178e+00, -2.8479e+00, -3.7166e+00, -9.9507e-02]],

         [[ 3.1797e+00,        -inf,        -inf,        -inf],
          [-1.1842e+00, -1.5630e+00,        -inf,        -inf],
          [-2.5105e+00,  9.0125e-01, -2.6383e+00,        -inf],
          [-9.0536e-01,  1.5736e+00, -2.6257e+00,  1.2279e+00]]],


        [[[-1.1027e+00,        -inf,        -inf,        -inf],
          [ 5.1116e-01,  3.7214e+00,        -inf,        -inf],
          [-3.1860e+00,  9.7840e-01, -2.6770e+00,        -inf],
          [-4.1947e+00, -1.7464e+00, -7.4274e-01, -8.2825e-01]],

         [[ 2.4099e+00,        -inf,        -inf,        -inf],
          [ 2.7391e+00,  1.5641e+00,        -inf,        -inf],
          [ 1.7427e+00,  2.2211e+00,  6.2751e-01,        -inf],
          [ 9.9549e-01,  2.7637e+00,  7.1949e-01, -1.9365e+00]],

         [[ 1.0280e+00,        -inf,        -inf,        -inf],
          [ 1.5827e+00, -5.6306e+00,        -inf,        -inf],
          [-2.0985e-03, -4.5607e+00,  3.9982e-01,        -inf],
          [ 6.5282e-01, -5.6736e+00, -3.7214e+00, -5.0694e-01]],

         [[-3.1315e-01,        -inf,        -inf,        -inf],
          [-8.5379e-01,  1.3302e+00,        -inf,        -inf],
          [-9.8255e-02, -3.0248e-01, -7.4838e-01,        -inf],
          [ 2.6139e+00, -2.0997e+00,  2.7887e+00, -1.9938e+00]],

         [[ 5.4159e+00,        -inf,        -inf,        -inf],
          [ 6.6861e+00,  8.3766e+00,        -inf,        -inf],
          [ 3.2675e+00,  2.9990e+00,  4.4778e-01,        -inf],
          [ 5.5734e+00,  3.7666e+00, -3.4053e+00, -2.5293e+00]],

         [[ 7.8229e-01,        -inf,        -inf,        -inf],
          [ 1.7383e+00,  2.6809e+00,        -inf,        -inf],
          [-8.9098e-01, -3.6279e+00, -4.7359e+00,        -inf],
          [ 1.6092e-01,  7.5946e+00,  3.0961e+00,  9.5468e-01]],

         [[-1.7654e+00,        -inf,        -inf,        -inf],
          [-6.4484e+00, -3.6446e+00,        -inf,        -inf],
          [-7.9396e+00, -1.2988e+00, -3.8107e-01,        -inf],
          [-3.7718e+00, -2.9334e+00, -2.1734e+00,  9.5410e-01]],

         [[ 2.8979e-01,        -inf,        -inf,        -inf],
          [-6.8779e-01,  8.7754e-01,        -inf,        -inf],
          [ 5.1667e-01,  3.2483e+00,  7.0998e+00,        -inf],
          [-1.0483e+00,  1.0722e+00,  2.7782e-01, -2.3627e+00]],

         [[ 1.9828e+00,        -inf,        -inf,        -inf],
          [-1.7567e-01, -2.3544e+00,        -inf,        -inf],
          [ 1.2987e+00,  2.2667e+00,  5.1395e+00,        -inf],
          [ 7.0520e-04,  8.1180e-01,  2.3258e+00,  2.0447e+00]],

         [[-1.1753e+00,        -inf,        -inf,        -inf],
          [-2.0324e+00, -3.9826e+00,        -inf,        -inf],
          [ 5.5154e+00,  2.4248e+00, -6.9838e-03,        -inf],
          [ 1.4657e-02, -7.5367e+00, -1.0654e+00, -7.0670e-01]],

         [[ 2.7524e+00,        -inf,        -inf,        -inf],
          [ 2.8154e+00,  9.3280e-01,        -inf,        -inf],
          [ 1.5638e+00,  6.4180e-01, -2.9198e+00,        -inf],
          [ 1.4447e+00, -1.1034e+00, -3.0252e+00, -2.5456e+00]],

         [[ 2.9415e+00,        -inf,        -inf,        -inf],
          [ 1.0472e+00,  2.0469e+00,        -inf,        -inf],
          [ 8.5752e-01,  2.1487e+00,  3.8616e+00,        -inf],
          [ 2.8380e+00, -2.6176e+00, -2.6792e+00, -2.5543e-02]],

         [[ 4.6197e+00,        -inf,        -inf,        -inf],
          [ 3.6280e+00,  1.0409e+00,        -inf,        -inf],
          [ 3.5709e+00,  2.2635e+00,  2.8344e+00,        -inf],
          [ 1.5725e+00,  1.3418e+00,  1.6652e+00,  5.2272e-01]],

         [[ 1.9217e+00,        -inf,        -inf,        -inf],
          [-2.3165e+00, -3.2659e+00,        -inf,        -inf],
          [ 2.7748e+00, -2.2904e-01,  1.3720e+00,        -inf],
          [-4.4391e+00, -4.5237e+00,  1.6919e+00, -2.5140e+00]],

         [[ 5.3239e-01,        -inf,        -inf,        -inf],
          [-9.9577e-01, -3.7349e+00,        -inf,        -inf],
          [-1.4453e+00, -2.8332e+00,  4.9568e+00,        -inf],
          [-2.4428e+00, -6.7856e-01, -5.0243e-01, -2.6828e+00]],

         [[-5.5293e-01,        -inf,        -inf,        -inf],
          [ 2.0263e+00,  8.1711e-02,        -inf,        -inf],
          [-9.8457e-01, -3.4561e+00,  1.6718e-01,        -inf],
          [ 2.5783e+00, -2.1737e+00, -2.8780e+00,  1.1180e+00]],

         [[-1.5413e+00,        -inf,        -inf,        -inf],
          [ 2.6697e+00, -1.8380e+00,        -inf,        -inf],
          [-1.6130e-01, -2.5296e+00,  1.2860e+00,        -inf],
          [-1.9922e+00, -4.8566e+00,  9.2136e-01, -5.4695e-01]],

         [[-8.8316e-01,        -inf,        -inf,        -inf],
          [-9.1508e-01,  1.0906e+00,        -inf,        -inf],
          [-3.6841e+00, -2.9831e+00, -2.0458e+00,        -inf],
          [-1.3135e+00, -1.4377e+00, -6.5171e-01, -1.3958e+00]],

         [[ 2.1059e+00,        -inf,        -inf,        -inf],
          [ 3.6402e+00,  7.7802e-02,        -inf,        -inf],
          [-4.2782e-01, -3.3694e+00, -4.7158e+00,        -inf],
          [ 2.1698e+00,  2.4789e+00, -8.3494e-01, -1.8302e+00]],

         [[ 4.4005e-01,        -inf,        -inf,        -inf],
          [-1.7182e+00, -2.1112e+00,        -inf,        -inf],
          [-1.4818e+00, -2.4860e+00, -1.3939e+00,        -inf],
          [ 5.5218e-01,  1.2464e+00,  5.2223e-01, -2.0834e-01]],

         [[-6.5930e-01,        -inf,        -inf,        -inf],
          [-8.1934e-01,  3.1173e+00,        -inf,        -inf],
          [ 4.0642e-01,  2.8109e-01,  3.4380e+00,        -inf],
          [ 2.2103e+00, -1.1157e-01, -5.2361e-01,  2.3614e+00]],

         [[ 1.9972e+00,        -inf,        -inf,        -inf],
          [ 2.7867e-01,  5.9366e-02,        -inf,        -inf],
          [-3.6266e+00, -3.0055e+00, -4.0117e+00,        -inf],
          [ 1.2263e+00,  1.9126e+00, -3.4311e+00, -7.3255e-01]],

         [[ 6.4192e+00,        -inf,        -inf,        -inf],
          [ 7.1774e+00,  3.8229e+00,        -inf,        -inf],
          [ 8.4081e+00,  3.0496e+00,  2.4277e+00,        -inf],
          [ 8.6935e+00,  4.8272e+00,  4.1920e+00,  2.5335e+00]],

         [[ 1.8549e+00,        -inf,        -inf,        -inf],
          [-4.1764e+00, -2.0480e+00,        -inf,        -inf],
          [-3.4098e+00, -3.9224e+00, -7.7552e-01,        -inf],
          [-2.4234e+00, -2.5720e+00, -4.2877e-01, -6.5829e-01]],

         [[-4.3249e+00,        -inf,        -inf,        -inf],
          [-6.1155e+00,  1.0363e-01,        -inf,        -inf],
          [-7.2953e+00, -3.6211e+00, -3.6017e+00,        -inf],
          [ 3.8782e+00, -1.2876e+00, -4.5824e-01, -5.2490e-01]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 0.2192, -0.1542,  0.0028,  ...,  0.0970, -0.4530, -0.0104],
          [ 0.3111, -0.8556,  0.3045,  ...,  0.3717, -0.7557,  0.3078],
          [ 1.2570, -1.4870, -0.8740,  ...,  0.0221,  0.3636,  0.4115],
          ...,
          [-0.4177, -0.5397, -0.1572,  ..., -0.1709,  0.5951, -0.8704],
          [ 0.5303,  0.5063, -0.0621,  ...,  0.2978,  0.1734, -0.4988],
          [ 0.7789, -0.3485, -0.4004,  ...,  0.9911, -0.4541, -0.9192]],

         [[ 0.4554,  0.5006,  0.0157,  ..., -0.5623, -0.6748,  0.0566],
          [ 0.1833, -0.5041,  0.1794,  ...,  0.2190, -0.4453,  0.1814],
          [ 0.8416, -0.5291, -1.2161,  ..., -0.1729,  0.0033,  0.9176],
          ...,
          [-0.5192, -0.2043, -0.2004,  ..., -0.2522,  0.3395, -0.6891],
          [ 0.8030, -0.0359, -0.2258,  ...,  0.1841,  0.5838, -0.0128],
          [ 0.7882, -0.7424, -0.1176,  ...,  1.0342, -0.3036, -0.3966]],

         [[ 0.6360,  0.4363, -0.0952,  ..., -0.3249, -0.7554,  0.1930],
          [ 0.3352,  0.0768,  0.0443,  ...,  0.8212, -0.5170,  0.4866],
          [ 0.8378, -0.4175, -0.6989,  ..., -0.0247,  0.0033,  1.1926],
          ...,
          [-0.3780, -0.2614,  0.0734,  ..., -0.3413, -0.1105, -0.4711],
          [ 0.7076,  0.0911, -0.1314,  ..., -0.0227,  0.5957,  0.0965],
          [ 0.5298, -0.3610, -0.1923,  ...,  0.8936, -0.2348,  0.1144]],

         [[ 0.2769,  0.0206,  0.0152,  ..., -0.2874, -0.3139,  0.0498],
          [ 0.1186, -0.1161,  0.1043,  ...,  0.6991, -0.4454,  0.2730],
          [ 0.3140,  0.0421, -0.2033,  ...,  0.0058, -0.0731,  0.7843],
          ...,
          [-0.3447, -0.1384,  0.0808,  ..., -0.3311, -0.2176, -0.3367],
          [ 0.4289,  0.3305, -0.1076,  ...,  0.2444,  0.2968, -0.0114],
          [ 0.5714, -0.5880, -0.1854,  ...,  1.1490, -0.4251,  0.2009]]],


        [[[ 0.7656, -0.0556,  0.2223,  ...,  0.5946, -0.2912, -0.3458],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.9918, -1.1049, -0.4158,  ..., -0.1458,  0.0432,  1.5711],
          ...,
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.1421,  0.7391,  0.1949,  ...,  0.3759,  0.1222, -0.0284],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[ 0.6562,  0.6781, -0.1970,  ...,  0.0599, -0.0947, -0.4982],
          [ 0.1726, -0.4301,  0.1769,  ...,  0.5452, -0.4695,  0.3090],
          [ 0.7054, -0.7859, -0.2958,  ..., -0.1037,  0.0307,  1.1175],
          ...,
          [-0.0492, -0.0210, -0.1486,  ...,  0.4178,  1.1088, -0.6518],
          [ 0.1844, -0.1379,  0.0621,  ...,  0.7904,  0.2927, -0.4723],
          [ 0.3008, -0.4057,  0.1442,  ...,  0.7794,  0.4289, -0.2562]],

         [[ 0.5241,  0.4180, -0.2045,  ..., -0.2120, -0.2078, -0.4096],
          [-0.1333, -0.0850, -0.2712,  ...,  0.8956, -0.3848,  0.3410],
          [ 1.0450, -0.3661,  0.0426,  ..., -0.4564, -0.0655,  1.7222],
          ...,
          [ 0.1695, -0.0097, -0.1623,  ...,  0.3298,  0.8218, -0.4972],
          [ 0.4809,  0.3038,  0.1897,  ...,  0.3090,  0.3255,  0.4689],
          [-0.0755,  0.1756, -0.6327,  ...,  0.1792,  0.0154, -0.3682]],

         [[ 0.4231, -0.0804,  0.0391,  ..., -0.3910, -0.2831, -0.1695],
          [-0.1404, -0.0413, -0.2566,  ...,  0.6911, -0.4820,  0.1976],
          [ 0.9508, -0.1622,  0.0403,  ..., -0.0901, -0.2112,  1.2895],
          ...,
          [ 0.0366, -0.1392, -0.3294,  ...,  0.0532,  0.7854, -0.4021],
          [ 0.4689,  0.3071,  0.3194,  ...,  0.8349,  0.2685,  0.0300],
          [ 0.1155, -0.0404, -0.3657,  ...,  0.4635,  0.0392, -0.3370]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.2192, -0.1542,  0.0028,  ...,  0.9911, -0.4541, -0.9192],
         [ 0.4554,  0.5006,  0.0157,  ...,  1.0342, -0.3036, -0.3966],
         [ 0.6360,  0.4363, -0.0952,  ...,  0.8936, -0.2348,  0.1144],
         [ 0.2769,  0.0206,  0.0152,  ...,  1.1490, -0.4251,  0.2009]],

        [[ 0.7656, -0.0556,  0.2223,  ...,  0.0000,  0.0000,  0.0000],
         [ 0.6562,  0.6781, -0.1970,  ...,  0.7794,  0.4289, -0.2562],
         [ 0.5241,  0.4180, -0.2045,  ...,  0.1792,  0.0154, -0.3682],
         [ 0.4231, -0.0804,  0.0391,  ...,  0.4635,  0.0392, -0.3370]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.2129, -0.7931,  0.0920,  ..., -0.4295,  0.2092, -0.3842],
         [-0.1262, -0.3027, -0.1498,  ..., -0.3597,  0.2577, -0.3103],
         [-0.0026, -0.3564,  0.0456,  ..., -0.1730, -0.0401, -0.4395],
         [ 0.0284, -0.3830, -0.0870,  ..., -0.1485,  0.0635, -0.3789]],

        [[-0.5644, -0.4393,  0.2012,  ..., -0.3667,  0.4570, -0.1510],
         [-0.3945, -0.3376, -0.2162,  ...,  0.0895,  0.1369, -0.2606],
         [-0.2310, -0.3608, -0.1943,  ..., -0.0241, -0.0214, -0.1901],
         [-0.2168, -0.4301, -0.3206,  ..., -0.1863,  0.0613, -0.2100]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-3.3429,    -inf,    -inf,    -inf],
          [-5.6088,  5.0273,    -inf,    -inf],
          [-1.0703, -2.1181, -7.2557,    -inf],
          [ 1.2005, -1.5223, -2.7835,  0.2824]],

         [[ 0.4537,    -inf,    -inf,    -inf],
          [-0.2850,  0.9394,    -inf,    -inf],
          [-0.2862, -0.6827,  0.6445,    -inf],
          [-2.4092,  1.4180,  1.2368, -7.4037]],

         [[-0.0853,    -inf,    -inf,    -inf],
          [ 1.5122,  1.5452,    -inf,    -inf],
          [ 2.4774, -4.3056, -0.2684,    -inf],
          [ 4.8543,  1.4469,  1.2007,  0.5076]],

         [[ 0.6957,    -inf,    -inf,    -inf],
          [ 0.1945,  2.5244,    -inf,    -inf],
          [ 2.7918,  2.8467,  1.1046,    -inf],
          [ 1.5781,  0.3420,  4.0589, -0.0176]],

         [[ 3.2274,    -inf,    -inf,    -inf],
          [ 3.8116,  1.9579,    -inf,    -inf],
          [ 0.8789, -1.1521,  0.1273,    -inf],
          [ 2.3106,  0.4840,  2.0088, -1.0074]],

         [[-1.5685,    -inf,    -inf,    -inf],
          [ 1.6717,  2.0310,    -inf,    -inf],
          [ 0.8216,  1.1246, -1.1856,    -inf],
          [ 2.7873,  0.8993, -3.2327, -3.3161]],

         [[-3.4230,    -inf,    -inf,    -inf],
          [-1.7129, -3.7773,    -inf,    -inf],
          [ 0.0535, -2.2496, -0.1961,    -inf],
          [-1.8349, -1.8819, -1.1372, -2.5068]],

         [[ 1.3065,    -inf,    -inf,    -inf],
          [-3.6159, -1.8008,    -inf,    -inf],
          [-1.0206, -0.9176, -3.4605,    -inf],
          [ 0.9471,  0.4633, -2.9845,  1.1543]],

         [[ 2.0665,    -inf,    -inf,    -inf],
          [ 0.4438,  4.7248,    -inf,    -inf],
          [-3.9877,  2.1808, -0.1045,    -inf],
          [ 2.5534,  2.5471,  3.0410,  1.2944]],

         [[-1.5427,    -inf,    -inf,    -inf],
          [-5.8360, -2.8905,    -inf,    -inf],
          [-1.4461, -5.4810, -3.0184,    -inf],
          [-1.3932, -0.9678, -0.5912, -2.9148]],

         [[ 1.3040,    -inf,    -inf,    -inf],
          [ 2.8609,  2.2720,    -inf,    -inf],
          [ 4.0377,  1.3465,  1.0890,    -inf],
          [ 0.6565,  2.1439, -1.9675, -2.5891]],

         [[ 1.3285,    -inf,    -inf,    -inf],
          [ 1.0529, -0.3700,    -inf,    -inf],
          [-2.8086, -0.8010, -1.9147,    -inf],
          [ 3.1028, -2.0739,  0.6536,  4.2826]],

         [[-4.2261,    -inf,    -inf,    -inf],
          [ 0.8141, -0.5169,    -inf,    -inf],
          [ 1.2439, -1.2793,  1.3578,    -inf],
          [ 1.2544,  1.2089,  2.1078,  2.3539]],

         [[-1.1367,    -inf,    -inf,    -inf],
          [-4.0340, -2.4550,    -inf,    -inf],
          [-3.5470, -2.2690,  0.3948,    -inf],
          [ 2.6756,  2.4743,  6.9784,  4.1048]],

         [[ 3.9072,    -inf,    -inf,    -inf],
          [ 1.6620, -0.8900,    -inf,    -inf],
          [ 2.0480,  3.5946, -1.3847,    -inf],
          [-0.7188,  2.4068, -5.7875,  0.6087]],

         [[-0.1378,    -inf,    -inf,    -inf],
          [-0.4981, -2.0622,    -inf,    -inf],
          [ 0.1355, -1.3118,  0.2992,    -inf],
          [-0.3776,  2.7640,  5.5855,  1.7981]],

         [[-2.2204,    -inf,    -inf,    -inf],
          [-5.4093,  1.8937,    -inf,    -inf],
          [-4.7079,  2.8936, -0.7388,    -inf],
          [-4.6361,  4.2460,  5.0602,  1.3570]],

         [[ 2.0233,    -inf,    -inf,    -inf],
          [ 2.9321, -0.0326,    -inf,    -inf],
          [ 3.8079, -0.7769, -0.8201,    -inf],
          [ 3.9879, -0.6920,  1.1816, -0.3299]],

         [[-4.0404,    -inf,    -inf,    -inf],
          [-2.6481, -2.8253,    -inf,    -inf],
          [-3.4302,  1.2711, -1.6228,    -inf],
          [-1.7119,  0.7066, -1.3129, -0.1459]],

         [[ 2.0148,    -inf,    -inf,    -inf],
          [-1.7849,  1.5902,    -inf,    -inf],
          [-3.6322,  0.5683, -1.3716,    -inf],
          [ 2.6724,  2.0314, -1.3889, -3.7053]],

         [[-3.3666,    -inf,    -inf,    -inf],
          [ 2.1896,  4.7569,    -inf,    -inf],
          [-1.6575, -0.6545,  1.4955,    -inf],
          [ 7.6246,  7.5667,  9.3067,  9.3158]],

         [[ 1.6482,    -inf,    -inf,    -inf],
          [ 0.3567, -3.0634,    -inf,    -inf],
          [-1.8812,  1.0940, -2.3299,    -inf],
          [ 2.0383, -1.0519, -0.3283,  2.8782]],

         [[ 0.1324,    -inf,    -inf,    -inf],
          [-0.3855, -0.0789,    -inf,    -inf],
          [ 3.3592,  0.2358, -0.8755,    -inf],
          [-0.6981, -2.4391,  2.1764,  1.5487]],

         [[-0.7365,    -inf,    -inf,    -inf],
          [-0.9526, -1.1240,    -inf,    -inf],
          [ 1.4610,  2.2386,  0.9867,    -inf],
          [-2.1346, -0.1013, -0.4844,  1.5663]],

         [[ 0.9624,    -inf,    -inf,    -inf],
          [ 0.4995,  2.9524,    -inf,    -inf],
          [-1.6448,  0.3499,  4.3544,    -inf],
          [ 0.9749,  2.2870,  3.7207,  1.4854]]],


        [[[-4.4167,    -inf,    -inf,    -inf],
          [-0.7377, -1.3414,    -inf,    -inf],
          [-4.8706, -5.9672, -7.3180,    -inf],
          [-1.4137, -3.9086, -3.6698,  0.3194]],

         [[ 1.4338,    -inf,    -inf,    -inf],
          [-0.5834, -0.1252,    -inf,    -inf],
          [-5.4800, -1.3047,  0.8304,    -inf],
          [-2.8648, -3.0282,  0.4277, -4.0285]],

         [[ 3.5398,    -inf,    -inf,    -inf],
          [ 3.3273,  3.0859,    -inf,    -inf],
          [ 2.7619,  0.7982, -1.2750,    -inf],
          [ 3.0490, -1.6499, -1.5659, -2.9275]],

         [[ 2.3893,    -inf,    -inf,    -inf],
          [ 5.3729,  1.9625,    -inf,    -inf],
          [ 1.9558,  0.1372,  3.4883,    -inf],
          [ 5.9646, -0.3715,  6.1223,  3.9315]],

         [[ 2.5103,    -inf,    -inf,    -inf],
          [ 0.4722, -0.0949,    -inf,    -inf],
          [-1.4131,  1.7817,  1.1907,    -inf],
          [ 2.0820,  2.3482,  0.4481, -0.7142]],

         [[-1.9816,    -inf,    -inf,    -inf],
          [ 1.1621,  1.0041,    -inf,    -inf],
          [-2.4613, -2.0064, -3.6349,    -inf],
          [-0.2838,  1.0832, -2.1033,  3.5093]],

         [[-0.3254,    -inf,    -inf,    -inf],
          [-0.7552,  0.5728,    -inf,    -inf],
          [-5.4343,  0.6026, -3.5126,    -inf],
          [ 1.0842,  1.1908, -1.1108, -1.6222]],

         [[ 1.4565,    -inf,    -inf,    -inf],
          [ 2.3349,  0.4367,    -inf,    -inf],
          [ 0.9206, -1.3690, -4.4759,    -inf],
          [ 3.6650,  0.1658,  1.2349,  0.7629]],

         [[ 2.0198,    -inf,    -inf,    -inf],
          [ 1.2191,  0.0189,    -inf,    -inf],
          [-1.7693, -5.4979, -7.6770,    -inf],
          [-0.3257, -0.7266, -2.0814,  0.5965]],

         [[-6.1604,    -inf,    -inf,    -inf],
          [-2.9647,  0.2507,    -inf,    -inf],
          [-0.8036, -3.7901, -1.9016,    -inf],
          [-3.6166, -2.6775, -1.4588, -4.0903]],

         [[ 1.3351,    -inf,    -inf,    -inf],
          [ 4.7371,  0.9875,    -inf,    -inf],
          [ 1.1552, -3.7985, -3.5649,    -inf],
          [ 1.1720, -0.6516, -4.4827, -5.7268]],

         [[ 1.3566,    -inf,    -inf,    -inf],
          [-0.9483,  4.8074,    -inf,    -inf],
          [-1.2134,  3.8966,  0.3104,    -inf],
          [ 1.9266,  0.9567,  2.5034,  3.8274]],

         [[-3.0608,    -inf,    -inf,    -inf],
          [ 2.6799,  2.5917,    -inf,    -inf],
          [-2.5428, -0.8488, -0.0208,    -inf],
          [-1.1737,  2.0237,  1.9250,  3.9846]],

         [[ 0.7635,    -inf,    -inf,    -inf],
          [ 0.2219, -1.0583,    -inf,    -inf],
          [-0.0371, -2.3127, -2.5679,    -inf],
          [ 2.7032,  2.3367, -1.2098,  6.8411]],

         [[ 0.2142,    -inf,    -inf,    -inf],
          [-1.8678, -2.3993,    -inf,    -inf],
          [-1.7228, -3.3109, -0.0591,    -inf],
          [-2.1297, -4.9609,  1.0619, -2.2848]],

         [[-0.9370,    -inf,    -inf,    -inf],
          [-2.7212, -4.5422,    -inf,    -inf],
          [-4.3480, -4.1064, -4.7662,    -inf],
          [-2.8410, -1.5924,  0.8185,  0.9026]],

         [[-4.5853,    -inf,    -inf,    -inf],
          [-0.8307,  2.3925,    -inf,    -inf],
          [-0.6823, -0.3266,  0.8932,    -inf],
          [-2.7660, -0.6864,  4.4186, -0.0203]],

         [[-1.3510,    -inf,    -inf,    -inf],
          [ 2.4901,  0.4660,    -inf,    -inf],
          [-0.6877,  0.1545,  0.7215,    -inf],
          [-2.0104,  1.4167,  1.9836,  0.0448]],

         [[-3.3018,    -inf,    -inf,    -inf],
          [-1.1518, -1.1653,    -inf,    -inf],
          [-0.1153, -0.6110,  1.6184,    -inf],
          [-1.1649, -0.9817, -0.0659,  0.6824]],

         [[ 2.4140,    -inf,    -inf,    -inf],
          [ 0.1862, -0.8207,    -inf,    -inf],
          [ 1.9459, -1.6551,  2.2486,    -inf],
          [ 2.2511, -1.2861, -1.4103, -0.5590]],

         [[ 2.4456,    -inf,    -inf,    -inf],
          [ 1.3874,  4.9750,    -inf,    -inf],
          [ 0.4771,  2.0630, -0.9987,    -inf],
          [-0.0724,  2.2416, -2.9153,  0.5765]],

         [[-0.7142,    -inf,    -inf,    -inf],
          [-0.8766, -3.8497,    -inf,    -inf],
          [ 0.2112,  2.1370, -0.9650,    -inf],
          [-0.5780, -2.9075, -0.6211,  1.8577]],

         [[ 0.9480,    -inf,    -inf,    -inf],
          [ 2.8879, -3.9202,    -inf,    -inf],
          [ 1.8849, -1.4760,  1.4651,    -inf],
          [ 3.3236,  3.6682, -0.1367,  1.5181]],

         [[-0.4066,    -inf,    -inf,    -inf],
          [ 0.5535,  1.4270,    -inf,    -inf],
          [-0.3683,  1.4864, -0.8578,    -inf],
          [-1.6488,  1.1939, -0.5705,  4.3293]],

         [[-2.0931,    -inf,    -inf,    -inf],
          [-1.1671, -1.6482,    -inf,    -inf],
          [-3.6479, -2.8240, -1.3504,    -inf],
          [-5.7967, -4.7315, -2.3040, -1.2219]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-3.3429,    -inf,    -inf,    -inf],
          [-5.6088,  5.0273,    -inf,    -inf],
          [-1.0703, -2.1181, -7.2557,    -inf],
          [ 1.2005, -1.5223, -2.7835,  0.2824]],

         [[ 0.4537,    -inf,    -inf,    -inf],
          [-0.2850,  0.9394,    -inf,    -inf],
          [-0.2862, -0.6827,  0.6445,    -inf],
          [-2.4092,  1.4180,  1.2368, -7.4037]],

         [[-0.0853,    -inf,    -inf,    -inf],
          [ 1.5122,  1.5452,    -inf,    -inf],
          [ 2.4774, -4.3056, -0.2684,    -inf],
          [ 4.8543,  1.4469,  1.2007,  0.5076]],

         [[ 0.6957,    -inf,    -inf,    -inf],
          [ 0.1945,  2.5244,    -inf,    -inf],
          [ 2.7918,  2.8467,  1.1046,    -inf],
          [ 1.5781,  0.3420,  4.0589, -0.0176]],

         [[ 3.2274,    -inf,    -inf,    -inf],
          [ 3.8116,  1.9579,    -inf,    -inf],
          [ 0.8789, -1.1521,  0.1273,    -inf],
          [ 2.3106,  0.4840,  2.0088, -1.0074]],

         [[-1.5685,    -inf,    -inf,    -inf],
          [ 1.6717,  2.0310,    -inf,    -inf],
          [ 0.8216,  1.1246, -1.1856,    -inf],
          [ 2.7873,  0.8993, -3.2327, -3.3161]],

         [[-3.4230,    -inf,    -inf,    -inf],
          [-1.7129, -3.7773,    -inf,    -inf],
          [ 0.0535, -2.2496, -0.1961,    -inf],
          [-1.8349, -1.8819, -1.1372, -2.5068]],

         [[ 1.3065,    -inf,    -inf,    -inf],
          [-3.6159, -1.8008,    -inf,    -inf],
          [-1.0206, -0.9176, -3.4605,    -inf],
          [ 0.9471,  0.4633, -2.9845,  1.1543]],

         [[ 2.0665,    -inf,    -inf,    -inf],
          [ 0.4438,  4.7248,    -inf,    -inf],
          [-3.9877,  2.1808, -0.1045,    -inf],
          [ 2.5534,  2.5471,  3.0410,  1.2944]],

         [[-1.5427,    -inf,    -inf,    -inf],
          [-5.8360, -2.8905,    -inf,    -inf],
          [-1.4461, -5.4810, -3.0184,    -inf],
          [-1.3932, -0.9678, -0.5912, -2.9148]],

         [[ 1.3040,    -inf,    -inf,    -inf],
          [ 2.8609,  2.2720,    -inf,    -inf],
          [ 4.0377,  1.3465,  1.0890,    -inf],
          [ 0.6565,  2.1439, -1.9675, -2.5891]],

         [[ 1.3285,    -inf,    -inf,    -inf],
          [ 1.0529, -0.3700,    -inf,    -inf],
          [-2.8086, -0.8010, -1.9147,    -inf],
          [ 3.1028, -2.0739,  0.6536,  4.2826]],

         [[-4.2261,    -inf,    -inf,    -inf],
          [ 0.8141, -0.5169,    -inf,    -inf],
          [ 1.2439, -1.2793,  1.3578,    -inf],
          [ 1.2544,  1.2089,  2.1078,  2.3539]],

         [[-1.1367,    -inf,    -inf,    -inf],
          [-4.0340, -2.4550,    -inf,    -inf],
          [-3.5470, -2.2690,  0.3948,    -inf],
          [ 2.6756,  2.4743,  6.9784,  4.1048]],

         [[ 3.9072,    -inf,    -inf,    -inf],
          [ 1.6620, -0.8900,    -inf,    -inf],
          [ 2.0480,  3.5946, -1.3847,    -inf],
          [-0.7188,  2.4068, -5.7875,  0.6087]],

         [[-0.1378,    -inf,    -inf,    -inf],
          [-0.4981, -2.0622,    -inf,    -inf],
          [ 0.1355, -1.3118,  0.2992,    -inf],
          [-0.3776,  2.7640,  5.5855,  1.7981]],

         [[-2.2204,    -inf,    -inf,    -inf],
          [-5.4093,  1.8937,    -inf,    -inf],
          [-4.7079,  2.8936, -0.7388,    -inf],
          [-4.6361,  4.2460,  5.0602,  1.3570]],

         [[ 2.0233,    -inf,    -inf,    -inf],
          [ 2.9321, -0.0326,    -inf,    -inf],
          [ 3.8079, -0.7769, -0.8201,    -inf],
          [ 3.9879, -0.6920,  1.1816, -0.3299]],

         [[-4.0404,    -inf,    -inf,    -inf],
          [-2.6481, -2.8253,    -inf,    -inf],
          [-3.4302,  1.2711, -1.6228,    -inf],
          [-1.7119,  0.7066, -1.3129, -0.1459]],

         [[ 2.0148,    -inf,    -inf,    -inf],
          [-1.7849,  1.5902,    -inf,    -inf],
          [-3.6322,  0.5683, -1.3716,    -inf],
          [ 2.6724,  2.0314, -1.3889, -3.7053]],

         [[-3.3666,    -inf,    -inf,    -inf],
          [ 2.1896,  4.7569,    -inf,    -inf],
          [-1.6575, -0.6545,  1.4955,    -inf],
          [ 7.6246,  7.5667,  9.3067,  9.3158]],

         [[ 1.6482,    -inf,    -inf,    -inf],
          [ 0.3567, -3.0634,    -inf,    -inf],
          [-1.8812,  1.0940, -2.3299,    -inf],
          [ 2.0383, -1.0519, -0.3283,  2.8782]],

         [[ 0.1324,    -inf,    -inf,    -inf],
          [-0.3855, -0.0789,    -inf,    -inf],
          [ 3.3592,  0.2358, -0.8755,    -inf],
          [-0.6981, -2.4391,  2.1764,  1.5487]],

         [[-0.7365,    -inf,    -inf,    -inf],
          [-0.9526, -1.1240,    -inf,    -inf],
          [ 1.4610,  2.2386,  0.9867,    -inf],
          [-2.1346, -0.1013, -0.4844,  1.5663]],

         [[ 0.9624,    -inf,    -inf,    -inf],
          [ 0.4995,  2.9524,    -inf,    -inf],
          [-1.6448,  0.3499,  4.3544,    -inf],
          [ 0.9749,  2.2870,  3.7207,  1.4854]]],


        [[[-4.4167,    -inf,    -inf,    -inf],
          [-0.7377, -1.3414,    -inf,    -inf],
          [-4.8706, -5.9672, -7.3180,    -inf],
          [-1.4137, -3.9086, -3.6698,  0.3194]],

         [[ 1.4338,    -inf,    -inf,    -inf],
          [-0.5834, -0.1252,    -inf,    -inf],
          [-5.4800, -1.3047,  0.8304,    -inf],
          [-2.8648, -3.0282,  0.4277, -4.0285]],

         [[ 3.5398,    -inf,    -inf,    -inf],
          [ 3.3273,  3.0859,    -inf,    -inf],
          [ 2.7619,  0.7982, -1.2750,    -inf],
          [ 3.0490, -1.6499, -1.5659, -2.9275]],

         [[ 2.3893,    -inf,    -inf,    -inf],
          [ 5.3729,  1.9625,    -inf,    -inf],
          [ 1.9558,  0.1372,  3.4883,    -inf],
          [ 5.9646, -0.3715,  6.1223,  3.9315]],

         [[ 2.5103,    -inf,    -inf,    -inf],
          [ 0.4722, -0.0949,    -inf,    -inf],
          [-1.4131,  1.7817,  1.1907,    -inf],
          [ 2.0820,  2.3482,  0.4481, -0.7142]],

         [[-1.9816,    -inf,    -inf,    -inf],
          [ 1.1621,  1.0041,    -inf,    -inf],
          [-2.4613, -2.0064, -3.6349,    -inf],
          [-0.2838,  1.0832, -2.1033,  3.5093]],

         [[-0.3254,    -inf,    -inf,    -inf],
          [-0.7552,  0.5728,    -inf,    -inf],
          [-5.4343,  0.6026, -3.5126,    -inf],
          [ 1.0842,  1.1908, -1.1108, -1.6222]],

         [[ 1.4565,    -inf,    -inf,    -inf],
          [ 2.3349,  0.4367,    -inf,    -inf],
          [ 0.9206, -1.3690, -4.4759,    -inf],
          [ 3.6650,  0.1658,  1.2349,  0.7629]],

         [[ 2.0198,    -inf,    -inf,    -inf],
          [ 1.2191,  0.0189,    -inf,    -inf],
          [-1.7693, -5.4979, -7.6770,    -inf],
          [-0.3257, -0.7266, -2.0814,  0.5965]],

         [[-6.1604,    -inf,    -inf,    -inf],
          [-2.9647,  0.2507,    -inf,    -inf],
          [-0.8036, -3.7901, -1.9016,    -inf],
          [-3.6166, -2.6775, -1.4588, -4.0903]],

         [[ 1.3351,    -inf,    -inf,    -inf],
          [ 4.7371,  0.9875,    -inf,    -inf],
          [ 1.1552, -3.7985, -3.5649,    -inf],
          [ 1.1720, -0.6516, -4.4827, -5.7268]],

         [[ 1.3566,    -inf,    -inf,    -inf],
          [-0.9483,  4.8074,    -inf,    -inf],
          [-1.2134,  3.8966,  0.3104,    -inf],
          [ 1.9266,  0.9567,  2.5034,  3.8274]],

         [[-3.0608,    -inf,    -inf,    -inf],
          [ 2.6799,  2.5917,    -inf,    -inf],
          [-2.5428, -0.8488, -0.0208,    -inf],
          [-1.1737,  2.0237,  1.9250,  3.9846]],

         [[ 0.7635,    -inf,    -inf,    -inf],
          [ 0.2219, -1.0583,    -inf,    -inf],
          [-0.0371, -2.3127, -2.5679,    -inf],
          [ 2.7032,  2.3367, -1.2098,  6.8411]],

         [[ 0.2142,    -inf,    -inf,    -inf],
          [-1.8678, -2.3993,    -inf,    -inf],
          [-1.7228, -3.3109, -0.0591,    -inf],
          [-2.1297, -4.9609,  1.0619, -2.2848]],

         [[-0.9370,    -inf,    -inf,    -inf],
          [-2.7212, -4.5422,    -inf,    -inf],
          [-4.3480, -4.1064, -4.7662,    -inf],
          [-2.8410, -1.5924,  0.8185,  0.9026]],

         [[-4.5853,    -inf,    -inf,    -inf],
          [-0.8307,  2.3925,    -inf,    -inf],
          [-0.6823, -0.3266,  0.8932,    -inf],
          [-2.7660, -0.6864,  4.4186, -0.0203]],

         [[-1.3510,    -inf,    -inf,    -inf],
          [ 2.4901,  0.4660,    -inf,    -inf],
          [-0.6877,  0.1545,  0.7215,    -inf],
          [-2.0104,  1.4167,  1.9836,  0.0448]],

         [[-3.3018,    -inf,    -inf,    -inf],
          [-1.1518, -1.1653,    -inf,    -inf],
          [-0.1153, -0.6110,  1.6184,    -inf],
          [-1.1649, -0.9817, -0.0659,  0.6824]],

         [[ 2.4140,    -inf,    -inf,    -inf],
          [ 0.1862, -0.8207,    -inf,    -inf],
          [ 1.9459, -1.6551,  2.2486,    -inf],
          [ 2.2511, -1.2861, -1.4103, -0.5590]],

         [[ 2.4456,    -inf,    -inf,    -inf],
          [ 1.3874,  4.9750,    -inf,    -inf],
          [ 0.4771,  2.0630, -0.9987,    -inf],
          [-0.0724,  2.2416, -2.9153,  0.5765]],

         [[-0.7142,    -inf,    -inf,    -inf],
          [-0.8766, -3.8497,    -inf,    -inf],
          [ 0.2112,  2.1370, -0.9650,    -inf],
          [-0.5780, -2.9075, -0.6211,  1.8577]],

         [[ 0.9480,    -inf,    -inf,    -inf],
          [ 2.8879, -3.9202,    -inf,    -inf],
          [ 1.8849, -1.4760,  1.4651,    -inf],
          [ 3.3236,  3.6682, -0.1367,  1.5181]],

         [[-0.4066,    -inf,    -inf,    -inf],
          [ 0.5535,  1.4270,    -inf,    -inf],
          [-0.3683,  1.4864, -0.8578,    -inf],
          [-1.6488,  1.1939, -0.5705,  4.3293]],

         [[-2.0931,    -inf,    -inf,    -inf],
          [-1.1671, -1.6482,    -inf,    -inf],
          [-3.6479, -2.8240, -1.3504,    -inf],
          [-5.7967, -4.7315, -2.3040, -1.2219]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-8.5469e-01,  4.7514e-01, -2.4691e-01,  ...,  6.2559e-01,
            9.5117e-01,  1.0332e+00],
          [-4.8993e-01, -6.3519e-01,  4.7350e-01,  ..., -1.5544e-01,
           -2.2337e-01,  3.7967e-01],
          [ 8.6663e-01,  4.1813e-02,  1.8997e+00,  ..., -4.7902e-01,
            4.4419e-01, -8.5908e-01],
          ...,
          [-5.4843e-01,  9.9980e-01,  4.8631e-01,  ...,  2.1592e-01,
           -8.4764e-01,  5.2066e-01],
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 4.0765e-01,  8.0857e-01, -3.8381e-01,  ...,  6.1439e-01,
            2.3067e-01, -2.4706e-01]],

         [[-9.0478e-01,  1.0028e+00, -5.6329e-01,  ...,  3.8058e-01,
            3.5530e-01,  4.0955e-01],
          [-2.6994e-01, -3.6919e-01,  3.8322e-01,  ..., -1.0856e-01,
           -1.4201e-01,  6.0465e-01],
          [ 3.7401e-01,  4.1611e-01,  1.0518e+00,  ..., -3.4037e-01,
            3.9746e-01, -4.3109e-01],
          ...,
          [-7.0931e-01,  1.0985e+00,  1.3631e-02,  ...,  6.3984e-01,
           -3.0971e-01,  6.0549e-01],
          [-2.3430e-01,  2.6980e-01,  4.4979e-01,  ...,  6.5693e-01,
            4.4549e-01, -4.0443e-01],
          [ 4.6950e-01,  8.3675e-01,  2.6934e-02,  ..., -3.5911e-01,
           -1.1020e-01, -3.1742e-01]],

         [[-7.6241e-01,  8.7492e-01, -3.8610e-01,  ...,  4.6004e-01,
            4.5875e-01,  5.2950e-01],
          [-1.1418e-01, -4.1533e-01,  2.5083e-01,  ..., -4.8378e-02,
           -6.4398e-02,  4.9762e-01],
          [ 5.5140e-02,  1.8983e-01,  8.8322e-01,  ..., -4.8297e-01,
            1.2503e-01, -7.5066e-01],
          ...,
          [-4.4036e-01,  6.4748e-01,  5.9384e-02,  ...,  3.5366e-01,
           -2.6249e-01,  3.4184e-01],
          [-6.3708e-01,  6.7340e-02,  5.7186e-01,  ...,  4.3705e-01,
            6.4451e-01, -3.6421e-01],
          [ 4.0575e-01,  1.5292e+00,  4.0310e-01,  ..., -2.8026e-01,
           -2.9397e-01, -2.1222e-01]],

         [[-7.5923e-01,  7.0737e-01, -1.5800e-01,  ...,  2.1061e-01,
            1.4052e-01,  3.9708e-01],
          [-1.6291e-01, -3.8371e-01,  7.7475e-02,  ..., -5.0336e-02,
           -4.4388e-02,  4.7100e-01],
          [ 1.7997e-01,  7.1026e-03,  6.8856e-01,  ..., -4.4913e-01,
            5.8083e-02, -5.4122e-01],
          ...,
          [-2.0880e-01,  4.1056e-01, -3.9202e-02,  ...,  4.7900e-01,
           -1.6447e-01,  3.5569e-01],
          [-5.8001e-01, -1.0694e-01,  2.8555e-01,  ...,  1.8421e-01,
            3.2548e-01, -3.2317e-01],
          [ 1.7453e-01,  6.2090e-01,  7.3046e-02,  ..., -2.8577e-01,
            1.2748e-01, -2.6118e-01]]],


        [[[ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [ 1.2232e-01,  1.8850e-01, -7.4185e-01,  ..., -4.4359e-01,
           -4.2369e-01,  6.8086e-02],
          [ 7.0528e-02,  1.9214e-01,  8.8740e-01,  ..., -6.4700e-01,
            4.3114e-01, -4.1034e-02],
          ...,
          [-2.9151e-01,  1.1400e+00, -3.5019e-01,  ..., -2.1476e-01,
           -8.9050e-01,  3.6689e-01],
          [-5.2447e-01,  3.6704e-01,  9.2590e-02,  ...,  4.1607e-01,
            8.1109e-01,  4.8730e-01],
          [ 2.8151e-01,  1.1781e+00,  1.3416e-01,  ...,  7.2648e-01,
            7.2742e-01, -7.9975e-01]],

         [[-5.6997e-01,  1.4213e+00, -4.0174e-01,  ...,  1.8804e-01,
            9.9671e-02,  5.2063e-01],
          [ 4.1422e-01,  1.6097e-01, -3.4227e-01,  ..., -2.9542e-01,
           -1.0570e-01,  5.1277e-01],
          [-5.7689e-04, -3.5041e-02,  6.4315e-01,  ..., -6.4364e-01,
            6.0317e-01, -4.9506e-02],
          ...,
          [-5.7046e-01,  1.0140e+00, -5.3544e-01,  ..., -3.4040e-02,
           -6.7769e-01,  5.3868e-01],
          [-5.2850e-01,  3.2057e-01, -1.9356e-01,  ..., -1.7108e-01,
            4.6635e-03, -8.6995e-02],
          [ 3.8534e-01,  9.7352e-01,  2.9206e-01,  ...,  3.7574e-02,
            2.3229e-01, -6.0015e-01]],

         [[-3.3129e-01,  1.4924e+00, -3.5845e-01,  ...,  1.8830e-01,
            1.2933e-01,  5.0382e-01],
          [ 6.2675e-01,  5.9857e-02, -2.1523e-01,  ..., -9.6251e-02,
            4.9053e-01,  7.2382e-01],
          [-1.3243e-01,  1.6706e-01,  6.0909e-01,  ..., -6.0028e-01,
            4.3462e-01, -2.5615e-01],
          ...,
          [-6.1766e-01,  2.9791e-01, -2.7893e-01,  ...,  1.5213e-01,
           -1.7622e-01,  2.2156e-01],
          [-8.1167e-01,  4.7836e-01,  6.1520e-02,  ..., -1.2295e-01,
           -4.9320e-02, -4.7183e-02],
          [ 3.5825e-01,  1.0823e+00,  2.7758e-01,  ...,  3.8172e-01,
            2.3465e-01, -1.0157e+00]],

         [[-5.5319e-01,  1.2152e+00, -3.8515e-01,  ..., -9.3279e-02,
           -1.2911e-01,  3.8667e-01],
          [ 4.5449e-01,  4.0615e-02, -1.6706e-01,  ..., -6.7795e-02,
            3.6966e-01,  5.1939e-01],
          [-1.0664e-01,  1.6615e-01,  5.1966e-01,  ..., -4.8914e-01,
            3.3211e-01, -2.1667e-01],
          ...,
          [-9.1673e-01,  4.5879e-01, -2.1549e-01,  ...,  2.4300e-01,
           -6.0624e-01,  3.3311e-01],
          [-8.4994e-01,  3.7967e-01,  1.3106e-01,  ..., -3.3071e-01,
           -1.2275e-01,  7.2677e-02],
          [-3.3846e-02,  4.0724e-01,  3.9351e-01,  ..., -1.5666e-01,
            9.7875e-02, -9.2722e-02]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.8547,  0.4751, -0.2469,  ...,  0.6144,  0.2307, -0.2471],
         [-0.9048,  1.0028, -0.5633,  ..., -0.3591, -0.1102, -0.3174],
         [-0.7624,  0.8749, -0.3861,  ..., -0.2803, -0.2940, -0.2122],
         [-0.7592,  0.7074, -0.1580,  ..., -0.2858,  0.1275, -0.2612]],

        [[ 0.0000,  0.0000,  0.0000,  ...,  0.7265,  0.7274, -0.7997],
         [-0.5700,  1.4213, -0.4017,  ...,  0.0376,  0.2323, -0.6002],
         [-0.3313,  1.4924, -0.3585,  ...,  0.3817,  0.2347, -1.0157],
         [-0.5532,  1.2152, -0.3852,  ..., -0.1567,  0.0979, -0.0927]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.2181,  0.1827, -0.0286,  ...,  0.0522,  0.1495,  0.1506],
         [-0.0796, -0.0478,  0.0862,  ...,  0.2252,  0.4216, -0.0436],
         [-0.0597, -0.0134,  0.0840,  ...,  0.2836,  0.4505, -0.1754],
         [ 0.0167,  0.0400, -0.0483,  ...,  0.3514,  0.4454, -0.0457]],

        [[ 0.3266,  0.1398,  0.3916,  ..., -0.2731, -0.0492, -0.3061],
         [ 0.2783,  0.0902, -0.0135,  ...,  0.0217, -0.1185, -0.1653],
         [ 0.2365,  0.0977, -0.0107,  ...,  0.0138, -0.0156, -0.3201],
         [ 0.2551, -0.0556,  0.0372,  ...,  0.0180,  0.0133, -0.2890]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.3204,    -inf,    -inf,    -inf],
          [ 0.4606, -0.0277,    -inf,    -inf],
          [ 1.2817,  4.8368,  4.9859,    -inf],
          [ 4.4927,  7.0940,  4.3753,  0.9490]],

         [[ 2.7242,    -inf,    -inf,    -inf],
          [-0.9965, -3.4281,    -inf,    -inf],
          [ 0.5049,  1.3411, -3.7101,    -inf],
          [ 1.5409, -0.9963, -0.6185, -0.3012]],

         [[ 8.4039,    -inf,    -inf,    -inf],
          [ 0.6434,  1.1487,    -inf,    -inf],
          [ 1.1654, -2.6426,  0.7153,    -inf],
          [-0.5411,  0.0636,  1.6001, -1.6858]],

         [[ 6.4829,    -inf,    -inf,    -inf],
          [ 4.2965, -0.3343,    -inf,    -inf],
          [ 3.4329,  1.3987,  2.3792,    -inf],
          [ 2.8492, -0.2187, -0.1001, -1.0882]],

         [[-5.8484,    -inf,    -inf,    -inf],
          [-1.8103,  0.2218,    -inf,    -inf],
          [-1.6920, -0.9319, -0.5417,    -inf],
          [-3.2745, -5.1349, -0.9282, -3.5087]],

         [[-5.5375,    -inf,    -inf,    -inf],
          [-2.9850, -1.3072,    -inf,    -inf],
          [-2.7372, -1.8850, -2.4548,    -inf],
          [ 0.3193, -2.8479,  1.7273, -3.6521]],

         [[-1.0124,    -inf,    -inf,    -inf],
          [ 0.3408, -1.9852,    -inf,    -inf],
          [-0.4795, -1.2607,  0.6379,    -inf],
          [ 1.1209, -0.9258, -1.9560,  2.6145]],

         [[-1.3218,    -inf,    -inf,    -inf],
          [ 0.6878,  2.6096,    -inf,    -inf],
          [-2.1397, -3.8010, -1.2941,    -inf],
          [ 1.3831, -1.2717, -1.3082, -2.7075]],

         [[ 1.9432,    -inf,    -inf,    -inf],
          [ 0.8147,  0.9142,    -inf,    -inf],
          [-0.4517, -0.2676, -0.3211,    -inf],
          [-1.7451,  1.2721, -5.8632, -0.4973]],

         [[-1.8892,    -inf,    -inf,    -inf],
          [ 2.5188,  5.6076,    -inf,    -inf],
          [ 2.4087,  6.3460,  1.6642,    -inf],
          [-1.1079,  2.9126, -0.3207,  1.7099]],

         [[-0.7150,    -inf,    -inf,    -inf],
          [-3.5426, -2.2876,    -inf,    -inf],
          [ 2.5947,  4.7424, -2.0887,    -inf],
          [-1.8704,  1.0447, -1.8129,  0.6216]],

         [[ 1.7416,    -inf,    -inf,    -inf],
          [-0.8687, -3.4941,    -inf,    -inf],
          [-1.4549, -2.4789,  0.5715,    -inf],
          [-0.8632, -3.4725,  0.2025,  2.5921]],

         [[ 0.3623,    -inf,    -inf,    -inf],
          [ 1.0158, -7.2728,    -inf,    -inf],
          [ 1.0075, -2.1491, -0.3613,    -inf],
          [ 1.0814, -3.3576, -0.3210,  0.2917]],

         [[ 0.0281,    -inf,    -inf,    -inf],
          [-2.3417,  1.1576,    -inf,    -inf],
          [ 0.0418,  2.2706,  0.9991,    -inf],
          [-2.7368,  1.0739,  0.2391, -2.4702]],

         [[-0.5712,    -inf,    -inf,    -inf],
          [ 1.7088,  1.1326,    -inf,    -inf],
          [ 0.9369,  1.3384, -0.0794,    -inf],
          [-1.4239,  1.3710,  4.4381, -0.0932]],

         [[ 0.7345,    -inf,    -inf,    -inf],
          [-5.6268, -4.4608,    -inf,    -inf],
          [ 2.5530, -0.6188,  1.8332,    -inf],
          [ 5.1465,  0.9140,  4.1168,  1.2828]],

         [[ 0.5961,    -inf,    -inf,    -inf],
          [ 1.3501,  7.6090,    -inf,    -inf],
          [ 0.0892,  1.5120,  0.6473,    -inf],
          [-5.2809, -6.0496, -0.4846,  0.9264]],

         [[ 0.6856,    -inf,    -inf,    -inf],
          [-2.1002,  2.2301,    -inf,    -inf],
          [-1.0715,  3.0799,  0.3508,    -inf],
          [-0.5344,  0.8369, -0.6331, -0.8461]],

         [[-2.9107,    -inf,    -inf,    -inf],
          [-1.6955,  0.9048,    -inf,    -inf],
          [-2.6355,  0.4775,  0.7803,    -inf],
          [-0.3071, -0.6945, -0.7646,  3.3091]],

         [[ 0.0135,    -inf,    -inf,    -inf],
          [ 0.8064,  0.5764,    -inf,    -inf],
          [ 4.4786,  3.7852, -0.3629,    -inf],
          [ 4.1183,  2.5278,  3.2446,  2.6466]],

         [[ 2.9186,    -inf,    -inf,    -inf],
          [-0.0917, -0.2542,    -inf,    -inf],
          [-0.4032, -2.5301, -0.2792,    -inf],
          [ 4.8872,  2.1571,  3.6257,  3.7452]],

         [[ 6.0134,    -inf,    -inf,    -inf],
          [ 2.2591,  1.3019,    -inf,    -inf],
          [ 2.6462,  2.8088, -1.6475,    -inf],
          [-0.5093, -1.1381, -0.5432, -0.5569]],

         [[ 2.1677,    -inf,    -inf,    -inf],
          [-1.1328, -1.6933,    -inf,    -inf],
          [ 3.8818,  3.6948, -4.6251,    -inf],
          [ 3.2477,  0.5957,  0.2624,  0.3564]],

         [[-1.8413,    -inf,    -inf,    -inf],
          [ 1.0888, -1.4319,    -inf,    -inf],
          [-1.6677, -2.8468,  0.5359,    -inf],
          [ 1.7904, -1.8053,  2.7010,  1.1681]],

         [[ 1.6938,    -inf,    -inf,    -inf],
          [ 2.1611,  1.3472,    -inf,    -inf],
          [-0.4417, -1.8229,  0.7791,    -inf],
          [-0.5420, -1.9225,  1.6976, -2.1739]]],


        [[[ 2.1928,    -inf,    -inf,    -inf],
          [-2.3602, -2.0874,    -inf,    -inf],
          [ 0.7467,  2.5203,  1.1790,    -inf],
          [ 1.6092,  1.8132, -0.0690,  3.1812]],

         [[-1.6308,    -inf,    -inf,    -inf],
          [-1.5311, -0.7343,    -inf,    -inf],
          [-1.1595, -0.7035, -0.7159,    -inf],
          [-0.9239,  1.6835,  1.4171,  0.0126]],

         [[ 5.0300,    -inf,    -inf,    -inf],
          [ 5.6942,  3.0321,    -inf,    -inf],
          [ 1.2961,  0.7284,  0.9133,    -inf],
          [-1.3234, -0.1458,  2.1586, -3.9688]],

         [[ 5.1348,    -inf,    -inf,    -inf],
          [ 2.4101,  1.4227,    -inf,    -inf],
          [-2.6845, -0.7766,  0.9529,    -inf],
          [ 1.0789,  1.9826,  3.2542,  1.5064]],

         [[-3.2648,    -inf,    -inf,    -inf],
          [-1.7108,  1.6742,    -inf,    -inf],
          [-1.3223, -1.5656, -4.6571,    -inf],
          [-2.9841, -2.7154, -6.4691, -2.6750]],

         [[-4.1748,    -inf,    -inf,    -inf],
          [ 0.0455, -1.3844,    -inf,    -inf],
          [-4.1517, -1.5050, -0.9965,    -inf],
          [ 0.7512, -1.6934, -3.8860,  0.0397]],

         [[-2.0426,    -inf,    -inf,    -inf],
          [-0.6067, -3.4081,    -inf,    -inf],
          [ 1.1366,  1.8254,  3.8427,    -inf],
          [ 6.2700, -1.7929, -3.8674,  5.8170]],

         [[ 2.6206,    -inf,    -inf,    -inf],
          [ 1.7650,  1.8589,    -inf,    -inf],
          [ 0.5977, -4.1179, -3.6927,    -inf],
          [ 0.8128, -1.4789,  1.8564,  3.0566]],

         [[ 2.8892,    -inf,    -inf,    -inf],
          [-0.2989,  3.9473,    -inf,    -inf],
          [ 1.9115,  4.1176,  1.1025,    -inf],
          [-2.5282,  1.6303, -1.7363,  5.6735]],

         [[-0.7079,    -inf,    -inf,    -inf],
          [-0.3889, -0.5265,    -inf,    -inf],
          [ 3.5359,  5.8732,  3.2105,    -inf],
          [-1.1000,  0.4162,  2.7041,  3.3586]],

         [[-3.3353,    -inf,    -inf,    -inf],
          [-4.1859,  3.4837,    -inf,    -inf],
          [-1.3650,  1.5374, -5.6792,    -inf],
          [-0.7255, -1.6344,  0.9528,  4.1045]],

         [[ 2.0803,    -inf,    -inf,    -inf],
          [-3.3644, -4.1675,    -inf,    -inf],
          [ 0.9350, -1.6236,  2.0320,    -inf],
          [-2.2930, -6.0979, -2.4734, -1.5937]],

         [[ 1.5277,    -inf,    -inf,    -inf],
          [ 0.6575, -0.7592,    -inf,    -inf],
          [-0.8021, -1.5097, -0.3784,    -inf],
          [ 2.5175,  4.8172,  1.2184,  3.5045]],

         [[ 1.2570,    -inf,    -inf,    -inf],
          [-1.1405,  1.6198,    -inf,    -inf],
          [ 0.7660,  0.6369,  1.7592,    -inf],
          [ 0.3222, -2.0772, -2.7001, -1.2815]],

         [[-3.0075,    -inf,    -inf,    -inf],
          [-1.0320,  5.2210,    -inf,    -inf],
          [ 0.3130,  2.8929,  1.1740,    -inf],
          [-0.9345,  0.8492,  1.6425,  0.1458]],

         [[ 1.3016,    -inf,    -inf,    -inf],
          [-0.7334,  1.7640,    -inf,    -inf],
          [-0.9905,  2.9361,  2.5281,    -inf],
          [ 2.7136,  4.6670,  0.5151,  2.4143]],

         [[ 2.3255,    -inf,    -inf,    -inf],
          [-0.2845,  1.2967,    -inf,    -inf],
          [-6.3888, -2.6324,  3.6384,    -inf],
          [-6.9872, -4.6989,  2.6237, -4.3127]],

         [[ 0.5755,    -inf,    -inf,    -inf],
          [-0.6053, -0.9941,    -inf,    -inf],
          [-2.8854, -3.8158, -2.4581,    -inf],
          [-1.8862, -0.5072, -1.8745, -3.5360]],

         [[-2.8957,    -inf,    -inf,    -inf],
          [-1.6354, -1.5418,    -inf,    -inf],
          [-2.8760,  2.4157,  2.5250,    -inf],
          [ 1.9203,  1.1938,  5.2472,  5.6542]],

         [[ 1.4779,    -inf,    -inf,    -inf],
          [ 3.7783,  0.5511,    -inf,    -inf],
          [ 1.0090,  0.6167, -2.2789,    -inf],
          [-1.1547, -2.1087, -2.2544, -1.4616]],

         [[-0.6834,    -inf,    -inf,    -inf],
          [ 2.0168, -1.1165,    -inf,    -inf],
          [-1.1421,  1.6568, -0.4930,    -inf],
          [-0.3728, -1.3207, -3.0923,  1.7162]],

         [[ 1.4745,    -inf,    -inf,    -inf],
          [-1.0557, -0.7769,    -inf,    -inf],
          [ 3.9080,  2.2603, -4.8887,    -inf],
          [ 2.6921,  1.0163,  0.7649, -4.1490]],

         [[-0.9725,    -inf,    -inf,    -inf],
          [ 1.1584,  0.1606,    -inf,    -inf],
          [ 3.7628, -0.3485,  2.0488,    -inf],
          [ 5.3954,  4.6241,  2.9993,  1.3994]],

         [[-2.9444,    -inf,    -inf,    -inf],
          [ 3.6713, -0.3327,    -inf,    -inf],
          [ 0.2760, -1.4158, -2.5947,    -inf],
          [ 4.7503,  1.3452,  1.7093, -1.5578]],

         [[-0.6951,    -inf,    -inf,    -inf],
          [ 3.1942, -0.0145,    -inf,    -inf],
          [-0.6000,  0.2972,  0.2135,    -inf],
          [-1.6778, -3.2905, -2.0085, -2.3914]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 0.3204,    -inf,    -inf,    -inf],
          [ 0.4606, -0.0277,    -inf,    -inf],
          [ 1.2817,  4.8368,  4.9859,    -inf],
          [ 4.4927,  7.0940,  4.3753,  0.9490]],

         [[ 2.7242,    -inf,    -inf,    -inf],
          [-0.9965, -3.4281,    -inf,    -inf],
          [ 0.5049,  1.3411, -3.7101,    -inf],
          [ 1.5409, -0.9963, -0.6185, -0.3012]],

         [[ 8.4039,    -inf,    -inf,    -inf],
          [ 0.6434,  1.1487,    -inf,    -inf],
          [ 1.1654, -2.6426,  0.7153,    -inf],
          [-0.5411,  0.0636,  1.6001, -1.6858]],

         [[ 6.4829,    -inf,    -inf,    -inf],
          [ 4.2965, -0.3343,    -inf,    -inf],
          [ 3.4329,  1.3987,  2.3792,    -inf],
          [ 2.8492, -0.2187, -0.1001, -1.0882]],

         [[-5.8484,    -inf,    -inf,    -inf],
          [-1.8103,  0.2218,    -inf,    -inf],
          [-1.6920, -0.9319, -0.5417,    -inf],
          [-3.2745, -5.1349, -0.9282, -3.5087]],

         [[-5.5375,    -inf,    -inf,    -inf],
          [-2.9850, -1.3072,    -inf,    -inf],
          [-2.7372, -1.8850, -2.4548,    -inf],
          [ 0.3193, -2.8479,  1.7273, -3.6521]],

         [[-1.0124,    -inf,    -inf,    -inf],
          [ 0.3408, -1.9852,    -inf,    -inf],
          [-0.4795, -1.2607,  0.6379,    -inf],
          [ 1.1209, -0.9258, -1.9560,  2.6145]],

         [[-1.3218,    -inf,    -inf,    -inf],
          [ 0.6878,  2.6096,    -inf,    -inf],
          [-2.1397, -3.8010, -1.2941,    -inf],
          [ 1.3831, -1.2717, -1.3082, -2.7075]],

         [[ 1.9432,    -inf,    -inf,    -inf],
          [ 0.8147,  0.9142,    -inf,    -inf],
          [-0.4517, -0.2676, -0.3211,    -inf],
          [-1.7451,  1.2721, -5.8632, -0.4973]],

         [[-1.8892,    -inf,    -inf,    -inf],
          [ 2.5188,  5.6076,    -inf,    -inf],
          [ 2.4087,  6.3460,  1.6642,    -inf],
          [-1.1079,  2.9126, -0.3207,  1.7099]],

         [[-0.7150,    -inf,    -inf,    -inf],
          [-3.5426, -2.2876,    -inf,    -inf],
          [ 2.5947,  4.7424, -2.0887,    -inf],
          [-1.8704,  1.0447, -1.8129,  0.6216]],

         [[ 1.7416,    -inf,    -inf,    -inf],
          [-0.8687, -3.4941,    -inf,    -inf],
          [-1.4549, -2.4789,  0.5715,    -inf],
          [-0.8632, -3.4725,  0.2025,  2.5921]],

         [[ 0.3623,    -inf,    -inf,    -inf],
          [ 1.0158, -7.2728,    -inf,    -inf],
          [ 1.0075, -2.1491, -0.3613,    -inf],
          [ 1.0814, -3.3576, -0.3210,  0.2917]],

         [[ 0.0281,    -inf,    -inf,    -inf],
          [-2.3417,  1.1576,    -inf,    -inf],
          [ 0.0418,  2.2706,  0.9991,    -inf],
          [-2.7368,  1.0739,  0.2391, -2.4702]],

         [[-0.5712,    -inf,    -inf,    -inf],
          [ 1.7088,  1.1326,    -inf,    -inf],
          [ 0.9369,  1.3384, -0.0794,    -inf],
          [-1.4239,  1.3710,  4.4381, -0.0932]],

         [[ 0.7345,    -inf,    -inf,    -inf],
          [-5.6268, -4.4608,    -inf,    -inf],
          [ 2.5530, -0.6188,  1.8332,    -inf],
          [ 5.1465,  0.9140,  4.1168,  1.2828]],

         [[ 0.5961,    -inf,    -inf,    -inf],
          [ 1.3501,  7.6090,    -inf,    -inf],
          [ 0.0892,  1.5120,  0.6473,    -inf],
          [-5.2809, -6.0496, -0.4846,  0.9264]],

         [[ 0.6856,    -inf,    -inf,    -inf],
          [-2.1002,  2.2301,    -inf,    -inf],
          [-1.0715,  3.0799,  0.3508,    -inf],
          [-0.5344,  0.8369, -0.6331, -0.8461]],

         [[-2.9107,    -inf,    -inf,    -inf],
          [-1.6955,  0.9048,    -inf,    -inf],
          [-2.6355,  0.4775,  0.7803,    -inf],
          [-0.3071, -0.6945, -0.7646,  3.3091]],

         [[ 0.0135,    -inf,    -inf,    -inf],
          [ 0.8064,  0.5764,    -inf,    -inf],
          [ 4.4786,  3.7852, -0.3629,    -inf],
          [ 4.1183,  2.5278,  3.2446,  2.6466]],

         [[ 2.9186,    -inf,    -inf,    -inf],
          [-0.0917, -0.2542,    -inf,    -inf],
          [-0.4032, -2.5301, -0.2792,    -inf],
          [ 4.8872,  2.1571,  3.6257,  3.7452]],

         [[ 6.0134,    -inf,    -inf,    -inf],
          [ 2.2591,  1.3019,    -inf,    -inf],
          [ 2.6462,  2.8088, -1.6475,    -inf],
          [-0.5093, -1.1381, -0.5432, -0.5569]],

         [[ 2.1677,    -inf,    -inf,    -inf],
          [-1.1328, -1.6933,    -inf,    -inf],
          [ 3.8818,  3.6948, -4.6251,    -inf],
          [ 3.2477,  0.5957,  0.2624,  0.3564]],

         [[-1.8413,    -inf,    -inf,    -inf],
          [ 1.0888, -1.4319,    -inf,    -inf],
          [-1.6677, -2.8468,  0.5359,    -inf],
          [ 1.7904, -1.8053,  2.7010,  1.1681]],

         [[ 1.6938,    -inf,    -inf,    -inf],
          [ 2.1611,  1.3472,    -inf,    -inf],
          [-0.4417, -1.8229,  0.7791,    -inf],
          [-0.5420, -1.9225,  1.6976, -2.1739]]],


        [[[ 2.1928,    -inf,    -inf,    -inf],
          [-2.3602, -2.0874,    -inf,    -inf],
          [ 0.7467,  2.5203,  1.1790,    -inf],
          [ 1.6092,  1.8132, -0.0690,  3.1812]],

         [[-1.6308,    -inf,    -inf,    -inf],
          [-1.5311, -0.7343,    -inf,    -inf],
          [-1.1595, -0.7035, -0.7159,    -inf],
          [-0.9239,  1.6835,  1.4171,  0.0126]],

         [[ 5.0300,    -inf,    -inf,    -inf],
          [ 5.6942,  3.0321,    -inf,    -inf],
          [ 1.2961,  0.7284,  0.9133,    -inf],
          [-1.3234, -0.1458,  2.1586, -3.9688]],

         [[ 5.1348,    -inf,    -inf,    -inf],
          [ 2.4101,  1.4227,    -inf,    -inf],
          [-2.6845, -0.7766,  0.9529,    -inf],
          [ 1.0789,  1.9826,  3.2542,  1.5064]],

         [[-3.2648,    -inf,    -inf,    -inf],
          [-1.7108,  1.6742,    -inf,    -inf],
          [-1.3223, -1.5656, -4.6571,    -inf],
          [-2.9841, -2.7154, -6.4691, -2.6750]],

         [[-4.1748,    -inf,    -inf,    -inf],
          [ 0.0455, -1.3844,    -inf,    -inf],
          [-4.1517, -1.5050, -0.9965,    -inf],
          [ 0.7512, -1.6934, -3.8860,  0.0397]],

         [[-2.0426,    -inf,    -inf,    -inf],
          [-0.6067, -3.4081,    -inf,    -inf],
          [ 1.1366,  1.8254,  3.8427,    -inf],
          [ 6.2700, -1.7929, -3.8674,  5.8170]],

         [[ 2.6206,    -inf,    -inf,    -inf],
          [ 1.7650,  1.8589,    -inf,    -inf],
          [ 0.5977, -4.1179, -3.6927,    -inf],
          [ 0.8128, -1.4789,  1.8564,  3.0566]],

         [[ 2.8892,    -inf,    -inf,    -inf],
          [-0.2989,  3.9473,    -inf,    -inf],
          [ 1.9115,  4.1176,  1.1025,    -inf],
          [-2.5282,  1.6303, -1.7363,  5.6735]],

         [[-0.7079,    -inf,    -inf,    -inf],
          [-0.3889, -0.5265,    -inf,    -inf],
          [ 3.5359,  5.8732,  3.2105,    -inf],
          [-1.1000,  0.4162,  2.7041,  3.3586]],

         [[-3.3353,    -inf,    -inf,    -inf],
          [-4.1859,  3.4837,    -inf,    -inf],
          [-1.3650,  1.5374, -5.6792,    -inf],
          [-0.7255, -1.6344,  0.9528,  4.1045]],

         [[ 2.0803,    -inf,    -inf,    -inf],
          [-3.3644, -4.1675,    -inf,    -inf],
          [ 0.9350, -1.6236,  2.0320,    -inf],
          [-2.2930, -6.0979, -2.4734, -1.5937]],

         [[ 1.5277,    -inf,    -inf,    -inf],
          [ 0.6575, -0.7592,    -inf,    -inf],
          [-0.8021, -1.5097, -0.3784,    -inf],
          [ 2.5175,  4.8172,  1.2184,  3.5045]],

         [[ 1.2570,    -inf,    -inf,    -inf],
          [-1.1405,  1.6198,    -inf,    -inf],
          [ 0.7660,  0.6369,  1.7592,    -inf],
          [ 0.3222, -2.0772, -2.7001, -1.2815]],

         [[-3.0075,    -inf,    -inf,    -inf],
          [-1.0320,  5.2210,    -inf,    -inf],
          [ 0.3130,  2.8929,  1.1740,    -inf],
          [-0.9345,  0.8492,  1.6425,  0.1458]],

         [[ 1.3016,    -inf,    -inf,    -inf],
          [-0.7334,  1.7640,    -inf,    -inf],
          [-0.9905,  2.9361,  2.5281,    -inf],
          [ 2.7136,  4.6670,  0.5151,  2.4143]],

         [[ 2.3255,    -inf,    -inf,    -inf],
          [-0.2845,  1.2967,    -inf,    -inf],
          [-6.3888, -2.6324,  3.6384,    -inf],
          [-6.9872, -4.6989,  2.6237, -4.3127]],

         [[ 0.5755,    -inf,    -inf,    -inf],
          [-0.6053, -0.9941,    -inf,    -inf],
          [-2.8854, -3.8158, -2.4581,    -inf],
          [-1.8862, -0.5072, -1.8745, -3.5360]],

         [[-2.8957,    -inf,    -inf,    -inf],
          [-1.6354, -1.5418,    -inf,    -inf],
          [-2.8760,  2.4157,  2.5250,    -inf],
          [ 1.9203,  1.1938,  5.2472,  5.6542]],

         [[ 1.4779,    -inf,    -inf,    -inf],
          [ 3.7783,  0.5511,    -inf,    -inf],
          [ 1.0090,  0.6167, -2.2789,    -inf],
          [-1.1547, -2.1087, -2.2544, -1.4616]],

         [[-0.6834,    -inf,    -inf,    -inf],
          [ 2.0168, -1.1165,    -inf,    -inf],
          [-1.1421,  1.6568, -0.4930,    -inf],
          [-0.3728, -1.3207, -3.0923,  1.7162]],

         [[ 1.4745,    -inf,    -inf,    -inf],
          [-1.0557, -0.7769,    -inf,    -inf],
          [ 3.9080,  2.2603, -4.8887,    -inf],
          [ 2.6921,  1.0163,  0.7649, -4.1490]],

         [[-0.9725,    -inf,    -inf,    -inf],
          [ 1.1584,  0.1606,    -inf,    -inf],
          [ 3.7628, -0.3485,  2.0488,    -inf],
          [ 5.3954,  4.6241,  2.9993,  1.3994]],

         [[-2.9444,    -inf,    -inf,    -inf],
          [ 3.6713, -0.3327,    -inf,    -inf],
          [ 0.2760, -1.4158, -2.5947,    -inf],
          [ 4.7503,  1.3452,  1.7093, -1.5578]],

         [[-0.6951,    -inf,    -inf,    -inf],
          [ 3.1942, -0.0145,    -inf,    -inf],
          [-0.6000,  0.2972,  0.2135,    -inf],
          [-1.6778, -3.2905, -2.0085, -2.3914]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[ 3.7159e-01,  4.1297e-01, -1.0798e-01,  ..., -5.9186e-01,
            1.0524e+00,  6.1222e-01],
          [-9.0785e-03,  5.9492e-02,  2.8313e-01,  ...,  6.3721e-01,
           -5.7029e-02,  1.5211e+00],
          [-3.1118e-01, -7.3601e-01,  2.2672e-01,  ..., -1.1114e+00,
            3.9354e-01, -7.5015e-01],
          ...,
          [-6.1368e-01, -6.8819e-01, -1.0561e-01,  ...,  6.2651e-01,
            6.7597e-01, -2.0178e-01],
          [-4.0043e-01,  1.7683e-01,  1.9421e-01,  ...,  6.2137e-02,
           -5.4549e-01, -2.4387e-01],
          [-2.0358e-01,  9.0484e-01, -7.6881e-01,  ...,  9.1217e-02,
            1.9798e-01,  1.1055e-01]],

         [[ 2.1956e-01,  5.4475e-01, -2.7548e-01,  ..., -3.0903e-01,
            4.1980e-01,  7.1049e-01],
          [ 1.7278e-01,  6.1795e-01,  8.9337e-01,  ...,  2.1993e-01,
           -2.6203e-01,  1.3641e+00],
          [-2.8841e-02, -2.3817e-01,  1.5702e-01,  ..., -5.4873e-01,
            1.9808e-01, -8.0019e-01],
          ...,
          [-8.0375e-01, -4.2030e-01,  3.3266e-02,  ...,  5.5693e-01,
            5.0661e-01, -3.9794e-01],
          [-1.3563e-01,  1.6568e-01,  1.9118e-02,  ..., -1.2051e-01,
           -1.0398e-01, -7.5144e-02],
          [-1.0696e-01,  4.7541e-01, -4.0394e-01,  ...,  4.7927e-02,
            1.0402e-01,  5.8086e-02]],

         [[ 1.1137e-01,  3.5700e-01, -1.9653e-01,  ..., -1.4583e-01,
            1.5873e-01,  4.5395e-01],
          [-9.3918e-02, -1.0036e-02,  1.6945e-01,  ...,  1.7414e-01,
           -5.2471e-02,  6.3363e-01],
          [ 1.9355e-01, -2.4422e-01,  1.0544e-03,  ..., -2.9363e-01,
            2.7414e-01, -7.7998e-01],
          ...,
          [-6.9992e-01, -2.8720e-01, -1.5973e-02,  ...,  6.1197e-01,
            3.7563e-01, -4.5672e-01],
          [-1.0338e-01,  4.5167e-01, -3.8642e-02,  ...,  2.7408e-02,
           -6.1904e-02, -7.2557e-01],
          [ 6.0080e-02,  1.0704e+00, -5.3850e-01,  ...,  1.4156e-01,
            5.4289e-01,  1.0101e-01]],

         [[ 4.9476e-01,  4.2344e-01, -3.6199e-01,  ..., -9.0368e-02,
            5.1132e-01,  6.4588e-01],
          [ 1.2433e-01,  5.3873e-01,  4.1640e-01,  ...,  2.0246e-02,
           -2.9174e-01,  9.4261e-01],
          [ 2.0171e-01, -1.2575e-01, -1.4788e-02,  ..., -1.4611e-01,
            1.9412e-01, -6.2716e-01],
          ...,
          [-2.1533e-01, -1.2465e-01, -1.0440e-01,  ...,  4.0975e-01,
            1.4000e-01, -2.3501e-01],
          [-3.1024e-01,  3.7715e-01,  8.0114e-02,  ..., -1.3553e-01,
            1.2681e-01, -4.5687e-01],
          [ 4.8061e-02,  1.1255e+00, -5.2280e-01,  ...,  2.3496e-02,
            4.8631e-01,  6.7955e-03]]],


        [[[ 4.9620e-01, -1.0654e+00, -3.1197e-01,  ..., -9.7483e-01,
            4.8104e-01,  1.1555e+00],
          [-3.1693e-01, -1.0797e-01,  5.8730e-01,  ..., -4.6724e-01,
            5.1010e-01,  8.9908e-01],
          [-3.3010e-01, -1.1068e+00,  3.5365e-01,  ..., -5.6280e-01,
            2.1031e-01, -2.9179e-01],
          ...,
          [ 0.0000e+00,  0.0000e+00,  0.0000e+00,  ...,  0.0000e+00,
            0.0000e+00,  0.0000e+00],
          [-1.2421e+00, -5.2751e-01,  6.5651e-01,  ..., -1.6821e-02,
           -1.0762e+00, -3.0027e-02],
          [-7.2723e-01,  9.8169e-01, -3.1764e-02,  ..., -5.8722e-01,
            5.6639e-01, -7.2622e-02]],

         [[-9.7819e-02, -4.3393e-02, -3.5642e-01,  ...,  5.0430e-02,
           -7.3536e-02,  1.3043e-01],
          [-4.3488e-01,  4.0042e-01,  5.3278e-01,  ..., -9.5421e-01,
           -8.3168e-03,  1.1002e+00],
          [-3.9928e-01, -8.7472e-01,  2.5330e-01,  ..., -3.9839e-01,
            2.3283e-01, -8.9522e-02],
          ...,
          [-4.9948e-01, -5.6663e-02, -8.1328e-01,  ...,  5.7355e-01,
            5.6710e-01, -3.6035e-01],
          [-1.1620e+00, -6.9753e-01,  9.0740e-01,  ..., -3.7034e-01,
           -8.6679e-01, -1.8240e-01],
          [-7.3211e-01,  1.0058e+00,  6.9444e-02,  ..., -3.7355e-01,
            3.2903e-01, -4.8121e-01]],

         [[ 2.7229e-02, -4.3073e-01, -8.1687e-01,  ..., -4.5119e-01,
            1.5302e-01,  2.9439e-01],
          [-4.1450e-01,  9.4637e-02,  4.5728e-01,  ..., -5.3159e-01,
           -1.4320e-02,  6.0138e-01],
          [-5.1855e-01, -7.1417e-01,  3.2793e-02,  ..., -7.3931e-02,
            7.0016e-01, -9.8789e-02],
          ...,
          [ 8.9623e-02, -1.5711e-01, -7.0384e-01,  ...,  3.4991e-01,
            5.5626e-01, -2.6213e-01],
          [-7.2136e-01, -6.0255e-01,  8.5977e-01,  ..., -5.2100e-01,
           -1.0338e+00, -7.1612e-01],
          [-7.3351e-01,  1.0541e+00,  3.0113e-01,  ..., -2.1580e-01,
            4.4721e-01, -3.7819e-01]],

         [[ 1.5037e-01, -4.0537e-01, -7.5325e-01,  ..., -4.4752e-01,
            2.9108e-01,  1.1953e-01],
          [-2.0729e-01,  3.0489e-01,  4.5168e-01,  ..., -5.4987e-01,
            1.6914e-01,  7.7063e-01],
          [-5.8109e-01, -6.8735e-01, -4.2682e-02,  ..., -1.4436e-02,
            7.0871e-01, -6.0078e-02],
          ...,
          [-3.4050e-01, -4.6720e-02, -9.9571e-01,  ...,  6.3700e-01,
            5.3211e-01, -2.2910e-02],
          [-7.0306e-01, -6.0464e-01,  7.3694e-01,  ..., -5.0229e-01,
           -9.1441e-01, -5.4810e-01],
          [-4.6241e-01,  8.5528e-01,  9.9143e-02,  ...,  1.2386e-02,
            5.3868e-01, -2.2130e-02]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[ 0.3716,  0.4130, -0.1080,  ...,  0.0912,  0.1980,  0.1106],
         [ 0.2196,  0.5447, -0.2755,  ...,  0.0479,  0.1040,  0.0581],
         [ 0.1114,  0.3570, -0.1965,  ...,  0.1416,  0.5429,  0.1010],
         [ 0.4948,  0.4234, -0.3620,  ...,  0.0235,  0.4863,  0.0068]],

        [[ 0.4962, -1.0654, -0.3120,  ..., -0.5872,  0.5664, -0.0726],
         [-0.0978, -0.0434, -0.3564,  ..., -0.3735,  0.3290, -0.4812],
         [ 0.0272, -0.4307, -0.8169,  ..., -0.2158,  0.4472, -0.3782],
         [ 0.1504, -0.4054, -0.7532,  ...,  0.0124,  0.5387, -0.0221]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[ 0.0626,  0.0014, -0.2642,  ..., -0.2642, -0.0554,  0.5263],
         [ 0.3615, -0.0248, -0.2526,  ...,  0.2731, -0.0408,  0.1915],
         [ 0.1928, -0.0912, -0.3306,  ...,  0.3285,  0.0869,  0.3271],
         [ 0.1411, -0.1797, -0.2198,  ...,  0.2246, -0.0599,  0.1660]],

        [[-0.0730, -0.3547, -0.0426,  ..., -0.2694, -0.1587,  0.4450],
         [ 0.0695, -0.4013,  0.0562,  ..., -0.1347, -0.0633,  0.3970],
         [ 0.1029, -0.3804, -0.2380,  ..., -0.0504, -0.1396,  0.3629],
         [ 0.1524, -0.3439, -0.0444,  ...,  0.0016,  0.1096,  0.1906]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.3052,    -inf,    -inf,    -inf],
          [-0.6631, -2.3486,    -inf,    -inf],
          [-0.0854, -1.4915, -0.3135,    -inf],
          [-1.1263, -5.5493,  1.5484,  2.2994]],

         [[ 1.7134,    -inf,    -inf,    -inf],
          [ 1.6155,  1.0484,    -inf,    -inf],
          [-1.4106,  1.5722,  0.8754,    -inf],
          [ 0.3479,  5.2191,  4.1156,  2.0907]],

         [[-0.3476,    -inf,    -inf,    -inf],
          [-1.7741, -2.2496,    -inf,    -inf],
          [-3.3515, -2.4174, -0.9641,    -inf],
          [-4.8896,  0.7903, -0.1080, -0.6307]],

         [[ 1.9145,    -inf,    -inf,    -inf],
          [ 0.0380, -0.2156,    -inf,    -inf],
          [ 1.1439,  0.1097, -1.3644,    -inf],
          [-0.8806, -5.2294, -1.2365, -1.5893]],

         [[-1.5904,    -inf,    -inf,    -inf],
          [-2.8280,  1.5937,    -inf,    -inf],
          [ 2.0909,  5.0565,  1.9909,    -inf],
          [ 1.2081,  2.1489,  4.1645,  1.2885]],

         [[-0.5455,    -inf,    -inf,    -inf],
          [ 0.2735,  0.0150,    -inf,    -inf],
          [-0.4422, -0.9562,  0.4568,    -inf],
          [ 2.3139,  0.0544,  2.7261, -1.3490]],

         [[ 4.0012,    -inf,    -inf,    -inf],
          [-0.1589, -2.5882,    -inf,    -inf],
          [-1.1695, -3.3942, -3.0634,    -inf],
          [ 0.7156, -1.7705,  1.3061, -2.7765]],

         [[ 2.6392,    -inf,    -inf,    -inf],
          [ 0.8464,  2.2779,    -inf,    -inf],
          [ 2.0213,  1.1672,  5.0073,    -inf],
          [-3.1567, -3.0804, -1.3914,  0.1225]],

         [[-3.1870,    -inf,    -inf,    -inf],
          [ 0.4990,  0.0684,    -inf,    -inf],
          [-1.6989, -2.5545,  3.8323,    -inf],
          [ 2.0574, -4.1223,  0.3854,  0.3211]],

         [[ 1.3230,    -inf,    -inf,    -inf],
          [ 2.0093, -5.5743,    -inf,    -inf],
          [-0.8003, -2.1588, -2.0313,    -inf],
          [ 4.6602, -1.4281, -2.0939, -1.6036]],

         [[-0.1005,    -inf,    -inf,    -inf],
          [ 0.5435, -1.1900,    -inf,    -inf],
          [-0.7221,  1.5537, -3.5787,    -inf],
          [-3.5109, -0.6351, -4.3903, -3.3545]],

         [[-0.1519,    -inf,    -inf,    -inf],
          [ 2.4043,  1.0332,    -inf,    -inf],
          [-0.2489,  3.0921,  0.9467,    -inf],
          [ 0.2149,  1.8066, -3.2990,  0.3543]],

         [[-2.0942,    -inf,    -inf,    -inf],
          [-4.2956, -1.5999,    -inf,    -inf],
          [-5.5936, -1.8477, -0.3036,    -inf],
          [-1.3548, -1.0886, -2.9511,  0.9936]],

         [[-0.4301,    -inf,    -inf,    -inf],
          [ 0.7211, -1.6937,    -inf,    -inf],
          [-2.9434, -3.9007, -1.0826,    -inf],
          [-1.5015, -0.7122, -0.7522, -1.2561]],

         [[ 3.1368,    -inf,    -inf,    -inf],
          [ 5.0084,  2.4388,    -inf,    -inf],
          [ 1.3406,  2.7830,  2.6256,    -inf],
          [ 4.9647,  0.1813,  3.6936, -0.7078]],

         [[-3.2691,    -inf,    -inf,    -inf],
          [-2.3677, -2.5763,    -inf,    -inf],
          [ 0.3178, -1.7855,  0.8570,    -inf],
          [-0.3238,  0.4492,  1.5537, -1.0240]],

         [[-1.8441,    -inf,    -inf,    -inf],
          [-0.7390,  4.5223,    -inf,    -inf],
          [ 3.4504,  2.0674,  3.4053,    -inf],
          [ 4.1406,  1.5513,  6.4953,  1.5674]],

         [[-3.0406,    -inf,    -inf,    -inf],
          [-2.5462, -1.5620,    -inf,    -inf],
          [-4.1041,  1.1093, -8.4036,    -inf],
          [-0.2703,  2.0400, -2.7381,  1.1761]],

         [[ 1.8860,    -inf,    -inf,    -inf],
          [ 1.7727,  1.9643,    -inf,    -inf],
          [ 2.4772,  2.8921, -1.6258,    -inf],
          [-1.5887, -3.0692, -3.7542, -2.7499]],

         [[-1.0558,    -inf,    -inf,    -inf],
          [ 0.2051, -0.3134,    -inf,    -inf],
          [ 2.9489,  2.6706,  0.3120,    -inf],
          [-2.6366, -0.7583,  0.5380, -3.4216]],

         [[-1.3828,    -inf,    -inf,    -inf],
          [ 0.3702, -0.3414,    -inf,    -inf],
          [ 1.0060,  4.4011,  3.0111,    -inf],
          [ 0.6337,  0.6297,  2.0546, -3.7865]],

         [[ 1.0079,    -inf,    -inf,    -inf],
          [-5.0591, -2.9276,    -inf,    -inf],
          [-1.0221, -0.9845,  0.9340,    -inf],
          [-3.1283, -0.4593,  2.1296, -0.3294]],

         [[ 0.9501,    -inf,    -inf,    -inf],
          [ 1.6324,  0.2254,    -inf,    -inf],
          [ 2.6227,  1.0913,  3.9802,    -inf],
          [ 2.1805,  4.0952,  2.3599, -0.1252]],

         [[-1.3282,    -inf,    -inf,    -inf],
          [-0.6738,  1.3010,    -inf,    -inf],
          [-5.3028, -1.4067,  1.4845,    -inf],
          [-0.3024,  0.1473,  1.3821, -0.0872]],

         [[ 4.9486,    -inf,    -inf,    -inf],
          [ 2.2408,  1.5239,    -inf,    -inf],
          [ 1.4430, -1.6418, -2.5802,    -inf],
          [ 1.6616, -2.4833, -1.0881, -2.1031]]],


        [[[-2.5792,    -inf,    -inf,    -inf],
          [ 0.7556,  2.3441,    -inf,    -inf],
          [ 0.4620,  3.2765,  4.4485,    -inf],
          [ 0.0639,  0.1379,  3.0964,  4.8386]],

         [[-2.0575,    -inf,    -inf,    -inf],
          [-1.1964, -1.2015,    -inf,    -inf],
          [-3.2777,  2.0131,  2.6595,    -inf],
          [-4.0580,  6.4962,  1.0332,  2.3592]],

         [[-6.1562,    -inf,    -inf,    -inf],
          [-7.0613, -1.4705,    -inf,    -inf],
          [-4.2171,  1.6187, -2.7699,    -inf],
          [-6.5903, -0.8237,  3.3388,  1.4146]],

         [[ 1.7650,    -inf,    -inf,    -inf],
          [-0.0186,  0.9950,    -inf,    -inf],
          [ 0.9407,  1.7290,  0.9622,    -inf],
          [ 2.3805,  0.9763, -3.5688, -1.3469]],

         [[-0.6895,    -inf,    -inf,    -inf],
          [-4.1186, -3.2005,    -inf,    -inf],
          [ 2.0278,  2.2093,  0.2033,    -inf],
          [ 0.1820, -0.6320,  0.1621,  2.3975]],

         [[ 1.0402,    -inf,    -inf,    -inf],
          [ 1.0542, -0.3430,    -inf,    -inf],
          [ 3.2027, -0.0559,  0.5422,    -inf],
          [ 3.5168,  0.8690,  2.0506,  0.5078]],

         [[ 1.4982,    -inf,    -inf,    -inf],
          [-0.6515,  3.2850,    -inf,    -inf],
          [ 1.5878,  2.5710,  0.4058,    -inf],
          [-0.8154,  2.3441,  0.1889,  3.2036]],

         [[ 3.0032,    -inf,    -inf,    -inf],
          [ 0.8055,  3.0083,    -inf,    -inf],
          [ 0.7812,  3.1939,  4.4590,    -inf],
          [ 4.0264,  3.1343,  2.1649, -1.5347]],

         [[ 0.6375,    -inf,    -inf,    -inf],
          [ 3.8270,  1.5379,    -inf,    -inf],
          [ 2.1370,  1.2363, -0.1474,    -inf],
          [ 8.1534,  1.8977,  2.6658, -2.7675]],

         [[-3.9591,    -inf,    -inf,    -inf],
          [-3.1373, -4.2275,    -inf,    -inf],
          [-6.7072, -5.7948, -6.8583,    -inf],
          [-3.1538, -3.7755, -2.4775, -1.9014]],

         [[ 1.7735,    -inf,    -inf,    -inf],
          [-1.9414, -0.8935,    -inf,    -inf],
          [ 2.7621,  1.4483,  1.0791,    -inf],
          [-0.6068,  0.6203,  1.5410,  0.4169]],

         [[-0.2734,    -inf,    -inf,    -inf],
          [ 3.2916,  4.1881,    -inf,    -inf],
          [ 0.0303,  3.5398,  0.0155,    -inf],
          [-0.4176,  0.7973,  5.7659,  6.2240]],

         [[-4.4827,    -inf,    -inf,    -inf],
          [-4.2149,  0.1131,    -inf,    -inf],
          [-2.5108, -3.6305, -0.6388,    -inf],
          [ 0.4230, -1.6648, -0.6728,  0.5940]],

         [[-0.1470,    -inf,    -inf,    -inf],
          [ 2.4483,  2.2580,    -inf,    -inf],
          [ 3.0440,  2.7018, -0.1158,    -inf],
          [ 2.3538,  1.2283, -2.2822,  2.5587]],

         [[-3.3333,    -inf,    -inf,    -inf],
          [ 1.4121, -2.8214,    -inf,    -inf],
          [-0.6875, -1.4852,  1.1309,    -inf],
          [ 0.0288, -0.5512, -1.6094, -3.4571]],

         [[-2.1504,    -inf,    -inf,    -inf],
          [-2.6323, -1.4779,    -inf,    -inf],
          [ 2.6204, -1.2163, -2.5212,    -inf],
          [ 0.2667, -0.9969,  0.0577, -0.4040]],

         [[ 1.9692,    -inf,    -inf,    -inf],
          [-0.6171,  3.3691,    -inf,    -inf],
          [ 7.7850,  7.2164,  2.4354,    -inf],
          [ 5.4357, -0.3016,  2.1574,  1.0872]],

         [[-4.5525,    -inf,    -inf,    -inf],
          [-2.5466, -1.0394,    -inf,    -inf],
          [-4.9342, -2.4974, -7.0172,    -inf],
          [ 0.2760,  2.8282, -2.3031,  3.7750]],

         [[ 1.6353,    -inf,    -inf,    -inf],
          [ 5.4617,  2.8699,    -inf,    -inf],
          [ 2.8249,  2.3971,  0.2018,    -inf],
          [ 2.1884,  2.0648, -0.8523, -1.1167]],

         [[-1.7455,    -inf,    -inf,    -inf],
          [ 4.5535,  3.5231,    -inf,    -inf],
          [ 2.7638, -0.2214, -0.6860,    -inf],
          [ 1.4071,  0.2957,  0.5958, -4.2540]],

         [[ 0.4506,    -inf,    -inf,    -inf],
          [ 1.5025,  0.3386,    -inf,    -inf],
          [ 2.7513,  2.6770, -0.9482,    -inf],
          [-2.2426,  3.7954,  2.9912,  3.8275]],

         [[-0.9267,    -inf,    -inf,    -inf],
          [-0.4888,  0.9464,    -inf,    -inf],
          [ 1.3219,  1.1642, -3.6896,    -inf],
          [-0.1501,  2.2457,  0.4849,  3.9153]],

         [[ 2.7963,    -inf,    -inf,    -inf],
          [ 1.6695, -0.7549,    -inf,    -inf],
          [-0.7153,  0.9337, -0.7299,    -inf],
          [ 8.4514,  3.6314,  4.2465, -0.1355]],

         [[ 0.0448,    -inf,    -inf,    -inf],
          [ 2.7967,  0.6952,    -inf,    -inf],
          [ 3.1870, -0.6803,  4.8852,    -inf],
          [ 2.3098, -2.1547,  5.3847,  0.8166]],

         [[ 4.8978,    -inf,    -inf,    -inf],
          [-0.3721, -1.6927,    -inf,    -inf],
          [ 4.3840, -1.9705, -0.5245,    -inf],
          [-0.5252,  0.0811, -3.6753,  2.8511]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[-1.3052,    -inf,    -inf,    -inf],
          [-0.6631, -2.3486,    -inf,    -inf],
          [-0.0854, -1.4915, -0.3135,    -inf],
          [-1.1263, -5.5493,  1.5484,  2.2994]],

         [[ 1.7134,    -inf,    -inf,    -inf],
          [ 1.6155,  1.0484,    -inf,    -inf],
          [-1.4106,  1.5722,  0.8754,    -inf],
          [ 0.3479,  5.2191,  4.1156,  2.0907]],

         [[-0.3476,    -inf,    -inf,    -inf],
          [-1.7741, -2.2496,    -inf,    -inf],
          [-3.3515, -2.4174, -0.9641,    -inf],
          [-4.8896,  0.7903, -0.1080, -0.6307]],

         [[ 1.9145,    -inf,    -inf,    -inf],
          [ 0.0380, -0.2156,    -inf,    -inf],
          [ 1.1439,  0.1097, -1.3644,    -inf],
          [-0.8806, -5.2294, -1.2365, -1.5893]],

         [[-1.5904,    -inf,    -inf,    -inf],
          [-2.8280,  1.5937,    -inf,    -inf],
          [ 2.0909,  5.0565,  1.9909,    -inf],
          [ 1.2081,  2.1489,  4.1645,  1.2885]],

         [[-0.5455,    -inf,    -inf,    -inf],
          [ 0.2735,  0.0150,    -inf,    -inf],
          [-0.4422, -0.9562,  0.4568,    -inf],
          [ 2.3139,  0.0544,  2.7261, -1.3490]],

         [[ 4.0012,    -inf,    -inf,    -inf],
          [-0.1589, -2.5882,    -inf,    -inf],
          [-1.1695, -3.3942, -3.0634,    -inf],
          [ 0.7156, -1.7705,  1.3061, -2.7765]],

         [[ 2.6392,    -inf,    -inf,    -inf],
          [ 0.8464,  2.2779,    -inf,    -inf],
          [ 2.0213,  1.1672,  5.0073,    -inf],
          [-3.1567, -3.0804, -1.3914,  0.1225]],

         [[-3.1870,    -inf,    -inf,    -inf],
          [ 0.4990,  0.0684,    -inf,    -inf],
          [-1.6989, -2.5545,  3.8323,    -inf],
          [ 2.0574, -4.1223,  0.3854,  0.3211]],

         [[ 1.3230,    -inf,    -inf,    -inf],
          [ 2.0093, -5.5743,    -inf,    -inf],
          [-0.8003, -2.1588, -2.0313,    -inf],
          [ 4.6602, -1.4281, -2.0939, -1.6036]],

         [[-0.1005,    -inf,    -inf,    -inf],
          [ 0.5435, -1.1900,    -inf,    -inf],
          [-0.7221,  1.5537, -3.5787,    -inf],
          [-3.5109, -0.6351, -4.3903, -3.3545]],

         [[-0.1519,    -inf,    -inf,    -inf],
          [ 2.4043,  1.0332,    -inf,    -inf],
          [-0.2489,  3.0921,  0.9467,    -inf],
          [ 0.2149,  1.8066, -3.2990,  0.3543]],

         [[-2.0942,    -inf,    -inf,    -inf],
          [-4.2956, -1.5999,    -inf,    -inf],
          [-5.5936, -1.8477, -0.3036,    -inf],
          [-1.3548, -1.0886, -2.9511,  0.9936]],

         [[-0.4301,    -inf,    -inf,    -inf],
          [ 0.7211, -1.6937,    -inf,    -inf],
          [-2.9434, -3.9007, -1.0826,    -inf],
          [-1.5015, -0.7122, -0.7522, -1.2561]],

         [[ 3.1368,    -inf,    -inf,    -inf],
          [ 5.0084,  2.4388,    -inf,    -inf],
          [ 1.3406,  2.7830,  2.6256,    -inf],
          [ 4.9647,  0.1813,  3.6936, -0.7078]],

         [[-3.2691,    -inf,    -inf,    -inf],
          [-2.3677, -2.5763,    -inf,    -inf],
          [ 0.3178, -1.7855,  0.8570,    -inf],
          [-0.3238,  0.4492,  1.5537, -1.0240]],

         [[-1.8441,    -inf,    -inf,    -inf],
          [-0.7390,  4.5223,    -inf,    -inf],
          [ 3.4504,  2.0674,  3.4053,    -inf],
          [ 4.1406,  1.5513,  6.4953,  1.5674]],

         [[-3.0406,    -inf,    -inf,    -inf],
          [-2.5462, -1.5620,    -inf,    -inf],
          [-4.1041,  1.1093, -8.4036,    -inf],
          [-0.2703,  2.0400, -2.7381,  1.1761]],

         [[ 1.8860,    -inf,    -inf,    -inf],
          [ 1.7727,  1.9643,    -inf,    -inf],
          [ 2.4772,  2.8921, -1.6258,    -inf],
          [-1.5887, -3.0692, -3.7542, -2.7499]],

         [[-1.0558,    -inf,    -inf,    -inf],
          [ 0.2051, -0.3134,    -inf,    -inf],
          [ 2.9489,  2.6706,  0.3120,    -inf],
          [-2.6366, -0.7583,  0.5380, -3.4216]],

         [[-1.3828,    -inf,    -inf,    -inf],
          [ 0.3702, -0.3414,    -inf,    -inf],
          [ 1.0060,  4.4011,  3.0111,    -inf],
          [ 0.6337,  0.6297,  2.0546, -3.7865]],

         [[ 1.0079,    -inf,    -inf,    -inf],
          [-5.0591, -2.9276,    -inf,    -inf],
          [-1.0221, -0.9845,  0.9340,    -inf],
          [-3.1283, -0.4593,  2.1296, -0.3294]],

         [[ 0.9501,    -inf,    -inf,    -inf],
          [ 1.6324,  0.2254,    -inf,    -inf],
          [ 2.6227,  1.0913,  3.9802,    -inf],
          [ 2.1805,  4.0952,  2.3599, -0.1252]],

         [[-1.3282,    -inf,    -inf,    -inf],
          [-0.6738,  1.3010,    -inf,    -inf],
          [-5.3028, -1.4067,  1.4845,    -inf],
          [-0.3024,  0.1473,  1.3821, -0.0872]],

         [[ 4.9486,    -inf,    -inf,    -inf],
          [ 2.2408,  1.5239,    -inf,    -inf],
          [ 1.4430, -1.6418, -2.5802,    -inf],
          [ 1.6616, -2.4833, -1.0881, -2.1031]]],


        [[[-2.5792,    -inf,    -inf,    -inf],
          [ 0.7556,  2.3441,    -inf,    -inf],
          [ 0.4620,  3.2765,  4.4485,    -inf],
          [ 0.0639,  0.1379,  3.0964,  4.8386]],

         [[-2.0575,    -inf,    -inf,    -inf],
          [-1.1964, -1.2015,    -inf,    -inf],
          [-3.2777,  2.0131,  2.6595,    -inf],
          [-4.0580,  6.4962,  1.0332,  2.3592]],

         [[-6.1562,    -inf,    -inf,    -inf],
          [-7.0613, -1.4705,    -inf,    -inf],
          [-4.2171,  1.6187, -2.7699,    -inf],
          [-6.5903, -0.8237,  3.3388,  1.4146]],

         [[ 1.7650,    -inf,    -inf,    -inf],
          [-0.0186,  0.9950,    -inf,    -inf],
          [ 0.9407,  1.7290,  0.9622,    -inf],
          [ 2.3805,  0.9763, -3.5688, -1.3469]],

         [[-0.6895,    -inf,    -inf,    -inf],
          [-4.1186, -3.2005,    -inf,    -inf],
          [ 2.0278,  2.2093,  0.2033,    -inf],
          [ 0.1820, -0.6320,  0.1621,  2.3975]],

         [[ 1.0402,    -inf,    -inf,    -inf],
          [ 1.0542, -0.3430,    -inf,    -inf],
          [ 3.2027, -0.0559,  0.5422,    -inf],
          [ 3.5168,  0.8690,  2.0506,  0.5078]],

         [[ 1.4982,    -inf,    -inf,    -inf],
          [-0.6515,  3.2850,    -inf,    -inf],
          [ 1.5878,  2.5710,  0.4058,    -inf],
          [-0.8154,  2.3441,  0.1889,  3.2036]],

         [[ 3.0032,    -inf,    -inf,    -inf],
          [ 0.8055,  3.0083,    -inf,    -inf],
          [ 0.7812,  3.1939,  4.4590,    -inf],
          [ 4.0264,  3.1343,  2.1649, -1.5347]],

         [[ 0.6375,    -inf,    -inf,    -inf],
          [ 3.8270,  1.5379,    -inf,    -inf],
          [ 2.1370,  1.2363, -0.1474,    -inf],
          [ 8.1534,  1.8977,  2.6658, -2.7675]],

         [[-3.9591,    -inf,    -inf,    -inf],
          [-3.1373, -4.2275,    -inf,    -inf],
          [-6.7072, -5.7948, -6.8583,    -inf],
          [-3.1538, -3.7755, -2.4775, -1.9014]],

         [[ 1.7735,    -inf,    -inf,    -inf],
          [-1.9414, -0.8935,    -inf,    -inf],
          [ 2.7621,  1.4483,  1.0791,    -inf],
          [-0.6068,  0.6203,  1.5410,  0.4169]],

         [[-0.2734,    -inf,    -inf,    -inf],
          [ 3.2916,  4.1881,    -inf,    -inf],
          [ 0.0303,  3.5398,  0.0155,    -inf],
          [-0.4176,  0.7973,  5.7659,  6.2240]],

         [[-4.4827,    -inf,    -inf,    -inf],
          [-4.2149,  0.1131,    -inf,    -inf],
          [-2.5108, -3.6305, -0.6388,    -inf],
          [ 0.4230, -1.6648, -0.6728,  0.5940]],

         [[-0.1470,    -inf,    -inf,    -inf],
          [ 2.4483,  2.2580,    -inf,    -inf],
          [ 3.0440,  2.7018, -0.1158,    -inf],
          [ 2.3538,  1.2283, -2.2822,  2.5587]],

         [[-3.3333,    -inf,    -inf,    -inf],
          [ 1.4121, -2.8214,    -inf,    -inf],
          [-0.6875, -1.4852,  1.1309,    -inf],
          [ 0.0288, -0.5512, -1.6094, -3.4571]],

         [[-2.1504,    -inf,    -inf,    -inf],
          [-2.6323, -1.4779,    -inf,    -inf],
          [ 2.6204, -1.2163, -2.5212,    -inf],
          [ 0.2667, -0.9969,  0.0577, -0.4040]],

         [[ 1.9692,    -inf,    -inf,    -inf],
          [-0.6171,  3.3691,    -inf,    -inf],
          [ 7.7850,  7.2164,  2.4354,    -inf],
          [ 5.4357, -0.3016,  2.1574,  1.0872]],

         [[-4.5525,    -inf,    -inf,    -inf],
          [-2.5466, -1.0394,    -inf,    -inf],
          [-4.9342, -2.4974, -7.0172,    -inf],
          [ 0.2760,  2.8282, -2.3031,  3.7750]],

         [[ 1.6353,    -inf,    -inf,    -inf],
          [ 5.4617,  2.8699,    -inf,    -inf],
          [ 2.8249,  2.3971,  0.2018,    -inf],
          [ 2.1884,  2.0648, -0.8523, -1.1167]],

         [[-1.7455,    -inf,    -inf,    -inf],
          [ 4.5535,  3.5231,    -inf,    -inf],
          [ 2.7638, -0.2214, -0.6860,    -inf],
          [ 1.4071,  0.2957,  0.5958, -4.2540]],

         [[ 0.4506,    -inf,    -inf,    -inf],
          [ 1.5025,  0.3386,    -inf,    -inf],
          [ 2.7513,  2.6770, -0.9482,    -inf],
          [-2.2426,  3.7954,  2.9912,  3.8275]],

         [[-0.9267,    -inf,    -inf,    -inf],
          [-0.4888,  0.9464,    -inf,    -inf],
          [ 1.3219,  1.1642, -3.6896,    -inf],
          [-0.1501,  2.2457,  0.4849,  3.9153]],

         [[ 2.7963,    -inf,    -inf,    -inf],
          [ 1.6695, -0.7549,    -inf,    -inf],
          [-0.7153,  0.9337, -0.7299,    -inf],
          [ 8.4514,  3.6314,  4.2465, -0.1355]],

         [[ 0.0448,    -inf,    -inf,    -inf],
          [ 2.7967,  0.6952,    -inf,    -inf],
          [ 3.1870, -0.6803,  4.8852,    -inf],
          [ 2.3098, -2.1547,  5.3847,  0.8166]],

         [[ 4.8978,    -inf,    -inf,    -inf],
          [-0.3721, -1.6927,    -inf,    -inf],
          [ 4.3840, -1.9705, -0.5245,    -inf],
          [-0.5252,  0.0811, -3.6753,  2.8511]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-6.9657e-01,  1.3103e-01, -9.0145e-01,  ..., -1.0774e-02,
           -1.1563e+00,  1.7984e-01],
          [-4.3731e-02,  1.0602e+00,  5.0620e-01,  ...,  4.5235e-01,
            6.3164e-01, -1.2417e+00],
          [ 2.8092e-01, -4.4499e-01, -6.2834e-01,  ..., -1.1420e+00,
            7.7064e-01, -6.2226e-02],
          ...,
          [ 1.9738e-01, -1.1592e+00, -6.6462e-02,  ...,  1.7609e-01,
           -1.1860e+00,  6.3158e-01],
          [ 7.0760e-01,  1.0154e-01, -7.7677e-01,  ..., -1.0571e+00,
            5.5581e-02, -9.3931e-01],
          [-1.1447e+00, -1.2070e+00,  7.0736e-01,  ..., -3.8081e-01,
           -5.1982e-01, -1.0033e+00]],

         [[-7.9295e-01, -1.0587e-02, -7.9798e-01,  ..., -5.2866e-01,
           -9.4913e-01,  1.0470e-01],
          [-2.2640e-02,  5.4888e-01,  2.6207e-01,  ...,  2.3419e-01,
            3.2701e-01, -6.4283e-01],
          [-2.9127e-01,  9.8868e-02, -3.5161e-01,  ..., -5.5263e-01,
            3.3457e-01,  9.7344e-02],
          ...,
          [-4.2528e-01, -4.1842e-01,  1.0058e-01,  ...,  2.2339e-01,
           -5.3034e-01,  2.7539e-01],
          [ 2.4690e-01, -8.2704e-02, -5.1336e-01,  ..., -1.8631e-01,
           -2.4130e-01, -7.4560e-01],
          [-8.3272e-01, -1.1458e+00,  2.4898e-01,  ..., -4.6404e-01,
           -5.4121e-01, -6.6528e-01]],

         [[ 1.1926e-01, -2.6393e-02, -7.5916e-01,  ..., -7.7372e-02,
           -6.0791e-01,  9.0417e-02],
          [-8.1899e-02,  7.5730e-01,  1.7567e-01,  ..., -1.0284e-01,
            3.1416e-01,  2.6510e-02],
          [-3.2990e-01,  1.5931e-01, -4.9473e-01,  ..., -3.0677e-01,
            4.7086e-02, -3.4431e-01],
          ...,
          [-5.2713e-01, -4.2165e-01,  6.5096e-02,  ...,  4.0299e-01,
           -3.0389e-01,  6.7646e-01],
          [ 1.0550e-01, -5.3857e-02, -2.5735e-01,  ..., -5.1002e-02,
           -1.4397e-01, -3.8410e-01],
          [-8.0462e-01, -8.0523e-01,  4.8663e-01,  ..., -5.9708e-01,
           -4.9834e-01, -9.7399e-01]],

         [[ 3.6441e-01,  4.2709e-02, -8.4824e-01,  ..., -4.3930e-02,
           -8.0649e-01,  1.0678e-01],
          [-1.0396e-01,  7.1655e-01,  2.1730e-01,  ..., -2.0192e-01,
            1.9525e-01,  2.3274e-01],
          [-1.7442e-01, -9.5264e-02, -4.0300e-01,  ..., -2.7406e-01,
           -4.4320e-01,  7.5313e-02],
          ...,
          [-5.1600e-01, -3.7024e-01,  4.4037e-02,  ...,  4.1019e-01,
           -2.1205e-01,  5.3054e-01],
          [ 2.0386e-01,  3.1946e-01, -4.4751e-01,  ...,  1.0666e-02,
           -4.5392e-01, -2.4083e-01],
          [-6.5417e-01, -9.9341e-01,  4.0395e-01,  ..., -3.5373e-01,
           -3.9136e-01, -1.0624e+00]]],


        [[[-1.0364e+00,  2.9967e-01, -5.2896e-01,  ..., -2.2374e-01,
           -8.6575e-01,  2.3073e-01],
          [-5.5402e-01,  6.0794e-01,  2.8358e-01,  ...,  2.5763e-01,
           -1.6025e-01, -1.9983e-01],
          [ 2.6056e-01, -8.3387e-03, -8.8258e-01,  ..., -8.9168e-01,
            2.8167e-01, -1.4477e-02],
          ...,
          [ 4.6936e-02, -9.3581e-01,  3.6334e-01,  ..., -5.2827e-01,
           -7.6000e-01, -2.6682e-01],
          [ 2.3606e-01,  1.1968e-01, -1.1652e+00,  ..., -5.7371e-01,
            4.0020e-01, -5.2084e-01],
          [-6.0760e-01, -6.8615e-01,  5.2048e-01,  ..., -7.2758e-01,
           -5.3034e-01, -1.1291e+00]],

         [[-5.9757e-01,  3.1263e-01, -8.3996e-01,  ..., -4.2536e-01,
           -1.1955e+00,  2.6835e-02],
          [ 4.1603e-04,  7.3034e-02, -1.2088e-01,  ...,  2.6293e-01,
           -8.4432e-02,  5.0581e-01],
          [ 4.2228e-01,  5.6220e-01, -6.3165e-01,  ..., -5.6363e-02,
            4.5708e-01,  2.2989e-01],
          ...,
          [-3.7363e-01, -5.4766e-01,  7.5661e-02,  ..., -3.8826e-02,
           -3.8250e-01, -3.5817e-01],
          [ 2.2421e-01,  3.3502e-01, -8.8518e-01,  ..., -3.0420e-01,
            4.5141e-01, -5.5802e-02],
          [-4.9098e-01, -4.4642e-01, -2.3515e-01,  ..., -1.9188e-01,
           -2.0491e-01, -2.4999e-01]],

         [[-3.6474e-01,  5.6750e-01, -8.1892e-01,  ..., -3.0525e-01,
           -1.1933e+00,  1.3781e-01],
          [ 1.5359e-01,  4.0917e-02,  1.5068e-01,  ...,  2.6941e-01,
           -8.5048e-02,  4.7542e-01],
          [ 5.3799e-01,  4.4253e-01, -1.0568e+00,  ..., -5.1223e-01,
            3.1892e-01,  1.0124e-01],
          ...,
          [-6.8063e-01, -4.5527e-01, -1.0878e-01,  ...,  3.1536e-01,
           -1.6215e-01, -1.9970e-01],
          [ 4.6129e-01,  3.9116e-01, -8.5080e-01,  ...,  3.9519e-02,
           -1.5925e-01, -1.8691e-01],
          [-8.3396e-01, -7.2044e-01,  2.4914e-01,  ..., -6.2615e-01,
           -5.0085e-01, -1.2104e+00]],

         [[-2.5359e-01,  4.0190e-01, -5.9929e-01,  ..., -2.6737e-01,
           -8.5915e-01,  1.4432e-01],
          [-1.6902e-01, -5.9549e-03,  2.2470e-02,  ...,  2.3782e-01,
            8.8534e-02,  7.2402e-01],
          [ 6.6324e-01,  2.6577e-01, -9.2328e-01,  ..., -5.8669e-01,
           -1.1324e-01, -8.9031e-02],
          ...,
          [-3.8995e-01, -2.9860e-01, -1.9184e-01,  ...,  4.3573e-01,
            8.7746e-02, -7.2746e-02],
          [ 2.7035e-01,  5.3929e-01, -7.1146e-01,  ..., -1.0423e-01,
           -1.3413e-01, -3.0998e-01],
          [-8.3247e-01, -1.0212e+00,  1.9191e-01,  ..., -2.5316e-01,
           -3.7419e-01, -1.2208e+00]]]], grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.6966,  0.1310, -0.9014,  ..., -0.3808, -0.5198, -1.0033],
         [-0.7929, -0.0106, -0.7980,  ..., -0.4640, -0.5412, -0.6653],
         [ 0.1193, -0.0264, -0.7592,  ..., -0.5971, -0.4983, -0.9740],
         [ 0.3644,  0.0427, -0.8482,  ..., -0.3537, -0.3914, -1.0624]],

        [[-1.0364,  0.2997, -0.5290,  ..., -0.7276, -0.5303, -1.1291],
         [-0.5976,  0.3126, -0.8400,  ..., -0.1919, -0.2049, -0.2500],
         [-0.3647,  0.5675, -0.8189,  ..., -0.6261, -0.5009, -1.2104],
         [-0.2536,  0.4019, -0.5993,  ..., -0.2532, -0.3742, -1.2208]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.0368, -0.2764,  0.1733,  ..., -0.3132, -0.1786,  0.0943],
         [-0.1493, -0.0689,  0.4489,  ...,  0.0243,  0.0392,  0.1930],
         [-0.0811, -0.1603,  0.4079,  ...,  0.1483, -0.0731,  0.5092],
         [ 0.0070, -0.0557,  0.1705,  ...,  0.1083,  0.0473,  0.3437]],

        [[ 0.0613, -0.4387,  0.3626,  ..., -0.3067,  0.2274, -0.0354],
         [ 0.2972, -0.3989,  0.2475,  ..., -0.2673,  0.0240,  0.1527],
         [ 0.3608, -0.4462,  0.1449,  ..., -0.3571, -0.0395,  0.3483],
         [ 0.4497, -0.3234,  0.3017,  ..., -0.2230,  0.0066,  0.4144]]],
       grad_fn=<ViewBackward0>)
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 3.7430e+00,        -inf,        -inf,        -inf],
          [ 1.5677e+00, -9.1481e-01,        -inf,        -inf],
          [ 1.6537e+00,  1.9506e+00, -1.3018e+00,        -inf],
          [-3.6899e-01,  1.7951e+00,  6.4115e-01,  1.6565e+00]],

         [[ 1.7768e+00,        -inf,        -inf,        -inf],
          [-5.6532e-01, -6.1687e+00,        -inf,        -inf],
          [-3.1474e+00, -2.0538e+00,  2.2393e+00,        -inf],
          [ 2.0189e+00, -1.1330e+00,  2.0059e+00, -6.2558e+00]],

         [[ 2.5323e+00,        -inf,        -inf,        -inf],
          [ 3.9294e+00,  5.1842e+00,        -inf,        -inf],
          [ 4.3355e+00,  7.4273e+00,  9.7824e-01,        -inf],
          [ 2.5521e+00,  6.7404e+00,  4.1087e+00,  5.2105e+00]],

         [[ 3.0578e+00,        -inf,        -inf,        -inf],
          [ 2.7755e+00,  2.7931e+00,        -inf,        -inf],
          [ 3.1012e+00, -2.3400e+00,  1.6522e+00,        -inf],
          [ 1.0481e+00, -1.0570e+00,  1.6194e+00, -1.4023e+00]],

         [[-2.2079e+00,        -inf,        -inf,        -inf],
          [ 1.8766e-01,  1.2703e+00,        -inf,        -inf],
          [-3.7609e+00, -2.6632e-01,  4.0455e+00,        -inf],
          [-2.6085e+00,  7.7145e-01,  5.1984e-01,  1.7744e+00]],

         [[-1.2197e+00,        -inf,        -inf,        -inf],
          [-7.0477e-01, -1.0832e+00,        -inf,        -inf],
          [ 1.4035e+00,  1.6081e+00,  3.7562e+00,        -inf],
          [ 1.0861e+00, -2.5359e-01,  5.7089e+00,  7.1757e+00]],

         [[ 2.6085e+00,        -inf,        -inf,        -inf],
          [-1.5192e+00, -1.9567e-01,        -inf,        -inf],
          [-3.6892e+00, -4.7279e-01, -2.1356e+00,        -inf],
          [-2.0511e+00, -3.5315e-01, -2.9403e+00, -3.5118e+00]],

         [[-7.5067e-01,        -inf,        -inf,        -inf],
          [ 1.2290e-01, -1.3885e+00,        -inf,        -inf],
          [-3.9802e-01,  4.5038e-01,  5.8934e-01,        -inf],
          [ 3.2579e+00,  1.5193e+00,  5.1047e+00,  5.0273e+00]],

         [[-1.2307e+00,        -inf,        -inf,        -inf],
          [-5.5759e+00, -4.2472e-01,        -inf,        -inf],
          [-6.3183e+00,  2.3691e+00,  3.3386e-01,        -inf],
          [-3.1730e+00, -1.5073e+00,  1.3954e+00,  3.7516e-01]],

         [[ 2.7804e+00,        -inf,        -inf,        -inf],
          [-3.3611e+00,  8.9167e-01,        -inf,        -inf],
          [-4.1526e+00,  1.6671e+00, -2.4311e+00,        -inf],
          [-2.4468e+00,  1.6129e+00, -1.9844e+00,  2.4507e+00]],

         [[-2.2624e+00,        -inf,        -inf,        -inf],
          [-4.5173e+00, -2.0682e+00,        -inf,        -inf],
          [-5.9691e+00, -2.7424e+00, -6.5486e+00,        -inf],
          [ 9.6991e-02, -3.6430e+00, -2.9651e+00, -1.0585e+00]],

         [[-1.9238e+00,        -inf,        -inf,        -inf],
          [ 9.9783e-01, -2.0176e+00,        -inf,        -inf],
          [ 1.6755e+00,  5.6970e-01, -3.8614e+00,        -inf],
          [ 2.0607e+00,  1.9252e+00,  1.2850e+00,  1.4988e+00]],

         [[-1.6640e+00,        -inf,        -inf,        -inf],
          [ 7.3617e-01, -2.2064e+00,        -inf,        -inf],
          [-2.3224e+00, -1.4707e+00, -1.9439e+00,        -inf],
          [-7.5023e-01, -2.7466e+00,  4.0417e-01, -4.9235e+00]],

         [[-1.0201e+00,        -inf,        -inf,        -inf],
          [-2.1561e+00, -3.0607e+00,        -inf,        -inf],
          [-5.5030e+00, -2.3219e+00, -2.0098e+00,        -inf],
          [-1.2023e+00, -3.5062e+00, -1.4955e+00,  1.3026e-01]],

         [[ 6.7340e-01,        -inf,        -inf,        -inf],
          [ 3.9005e+00,  1.7694e+00,        -inf,        -inf],
          [ 4.9697e+00,  2.7511e+00,  2.6139e+00,        -inf],
          [ 2.3744e+00, -4.3958e-01,  2.1146e+00, -4.9189e-01]],

         [[-1.3606e+00,        -inf,        -inf,        -inf],
          [-1.8408e+00, -3.9325e+00,        -inf,        -inf],
          [ 3.1956e+00, -1.8454e+00, -3.9209e+00,        -inf],
          [ 2.2065e+00,  2.1375e+00, -1.8856e+00,  2.3620e-01]],

         [[ 3.0494e+00,        -inf,        -inf,        -inf],
          [ 1.7096e-01, -2.1600e+00,        -inf,        -inf],
          [ 5.6919e+00, -1.9724e+00,  6.0623e-01,        -inf],
          [ 2.3245e+00, -9.3674e-01, -4.5089e+00, -5.6167e+00]],

         [[ 1.9480e+00,        -inf,        -inf,        -inf],
          [ 9.7800e-01,  1.6818e-01,        -inf,        -inf],
          [-8.0361e-01,  1.6158e+00,  2.0138e+00,        -inf],
          [-7.7303e-01, -6.2557e-01,  1.1942e+00,  4.6388e+00]],

         [[-2.7670e+00,        -inf,        -inf,        -inf],
          [-1.5621e+00,  7.2175e-01,        -inf,        -inf],
          [-3.8574e+00,  8.0055e-01, -2.0542e+00,        -inf],
          [-1.5456e+00, -9.3298e-01,  1.1581e+00,  2.9008e+00]],

         [[ 1.3712e+00,        -inf,        -inf,        -inf],
          [ 3.3404e+00, -6.5507e-01,        -inf,        -inf],
          [ 1.5296e+00, -4.0229e-01,  2.1663e+00,        -inf],
          [ 2.2012e+00, -1.2770e+00,  3.7234e+00,  6.1180e+00]],

         [[ 5.2516e+00,        -inf,        -inf,        -inf],
          [ 2.8817e+00, -1.7660e+00,        -inf,        -inf],
          [-2.9883e-02,  3.1874e+00, -1.5357e+00,        -inf],
          [-1.1803e+00, -1.5042e+00, -2.0635e+00,  1.3737e+00]],

         [[ 4.6436e-01,        -inf,        -inf,        -inf],
          [-9.0474e-01,  6.1887e-01,        -inf,        -inf],
          [-2.8295e+00, -1.5352e+00,  1.8087e+00,        -inf],
          [-1.2496e-02,  2.2167e+00,  2.1221e+00,  2.5920e-01]],

         [[-7.7008e+00,        -inf,        -inf,        -inf],
          [-4.5150e+00, -5.6802e+00,        -inf,        -inf],
          [-3.8737e+00, -2.7661e+00, -6.0932e-01,        -inf],
          [-2.5775e+00, -2.1798e+00,  1.5769e+00, -7.1410e-01]],

         [[-3.6424e+00,        -inf,        -inf,        -inf],
          [-2.8537e+00, -1.7766e+00,        -inf,        -inf],
          [-2.6348e+00, -7.5358e-01,  3.8194e-01,        -inf],
          [-4.1156e+00, -4.4121e+00, -6.0118e+00,  8.1026e-01]],

         [[ 2.5624e+00,        -inf,        -inf,        -inf],
          [-4.4317e+00, -7.1279e+00,        -inf,        -inf],
          [-6.6253e-01, -2.7534e+00, -6.9329e-01,        -inf],
          [ 2.5217e+00, -5.1163e-01, -3.4114e+00,  8.0171e-01]]],


        [[[ 6.1184e+00,        -inf,        -inf,        -inf],
          [ 2.2319e+00, -3.2470e+00,        -inf,        -inf],
          [ 1.8641e+00, -3.2374e+00,  2.0075e+00,        -inf],
          [-2.5182e+00, -6.3140e+00,  7.7008e-01, -6.2614e+00]],

         [[ 4.5401e-01,        -inf,        -inf,        -inf],
          [-5.9996e-01, -9.3488e-01,        -inf,        -inf],
          [-1.7832e+00,  2.2779e+00, -1.6652e+00,        -inf],
          [-2.5675e-01,  3.3580e+00, -1.6282e+00,  2.7492e+00]],

         [[ 3.5538e-01,        -inf,        -inf,        -inf],
          [-1.1953e+00,  3.3619e+00,        -inf,        -inf],
          [-2.6656e+00,  3.0009e+00,  3.0930e+00,        -inf],
          [-4.0686e+00,  3.0776e+00,  2.1514e+00, -1.0818e+00]],

         [[ 8.2858e-01,        -inf,        -inf,        -inf],
          [ 3.9792e+00,  4.3989e+00,        -inf,        -inf],
          [ 2.1561e+00, -4.0030e-01,  1.6006e+00,        -inf],
          [-1.8100e+00, -1.3985e+00,  6.1663e-01, -3.2975e-01]],

         [[-4.0929e+00,        -inf,        -inf,        -inf],
          [-2.5944e+00,  2.6353e+00,        -inf,        -inf],
          [-6.0262e+00,  1.4943e+00, -2.3317e+00,        -inf],
          [ 1.0557e+00,  5.2683e+00, -1.3700e+00, -1.9487e+00]],

         [[ 5.7158e-02,        -inf,        -inf,        -inf],
          [ 2.8870e-01, -7.9828e-01,        -inf,        -inf],
          [ 3.7356e+00,  1.5859e+00,  1.8966e+00,        -inf],
          [ 4.4006e+00,  1.3959e+00,  2.3553e+00,  4.0044e+00]],

         [[ 6.8352e-01,        -inf,        -inf,        -inf],
          [-4.1923e+00,  1.9829e+00,        -inf,        -inf],
          [-5.1227e+00,  2.5901e+00, -1.0874e+00,        -inf],
          [-1.6821e+00,  1.3114e+00, -1.9790e+00, -1.6431e+00]],

         [[-1.5600e+00,        -inf,        -inf,        -inf],
          [ 2.7214e+00,  1.0037e+00,        -inf,        -inf],
          [-4.8141e+00, -2.8760e+00,  2.2512e+00,        -inf],
          [ 2.2183e+00,  1.7593e-01,  4.6551e+00,  3.3860e+00]],

         [[-1.3290e-01,        -inf,        -inf,        -inf],
          [ 3.7462e-01,  2.8949e+00,        -inf,        -inf],
          [ 2.1129e-03,  2.9916e+00,  1.2780e+00,        -inf],
          [-1.9720e+00,  1.3080e+00,  1.1098e-01,  4.2523e+00]],

         [[ 3.7928e-01,        -inf,        -inf,        -inf],
          [-3.9484e+00,  1.8595e-01,        -inf,        -inf],
          [ 2.6841e+00,  2.8403e+00, -1.2829e-01,        -inf],
          [-1.6961e+00,  2.4927e+00,  1.3748e+00, -3.7895e-01]],

         [[-2.8342e+00,        -inf,        -inf,        -inf],
          [-1.4619e+00, -1.1255e+00,        -inf,        -inf],
          [ 9.8724e-01,  1.7880e+00, -1.4772e-01,        -inf],
          [-1.4416e+00, -2.3017e+00, -1.3342e+00,  3.5769e+00]],

         [[-3.0850e+00,        -inf,        -inf,        -inf],
          [ 1.6929e+00,  9.6935e-01,        -inf,        -inf],
          [ 1.2060e+00,  1.8175e+00, -3.2218e+00,        -inf],
          [-9.5007e-02,  2.3555e+00, -1.6241e+00,  3.1940e+00]],

         [[-4.6428e-01,        -inf,        -inf,        -inf],
          [ 2.0714e+00,  1.2997e+00,        -inf,        -inf],
          [-2.2317e+00,  1.9346e-01,  1.9203e+00,        -inf],
          [-5.4053e+00, -3.2752e-01, -9.5005e-01, -5.4256e+00]],

         [[-1.0228e+00,        -inf,        -inf,        -inf],
          [-4.6435e-01, -2.6767e+00,        -inf,        -inf],
          [-5.7524e+00, -4.9990e+00, -4.2635e+00,        -inf],
          [-1.1408e+00, -5.3408e+00, -4.3414e+00, -3.8150e+00]],

         [[ 1.4830e-01,        -inf,        -inf,        -inf],
          [ 3.2304e+00, -1.7827e+00,        -inf,        -inf],
          [ 1.9128e+00, -2.8468e-02,  6.7021e-02,        -inf],
          [ 3.9156e+00, -4.2879e+00, -3.9192e+00,  1.9794e+00]],

         [[-4.0616e-01,        -inf,        -inf,        -inf],
          [-4.9904e-01, -4.3616e-01,        -inf,        -inf],
          [ 7.1075e-01, -1.3407e+00,  9.0042e-01,        -inf],
          [-1.0105e+00,  2.1223e+00,  1.0225e+00,  1.1285e+00]],

         [[ 4.0981e+00,        -inf,        -inf,        -inf],
          [ 6.0386e-01,  1.5507e+00,        -inf,        -inf],
          [-5.9578e-01,  2.0829e+00,  5.1446e+00,        -inf],
          [ 1.7078e+00,  4.4079e-01, -3.0404e+00, -2.2425e+00]],

         [[ 1.0465e+00,        -inf,        -inf,        -inf],
          [-1.9120e+00,  3.0289e+00,        -inf,        -inf],
          [ 5.1988e-01,  4.0160e+00,  2.3879e+00,        -inf],
          [ 2.3558e+00,  3.9387e+00,  3.1529e+00,  3.5412e+00]],

         [[ 7.1958e-01,        -inf,        -inf,        -inf],
          [ 1.6430e+00,  2.1724e+00,        -inf,        -inf],
          [-1.9051e+00, -4.3412e+00, -3.4853e+00,        -inf],
          [-8.3983e-01, -5.0591e+00, -4.7686e-01, -1.0367e+00]],

         [[ 2.2346e+00,        -inf,        -inf,        -inf],
          [ 4.4109e+00,  3.3117e+00,        -inf,        -inf],
          [ 4.7929e+00,  4.6048e+00,  4.9242e+00,        -inf],
          [ 7.1973e+00,  2.8588e+00,  7.8338e-01, -3.1218e+00]],

         [[-2.0467e-01,        -inf,        -inf,        -inf],
          [ 3.4433e+00, -1.8029e+00,        -inf,        -inf],
          [-9.6797e-01, -2.9516e+00,  1.6323e+00,        -inf],
          [-8.1181e-01, -2.2460e+00, -3.3120e+00,  3.2452e+00]],

         [[-8.4005e-01,        -inf,        -inf,        -inf],
          [-1.7613e+00, -8.7201e-01,        -inf,        -inf],
          [-7.4531e-01,  1.7568e+00, -1.6040e+00,        -inf],
          [-8.2232e-01,  2.7229e+00, -1.5567e+00, -4.3671e-01]],

         [[-4.3384e+00,        -inf,        -inf,        -inf],
          [-3.9442e+00, -3.9767e+00,        -inf,        -inf],
          [-1.8222e+00, -5.2717e+00, -3.1129e+00,        -inf],
          [-7.5850e+00, -1.9562e+00, -4.3398e+00,  6.9655e-01]],

         [[-4.4921e+00,        -inf,        -inf,        -inf],
          [ 1.2708e-01, -3.5563e+00,        -inf,        -inf],
          [ 5.3848e-01,  3.4337e+00, -2.6502e+00,        -inf],
          [ 3.5053e-01, -2.4623e+00, -6.4988e+00,  2.1197e+00]],

         [[-3.1809e+00,        -inf,        -inf,        -inf],
          [-1.1960e+00, -4.0761e+00,        -inf,        -inf],
          [ 1.1590e+00, -4.1724e+00,  1.9855e+00,        -inf],
          [ 4.8536e+00, -5.5775e-01,  8.5597e-01,  1.2052e+00]]]],
       grad_fn=<MaskedFillBackward0>)
attn weights tensor:
 tensor([[[[ 3.7430e+00,        -inf,        -inf,        -inf],
          [ 1.5677e+00, -9.1481e-01,        -inf,        -inf],
          [ 1.6537e+00,  1.9506e+00, -1.3018e+00,        -inf],
          [-3.6899e-01,  1.7951e+00,  6.4115e-01,  1.6565e+00]],

         [[ 1.7768e+00,        -inf,        -inf,        -inf],
          [-5.6532e-01, -6.1687e+00,        -inf,        -inf],
          [-3.1474e+00, -2.0538e+00,  2.2393e+00,        -inf],
          [ 2.0189e+00, -1.1330e+00,  2.0059e+00, -6.2558e+00]],

         [[ 2.5323e+00,        -inf,        -inf,        -inf],
          [ 3.9294e+00,  5.1842e+00,        -inf,        -inf],
          [ 4.3355e+00,  7.4273e+00,  9.7824e-01,        -inf],
          [ 2.5521e+00,  6.7404e+00,  4.1087e+00,  5.2105e+00]],

         [[ 3.0578e+00,        -inf,        -inf,        -inf],
          [ 2.7755e+00,  2.7931e+00,        -inf,        -inf],
          [ 3.1012e+00, -2.3400e+00,  1.6522e+00,        -inf],
          [ 1.0481e+00, -1.0570e+00,  1.6194e+00, -1.4023e+00]],

         [[-2.2079e+00,        -inf,        -inf,        -inf],
          [ 1.8766e-01,  1.2703e+00,        -inf,        -inf],
          [-3.7609e+00, -2.6632e-01,  4.0455e+00,        -inf],
          [-2.6085e+00,  7.7145e-01,  5.1984e-01,  1.7744e+00]],

         [[-1.2197e+00,        -inf,        -inf,        -inf],
          [-7.0477e-01, -1.0832e+00,        -inf,        -inf],
          [ 1.4035e+00,  1.6081e+00,  3.7562e+00,        -inf],
          [ 1.0861e+00, -2.5359e-01,  5.7089e+00,  7.1757e+00]],

         [[ 2.6085e+00,        -inf,        -inf,        -inf],
          [-1.5192e+00, -1.9567e-01,        -inf,        -inf],
          [-3.6892e+00, -4.7279e-01, -2.1356e+00,        -inf],
          [-2.0511e+00, -3.5315e-01, -2.9403e+00, -3.5118e+00]],

         [[-7.5067e-01,        -inf,        -inf,        -inf],
          [ 1.2290e-01, -1.3885e+00,        -inf,        -inf],
          [-3.9802e-01,  4.5038e-01,  5.8934e-01,        -inf],
          [ 3.2579e+00,  1.5193e+00,  5.1047e+00,  5.0273e+00]],

         [[-1.2307e+00,        -inf,        -inf,        -inf],
          [-5.5759e+00, -4.2472e-01,        -inf,        -inf],
          [-6.3183e+00,  2.3691e+00,  3.3386e-01,        -inf],
          [-3.1730e+00, -1.5073e+00,  1.3954e+00,  3.7516e-01]],

         [[ 2.7804e+00,        -inf,        -inf,        -inf],
          [-3.3611e+00,  8.9167e-01,        -inf,        -inf],
          [-4.1526e+00,  1.6671e+00, -2.4311e+00,        -inf],
          [-2.4468e+00,  1.6129e+00, -1.9844e+00,  2.4507e+00]],

         [[-2.2624e+00,        -inf,        -inf,        -inf],
          [-4.5173e+00, -2.0682e+00,        -inf,        -inf],
          [-5.9691e+00, -2.7424e+00, -6.5486e+00,        -inf],
          [ 9.6991e-02, -3.6430e+00, -2.9651e+00, -1.0585e+00]],

         [[-1.9238e+00,        -inf,        -inf,        -inf],
          [ 9.9783e-01, -2.0176e+00,        -inf,        -inf],
          [ 1.6755e+00,  5.6970e-01, -3.8614e+00,        -inf],
          [ 2.0607e+00,  1.9252e+00,  1.2850e+00,  1.4988e+00]],

         [[-1.6640e+00,        -inf,        -inf,        -inf],
          [ 7.3617e-01, -2.2064e+00,        -inf,        -inf],
          [-2.3224e+00, -1.4707e+00, -1.9439e+00,        -inf],
          [-7.5023e-01, -2.7466e+00,  4.0417e-01, -4.9235e+00]],

         [[-1.0201e+00,        -inf,        -inf,        -inf],
          [-2.1561e+00, -3.0607e+00,        -inf,        -inf],
          [-5.5030e+00, -2.3219e+00, -2.0098e+00,        -inf],
          [-1.2023e+00, -3.5062e+00, -1.4955e+00,  1.3026e-01]],

         [[ 6.7340e-01,        -inf,        -inf,        -inf],
          [ 3.9005e+00,  1.7694e+00,        -inf,        -inf],
          [ 4.9697e+00,  2.7511e+00,  2.6139e+00,        -inf],
          [ 2.3744e+00, -4.3958e-01,  2.1146e+00, -4.9189e-01]],

         [[-1.3606e+00,        -inf,        -inf,        -inf],
          [-1.8408e+00, -3.9325e+00,        -inf,        -inf],
          [ 3.1956e+00, -1.8454e+00, -3.9209e+00,        -inf],
          [ 2.2065e+00,  2.1375e+00, -1.8856e+00,  2.3620e-01]],

         [[ 3.0494e+00,        -inf,        -inf,        -inf],
          [ 1.7096e-01, -2.1600e+00,        -inf,        -inf],
          [ 5.6919e+00, -1.9724e+00,  6.0623e-01,        -inf],
          [ 2.3245e+00, -9.3674e-01, -4.5089e+00, -5.6167e+00]],

         [[ 1.9480e+00,        -inf,        -inf,        -inf],
          [ 9.7800e-01,  1.6818e-01,        -inf,        -inf],
          [-8.0361e-01,  1.6158e+00,  2.0138e+00,        -inf],
          [-7.7303e-01, -6.2557e-01,  1.1942e+00,  4.6388e+00]],

         [[-2.7670e+00,        -inf,        -inf,        -inf],
          [-1.5621e+00,  7.2175e-01,        -inf,        -inf],
          [-3.8574e+00,  8.0055e-01, -2.0542e+00,        -inf],
          [-1.5456e+00, -9.3298e-01,  1.1581e+00,  2.9008e+00]],

         [[ 1.3712e+00,        -inf,        -inf,        -inf],
          [ 3.3404e+00, -6.5507e-01,        -inf,        -inf],
          [ 1.5296e+00, -4.0229e-01,  2.1663e+00,        -inf],
          [ 2.2012e+00, -1.2770e+00,  3.7234e+00,  6.1180e+00]],

         [[ 5.2516e+00,        -inf,        -inf,        -inf],
          [ 2.8817e+00, -1.7660e+00,        -inf,        -inf],
          [-2.9883e-02,  3.1874e+00, -1.5357e+00,        -inf],
          [-1.1803e+00, -1.5042e+00, -2.0635e+00,  1.3737e+00]],

         [[ 4.6436e-01,        -inf,        -inf,        -inf],
          [-9.0474e-01,  6.1887e-01,        -inf,        -inf],
          [-2.8295e+00, -1.5352e+00,  1.8087e+00,        -inf],
          [-1.2496e-02,  2.2167e+00,  2.1221e+00,  2.5920e-01]],

         [[-7.7008e+00,        -inf,        -inf,        -inf],
          [-4.5150e+00, -5.6802e+00,        -inf,        -inf],
          [-3.8737e+00, -2.7661e+00, -6.0932e-01,        -inf],
          [-2.5775e+00, -2.1798e+00,  1.5769e+00, -7.1410e-01]],

         [[-3.6424e+00,        -inf,        -inf,        -inf],
          [-2.8537e+00, -1.7766e+00,        -inf,        -inf],
          [-2.6348e+00, -7.5358e-01,  3.8194e-01,        -inf],
          [-4.1156e+00, -4.4121e+00, -6.0118e+00,  8.1026e-01]],

         [[ 2.5624e+00,        -inf,        -inf,        -inf],
          [-4.4317e+00, -7.1279e+00,        -inf,        -inf],
          [-6.6253e-01, -2.7534e+00, -6.9329e-01,        -inf],
          [ 2.5217e+00, -5.1163e-01, -3.4114e+00,  8.0171e-01]]],


        [[[ 6.1184e+00,        -inf,        -inf,        -inf],
          [ 2.2319e+00, -3.2470e+00,        -inf,        -inf],
          [ 1.8641e+00, -3.2374e+00,  2.0075e+00,        -inf],
          [-2.5182e+00, -6.3140e+00,  7.7008e-01, -6.2614e+00]],

         [[ 4.5401e-01,        -inf,        -inf,        -inf],
          [-5.9996e-01, -9.3488e-01,        -inf,        -inf],
          [-1.7832e+00,  2.2779e+00, -1.6652e+00,        -inf],
          [-2.5675e-01,  3.3580e+00, -1.6282e+00,  2.7492e+00]],

         [[ 3.5538e-01,        -inf,        -inf,        -inf],
          [-1.1953e+00,  3.3619e+00,        -inf,        -inf],
          [-2.6656e+00,  3.0009e+00,  3.0930e+00,        -inf],
          [-4.0686e+00,  3.0776e+00,  2.1514e+00, -1.0818e+00]],

         [[ 8.2858e-01,        -inf,        -inf,        -inf],
          [ 3.9792e+00,  4.3989e+00,        -inf,        -inf],
          [ 2.1561e+00, -4.0030e-01,  1.6006e+00,        -inf],
          [-1.8100e+00, -1.3985e+00,  6.1663e-01, -3.2975e-01]],

         [[-4.0929e+00,        -inf,        -inf,        -inf],
          [-2.5944e+00,  2.6353e+00,        -inf,        -inf],
          [-6.0262e+00,  1.4943e+00, -2.3317e+00,        -inf],
          [ 1.0557e+00,  5.2683e+00, -1.3700e+00, -1.9487e+00]],

         [[ 5.7158e-02,        -inf,        -inf,        -inf],
          [ 2.8870e-01, -7.9828e-01,        -inf,        -inf],
          [ 3.7356e+00,  1.5859e+00,  1.8966e+00,        -inf],
          [ 4.4006e+00,  1.3959e+00,  2.3553e+00,  4.0044e+00]],

         [[ 6.8352e-01,        -inf,        -inf,        -inf],
          [-4.1923e+00,  1.9829e+00,        -inf,        -inf],
          [-5.1227e+00,  2.5901e+00, -1.0874e+00,        -inf],
          [-1.6821e+00,  1.3114e+00, -1.9790e+00, -1.6431e+00]],

         [[-1.5600e+00,        -inf,        -inf,        -inf],
          [ 2.7214e+00,  1.0037e+00,        -inf,        -inf],
          [-4.8141e+00, -2.8760e+00,  2.2512e+00,        -inf],
          [ 2.2183e+00,  1.7593e-01,  4.6551e+00,  3.3860e+00]],

         [[-1.3290e-01,        -inf,        -inf,        -inf],
          [ 3.7462e-01,  2.8949e+00,        -inf,        -inf],
          [ 2.1129e-03,  2.9916e+00,  1.2780e+00,        -inf],
          [-1.9720e+00,  1.3080e+00,  1.1098e-01,  4.2523e+00]],

         [[ 3.7928e-01,        -inf,        -inf,        -inf],
          [-3.9484e+00,  1.8595e-01,        -inf,        -inf],
          [ 2.6841e+00,  2.8403e+00, -1.2829e-01,        -inf],
          [-1.6961e+00,  2.4927e+00,  1.3748e+00, -3.7895e-01]],

         [[-2.8342e+00,        -inf,        -inf,        -inf],
          [-1.4619e+00, -1.1255e+00,        -inf,        -inf],
          [ 9.8724e-01,  1.7880e+00, -1.4772e-01,        -inf],
          [-1.4416e+00, -2.3017e+00, -1.3342e+00,  3.5769e+00]],

         [[-3.0850e+00,        -inf,        -inf,        -inf],
          [ 1.6929e+00,  9.6935e-01,        -inf,        -inf],
          [ 1.2060e+00,  1.8175e+00, -3.2218e+00,        -inf],
          [-9.5007e-02,  2.3555e+00, -1.6241e+00,  3.1940e+00]],

         [[-4.6428e-01,        -inf,        -inf,        -inf],
          [ 2.0714e+00,  1.2997e+00,        -inf,        -inf],
          [-2.2317e+00,  1.9346e-01,  1.9203e+00,        -inf],
          [-5.4053e+00, -3.2752e-01, -9.5005e-01, -5.4256e+00]],

         [[-1.0228e+00,        -inf,        -inf,        -inf],
          [-4.6435e-01, -2.6767e+00,        -inf,        -inf],
          [-5.7524e+00, -4.9990e+00, -4.2635e+00,        -inf],
          [-1.1408e+00, -5.3408e+00, -4.3414e+00, -3.8150e+00]],

         [[ 1.4830e-01,        -inf,        -inf,        -inf],
          [ 3.2304e+00, -1.7827e+00,        -inf,        -inf],
          [ 1.9128e+00, -2.8468e-02,  6.7021e-02,        -inf],
          [ 3.9156e+00, -4.2879e+00, -3.9192e+00,  1.9794e+00]],

         [[-4.0616e-01,        -inf,        -inf,        -inf],
          [-4.9904e-01, -4.3616e-01,        -inf,        -inf],
          [ 7.1075e-01, -1.3407e+00,  9.0042e-01,        -inf],
          [-1.0105e+00,  2.1223e+00,  1.0225e+00,  1.1285e+00]],

         [[ 4.0981e+00,        -inf,        -inf,        -inf],
          [ 6.0386e-01,  1.5507e+00,        -inf,        -inf],
          [-5.9578e-01,  2.0829e+00,  5.1446e+00,        -inf],
          [ 1.7078e+00,  4.4079e-01, -3.0404e+00, -2.2425e+00]],

         [[ 1.0465e+00,        -inf,        -inf,        -inf],
          [-1.9120e+00,  3.0289e+00,        -inf,        -inf],
          [ 5.1988e-01,  4.0160e+00,  2.3879e+00,        -inf],
          [ 2.3558e+00,  3.9387e+00,  3.1529e+00,  3.5412e+00]],

         [[ 7.1958e-01,        -inf,        -inf,        -inf],
          [ 1.6430e+00,  2.1724e+00,        -inf,        -inf],
          [-1.9051e+00, -4.3412e+00, -3.4853e+00,        -inf],
          [-8.3983e-01, -5.0591e+00, -4.7686e-01, -1.0367e+00]],

         [[ 2.2346e+00,        -inf,        -inf,        -inf],
          [ 4.4109e+00,  3.3117e+00,        -inf,        -inf],
          [ 4.7929e+00,  4.6048e+00,  4.9242e+00,        -inf],
          [ 7.1973e+00,  2.8588e+00,  7.8338e-01, -3.1218e+00]],

         [[-2.0467e-01,        -inf,        -inf,        -inf],
          [ 3.4433e+00, -1.8029e+00,        -inf,        -inf],
          [-9.6797e-01, -2.9516e+00,  1.6323e+00,        -inf],
          [-8.1181e-01, -2.2460e+00, -3.3120e+00,  3.2452e+00]],

         [[-8.4005e-01,        -inf,        -inf,        -inf],
          [-1.7613e+00, -8.7201e-01,        -inf,        -inf],
          [-7.4531e-01,  1.7568e+00, -1.6040e+00,        -inf],
          [-8.2232e-01,  2.7229e+00, -1.5567e+00, -4.3671e-01]],

         [[-4.3384e+00,        -inf,        -inf,        -inf],
          [-3.9442e+00, -3.9767e+00,        -inf,        -inf],
          [-1.8222e+00, -5.2717e+00, -3.1129e+00,        -inf],
          [-7.5850e+00, -1.9562e+00, -4.3398e+00,  6.9655e-01]],

         [[-4.4921e+00,        -inf,        -inf,        -inf],
          [ 1.2708e-01, -3.5563e+00,        -inf,        -inf],
          [ 5.3848e-01,  3.4337e+00, -2.6502e+00,        -inf],
          [ 3.5053e-01, -2.4623e+00, -6.4988e+00,  2.1197e+00]],

         [[-3.1809e+00,        -inf,        -inf,        -inf],
          [-1.1960e+00, -4.0761e+00,        -inf,        -inf],
          [ 1.1590e+00, -4.1724e+00,  1.9855e+00,        -inf],
          [ 4.8536e+00, -5.5775e-01,  8.5597e-01,  1.2052e+00]]]],
       grad_fn=<MaskedFillBackward0>)
context_vec step1:
 tensor([[[[-0.8118,  0.5255,  0.2349,  ..., -0.0119,  0.7603,  0.6619],
          [ 0.7543, -0.2382, -1.9627,  ...,  0.3116,  0.1445,  0.0801],
          [ 0.6537, -0.8737, -0.5677,  ..., -0.0551, -0.2360, -0.3662],
          ...,
          [ 0.2344,  0.4758,  0.5053,  ..., -1.2533, -1.0094,  0.6866],
          [ 0.5442,  1.2171,  1.5152,  ..., -0.0299,  0.5403, -0.7552],
          [ 0.5892,  0.3772,  1.5824,  ..., -0.2715,  0.4790,  0.5620]],

         [[-0.4624,  0.4234,  0.1591,  ..., -0.1442,  0.7063,  0.6177],
          [ 0.2814,  0.2375, -1.6751,  ...,  0.0362, -0.0539,  0.2790],
          [ 0.1725, -0.3684, -0.0092,  ..., -0.0408, -0.6596, -0.7257],
          ...,
          [ 0.3557,  0.3207,  0.1213,  ..., -0.5621, -0.6053,  0.4670],
          [ 0.7063,  0.2464,  0.9191,  ..., -0.0580,  0.2445, -0.7576],
          [ 0.0135,  0.3777,  1.6404,  ...,  0.0675,  0.8336,  0.7171]],

         [[-0.1371,  0.2489,  0.0898,  ..., -0.1166,  0.6408,  0.5803],
          [-0.2107,  0.4429, -0.9554,  ...,  0.1784,  0.2063,  0.0040],
          [ 0.1755, -0.3118, -0.0222,  ..., -0.0575, -0.6502, -0.7542],
          ...,
          [ 0.5375, -0.0707,  0.1353,  ..., -0.1339, -0.1842,  0.1788],
          [ 0.8899,  0.0039,  0.1866,  ..., -0.1373,  0.2747, -0.6203],
          [ 0.1516,  0.4542,  1.8179,  ...,  0.4065,  0.5647,  0.8396]],

         [[-0.0966,  0.0652,  0.1458,  ..., -0.1388,  0.3578,  0.6278],
          [-0.1386,  0.3420, -1.1035,  ...,  0.2135,  0.1480,  0.0089],
          [ 0.1636, -0.3298, -0.1858,  ...,  0.0263, -0.4178, -0.4030],
          ...,
          [ 0.4619, -0.0593,  0.5483,  ..., -0.5522, -0.2285,  0.3306],
          [ 0.9376, -0.0600,  0.1928,  ...,  0.0757,  0.4234, -0.4105],
          [-0.2318,  0.1875,  1.3802,  ...,  0.1285,  0.5254,  0.7355]]],


        [[[-0.8006, -0.3062, -0.6871,  ...,  0.1270,  1.1332,  0.8873],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
          [ 0.6302, -1.1326, -0.5021,  ..., -0.6097, -0.2869, -0.3157],
          ...,
          [ 0.0801,  1.0101, -0.2876,  ..., -0.7546, -1.3980, -0.0753],
          [ 1.2224,  0.8198,  0.5919,  ..., -0.1241,  0.2610, -0.7986],
          [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],

         [[-0.7946, -0.2639, -0.5226,  ...,  0.3346,  0.7068,  0.6623],
          [ 0.2103, -0.1083, -0.8729,  ...,  0.3819,  0.3702, -0.0594],
          [ 0.6164, -0.6089, -0.3728,  ..., -1.1235, -0.2961, -0.9568],
          ...,
          [ 0.2236,  0.9353, -0.6744,  ..., -0.7512, -0.8987, -0.2224],
          [ 1.0108,  0.2624,  0.5297,  ..., -0.1756, -0.0412, -0.3897],
          [-0.1264,  0.4861,  0.9915,  ..., -0.0250,  0.9714,  0.2909]],

         [[-0.1159,  0.1130, -0.3371,  ...,  0.3328,  0.8204,  0.3565],
          [-0.0634,  0.2330, -1.6659,  ...,  0.1733,  0.4423, -0.0698],
          [ 0.3264, -0.2658, -0.0469,  ..., -0.5202, -0.0475, -0.8547],
          ...,
          [ 0.1275,  0.6274, -0.3911,  ..., -0.4960, -0.6623, -0.1263],
          [ 1.0917, -0.1137,  0.3101,  ..., -0.3703, -0.2831, -0.2415],
          [ 0.1690,  0.6495,  0.9448,  ...,  0.5008,  0.7224,  0.0127]],

         [[ 0.2483,  0.1560, -0.2720,  ...,  0.2343,  0.8177,  0.2337],
          [-0.1741, -0.2119, -1.5293,  ...,  0.1527,  0.3459, -0.2433],
          [ 0.2394, -0.5205, -0.3178,  ..., -0.7156, -0.2760, -0.7020],
          ...,
          [ 0.2706,  0.4531, -0.4314,  ...,  0.0066, -0.4011,  0.0297],
          [ 1.1011, -0.0896,  0.4119,  ..., -0.2155, -0.1968, -0.3390],
          [-0.1146,  0.5108,  0.7960,  ...,  0.3053,  0.7827, -0.0186]]]],
       grad_fn=<TransposeBackward0>)
context_vec step2:
 tensor([[[-0.8118,  0.5255,  0.2349,  ..., -0.2715,  0.4790,  0.5620],
         [-0.4624,  0.4234,  0.1591,  ...,  0.0675,  0.8336,  0.7171],
         [-0.1371,  0.2489,  0.0898,  ...,  0.4065,  0.5647,  0.8396],
         [-0.0966,  0.0652,  0.1458,  ...,  0.1285,  0.5254,  0.7355]],

        [[-0.8006, -0.3062, -0.6871,  ...,  0.0000,  0.0000,  0.0000],
         [-0.7946, -0.2639, -0.5226,  ..., -0.0250,  0.9714,  0.2909],
         [-0.1159,  0.1130, -0.3371,  ...,  0.5008,  0.7224,  0.0127],
         [ 0.2483,  0.1560, -0.2720,  ...,  0.3053,  0.7827, -0.0186]]],
       grad_fn=<ViewBackward0>)
context_vec step3:
 tensor([[[-0.3622, -0.3547,  0.6001,  ...,  0.7055,  0.7299,  0.2596],
         [-0.0437, -0.0327,  0.1689,  ...,  0.4033,  0.2996,  0.0429],
         [ 0.0671, -0.0642, -0.0726,  ...,  0.4790,  0.3077,  0.1184],
         [-0.1167,  0.0019, -0.0770,  ...,  0.2852,  0.2470,  0.0147]],

        [[-0.5126,  0.1035,  0.0030,  ...,  0.0287, -0.1054, -0.2565],
         [-0.2564,  0.0804, -0.0546,  ...,  0.2090, -0.2704, -0.2325],
         [-0.1011,  0.0024,  0.0142,  ...,  0.2632, -0.0801, -0.3024],
         [-0.0266,  0.1526, -0.0612,  ...,  0.4367, -0.2275, -0.4291]]],
       grad_fn=<ViewBackward0>)
Output shape:  torch.Size([2, 4, 50257])
tensor([[[-0.1469,  0.0212, -0.0808,  ...,  0.5897,  0.3543, -0.4660],
         [-0.1788, -0.2813, -0.7289,  ...,  0.0376,  0.4681, -0.2519],
         [-0.7589, -0.1077,  0.3074,  ...,  0.2868,  1.1091,  0.2850],
         [-1.4565,  0.1867, -0.4038,  ...,  0.3269,  0.4481, -0.2287]],

        [[-0.2061,  0.4634,  0.1757,  ..., -0.2840,  0.3281, -0.4769],
         [ 0.0041, -0.4003, -0.7514,  ...,  0.3916,  0.2014, -0.3160],
         [-0.5383, -0.0121, -0.0592,  ...,  0.0099,  0.7850, -0.5107],
         [-1.1651,  0.1588, -0.3770,  ...,  0.5402,  0.0193,  0.1448]]],
       grad_fn=<UnsafeViewBackward0>)


Model Analysis (params and size)

Total number of parameters: 1,637,792,000
	Token embedding layer shape: torch.Size([50257, 1600])
	Output layer shape: torch.Size([50257, 1600])
Number of trainable parameters considering weight tying:  {1557380800}
params of the out_head piece of the model: 80,411,200
params of the final_norm piece of the model:  3200
Total size of the model: 6.10 GB
