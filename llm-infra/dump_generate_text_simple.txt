encoded:  [15496, 11, 314, 716]
encoded_tensor.shape:  torch.Size([1, 4])
current dir:  /Users/anupkaul/akaul_git/demosthenes-llm/llm-infra 

addnl module path to be used for import:  /Users/anupkaul/akaul_git/demosthenes-llm/llm-infra/../attention/ 

causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-0.2376,    -inf,    -inf,    -inf],
          [-1.4651, -1.9270,    -inf,    -inf],
          [-3.0571,  0.6001, -1.4037,    -inf],
          [-1.8136, -3.6137,  1.4426,  1.4594]],

         [[-3.4753,    -inf,    -inf,    -inf],
          [-0.3892, -1.4524,    -inf,    -inf],
          [-2.5005, -1.6188, -2.7403,    -inf],
          [ 2.5563, -2.1985,  2.6905,  2.3065]],

         [[-0.4514,    -inf,    -inf,    -inf],
          [-0.7668, -3.1076,    -inf,    -inf],
          [-1.7995, -0.7343, -0.0721,    -inf],
          [-0.0371,  3.3833, -3.1568, -1.3507]],

         [[ 0.1974,    -inf,    -inf,    -inf],
          [-0.5377, -2.1754,    -inf,    -inf],
          [-3.8543, -6.8755,  1.7369,    -inf],
          [-2.6404,  0.0709,  4.4687,  0.5130]],

         [[-0.8487,    -inf,    -inf,    -inf],
          [-0.4924, -0.9702,    -inf,    -inf],
          [ 0.5900, -2.0134, -1.4457,    -inf],
          [ 0.7419,  0.4438, -1.4491,  1.0023]],

         [[ 2.9300,    -inf,    -inf,    -inf],
          [-0.5927,  0.1972,    -inf,    -inf],
          [ 3.8712, -2.2786, -0.5599,    -inf],
          [-0.7902, -2.6432, -3.7205, -1.4001]],

         [[ 3.2257,    -inf,    -inf,    -inf],
          [-3.3695,  5.8269,    -inf,    -inf],
          [ 0.8877,  0.6217, -0.0507,    -inf],
          [-0.8333,  3.8472,  0.5835, -4.8795]],

         [[ 3.4468,    -inf,    -inf,    -inf],
          [-1.7952, -3.0500,    -inf,    -inf],
          [ 1.8880,  2.0072,  2.0687,    -inf],
          [ 1.9030, -5.1891,  0.2396, -2.3364]],

         [[ 1.6061,    -inf,    -inf,    -inf],
          [ 2.1489,  2.4694,    -inf,    -inf],
          [ 4.8520,  1.1714,  0.0991,    -inf],
          [ 0.4834,  1.8729,  5.1887,  3.0122]],

         [[ 1.4761,    -inf,    -inf,    -inf],
          [ 1.4660, -3.5071,    -inf,    -inf],
          [ 2.0774, -0.5220, -0.2239,    -inf],
          [ 0.5463, -0.1409, -0.3505,  0.9077]],

         [[ 2.5556,    -inf,    -inf,    -inf],
          [ 3.5269,  3.0923,    -inf,    -inf],
          [ 2.0204,  1.4491, -4.1399,    -inf],
          [ 0.5719,  3.4069,  2.1870,  0.9292]],

         [[-2.6184,    -inf,    -inf,    -inf],
          [-0.4172,  2.5542,    -inf,    -inf],
          [-3.2451,  0.5690,  5.9337,    -inf],
          [ 0.9469, -3.9677,  0.5519, -7.1994]]]])
attn weights tensor:
 tensor([[[[-0.2376,    -inf,    -inf,    -inf],
          [-1.4651, -1.9270,    -inf,    -inf],
          [-3.0571,  0.6001, -1.4037,    -inf],
          [-1.8136, -3.6137,  1.4426,  1.4594]],

         [[-3.4753,    -inf,    -inf,    -inf],
          [-0.3892, -1.4524,    -inf,    -inf],
          [-2.5005, -1.6188, -2.7403,    -inf],
          [ 2.5563, -2.1985,  2.6905,  2.3065]],

         [[-0.4514,    -inf,    -inf,    -inf],
          [-0.7668, -3.1076,    -inf,    -inf],
          [-1.7995, -0.7343, -0.0721,    -inf],
          [-0.0371,  3.3833, -3.1568, -1.3507]],

         [[ 0.1974,    -inf,    -inf,    -inf],
          [-0.5377, -2.1754,    -inf,    -inf],
          [-3.8543, -6.8755,  1.7369,    -inf],
          [-2.6404,  0.0709,  4.4687,  0.5130]],

         [[-0.8487,    -inf,    -inf,    -inf],
          [-0.4924, -0.9702,    -inf,    -inf],
          [ 0.5900, -2.0134, -1.4457,    -inf],
          [ 0.7419,  0.4438, -1.4491,  1.0023]],

         [[ 2.9300,    -inf,    -inf,    -inf],
          [-0.5927,  0.1972,    -inf,    -inf],
          [ 3.8712, -2.2786, -0.5599,    -inf],
          [-0.7902, -2.6432, -3.7205, -1.4001]],

         [[ 3.2257,    -inf,    -inf,    -inf],
          [-3.3695,  5.8269,    -inf,    -inf],
          [ 0.8877,  0.6217, -0.0507,    -inf],
          [-0.8333,  3.8472,  0.5835, -4.8795]],

         [[ 3.4468,    -inf,    -inf,    -inf],
          [-1.7952, -3.0500,    -inf,    -inf],
          [ 1.8880,  2.0072,  2.0687,    -inf],
          [ 1.9030, -5.1891,  0.2396, -2.3364]],

         [[ 1.6061,    -inf,    -inf,    -inf],
          [ 2.1489,  2.4694,    -inf,    -inf],
          [ 4.8520,  1.1714,  0.0991,    -inf],
          [ 0.4834,  1.8729,  5.1887,  3.0122]],

         [[ 1.4761,    -inf,    -inf,    -inf],
          [ 1.4660, -3.5071,    -inf,    -inf],
          [ 2.0774, -0.5220, -0.2239,    -inf],
          [ 0.5463, -0.1409, -0.3505,  0.9077]],

         [[ 2.5556,    -inf,    -inf,    -inf],
          [ 3.5269,  3.0923,    -inf,    -inf],
          [ 2.0204,  1.4491, -4.1399,    -inf],
          [ 0.5719,  3.4069,  2.1870,  0.9292]],

         [[-2.6184,    -inf,    -inf,    -inf],
          [-0.4172,  2.5542,    -inf,    -inf],
          [-3.2451,  0.5690,  5.9337,    -inf],
          [ 0.9469, -3.9677,  0.5519, -7.1994]]]])
context_vec step1:
 tensor([[[[-5.2198e-01, -4.9333e-01, -5.1272e-01,  ...,  2.6122e-01,
           -3.0187e-01, -2.1154e-01],
          [ 1.0928e+00,  2.4533e-01,  4.7127e-01,  ...,  6.3603e-01,
            1.5738e-01,  9.3294e-01],
          [ 3.5666e-01,  8.7198e-01, -3.9371e-01,  ..., -8.4518e-02,
            2.5200e-01, -3.8840e-01],
          ...,
          [ 8.0737e-01,  1.6326e+00, -1.3004e-01,  ..., -5.2559e-01,
            3.9951e-01,  5.1704e-01],
          [-2.1186e-01, -1.7206e-01, -2.7254e-01,  ...,  1.2597e-01,
           -5.4406e-01, -4.3783e-01],
          [-7.7216e-01, -8.0352e-01,  4.2021e-02,  ..., -1.0597e+00,
            1.1797e-01,  3.5046e-01]],

         [[-6.4866e-01, -6.4684e-01, -1.7029e-01,  ..., -1.2367e-01,
            2.6228e-02, -4.5476e-01],
          [ 6.1342e-01,  3.6343e-01,  3.0797e-01,  ...,  8.8775e-01,
            2.8467e-02,  9.6383e-01],
          [ 4.8528e-01,  4.3581e-01, -4.7287e-02,  ...,  1.6299e-01,
            4.0914e-01, -2.8905e-01],
          ...,
          [ 3.0338e-01,  1.1610e+00, -1.6909e-01,  ..., -4.6143e-01,
            6.3242e-01,  1.9627e-01],
          [-5.0668e-02, -1.6568e-01, -1.8152e-01,  ...,  8.1572e-02,
           -7.2863e-02,  2.5835e-01],
          [-2.1813e-01, -3.8043e-01, -5.1511e-02,  ..., -9.5824e-01,
            2.1987e-01,  2.6962e-02]],

         [[-4.7684e-01, -2.2947e-01,  5.6083e-02,  ..., -7.4217e-02,
            3.4324e-02, -3.2020e-01],
          [ 3.4181e-01,  1.9765e-01,  3.5555e-01,  ...,  4.0700e-01,
            1.2771e-01,  8.6625e-01],
          [ 3.6386e-01,  3.4316e-01, -6.9837e-02,  ...,  2.3985e-01,
            2.2903e-01,  5.2125e-02],
          ...,
          [ 7.7704e-02,  6.2066e-01,  2.5083e-01,  ..., -3.0775e-01,
            4.8397e-01, -5.7781e-04],
          [ 7.0328e-03, -6.2980e-02, -2.8651e-01,  ...,  2.8817e-02,
            3.0185e-02,  1.7883e-01],
          [-5.5037e-02, -3.4027e-01,  2.7635e-01,  ..., -5.8592e-01,
            2.6661e-01,  9.5422e-01]],

         [[-3.3395e-01,  4.5726e-02, -1.2179e-02,  ...,  2.2167e-02,
           -1.0614e-01, -2.9199e-01],
          [ 1.7991e-01, -1.7246e-01,  1.9762e-01,  ...,  2.0791e-02,
            2.2651e-02,  6.4128e-01],
          [ 1.8627e-01,  2.5760e-01, -1.1427e-01,  ...,  2.6958e-01,
            2.5652e-01, -2.9811e-02],
          ...,
          [ 6.1142e-02,  9.1881e-02,  1.5394e-01,  ..., -1.6424e-01,
            4.8763e-01,  8.8547e-02],
          [ 9.1542e-02, -1.2835e-01, -3.9042e-01,  ..., -2.5434e-02,
            9.4993e-02,  2.4285e-01],
          [-3.1947e-01, -3.6365e-01,  1.9856e-01,  ..., -6.9420e-01,
            2.6840e-01,  6.5040e-01]]]])
context_vec step2:
 tensor([[[-0.5220, -0.4933, -0.5127,  ..., -1.0597,  0.1180,  0.3505],
         [-0.6487, -0.6468, -0.1703,  ..., -0.9582,  0.2199,  0.0270],
         [-0.4768, -0.2295,  0.0561,  ..., -0.5859,  0.2666,  0.9542],
         [-0.3340,  0.0457, -0.0122,  ..., -0.6942,  0.2684,  0.6504]]])
context_vec step3:
 tensor([[[-0.8231, -0.0712,  0.1164,  ..., -0.3008,  0.0665,  0.5461],
         [-0.4259, -0.1714,  0.3074,  ..., -0.0644,  0.0853,  0.3473],
         [-0.3766, -0.4054,  0.3280,  ..., -0.2183,  0.3885,  0.2661],
         [-0.3000, -0.2909,  0.0634,  ..., -0.0518,  0.0813,  0.1879]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 0.3570,    -inf,    -inf,    -inf],
          [-2.3934, -2.5995,    -inf,    -inf],
          [ 1.0283, -2.1234, -3.7181,    -inf],
          [ 0.3576, -1.5070, -1.4311, -3.0627]],

         [[ 2.8613,    -inf,    -inf,    -inf],
          [ 2.9167,  4.0480,    -inf,    -inf],
          [ 0.1552,  0.5528,  1.0697,    -inf],
          [-2.5656,  2.4430,  5.5220, -2.2809]],

         [[-2.7786,    -inf,    -inf,    -inf],
          [-0.1344,  0.6858,    -inf,    -inf],
          [ 1.6124, -2.2568,  1.4416,    -inf],
          [ 2.1089, -0.8681, -1.2483,  1.2153]],

         [[-1.2068,    -inf,    -inf,    -inf],
          [-6.5329, -0.6028,    -inf,    -inf],
          [ 0.5836, -2.2723, -1.9268,    -inf],
          [ 0.1233, -1.1943,  1.9303,  0.3007]],

         [[-0.4738,    -inf,    -inf,    -inf],
          [-4.8768,  0.1338,    -inf,    -inf],
          [ 1.3169,  3.7109, -3.7899,    -inf],
          [-2.6045,  4.4472,  1.0173,  1.7052]],

         [[-3.6585,    -inf,    -inf,    -inf],
          [ 0.1575, -0.3510,    -inf,    -inf],
          [-4.4031,  3.2371,  1.9545,    -inf],
          [-5.8565, -3.8741, -2.0408,  2.5608]],

         [[-3.8502,    -inf,    -inf,    -inf],
          [-4.1169, -2.9010,    -inf,    -inf],
          [-4.6494,  4.9215, -3.9612,    -inf],
          [ 1.6790, -2.4367,  6.6089,  5.9158]],

         [[-3.3033,    -inf,    -inf,    -inf],
          [ 3.5526, -6.7779,    -inf,    -inf],
          [-0.7587, -4.7892,  2.5348,    -inf],
          [-0.8967, -0.9013, -3.6731, -0.1601]],

         [[ 0.4822,    -inf,    -inf,    -inf],
          [-2.5759, -2.9883,    -inf,    -inf],
          [ 0.4943, -2.2640,  4.6742,    -inf],
          [ 3.7496, -0.2752,  3.1304, -2.2199]],

         [[ 3.2645,    -inf,    -inf,    -inf],
          [ 2.9623,  1.5131,    -inf,    -inf],
          [ 4.2805, -2.3820, -1.1526,    -inf],
          [-1.0040,  3.0163,  1.4838, -6.6383]],

         [[ 1.7970,    -inf,    -inf,    -inf],
          [-0.6017, -3.5400,    -inf,    -inf],
          [ 1.3968, -0.8890,  1.0269,    -inf],
          [-4.0184,  4.2483,  5.4254, -1.0686]],

         [[ 4.4750,    -inf,    -inf,    -inf],
          [-0.8759, -5.0003,    -inf,    -inf],
          [ 2.8575, -4.0604, -0.2405,    -inf],
          [ 5.3255,  3.0293,  3.5006,  4.2808]]]])
attn weights tensor:
 tensor([[[[ 0.3570,    -inf,    -inf,    -inf],
          [-2.3934, -2.5995,    -inf,    -inf],
          [ 1.0283, -2.1234, -3.7181,    -inf],
          [ 0.3576, -1.5070, -1.4311, -3.0627]],

         [[ 2.8613,    -inf,    -inf,    -inf],
          [ 2.9167,  4.0480,    -inf,    -inf],
          [ 0.1552,  0.5528,  1.0697,    -inf],
          [-2.5656,  2.4430,  5.5220, -2.2809]],

         [[-2.7786,    -inf,    -inf,    -inf],
          [-0.1344,  0.6858,    -inf,    -inf],
          [ 1.6124, -2.2568,  1.4416,    -inf],
          [ 2.1089, -0.8681, -1.2483,  1.2153]],

         [[-1.2068,    -inf,    -inf,    -inf],
          [-6.5329, -0.6028,    -inf,    -inf],
          [ 0.5836, -2.2723, -1.9268,    -inf],
          [ 0.1233, -1.1943,  1.9303,  0.3007]],

         [[-0.4738,    -inf,    -inf,    -inf],
          [-4.8768,  0.1338,    -inf,    -inf],
          [ 1.3169,  3.7109, -3.7899,    -inf],
          [-2.6045,  4.4472,  1.0173,  1.7052]],

         [[-3.6585,    -inf,    -inf,    -inf],
          [ 0.1575, -0.3510,    -inf,    -inf],
          [-4.4031,  3.2371,  1.9545,    -inf],
          [-5.8565, -3.8741, -2.0408,  2.5608]],

         [[-3.8502,    -inf,    -inf,    -inf],
          [-4.1169, -2.9010,    -inf,    -inf],
          [-4.6494,  4.9215, -3.9612,    -inf],
          [ 1.6790, -2.4367,  6.6089,  5.9158]],

         [[-3.3033,    -inf,    -inf,    -inf],
          [ 3.5526, -6.7779,    -inf,    -inf],
          [-0.7587, -4.7892,  2.5348,    -inf],
          [-0.8967, -0.9013, -3.6731, -0.1601]],

         [[ 0.4822,    -inf,    -inf,    -inf],
          [-2.5759, -2.9883,    -inf,    -inf],
          [ 0.4943, -2.2640,  4.6742,    -inf],
          [ 3.7496, -0.2752,  3.1304, -2.2199]],

         [[ 3.2645,    -inf,    -inf,    -inf],
          [ 2.9623,  1.5131,    -inf,    -inf],
          [ 4.2805, -2.3820, -1.1526,    -inf],
          [-1.0040,  3.0163,  1.4838, -6.6383]],

         [[ 1.7970,    -inf,    -inf,    -inf],
          [-0.6017, -3.5400,    -inf,    -inf],
          [ 1.3968, -0.8890,  1.0269,    -inf],
          [-4.0184,  4.2483,  5.4254, -1.0686]],

         [[ 4.4750,    -inf,    -inf,    -inf],
          [-0.8759, -5.0003,    -inf,    -inf],
          [ 2.8575, -4.0604, -0.2405,    -inf],
          [ 5.3255,  3.0293,  3.5006,  4.2808]]]])
context_vec step1:
 tensor([[[[-0.3111, -0.5813,  0.2765,  ..., -0.4734,  0.1640, -0.1338],
          [-0.4453, -0.4612, -0.6976,  ..., -1.4026,  0.2379, -0.4129],
          [ 0.5196,  0.5629,  1.3764,  ..., -0.2109, -0.3909,  0.6583],
          ...,
          [ 0.1895,  0.1545,  0.3840,  ..., -0.4799, -0.5147,  0.5174],
          [-0.5552, -0.6812, -0.6827,  ..., -1.3519, -0.8631,  0.3006],
          [ 0.1030, -0.4396, -0.0251,  ...,  0.1414, -1.3195,  0.2850]],

         [[-0.1762, -0.1172,  0.3338,  ..., -0.0462,  0.0131, -0.2363],
          [-0.1896, -0.5944, -0.1845,  ..., -0.7419,  0.2462, -0.0354],
          [ 0.3614,  0.4451,  0.9773,  ..., -0.6299,  0.0116,  0.5444],
          ...,
          [ 0.0366,  0.0410,  0.3775,  ..., -0.3719,  0.0081,  0.6017],
          [ 0.2203, -0.6034, -0.2825,  ..., -0.9023, -0.7263,  0.4717],
          [ 0.3654, -0.2410, -0.0775,  ..., -0.3245, -0.8616,  0.3964]],

         [[-0.0347, -0.1996,  0.0223,  ..., -0.2727, -0.0519, -0.0757],
          [ 0.1156, -0.1421, -0.3397,  ..., -0.7169,  0.1340, -0.2010],
          [ 0.3795,  0.7116,  0.8786,  ..., -0.2987,  0.0774,  0.5298],
          ...,
          [ 0.1811, -0.1097,  0.5868,  ..., -0.3326,  0.2425,  0.6242],
          [ 0.2323, -0.7593, -0.0059,  ..., -0.3214, -0.6580,  0.2467],
          [-0.0560, -0.4367, -0.2074,  ..., -0.1992, -0.6000,  0.2197]],

         [[ 0.0984, -0.1631, -0.1712,  ..., -0.3301, -0.0186, -0.1177],
          [ 0.2093,  0.1975, -0.2099,  ..., -0.6655,  0.2045, -0.2308],
          [ 0.4831,  0.8186,  0.1440,  ..., -0.1935, -0.0727,  0.0752],
          ...,
          [ 0.0123, -0.2628,  0.4786,  ..., -0.3294,  0.5386,  0.6542],
          [ 0.3936, -0.5496,  0.1497,  ...,  0.1916, -0.4362,  0.2109],
          [ 0.1598, -0.4764, -0.2095,  ..., -0.1736, -0.1577,  0.1337]]]])
context_vec step2:
 tensor([[[-0.3111, -0.5813,  0.2765,  ...,  0.1414, -1.3195,  0.2850],
         [-0.1762, -0.1172,  0.3338,  ..., -0.3245, -0.8616,  0.3964],
         [-0.0347, -0.1996,  0.0223,  ..., -0.1992, -0.6000,  0.2197],
         [ 0.0984, -0.1631, -0.1712,  ..., -0.1736, -0.1577,  0.1337]]])
context_vec step3:
 tensor([[[ 0.3969,  0.1280, -0.4097,  ..., -0.0303,  0.4214,  0.0588],
         [ 0.2074,  0.1958, -0.1087,  ..., -0.3332,  0.2825,  0.0343],
         [ 0.1367,  0.2547, -0.0950,  ..., -0.0818,  0.2490, -0.0588],
         [ 0.1617,  0.1993,  0.0580,  ..., -0.1455,  0.0551,  0.0216]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-2.4015,    -inf,    -inf,    -inf],
          [ 2.5212,  0.7583,    -inf,    -inf],
          [ 5.7514,  3.1604,  0.4880,    -inf],
          [ 0.2398,  1.8802, -1.4103, -1.1528]],

         [[-1.2920,    -inf,    -inf,    -inf],
          [-0.3057, -2.4039,    -inf,    -inf],
          [ 0.5632,  3.0062,  0.8840,    -inf],
          [-2.2756,  2.2035, -2.7424,  1.0682]],

         [[ 2.3924,    -inf,    -inf,    -inf],
          [ 3.2037,  0.0419,    -inf,    -inf],
          [-2.0999, -0.7384, -2.2661,    -inf],
          [ 1.3299,  2.0652, -0.3914,  3.9440]],

         [[-2.4088,    -inf,    -inf,    -inf],
          [-1.4439,  4.2856,    -inf,    -inf],
          [-1.1339, -0.2396,  0.8836,    -inf],
          [-1.1864,  3.8895,  0.1582,  0.6841]],

         [[-0.4339,    -inf,    -inf,    -inf],
          [ 2.1188,  2.2431,    -inf,    -inf],
          [ 1.2619, -3.1218, -1.3884,    -inf],
          [-1.7359, -2.2633,  3.4703, -1.8377]],

         [[ 1.1160,    -inf,    -inf,    -inf],
          [-1.5408,  2.4514,    -inf,    -inf],
          [ 1.7441,  2.9481,  0.4755,    -inf],
          [-1.4557, -1.7770,  2.2157, -0.5064]],

         [[-1.2868,    -inf,    -inf,    -inf],
          [-2.7141, -0.7041,    -inf,    -inf],
          [-1.3106, -1.5126,  3.8879,    -inf],
          [-0.4583,  0.4929, -0.6579, -4.9429]],

         [[ 3.2645,    -inf,    -inf,    -inf],
          [-2.2640, -2.0777,    -inf,    -inf],
          [-1.6199, -3.0925,  0.8709,    -inf],
          [-4.0417,  1.1535,  0.1133, -1.0336]],

         [[-1.5883,    -inf,    -inf,    -inf],
          [-1.5203, -3.0192,    -inf,    -inf],
          [ 0.8965, -0.6330, -2.1658,    -inf],
          [-2.7036,  3.7179, -2.5289,  2.7308]],

         [[ 0.1937,    -inf,    -inf,    -inf],
          [ 6.1826,  0.2865,    -inf,    -inf],
          [-0.2087, -0.0258, -0.8561,    -inf],
          [ 2.9372, -5.9976, -1.9376,  4.1004]],

         [[ 2.6899,    -inf,    -inf,    -inf],
          [ 1.0465, -0.4038,    -inf,    -inf],
          [-2.4419,  1.6957, -0.3902,    -inf],
          [-3.6169, -3.0123,  2.5429,  0.9707]],

         [[ 6.8112,    -inf,    -inf,    -inf],
          [ 3.8521,  0.7375,    -inf,    -inf],
          [ 4.2124,  1.8148, -2.7062,    -inf],
          [ 2.0151,  2.0380,  0.0681, -1.1365]]]])
attn weights tensor:
 tensor([[[[-2.4015,    -inf,    -inf,    -inf],
          [ 2.5212,  0.7583,    -inf,    -inf],
          [ 5.7514,  3.1604,  0.4880,    -inf],
          [ 0.2398,  1.8802, -1.4103, -1.1528]],

         [[-1.2920,    -inf,    -inf,    -inf],
          [-0.3057, -2.4039,    -inf,    -inf],
          [ 0.5632,  3.0062,  0.8840,    -inf],
          [-2.2756,  2.2035, -2.7424,  1.0682]],

         [[ 2.3924,    -inf,    -inf,    -inf],
          [ 3.2037,  0.0419,    -inf,    -inf],
          [-2.0999, -0.7384, -2.2661,    -inf],
          [ 1.3299,  2.0652, -0.3914,  3.9440]],

         [[-2.4088,    -inf,    -inf,    -inf],
          [-1.4439,  4.2856,    -inf,    -inf],
          [-1.1339, -0.2396,  0.8836,    -inf],
          [-1.1864,  3.8895,  0.1582,  0.6841]],

         [[-0.4339,    -inf,    -inf,    -inf],
          [ 2.1188,  2.2431,    -inf,    -inf],
          [ 1.2619, -3.1218, -1.3884,    -inf],
          [-1.7359, -2.2633,  3.4703, -1.8377]],

         [[ 1.1160,    -inf,    -inf,    -inf],
          [-1.5408,  2.4514,    -inf,    -inf],
          [ 1.7441,  2.9481,  0.4755,    -inf],
          [-1.4557, -1.7770,  2.2157, -0.5064]],

         [[-1.2868,    -inf,    -inf,    -inf],
          [-2.7141, -0.7041,    -inf,    -inf],
          [-1.3106, -1.5126,  3.8879,    -inf],
          [-0.4583,  0.4929, -0.6579, -4.9429]],

         [[ 3.2645,    -inf,    -inf,    -inf],
          [-2.2640, -2.0777,    -inf,    -inf],
          [-1.6199, -3.0925,  0.8709,    -inf],
          [-4.0417,  1.1535,  0.1133, -1.0336]],

         [[-1.5883,    -inf,    -inf,    -inf],
          [-1.5203, -3.0192,    -inf,    -inf],
          [ 0.8965, -0.6330, -2.1658,    -inf],
          [-2.7036,  3.7179, -2.5289,  2.7308]],

         [[ 0.1937,    -inf,    -inf,    -inf],
          [ 6.1826,  0.2865,    -inf,    -inf],
          [-0.2087, -0.0258, -0.8561,    -inf],
          [ 2.9372, -5.9976, -1.9376,  4.1004]],

         [[ 2.6899,    -inf,    -inf,    -inf],
          [ 1.0465, -0.4038,    -inf,    -inf],
          [-2.4419,  1.6957, -0.3902,    -inf],
          [-3.6169, -3.0123,  2.5429,  0.9707]],

         [[ 6.8112,    -inf,    -inf,    -inf],
          [ 3.8521,  0.7375,    -inf,    -inf],
          [ 4.2124,  1.8148, -2.7062,    -inf],
          [ 2.0151,  2.0380,  0.0681, -1.1365]]]])
context_vec step1:
 tensor([[[[ 1.2042e+00, -7.6336e-02, -1.2392e+00,  ..., -4.6633e-01,
            7.4751e-01,  2.4345e-01],
          [ 1.2750e+00,  2.2794e-03, -1.2233e+00,  ...,  9.8996e-01,
           -6.4672e-01, -8.3666e-01],
          [-2.5799e-01, -3.2760e-01, -1.8073e-01,  ...,  5.4290e-01,
           -7.2971e-01, -2.5741e-01],
          ...,
          [-6.8654e-02, -2.4721e-02,  3.7950e-01,  ..., -5.6678e-01,
            9.3256e-01,  9.4952e-01],
          [ 4.1788e-01, -1.9682e-01,  5.2476e-01,  ...,  9.1707e-02,
            6.5069e-01,  1.4462e-01],
          [ 2.0542e-02, -4.2395e-01,  7.2274e-01,  ..., -1.7053e-01,
            1.4483e-01,  1.1440e-01]],

         [[ 7.2455e-01, -1.8427e-01, -9.9398e-01,  ..., -1.7920e-01,
            1.2521e-01, -1.9563e-01],
          [ 8.4937e-01,  5.3171e-02, -5.2063e-01,  ...,  5.0250e-01,
           -6.7404e-01, -4.9332e-01],
          [-3.1142e-02, -2.5617e-01, -2.5983e-01,  ...,  8.2988e-02,
           -5.4088e-01,  1.3655e-02],
          ...,
          [-1.3705e-01,  8.3500e-02,  2.8634e-01,  ..., -4.2391e-01,
            4.5161e-01,  4.4868e-01],
          [ 1.3460e-01,  1.1127e-01,  1.2541e-01,  ..., -3.1172e-02,
            5.9304e-02, -5.4881e-04],
          [-4.0032e-01, -3.9404e-01,  3.6944e-01,  ..., -5.8290e-01,
           -7.4076e-02, -1.4951e-01]],

         [[ 6.1591e-01, -3.8085e-01, -9.3668e-01,  ..., -3.5912e-01,
            5.2533e-02, -3.9131e-02],
          [ 4.6340e-01,  1.1404e-01, -1.4313e-02,  ..., -9.9121e-02,
           -6.3218e-01, -9.5276e-02],
          [ 1.5732e-01, -2.5688e-01, -1.8588e-02,  ..., -7.6029e-03,
           -2.1117e-01,  2.2410e-01],
          ...,
          [-1.9305e-01, -7.2342e-03,  1.4849e-01,  ..., -2.5991e-01,
            1.7168e-01,  2.1392e-01],
          [-2.2684e-01,  2.5752e-01,  2.7018e-01,  ..., -2.5329e-01,
           -8.1919e-02,  4.5898e-02],
          [-2.7509e-01, -1.5133e-01,  1.8357e-01,  ..., -3.4729e-01,
            7.1423e-02, -2.0390e-01]],

         [[ 5.0784e-01, -1.8201e-01, -8.0226e-01,  ..., -4.8208e-01,
            1.4880e-01, -7.6496e-02],
          [ 2.3914e-01, -1.6406e-01, -2.1536e-03,  ...,  1.8729e-01,
           -9.0088e-02, -7.7634e-03],
          [-2.8176e-02, -1.7645e-02, -3.9094e-01,  ..., -2.2187e-01,
           -2.7595e-01,  3.8539e-01],
          ...,
          [ 4.8442e-02, -5.1854e-02,  3.2400e-01,  ..., -1.4794e-01,
           -4.4357e-02,  5.3179e-01],
          [-1.7987e-01, -9.6091e-02,  3.8530e-01,  ..., -3.0329e-01,
           -1.1929e-01,  4.0769e-01],
          [-2.7434e-01,  3.5653e-01,  1.4978e-01,  ..., -1.0694e-01,
            1.3766e-01, -3.0222e-01]]]])
context_vec step2:
 tensor([[[ 1.2042, -0.0763, -1.2392,  ..., -0.1705,  0.1448,  0.1144],
         [ 0.7245, -0.1843, -0.9940,  ..., -0.5829, -0.0741, -0.1495],
         [ 0.6159, -0.3809, -0.9367,  ..., -0.3473,  0.0714, -0.2039],
         [ 0.5078, -0.1820, -0.8023,  ..., -0.1069,  0.1377, -0.3022]]])
context_vec step3:
 tensor([[[-0.0532,  0.0739, -0.3869,  ...,  0.1890, -0.2707,  0.4490],
         [-0.1852, -0.0571, -0.4853,  ...,  0.2067,  0.0944, -0.0734],
         [-0.3321, -0.1419, -0.2013,  ...,  0.1394,  0.3130,  0.0592],
         [-0.3077, -0.0757,  0.0099,  ...,  0.1973,  0.1232, -0.0454]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.3761,    -inf,    -inf,    -inf],
          [ 0.6012,  1.7419,    -inf,    -inf],
          [ 0.9145,  4.9879,  2.4978,    -inf],
          [ 2.2050, -7.2312, -4.4518,  0.5533]],

         [[-2.7870,    -inf,    -inf,    -inf],
          [-4.0423, -0.4837,    -inf,    -inf],
          [-1.7310,  1.0126,  0.8893,    -inf],
          [ 1.4216, -0.8746, -0.5035,  3.6392]],

         [[-3.0747,    -inf,    -inf,    -inf],
          [-2.3686, -2.1308,    -inf,    -inf],
          [ 5.2740, -2.5202,  2.8448,    -inf],
          [-0.8512,  0.8769,  1.4541,  3.1641]],

         [[-2.4288,    -inf,    -inf,    -inf],
          [-2.1378, -0.5420,    -inf,    -inf],
          [-2.9931, -2.0328, -0.9865,    -inf],
          [-4.2237,  1.2402, -0.1214,  0.2413]],

         [[ 2.1764,    -inf,    -inf,    -inf],
          [ 4.8287,  2.3936,    -inf,    -inf],
          [ 1.6714,  1.8451, -3.0547,    -inf],
          [ 1.5014, -1.8815,  0.6523, -0.4967]],

         [[ 2.2508,    -inf,    -inf,    -inf],
          [-0.5679, -4.4257,    -inf,    -inf],
          [ 1.4975,  2.0465, -0.1300,    -inf],
          [-5.5077, -0.9600, -3.5238, -0.8400]],

         [[ 0.4052,    -inf,    -inf,    -inf],
          [-0.4098,  0.6727,    -inf,    -inf],
          [-0.5800,  1.2229,  5.2978,    -inf],
          [-1.3677,  4.6143,  3.5536,  0.0147]],

         [[-1.6593,    -inf,    -inf,    -inf],
          [ 1.7782, -4.4282,    -inf,    -inf],
          [ 0.3212, -5.8414,  2.3241,    -inf],
          [-2.1941, -5.5930,  2.2760,  1.4716]],

         [[-1.7668,    -inf,    -inf,    -inf],
          [ 1.6954, -0.4651,    -inf,    -inf],
          [ 4.9301,  0.1760,  4.2266,    -inf],
          [-1.3209,  2.3890,  4.6776, -1.4498]],

         [[-0.8192,    -inf,    -inf,    -inf],
          [ 0.3405,  2.5706,    -inf,    -inf],
          [ 0.8656,  0.3112,  0.0488,    -inf],
          [ 0.3293, -1.3145, -0.9297, -0.5785]],

         [[-1.5534,    -inf,    -inf,    -inf],
          [-2.5890,  1.1658,    -inf,    -inf],
          [ 0.7944,  0.9979,  3.2129,    -inf],
          [-0.9710, -3.1342,  2.7326,  3.1790]],

         [[-1.9844,    -inf,    -inf,    -inf],
          [-0.3301, -0.8004,    -inf,    -inf],
          [ 0.4042,  1.4781,  4.3863,    -inf],
          [ 4.1158, -2.9247, -2.4343,  2.5515]]]])
attn weights tensor:
 tensor([[[[ 1.3761,    -inf,    -inf,    -inf],
          [ 0.6012,  1.7419,    -inf,    -inf],
          [ 0.9145,  4.9879,  2.4978,    -inf],
          [ 2.2050, -7.2312, -4.4518,  0.5533]],

         [[-2.7870,    -inf,    -inf,    -inf],
          [-4.0423, -0.4837,    -inf,    -inf],
          [-1.7310,  1.0126,  0.8893,    -inf],
          [ 1.4216, -0.8746, -0.5035,  3.6392]],

         [[-3.0747,    -inf,    -inf,    -inf],
          [-2.3686, -2.1308,    -inf,    -inf],
          [ 5.2740, -2.5202,  2.8448,    -inf],
          [-0.8512,  0.8769,  1.4541,  3.1641]],

         [[-2.4288,    -inf,    -inf,    -inf],
          [-2.1378, -0.5420,    -inf,    -inf],
          [-2.9931, -2.0328, -0.9865,    -inf],
          [-4.2237,  1.2402, -0.1214,  0.2413]],

         [[ 2.1764,    -inf,    -inf,    -inf],
          [ 4.8287,  2.3936,    -inf,    -inf],
          [ 1.6714,  1.8451, -3.0547,    -inf],
          [ 1.5014, -1.8815,  0.6523, -0.4967]],

         [[ 2.2508,    -inf,    -inf,    -inf],
          [-0.5679, -4.4257,    -inf,    -inf],
          [ 1.4975,  2.0465, -0.1300,    -inf],
          [-5.5077, -0.9600, -3.5238, -0.8400]],

         [[ 0.4052,    -inf,    -inf,    -inf],
          [-0.4098,  0.6727,    -inf,    -inf],
          [-0.5800,  1.2229,  5.2978,    -inf],
          [-1.3677,  4.6143,  3.5536,  0.0147]],

         [[-1.6593,    -inf,    -inf,    -inf],
          [ 1.7782, -4.4282,    -inf,    -inf],
          [ 0.3212, -5.8414,  2.3241,    -inf],
          [-2.1941, -5.5930,  2.2760,  1.4716]],

         [[-1.7668,    -inf,    -inf,    -inf],
          [ 1.6954, -0.4651,    -inf,    -inf],
          [ 4.9301,  0.1760,  4.2266,    -inf],
          [-1.3209,  2.3890,  4.6776, -1.4498]],

         [[-0.8192,    -inf,    -inf,    -inf],
          [ 0.3405,  2.5706,    -inf,    -inf],
          [ 0.8656,  0.3112,  0.0488,    -inf],
          [ 0.3293, -1.3145, -0.9297, -0.5785]],

         [[-1.5534,    -inf,    -inf,    -inf],
          [-2.5890,  1.1658,    -inf,    -inf],
          [ 0.7944,  0.9979,  3.2129,    -inf],
          [-0.9710, -3.1342,  2.7326,  3.1790]],

         [[-1.9844,    -inf,    -inf,    -inf],
          [-0.3301, -0.8004,    -inf,    -inf],
          [ 0.4042,  1.4781,  4.3863,    -inf],
          [ 4.1158, -2.9247, -2.4343,  2.5515]]]])
context_vec step1:
 tensor([[[[-1.4755e-01,  7.4604e-01, -6.5947e-01,  ...,  2.4483e-02,
            4.0763e-01,  1.6887e-02],
          [-1.7426e+00, -2.7257e-01, -1.8450e-01,  ...,  1.1315e+00,
           -1.0828e-01,  5.4643e-02],
          [ 1.0177e-01, -1.3893e-01, -1.9417e-01,  ...,  5.5002e-01,
            8.1895e-01,  7.4830e-01],
          ...,
          [ 3.8453e-01,  1.8009e-01,  1.3879e-01,  ...,  1.1019e+00,
            7.3674e-01, -2.8495e-02],
          [ 4.6427e-01, -8.0582e-02, -9.4763e-02,  ...,  5.0886e-01,
            6.3624e-02, -1.7921e-01],
          [ 2.6083e-02,  6.5238e-01, -2.2252e-01,  ..., -2.1170e-01,
            7.3941e-01, -1.2711e+00]],

         [[-6.6525e-02, -2.1538e-01,  5.5373e-02,  ..., -2.3844e-01,
            2.2073e-01, -1.2101e-01],
          [-1.0372e+00, -7.0164e-01, -8.5610e-02,  ...,  6.9067e-01,
           -3.6643e-01, -2.5166e-01],
          [ 1.1333e-01, -3.0279e-01, -3.7870e-03,  ...,  6.2864e-01,
            1.0247e+00,  1.9243e-01],
          ...,
          [-5.1152e-01, -1.5743e-01,  7.1684e-01,  ...,  8.2498e-01,
            1.0683e+00, -2.1036e-02],
          [ 6.3780e-02,  9.8129e-02, -4.2108e-01,  ...,  5.4816e-01,
            1.7461e-01, -5.4354e-01],
          [-5.1582e-02,  6.0793e-01, -5.9477e-03,  ..., -2.0400e-01,
            6.0124e-01, -6.9943e-01]],

         [[ 7.1048e-03,  7.8224e-02,  5.6234e-02,  ...,  1.0334e-01,
            3.9239e-01, -4.3226e-03],
          [-7.1098e-01, -2.7314e-01, -1.4557e-01,  ...,  3.5864e-01,
           -2.8673e-01, -2.3551e-01],
          [-3.5073e-02,  2.7564e-02,  9.2564e-02,  ...,  5.3378e-01,
            4.6719e-01,  5.7555e-02],
          ...,
          [-1.4846e-01, -1.6597e-01,  6.8854e-01,  ...,  9.1881e-01,
            6.4120e-01,  1.6437e-01],
          [ 2.3059e-01, -1.4872e-01, -3.5813e-01,  ...,  4.8331e-01,
            1.8284e-01, -2.0765e-01],
          [-3.2809e-01,  2.5599e-01,  1.6721e-01,  ...,  3.7972e-01,
            6.3833e-01, -4.4386e-02]],

         [[ 2.4766e-02,  5.3776e-01,  3.8141e-02,  ...,  1.0013e-01,
            1.5726e-01,  1.2406e-01],
          [-6.0004e-01, -2.5387e-01, -2.9775e-01,  ...,  4.4086e-01,
           -4.2579e-01, -9.0873e-02],
          [-3.1362e-02,  2.6113e-01,  4.0942e-01,  ...,  1.7392e-01,
            3.1770e-01, -2.8955e-01],
          ...,
          [ 1.2142e-03, -1.2017e-01,  4.9686e-01,  ...,  5.6476e-01,
            6.5144e-01,  3.1652e-03],
          [ 4.8310e-01,  1.1015e-01, -3.3594e-01,  ..., -1.1589e-01,
            1.9693e-01, -4.8335e-03],
          [-3.3772e-01,  1.0268e-01, -1.0099e-01,  ..., -7.2167e-02,
            7.4899e-01, -4.8572e-01]]]])
context_vec step2:
 tensor([[[-0.1476,  0.7460, -0.6595,  ..., -0.2117,  0.7394, -1.2711],
         [-0.0665, -0.2154,  0.0554,  ..., -0.2040,  0.6012, -0.6994],
         [ 0.0071,  0.0782,  0.0562,  ...,  0.3797,  0.6383, -0.0444],
         [ 0.0248,  0.5378,  0.0381,  ..., -0.0722,  0.7490, -0.4857]]])
context_vec step3:
 tensor([[[ 0.2879, -0.3458, -0.2393,  ..., -0.1860,  0.3873, -0.0533],
         [ 0.5031, -0.1107, -0.1236,  ..., -0.0232,  0.1513, -0.0692],
         [ 0.1947, -0.2222,  0.0512,  ...,  0.0286, -0.0748, -0.0466],
         [ 0.0903, -0.2237,  0.1153,  ..., -0.0173, -0.1307, -0.1179]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-1.3220e+00,        -inf,        -inf,        -inf],
          [-2.0045e+00,  8.9898e-01,        -inf,        -inf],
          [ 1.2827e+00, -6.8516e-01, -1.1422e+00,        -inf],
          [ 2.2355e+00,  2.8086e+00, -1.6028e+00,  1.9049e+00]],

         [[ 9.6264e-01,        -inf,        -inf,        -inf],
          [-4.0348e-01, -2.2556e+00,        -inf,        -inf],
          [ 7.2566e-01, -5.3747e-03, -6.9076e-01,        -inf],
          [ 2.6825e+00, -1.1662e+00,  4.0899e+00, -1.0189e+00]],

         [[ 1.1645e+00,        -inf,        -inf,        -inf],
          [ 3.6562e+00, -1.3414e+00,        -inf,        -inf],
          [ 1.6228e+00, -4.2355e+00, -1.6948e-01,        -inf],
          [-4.1983e+00, -5.0987e+00, -1.4983e-01, -2.2038e+00]],

         [[-3.5677e+00,        -inf,        -inf,        -inf],
          [-2.0192e+00, -1.5448e+00,        -inf,        -inf],
          [-5.2060e+00, -1.5876e+00,  3.8029e+00,        -inf],
          [-3.0689e+00,  1.2833e+00,  2.6184e+00,  1.4875e+00]],

         [[-3.4797e-01,        -inf,        -inf,        -inf],
          [-1.3997e+00, -4.0008e+00,        -inf,        -inf],
          [-1.0093e+00, -1.2778e+00, -1.2097e+00,        -inf],
          [ 8.3254e-01,  1.5218e+00,  2.8581e+00, -1.1777e+00]],

         [[ 4.2763e-01,        -inf,        -inf,        -inf],
          [ 9.3183e-01,  3.0881e+00,        -inf,        -inf],
          [ 3.9008e+00,  5.0640e+00,  5.9272e+00,        -inf],
          [ 2.2721e-01,  3.1327e+00,  5.6776e+00,  4.0494e-02]],

         [[ 2.2413e+00,        -inf,        -inf,        -inf],
          [ 5.0121e-01,  1.1188e+00,        -inf,        -inf],
          [ 6.7346e-02, -3.4231e+00, -4.2563e+00,        -inf],
          [-3.0347e+00, -3.0763e+00, -3.7974e+00,  8.5984e-01]],

         [[-3.6131e+00,        -inf,        -inf,        -inf],
          [ 2.5136e+00, -4.8090e-01,        -inf,        -inf],
          [-1.4568e+00, -1.5939e+00,  2.0225e+00,        -inf],
          [-3.1705e+00, -1.6861e+00,  3.6874e+00, -1.3908e-01]],

         [[ 1.5922e+00,        -inf,        -inf,        -inf],
          [ 3.0629e-01, -1.4089e+00,        -inf,        -inf],
          [ 3.3311e+00,  7.8558e-01,  4.1966e+00,        -inf],
          [ 3.4134e+00,  5.8520e-01, -3.7940e+00, -4.3063e+00]],

         [[ 1.3707e-01,        -inf,        -inf,        -inf],
          [ 1.4935e+00,  4.5922e-01,        -inf,        -inf],
          [ 6.8109e+00, -1.8777e+00,  1.1949e-01,        -inf],
          [ 4.4912e+00,  4.1477e+00,  2.1142e+00,  1.1439e+00]],

         [[ 1.1292e+00,        -inf,        -inf,        -inf],
          [-1.6126e+00,  1.1684e+00,        -inf,        -inf],
          [ 3.6028e+00,  5.3408e-01,  6.8429e+00,        -inf],
          [-1.0253e-01,  3.1961e+00,  1.6055e+00,  6.8790e-01]],

         [[ 1.2644e+00,        -inf,        -inf,        -inf],
          [-3.5980e+00, -3.9234e+00,        -inf,        -inf],
          [ 8.0076e-01,  2.8230e-01, -1.9376e+00,        -inf],
          [ 3.5299e+00,  7.5625e-01,  4.6777e+00,  5.8384e+00]]]])
attn weights tensor:
 tensor([[[[-1.3220e+00,        -inf,        -inf,        -inf],
          [-2.0045e+00,  8.9898e-01,        -inf,        -inf],
          [ 1.2827e+00, -6.8516e-01, -1.1422e+00,        -inf],
          [ 2.2355e+00,  2.8086e+00, -1.6028e+00,  1.9049e+00]],

         [[ 9.6264e-01,        -inf,        -inf,        -inf],
          [-4.0348e-01, -2.2556e+00,        -inf,        -inf],
          [ 7.2566e-01, -5.3747e-03, -6.9076e-01,        -inf],
          [ 2.6825e+00, -1.1662e+00,  4.0899e+00, -1.0189e+00]],

         [[ 1.1645e+00,        -inf,        -inf,        -inf],
          [ 3.6562e+00, -1.3414e+00,        -inf,        -inf],
          [ 1.6228e+00, -4.2355e+00, -1.6948e-01,        -inf],
          [-4.1983e+00, -5.0987e+00, -1.4983e-01, -2.2038e+00]],

         [[-3.5677e+00,        -inf,        -inf,        -inf],
          [-2.0192e+00, -1.5448e+00,        -inf,        -inf],
          [-5.2060e+00, -1.5876e+00,  3.8029e+00,        -inf],
          [-3.0689e+00,  1.2833e+00,  2.6184e+00,  1.4875e+00]],

         [[-3.4797e-01,        -inf,        -inf,        -inf],
          [-1.3997e+00, -4.0008e+00,        -inf,        -inf],
          [-1.0093e+00, -1.2778e+00, -1.2097e+00,        -inf],
          [ 8.3254e-01,  1.5218e+00,  2.8581e+00, -1.1777e+00]],

         [[ 4.2763e-01,        -inf,        -inf,        -inf],
          [ 9.3183e-01,  3.0881e+00,        -inf,        -inf],
          [ 3.9008e+00,  5.0640e+00,  5.9272e+00,        -inf],
          [ 2.2721e-01,  3.1327e+00,  5.6776e+00,  4.0494e-02]],

         [[ 2.2413e+00,        -inf,        -inf,        -inf],
          [ 5.0121e-01,  1.1188e+00,        -inf,        -inf],
          [ 6.7346e-02, -3.4231e+00, -4.2563e+00,        -inf],
          [-3.0347e+00, -3.0763e+00, -3.7974e+00,  8.5984e-01]],

         [[-3.6131e+00,        -inf,        -inf,        -inf],
          [ 2.5136e+00, -4.8090e-01,        -inf,        -inf],
          [-1.4568e+00, -1.5939e+00,  2.0225e+00,        -inf],
          [-3.1705e+00, -1.6861e+00,  3.6874e+00, -1.3908e-01]],

         [[ 1.5922e+00,        -inf,        -inf,        -inf],
          [ 3.0629e-01, -1.4089e+00,        -inf,        -inf],
          [ 3.3311e+00,  7.8558e-01,  4.1966e+00,        -inf],
          [ 3.4134e+00,  5.8520e-01, -3.7940e+00, -4.3063e+00]],

         [[ 1.3707e-01,        -inf,        -inf,        -inf],
          [ 1.4935e+00,  4.5922e-01,        -inf,        -inf],
          [ 6.8109e+00, -1.8777e+00,  1.1949e-01,        -inf],
          [ 4.4912e+00,  4.1477e+00,  2.1142e+00,  1.1439e+00]],

         [[ 1.1292e+00,        -inf,        -inf,        -inf],
          [-1.6126e+00,  1.1684e+00,        -inf,        -inf],
          [ 3.6028e+00,  5.3408e-01,  6.8429e+00,        -inf],
          [-1.0253e-01,  3.1961e+00,  1.6055e+00,  6.8790e-01]],

         [[ 1.2644e+00,        -inf,        -inf,        -inf],
          [-3.5980e+00, -3.9234e+00,        -inf,        -inf],
          [ 8.0076e-01,  2.8230e-01, -1.9376e+00,        -inf],
          [ 3.5299e+00,  7.5625e-01,  4.6777e+00,  5.8384e+00]]]])
context_vec step1:
 tensor([[[[ 0.1158,  0.4745,  1.6715,  ...,  0.0817,  0.0389,  1.1330],
          [ 0.5777,  0.2285, -0.6281,  ..., -0.6759, -0.5703,  0.5115],
          [-0.2465,  0.7171, -0.8609,  ...,  1.2560, -0.1384, -0.8450],
          ...,
          [ 0.6056,  0.4008,  0.9332,  ..., -0.1719, -0.6693,  0.0070],
          [ 0.0576, -0.8407, -0.7644,  ..., -1.0717,  1.2222, -0.0961],
          [ 1.0022, -0.0919, -0.2713,  ..., -0.3437,  0.1841,  0.3804]],

         [[ 0.1467, -0.0507,  1.2708,  ...,  0.0081,  0.8588,  0.8051],
          [ 0.5479, -0.1108, -0.4677,  ..., -0.9169,  0.1588, -0.0698],
          [-0.1875,  0.5260, -0.3943,  ...,  1.0182, -0.2839, -0.9140],
          ...,
          [ 0.7565,  0.1613,  0.8068,  ..., -0.3566, -0.0802,  0.2070],
          [-0.3914, -0.7292, -0.5803,  ..., -0.3932,  0.5127, -0.4829],
          [ 0.3084, -0.3248, -0.0944,  ..., -0.8689,  0.4110, -0.4274]],

         [[-0.1305,  0.1061,  1.3063,  ..., -0.0787,  0.7500,  0.8535],
          [ 0.5434, -0.0515, -0.1686,  ..., -0.8396,  0.2137, -0.3811],
          [ 0.1378,  0.4490, -0.6078,  ...,  0.9725, -0.4882, -0.6633],
          ...,
          [ 0.4032,  0.2377,  0.5446,  ..., -0.5716, -0.4301, -0.1590],
          [-0.4599, -0.2897, -0.0880,  ..., -0.2863,  0.5689, -0.0259],
          [ 0.2872, -0.6352,  0.1458,  ..., -0.4667,  0.3995, -0.6763]],

         [[-0.0367,  0.1615,  1.1376,  ...,  0.1754,  0.5851,  0.6416],
          [ 0.4459, -0.0555, -0.0193,  ..., -0.6789,  0.0823, -0.4680],
          [-0.0378, -0.0379, -0.5201,  ...,  0.7499, -0.2882, -0.3131],
          ...,
          [ 0.3676,  0.1810,  0.2670,  ..., -0.6759, -0.2150, -0.0853],
          [-0.3277, -0.4482, -0.3546,  ..., -0.1280,  0.4099,  0.0392],
          [-0.0434, -0.6443,  0.2174,  ..., -0.1750,  0.2005, -0.4391]]]])
context_vec step2:
 tensor([[[ 0.1158,  0.4745,  1.6715,  ..., -0.3437,  0.1841,  0.3804],
         [ 0.1467, -0.0507,  1.2708,  ..., -0.8689,  0.4110, -0.4274],
         [-0.1305,  0.1061,  1.3063,  ..., -0.4667,  0.3995, -0.6763],
         [-0.0367,  0.1615,  1.1376,  ..., -0.1750,  0.2005, -0.4391]]])
context_vec step3:
 tensor([[[-0.4686, -0.3162,  0.0201,  ..., -0.2241,  0.2687,  0.0194],
         [-0.3892, -0.1020,  0.1033,  ..., -0.3877,  0.0465, -0.0385],
         [-0.3222, -0.1265, -0.1175,  ..., -0.6632,  0.2199, -0.3187],
         [-0.2519,  0.0086, -0.1401,  ..., -0.5358,  0.0660, -0.2746]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-2.6629,    -inf,    -inf,    -inf],
          [ 1.0215,  1.5370,    -inf,    -inf],
          [-6.4425, -0.9437, -2.0585,    -inf],
          [-0.6801, -0.8974, -1.8144,  3.0691]],

         [[ 4.2764,    -inf,    -inf,    -inf],
          [ 5.0896, -4.1753,    -inf,    -inf],
          [ 1.5707, -2.3757, -3.0043,    -inf],
          [-4.0107,  3.1633,  1.5410, -0.2885]],

         [[ 3.2017,    -inf,    -inf,    -inf],
          [ 2.1877, -2.4454,    -inf,    -inf],
          [ 1.6623, -0.1128, -0.8051,    -inf],
          [-1.5686,  0.5070,  0.8149, -3.6955]],

         [[ 3.2494,    -inf,    -inf,    -inf],
          [ 1.8637, -2.2862,    -inf,    -inf],
          [ 2.6125, -0.4144,  2.1304,    -inf],
          [ 0.6205, -2.5009,  1.3912, -1.8568]],

         [[ 0.4835,    -inf,    -inf,    -inf],
          [ 2.8753, -3.5916,    -inf,    -inf],
          [ 4.4315, -3.7016,  3.2981,    -inf],
          [-3.7536,  3.0357, -1.5701, -0.5065]],

         [[ 1.9242,    -inf,    -inf,    -inf],
          [ 0.6832, -1.3512,    -inf,    -inf],
          [-2.0795, -3.6506, -0.4830,    -inf],
          [ 1.8757, -3.0512, -2.5388,  0.1025]],

         [[-2.7719,    -inf,    -inf,    -inf],
          [ 1.7406,  2.3980,    -inf,    -inf],
          [-0.9486,  1.2899,  5.6885,    -inf],
          [ 1.7350,  2.0028,  6.8365, -2.6851]],

         [[ 3.0204,    -inf,    -inf,    -inf],
          [-2.3043, -1.3426,    -inf,    -inf],
          [-2.8579, -3.3395,  1.5007,    -inf],
          [-1.2693, -1.4019, -4.8250, -0.0307]],

         [[-0.7581,    -inf,    -inf,    -inf],
          [ 2.9692, -3.4321,    -inf,    -inf],
          [ 2.0204, -0.5695, -0.8530,    -inf],
          [-0.8496,  5.5629, -0.7905, -2.6005]],

         [[-2.2591,    -inf,    -inf,    -inf],
          [-4.2558, -3.5978,    -inf,    -inf],
          [-1.3219, -0.6620, -2.2222,    -inf],
          [ 3.4004,  2.1118,  0.9494,  0.8899]],

         [[ 2.0803,    -inf,    -inf,    -inf],
          [-0.1501, -2.6761,    -inf,    -inf],
          [-3.0397,  1.5514, -1.0550,    -inf],
          [-4.0402, -4.9038,  0.1604,  1.2452]],

         [[-1.8529,    -inf,    -inf,    -inf],
          [-3.1212, -1.3260,    -inf,    -inf],
          [ 1.8119,  2.5920, -2.9179,    -inf],
          [-0.7137,  3.0717, -3.5012, -1.4584]]]])
attn weights tensor:
 tensor([[[[-2.6629,    -inf,    -inf,    -inf],
          [ 1.0215,  1.5370,    -inf,    -inf],
          [-6.4425, -0.9437, -2.0585,    -inf],
          [-0.6801, -0.8974, -1.8144,  3.0691]],

         [[ 4.2764,    -inf,    -inf,    -inf],
          [ 5.0896, -4.1753,    -inf,    -inf],
          [ 1.5707, -2.3757, -3.0043,    -inf],
          [-4.0107,  3.1633,  1.5410, -0.2885]],

         [[ 3.2017,    -inf,    -inf,    -inf],
          [ 2.1877, -2.4454,    -inf,    -inf],
          [ 1.6623, -0.1128, -0.8051,    -inf],
          [-1.5686,  0.5070,  0.8149, -3.6955]],

         [[ 3.2494,    -inf,    -inf,    -inf],
          [ 1.8637, -2.2862,    -inf,    -inf],
          [ 2.6125, -0.4144,  2.1304,    -inf],
          [ 0.6205, -2.5009,  1.3912, -1.8568]],

         [[ 0.4835,    -inf,    -inf,    -inf],
          [ 2.8753, -3.5916,    -inf,    -inf],
          [ 4.4315, -3.7016,  3.2981,    -inf],
          [-3.7536,  3.0357, -1.5701, -0.5065]],

         [[ 1.9242,    -inf,    -inf,    -inf],
          [ 0.6832, -1.3512,    -inf,    -inf],
          [-2.0795, -3.6506, -0.4830,    -inf],
          [ 1.8757, -3.0512, -2.5388,  0.1025]],

         [[-2.7719,    -inf,    -inf,    -inf],
          [ 1.7406,  2.3980,    -inf,    -inf],
          [-0.9486,  1.2899,  5.6885,    -inf],
          [ 1.7350,  2.0028,  6.8365, -2.6851]],

         [[ 3.0204,    -inf,    -inf,    -inf],
          [-2.3043, -1.3426,    -inf,    -inf],
          [-2.8579, -3.3395,  1.5007,    -inf],
          [-1.2693, -1.4019, -4.8250, -0.0307]],

         [[-0.7581,    -inf,    -inf,    -inf],
          [ 2.9692, -3.4321,    -inf,    -inf],
          [ 2.0204, -0.5695, -0.8530,    -inf],
          [-0.8496,  5.5629, -0.7905, -2.6005]],

         [[-2.2591,    -inf,    -inf,    -inf],
          [-4.2558, -3.5978,    -inf,    -inf],
          [-1.3219, -0.6620, -2.2222,    -inf],
          [ 3.4004,  2.1118,  0.9494,  0.8899]],

         [[ 2.0803,    -inf,    -inf,    -inf],
          [-0.1501, -2.6761,    -inf,    -inf],
          [-3.0397,  1.5514, -1.0550,    -inf],
          [-4.0402, -4.9038,  0.1604,  1.2452]],

         [[-1.8529,    -inf,    -inf,    -inf],
          [-3.1212, -1.3260,    -inf,    -inf],
          [ 1.8119,  2.5920, -2.9179,    -inf],
          [-0.7137,  3.0717, -3.5012, -1.4584]]]])
context_vec step1:
 tensor([[[[-0.2797,  0.9330, -0.2708,  ...,  0.9407, -0.8801, -0.1505],
          [ 0.2629,  0.3337,  0.4045,  ..., -0.3746,  0.5462,  0.6649],
          [ 0.4179,  0.7681,  0.7747,  ..., -0.0311,  1.2887, -0.7646],
          ...,
          [-0.6292,  0.3808,  0.1487,  ..., -0.7758,  0.3957,  1.6552],
          [ 1.2726, -0.6881,  0.7288,  ..., -0.1268,  0.7517,  0.4672],
          [-0.4324,  0.5043,  0.4364,  ...,  0.4899, -0.1169,  0.0336]],

         [[-0.0391,  0.1633,  0.1357,  ...,  0.5914, -0.3964, -0.2876],
          [ 0.4920,  0.3045,  0.2960,  ..., -0.3307,  0.1207,  0.5597],
          [ 0.1908,  0.2523,  0.0231,  ...,  0.0755,  0.7880, -0.3338],
          ...,
          [-0.3047, -0.1196,  0.3506,  ..., -0.4897,  0.3330,  0.4860],
          [ 0.5767, -0.0828,  0.8896,  ..., -0.0456,  0.5228, -0.0017],
          [ 0.0693,  0.2327,  0.2212,  ...,  0.3535, -0.2300,  0.1808]],

         [[ 0.2842, -0.4884, -0.0858,  ...,  0.2910,  0.0750, -0.1684],
          [ 0.3752,  0.1877,  0.3417,  ..., -0.1101, -0.4038,  0.5435],
          [-0.1246,  0.0505,  0.0136,  ...,  0.1278,  0.1915, -0.2950],
          ...,
          [-0.0835, -0.0475,  0.1327,  ..., -0.3248,  0.3526,  0.1778],
          [ 0.0236,  0.4755,  0.7396,  ..., -0.0544,  0.0576, -0.1365],
          [ 0.0252,  0.1120,  0.2306,  ...,  0.3943, -0.0382,  0.1048]],

         [[ 0.0664,  0.1224, -0.0174,  ..., -0.0113,  0.0654,  0.2575],
          [ 0.5794,  0.1435,  0.3057,  ...,  0.2087, -0.9739,  0.3948],
          [-0.1888, -0.2342,  0.0158,  ...,  0.1171, -0.0114, -0.1845],
          ...,
          [-0.1607,  0.1293,  0.1135,  ..., -0.3181,  0.1432,  0.0616],
          [-0.0355,  0.1138,  0.8982,  ..., -0.0641, -0.3269,  0.1228],
          [ 0.0090,  0.1410,  0.2911,  ...,  0.1369, -0.0043,  0.0435]]]])
context_vec step2:
 tensor([[[-0.2797,  0.9330, -0.2708,  ...,  0.4899, -0.1169,  0.0336],
         [-0.0391,  0.1633,  0.1357,  ...,  0.3535, -0.2300,  0.1808],
         [ 0.2842, -0.4884, -0.0858,  ...,  0.3943, -0.0382,  0.1048],
         [ 0.0664,  0.1224, -0.0174,  ...,  0.1369, -0.0043,  0.0435]]])
context_vec step3:
 tensor([[[-0.2935,  0.0984, -0.0054,  ...,  0.1972,  0.0947,  0.0289],
         [-0.1331,  0.0226,  0.1879,  ...,  0.1780, -0.0929, -0.0677],
         [-0.1778, -0.0670,  0.2223,  ...,  0.1892,  0.1066, -0.2076],
         [ 0.0869, -0.0182,  0.2413,  ...,  0.1673,  0.0852, -0.1347]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-4.3048,    -inf,    -inf,    -inf],
          [-2.3796, -0.6090,    -inf,    -inf],
          [-0.1143,  4.0371,  3.7860,    -inf],
          [-2.7333, -1.2775, -3.2815, -0.5970]],

         [[ 3.3153,    -inf,    -inf,    -inf],
          [ 2.0994, -0.2190,    -inf,    -inf],
          [-3.0227, -0.7738, -1.6208,    -inf],
          [-0.2280, -1.5787,  0.4681,  1.2437]],

         [[ 1.0033,    -inf,    -inf,    -inf],
          [-0.5743, -0.4043,    -inf,    -inf],
          [ 2.6156,  2.8231,  1.9517,    -inf],
          [-0.8725,  3.9707,  2.6267,  1.4684]],

         [[-0.1934,    -inf,    -inf,    -inf],
          [ 0.3265, -3.2311,    -inf,    -inf],
          [-3.7727, -4.3903,  1.3601,    -inf],
          [ 2.4057,  5.6783,  2.1445, -1.1235]],

         [[-0.1604,    -inf,    -inf,    -inf],
          [-3.9931,  1.3268,    -inf,    -inf],
          [-4.2011, -4.9232, -2.6982,    -inf],
          [ 1.6324,  4.8256,  2.7806,  2.2681]],

         [[ 0.4174,    -inf,    -inf,    -inf],
          [ 2.7210, -0.2757,    -inf,    -inf],
          [-2.2277,  0.0854, -1.3191,    -inf],
          [-3.7616,  1.4610,  1.2979, -1.4075]],

         [[ 2.9595,    -inf,    -inf,    -inf],
          [-0.7321, -0.2690,    -inf,    -inf],
          [-3.8500,  0.8323, -1.6170,    -inf],
          [-2.3067, -2.3722, -0.1179,  1.5293]],

         [[-1.6434,    -inf,    -inf,    -inf],
          [ 0.6165, -0.8211,    -inf,    -inf],
          [-1.1691,  0.8504,  0.5812,    -inf],
          [-0.1186,  4.3101, -1.0802,  0.3403]],

         [[-2.7721,    -inf,    -inf,    -inf],
          [-3.7698, -3.4560,    -inf,    -inf],
          [ 3.4237,  4.3556,  1.9247,    -inf],
          [-2.7583, -0.5469,  4.4233,  3.7664]],

         [[-1.4951,    -inf,    -inf,    -inf],
          [ 0.7578,  1.2588,    -inf,    -inf],
          [ 2.4112,  1.5591,  3.2509,    -inf],
          [-2.8436,  2.8529,  5.1890,  0.1497]],

         [[ 1.4316,    -inf,    -inf,    -inf],
          [ 0.4023,  1.8810,    -inf,    -inf],
          [ 1.8493,  4.0742, -0.8206,    -inf],
          [ 2.2816, -1.9145, -4.0156, -1.5475]],

         [[ 0.4584,    -inf,    -inf,    -inf],
          [ 0.0573,  1.2482,    -inf,    -inf],
          [ 2.3383, -0.5745,  3.0067,    -inf],
          [ 2.2347, -3.7871,  3.1087,  0.7084]]]])
attn weights tensor:
 tensor([[[[-4.3048,    -inf,    -inf,    -inf],
          [-2.3796, -0.6090,    -inf,    -inf],
          [-0.1143,  4.0371,  3.7860,    -inf],
          [-2.7333, -1.2775, -3.2815, -0.5970]],

         [[ 3.3153,    -inf,    -inf,    -inf],
          [ 2.0994, -0.2190,    -inf,    -inf],
          [-3.0227, -0.7738, -1.6208,    -inf],
          [-0.2280, -1.5787,  0.4681,  1.2437]],

         [[ 1.0033,    -inf,    -inf,    -inf],
          [-0.5743, -0.4043,    -inf,    -inf],
          [ 2.6156,  2.8231,  1.9517,    -inf],
          [-0.8725,  3.9707,  2.6267,  1.4684]],

         [[-0.1934,    -inf,    -inf,    -inf],
          [ 0.3265, -3.2311,    -inf,    -inf],
          [-3.7727, -4.3903,  1.3601,    -inf],
          [ 2.4057,  5.6783,  2.1445, -1.1235]],

         [[-0.1604,    -inf,    -inf,    -inf],
          [-3.9931,  1.3268,    -inf,    -inf],
          [-4.2011, -4.9232, -2.6982,    -inf],
          [ 1.6324,  4.8256,  2.7806,  2.2681]],

         [[ 0.4174,    -inf,    -inf,    -inf],
          [ 2.7210, -0.2757,    -inf,    -inf],
          [-2.2277,  0.0854, -1.3191,    -inf],
          [-3.7616,  1.4610,  1.2979, -1.4075]],

         [[ 2.9595,    -inf,    -inf,    -inf],
          [-0.7321, -0.2690,    -inf,    -inf],
          [-3.8500,  0.8323, -1.6170,    -inf],
          [-2.3067, -2.3722, -0.1179,  1.5293]],

         [[-1.6434,    -inf,    -inf,    -inf],
          [ 0.6165, -0.8211,    -inf,    -inf],
          [-1.1691,  0.8504,  0.5812,    -inf],
          [-0.1186,  4.3101, -1.0802,  0.3403]],

         [[-2.7721,    -inf,    -inf,    -inf],
          [-3.7698, -3.4560,    -inf,    -inf],
          [ 3.4237,  4.3556,  1.9247,    -inf],
          [-2.7583, -0.5469,  4.4233,  3.7664]],

         [[-1.4951,    -inf,    -inf,    -inf],
          [ 0.7578,  1.2588,    -inf,    -inf],
          [ 2.4112,  1.5591,  3.2509,    -inf],
          [-2.8436,  2.8529,  5.1890,  0.1497]],

         [[ 1.4316,    -inf,    -inf,    -inf],
          [ 0.4023,  1.8810,    -inf,    -inf],
          [ 1.8493,  4.0742, -0.8206,    -inf],
          [ 2.2816, -1.9145, -4.0156, -1.5475]],

         [[ 0.4584,    -inf,    -inf,    -inf],
          [ 0.0573,  1.2482,    -inf,    -inf],
          [ 2.3383, -0.5745,  3.0067,    -inf],
          [ 2.2347, -3.7871,  3.1087,  0.7084]]]])
context_vec step1:
 tensor([[[[-0.0256,  0.6420,  0.9959,  ...,  0.3262,  0.3693, -0.9257],
          [ 0.1452, -0.1447, -0.2939,  ..., -0.0347,  0.4509, -0.4817],
          [-0.0350,  1.1873,  0.2071,  ..., -0.5324,  0.5247,  0.3948],
          ...,
          [ 0.3434, -0.1310, -0.1743,  ..., -0.0689, -0.0769,  0.6726],
          [-1.2895, -0.2714, -0.0742,  ...,  1.0514,  1.5616,  0.8332],
          [ 0.2020, -0.2701,  1.0126,  ..., -0.9786, -1.0916, -0.4558]],

         [[-0.1545, -0.3520,  0.6712,  ...,  0.2484,  0.0717, -0.4227],
          [-0.1709, -0.4086, -0.1975,  ..., -0.2007,  0.1335, -0.3160],
          [-0.0019,  0.2348, -0.3446,  ...,  0.0821,  0.6864, -0.0309],
          ...,
          [-0.3434,  0.1857, -0.3891,  ...,  0.1871, -0.5908, -0.0772],
          [-0.8398, -0.2089,  0.1980,  ...,  0.6750,  0.6404,  0.6612],
          [-0.3855, -0.3545,  1.0951,  ..., -1.0093, -0.4531, -0.4165]],

         [[ 0.0110, -0.2999,  0.5689,  ...,  0.1825, -0.0727, -0.1678],
          [-0.5389, -0.3023, -0.1204,  ..., -0.1384,  0.2317,  0.1211],
          [-0.1555,  0.0056, -0.1482,  ...,  0.0776,  0.7196, -0.2268],
          ...,
          [-0.2686, -0.3534, -0.3768,  ...,  0.0205, -0.3603, -0.1121],
          [-0.7856, -0.1835,  0.4456,  ...,  0.6183,  0.4574,  0.6727],
          [-0.4188, -0.4092,  0.6966,  ..., -0.9057, -0.3549, -0.1255]],

         [[-0.1221,  0.0546,  0.7872,  ...,  0.2509, -0.2371, -0.3875],
          [-0.2859, -0.1479, -0.1018,  ..., -0.0319,  0.0441,  0.4982],
          [-0.2109, -0.2392, -0.0409,  ...,  0.0807,  0.5346, -0.2148],
          ...,
          [-0.3193, -0.4343, -0.2830,  ...,  0.0342, -0.3119, -0.0077],
          [-0.8762,  0.1183,  0.3457,  ...,  0.4156,  0.6112,  0.6817],
          [-0.3199, -0.5094,  0.7089,  ..., -0.7135, -0.1709, -0.2316]]]])
context_vec step2:
 tensor([[[-0.0256,  0.6420,  0.9959,  ..., -0.9786, -1.0916, -0.4558],
         [-0.1545, -0.3520,  0.6712,  ..., -1.0093, -0.4531, -0.4165],
         [ 0.0110, -0.2999,  0.5689,  ..., -0.9057, -0.3549, -0.1255],
         [-0.1221,  0.0546,  0.7872,  ..., -0.7135, -0.1709, -0.2316]]])
context_vec step3:
 tensor([[[-0.5910, -0.1279,  0.4399,  ..., -0.1635,  0.0110, -0.3459],
         [-0.3828,  0.0555,  0.2156,  ..., -0.2326, -0.0355, -0.3762],
         [-0.0876,  0.0688,  0.1529,  ..., -0.1506,  0.0811, -0.3682],
         [ 0.0856,  0.0330,  0.2775,  ..., -0.1668,  0.1160, -0.4504]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.3034e+00,        -inf,        -inf,        -inf],
          [-2.5656e+00,  6.0336e-03,        -inf,        -inf],
          [ 1.8262e+00,  2.2184e+00,  3.1072e+00,        -inf],
          [-3.0190e+00,  8.2269e-01, -6.4353e-01,  2.9650e+00]],

         [[-1.1145e+00,        -inf,        -inf,        -inf],
          [-5.2751e-01,  5.1875e+00,        -inf,        -inf],
          [-2.0908e+00, -4.0657e-01, -3.0623e+00,        -inf],
          [ 3.4250e+00,  1.5853e+00,  5.7630e+00, -4.1872e+00]],

         [[-4.8115e+00,        -inf,        -inf,        -inf],
          [-3.8454e+00,  1.6655e+00,        -inf,        -inf],
          [-5.7140e+00, -1.4722e+00, -4.9501e+00,        -inf],
          [ 2.8638e+00,  3.0382e+00, -2.0067e+00,  1.6561e+00]],

         [[ 2.6182e+00,        -inf,        -inf,        -inf],
          [-1.7094e+00, -2.8045e+00,        -inf,        -inf],
          [ 3.4992e-01,  4.3329e+00,  4.9487e-01,        -inf],
          [ 2.5238e+00,  3.1982e+00, -1.8874e+00, -2.5666e+00]],

         [[-6.2748e-01,        -inf,        -inf,        -inf],
          [ 1.4923e+00,  3.4256e+00,        -inf,        -inf],
          [-3.4147e+00, -5.9127e-01, -1.7273e+00,        -inf],
          [-1.9066e-01, -7.2940e-01, -2.1922e+00, -4.4414e+00]],

         [[ 1.8721e+00,        -inf,        -inf,        -inf],
          [-8.2579e-01, -1.6509e+00,        -inf,        -inf],
          [-1.7325e+00, -6.3766e+00, -5.5595e+00,        -inf],
          [ 6.5876e+00,  1.3482e+00, -2.1984e+00,  3.2320e+00]],

         [[-6.8163e-01,        -inf,        -inf,        -inf],
          [ 1.9613e+00, -2.0654e+00,        -inf,        -inf],
          [-1.1734e+00,  2.7367e+00, -4.0755e+00,        -inf],
          [-1.1626e+00,  2.8313e+00, -2.3979e+00,  2.1366e+00]],

         [[-5.4520e+00,        -inf,        -inf,        -inf],
          [-1.1438e+00, -2.2996e+00,        -inf,        -inf],
          [-2.6677e+00, -6.8509e+00, -2.5571e+00,        -inf],
          [ 3.7377e+00, -2.6919e+00,  1.9705e+00,  2.8969e+00]],

         [[-4.7577e-01,        -inf,        -inf,        -inf],
          [ 1.8763e+00,  2.7155e+00,        -inf,        -inf],
          [ 5.6670e-01,  1.5268e+00,  4.0396e+00,        -inf],
          [-8.2793e-01,  2.2971e+00, -1.3204e+00, -3.6436e+00]],

         [[-4.1394e+00,        -inf,        -inf,        -inf],
          [-6.6950e+00, -1.1209e+00,        -inf,        -inf],
          [ 2.9452e-01,  2.6481e-01, -1.7946e+00,        -inf],
          [-1.6673e+00, -1.9940e+00, -3.9655e+00, -6.3941e+00]],

         [[ 1.4231e+00,        -inf,        -inf,        -inf],
          [-3.4826e+00, -6.7679e+00,        -inf,        -inf],
          [-4.4638e-01, -3.1816e+00,  2.1272e-01,        -inf],
          [ 1.7650e-01, -1.9798e+00,  1.7742e+00,  5.2545e+00]],

         [[-3.6729e-01,        -inf,        -inf,        -inf],
          [ 4.0825e+00,  3.7463e-02,        -inf,        -inf],
          [-8.5655e-01, -8.0555e-01,  1.6072e+00,        -inf],
          [-3.6457e+00, -3.2740e+00, -1.5445e-01, -1.2680e+00]]]])
attn weights tensor:
 tensor([[[[ 1.3034e+00,        -inf,        -inf,        -inf],
          [-2.5656e+00,  6.0336e-03,        -inf,        -inf],
          [ 1.8262e+00,  2.2184e+00,  3.1072e+00,        -inf],
          [-3.0190e+00,  8.2269e-01, -6.4353e-01,  2.9650e+00]],

         [[-1.1145e+00,        -inf,        -inf,        -inf],
          [-5.2751e-01,  5.1875e+00,        -inf,        -inf],
          [-2.0908e+00, -4.0657e-01, -3.0623e+00,        -inf],
          [ 3.4250e+00,  1.5853e+00,  5.7630e+00, -4.1872e+00]],

         [[-4.8115e+00,        -inf,        -inf,        -inf],
          [-3.8454e+00,  1.6655e+00,        -inf,        -inf],
          [-5.7140e+00, -1.4722e+00, -4.9501e+00,        -inf],
          [ 2.8638e+00,  3.0382e+00, -2.0067e+00,  1.6561e+00]],

         [[ 2.6182e+00,        -inf,        -inf,        -inf],
          [-1.7094e+00, -2.8045e+00,        -inf,        -inf],
          [ 3.4992e-01,  4.3329e+00,  4.9487e-01,        -inf],
          [ 2.5238e+00,  3.1982e+00, -1.8874e+00, -2.5666e+00]],

         [[-6.2748e-01,        -inf,        -inf,        -inf],
          [ 1.4923e+00,  3.4256e+00,        -inf,        -inf],
          [-3.4147e+00, -5.9127e-01, -1.7273e+00,        -inf],
          [-1.9066e-01, -7.2940e-01, -2.1922e+00, -4.4414e+00]],

         [[ 1.8721e+00,        -inf,        -inf,        -inf],
          [-8.2579e-01, -1.6509e+00,        -inf,        -inf],
          [-1.7325e+00, -6.3766e+00, -5.5595e+00,        -inf],
          [ 6.5876e+00,  1.3482e+00, -2.1984e+00,  3.2320e+00]],

         [[-6.8163e-01,        -inf,        -inf,        -inf],
          [ 1.9613e+00, -2.0654e+00,        -inf,        -inf],
          [-1.1734e+00,  2.7367e+00, -4.0755e+00,        -inf],
          [-1.1626e+00,  2.8313e+00, -2.3979e+00,  2.1366e+00]],

         [[-5.4520e+00,        -inf,        -inf,        -inf],
          [-1.1438e+00, -2.2996e+00,        -inf,        -inf],
          [-2.6677e+00, -6.8509e+00, -2.5571e+00,        -inf],
          [ 3.7377e+00, -2.6919e+00,  1.9705e+00,  2.8969e+00]],

         [[-4.7577e-01,        -inf,        -inf,        -inf],
          [ 1.8763e+00,  2.7155e+00,        -inf,        -inf],
          [ 5.6670e-01,  1.5268e+00,  4.0396e+00,        -inf],
          [-8.2793e-01,  2.2971e+00, -1.3204e+00, -3.6436e+00]],

         [[-4.1394e+00,        -inf,        -inf,        -inf],
          [-6.6950e+00, -1.1209e+00,        -inf,        -inf],
          [ 2.9452e-01,  2.6481e-01, -1.7946e+00,        -inf],
          [-1.6673e+00, -1.9940e+00, -3.9655e+00, -6.3941e+00]],

         [[ 1.4231e+00,        -inf,        -inf,        -inf],
          [-3.4826e+00, -6.7679e+00,        -inf,        -inf],
          [-4.4638e-01, -3.1816e+00,  2.1272e-01,        -inf],
          [ 1.7650e-01, -1.9798e+00,  1.7742e+00,  5.2545e+00]],

         [[-3.6729e-01,        -inf,        -inf,        -inf],
          [ 4.0825e+00,  3.7463e-02,        -inf,        -inf],
          [-8.5655e-01, -8.0555e-01,  1.6072e+00,        -inf],
          [-3.6457e+00, -3.2740e+00, -1.5445e-01, -1.2680e+00]]]])
context_vec step1:
 tensor([[[[ 3.9807e-01,  4.1397e-01, -6.0961e-01,  ..., -5.4423e-01,
            7.2126e-02,  1.3328e+00],
          [-4.7923e-01, -6.4994e-01, -1.7824e-01,  ...,  6.1294e-01,
           -2.4409e-01, -1.4516e-01],
          [-1.5026e-01,  7.5138e-02,  1.1082e+00,  ..., -8.4867e-01,
            5.1698e-01, -2.5727e-01],
          ...,
          [ 3.7664e-01,  7.9920e-01, -7.7599e-01,  ...,  2.0918e-01,
            1.7314e-01,  3.5483e-01],
          [-2.5343e-01,  1.9897e-01,  9.3274e-01,  ...,  8.7073e-01,
            4.3458e-01,  2.5742e-01],
          [ 2.4570e-01,  2.6795e-01, -4.0005e-01,  ...,  1.9869e-01,
            3.2437e-02, -4.4940e-01]],

         [[ 5.7062e-02,  7.5745e-01, -4.7640e-01,  ...,  1.6505e-01,
           -4.0446e-01,  8.4879e-01],
          [ 9.1230e-01, -7.2800e-01,  4.1304e-01,  ..., -3.6457e-01,
           -4.7340e-02,  2.7146e-02],
          [-3.0962e-01,  3.8235e-01,  1.6695e-01,  ..., -3.7362e-01,
            2.5930e-01, -1.6730e-01],
          ...,
          [ 6.6633e-01,  3.1626e-01, -7.0363e-02,  ...,  3.1775e-01,
            2.5885e-01, -9.3571e-02],
          [-2.4089e-01,  1.1681e-01,  5.6174e-01,  ...,  5.8581e-01,
            2.2121e-01,  3.3244e-01],
          [ 2.0299e-01, -3.7839e-02, -5.5607e-01,  ..., -7.7773e-02,
            1.1068e-01, -4.4234e-02]],

         [[ 1.1179e-01,  6.7550e-01, -3.2905e-01,  ..., -1.1498e-01,
           -3.4741e-01,  7.6986e-01],
          [ 6.4113e-01, -4.8691e-01,  5.1712e-01,  ...,  1.0276e-03,
           -2.5611e-01,  1.9537e-01],
          [-1.7256e-01,  5.7687e-02,  2.3618e-01,  ...,  1.5671e-02,
            1.5187e-01, -6.3340e-02],
          ...,
          [ 2.6035e-01,  5.6440e-01, -3.8544e-01,  ...,  4.0373e-01,
            1.5906e-01,  1.9520e-01],
          [-2.0346e-01,  2.6369e-01,  2.9833e-02,  ...,  4.0627e-01,
            1.2329e-01, -2.3358e-01],
          [ 8.4394e-03, -1.3316e-01, -2.3168e-01,  ...,  1.4537e-01,
            2.2306e-02, -3.8986e-02]],

         [[ 4.4687e-04,  3.0288e-01, -2.0452e-01,  ...,  2.4579e-02,
           -1.6958e-01,  3.9002e-01],
          [ 3.2818e-01, -2.3828e-01,  6.8365e-01,  ...,  1.7000e-01,
           -3.3323e-01,  1.3325e-01],
          [-1.7454e-01,  3.2752e-01,  2.1286e-02,  ...,  1.1326e-01,
            4.4112e-01,  9.6221e-02],
          ...,
          [ 8.2948e-02,  4.6477e-01, -2.6934e-01,  ...,  3.9097e-01,
            2.0412e-01,  2.0595e-01],
          [-3.4707e-01,  3.7627e-01,  5.0312e-02,  ...,  4.2606e-01,
            4.2254e-02, -4.8236e-02],
          [-7.5898e-02, -2.9497e-01, -5.2975e-01,  ...,  7.0047e-01,
            5.0007e-02, -6.0131e-04]]]])
context_vec step2:
 tensor([[[ 3.9807e-01,  4.1397e-01, -6.0961e-01,  ...,  1.9869e-01,
           3.2437e-02, -4.4940e-01],
         [ 5.7062e-02,  7.5745e-01, -4.7640e-01,  ..., -7.7773e-02,
           1.1068e-01, -4.4234e-02],
         [ 1.1179e-01,  6.7550e-01, -3.2905e-01,  ...,  1.4537e-01,
           2.2306e-02, -3.8986e-02],
         [ 4.4687e-04,  3.0288e-01, -2.0452e-01,  ...,  7.0047e-01,
           5.0007e-02, -6.0131e-04]]])
context_vec step3:
 tensor([[[-0.0753, -0.0478,  0.3273,  ..., -0.3001,  0.0364, -0.0518],
         [ 0.1100,  0.2761,  0.1705,  ..., -0.1634, -0.1862, -0.1491],
         [ 0.0455,  0.1137,  0.1455,  ..., -0.0996, -0.0426, -0.3540],
         [ 0.1110, -0.0397,  0.2498,  ...,  0.0057, -0.0714, -0.1479]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 6.5925e-01,        -inf,        -inf,        -inf],
          [ 2.1030e+00, -2.4481e-01,        -inf,        -inf],
          [-3.3220e-01, -4.2154e+00, -3.1445e+00,        -inf],
          [ 1.6985e+00, -1.1746e-01, -5.1009e+00, -9.3646e-01]],

         [[-2.7487e+00,        -inf,        -inf,        -inf],
          [-1.9598e+00,  2.2814e+00,        -inf,        -inf],
          [ 1.3093e+00,  3.2076e+00,  3.4859e+00,        -inf],
          [ 2.4275e+00, -3.3253e+00, -1.1503e+00,  6.2162e-01]],

         [[-1.8331e+00,        -inf,        -inf,        -inf],
          [ 1.2431e+00,  4.3040e+00,        -inf,        -inf],
          [ 5.0174e-01, -1.7714e+00,  9.2132e-01,        -inf],
          [ 2.0552e+00, -9.5347e-01, -6.9842e-01,  5.1290e+00]],

         [[ 1.2130e+00,        -inf,        -inf,        -inf],
          [ 6.9763e-01,  1.9890e-01,        -inf,        -inf],
          [-3.4466e-01,  3.7001e-01, -1.8206e-01,        -inf],
          [-2.2659e+00, -4.1613e+00, -1.2048e+00, -3.0179e+00]],

         [[-1.5554e+00,        -inf,        -inf,        -inf],
          [-1.4441e+00,  3.0556e+00,        -inf,        -inf],
          [-2.4851e+00, -3.5497e+00,  7.6262e-02,        -inf],
          [ 6.9630e-01,  1.1224e+00, -3.5379e+00,  2.3611e+00]],

         [[ 2.0138e-01,        -inf,        -inf,        -inf],
          [-5.7091e+00, -1.2016e-03,        -inf,        -inf],
          [-3.1722e-01, -1.9968e+00, -3.9455e+00,        -inf],
          [ 2.7290e+00, -1.5700e+00, -5.8174e-01, -1.2168e+00]],

         [[ 6.2319e-01,        -inf,        -inf,        -inf],
          [ 1.8297e+00, -5.0262e-01,        -inf,        -inf],
          [ 1.4008e+00,  8.2144e-01,  1.4073e+00,        -inf],
          [-2.4426e+00, -4.1136e+00, -9.1150e-01,  1.9271e+00]],

         [[-2.8784e+00,        -inf,        -inf,        -inf],
          [-3.3846e+00,  8.3547e-01,        -inf,        -inf],
          [-2.7405e-01,  1.4443e+00,  4.8142e+00,        -inf],
          [ 1.2213e+00, -3.1416e+00, -5.5735e+00,  6.4423e+00]],

         [[ 1.7042e+00,        -inf,        -inf,        -inf],
          [ 2.0896e+00, -3.8296e+00,        -inf,        -inf],
          [ 2.5061e+00, -3.8281e+00, -3.2048e+00,        -inf],
          [ 4.0687e+00,  1.7879e+00, -1.0393e+00,  1.8774e+00]],

         [[ 4.3392e+00,        -inf,        -inf,        -inf],
          [ 3.0640e+00, -1.3884e+00,        -inf,        -inf],
          [ 2.6351e+00,  1.3231e+00, -3.6039e-01,        -inf],
          [-3.8310e+00, -2.3059e+00, -2.2931e+00, -1.2987e+00]],

         [[-1.1033e+00,        -inf,        -inf,        -inf],
          [-3.1496e-02, -4.4526e+00,        -inf,        -inf],
          [ 2.6306e-01,  1.2580e+00, -5.0809e+00,        -inf],
          [ 2.9007e+00,  2.0377e+00,  8.8631e-01, -1.5222e+00]],

         [[ 4.9002e+00,        -inf,        -inf,        -inf],
          [ 3.1450e+00,  1.5661e+00,        -inf,        -inf],
          [ 2.2009e+00,  2.6362e+00,  5.9068e+00,        -inf],
          [ 5.3520e+00, -9.6191e-01,  2.6930e+00, -1.7800e-01]]]])
attn weights tensor:
 tensor([[[[ 6.5925e-01,        -inf,        -inf,        -inf],
          [ 2.1030e+00, -2.4481e-01,        -inf,        -inf],
          [-3.3220e-01, -4.2154e+00, -3.1445e+00,        -inf],
          [ 1.6985e+00, -1.1746e-01, -5.1009e+00, -9.3646e-01]],

         [[-2.7487e+00,        -inf,        -inf,        -inf],
          [-1.9598e+00,  2.2814e+00,        -inf,        -inf],
          [ 1.3093e+00,  3.2076e+00,  3.4859e+00,        -inf],
          [ 2.4275e+00, -3.3253e+00, -1.1503e+00,  6.2162e-01]],

         [[-1.8331e+00,        -inf,        -inf,        -inf],
          [ 1.2431e+00,  4.3040e+00,        -inf,        -inf],
          [ 5.0174e-01, -1.7714e+00,  9.2132e-01,        -inf],
          [ 2.0552e+00, -9.5347e-01, -6.9842e-01,  5.1290e+00]],

         [[ 1.2130e+00,        -inf,        -inf,        -inf],
          [ 6.9763e-01,  1.9890e-01,        -inf,        -inf],
          [-3.4466e-01,  3.7001e-01, -1.8206e-01,        -inf],
          [-2.2659e+00, -4.1613e+00, -1.2048e+00, -3.0179e+00]],

         [[-1.5554e+00,        -inf,        -inf,        -inf],
          [-1.4441e+00,  3.0556e+00,        -inf,        -inf],
          [-2.4851e+00, -3.5497e+00,  7.6262e-02,        -inf],
          [ 6.9630e-01,  1.1224e+00, -3.5379e+00,  2.3611e+00]],

         [[ 2.0138e-01,        -inf,        -inf,        -inf],
          [-5.7091e+00, -1.2016e-03,        -inf,        -inf],
          [-3.1722e-01, -1.9968e+00, -3.9455e+00,        -inf],
          [ 2.7290e+00, -1.5700e+00, -5.8174e-01, -1.2168e+00]],

         [[ 6.2319e-01,        -inf,        -inf,        -inf],
          [ 1.8297e+00, -5.0262e-01,        -inf,        -inf],
          [ 1.4008e+00,  8.2144e-01,  1.4073e+00,        -inf],
          [-2.4426e+00, -4.1136e+00, -9.1150e-01,  1.9271e+00]],

         [[-2.8784e+00,        -inf,        -inf,        -inf],
          [-3.3846e+00,  8.3547e-01,        -inf,        -inf],
          [-2.7405e-01,  1.4443e+00,  4.8142e+00,        -inf],
          [ 1.2213e+00, -3.1416e+00, -5.5735e+00,  6.4423e+00]],

         [[ 1.7042e+00,        -inf,        -inf,        -inf],
          [ 2.0896e+00, -3.8296e+00,        -inf,        -inf],
          [ 2.5061e+00, -3.8281e+00, -3.2048e+00,        -inf],
          [ 4.0687e+00,  1.7879e+00, -1.0393e+00,  1.8774e+00]],

         [[ 4.3392e+00,        -inf,        -inf,        -inf],
          [ 3.0640e+00, -1.3884e+00,        -inf,        -inf],
          [ 2.6351e+00,  1.3231e+00, -3.6039e-01,        -inf],
          [-3.8310e+00, -2.3059e+00, -2.2931e+00, -1.2987e+00]],

         [[-1.1033e+00,        -inf,        -inf,        -inf],
          [-3.1496e-02, -4.4526e+00,        -inf,        -inf],
          [ 2.6306e-01,  1.2580e+00, -5.0809e+00,        -inf],
          [ 2.9007e+00,  2.0377e+00,  8.8631e-01, -1.5222e+00]],

         [[ 4.9002e+00,        -inf,        -inf,        -inf],
          [ 3.1450e+00,  1.5661e+00,        -inf,        -inf],
          [ 2.2009e+00,  2.6362e+00,  5.9068e+00,        -inf],
          [ 5.3520e+00, -9.6191e-01,  2.6930e+00, -1.7800e-01]]]])
context_vec step1:
 tensor([[[[ 0.9559, -0.8384, -0.8835,  ...,  0.6720,  0.4832, -0.2450],
          [-0.3603,  0.1370,  0.1352,  ..., -0.1507, -0.5076, -0.1730],
          [-0.2024, -0.3108, -0.4864,  ..., -0.4049,  0.1387,  0.0612],
          ...,
          [-0.1214, -0.2823, -0.4831,  ..., -0.5613,  0.6179, -0.7796],
          [-0.5568,  0.0548, -1.0396,  ...,  0.9667,  0.3142,  1.3892],
          [ 0.4430,  0.7206,  0.9459,  ..., -0.6667, -0.3969, -0.6598]],

         [[ 0.6809, -0.2982, -0.7527,  ...,  0.1888,  0.5189, -0.0980],
          [-0.2756, -0.2129,  0.6625,  ..., -0.0686, -0.1027, -0.3244],
          [-0.4710, -0.4383, -0.0461,  ..., -0.6598,  0.1287,  0.3684],
          ...,
          [ 0.1260, -0.1983, -0.2756,  ..., -0.0723,  0.8284, -0.4570],
          [-0.6653,  0.0883, -0.5747,  ...,  0.4476,  0.1644,  1.0182],
          [ 0.0502,  0.5496,  0.7487,  ..., -0.1319, -0.5761, -0.6103]],

         [[ 0.5321, -0.2015, -0.3461,  ...,  0.0971,  0.5789, -0.3269],
          [-0.0406,  0.0402,  0.3896,  ..., -0.2886, -0.4014, -0.4212],
          [-0.4912, -0.4282, -0.6581,  ..., -0.3623,  0.0262,  0.4690],
          ...,
          [-0.0293, -0.1877, -0.0083,  ..., -0.1672,  0.5407, -0.2899],
          [-0.5367,  0.0466, -0.4341,  ...,  0.0228, -0.1285,  0.6654],
          [-0.2768,  0.3315,  0.0600,  ...,  0.4780, -0.3011, -0.0619]],

         [[ 0.2699, -0.2523, -0.4333,  ...,  0.0073,  0.5062, -0.3243],
          [-0.1240, -0.0573,  0.1457,  ..., -0.3196, -0.4541, -0.4050],
          [-0.3091, -0.2405, -0.2433,  ..., -0.3920, -0.1069,  0.2121],
          ...,
          [ 0.0486, -0.0074,  0.1797,  ..., -0.1506,  0.0818,  0.1787],
          [-0.4229, -0.0761, -0.2828,  ..., -0.1730, -0.2418,  0.5785],
          [-0.1447,  0.4364,  0.2861,  ...,  0.2299, -0.2285, -0.2694]]]])
context_vec step2:
 tensor([[[ 0.9559, -0.8384, -0.8835,  ..., -0.6667, -0.3969, -0.6598],
         [ 0.6809, -0.2982, -0.7527,  ..., -0.1319, -0.5761, -0.6103],
         [ 0.5321, -0.2015, -0.3461,  ...,  0.4780, -0.3011, -0.0619],
         [ 0.2699, -0.2523, -0.4333,  ...,  0.2299, -0.2285, -0.2694]]])
context_vec step3:
 tensor([[[ 0.0721, -0.2495, -0.4666,  ..., -0.1324,  0.1588,  0.1257],
         [-0.0025,  0.0532, -0.5996,  ...,  0.2541,  0.2125,  0.1366],
         [-0.1200, -0.2467, -0.4866,  ...,  0.4229,  0.3158,  0.0860],
         [-0.1455, -0.0058, -0.5157,  ...,  0.1778,  0.3425, -0.0356]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 8.7386e-01,        -inf,        -inf,        -inf],
          [ 3.9503e+00, -2.7609e-02,        -inf,        -inf],
          [ 1.8521e+00, -3.1131e+00,  1.8943e+00,        -inf],
          [-5.6679e-01,  2.1261e+00, -2.1939e+00, -1.0028e+00]],

         [[ 3.7643e+00,        -inf,        -inf,        -inf],
          [ 2.9910e-01,  1.5260e+00,        -inf,        -inf],
          [ 6.4995e+00,  2.1990e+00,  1.4372e+00,        -inf],
          [-1.0251e+00,  5.9517e+00,  4.2260e+00,  1.3402e+00]],

         [[ 2.5953e+00,        -inf,        -inf,        -inf],
          [ 2.9235e+00, -4.5433e-01,        -inf,        -inf],
          [ 5.5290e+00, -1.8502e+00, -2.2858e+00,        -inf],
          [ 1.2779e+00, -1.3772e+00,  2.1603e+00, -4.8358e-01]],

         [[ 9.2989e-01,        -inf,        -inf,        -inf],
          [ 4.3134e+00, -2.1312e+00,        -inf,        -inf],
          [ 4.8539e-01, -5.0640e-01,  1.9546e+00,        -inf],
          [-5.1890e+00, -4.1580e-01,  1.0541e+00, -3.4891e+00]],

         [[ 2.5730e+00,        -inf,        -inf,        -inf],
          [ 4.7759e+00,  3.1115e+00,        -inf,        -inf],
          [ 8.8922e-01, -9.2261e-01, -2.0169e+00,        -inf],
          [ 5.1627e-02,  4.6064e+00,  1.5879e+00,  1.3885e+00]],

         [[ 2.1563e+00,        -inf,        -inf,        -inf],
          [ 1.4130e+00, -8.2377e-01,        -inf,        -inf],
          [ 1.9508e+00, -1.5088e+00, -2.8437e+00,        -inf],
          [ 2.0940e+00,  2.2794e+00,  3.2075e+00,  1.7294e+00]],

         [[-4.7401e+00,        -inf,        -inf,        -inf],
          [-9.1342e-01, -2.5119e+00,        -inf,        -inf],
          [ 2.6160e-01, -2.9725e-01,  1.6784e-01,        -inf],
          [ 3.1170e+00,  7.0973e+00, -5.1492e+00, -5.3521e+00]],

         [[ 1.2850e+00,        -inf,        -inf,        -inf],
          [-7.7877e-02,  5.6154e-01,        -inf,        -inf],
          [ 2.1226e-03,  8.3693e-01, -1.0585e+00,        -inf],
          [-1.5750e+00, -7.8897e-01,  4.6653e+00, -4.3465e-02]],

         [[-1.0846e+00,        -inf,        -inf,        -inf],
          [ 3.4551e+00,  2.4912e+00,        -inf,        -inf],
          [ 7.1514e+00,  2.9416e+00,  2.8110e+00,        -inf],
          [ 1.6590e+00,  8.4427e-03,  1.1863e+00, -6.9914e+00]],

         [[ 2.3024e+00,        -inf,        -inf,        -inf],
          [ 8.6299e-01, -1.2889e+00,        -inf,        -inf],
          [-1.9042e+00, -2.5323e+00, -5.4386e+00,        -inf],
          [ 1.8638e+00,  2.1024e+00,  4.0528e+00,  1.2866e-01]],

         [[-3.5200e-01,        -inf,        -inf,        -inf],
          [ 1.1440e+00,  2.3196e+00,        -inf,        -inf],
          [-4.0420e+00,  4.4844e-01,  2.1226e+00,        -inf],
          [-4.0750e+00, -6.1213e-01, -4.6645e+00, -3.4311e+00]],

         [[-1.4709e-01,        -inf,        -inf,        -inf],
          [ 6.3750e-01, -1.0132e+00,        -inf,        -inf],
          [-5.3258e+00,  2.6271e-01,  1.0141e+00,        -inf],
          [-3.7408e+00, -1.0143e+00, -4.3344e+00, -7.8881e-01]]]])
attn weights tensor:
 tensor([[[[ 8.7386e-01,        -inf,        -inf,        -inf],
          [ 3.9503e+00, -2.7609e-02,        -inf,        -inf],
          [ 1.8521e+00, -3.1131e+00,  1.8943e+00,        -inf],
          [-5.6679e-01,  2.1261e+00, -2.1939e+00, -1.0028e+00]],

         [[ 3.7643e+00,        -inf,        -inf,        -inf],
          [ 2.9910e-01,  1.5260e+00,        -inf,        -inf],
          [ 6.4995e+00,  2.1990e+00,  1.4372e+00,        -inf],
          [-1.0251e+00,  5.9517e+00,  4.2260e+00,  1.3402e+00]],

         [[ 2.5953e+00,        -inf,        -inf,        -inf],
          [ 2.9235e+00, -4.5433e-01,        -inf,        -inf],
          [ 5.5290e+00, -1.8502e+00, -2.2858e+00,        -inf],
          [ 1.2779e+00, -1.3772e+00,  2.1603e+00, -4.8358e-01]],

         [[ 9.2989e-01,        -inf,        -inf,        -inf],
          [ 4.3134e+00, -2.1312e+00,        -inf,        -inf],
          [ 4.8539e-01, -5.0640e-01,  1.9546e+00,        -inf],
          [-5.1890e+00, -4.1580e-01,  1.0541e+00, -3.4891e+00]],

         [[ 2.5730e+00,        -inf,        -inf,        -inf],
          [ 4.7759e+00,  3.1115e+00,        -inf,        -inf],
          [ 8.8922e-01, -9.2261e-01, -2.0169e+00,        -inf],
          [ 5.1627e-02,  4.6064e+00,  1.5879e+00,  1.3885e+00]],

         [[ 2.1563e+00,        -inf,        -inf,        -inf],
          [ 1.4130e+00, -8.2377e-01,        -inf,        -inf],
          [ 1.9508e+00, -1.5088e+00, -2.8437e+00,        -inf],
          [ 2.0940e+00,  2.2794e+00,  3.2075e+00,  1.7294e+00]],

         [[-4.7401e+00,        -inf,        -inf,        -inf],
          [-9.1342e-01, -2.5119e+00,        -inf,        -inf],
          [ 2.6160e-01, -2.9725e-01,  1.6784e-01,        -inf],
          [ 3.1170e+00,  7.0973e+00, -5.1492e+00, -5.3521e+00]],

         [[ 1.2850e+00,        -inf,        -inf,        -inf],
          [-7.7877e-02,  5.6154e-01,        -inf,        -inf],
          [ 2.1226e-03,  8.3693e-01, -1.0585e+00,        -inf],
          [-1.5750e+00, -7.8897e-01,  4.6653e+00, -4.3465e-02]],

         [[-1.0846e+00,        -inf,        -inf,        -inf],
          [ 3.4551e+00,  2.4912e+00,        -inf,        -inf],
          [ 7.1514e+00,  2.9416e+00,  2.8110e+00,        -inf],
          [ 1.6590e+00,  8.4427e-03,  1.1863e+00, -6.9914e+00]],

         [[ 2.3024e+00,        -inf,        -inf,        -inf],
          [ 8.6299e-01, -1.2889e+00,        -inf,        -inf],
          [-1.9042e+00, -2.5323e+00, -5.4386e+00,        -inf],
          [ 1.8638e+00,  2.1024e+00,  4.0528e+00,  1.2866e-01]],

         [[-3.5200e-01,        -inf,        -inf,        -inf],
          [ 1.1440e+00,  2.3196e+00,        -inf,        -inf],
          [-4.0420e+00,  4.4844e-01,  2.1226e+00,        -inf],
          [-4.0750e+00, -6.1213e-01, -4.6645e+00, -3.4311e+00]],

         [[-1.4709e-01,        -inf,        -inf,        -inf],
          [ 6.3750e-01, -1.0132e+00,        -inf,        -inf],
          [-5.3258e+00,  2.6271e-01,  1.0141e+00,        -inf],
          [-3.7408e+00, -1.0143e+00, -4.3344e+00, -7.8881e-01]]]])
context_vec step1:
 tensor([[[[-0.7680,  0.8235, -0.6004,  ..., -0.2237,  0.6719, -0.2393],
          [ 0.4003, -0.1485,  0.9564,  ...,  0.6227, -0.6243, -0.1517],
          [ 1.4443, -0.9535, -0.3744,  ..., -0.2330,  0.5367, -0.7384],
          ...,
          [-0.9949,  0.0762, -0.8101,  ..., -0.3025,  0.4419, -0.3631],
          [ 0.1121,  0.4255,  0.7878,  ..., -0.2232, -0.5352,  0.6084],
          [-0.0862,  0.2718,  0.3524,  ...,  0.5203,  0.3730,  0.0405]],

         [[-0.2121,  0.8926, -0.5042,  ...,  0.0227,  0.3049, -0.1867],
          [ 0.4691,  0.0641,  0.4703,  ..., -0.1106, -0.1069, -0.2790],
          [ 0.7538, -0.9314, -0.5588,  ..., -0.0833,  0.7849, -0.7949],
          ...,
          [-0.8902,  0.0212, -0.3761,  ..., -0.7367,  0.1666, -0.4470],
          [-0.1779,  0.1263,  0.1236,  ..., -0.7562, -0.4268, -0.0832],
          [-0.0340,  0.6527,  0.3348,  ...,  0.1044,  0.1813,  0.0213]],

         [[-0.3317,  0.9203, -0.3940,  ...,  0.0651, -0.1324, -0.2180],
          [ 0.2045, -0.0323,  0.6415,  ...,  0.1011,  0.0403, -0.2990],
          [ 0.7874, -0.7965, -0.4372,  ..., -0.2501,  0.4990, -0.6729],
          ...,
          [-0.5869,  0.1684,  0.0512,  ..., -0.8088, -0.1007, -0.5541],
          [ 0.0322,  0.3379, -0.3018,  ..., -0.5827, -0.6571,  0.0699],
          [ 0.3010,  0.7369,  0.0862,  ..., -0.1337, -0.0455,  0.0297]],

         [[-0.1243,  0.7726, -0.3604,  ...,  0.1691, -0.2565, -0.1600],
          [ 0.0552,  0.1528,  0.4384,  ..., -0.1954,  0.3136, -0.4322],
          [ 0.4250, -0.6139, -0.3778,  ..., -0.0325,  0.4086, -0.6546],
          ...,
          [-0.3575,  0.2979,  0.1467,  ..., -0.7927, -0.1623, -0.6214],
          [ 0.0426,  0.2767,  0.0181,  ..., -0.3981, -0.3918,  0.0916],
          [ 0.2708,  0.6383, -0.0760,  ..., -0.0350,  0.2884,  0.0197]]]])
context_vec step2:
 tensor([[[-0.7680,  0.8235, -0.6004,  ...,  0.5203,  0.3730,  0.0405],
         [-0.2121,  0.8926, -0.5042,  ...,  0.1044,  0.1813,  0.0213],
         [-0.3317,  0.9203, -0.3940,  ..., -0.1337, -0.0455,  0.0297],
         [-0.1243,  0.7726, -0.3604,  ..., -0.0350,  0.2884,  0.0197]]])
context_vec step3:
 tensor([[[ 0.3146,  0.3117,  0.3009,  ...,  0.1988,  0.2896,  0.1073],
         [ 0.2401,  0.1417,  0.3057,  ...,  0.0493,  0.1948,  0.2393],
         [ 0.1947, -0.0246,  0.2376,  ..., -0.1019,  0.0867,  0.0158],
         [ 0.1016, -0.0206,  0.0868,  ..., -0.0637,  0.0882,  0.0641]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[ 1.4158,    -inf,    -inf,    -inf],
          [ 1.6735, -0.4881,    -inf,    -inf],
          [ 0.7148,  0.6886, -0.9579,    -inf],
          [ 0.4304, -1.1701, -1.6487, -4.8064]],

         [[ 0.7854,    -inf,    -inf,    -inf],
          [ 2.0510,  1.2905,    -inf,    -inf],
          [ 0.3503, -1.4874,  0.5995,    -inf],
          [ 3.4721,  1.2521,  3.8179,  0.2041]],

         [[-0.2607,    -inf,    -inf,    -inf],
          [-0.9848,  1.5973,    -inf,    -inf],
          [-2.3647, -2.6291,  3.1270,    -inf],
          [-0.8347,  4.0645,  4.9043, -3.4371]],

         [[ 0.4633,    -inf,    -inf,    -inf],
          [-0.9217, -0.2268,    -inf,    -inf],
          [ 0.4334,  1.0928,  2.2613,    -inf],
          [-3.3133, -0.0544,  1.0945, -1.2503]],

         [[-2.4089,    -inf,    -inf,    -inf],
          [ 1.9702, -2.1667,    -inf,    -inf],
          [ 5.3788,  4.2307,  4.1756,    -inf],
          [ 3.5574,  4.0800,  4.4473,  8.9966]],

         [[-5.1309,    -inf,    -inf,    -inf],
          [-5.1362, -1.0700,    -inf,    -inf],
          [-1.9178, -1.6907,  2.1314,    -inf],
          [ 0.6928,  0.2853,  1.8608, -1.7381]],

         [[-1.2883,    -inf,    -inf,    -inf],
          [ 4.3224,  0.3126,    -inf,    -inf],
          [ 3.3196,  2.1271,  2.2837,    -inf],
          [ 1.0640,  1.5278, -0.0912, -4.7282]],

         [[-0.6592,    -inf,    -inf,    -inf],
          [ 2.4759,  3.4329,    -inf,    -inf],
          [ 0.3415,  1.4557,  3.1047,    -inf],
          [-1.1568, -1.5811,  3.9042,  0.2249]],

         [[-0.1999,    -inf,    -inf,    -inf],
          [ 3.3260,  1.7285,    -inf,    -inf],
          [-1.5643, -7.0706, -1.5074,    -inf],
          [ 1.3347,  0.1769, -1.1452, -1.7782]],

         [[-3.8470,    -inf,    -inf,    -inf],
          [ 3.2128, -2.6424,    -inf,    -inf],
          [-4.9929, -6.1773, -2.0377,    -inf],
          [-2.9463, -3.0018, -2.2297, -0.8207]],

         [[-4.2285,    -inf,    -inf,    -inf],
          [-0.4056,  0.1395,    -inf,    -inf],
          [ 2.8315, -0.2235,  2.0212,    -inf],
          [-1.1437, -0.0561, -1.8008,  0.2398]],

         [[-1.4693,    -inf,    -inf,    -inf],
          [ 3.9518, -3.9476,    -inf,    -inf],
          [ 3.8611, -1.9718, -4.0944,    -inf],
          [-0.4531, -3.9523, -2.5856, -2.3668]]]])
attn weights tensor:
 tensor([[[[ 1.4158,    -inf,    -inf,    -inf],
          [ 1.6735, -0.4881,    -inf,    -inf],
          [ 0.7148,  0.6886, -0.9579,    -inf],
          [ 0.4304, -1.1701, -1.6487, -4.8064]],

         [[ 0.7854,    -inf,    -inf,    -inf],
          [ 2.0510,  1.2905,    -inf,    -inf],
          [ 0.3503, -1.4874,  0.5995,    -inf],
          [ 3.4721,  1.2521,  3.8179,  0.2041]],

         [[-0.2607,    -inf,    -inf,    -inf],
          [-0.9848,  1.5973,    -inf,    -inf],
          [-2.3647, -2.6291,  3.1270,    -inf],
          [-0.8347,  4.0645,  4.9043, -3.4371]],

         [[ 0.4633,    -inf,    -inf,    -inf],
          [-0.9217, -0.2268,    -inf,    -inf],
          [ 0.4334,  1.0928,  2.2613,    -inf],
          [-3.3133, -0.0544,  1.0945, -1.2503]],

         [[-2.4089,    -inf,    -inf,    -inf],
          [ 1.9702, -2.1667,    -inf,    -inf],
          [ 5.3788,  4.2307,  4.1756,    -inf],
          [ 3.5574,  4.0800,  4.4473,  8.9966]],

         [[-5.1309,    -inf,    -inf,    -inf],
          [-5.1362, -1.0700,    -inf,    -inf],
          [-1.9178, -1.6907,  2.1314,    -inf],
          [ 0.6928,  0.2853,  1.8608, -1.7381]],

         [[-1.2883,    -inf,    -inf,    -inf],
          [ 4.3224,  0.3126,    -inf,    -inf],
          [ 3.3196,  2.1271,  2.2837,    -inf],
          [ 1.0640,  1.5278, -0.0912, -4.7282]],

         [[-0.6592,    -inf,    -inf,    -inf],
          [ 2.4759,  3.4329,    -inf,    -inf],
          [ 0.3415,  1.4557,  3.1047,    -inf],
          [-1.1568, -1.5811,  3.9042,  0.2249]],

         [[-0.1999,    -inf,    -inf,    -inf],
          [ 3.3260,  1.7285,    -inf,    -inf],
          [-1.5643, -7.0706, -1.5074,    -inf],
          [ 1.3347,  0.1769, -1.1452, -1.7782]],

         [[-3.8470,    -inf,    -inf,    -inf],
          [ 3.2128, -2.6424,    -inf,    -inf],
          [-4.9929, -6.1773, -2.0377,    -inf],
          [-2.9463, -3.0018, -2.2297, -0.8207]],

         [[-4.2285,    -inf,    -inf,    -inf],
          [-0.4056,  0.1395,    -inf,    -inf],
          [ 2.8315, -0.2235,  2.0212,    -inf],
          [-1.1437, -0.0561, -1.8008,  0.2398]],

         [[-1.4693,    -inf,    -inf,    -inf],
          [ 3.9518, -3.9476,    -inf,    -inf],
          [ 3.8611, -1.9718, -4.0944,    -inf],
          [-0.4531, -3.9523, -2.5856, -2.3668]]]])
context_vec step1:
 tensor([[[[ 0.8112,  0.1168,  0.1722,  ...,  0.2317, -0.2973,  0.2067],
          [-0.6457,  0.3832, -1.1519,  ...,  0.5266,  0.4893, -0.0730],
          [-0.6128,  0.4413,  0.1654,  ...,  0.2435,  0.7760,  0.1744],
          ...,
          [-0.6140, -0.4254,  0.4378,  ..., -0.6922,  0.4583, -0.3256],
          [ 0.5429,  0.6685, -0.1113,  ...,  0.0854, -0.8265, -0.1974],
          [-0.3071,  0.3935,  0.8077,  ...,  0.2513,  0.3309,  0.1607]],

         [[-0.1885, -0.1615, -0.0446,  ..., -0.0901,  0.0569,  0.1394],
          [-0.4989, -0.4697, -0.7934,  ...,  0.1077,  0.8020,  0.4361],
          [-0.4003,  0.5077,  0.0143,  ...,  0.7118,  0.4190, -0.0266],
          ...,
          [-0.4577, -0.3529,  0.2837,  ..., -0.6461,  0.7412, -0.4122],
          [-0.2550,  0.4305,  0.3607,  ...,  0.1466, -0.9200, -0.3762],
          [ 0.0344,  0.3623,  0.9062,  ...,  0.4109,  0.0452,  0.0161]],

         [[-0.1984, -0.2658, -0.2718,  ..., -0.1501,  0.4180,  0.1138],
          [-0.1968, -0.6745, -0.5983,  ...,  0.4072,  0.3643,  0.6974],
          [-0.4115,  0.1667,  0.3039,  ...,  0.4812,  0.8939, -0.0542],
          ...,
          [-0.4332, -0.4208,  0.0612,  ..., -0.7847,  0.6512, -0.6781],
          [-0.1622,  0.5162,  0.5426,  ...,  0.5665, -0.5219, -0.0798],
          [ 0.0653,  0.3015,  0.8994,  ...,  0.4855,  0.0422, -0.1420]],

         [[-0.2482, -0.2280, -0.0787,  ..., -0.1348,  0.5048,  0.1024],
          [-0.2867, -0.6682, -0.4802,  ...,  0.3183,  0.3116,  0.6213],
          [-0.3380,  0.1271,  0.2372,  ...,  0.6707,  0.5959, -0.0895],
          ...,
          [-0.5555, -0.3116,  0.1252,  ..., -0.5473,  0.7010, -0.2822],
          [-0.4822,  0.2849,  0.2558,  ...,  0.5236, -0.2425, -0.0830],
          [ 0.0513,  0.2050,  0.3870,  ...,  0.4741,  0.2494, -0.3974]]]])
context_vec step2:
 tensor([[[ 0.8112,  0.1168,  0.1722,  ...,  0.2513,  0.3309,  0.1607],
         [-0.1885, -0.1615, -0.0446,  ...,  0.4109,  0.0452,  0.0161],
         [-0.1984, -0.2658, -0.2718,  ...,  0.4855,  0.0422, -0.1420],
         [-0.2482, -0.2280, -0.0787,  ...,  0.4741,  0.2494, -0.3974]]])
context_vec step3:
 tensor([[[ 0.0596,  0.4511,  0.2158,  ...,  0.0149, -0.4798, -0.2449],
         [-0.1668,  0.0408,  0.2378,  ..., -0.0934, -0.2208, -0.2104],
         [-0.1463,  0.0430,  0.0413,  ..., -0.2228, -0.2691, -0.0312],
         [-0.1238, -0.0032,  0.1943,  ..., -0.3325, -0.1743,  0.0867]]])
causal masked bool tensor:
 tensor([[False,  True,  True,  True],
        [False, False,  True,  True],
        [False, False, False,  True],
        [False, False, False, False]])
attn scores masked causal:
 tensor([[[[-0.9786,    -inf,    -inf,    -inf],
          [-2.3460, -0.9926,    -inf,    -inf],
          [-3.6182, -0.9736, -1.3027,    -inf],
          [-4.1544,  0.1454, -1.6874,  0.1887]],

         [[-0.1071,    -inf,    -inf,    -inf],
          [-1.9508,  0.9121,    -inf,    -inf],
          [-0.1887,  1.5004,  1.6899,    -inf],
          [ 1.2427,  4.7148,  2.7358,  1.1123]],

         [[ 1.0606,    -inf,    -inf,    -inf],
          [-1.5103, -0.4207,    -inf,    -inf],
          [ 6.5889,  0.8821, -1.3419,    -inf],
          [ 7.4068, 11.5013,  7.2865,  5.5635]],

         [[ 0.6490,    -inf,    -inf,    -inf],
          [ 3.4558, -2.3002,    -inf,    -inf],
          [ 4.2780, -0.8212, -3.2833,    -inf],
          [-3.5553, -2.7350,  0.2405,  1.0154]],

         [[-0.2433,    -inf,    -inf,    -inf],
          [-1.6724,  1.0137,    -inf,    -inf],
          [ 3.7073,  0.3006, -1.2167,    -inf],
          [-3.3916,  3.4467,  0.8002,  1.9818]],

         [[ 0.0250,    -inf,    -inf,    -inf],
          [ 2.7197, -3.2537,    -inf,    -inf],
          [-2.3774, -1.3202,  2.5196,    -inf],
          [-0.5413, -3.2806, -1.3730, -1.4454]],

         [[ 4.0624,    -inf,    -inf,    -inf],
          [ 3.4986,  1.7012,    -inf,    -inf],
          [ 4.1346,  6.4128,  1.4774,    -inf],
          [ 3.2702, -0.0182,  0.5528,  3.7835]],

         [[-0.5972,    -inf,    -inf,    -inf],
          [ 1.4831,  4.9396,    -inf,    -inf],
          [-4.8833,  0.2993, -3.4989,    -inf],
          [-4.0078,  1.7064, -2.9179, -1.0903]],

         [[-0.1384,    -inf,    -inf,    -inf],
          [-3.6950, -2.0653,    -inf,    -inf],
          [-1.9071,  3.4010,  4.4658,    -inf],
          [-5.1510, -2.1825, -1.6222, -6.0477]],

         [[-0.1885,    -inf,    -inf,    -inf],
          [-1.0190, -3.1426,    -inf,    -inf],
          [-0.4249, -1.4179,  2.6532,    -inf],
          [ 0.5289,  0.3168,  1.9979,  2.8758]],

         [[ 0.7030,    -inf,    -inf,    -inf],
          [ 1.8837,  3.9289,    -inf,    -inf],
          [ 4.7134,  2.0712,  1.4732,    -inf],
          [ 4.1817,  0.8152,  2.0283, -0.2846]],

         [[-2.8521,    -inf,    -inf,    -inf],
          [-0.4495, -3.3690,    -inf,    -inf],
          [-2.1452, -3.7144, -2.4207,    -inf],
          [ 5.7461, -1.9042,  1.7147,  0.1910]]]])
attn weights tensor:
 tensor([[[[-0.9786,    -inf,    -inf,    -inf],
          [-2.3460, -0.9926,    -inf,    -inf],
          [-3.6182, -0.9736, -1.3027,    -inf],
          [-4.1544,  0.1454, -1.6874,  0.1887]],

         [[-0.1071,    -inf,    -inf,    -inf],
          [-1.9508,  0.9121,    -inf,    -inf],
          [-0.1887,  1.5004,  1.6899,    -inf],
          [ 1.2427,  4.7148,  2.7358,  1.1123]],

         [[ 1.0606,    -inf,    -inf,    -inf],
          [-1.5103, -0.4207,    -inf,    -inf],
          [ 6.5889,  0.8821, -1.3419,    -inf],
          [ 7.4068, 11.5013,  7.2865,  5.5635]],

         [[ 0.6490,    -inf,    -inf,    -inf],
          [ 3.4558, -2.3002,    -inf,    -inf],
          [ 4.2780, -0.8212, -3.2833,    -inf],
          [-3.5553, -2.7350,  0.2405,  1.0154]],

         [[-0.2433,    -inf,    -inf,    -inf],
          [-1.6724,  1.0137,    -inf,    -inf],
          [ 3.7073,  0.3006, -1.2167,    -inf],
          [-3.3916,  3.4467,  0.8002,  1.9818]],

         [[ 0.0250,    -inf,    -inf,    -inf],
          [ 2.7197, -3.2537,    -inf,    -inf],
          [-2.3774, -1.3202,  2.5196,    -inf],
          [-0.5413, -3.2806, -1.3730, -1.4454]],

         [[ 4.0624,    -inf,    -inf,    -inf],
          [ 3.4986,  1.7012,    -inf,    -inf],
          [ 4.1346,  6.4128,  1.4774,    -inf],
          [ 3.2702, -0.0182,  0.5528,  3.7835]],

         [[-0.5972,    -inf,    -inf,    -inf],
          [ 1.4831,  4.9396,    -inf,    -inf],
          [-4.8833,  0.2993, -3.4989,    -inf],
          [-4.0078,  1.7064, -2.9179, -1.0903]],

         [[-0.1384,    -inf,    -inf,    -inf],
          [-3.6950, -2.0653,    -inf,    -inf],
          [-1.9071,  3.4010,  4.4658,    -inf],
          [-5.1510, -2.1825, -1.6222, -6.0477]],

         [[-0.1885,    -inf,    -inf,    -inf],
          [-1.0190, -3.1426,    -inf,    -inf],
          [-0.4249, -1.4179,  2.6532,    -inf],
          [ 0.5289,  0.3168,  1.9979,  2.8758]],

         [[ 0.7030,    -inf,    -inf,    -inf],
          [ 1.8837,  3.9289,    -inf,    -inf],
          [ 4.7134,  2.0712,  1.4732,    -inf],
          [ 4.1817,  0.8152,  2.0283, -0.2846]],

         [[-2.8521,    -inf,    -inf,    -inf],
          [-0.4495, -3.3690,    -inf,    -inf],
          [-2.1452, -3.7144, -2.4207,    -inf],
          [ 5.7461, -1.9042,  1.7147,  0.1910]]]])
context_vec step1:
 tensor([[[[-0.2518,  0.0589,  1.1020,  ...,  0.4638, -0.7432, -0.6094],
          [ 0.0085,  0.6637, -0.3654,  ..., -0.5030, -0.0811,  0.5757],
          [-0.1837,  0.1421,  1.0956,  ..., -0.0070,  0.6303, -0.8442],
          ...,
          [-0.2205, -0.0278, -0.9923,  ..., -0.2869, -0.0111,  0.0154],
          [ 0.2292, -0.3805, -1.1405,  ..., -0.0279,  0.2902, -0.3680],
          [-0.5804, -0.0124,  0.3806,  ...,  0.2771,  0.5607, -0.8765]],

         [[-0.0273,  0.0601,  1.0254,  ..., -0.0059, -0.7252, -0.7096],
          [ 0.0886,  0.3335, -0.2755,  ..., -0.5321, -0.4279, -0.0184],
          [-0.0012,  0.3717,  1.0356,  ...,  0.1086,  0.5985, -0.5539],
          ...,
          [-0.3905,  0.1030, -0.7482,  ..., -0.3700, -0.0820, -0.0150],
          [ 0.6032,  0.0738, -0.4858,  ...,  0.3519, -0.4402, -0.3733],
          [-0.2896,  0.0698,  0.1461,  ...,  0.1898,  0.2225, -0.4900]],

         [[-0.1215, -0.0257,  0.7365,  ..., -0.4245, -0.7400, -0.8436],
          [ 0.3397,  0.3012, -0.4032,  ..., -0.4410, -0.4552,  0.0285],
          [-0.0593,  0.3671,  0.8740,  ...,  0.3659,  0.5029, -0.3892],
          ...,
          [ 0.0406,  0.1488, -0.4168,  ..., -0.1389, -0.1936, -0.0192],
          [ 0.6118,  0.0346, -0.6862,  ...,  0.4409, -0.1183, -0.3344],
          [ 0.0307,  0.4831, -0.0154,  ...,  0.4310,  0.2266, -0.3735]],

         [[ 0.0544,  0.2093,  0.4266,  ..., -0.1420, -0.3303, -0.7045],
          [ 0.2804,  0.1873, -0.3861,  ..., -0.2871, -0.4443,  0.1142],
          [ 0.0083,  0.4126,  0.6574,  ...,  0.3204,  0.1863, -0.2221],
          ...,
          [ 0.1236,  0.1404, -0.1110,  ...,  0.0411,  0.0012, -0.3023],
          [ 0.5651, -0.0712, -0.5506,  ...,  0.3543, -0.0907, -0.5111],
          [-0.0064,  0.2689, -0.0280,  ...,  0.2849,  0.2227, -0.4398]]]])
context_vec step2:
 tensor([[[-0.2518,  0.0589,  1.1020,  ...,  0.2771,  0.5607, -0.8765],
         [-0.0273,  0.0601,  1.0254,  ...,  0.1898,  0.2225, -0.4900],
         [-0.1215, -0.0257,  0.7365,  ...,  0.4310,  0.2266, -0.3735],
         [ 0.0544,  0.2093,  0.4266,  ...,  0.2849,  0.2227, -0.4398]]])
context_vec step3:
 tensor([[[-0.0810,  0.7486,  0.2961,  ..., -0.2174,  0.8855,  0.0681],
         [-0.2400,  0.3538,  0.4190,  ..., -0.1410,  0.6814, -0.0537],
         [ 0.0037,  0.3092,  0.2011,  ..., -0.1992,  0.5357, -0.1784],
         [ 0.0314,  0.1883,  0.1771,  ..., -0.0013,  0.6468, -0.3200]]])
Output:  tensor([[15496,    11,   314,   716, 27018]])
Output length: 5
Hello, I am Feature
