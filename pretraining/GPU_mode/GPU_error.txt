Epoch 1 (Step 000000): Train loss 0.434, Val loss 7.439
debug: len input batch:  2  len target batch:  2  len train loader :  9
Traceback (most recent call last):
  File "/home/anupam/akaul_git/demosthenes-llm/pretraining/training.py", line 189, in <module>
    train_losses, val_losses, tokens_seen = train_model_simple(
                                            ^^^^^^^^^^^^^^^^^^^
  File "/home/anupam/akaul_git/demosthenes-llm/pretraining/training.py", line 39, in train_model_simple
    optimizer.step()                                  # update weight model using loss gradients
    ^^^^^^^^^^^^^^^^
  File "/home/anupam/anu-env/lib/python3.12/site-packages/torch/optim/optimizer.py", line 517, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/anupam/anu-env/lib/python3.12/site-packages/torch/optim/optimizer.py", line 82, in _use_grad
    ret = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/anupam/anu-env/lib/python3.12/site-packages/torch/optim/adam.py", line 247, in step
    adam(
  File "/home/anupam/anu-env/lib/python3.12/site-packages/torch/optim/optimizer.py", line 150, in maybe_fallback
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/anupam/anu-env/lib/python3.12/site-packages/torch/optim/adam.py", line 953, in adam
    func(
  File "/home/anupam/anu-env/lib/python3.12/site-packages/torch/optim/adam.py", line 777, in _multi_tensor_adam
    exp_avg_sq_sqrt = torch._foreach_sqrt(device_exp_avg_sqs)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 148.00 MiB. GPU 0 has a total capacity of 3.94 GiB of which 23.69 MiB is free. Including non-PyTorch memory, this process has 3.91 GiB memory in use. Of the allocated memory 3.53 GiB is allocated by PyTorch, and 321.23 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

